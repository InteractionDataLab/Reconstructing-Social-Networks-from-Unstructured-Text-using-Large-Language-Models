<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Toronto_scripts skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Toronto/scripts</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P>// Autocomplete ================================================================
</P><P>function start_autocomplete() {
pages = [
</P><PRE> &quot;applied design&quot;,
 &quot;attributions&quot;,
 &quot;basic part&quot;,
 &quot;bioinformatics workshop&quot;,
 &quot;collection&quot;,
 &quot;composite part&quot;,
 &quot;contribution&quot;,
 &quot;demonstrate&quot;,
 &quot;description&quot;,
 &quot;design&quot;,
 &quot;drylab&quot;,
 &quot;engagement&quot;,
 &quot;entrepreneurship&quot;,
 &quot;expirements&quot;,
 &quot;gold integrated&quot;,
 &quot;hardware&quot;,
 &quot;home&quot;,
 &quot;hp gold&quot;,
 &quot;hp silver&quot;,
 &quot;human practices&quot;,
 &quot;icon-a-thon&quot;,
 &quot;improve&quot;,
 &quot;integrated practices&quot;,
 &quot;interlab&quot;,
 &quot;interviews&quot;,
 &quot;measurement&quot;,
 &quot;model&quot;,
 &quot;notebook&quot;,
 &quot;parts&quot;,
 &quot;parts collection&quot;,
 &quot;plant&quot;,
 &quot;podcasts&quot;,
 &quot;proof&quot;,
 &quot;results&quot;,
 &quot;saftey&quot;,
 &quot;silver&quot;,
 &quot;software&quot;,
 &quot;team&quot;,
 &quot;wetlab&quot;
</PRE><P>]
</P><P>link = [
</P><PRE> &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Applied_Design">https://2017.igem.org/Team:Toronto/Applied_Design</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Attributions">https://2017.igem.org/Team:Toronto/Attributions</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Basic_Part">https://2017.igem.org/Team:Toronto/Basic_Part</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Bioinformatics-Workshop">https://2017.igem.org/Team:Toronto/Bioinformatics-Workshop</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Part_Collection">https://2017.igem.org/Team:Toronto/Part_Collection</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Composite_Part">https://2017.igem.org/Team:Toronto/Composite_Part</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Contribution">https://2017.igem.org/Team:Toronto/Contribution</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Demonstrate">https://2017.igem.org/Team:Toronto/Demonstrate</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Description">https://2017.igem.org/Team:Toronto/Description</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Design">https://2017.igem.org/Team:Toronto/Design</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Drylab">https://2017.igem.org/Team:Toronto/Drylab</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Engagement">https://2017.igem.org/Team:Toronto/Engagement</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Entrepreneurship">https://2017.igem.org/Team:Toronto/Entrepreneurship</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Experiments">https://2017.igem.org/Team:Toronto/Experiments</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Gold_Integrated">https://2017.igem.org/Team:Toronto/Gold_Integrated</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Hardware">https://2017.igem.org/Team:Toronto/Hardware</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto">https://2017.igem.org/Team:Toronto</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/HP/Gold">https://2017.igem.org/Team:Toronto/HP/Gold</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/HP/Silver">https://2017.igem.org/Team:Toronto/HP/Silver</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/PnP">https://2017.igem.org/Team:Toronto/PnP</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Icon-a-thon">https://2017.igem.org/Team:Toronto/Icon-a-thon</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Improve">https://2017.igem.org/Team:Toronto/Improve</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Integrated_Practices">https://2017.igem.org/Team:Toronto/Integrated_Practices</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/InterLab">https://2017.igem.org/Team:Toronto/InterLab</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Interviews">https://2017.igem.org/Team:Toronto/Interviews</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Measurement">https://2017.igem.org/Team:Toronto/Measurement</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Model">https://2017.igem.org/Team:Toronto/Model</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Notebook">https://2017.igem.org/Team:Toronto/Notebook</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Parts">https://2017.igem.org/Team:Toronto/Parts</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Part_Collection">https://2017.igem.org/Team:Toronto/Part_Collection</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Plant">https://2017.igem.org/Team:Toronto/Plant</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Podcast">https://2017.igem.org/Team:Toronto/Podcast</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Proof">https://2017.igem.org/Team:Toronto/Proof</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Results">https://2017.igem.org/Team:Toronto/Results</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Safety">https://2017.igem.org/Team:Toronto/Safety</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Silver">https://2017.igem.org/Team:Toronto/Silver</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Software">https://2017.igem.org/Team:Toronto/Software</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Team">https://2017.igem.org/Team:Toronto/Team</A>&quot;,
 &quot;<A rel="nofollow" class="external free" href="https://2017.igem.org/Team:Toronto/Wetlab">https://2017.igem.org/Team:Toronto/Wetlab</A>&quot;
</PRE><P>]
</P><PRE> function autocomplete() {
   console.log('Autocomplete has loaded');
   var input = document.getElementById('autocomplete');
   var suggest = document.getElementById(&quot;auto-suggest&quot;);
   var search = document.getElementById(&quot;search&quot;)
</PRE><PRE>   input.addEventListener('blur', function() {
     input.value = <I>;</I>
     setTimeout(function() {
       suggest.innerHTML = <I>;</I>
     }, 100);
   });
</PRE><PRE>   input.addEventListener(&quot;keyup&quot;, function() {
</PRE><PRE>     matches = [];
     pages.forEach(function(elem, i) {
       if (elem.includes(input.value.toLowerCase()) &amp;&amp; input.value != <I>) {</I>
         var li = document.createElement('li');
         var a = document.createElement('a');
         var text = document.createTextNode(elem.toUpperCase())
</PRE><PRE>         a.setAttribute('href', link[i])
         a.appendChild(text)
         li.appendChild(a)
</PRE><PRE>         matches.push(li);
         // console.log(matches);
       }
     });
     // console.log(suggest)
     suggest.innerHTML=<I>;</I>
     if (matches.length == 0) {
       search.style.display = 'none';
     } else {
       search.style.display = 'block';
       matches.forEach(function(elem) {
         suggest.appendChild(elem)
       });
     }
     // console.log(pages.includes(input.value));
   });
 }
</PRE><PRE> autocomplete();
</PRE><P>}
</P><P>start_autocomplete();
</P><P>// Set and unset the active class
function setActive(elem) {
</P><PRE> var sideNav = document.getElementsByClassName('sidebar-minibox');
 // console.log(sideNav);
 var ul = sideNav[0].getElementsByTagName('ul');
 console.log(ul);
 var li = ul[0].getElementsByTagName('li');
</PRE><PRE> for (i=0; i&lt;li.length; i++) {
   li[i].classList.remove('active');
 }
</PRE><PRE> elem.classList.add('active');
</PRE><P>}
</P><P>// Build the list items of the sideNav
function build(item, id) {
</P><PRE> var li = document.createElement('li');
 var anchor = document.createElement('a');
 var text = document.createTextNode(item.innerText);
</PRE><PRE> anchor.appendChild(text)
 anchor.setAttribute('href', '#'+id);
 li.appendChild(anchor);
 li.setAttribute('onclick', 'setActive(this)');
</PRE><PRE> return li;
</PRE><P>}
</P><P>function scrollWatch(scrollHeights, sectionContent) {
</P><PRE> var header = document.getElementsByClassName('header')[0];
 var sideNav = document.getElementsByClassName('sidebar-minibox')[0];
 var content = document.getElementsByClassName('content-page')[0];
 var footer = document.getElementsByClassName('footer')[0];
 var sideNavItems = sideNav.getElementsByTagName('li');
</PRE><PRE> window.addEventListener('scroll', function() {
   var mainNavScrollHeight = header.scrollHeight;
   var windowPageYOffset = window.pageYOffset;
   var windowInnerHeight = window.innerHeight;
   var documentBodyHeight = document.body.offsetHeight;
   // var footerScrollHeight = footer.scrollHeight;
   var footerScrollHeight = 0;
   var contentScroll = windowPageYOffset + mainNavScrollHeight;
   var bottom = documentBodyHeight - windowInnerHeight;
</PRE><PRE>   // console.log(contentScroll);
</PRE><PRE>   var currentView = scrollHeights.filter(function(arr) {
     // return arr &lt; contentScroll;
     return arr &lt; windowPageYOffset;
   });
   var currentViewLength = currentView.length;
</PRE><PRE>   // Make sure that the seek class is removed from the top element of the
   // sideNav when the top of the page is scrolled to
   if (contentScroll &gt; windowPageYOffset) {
     sideNavItems[0].classList.remove('active');
   }
</PRE><PRE>   // Add the active class to the list button in sideNav when the corresponding
   // section is in view. Remove this class when it is not.
   if (currentViewLength &gt; 0) {
     var index = currentViewLength - 1;
     for (i=0; i&lt;scrollHeights.length; i++) {
       sideNavItems[i].classList.remove('active');
     }
     sideNavItems[index].classList.add('active');
   } else {
</PRE><PRE>   }
</PRE><PRE>   // Fix the sideNav to the top of the page when the mainNav is scrolled past
   // Unfix otherwise
   if (windowPageYOffset &gt; mainNavScrollHeight) {
     sideNav.classList.add('sideNavfixed');
     content.classList.add('contentScroll');
   } else {
     sideNav.classList.remove('sideNavfixed');
     content.classList.remove('contentScroll');
   }
 });
</PRE><P>}
</P><P>function buildNav() {
</P><PRE> var sections = document.getElementsByClassName('subsection');
 var numberOfSections = sections.length;
 var sideNav = document.getElementsByClassName('sidebar-minibox')[0];
 var titleList = [];
 var idList = [];
 var scrollHeights = [];
 // console.log(sideNav.getElementsByTagName('ul')[0]);
</PRE><PRE> // Make a list of titles and scroll heights
 for (i=0; i&lt;numberOfSections; i++) {
   titleList.push(sections[i].getElementsByTagName('h2')[0]);
   idList.push(sections[i].id);
   scrollHeights.push(sections[i].offsetTop - 300);
 }
 console.log(scrollHeights);
</PRE><PRE> // Build the sideNav lists
 for (sec=0; sec&lt;numberOfSections; sec++) {
   listItem = build(titleList[sec], idList[sec])
   sideNav.getElementsByTagName('ul')[0].appendChild(listItem);
 }
</PRE><PRE> scrollWatch(scrollHeights, sections);
</PRE><P>}
</P><P>function sidebarFixed() {
	var sidebarOffset = $(&quot;#sidebar-box&quot;).offset().top - 50;
	$(window).scroll(function() {
			var scroll = $(window).scrollTop();
			 //console.log(scroll);
			if (scroll &gt;= sidebarOffset) {
					//console.log('a');
					$(&quot;#sidebar-box&quot;).addClass(&quot;fixed&quot;);
			} else {
					//console.log('a');
					$(&quot;#sidebar-box&quot;).removeClass(&quot;fixed&quot;);
			}
	});
}
</P><P>sidebarFixed();
</P><P>buildNav();
</P><P>
// 3dMOLjs initialization function
</P><P>function insertStructure(container, structureUrl, settingsFunction){
</P><PRE> let element = $(container);
 let config = { backgroundColor: '#0d0d0d' };
 let viewer = $3Dmol.createViewer( element, config );
 let pdbUri = structureUrl;
 jQuery.ajax( pdbUri, {
   success: function(data) {
     let v = viewer;
     v.addModel( data, &quot;pdb&quot; );
     settingsFunction(v);
     v.zoomTo();
     v.zoom(1.2, 1000);
     v.render();
   },
   error: function(hdr, status, err) {
     console.log( &quot;Failed to load PDB &quot; + pdbUri + &quot;: &quot; + err );
   }
 });
</PRE><P>}
</P><P>var settingsList = {
</P><PRE> settings1: function(v){
   v.setStyle({}, {cartoon: {color: 'spectrum'}})
 },
 settings2: function(v){
   v.setStyle({}, {cartoon: {color: 'spectrum'}})
 },
</PRE><P>}
</P><P>insertStructure(&quot;#container-01&quot;, '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2017/5/51/T--Toronto--2017_final_lacilov.txt'">https://static.igem.org/mediawiki/2017/5/51/T--Toronto--2017_final_lacilov.txt'</A>, settingsList.settings1);
</P><P>insertStructure(&quot;#container-02&quot;, '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2017/9/99/T--Toronto--2017_2v1a.txt'">https://static.igem.org/mediawiki/2017/9/99/T--Toronto--2017_2v1a.txt'</A>, settingsList.settings2);
</P><P>'use strict';
</P><P>var audioPlayer = document.querySelector('.audio-player');
var playPause = audioPlayer.querySelector('#playPause');
var playpauseBtn = audioPlayer.querySelector('.play-pause-btn');
var loading = audioPlayer.querySelector('.loading');
var progress = audioPlayer.querySelector('.progress');
var sliders = audioPlayer.querySelectorAll('.slider');
var volumeBtn = audioPlayer.querySelector('.volume-btn');
var volumeControls = audioPlayer.querySelector('.volume-controls');
var volumeProgress = volumeControls.querySelector('.slider .progress');
var player = audioPlayer.querySelector('audio');
var currentTime = audioPlayer.querySelector('.current-time');
var totalTime = audioPlayer.querySelector('.total-time');
var speaker = audioPlayer.querySelector('#speaker');
</P><P>var draggableClasses = ['pin'];
var currentlyDragged = null;
</P><P>window.addEventListener('mousedown', function (event) {
</P><PRE> if (!isDraggable(event.target)) return false;
</PRE><PRE> currentlyDragged = event.target;
 var handleMethod = currentlyDragged.dataset.method;
</PRE><PRE> this.addEventListener('mousemove', window[handleMethod], false);
</PRE><PRE> window.addEventListener('mouseup', function () {
   currentlyDragged = false;
   window.removeEventListener('mousemove', window[handleMethod], false);
 }, false);
</PRE><P>});
</P><P>playpauseBtn.addEventListener('click', togglePlay);
player.addEventListener('timeupdate', updateProgress);
player.addEventListener('volumechange', updateVolume);
player.addEventListener('loadedmetadata', function () {
</P><PRE> totalTime.textContent = formatTime(player.duration);
</PRE><P>});
player.addEventListener('canplay', makePlay);
player.addEventListener('ended', function () {
</P><PRE> playPause.attributes.d.value = &quot;M18 12L0 24V0&quot;;
 player.currentTime = 0;
</PRE><P>});
</P><P>volumeBtn.addEventListener('click', function () {
</P><PRE> volumeBtn.classList.toggle('open');
 volumeControls.classList.toggle('hidden');
</PRE><P>});
</P><P>window.addEventListener('resize', directionAware);
</P><P>sliders.forEach(function (slider) {
</P><PRE> var pin = slider.querySelector('.pin');
 slider.addEventListener('click', window[pin.dataset.method]);
</PRE><P>});
</P><P>directionAware();
</P><P>function isDraggable(el) {
</P><PRE> var canDrag = false;
 var classes = Array.from(el.classList);
 draggableClasses.forEach(function (draggable) {
   if (classes.indexOf(draggable) !== -1) canDrag = true;
 });
 return canDrag;
</PRE><P>}
</P><P>function inRange(event) {
</P><PRE> var rangeBox = getRangeBox(event);
 var rect = rangeBox.getBoundingClientRect();
 var direction = rangeBox.dataset.direction;
 if (direction == 'horizontal') {
   var min = rangeBox.offsetLeft;
   var max = min + rangeBox.offsetWidth;
   if (event.clientX &lt; min || event.clientX &gt; max) return false;
 } else {
   var min = rect.top;
   var max = min + rangeBox.offsetHeight;
   if (event.clientY &lt; min || event.clientY &gt; max) return false;
 }
 return true;
</PRE><P>}
</P><P>function updateProgress() {
</P><PRE> var current = player.currentTime;
 var percent = current / player.duration * 100;
 progress.style.width = percent + '%';
</PRE><PRE> currentTime.textContent = formatTime(current);
</PRE><P>}
</P><P>function updateVolume() {
</P><PRE> volumeProgress.style.height = player.volume * 100 + '%';
 if (player.volume &gt;= 0.5) {
   speaker.attributes.d.value = 'M14.667 0v2.747c3.853 1.146 6.666 4.72 6.666 8.946 0 4.227-2.813 7.787-6.666 8.934v2.76C20 22.173 24 17.4 24 11.693 24 5.987 20 1.213 14.667 0zM18 11.693c0-2.36-1.333-4.386-3.333-5.373v10.707c2-.947 3.333-2.987 3.333-5.334zm-18-4v8h5.333L12 22.36V1.027L5.333 7.693H0z';
 } else if (player.volume &lt; 0.5 &amp;&amp; player.volume &gt; 0.05) {
   speaker.attributes.d.value = 'M0 7.667v8h5.333L12 22.333V1L5.333 7.667M17.333 11.373C17.333 9.013 16 6.987 14 6v10.707c2-.947 3.333-2.987 3.333-5.334z';
 } else if (player.volume &lt;= 0.05) {
   speaker.attributes.d.value = 'M0 7.667v8h5.333L12 22.333V1L5.333 7.667';
 }
</PRE><P>}
</P><P>function getRangeBox(event) {
</P><PRE> var rangeBox = event.target;
 var el = currentlyDragged;
 if (event.type == 'click' &amp;&amp; isDraggable(event.target)) {
   rangeBox = event.target.parentElement.parentElement;
 }
 if (event.type == 'mousemove') {
   rangeBox = el.parentElement.parentElement;
 }
 return rangeBox;
</PRE><P>}
</P><P>function getCoefficient(event) {
</P><PRE> var slider = getRangeBox(event);
 var rect = slider.getBoundingClientRect();
 var K = 0;
 if (slider.dataset.direction == 'horizontal') {
</PRE><PRE>   var offsetX = event.clientX - slider.offsetLeft;
   var width = slider.clientWidth;
   K = offsetX / width;
 } else if (slider.dataset.direction == 'vertical') {
</PRE><PRE>   var height = slider.clientHeight;
   var offsetY = event.clientY - rect.top;
   K = 1 - offsetY / height;
 }
 return K;
</PRE><P>}
</P><P>function rewind(event) {
</P><PRE> if (inRange(event)) {
   player.currentTime = player.duration * getCoefficient(event);
 }
</PRE><P>}
</P><P>function changeVolume(event) {
</P><PRE> if (inRange(event)) {
   player.volume = getCoefficient(event);
 }
</PRE><P>}
</P><P>function formatTime(time) {
</P><PRE> var min = Math.floor(time / 60);
 var sec = Math.floor(time % 60);
 return min + ':' + (sec &lt; 10 ? '0' + sec : sec);
</PRE><P>}
</P><P>function togglePlay() {
</P><PRE> if (player.paused) {
   playPause.attributes.d.value = &quot;M0 0h6v24H0zM12 0h6v24h-6z&quot;;
   player.play();
 } else {
   playPause.attributes.d.value = &quot;M18 12L0 24V0&quot;;
   player.pause();
 }
</PRE><P>}
</P><P>function makePlay() {
</P><PRE> playpauseBtn.style.display = 'block';
 loading.style.display = 'none';
</PRE><P>}
</P><P>function directionAware() {
</P><PRE> if (window.innerHeight &lt; 250) {
   volumeControls.style.bottom = '-54px';
   volumeControls.style.left = '54px';
 } else if (audioPlayer.offsetTop &lt; 154) {
   volumeControls.style.bottom = '-164px';
   volumeControls.style.left = '-3px';
 } else {
   volumeControls.style.bottom = '52px';
   volumeControls.style.left = '-3px';
 }
</PRE><P>}
</P></DIV></DIV></DIV></DIV></DIV></BODY></HTML>