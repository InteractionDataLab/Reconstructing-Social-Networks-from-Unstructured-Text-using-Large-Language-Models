<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Lund_Modeling_Implementation skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Lund/Modeling/Implementation</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><DIV class="container"><DIV class="navbar-header"><BUTTON type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false"><SPAN class="sr-only">Toggle navigation</SPAN></BUTTON></DIV><DIV class="collapse navbar-collapse" id="navbar-collapse"><UL class="nav navbar-nav navbar-right"><LI id="li_home"><A href="/Team:Lund">Home</A></LI><LI id="li_team" class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Team </A></LI><LI><A href="/Team:Lund/Team">Team</A></LI><LI><A href="/Team:Lund/Collaborations">Collaborations</A></LI><LI><A href="/Team:Lund/Attributions">Attributions</A></LI></UL><LI id="li_project" class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Project </A></LI><LI><A href="/Team:Lund/Description">Description</A></LI><LI><A href="/Team:Lund/Design">Design</A></LI><LI><A href="/Team:Lund/Results">Results</A></LI><LI><A href="/Team:Lund/InterLab">InterLab</A></LI><LI><A href="/Team:Lund/Parts">Parts</A></LI><LI><A href="/Team:Lund/Experiments">Protocols</A></LI><LI><A href="/Team:Lund/Notebook">Notebook</A></LI><LI id="li_model"><A href="/Team:Lund/Model">Model</A></LI><LI id="li_safety"><A href="/Team:Lund/Safety">Safety</A></LI><LI id="li_hp"><A href="/Team:Lund/HP/Silver">Practices</A></LI></DIV></DIV></DIV><HEADER class="modeling-landing"><DIV class="container"><H1 class="display">Modeling</H1></DIV></HEADER><DIV class="container"><UL class="nav nav-pills nav-auto-stacked"><LI role="presentation"><A href="/Team:Lund/Model">Results</A></LI><LI role="presentation"><A href="/Team:Lund/Modeling/ModelDerivation">Model derivation</A></LI><LI role="presentation"><A href="/Team:Lund/Modeling/ParameterEstimation">Parameter estimation</A></LI><LI role="presentation" class="active"><A href="/Team:Lund/Modeling/Implementation">Implementation</A></LI></UL></DIV><DIV id="modeling" class="content-wrapper under-nav text-layout"><DIV class="container"><DIV class="row"><DIV class="col-lg-10"><SECTION><H3 class="section-heading">Overview</H3><P>Numerical reliability and reproducibility is a crucial part of research. In this section we provide a detailed description of the implementation
          of our model.</P></SECTION><SECTION><H3 class="section-heading">Programming environment</H3><P> The entire system was implemented in MATLAB (2017a, The Mathworks Inc.) using the SimBiology<SUPER>©</SUPER> app which provides a block diagram environment for a
          model-based design implementation of biochemical networks. By using drag and drop features, species and reactions are placed in an editor and
          connected to yield a model based representation of the system. The representation then generates code which constitutes to the differential
          equations (or transitions in the case of stochastic modeling) which can be used for simulations. The SimBiology app thus  provides an efficient way
          of building biochemical network models and automatically generate differential equations without the need to manually balance
          reaction fluxes which otherwise can be a highly error prone process.</P><P><I>Fig. 1</I> illustrates our model implemented in the graphical user interface. The diagram consists of  blue boxes, yellow nodes and arrows
          interconnecting the components. The boxes represent the interacting species and the nodes the corresponding reactions. Lines pointing from a specie
          into a node represents a reactant and lines pointing out from a node to a specie represents a product. Dashed lines indicate that the reactant is not
          consumed under the reaction.</P><P>The illustrated system can be subdivided into five parts. The first part (a) illustrates the <I>lacI</I> dynamics which expresses the <I>lac</I>
          repressor. In (b), the IPTG induction of the repressed genes represented by their operons ON and OE is shown. These operons regulate the epression
          of GFP1-9 and GFP10-ER-GFP11 respectively. The NahR pathway is marked by (c) and shows the binding to NahR to the <I>Psal</I> promoter followed by
          the subsequent transcriptional activation by salicylate to yield GFP1-9. In (d), GFP10-ER-GFP11 is translated and activates by the addition of
          estrogen. In the final part (e), the GFP association occurs, yielding a fully restored fluorophore.</P><FIGURE><FIGCAPTION><I>Figure 1: Illustration
            of the SimBiology© implementation of our system. The networks can be considered as five parts (a)-(e) governing the dynamics of separate
            components. Those include the expression of the <I>lac</I> repressor, <I>lac</I> regulation, NahR and GFP10-ER-GFP11 pathway and final GFP
            association respectively.</I></FIGCAPTION></FIGURE></SECTION><SECTION><H3 class="section-heading">Experimental setup</H3><H5>Simulations</H5><P>To properly emulate the working conditions of the cell at the time of addition in the wet lab, the system was run until steady state without the addition of
          inducers. The steady state values were then saved and a new simulation was started using the steady state values as initial concentrations and
          adding IPTG, salicylate and estrogen to induce gene expression. The inital simulation was run with initial concentrations set to zero expect for the
          gene content which was set at 83.2 nM for $\ce{O_N}$, $\ce{O_E}$ and $\ce{I_R}$ (see <A href="/Team:Lund/Modeling/ParameterEstimation">parameter section</A> for details).</P><H5>Calculation of rise time and settling time</H5><P>To measure the responsiveness of the biosensor we used the rise time and settling time as
          measures. The rise time is defined as the time it takes for a signal to go from 10% to 90% of the steady state value. The settling time is defined
          at the time it takes for a signal to fall within 2% of the steady state value. These entities were calculated using the function <I>STEPINFO</I>
          (MATLAB 2017a, The Mathworks Inc.). </P><H5>Calculation of global sensitivities</H5><P>The global sensitivities were calculated using the Sensitivity Analysis Library (SALib, see [1])
          using Python 3.5.3. The method used was the Sobol method which is a variance based sensitivity analysis method. This was chosen because it has been
          recommended to use variance based methods whenever the computational cost is not a problem [2]. The input parameters were chosen by logarithmically
          sampling the parameter space using Saltelli's sampling scheme. For more details, see the <A href="http://salib.readthedocs.io/en/latest/_modules/SALib/sample/saltelli.html">documentation page</A>.</P></SECTION><SECTION><H3 class="section-heading">Implementation details</H3><H5>Choice of ODE solver</H5><P> Since we had parameters differencing with several orders of magnitude, numerical stiffness was expected and a stiff ordinary differential
          equation (ODE) solver had to be used. For this we choose MATLABs solver <I>ODE23t</I> (MATLAB 2017a, The Mathworks Inc.) as it was found to have the
          best performance on our system among the other solvers in the MATLAB ecosystem. This solver is commonly used to solve moderately stiff ODEs and
          uses a variant of the classical trapezoidal rule. </P><H5>Choice of optimization algorithm</H5><P>In performing the parameter estimation, several optimization algorithms were evaluated and tried such as <I>FMINSEARCH</I> (MATLAB 2017a, The
          Mathworks Inc.), <I>LSQNONLIN</I> (MATLAB 2017a, The Mathworks Inc.) and <I>PARTICLESWARM</I> (MATLAB 2017a, The Mathworks Inc.). The function
          <I>LSQNONLIN</I> was chosen as it seemed to perform best. The solver is commonly used to solve nonlinear least square problems and uses the
          Levenberg-Marquart algorithm. All optimizations were run using standard configurations. </P><H5>Simulation parameters</H5><P> To ensure numerically reliable solutions, all simulations were carried out using an absolute error tolerance of 10<SUP>-8</SUP> and carefully
          inspected to keep off spurious solutions. In addition, several solutions were tested against other ODE solvers such as <I>ODE15s</I> (MATLAB 2017a,
          The Mathworks Inc.) to ensure reliability. </P></SECTION><SECTION><H3 class="section-heading">References</H3><BUTTON id="refBtn" class="btn btn-default" type="button" data-toggle="collapse" data-target="#ref" aria-expanded="false" aria-controls="ref">
            Show
          </BUTTON><DIV class="collapse" id="ref"><OL class="references"><LI>[1] Herman, J. and Usher, W. (2017) SALib: An open-source Python library for sensitivity analysis. <I>Journal of Open Source Software</I>, 2(9).</LI><LI>[2] Zi, Z. (2011). Sensitivity analysis approaches applied to systems biology models. <I>IET Systems Biology</I>, 5(6), pp.336-346. </LI></OL></DIV></SECTION></DIV></DIV></DIV></DIV></DIV><FOOTER class="footer"><SECTION class="site-map container"><DIV class="row"><DIV class="col-sm-3"><H5>Home</H5><UL><LI><A href="/Team:Lund">Home</A></LI></UL><H5>Team</H5><UL><LI><A href="/Team:Lund/Team">Team</A></LI><LI><A href="/Team:Lund/Collaborations">Collaborations</A></LI><LI><A href="/Team:Lund/Attributions">Attributions</A></LI></UL></DIV><DIV class="col-sm-3"><H5>Project</H5><UL><LI><A href="/Team:Lund/Description">Description</A></LI><LI><A href="/Team:Lund/Design">Design</A></LI><LI><A href="/Team:Lund/Results">Results</A></LI><LI><A href="/Team:Lund/InterLab">InterLab</A></LI><LI><A href="/Team:Lund/Parts">Parts</A></LI><LI><A href="/Team:Lund/Experiments">Protocol</A></LI><LI><A href="/Team:Lund/Notebook">Notebook</A></LI></UL></DIV><DIV class="col-sm-3"><H5>Model</H5><UL><LI><A href="/Team:Lund/Model">Results</A></LI><LI><A href="/Team:Lund/Modeling/ModelDerivation">Model derivation</A></LI><LI><A href="/Team:Lund/Modeling/ParameterEstimation">Parameter estimation</A></LI><LI><A href="/Team:Lund/Modeling/Implementation">Implementation</A></LI></UL><H5>Safety</H5><UL><LI><A href="/Team:Lund/Safety">Safety</A></LI></UL></DIV><DIV class="col-sm-3"><H5>Practices</H5><UL><LI><A href="/Team:Lund/HP/Silver">Overview</A></LI><LI><A href="/Team:Lund/HP/Gold_Integrated">Integrated</A></LI><LI><A href="/Team:Lund/Engagement">Engagement</A></LI><LI><A href="/Team:Lund/HP/Media">Media</A></LI><LI><A href="/Team:Lund/Communication">Communication</A></LI></UL></DIV></DIV></SECTION><SECTION class="container"><DIV class="row"><DIV class="contact col-sm-3"><H4>Contact</H4>
        Sölvegatan 22 A
        223 62 Lund
        Sweden<A href="mailto:igemlund@gmail.com">igemlund@gmail.com</A></DIV><DIV class="social-media col-sm-3 col-sm-offset-3"><H4>Stay connected</H4><UL><LI><A href="https://www.facebook.com/igemlund" target="_blank">
              Facebook
            </A></LI><LI><A href="https://www.instagram.com/igem_lund" target="_blank">
              Instagram
            </A></LI><LI><A href="https://twitter.com/iGEM_Lund" target="_blank">
              Twitter
            </A></LI></UL></DIV></DIV></SECTION><SECTION class="copyright container">©2017 iGEM Lund
  </SECTION></FOOTER></DIV></DIV></DIV></BODY></HTML>