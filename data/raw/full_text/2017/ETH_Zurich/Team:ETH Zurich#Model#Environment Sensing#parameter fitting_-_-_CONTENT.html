<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_ETH_Zurich_Model_Environment_Sensing_parameter_fitting skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:ETH Zurich/Model/Environment Sensing/parameter fitting</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><DIV id="eth-main-contents" class="eth-main-contents"><HEADER id="header"><NAV><UL class="main-menu col-to-row enlarge-line-height custom_cursor"><LI onclick="return true"><SPAN class="menu-entry">Project Idea</SPAN></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Description">Story of CATE</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Applied_Design">CATE in Action</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Circuit">Circuit</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Design">Design</A></LI></UL><LI onclick="return true"><SPAN class="menu-entry">Engineering</SPAN></LI><LI onclick="return true"><SPAN class="dry">Dry Lab</SPAN></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Model">Overview</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Model/Environment_Sensing">Tumor Sensor</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Model/Heat_Sensor">Heat Sensor</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Model/In_Vivo">3D Model</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Model/In_Silico_Final">Final Integration</A></LI><UL class="subsubmenu"><LI onclick="return true"><SPAN class="wet">Wet Lab</SPAN></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Experiments">Experiments</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Notebook">Lab Journal</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Protocols">Protocols</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Safety">Safety</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Sequences">Sequences</A></LI></UL></NAV></HEADER></DIV><LI onclick="return true"><SPAN class="menu-entry">Achievements</SPAN></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Results">Results</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Parts">Parts</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Medal_Criteria">Medal Criteria</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/InterLab">InterLab</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Collaborations">Collaborations</A></LI><LI onclick="return true"><SPAN class="menu-entry">Human Practices</SPAN></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Human_Practices">Overview</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/HP/Gold_Integrated">Integrated Practices</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/HP/Silver">Public Engagement</A></LI><LI onclick="return true"><SPAN class="menu-entry">Our Team</SPAN></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Attributions">Attributions</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Team">Members</A></LI><LI onclick="return true"><A href="/Team:ETH_Zurich/Sponsors">Sponsors</A></LI><MAIN role="main"><H1 class="headline">Fit the quorum sensing parameters of our system from experiments</H1><SECTION class="first goal"><H1>Goal</H1><P>Once the initial guidelines for the genetic design given <A href="https://2017.igem.org/Team:ETH_Zurich/Model/Environment_Sensing/parameter_space">in a first step</A>, we need to measure on our obtained biological system whether it behaves as intended. Therefore, we will submit it to carefully designed experiments, in order to fit our model on the obtained data and retrieve crucial parameters. The tricky part here is that in a test tube, our system will behave differently than in a tumor, as the repartition of bacteria is not the same and diffusion of AHL does not take place in the lab experiments. We therefore have to extend our model to take this discrepancy into account.</P><P><STRONG>We then fit three of the most important parameters of our system: the expression levels of luxI and luxR, and the P<SUB>lux</SUB> promoter leakiness.</STRONG></P></SECTION><SECTION><DIV class="multi-summary"><DETAILS><SUMMARY>In vitro model extension</SUMMARY><SECTION id="sec1"><P>Compared to the real-life situation happening in the tumor, during our experiments bacteria are in a very different state: they are in bulk in the liquid culture and not in an open solid medium like they would be around the tumor. Therefore, the diffusion of AHL in the test tube does not take place, and some of our equations used before should be adapted to describe the behavior of our circuit when bacteria are in the situation of our lab experiments: only AHL production and degradation happen in the test tubes.</P><SPAN class="math">\[\begin{aligned}
        \frac{\mathrm{d} [\text{AHL}]}{\mathrm{d} t} &amp;= P_{\text{AHL}} - k_{\text{deg}} [\text{AHL}]\end{aligned}\]</SPAN><P>Therefore, once reached the steady state, and thanks to the still valid equation describing AHL production<SPAN class="math">\begin{aligned}P_{\text{AHL}} &amp;= d_{\text{cell}} a_{\text{AHL}} [\text{luxI}]\end{aligned}</SPAN> the level of AHL is now:</P><SPAN class="math">\[\begin{aligned}
        \text{[AHL]} &amp;= \frac{d_{\text{cell}} a_{\text{AHL}} [\text{luxI}]} {k_{\text{deg}}}\end{aligned}\]</SPAN><P>The rest of the model remain unchanged, as it concerns intracellular phenomena that are assumed to happen the same way in vitro than in vivo.
</P></SECTION></DETAILS></DIV><H2 id="od005">Switching OD target for our <IM>in vitro</IM> experiments</H2><P>As an example and guide for our experiments, here is are the two different responses that our system should exhibit according to the <A href="https://2017.igem.org/Team:ETH_Zurich/Model/Environment_Sensing/parameter_space">design guidelines</A> that we produced:</P><FIGURE class="fig-nonfloat" style="maxwidth: 600px;"><FIGCAPTION>Expected activation behavior of the quorum sensing module, in the tumor environment (in vivo) or in a tube (in vitro). The observed difference comes from the fact that no diffusion of AHL happens in the tubes during our experiments, making the activation of the quorum sensing taking place at lower OD.</FIGCAPTION></FIGURE><P><STRONG>We can see that the correction of the model to stick better to the reality of our experiments is essential to correctly lead our experimentations and subsequent data fits. In the in vitro situation, we should aim for an activation of the quorum sensing at OD 0.05.</STRONG></P><H1 id="luxr_fit">LuxR expression fitting</H1><H2>What experiment do we need to fit the expression of LuxR?</H2><P>LuxR is the regulatory protein binding AHL and subsequently activating a promoter where LuxR-AHL tetramers can bind:</P><P>The amount of LuxR present in the cell is crucial to know how much AHL is necessary to fully activate the promoter. And inversely, knowing the AHL dose response curve of the very simple system constituted of the constitutively luxR gene and a fluorescent reporter under the Lux promoter is enough to deduce the amount of LuxR in the bacteria, and therefore their expression level. This is why we have designed and performed <A href="https://2017.igem.org/Team:ETH_Zurich/Experiments/MRI_Contrast_Agent#AHL_dose_resp">an experiment to precisely measure a dose response curve</A> of such a system to be able to fit our luxR expression parameter.</P><DIV class="multi-summary"><DETAILS><SUMMARY>Fitting method</SUMMARY><P>We used the the following process to fit our model to experimental data:</P><OL><LI>From an initial set of parameters for our model, we simulate the response of the system that we should obtain</LI><LI>We quantify the difference (via a cost function) between the model-based response and the actual experimental data</LI><LI>We change the set of parameters in a way that is expected to reduce the cost (with gradient-based method) the and go back to step 1. and iterate</LI></OL><P>Thanks to the MEIGO toolbox already used for our <A href="https://2017.igem.org/Team:ETH_Zurich/Model/Environment_Sensing/parameter_space">parameter search</A>, we do not have to implement this whole process <IT>de novo</IT> but we can focus on the cost function that will be used for the fitting. We built it taking the chi2 test of goodness of fit as a basis, to be able to tell with precision whether our fit is significant or not, obtaining on top of that the uncertainty of the fit of our parameters which arise from experimental variability.</P></DETAILS><DETAILS><SUMMARY>Cost function based on the chi2 test</SUMMARY><P>The most simple way to measure the distance between simulated model data and experimental data is the sum of square of the difference between each couple of point. However, the statistical meaning of this value is not obvious, and it is hard to say from it whether the fit is statistically significant or not. This is why we have implemented a more sophisticated cost function based on the <A href="https://en.wikipedia.org/wiki/Chi-squared_test">chi2 test</A> of goodness of fit, using the the <A href="https://ch.mathworks.com/help/stats/chi2inv.html">chi2inv function</A> provided by Matlab. This cost function takes into account the experimental uncertainty to evaluate whether a fit is significant or not. The cost function is then, with <EM>theo</EM> being the vector of simulated data, <EM>exp</EM> the vector of experimental data, and <EM>σexp</EM> the vector of the standard deviation for each data point (computed from triplicates):
</P><P><SPAN class="math">\[\begin{aligned}
       \text{cost}(theo, exp, \sigma exp) = \frac{\sum_i^N\frac{(exp_i-theo_i)^2}{\sigma exp_i^2}}{\text{chi2inv}(0.95,N)}
       \end{aligned}\]</SPAN></P><P>When this cost is below 1, the fit is considered to be significant, taking into account the experimental uncertainty of the measures. Therefore, the set of parameters corresponding to the lowest obtained cost value will be the center value of the parameter, while the maximum and minimum possible values of the parameter will be the maximal and minimal ones satisfying the condition that the cost is below 1.</P></DETAILS><DETAILS><SUMMARY>Assumptions</SUMMARY><P>We assumed fixed the following parameters of our model, which are considered known well enough from previous characterizations:</P><TABLE><TBODY><TR><TH>Constant</TH><TH>Description</TH><TH>Value</TH><TH>Reference</TH></TR><TR><TD>K_LuxRAHL</TD><TD>LuxR-AHL quadrimer binding constant</TD><TD>5.10<SUP>-10</SUP> nM<SUP>-3</SUP></TD><TD><A href="#bib2" class="forward-ref">[2]</A></TD></TR><TR><TD>d_luxR</TD><TD>LuxR degradation rate</TD><TD>0.023 min<SUP>-1</SUP></TD><TD><A href="#bib3" class="forward-ref">[3]</A></TD></TR><TR><TD>K_luxR</TD><TD>Half-activation LuxR-AHL concentration of the hybrid promoter</TD><TD>5 nM</TD><TD><A href="https://2013.igem.org/Team:ETH_Zurich/Parameter">iGEM ETH 2013</A></TD></TR></TBODY></TABLE></DETAILS></DIV><P>From the experimental data of the AHL dose response curve, we could fit two parameters of our model: the expression level of luxR, and the leakiness of our promoter (both in log scale):</P><FIGURE class="fig-nonfloat" style="maxwidth: 800px;"><FIGCAPTION>Figure 1. Fit of the expression level of luxR. Parameter space fitting the experimental data. Each point represent a parameter vector that significantly fit the experimental data. The blue points fit the data the best (least sum of square) while the yellow ones represent parameters combinations that barely fit the data (but still significant according to the chi2 test of goodness of fit). Fitted parameters are annotated in red. Unfortunately, a very large values of the Hill coefficient of the promoter in regards to LuxR-AHL were possible, thus it could not be fitted.</FIGCAPTION></FIGURE><SECTION class="emphasize"><P>From our statistically significant fit and under the assumptions made, we can gather with a 95% confidence that:</P><OL><LI><P>The expression level of luxR in our system is equal to 41 ± 7 nM.min<SUP>-1</SUP></P><P>Moreover, this expression level is very close to the expression level we aimed at (100 nM.min<SUP>-1</SUP>) during our preliminary parameter space analysis.</P></LI><LI>The leakiness of the P<SUB>Lux</SUB> promoter in our system is equal to 3.9 ± 1.5 %</LI></OL></SECTION></SECTION></MAIN><SECTION id="sec2"><H1>LuxI expression fitting</H1><H2>What experiment do we need to fit the expression of LuxI?</H2><P>LuxI is the enzyme participating to the positive feedback loop by producing AHL that will bind to LuxR and lead to more activation of the promoter controlling the very own expression of luxI, closing the loop of positive feedback.</P><P>The strength of the expression of luxI (especially when at the basal activation, without AHL) is a parameter which strongly influences the bacterial cell density threshold at which our system activates. The same way we could deduce the expression level of luxR from the AHL dose response, we will here infer the expression level of luxI by testing over which bacterial cell density our system gets activated. This would not have been possible without knowing luxR expression first, as both parameters have an influence on the response of our system toward bacterial cell density. To see the response of our system to different cells concentration inputs,  we have designed and performed <A href="https://2017.igem.org/Team:ETH_Zurich/Experiments/Tumor_Sensor#QS_end_point">a quorum sensing end-point experiment</A> to be able to fit our luxI expression parameter.</P><DIV class="multi-summary"><DETAILS><SUMMARY>Assumptions on parameters</SUMMARY><H2>Parameters</H2><P>We assumed fixed the following parameters of our model, which are considered known well enough from previous characterizations, including our own characterization of luxR expression:</P><TABLE><TBODY><TR><TH>Constant</TH><TH>Description</TH><TH>Value</TH><TH>Reference</TH></TR><TR><TD>K_LuxRAHL</TD><TD>LuxR-AHL quadrimer binding constant</TD><TD>5.10<SUP>-10</SUP> nM<SUP>-3</SUP></TD><TD><A href="#bib2" class="forward-ref">[2]</A></TD></TR><TR><TD>d_luxR</TD><TD>LuxR degradation rate</TD><TD>0.023 min<SUP>-1</SUP></TD><TD><A href="#bib3" class="forward-ref">[3]</A></TD></TR><TR><TD>K_luxR</TD><TD>Half-activation LuxR-AHL concentration of the hybrid promoter</TD><TD>5 nM</TD><TD><A href="https://2013.igem.org/Team:ETH_Zurich/Parameter">iGEM ETH 2013</A></TD></TR><TR><TD>a_AHL</TD><TD>AHL synthesis rate by LuxI</TD><TD>0.01 min<SUP>-1</SUP></TD><TD><A href="#bib2" class="forward-ref">[2]</A></TD></TR><TR><TD>k_deg</TD><TD>AHL degradation rate</TD><TD>5.10<SUP>-4</SUP> min<SUP>-1</SUP></TD><TD><A href="#bib4" class="forward-ref">[4]</A></TD></TR><TR><TD>d_luxI</TD><TD>LuxI degradation rate</TD><TD>0.017 min<SUP>-1</SUP></TD><TD><A href="#bib4" class="forward-ref">[4]</A></TD></TR></TBODY></TABLE><P>We will let the value of a_luxR (expression level of luxR) vary between the two bounds that our first characterization has issued. We don't give any bound for k_luxI, the leakiness, as we should be able to fit it again independently.</P></DETAILS><DETAILS id="QS_fitting"><SUMMARY>Interpretation of the experimental data</SUMMARY><P>We were not able to find any significant fit on <A href="https://2017.igem.org/Team:ETH_Zurich/Experiments/Tumor_Sensor#QS_end_point">the raw experimental data</A>. To be able to still get information out of them, we had to consider that the maximal activation of our system was reached by the most dense and most fluorescent bacteria (which grew in high-glucose-content cultures), even though a clear plateau cannot be directly observed on our data (see Figure 3 below). This interpretation of the data was motivated by the hypothesis that fully activated bacteria were experiencing a high metabolic burden preventing them from reaching the OD they should have reached without this burden.</P><FIGURE class="fig-nonfloat" style="maxwidth:700px;"><FIGCAPTION>Figure 3. A) Final absorbance obtained depending on initial glucose concentrations of each culture. B) GFP fluorescence per A600 in response to population density. Colonies were grown over night in media with varying glucose concentrations that lead to different final population densities.</FIGCAPTION></FIGURE><P>In practice, what we did to get exploitable data for our fit is the following: we fitted first a linear model on the first data points (unaffected by any burden) of the A600 vs. glucose to get the OD that each culture should have reached without burden. We used this adjusted OD value in the (therefore adjusted) data to fit our model. Here is how the adjusted data look like:
</P><FIGURE class="fig-nonfloat" style="maxwidth:400px;"><FIGCAPTION>Figure 4. Adjusted data used for the fit of the expression of luxI.</FIGCAPTION></FIGURE><P>Finally, because of the absence of replicates in the data, we had to estimate a meaningful standard deviation to be able to use our cost function for the fitting: we assumed a 25% standard deviation for each measurement point, which is the standard deviation that was observed in the data used to fit the expression of luxR.</P></DETAILS></DIV><P>From the experimental data of the quorum sensing end-point experiment, we could fit two parameters of our model: the expression level of luxI, and once again the leakiness of our promoter (both in log scale):</P><FIGURE class="fig-nonfloat" style="maxwidth: 800px;"><FIGCAPTION>Figure 2. Fit of the expression level of luxI. Parameter space fitting the experimental data. Each point represent a parameter vector that significantly fit the experimental data. The blue points fit the data the best (least sum of square) while the yellow ones represent parameters combinations that barely fit the data (but still significant according to the chi2 test of goodness of fit). Fitted parameters are annotated in red.</FIGCAPTION></FIGURE><SECTION class="emphasize"><P>From our statistically significant fit and under the assumptions made, we can gather with a 95% confidence that:</P><OL><LI>The expression level of luxI in our system is comprised between 1.0 and 6.8 µM.min<SUP>-1</SUP>, with its most probable value being 3.2 µM.min<SUP>-1</SUP></LI><LI>The leakiness of the P<SUB>Lux</SUB> promoter in our system is comprised between 2.0 and 6.2 %, with its most probable value being 3.7 %</LI></OL><P><STRONG>In addition, we can verify that the leakiness of the P<SUB>Lux</SUB> promoter was successfully fitted two times with excellent consistency on two completely different experiments, supporting the validity of our approach and the assumptions we made.</STRONG></P></SECTION></SECTION><SECTION class="references"><H1>References</H1><OL><LI id="bib1"><A href="#ref1">^ </A><A href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2849637/">Vander Heiden, Matthew G., Lewis C. Cantley, and Craig B. Thompson. “Understanding the Warburg Effect: The Metabolic Requirements of Cell Proliferation.” <CITE>Science</CITE> (New York, N.Y.) 324.5930 (2009): 1029–1033. PMC. Web. 18 Oct. 2017.</A></LI><LI id="bib2"><A href="http://www.nature.com/nature/journal/v434/n7037/full/nature03461.html">A synthetic multicellular system for programmed pattern formation Subhayu Basu, Yoram Gerchman, Cynthia H. Collins, Frances H. Arnold &amp; Ron Weiss<SOURCE>Nature</SOURCE> 434, 1130-1134 (28 April 2005) | doi:10.1038/nature03461</A></LI><LI id="bib3"><A href="http://www.sciencedirect.com/science/article/pii/S0303264705001267">A.B. Goryachev, D.J. Toh T.Lee, Systems analysis of a quorum sensing network: Design constraints imposed by the functional requirements, network topology and kinetic constants <SOURCE>Biosystems</SOURCE>, Volume 83, Issues 2–3, February–March 2006, Pages 178-187</A></LI></OL></SECTION><FOOTER id="footerN"><BUTTON onclick="goto_top()" id="goto-top" title="Go to top">Top</BUTTON><A class="sponsor-a" href="/Team:ETH_Zurich/Sponsors">Sponsors</A></FOOTER></DIV></DIV></DIV></DIV></DIV></BODY></HTML>