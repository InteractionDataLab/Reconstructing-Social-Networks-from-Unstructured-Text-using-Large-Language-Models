<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_NAWI_Graz_Robot skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:NAWI Graz/Robot</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><DIV class="menu-navbar"><NAV class="navbar navbar-expand-lg navbar-light bg-light"><DIV class="collapse navbar-collapse" id="navbarNavDropdown"><UL class="navbar-nav ml-auto"><LI class="nav-item dropdown"><DIV class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink"><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Description">Description</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Design">Design</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Demonstrate">Demonstrate</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Model">Model</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Application">Application</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Results">Results</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/InterLab">InterLab Measurement Study</A></DIV></LI><LI class="nav-item dropdown"><A class="nav-link dropdown-toggle" role="button" href="https://2017.igem.org/Team:NAWI_Graz/Hardware" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Components
                </A><DIV class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink"><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Hardware"><SPAN class="top-menu">Parts</SPAN></A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Arena">Arena</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Bioreactor">Bioreactor</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Robot">Robot</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/ControlSystem">Control System</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/TemperatureModule">Temperature Interaction Module</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/TemperaturePlasmid">Temperature Plasmid</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/phInteractionModule">pH Interaction Module</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/pHPlasmid">pH Plasmid</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/FlourescenceChamber">Flourescence Measurement Chamber</A></DIV></LI><LI class="nav-item dropdown"><A class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Team
                </A><DIV class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink"><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Team">NAWI_Graz 2017</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Collaborations">Collaborations</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Attributions">Attributions</A></DIV></LI><LI class="nav-item dropdown"><A class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Lab Book
                </A><DIV class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink"><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Notebook">Notebook</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/WP">Working Protocols</A></DIV></LI><LI class="nav-item dropdown"><A class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Human Practices
                </A><DIV class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink"><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/HP/Silver">Public Engagement</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/HP/Gold">Integrated Human Practices</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Discussions">Discussions</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Education">Education</A><A class="dropdown-item" href="https://2017.igem.org/Team:NAWI_Graz/Interviews">Interviews</A></DIV></LI><LI class="nav-item"><A class="nav-link" href="https://2017.igem.org/Team:NAWI_Graz/Safety">Safety</A></LI></UL><UL class="navbar-nav ml-auto"><LI class="nav-item"><A class="nav-link" href="https://igem.org/2017_Judging_Form?team=NAWI_Graz">Judging Form</A></LI></UL></DIV></NAV></DIV><BUTTON onclick="topFunction()" id="topBtn" class="btn-info" title="Go to top">Go to Top</BUTTON><DIV class="jumbotron"><DIV class="section section-heading container"><H1>The Thymio Robot</H1></DIV><DIV class="section-text container"><P>
The robot, a Thymio II, is a robot designed for educational purposes. All components (hardware and software) are open source. The robot consists of more than 20 sensors, many LEDs, two motors, a microphone and a loudspeaker.
To make the already very powerful tool even more superior we connected a Raspberry Pi to it, allowing us to not only take full control over every aspect of the robot, but also using Python as a programming language for the device.
</P></DIV></DIV><DIV class="section-sub-text container"><B>Fig. 1:</B> Our Thymio robot in action. On its top resides a Raspberry Pi, which is powered by an external power bank.  
        </DIV><DIV class="section container"><H2 class="section-sub">The code</H2><DIV class="section-text container">

The program controlling our robot is relatively simple in principle. It can not only be addressed from the perspective of the robot, but also be considered in its entirety with the reactions of the bioreactor.
First, the robot connects to a network to link to the bioreactor. After that, it initializes its sensors and switches into the main loop. 
Here the robot iterates some commands: 
The robot queries the sensor values ​​of the distance sensors and, depending on a predetermined threshold, rules if there is an object in front of it or not.
If an object has been detected, this information is sent to the reactor (which then pumps a certain amount of bacterial culture into the reaction chamber, where the bacteria are either heated or the pH of their medium is changed).
If no object is detected, this information is also transmitted to the reactor (which then pumps a certain amount of bacterial culture into the reaction chamber, but in this case does not heat or change the pH of the medium).
Thereafter, the robot must wait for a response from the reactor. The reactor pumps the bacterial culture into the measuring chamber and checks whether fluorescent proteins can be detected.
In that case, this information is transmitted to the robot and depending on whether fluorescent proteins were detected (results in a rotation) or not (resulting in a movement forward), the robot reacts. After this reaction a new iteration of the main loop starts. 
This is our code controlling the Thymio:
</DIV><DIV class="column full_size"><DIV style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><TABLE><TBODY><TR><TD><PRE style="margin: 0; line-height: 125%">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209</PRE></TD><TD><PRE style="margin: 0; line-height: 125%"><SPAN style="color: #8f5902; font-style: italic">#!/usr/bin/python2</SPAN><SPAN style="color: #204a87; font-weight: bold">import</SPAN><SPAN style="color: #000000">dbus</SPAN><SPAN style="color: #204a87; font-weight: bold">import</SPAN><SPAN style="color: #000000">dbus.mainloop.glib</SPAN><SPAN style="color: #204a87; font-weight: bold">import</SPAN><SPAN style="color: #000000">gobject</SPAN><SPAN style="color: #204a87; font-weight: bold">import</SPAN><SPAN style="color: #000000">sys</SPAN><SPAN style="color: #204a87; font-weight: bold">import</SPAN><SPAN style="color: #000000">socket</SPAN><SPAN style="color: #204a87; font-weight: bold">import</SPAN><SPAN style="color: #000000">time</SPAN><SPAN style="color: #204a87; font-weight: bold">import</SPAN><SPAN style="color: #000000">logging</SPAN><SPAN style="color: #8f5902; font-style: italic">#from w1thermsensor import W1ThermSensor</SPAN><SPAN style="color: #204a87; font-weight: bold">from</SPAN><SPAN style="color: #000000">optparse</SPAN><SPAN style="color: #204a87; font-weight: bold">import</SPAN><SPAN style="color: #000000">OptionParser</SPAN><SPAN style="color: #8f5902; font-style: italic"># proximity sensor readaout values</SPAN><SPAN style="color: #000000">proxSensorsVal</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">]</SPAN><SPAN style="color: #8f5902; font-style: italic"># server ip and port</SPAN><SPAN style="color: #000000">host</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #4e9a06">'192.168.43.150'</SPAN><SPAN style="color: #000000">port</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #0000cf; font-weight: bold">4343</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">logging</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">getLogger</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'colibot'</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">debug</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #3465a4">False</SPAN><SPAN style="color: #000000">counter</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000">SENSOR_THRESHOLD</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #0000cf; font-weight: bold">3300</SPAN><SPAN style="color: #000000">DRIVE_DIST</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #0000cf; font-weight: bold">400</SPAN><SPAN style="color: #000000">TURN_DIST</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #0000cf; font-weight: bold">180</SPAN><SPAN style="color: #204a87; font-weight: bold">def</SPAN><SPAN style="color: #000000">dbus_reply</SPAN><SPAN style="color: #000000; font-weight: bold">():</SPAN><SPAN style="color: #204a87; font-weight: bold">pass</SPAN><SPAN style="color: #204a87; font-weight: bold">def</SPAN><SPAN style="color: #000000">dbus_error</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">e</SPAN><SPAN style="color: #000000; font-weight: bold">):</SPAN><SPAN style="color: #8f5902; font-style: italic"># logger.info 'error %s'</SPAN><SPAN style="color: #8f5902; font-style: italic"># logger.info str(e)</SPAN><SPAN style="color: #204a87; font-weight: bold">pass</SPAN><SPAN style="color: #204a87; font-weight: bold">def</SPAN><SPAN style="color: #000000">control</SPAN><SPAN style="color: #000000; font-weight: bold">():</SPAN><SPAN style="color: #8f5902; font-style: italic"># get the values of the sensors</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">GetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;prox.horizontal&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">reply_handler</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">get_variables_reply</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">error_handler</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">get_variables_error</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #8f5902; font-style: italic"># send proximity sensor reading to colis</SPAN><SPAN style="color: #000000">reply</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">coli_com</SPAN><SPAN style="color: #000000; font-weight: bold">()</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000">reply</SPAN><SPAN style="color: #ce5c00; font-weight: bold">==</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #204a87; font-weight: bold">for</SPAN><SPAN style="color: #000000">i</SPAN><SPAN style="color: #204a87; font-weight: bold">in</SPAN><SPAN style="color: #204a87">range</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">DRIVE_DIST</SPAN><SPAN style="color: #000000; font-weight: bold">):</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.left.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">100</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.right.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">100</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000">reply</SPAN><SPAN style="color: #ce5c00; font-weight: bold">==</SPAN><SPAN style="color: #0000cf; font-weight: bold">1</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #204a87; font-weight: bold">for</SPAN><SPAN style="color: #000000">i</SPAN><SPAN style="color: #204a87; font-weight: bold">in</SPAN><SPAN style="color: #204a87">range</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">TURN_DIST</SPAN><SPAN style="color: #000000; font-weight: bold">):</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.left.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">100</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.right.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #ce5c00; font-weight: bold">-</SPAN><SPAN style="color: #0000cf; font-weight: bold">100</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.left.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.right.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #204a87; font-weight: bold">return</SPAN><SPAN style="color: #3465a4">True</SPAN><SPAN style="color: #204a87; font-weight: bold">def</SPAN><SPAN style="color: #000000">get_variables_reply</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">r</SPAN><SPAN style="color: #000000; font-weight: bold">):</SPAN><SPAN style="color: #204a87; font-weight: bold">global</SPAN><SPAN style="color: #000000">proxSensorsVal</SPAN><SPAN style="color: #000000">proxSensorsVal</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">r</SPAN><SPAN style="color: #204a87; font-weight: bold">def</SPAN><SPAN style="color: #000000">get_variables_error</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">e</SPAN><SPAN style="color: #000000; font-weight: bold">):</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'error: '</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #204a87">str</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">e</SPAN><SPAN style="color: #000000; font-weight: bold">))</SPAN><SPAN style="color: #000000">loop</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">quit</SPAN><SPAN style="color: #000000; font-weight: bold">()</SPAN><SPAN style="color: #204a87; font-weight: bold">def</SPAN><SPAN style="color: #000000">coli_com</SPAN><SPAN style="color: #000000; font-weight: bold">():</SPAN><SPAN style="color: #204a87; font-weight: bold">global</SPAN><SPAN style="color: #000000">debug</SPAN><SPAN style="color: #000000">sum_prox</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">proxSensorsVal</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">]</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+</SPAN><SPAN style="color: #000000">proxSensorsVal</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">1</SPAN><SPAN style="color: #000000; font-weight: bold">]</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+</SPAN><SPAN style="color: #000000">proxSensorsVal</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">2</SPAN><SPAN style="color: #000000; font-weight: bold">]</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+</SPAN><SPAN style="color: #000000">proxSensorsVal</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">3</SPAN><SPAN style="color: #000000; font-weight: bold">]</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+</SPAN><SPAN style="color: #000000">proxSensorsVal</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">4</SPAN><SPAN style="color: #000000; font-weight: bold">]</SPAN><SPAN style="color: #000000">sides</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">proxSensorsVal</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">]</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+</SPAN><SPAN style="color: #000000">proxSensorsVal</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">4</SPAN><SPAN style="color: #000000; font-weight: bold">]</SPAN><SPAN style="color: #204a87; font-weight: bold">global</SPAN><SPAN style="color: #000000">counter</SPAN><SPAN style="color: #000000">counter</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+=</SPAN><SPAN style="color: #0000cf; font-weight: bold">1</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">counter</SPAN><SPAN style="color: #ce5c00; font-weight: bold">%</SPAN><SPAN style="color: #0000cf; font-weight: bold">2</SPAN><SPAN style="color: #000000; font-weight: bold">):</SPAN><SPAN style="color: #8f5902; font-style: italic"># print(&quot;dirrrrty hack to take every second measurement only&quot;)</SPAN><SPAN style="color: #204a87; font-weight: bold">return</SPAN><SPAN style="color: #0000cf; font-weight: bold">6</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'# # # # # # # # # # # # # # # # #'</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'                         cycle {}'</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">format</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">counter</SPAN><SPAN style="color: #ce5c00; font-weight: bold">/</SPAN><SPAN style="color: #0000cf; font-weight: bold">2</SPAN><SPAN style="color: #000000; font-weight: bold">))</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;Proximity sensor sum: &quot;</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+</SPAN><SPAN style="color: #204a87">str</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">sum_prox</SPAN><SPAN style="color: #000000; font-weight: bold">))</SPAN><SPAN style="color: #204a87; font-weight: bold">try</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">sum_prox</SPAN><SPAN style="color: #ce5c00; font-weight: bold">&gt;</SPAN><SPAN style="color: #000000">SENSOR_THRESHOLD</SPAN><SPAN style="color: #000000; font-weight: bold">):</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;Obstacle detected!&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #204a87; font-weight: bold">not</SPAN><SPAN style="color: #000000">debug</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #8f5902; font-style: italic"># send data to server</SPAN><SPAN style="color: #000000">s</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">sendto</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #204a87">str</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">encode</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'obstacle'</SPAN><SPAN style="color: #000000; font-weight: bold">),</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">host</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">port</SPAN><SPAN style="color: #000000; font-weight: bold">))</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;Sent 'obstacle' to reactor.&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000">debug</SPAN><SPAN style="color: #ce5c00; font-weight: bold">==</SPAN><SPAN style="color: #3465a4">True</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #000000">reply</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #4e9a06">'turn'</SPAN><SPAN style="color: #204a87; font-weight: bold">else</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;No obstacle&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #204a87; font-weight: bold">not</SPAN><SPAN style="color: #000000">debug</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #8f5902; font-style: italic"># send data to server</SPAN><SPAN style="color: #000000">s</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">sendto</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #204a87">str</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">encode</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'clear'</SPAN><SPAN style="color: #000000; font-weight: bold">),</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">host</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">port</SPAN><SPAN style="color: #000000; font-weight: bold">))</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;Sent 'clear' to reactor.&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000">debug</SPAN><SPAN style="color: #ce5c00; font-weight: bold">==</SPAN><SPAN style="color: #3465a4">True</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #000000">reply</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #4e9a06">'drive'</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000">debug</SPAN><SPAN style="color: #ce5c00; font-weight: bold">==</SPAN><SPAN style="color: #3465a4">False</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #8f5902; font-style: italic"># receive data</SPAN><SPAN style="color: #000000">d</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">s</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">recvfrom</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #0000cf; font-weight: bold">1024</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">reply</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">d</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">]</SPAN><SPAN style="color: #000000">addr</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">d</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">1</SPAN><SPAN style="color: #000000; font-weight: bold">]</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'Server reply : '</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+</SPAN><SPAN style="color: #204a87">str</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">reply</SPAN><SPAN style="color: #000000; font-weight: bold">))</SPAN><SPAN style="color: #8f5902; font-style: italic">#        logger.info('Executing ...')</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'                                #'</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'# # # # # # # # # # # # # # # # #'</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">''</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">reply</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">decode</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;utf-8&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #ce5c00; font-weight: bold">==</SPAN><SPAN style="color: #4e9a06">'turn'</SPAN><SPAN style="color: #000000; font-weight: bold">):</SPAN><SPAN style="color: #8f5902; font-style: italic">#            s.sendto(str.encode('thanks'), (host, port))</SPAN><SPAN style="color: #204a87; font-weight: bold">return</SPAN><SPAN style="color: #0000cf; font-weight: bold">1</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">reply</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">decode</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;utf-8&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #ce5c00; font-weight: bold">==</SPAN><SPAN style="color: #4e9a06">'drive'</SPAN><SPAN style="color: #000000; font-weight: bold">):</SPAN><SPAN style="color: #8f5902; font-style: italic">#            s.sendto(str.encode('thanks'), (host, port))            </SPAN><SPAN style="color: #204a87; font-weight: bold">return</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #204a87; font-weight: bold">else</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #204a87; font-weight: bold">return</SPAN><SPAN style="color: #0000cf; font-weight: bold">6</SPAN><SPAN style="color: #204a87; font-weight: bold">except</SPAN><SPAN style="color: #000000">socket</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">error</SPAN><SPAN style="color: #204a87; font-weight: bold">as</SPAN><SPAN style="color: #000000">msg</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'Error Code : '</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+</SPAN><SPAN style="color: #204a87">str</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">msg</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+</SPAN><SPAN style="color: #4e9a06">' Message '</SPAN><SPAN style="color: #ce5c00; font-weight: bold">+</SPAN><SPAN style="color: #000000">msg</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">1</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #204a87; font-weight: bold">def</SPAN><SPAN style="color: #000000">cam_sync_at_start</SPAN><SPAN style="color: #000000; font-weight: bold">():</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.left.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">300</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.right.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">300</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">time</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">sleep</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #0000cf; font-weight: bold">1</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.left.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.right.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.left.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #ce5c00; font-weight: bold">-</SPAN><SPAN style="color: #0000cf; font-weight: bold">300</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.right.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #ce5c00; font-weight: bold">-</SPAN><SPAN style="color: #0000cf; font-weight: bold">300</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">time</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">sleep</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #0000cf; font-weight: bold">1</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.left.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SetVariable</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;thymio-II&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">&quot;motor.right.target&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000; font-weight: bold">[</SPAN><SPAN style="color: #0000cf; font-weight: bold">0</SPAN><SPAN style="color: #000000; font-weight: bold">])</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000">__name__</SPAN><SPAN style="color: #ce5c00; font-weight: bold">==</SPAN><SPAN style="color: #4e9a06">'__main__'</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #8f5902; font-style: italic"># format</SPAN><SPAN style="color: #000000">FORMAT</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #4e9a06">&quot;[%(asctime)s ]   %(message)s&quot;</SPAN><SPAN style="color: #000000">fileHandler</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">logging</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">FileHandler</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'log.txt'</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">fileHandler</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">setFormatter</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">logging</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">Formatter</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">FORMAT</SPAN><SPAN style="color: #000000; font-weight: bold">))</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">addHandler</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">fileHandler</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">logging</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">basicConfig</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">level</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #0000cf; font-weight: bold">20</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">format</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">FORMAT</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">datefmt</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #4e9a06">'%d.%m.%Y %H:%M:%S'</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">parser</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">OptionParser</SPAN><SPAN style="color: #000000; font-weight: bold">()</SPAN><SPAN style="color: #000000">parser</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">add_option</SPAN><SPAN style="color: #000000; font-weight: bold">(&quot;-s&quot;, &quot;--system&quot;, action=&quot;store_true&quot;, dest=&quot;system&quot;,
                      default=False, help=&quot;use the system bus instead of the session bus&quot;)</SPAN><SPAN style="color: #000000">parser</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">add_option</SPAN><SPAN style="color: #000000; font-weight: bold">(&quot;-d&quot;, &quot;--debug&quot;, action=&quot;store_true&quot;, dest=&quot;debug&quot;,
                      default=False)</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">options</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">args</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">parser</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">parse_args</SPAN><SPAN style="color: #000000; font-weight: bold">()</SPAN><SPAN style="color: #000000">dbus</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">mainloop</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">glib</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">DBusGMainLoop</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">set_as_default</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #3465a4">True</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #8f5902; font-style: italic"># use system bus instead of session bus if option is passed</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000">options</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">system</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #000000">bus</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">dbus</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SystemBus</SPAN><SPAN style="color: #000000; font-weight: bold">()</SPAN><SPAN style="color: #204a87; font-weight: bold">else</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #000000">bus</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">dbus</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SessionBus</SPAN><SPAN style="color: #000000; font-weight: bold">()</SPAN><SPAN style="color: #204a87; font-weight: bold">if</SPAN><SPAN style="color: #000000">options</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">debug</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #000000">debug</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #3465a4">True</SPAN><SPAN style="color: #8f5902; font-style: italic"># Create Aseba network</SPAN><SPAN style="color: #000000">network</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">dbus</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">Interface</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">bus</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">get_object</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'ch.epfl.mobots.Aseba'</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #4e9a06">'/'</SPAN><SPAN style="color: #000000; font-weight: bold">),</SPAN><SPAN style="color: #000000">dbus_interface</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #4e9a06">'ch.epfl.mobots.AsebaNetwork'</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #8f5902; font-style: italic"># logger.info in the terminal the name of each Aseba NOde</SPAN><SPAN style="color: #8f5902; font-style: italic">#logger.info(network.GetNodesList())</SPAN><SPAN style="color: #8f5902; font-style: italic"># to sync camera:</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;cam-sync:&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">cam_sync_at_start</SPAN><SPAN style="color: #000000; font-weight: bold">()</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;Start logging&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;###############################&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;   ColiBot Thymio controller   &quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;-------------------------------&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;...        starting:        ...&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #8f5902; font-style: italic"># create dgram udp socket</SPAN><SPAN style="color: #204a87; font-weight: bold">try</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">&quot;Creating socket.&quot;</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">s</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">socket</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">socket</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #000000">socket</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">AF_INET</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">socket</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">SOCK_DGRAM</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #204a87; font-weight: bold">except</SPAN><SPAN style="color: #000000">socket</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">error</SPAN><SPAN style="color: #000000; font-weight: bold">:</SPAN><SPAN style="color: #000000">logger</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">info</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #4e9a06">'Failed to create socket'</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #000000">sys</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">exit</SPAN><SPAN style="color: #000000; font-weight: bold">()</SPAN><SPAN style="color: #8f5902; font-style: italic"># GObject loop</SPAN><SPAN style="color: #8f5902; font-style: italic"># logger.info 'starting loop'</SPAN><SPAN style="color: #000000">loop</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">gobject</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">MainLoop</SPAN><SPAN style="color: #000000; font-weight: bold">()</SPAN><SPAN style="color: #8f5902; font-style: italic"># call the callback of control flow</SPAN><SPAN style="color: #000000">handle</SPAN><SPAN style="color: #ce5c00; font-weight: bold">=</SPAN><SPAN style="color: #000000">gobject</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">timeout_add</SPAN><SPAN style="color: #000000; font-weight: bold">(</SPAN><SPAN style="color: #0000cf; font-weight: bold">1000</SPAN><SPAN style="color: #000000; font-weight: bold">,</SPAN><SPAN style="color: #000000">control</SPAN><SPAN style="color: #000000; font-weight: bold">)</SPAN><SPAN style="color: #8f5902; font-style: italic"># every 0.1 sec</SPAN><SPAN style="color: #000000">loop</SPAN><SPAN style="color: #ce5c00; font-weight: bold">.</SPAN><SPAN style="color: #000000">run</SPAN><SPAN style="color: #000000; font-weight: bold">()</SPAN></PRE></TD></TR></TBODY></TABLE></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>