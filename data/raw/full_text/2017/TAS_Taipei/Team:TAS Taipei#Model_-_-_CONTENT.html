<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_TAS_Taipei_Model skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:TAS Taipei/Model</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><DIV class="return"><H1>X</H1></DIV><DIV class="yellow"><DIV class="box right"><DIV class="box2 right project" href="https://2017.igem.org/Team:TAS_Taipei/Background"><H6 class="navCap">Project</H6></DIV><DIV class="box2 right experiment" href="https://2017.igem.org/Team:TAS_Taipei/Experimental_Summary"><H6 class="navCap">Experiments</H6></DIV><DIV class="box2 right modeling" href="https://2017.igem.org/Team:TAS_Taipei/Model"><H6 class="navCap">Modeling</H6></DIV><DIV class="box2 right prototype" href="https://2017.igem.org/Team:TAS_Taipei/Applied_Design"><H6 class="navCap">Prototype</H6></DIV><DIV class="box2 right policy" href="https://2017.igem.org/Team:TAS_Taipei/Human_Practices"><H6 class="navCap">Human Practices</H6></DIV><DIV class="box2 right biosafety" href="https://2017.igem.org/Team:TAS_Taipei/Safety"><H6 class="navCap">Safety</H6></DIV><DIV class="box2 right about" href="https://2017.igem.org/Team:TAS_Taipei/Team"><H6 class="navCap">About Us</H6></DIV><DIV class="box2 right acknowledgments" href="https://2017.igem.org/Team:TAS_Taipei/Attributions"><H6 class="navCap">Attributions</H6></DIV></DIV><DIV class="blue"><DIV class="box3 left project" href="https://2017.igem.org/Team:TAS_Taipei/Background"><H1>Project</H1></DIV><DIV class="box3 left experiment" href="https://2017.igem.org/Team:TAS_Taipei/Experimental_Summary"><H1>Experiment</H1></DIV><DIV class="box3 left modeling" href="https://2017.igem.org/Team:TAS_Taipei/Model"><H1>Modeling</H1></DIV><DIV class="box3 left prototype" href="https://2017.igem.org/Team:TAS_Taipei/Applied_Design"><H1>Prototype</H1></DIV><DIV class="box3 left policy" href="https://2017.igem.org/Team:TAS_Taipei/Human_Practices"><H1>Human Practice</H1></DIV><DIV class="box3 left biosafety" href="https://2017.igem.org/Team:TAS_Taipei/Safety"><H1>Safety</H1></DIV><DIV class="box3 left about" href="https://2017.igem.org/Team:TAS_Taipei/Team"><H1>About Us</H1></DIV><DIV class="box3 left acknowledgments" href="https://2017.igem.org/Team:TAS_Taipei/Attributions"><H1>Attributions</H1></DIV></DIV></DIV><DIV class="jumbotron" id="modeling-jumbo"><DIV class="container"><H1>Modeling</H1><H4>Computational Biology provides us insight on how to apply experimental data to real world applications!</H4></DIV></DIV><DIV class="cv" id="cv"><DIV class="row"><NAV class="pageNav col-lg-1" id="navbar"><UL class="nav"><LI><A href="#Intro" class="pageNavBig">INTRODUCTION</A></LI><LI><A href="#PR" class="pageNavBig">PR TRAPPING MODEL</A></LI><LI><A href="#LRI" class="pageNavSm">Ligand-receptor interaction</A></LI><LI><A href="#equation" class="pageNavSm">Binding Constants</A></LI><LI><A href="#floCalc" class="pageNavSm">Calculator</A></LI><LI><A href="#app" class="pageNavSm">Example Application</A></LI><LI><A href="#calc" class="pageNavSm">Calculations</A></LI><LI><A href="#bio" class="pageNavBig">BIOFILM TRAPPING MODEL</A></LI><LI><A href="#key" class="pageNavSm">Key Parameters Determination</A></LI><LI><A href="#bioequation" class="pageNavSm">Equation Determination</A></LI><LI><A href="#biocalc" class="pageNavSm">Calculator</A></LI><LI><A href="#bioapp" class="pageNavSm">Example Application</A></LI><LI><A href="#bioresults" class="pageNavSm">Calculations</A></LI><LI><A href="#water" class="pageNavSm">Speed of Water Measurement</A></LI><LI><A href="#Ref" class="pageNavBig">REFERENCES</A></LI></UL></NAV><DIV class="white col-lg-2">
                hi
            </DIV><DIV class="col-lg-10"><HEADER><DIV class="row"><H1 class="name col-lg-12">MODELING</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Our models aim to facilitate the implementation of the two nanoparticle (NP) trapping aspects of our project:
<OL><LI>Proteorhodopsin (PR)-expressing bacteria to trap citrate-coated NPs</LI><LI>Biofilm-coated biocarriers to trap all other NPs</LI></OL> 
Using variables which are common to any wastewater treatment plant (WWTP) -- such as NP concentration, water volume, and water retention time in each tank -- <B>we can determine the amount of bacteria or surface area of biofilm needed to reduce NP concentration in the treated effluent to a desired value.</B></H4></DIV></HEADER><SECTION class="main"><DIV class="row" id="Intro"><H1 class="col-lg-12 title2">INTRODUCTION</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            We aim to implement our NP trapping systems in different steps of the wastewater treatment process. There are several factors that will affect the NP trapping efficiency  for the proteorhodopsin (PR) bacteria and biofilm models. Our PR bacteria would be added to aeration tanks, where water movement is fast and turbulent, while our biofilm (attached to biocarriers), would be placed in the clarifier or sedimentation tanks, where water movement is calmer to keep the biofilm intact. 
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Due to the lack of literature on our proposed NP-trapping techniques using PR and biofilm, experimental trials and our prototype design were integral to the modeling process. Experimental trapping rates from our prototype were used to fit our model to the current trapping abilities of our PR construct (BBa_K2229400) and our biofilm construct (BBa_K2229300). <B>After experimentally determining the rate constants for our PR bacteria and biofilm constructs, the mathematical models can be used to determine two objectives, given an initial NP concentration and a final target NP concentration.    <A href="#floCalc">Objective 1</A>: What PR bacteria concentration is needed in the aeration tanks?    <A href="#biocalc">Objective 2</A>: How many biofilm-coated biocarriers are needed in the sedimentation tank? </B></H4></DIV><DIV class="row" id="PR"><H1 class="title2 col-lg-12">PROTEORHODOPSIN TRAPPING MODEL</H1></DIV><DIV class="row" id="LRI"><H1 class="section-title col-lg-12">Proteorhodopsin and citrate binding modeled as a ligand-receptor interaction</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            To model the binding of PR bacteria to CC-NPs, we used a coarse-grained model for ligand-receptor interaction (<I>Ruiz-Herrero et. al</I> 2013). The model is based on the chemical interaction between a freely diffusing ligand L (nanoparticle), and a cell membrane receptor R (PR bacteria), which combine to form a complex C (nanoparticle-loaded PR bacteria) in the following reaction scheme(Figure 4-1): 
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-10 col-lg-offset-1"><H4 class="subtitle"><B>Figure 4-1 Reaction scheme for PR bacteria and nanoparticles. </B> Our bacteria (R) and nanoparticles (L) bind with the affinity rate k(on) to form the complex C. Conversely, starting with the complex C, nanoparticles fall off bacteria with the dissociation rate k(off).<SPAN class="subCred"> Figure: Justin Y.</SPAN></H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            where k<SUB>on</SUB> is the binding rate constant of our PR bacteria to CC-NPs and k<SUB>off</SUB> is the rate constant of NPs dissociating from PR bacteria.  L, R, and C are all functions of time because our PR bacteria bind to NPs over time, which decreases the concentration of free NPs (L) and available PR bacteria (R) while increasing the concentration of NP-loaded PR bacteria (C). Therefore, we can use the following differential equation to model the progression of NP trapping over time by our PR bacteria: 
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-6 col-lg-offset-3"><H4 class="subtitle">Equation 1: Binding and Dissociation Model</H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            To determine the k<SUB>on</SUB> and k<SUB>off</SUB> rate constants, we fitted our model to match experiments (figures 4-3 and 4-4) that show a decrease in CC-AgNPs when mixed with a known concentration of our PR bacteria (BBa_K2229400).  <B>Determining k<SUB>on</SUB> and k<SUB>off</SUB> rate constants will enable us to use equation 1 and inform WWTPs what concentration of PR bacteria is needed to treat their tanks given a starting NP concentration and desired final NP concentration.</B>  Below, we will explain how we obtained both the k<SUB>on</SUB> and k<SUB>off</SUB> rate constants.
                        </H4></DIV><DIV class="row" id="equation"><H1 class="section-title col-lg-12">Determining NP binding rate (k<SUB>on</SUB>) and dissociation rate (k<SUB>off</SUB>) constants using experimental data</H1></DIV><DIV class="row"><H1 class="section-title-2 col-lg-12">Binding-Only Model (k<SUB>on</SUB> only)</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            We first determined k<SUB>on</SUB> while assuming a best-case scenario where NPs do not fall off of PR once they bind, which means that k<SUB>off</SUB> is zero. Thus, our initial model can be described with the following equation: 
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-4 col-lg-offset-4"><H4 class="subtitle">Equation 2: Binding-Only Model</H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Since the time-dependent functions [L] and [R] for binding between CC-NPs and PR bacteria are unknown in literature, we used finite-difference methods (FDM) to model this equation. (Click <A href="#calc">here</A> to learn more about how we used FDM!) 
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            We obtained k<SUB>on</SUB>, the binding rate constant, from experimental data where CC-AgNPs were mixed with a known concentration of our PR bacteria (BBa_K2229400) (figures 4-2 and 4-3 below). 
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-10 col-lg-offset-1"><H4 class="subtitle"><B>Figure 4-2 The binding rate k<SUB>on</SUB> for our PR bacteria was determined experimentally. </B> A known concentration of our PR bacteria (BBa_K2229400) was mixed with a known concentration of citrate-capped AgNPs, and the decrease in nanoparticle concentration over 5 hours was measured. By inputting the known bacteria and nanoparticle concentrations, we fitted our model to our experimental data to find k<SUB>on</SUB>.<SPAN class="subCred"> Figure: Justin Y.</SPAN></H4><H4 class="subtitle"><B>Figure 4-3 Determining k<SUB>on</SUB>. </B> We obtained k<SUB>on</SUB>, the binding rate constant, from experimental data where CC-AgNPs were mixed with a known concentration of our PR bacteria (BBa_K2229400). <SPAN class="subCred">Experiment: Justin Y</SPAN></H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            To find the k<SUB>on</SUB> value for our PR bacteria, we fitted our model to our experimental data (Click <A href="#rmse">here</A> to learn how we fit our model using RMSE!). 1.9×10-7 µL cells<SUP>-1 </SUP>hr<SUP>-1</SUP> was the k<SUB>on</SUB> value for which the Root Mean Squared Error (RMSE), a measure of the error between the model and the experiment, was the lowest. However, as Figure 4-3 shows, the Binding-Only Model does not reflect how the experimental data reaches an asymptote towards the end of 5 hours. One of the things that may account for this discrepancy between our Binding-Only Model and our experimental data is NPs falling off of the PR bacteria. As we show below, our revised model does a better job of describing the experimental data after accounting for this effect.  Since our Binding-Only Model does not take the NP dissociation rate constant, k<SUB>off</SUB>, into account, we now needed to determine this value.
                        </H4></DIV><DIV class="row"><H1 class="section-title-2 col-lg-12">Binding and Dissociation Model  (k<SUB>on</SUB> and k<SUB>off</SUB>)</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            For the first hour, few NPs are bound by the bacteria and there are many PR receptor sites open, so we assumed that the number of NPs falling off is negligible in the first hour. Thus, we assume that the dissociation rate, k<SUB>off</SUB>, is 0 from t = 0 to t = 1. Based on this assumption, we found a k<SUB>on</SUB> value that fitted our model to the first two points (the first hour) of our experimental data. As the yellow curve (step 2, figure 4-4 below) shows, the model fits the first two data points but falls below the experimental data as time goes on. We assumed that this discrepancy is due to NPs falling off the bacteria. Thus, our next step was finding a k<SUB>off</SUB> value that would fit our model to the asymptotic behavior of our experimental data. 0.32 hr<SUP>-1</SUP> was the k<SUB>off</SUB> value that yielded the lowest RMSE. (Click <A href="#rmse">here</A> to learn how we found k<SUB>off</SUB> using RMSE!). The green curve (step 3 figure 4-4 below) includes this k<SUB>off</SUB> value, and fits our experimental data much better with the lowest RMSE. Thus, our final Binding and Dissociation model includes both k<SUB>on</SUB> and k<SUB>off</SUB>. 
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-8 col-lg-offset-2"><H4 class="subtitle"><B>Figure 4-4 Determining K<SUB>off</SUB> to better fit our model to the experimental data. </B> Binding-only model (blue) does not reflect how the experimental data reaches an asymptote at the end of 5 hours. We assumed that this discrepancy is due to NPs falling off of bacteria. To account for this, we determined a new K<SUB>on</SUB> that fits the first two points of experimental data (yellow), and then we fitted the rest of the curve using a dissociation constant (K<SUB>off</SUB>). The resulting curve (green) including K<SUB>on</SUB> and K<SUB>off</SUB> fits our experimental data much better.</H4></DIV></DIV><DIV class="row" id="floCalc"><H1 class="section-title col-lg-12">CC-NP Trapping by PR Bacteria Calculator</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            We developed two calculators to help WWTPs use our PR bacteria to clean up CC-NPs.  
Calculator 1 allows WWTPs to input their NP concentration, their target NP concentration, and the time water spends in the tank to determine the initial PR bacteria concentration they need to add.
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12"><TABLE><TBODY><TR><TD>Initial NP Concentration (micromolar)</TD></TR><TR><TD>Target NP Concentration (micromolar)</TD></TR><TR><TD>Retention Time (the amount of time water stays in the tank, hours)</TD></TR><TR><TD colspan="2"><BUTTON onclick="calculate3()">Calculate!</BUTTON></TD></TR><TR><TD colspan="2">Initial Bacteria Concentration Needed (# of bacteria/microliter):
 <SPAN id="BacteriaResultConc">   </SPAN></TD></TR></TBODY></TABLE></H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Calculator 2 allows WWTPs to input their NP concentration, PR bacteria concentration they plan to add, and the time water spends in the tank to determine the final NP concentration of the water leaving the tank. 
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12"><TABLE><TBODY><TR><TD>Initial NP Concentration (micromolar)</TD></TR><TR><TD>Initial Bacteria Concentration (# of cells/microliter)</TD></TR><TR><TD>Amount of time that can be used for the process (hours)</TD></TR><TR><TD colspan="2"><BUTTON onclick="calculate2()">Calculate!</BUTTON></TD></TR><TR><TD colspan="2">Resulting NP Concentration (micromolar): <SPAN id="NPResultConc">   </SPAN></TD></TR></TBODY></TABLE></H4></DIV><DIV class="row" id="app"><H1 class="section-title col-lg-12">Example Application of Completed Model</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            We used our Binding and Dissociation model (figure 4-5) to determine the trapping of CC-NP concentration over time by our PR bacteria using the k<SUB>on</SUB> and k<SUB>off</SUB> values above (3.5×10<SUP>-7</SUP> µL cells<SUP>-1</SUP> hr<SUP>-1</SUP> and 0.32 hr<SUP>-1</SUP> respectively) and time intervals of 0.1 hours (click <A href="#whenusing">here</A> to learn why).
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-8 col-lg-offset-2"><H4 class="subtitle"><B>Figure 4-5 Applying our model to our experimental conditions.
</B> We used our Binding and Dissociation model to predict NP trapping for initial conditions that matched those of our experimental trial. The final NP concentration that our model predicts was 0.693 µM, which has a 2.19% error compared to our experimental value, 0.708µM.</H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">          In this example, the initial conditions of L and R were set to the same values as our experimental trial, which means that [NP] = 1.078 µM and [PR bacteria] (at OD600=0.712) = 569600 cells/µL. Under these conditions, our model predicts that NP concentration after 5 hours is 0.693 µM (the percent difference of our modeled value from our experimental value (0.708 µM) is 2.19%). <B>WWTPs can obtain a graph like this one by inputting the variables specific to their treatment plant, such as initial NP concentration and how much time water spends in the tank. </B></H4></DIV><DIV class="row" id="calc"><H1 class="section-title col-lg-12">Calculation Explanations for FDM and RMSE</H1></DIV><DIV class="row" id="calc"><H1 class="section-title-2 col-lg-12">Finite-Difference Method (FDM) Explanation</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            We used Euler’s Method to create our FDM model, and our formulas for the Binding-Only Model are shown below (table 4-1). As the table shows, by plugging in values for L and R at t = 0, a fixed value for k<SUB>on</SUB>, and the time interval Δt, dC/dt = Y<SUB>1</SUB> at t = 0 can be calculated. In other words, we can find the trapping rate at t = 0. As per FDM methods, we assume that the trapping rate is Y<SUB>1</SUB> for t = [0, t<SUB>0</SUB> + Δt] = [0, t<SUB>1</SUB>], so = [NP] trapped during the time interval t = [0, t<SUB>1</SUB>]. Therefore, to find the new L at t = t<SUB>1</SUB>, we subtract (Δt)Y<SUB>1</SUB> from L<SUB>0</SUB> to get L<SUB>1</SUB>. The same process is done for R to find R<SUB>1</SUB> because the decrease in [NP] is directly proportional to the decrease in unsaturated bacteria. Then, using the new values L<SUB>1</SUB> and R<SUB>1</SUB> and the same values of k<SUB>on</SUB> and Δt, a new trapping rate Y<SUB>2</SUB> for t = [0, t<SUB>1</SUB> + Δt] = [0, t<SUB>2</SUB>] is calculated. This process is repeated for each subsequent value of t. 
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-10 col-lg-offset-1"><H4 class="subtitle"><B>Table 4-1 Binding-Only Model Formulas </B> These are the formulas we entered into Excel to run Equation 2 of our model (where k<SUB>off</SUB> = 0) using FDM.</H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Table 4-2 shows a sample of our calculations for the Binding-Only Model using the formulas above, initial L and R conditions that match our experimental trial, the value of k<SUB>on</SUB> determined from experimental data, and Δt = 0.1 up to 1 hour. 
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-10 col-lg-offset-1"><H4 class="subtitle"><B>Table 4-2 Binding-Only Model Calculation Sample 
</B> This table shows the values we got for initial conditions matching our experimental trial, our value of k<SUB>on</SUB>, and time intervals of 0.1 hours going up to t = 1 hour.</H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            At t = 0, no NPs have been trapped and all PR bacteria are available, so we can set L = initial [NP] and R = initial [bacteria], and use these initial conditions to calculate subsequent values. 
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            For our Binding and Dissociation Model, the formulas were modified to include the effect of k<SUB>off</SUB>, which is shown below (table 4-3). This shows one of the advantages of Euler’s Method and other FDM models ‒ the form of dC/dt is adaptable to further variables or complications, and the model can still provide results for complex equations.
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-10 col-lg-offset-1"><H4 class="subtitle"><B>Table 4-3 Binding and Dissociation Model Formulas 
</B> These are the formulas we entered into Excel to run Equation 1 of our model (which incorporates both k<SUB>on</SUB> and k<SUB>off</SUB>) using FDM.</H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Table 4-4 shows a sample of our calculations for the binding and dissociation model using the formulas above, initial L and R conditions that match our experimental trial, the values of k<SUB>on</SUB> and k<SUB>off</SUB> determined from fitting to experimental data, and Δt = 0.1 up to 1 hour. 
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-8 col-lg-offset-2"><H4 class="subtitle"><B>Table 4-4 Binding and Dissociation Model Calculation Sample 
</B> This table shows the values we got for initial conditions matching our experimental trial, our value of k<SUB>on</SUB> and k<SUB>off</SUB>, and time intervals of 0.1 hours going up to t = 1 hour.</H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12" id="whenusing">
                            When using FDM, it is important to keep in mind that values after the set initial conditions are numerical approximations. This means that the larger the value of Δt, the more inaccurate the final result, as shown in figure 4-6.  
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-8 col-lg-offset-2"><H4 class="subtitle"><B>Figure 4-6 Effect of Changing Δt on FDM Calculations
</B> Decreasing Δt means more time interval divisions for a given time frame. This results in a smoother and more accurate curve. Thus, the smaller Δt is, the more accurate the model.<SPAN class="subCred">Figure: Justin Y.</SPAN></H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            For example, Figure 4-7 below shows how the trapping curve changes with different values of Δt. Larger values of Δt result in a final [NP] that is too low. This is because trapping rate is fastest at the beginning (when there are more unbound NPs and unsaturated bacteria), and large values of Δt assume this faster trapping rate for a larger interval of time, thus resulting in a faster decrease in [NP] than if smaller values of Δt were used. To account for error caused by FDM, we ran our model with decreasing values of Δt until there was a negligible difference in final [NP], which was at Δt = 0.1. Since the error due to FDM is negligible for Δt = 0.1, our model used time intervals of Δt = 0.1 hours.  
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-8 col-lg-offset-2"><H4 class="subtitle"><B>Figure 4-7 Determining an appropriate Δt for our model 
</B> We tried four values of Δt (1, 0.5, 0.25, and 0.1), and each resulting curve is shown in the figure. The red curve, which has the largest time intervals (Δt = 1) is the least smooth while the blue curve, which has the smallest time interval (Δt = 0.1) is the smoothest. There is a negligible difference between the green and blue curve on the graph, which means that we can use Δt = 0.1 for our model and assume that error caused by FDM is negligible.</H4></DIV></DIV><DIV class="row" id="rmse"><H1 class="section-title-2 col-lg-12">Minimizing Root Mean Square Error (RMSE) to find k<SUB>on</SUB> and k<SUB>off</SUB></H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            To determine the best fit of our model to our experimental data, we calculated the Root Mean Square Error (RMSE). We did this by squaring the difference between each experimental value and its respective modeling value, averaging these values, and finding the square root. The lower this RMSE value, the better the fit of our model to our experimental data.  
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            For our binding-only model (the blue curve in Figure 4-4), the RMSE was calculated for all of the experimental data points, and we found an initial k<SUB>on</SUB> value that gave the lowest RMSE. For our binding and dissociation model, we first found a new k<SUB>on</SUB> value that fit the first two experimental data points, then found a k<SUB>off</SUB> value that fit the rest of the data points. To find the k<SUB>on</SUB> value, the RMSE was calculated for the first two points. To find the k<SUB>off</SUB> value, the RMSE was calculated for all the points. 
                        </H4></DIV><DIV class="row" id="bio"><H1 class="title2 col-lg-12">BIOFILM TRAPPING MODEL</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Free-floating PR bacteria and biofilm have different characteristics, so we have to consider different variables in our biofilm trapping model. Our goal here is to use mathematical modeling to 1) <B>understand how biofilms interact with NPs</B>, and 2) use this information to <B>predict how many biofilm-coated biocarriers should be used in WWTP sedimentation tanks.</B></H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Based on experiments described below, we first determined that biofilm surface area (SA) is the main factor affecting NP trapping rate. This led us to develop a biofilm trapping model which treats NPs as solutes in wastewater that get trapped as they are carried into the biofilm surface by the movement of water (as shown in Figure 4-8). 
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-8 col-lg-offset-2"><H4 class="subtitle"><B>Figure 4-8 Variables affecting how biofilms trap NPs</B> NPs in wastewater get trapped as they contact a biofilm surface. Therefore, NP trapping depends on the speed of water carrying NPs into a biofilm's surface and the surface area of biofilm.<SPAN class="subCred"> Figure: Justin Y.</SPAN></H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            We modeled this interaction using a differential equation (click <A href="#bioequation">here</A> to see how we derived this equation): 
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            which relates the change in NP concentration to an effective trapping rate constant (k<SUB>trap</SUB>), the speed of the water carrying the NP into the biofilm (S<SUB>water</SUB>), the total surface area of biofilm (SA<SUB>biofilm</SUB>), and the total volume of the treatment container (V<SUB>water total</SUB>).
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            As with the PR bacteria model, we used FDM to solve this equation and ran experiments to find k<SUB>trap</SUB> based on experimentally controlled values of the other variables.
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Finally, we developed two calculators to help WWTPs use our biofilm to clean up NPs.
                        </H4></DIV><DIV class="row" id="key"><H1 class="section-title col-lg-12">Determining Key Parameters of Biofilm-NP Interaction</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            To model our biofilm’s NP trapping rate, we first needed to determine the significance of factors that would affect the biofilm-NP interaction. Initially, we assumed that the <B>surface area (SA) and volume of the biofilm</B> would be the two major factors that affect trapping rate since nanoparticle trapping depends on physical interaction between biofilm and nanoparticles.
                        </H4></DIV><DIV class="row"><H4 class="section-title-2 col-lg-12"><B>Biofilm Volume vs NP Trapping</B></H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            In our experiments, we observed that NPs were trapped in a matrix of biofilm (<A href="https://goo.gl/sjHa41">see our experiment),</A> but we did not know how deep the NPs would travel into the biofilm layer. When we tested 4 different volumes of biofilm for their NP trapping abilities over a period of 5 hours (to mimic WWTP sedimentation tank conditions), we found that volumes greater than 1-1.5 mL—which covered the entire bottom of the cylindrical container—did not significantly improve NP trapping (<A href="https://goo.gl/KFbJcA">see our experiment).</A> This led us to conclude that <B>NPs are not likely to travel through the entire biofilm layer</B>. 
                        </H4></DIV><DIV class="row"><H4 class="section-title-2 col-lg-12"><B>Biofilm Depth vs NP Trapping</B></H4></DIV><DIV class="row"><H4 class="para col-lg-12"><I>Wanner et al.</I> (2006) previously reported that biofilms could only trap particles up to a depth of 200 μm. To see if our own biofilm constructs have a similar trapping depth, we analyzed our volume trial results by converting the biofilm volumes to depths. Since our biofilm is different from the ones used by <I>Wanner et al.</I>, it might have a different maximum depth for trapping NPs.
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            In our experiments, biofilm was added directly to the cylindrical containers, where volume can be found by the equation v=πr<SUP>2</SUP>h. We tested 4 different biofilm volumes, so the height (<I>h</I>) or depth of the biofilm was found by plugging in known values for volume (<I>v</I>) and radius (<I>r</I>). 
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-10 col-lg-offset-1"><H4 class="subtitle"><B>Figure 4-9 Effects of biofilm depth on NP trapping </B> When biofilm depth exceeds a certain limit, depth no longer impacts NP trapping. We experimentally determined that a depth exceeding 1000 μm does not increase our biofilm's NP trapping ability. Thus, we made sure to use a biofilm depth over 1000 μm in our future experiments.</H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            We found that more AuNPs were trapped when the biofilm increased from 500 to 1000 μm, but when the depth exceeded 1000 μm, the amount of AuNPs trapped by our biofilm remained similar (figure 4-9). Therefore, our experimental results agree with the general conclusion of <I>Wanner et al.</I> (2006) that when biofilm depth exceeds a certain limit, depth no longer impacts NP trapping. In future experiments, we made sure to use biofilm with a thickness over 1000 μm (1 mm) to ensure that the depth is not a factor affecting NP trapping. 
                        </H4></DIV><DIV class="row"><H4 class="section-title-2 col-lg-12"><B>Biofilm Surface Area vs NP Trapping</B></H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Our biofilm volume and depth experiments allowed us to conclude that, once biofilm depth exceeds 1000 μm, any additional depth does not affect NP trapping, suggesting that surface area might have a larger effect on trapping rate. To test this, we ran an experiment using two different containers. We assumed that the biofilm surface area exposed to the AuNP solution is equal to the surface area of the containers’ bottoms (10.18 cm<SUP>2</SUP> and 2.01 cm<SUP>2</SUP>). In both containers, biofilm depth exceeded 1000 μm. We found that the <B>higher biofilm surface area resulted in a higher rate of AuNP trapping</B> (figure 4-10).
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-10 col-lg-offset-1"><H4 class="subtitle"><B>Figure 4-10 Increased biofilm surface area leads to a higher rate of AuNP trapping </B> We ran two identical experiments using different biofilm surface areas. Our results show that larger surface areas increase AuNP trapping.</H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Since a larger surface area will trap NPs at a faster rate, we designed biocarriers with a large surface area. Knowing the biofilm surface area needed and the surface area of our biocarrier, we can calculate the number of biocarriers needed to trap a known amount of NPs.
                        </H4></DIV><DIV class="row" id="bioequation"><H1 class="section-title col-lg-12">Modeling Biofilm’s Ability to Trap NPs</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            As long as biofilm depth exceeds 1000 μm, surface area is the main factor that affects NP trapping. We model how surface area affects the NP trapping rate when NPs come into contact with our biofilm. <B>Our model treats NPs as well-mixed solutes that are carried into the biofilm by water</B>. Due to the small mass of NPs, we assume that the speed of NP movement is the same speed as the turbulent water. Hence, knowing the volume of water in contact with our biofilm (V<SUB>water</SUB>) and NP concentration in the water ([NP]), we can determine how many NPs are in contact with our biofilm.
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Since <I>V<SUB>water</SUB></I> is the product of biofilm surface area (<I>SA<SUB>biofilm</SUB></I>), time elapsed (<I>T</I>), and the speed of water in contact with biofilm(<I>S<SUB>water</SUB></I>), our equation becomes: 
      </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            To model how many NPs in contact with biofilm are <B>actually</B> trapped, we added a trapping rate constant <I>k<SUB>trap</SUB></I>, which is a value between 0 (none trapped) and 1 (all NPs in contact with biofilm are trapped):
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            In our model, we also assume that NPs trapped by biofilm would sink into the biofilm matrix, and remain embedded. Thus, we do not have an expression for dissociation of trapped NPs from the biofilm. 

Taking the volume of a sedimentation tank (<I>V<SUB>tank</SUB></I>) into account, we can convert <I>NP<SUB>trapped</SUB></I> in biofilm into NP concentration of water in the sedimentation tank(<I>[NP]</I>). The differential equation below models the change in NP concentration in the tank over time:

                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                           We determined <I>k<SUB>trap</SUB></I> based on experiments with known values for <I>S<SUB>water</SUB></I>, <I>SA<SUB>biofilm</SUB></I>, <I>[NP]<SUB>initial</SUB></I>, and <I>V<SUB>tank</SUB></I>. In these experiments, AuNP solution and a layer of biofilm was added in plastic cylinders to simulate a WWTP sedimentation tank. With a central rotor slowly rotating, we measured the absorbance of the AuNP solution every 20 minutes for a total of 4 hours (<A href="https://2017.igem.org/Team:TAS_Taipei/Notebook">see Modeling in our lab notebook</A>). We then fit our model to our experimental data to find <I>k<SUB>trap</SUB></I>, with the same RMSE method used in our PR model (Figure 4-11; <A href="#bioresults">link to biofilm’s RMSE method</A>).
                        </H4></DIV><DIV class="row"><DIV class="image_container col-lg-10 col-lg-offset-1"><H4 class="subtitle"><B>Figure 4-11 Determining k<SUB>trap</SUB>, the trapping efficiency rate constant.</B> To fit experimental data where AuNP solution interacted with our biofilm, we used RMSE method to minimize error.</H4></DIV></DIV><DIV class="row" id="biocalc"><H1 class="section-title col-lg-12">Biofilm-NP Trapping Calculator</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                           Using our model, we developed two calculators to help WWTPs use our biofilm to clean up NPs. 
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                           Calculator 1 allows WWTPs to input their initial NP concentration (<I>[NP]<SUB>i</SUB></I>), targeted final NP concentration (<I>[NP]<SUB>f</SUB></I>), speed of water in contact with biofilm (<I>S<SUB>water</SUB></I>), total volume of the tank(<I>V<SUB>tank</SUB></I>), and the total time water spends in the tank (T) to determine the surface area of biofilm (<I>SA<SUB>biofilm</SUB></I><SUB><SUB>), which we convert to number of biocarriers needed to reach the targeted final NP concentration. 
                        </SUB></SUB></H4></DIV><DIV class="row" id="BiofilmCalculator2"><H4 class="para col-lg-12"><TABLE><TBODY><TR><TD>Initial NP concentration (micromolar)</TD></TR><TR><TD>Target NP Concentration (micromolar)</TD></TR><TR><TD>Speed of Water in contact with Biofilm (cm/min)</TD></TR><TR><TD>Total Volume of tank (L)</TD></TR><TR><TD>Total time biofilm is in contact with NP solution (minutes)</TD></TR><TR><TD colspan="2"><BUTTON onclick="calculate4()">Calculate!</BUTTON></TD></TR><TR><TD colspan="2"># of biocarriers needed (SA of 44.8 cm<SUP>2</SUP> each): <SPAN id="bioNPResultSA">   </SPAN></TD></TR></TBODY></TABLE></H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                           Calculator 2 allows WWTPs to input their initial NP concentration ([NP]i), speed of water in contact with biofilm (<I>S<SUB>water</SUB></I>), total volume of water (<I>V<SUB>tank</SUB></I>), time water has to spend in the tank (<I>T</I>), and # of biocarriers to determine the final NP concentration.
                        </H4></DIV><DIV class="row" id="BiofilmCalculator"><H4 class="para col-lg-12"><TABLE><TBODY><TR><TD>Initial nanoparticle concentration (micromolar)</TD></TR><TR><TD>Speed of water in contact with biofilm (cm/min)</TD></TR><TR><TD>Total Volume of Container (L)</TD></TR><TR><TD>Time for biofilm to be in contact with NP solution (minutes)</TD></TR><TR><TD># of biocarriers used (SA of 44.8 cm<SUP>2</SUP> each)</TD></TR><TR><TD colspan="2"><BUTTON onclick="calculate()">Calculate!</BUTTON></TD></TR><TR><TD colspan="2">Resulting Nanoparticle Concentration (micromolar): <SPAN id="bioNPResultConc">   </SPAN></TD></TR></TBODY></TABLE></H4></DIV><DIV class="row" id="bioapp"><H1 class="section-title col-lg-12">Example Application of Completed Model</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                           In figure 4-12, we used our model (with a time interval of 5 min-- click <A href="#bioresults">here</A> to learn why) to determine the decrease in [NP] in the water over time using the <I>k<SUB>trap</SUB></I> rate constant of our biofilm. In this example, the initial conditions were set to the same value as our experimental trial:
                           <UL><LI>[NP]<SUB>i</SUB> of 24.628 µM</LI><LI>S<SUB>water</SUB> of 66.72 cm/min</LI><LI>V<SUB>tank</SUB> of 0.310 liters</LI><LI>T of 24 hours</LI><LI>SA<SUB>biofilm</SUB> of 29.22 cm<SUP>2</SUP></LI></UL></H4></DIV><DIV class="row"><DIV class="image_container col-lg-10 col-lg-offset-1"><H4 class="subtitle"><B>Figure 4-12 Change of NP concentration over time </B> Using our biofilm trapping differential equation, we modeled the change of NP concentration over 24 hours using our biofilm.</H4></DIV></DIV><DIV class="row"><H4 class="para col-lg-12">
                           Under these conditions, our model predicts that NP concentration after 24 hours is 5.104 µM (the percent decrease in NP concentration is 79.3%). 
                        </H4></DIV><DIV class="row" id="bioresults"><H1 class="section-title col-lg-12">Calculation Explanation for FDM and RMSE</H1></DIV><DIV class="row"><H1 class="section-title-2 col-lg-12">Finite-Difference Method (FDM) Explanation</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                           As with the PR model, we used Euler’s method to approximate our differential equation. (link to Euler’s method) The main difference between our biofilm FDM model and the PR FDM model are the variables used. For our biofilm FDM model,  we plugged in the variables: the speed of water <I>S<SUB>water</SUB></I>, total volume of water in the tank, the biofilm surface area, a fixed <I>k<SUB>trap</SUB></I> and the initial NP concentration at time t=0. We also used a shorter time interval of Δt = 5 minutes to get a higher accuracy (Figure 4-6). As per FDM methods, we assume that the rate of decrease for NP concentration is approximately constant in each 5 minute interval. The new rate of NP concentration change is determined after each interval according to our biofilm-NP trapping differential equation using the most recent NP concentration. 
Table 3-5 shows a sample of our calculations for the biofilm-NP trapping model in the first hour using initial conditions that match our experimental test. The value of <I>k<SUB>trap</SUB></I>used here is the most accurate trapping efficiency rate constant as found by our RMSE method (<A href="#rmse">link to RMSE</A>). 

                        </H4></DIV><DIV class="row"><H1 class="section-title-2 col-lg-12">Minimizing Root Mean Square Error (RMSE) to find <I>k<SUB>trap</SUB></I></H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                           To determine the best fit of our model to our experimental data, we calculated the Root Mean Square Error (RMSE). We did this by squaring the difference between each experimental value and its respective modeling value, averaging these values, and finding the square root. The lower this RMSE value, the better the fit of our model to our experimental data. For our biofilm-NP trapping model, the RMSE was calculated for all of the experimental data points, and we found a <I>k<SUB>trap</SUB></I> value that gave the lowest RMSE. 
                        </H4></DIV><DIV class="row" id="water"><H1 class="section-title col-lg-12">Experimentally Measuring <I>S<SUB>water</SUB></I></H1></DIV><DIV class="row" id="water"><H1 class="section-title-2 col-lg-12">Dye-Drop Experiment Explanation</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Our biofilm-NP trapping model depends on the speed of water in contact with our biofilm <I>S<SUB>water</SUB></I>. In our experiment, the speed of the water is due to mixing by the central rotor. Since we do not have a precise sensor that can measure this, we designed an experiment using food coloring to determine the speed of water in this setup. We placed biofilm at the bottom of the container, so <I>S<SUB>water</SUB></I> should be equal to the vertical speed of water in the tank.
                        </H4></DIV><DIV class="row"><H4 class="para col-lg-12">
                            We carefully dropped food coloring from the surface of the water, and measured the time it took for any part of the dye to reach the bottom of the container. Dividing the vertical distance of the tank by this elapsed time gave us an approximate <I>S<SUB>water</SUB></I>. 
                        </H4></DIV><DIV class="row" id="Ref"><H1 class="title2 col-lg-12">REFERENCES</H1></DIV><DIV class="row"><H4 class="para col-lg-12">
                            Ruiz-Herrero T, Estrada J, Guantes R &amp; Miguez DG (2013). A Tunable Coarse-Grained Model for Ligand-Receptor Interaction. PLoS Comput Biol 9(11): e1003274. doi:10.1371/journal.pcbi.1003274
Wanner, O., Ebert, H.J., Morgenroth, E., Noguera, D., Picioreanu, C., Rittmann, B.E., Van Loosdrecht, M.C.M., 2006. Mathematical modeling of biofilms. IWA Scientific and Technical Report No. 18, IWA Task Group on Biofilm Modeling

                        </H4></DIV></SECTION></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>