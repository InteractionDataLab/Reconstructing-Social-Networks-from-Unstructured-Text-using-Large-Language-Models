<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_UC_Chile_js_finaljs"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:UC_Chile/js/finaljs">Page               </A></LI><LI><A href="/Talk:Team:UC_Chile/js/finaljs">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:UC_Chile/js/finaljs&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:UC_Chile/js/finaljs&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:UC_Chile/js/finaljs" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:UC Chile/js/finaljs</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2012.igem.org</H3><P>/*********************
//* jQuery Drop Line Menu- By Dynamic Drive: <A href="http://www.dynamicdrive.com/" class="external free" rel="nofollow">http://www.dynamicdrive.com/</A>
//* Last updated: May 9th, 11'
//* Menu avaiable at DD CSS Library: <A href="http://www.dynamicdrive.com/style/" class="external free" rel="nofollow">http://www.dynamicdrive.com/style/</A></P><UL><LI>/
</LI></UL><P>var droplinemenu={
</P><P>/*arrowimage: {classname: 'downarrowclass', src: <I>, leftpadding: 5}, //customize down arrow image*/</I>
animateduration: {over: 80, out: 50}, //duration of slide in/ out animation, in milliseconds
</P><P>buildmenu:function(menuid){
	jQuery(document).ready(function($){
		var $mainmenu=$(&quot;#&quot;+menuid+&quot;&gt;ul&quot;)
		var $headers=$mainmenu.find(&quot;ul&quot;).parent()
		$headers.each(function(i){
			var $curobj=$(this)
			var $subul=$(this).find('ul:eq(0)')
			this._dimensions={h:$curobj.find('a:eq(0)').outerHeight()}
			this.istopheader=$curobj.parents(&quot;ul&quot;).length==1? true : false
			if (!this.istopheader)
				$subul.css({left:0, top:this._dimensions.h})
			var $innerheader=$curobj.children('a').eq(0)
			$innerheader=($innerheader.children().eq(0).is('span'))? $innerheader.children().eq(0) : $innerheader //if header contains inner SPAN, use that
/*			$innerheader.append(
				'&lt;img src=&quot;'+ droplinemenu.arrowimage.src
				+'&quot; class=&quot;' + droplinemenu.arrowimage.classname
				+ '&quot; style=&quot;border:0; padding-left: '+droplinemenu.arrowimage.leftpadding+'px&quot; /&gt;'
			)*/
			$curobj.hoverIntent(
				function(e){
					var $targetul=$(this).children(&quot;ul:eq(0)&quot;)
					if ($targetul.queue().length&lt;=1) //if 1 or less queued animations
						if (this.istopheader)
							$targetul.css({left: $mainmenu.position().left, top: $mainmenu.position().top+this._dimensions.h})
						if (document.all &amp;&amp; !window.XMLHttpRequest) //detect IE6 or less, fix issue with overflow
							$mainmenu.find('ul').css({overflow: (this.istopheader)? 'hidden' : 'visible'})
						$targetul.dequeue().slideDown(droplinemenu.animateduration.over)
				},
				function(e){
					var $targetul=$(this).children(&quot;ul:eq(0)&quot;)
					$targetul.dequeue().slideUp(droplinemenu.animateduration.out)
				}
			) //end hover
		}) //end $headers.each()
		$mainmenu.find(&quot;ul&quot;).css({display:'none', visibility:'visible', width:$mainmenu.width()})
	}) //end document.ready
}
}
</P><PRE>/* jQuery Nivo Slider v2.6
* <A href="http://nivo.dev7studios.com" class="external free" rel="nofollow">http://nivo.dev7studios.com</A>
*
* Copyright 2011, Gilbert Pellegrom
* Free to use and abuse under the MIT license.
* <A href="http://www.opensource.org/licenses/mit-license.php" class="external free" rel="nofollow">http://www.opensource.org/licenses/mit-license.php</A>
* 
* March 2010
*/
</PRE><P>(function($){var NivoSlider=function(element,options){var settings=$.extend({},$.fn.nivoSlider.defaults,options);var vars={currentSlide:0,currentImage:<I>,totalSlides:0,randAnim:</I>,running:false,paused:false,stop:false};var slider=$(element);slider.data('nivo:vars',vars);slider.css('position','relative');slider.addClass('nivoSlider');var kids=slider.children();kids.each(function(){var child=$(this);var link=<I>;if(!child.is('img')){if(child.is('a')){child.addClass('nivo-imageLink');link=child;}</I>
child=child.find('img:first');}
var childWidth=child.width();if(childWidth==0)childWidth=child.attr('width');var childHeight=child.height();if(childHeight==0)childHeight=child.attr('height');if(childWidth&gt;slider.width()){slider.width(childWidth);}
if(childHeight&gt;slider.height()){slider.height(childHeight);}
if(link!=<I>){link.css('display','none');}</I>
child.css('display','none');vars.totalSlides++;});if(settings.startSlide&gt;0){if(settings.startSlide&gt;=vars.totalSlides)settings.startSlide=vars.totalSlides-1;vars.currentSlide=settings.startSlide;}
if($(kids[vars.currentSlide]).is('img')){vars.currentImage=$(kids[vars.currentSlide]);}else{vars.currentImage=$(kids[vars.currentSlide]).find('img:first');}
if($(kids[vars.currentSlide]).is('a')){$(kids[vars.currentSlide]).css('display','block');}
</P>
slider.css('background','url(&quot;'+vars.currentImage.attr('src')+'&quot;) no-repeat');slider.append($('').css({display:'none',opacity:settings.captionOpacity}));var processCaption=function(settings){var nivoCaption=$('.nivo-caption',slider);if(vars.currentImage.attr('title')!=<I>&amp;&amp;vars.currentImage.attr('title')!=undefined){var title=vars.currentImage.attr('title');if(title.substr(0,1)=='#')title=$(title).html();if(nivoCaption.css('display')=='block'){nivoCaption.find('p').fadeOut(settings.animSpeed,function(){$(this).html(title);$(this).fadeIn(settings.animSpeed);});}else{nivoCaption.find('p').html(title);}</I><P>nivoCaption.fadeIn(settings.animSpeed);}else{nivoCaption.fadeOut(settings.animSpeed);}}
processCaption(settings);var timer=0;if(!settings.manualAdvance&amp;&amp;kids.length&gt;1){timer=setInterval(function(){nivoRun(slider,kids,settings,false);},settings.pauseTime);}
</P>
if(settings.directionNav){slider.append('<DIV class="nivo-directionNav">&lt;a class=&quot;nivo-prevNav&quot;&gt;'+settings.prevText+'&lt;/a&gt;&lt;a class=&quot;nivo-nextNav&quot;&gt;'+settings.nextText+'&lt;/a&gt;</DIV>');if(settings.directionNavHide){$('.nivo-directionNav',slider).hide();slider.hover(function(){$('.nivo-directionNav',slider).show();},function(){$('.nivo-directionNav',slider).hide();});}
<P>$('a.nivo-prevNav',slider).live('click',function(){if(vars.running)return false;clearInterval(timer);timer=<I>;vars.currentSlide-=2;nivoRun(slider,kids,settings,'prev');});$('a.nivo-nextNav',slider).live('click',function(){if(vars.running)return false;clearInterval(timer);timer=</I>;nivoRun(slider,kids,settings,'next');});}
</P>
if(settings.controlNav){var nivoControl=$('');slider.append(nivoControl);for(var i=0;i&lt;kids.length;i++){if(settings.controlNavThumbs){var child=kids.eq(i);if(!child.is('img')){child=child.find('img:first');}
<P>if(settings.controlNavThumbsFromRel){nivoControl.append('&lt;a class=&quot;nivo-control&quot; rel=&quot;'+i+'&quot;&gt;&lt;img src=&quot;'+child.attr('rel')+'&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;');}else{nivoControl.append('&lt;a class=&quot;nivo-control&quot; rel=&quot;'+i+'&quot;&gt;&lt;img src=&quot;'+child.attr('src').replace(settings.controlNavThumbsSearch,settings.controlNavThumbsReplace)+'&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;');}}else{nivoControl.append('&lt;a class=&quot;nivo-control&quot; rel=&quot;'+i+'&quot;&gt;'+(i+1)+'&lt;/a&gt;');}}
$('.nivo-controlNav a:eq('+vars.currentSlide+')',slider).addClass('active');$('.nivo-controlNav a',slider).live('click',function(){if(vars.running)return false;if($(this).hasClass('active'))return false;clearInterval(timer);timer=<I>;slider.css('background','url(&quot;'+vars.currentImage.attr('src')+'&quot;) no-repeat');vars.currentSlide=$(this).attr('rel')-1;nivoRun(slider,kids,settings,'control');});}</I>
if(settings.keyboardNav){$(window).keypress(function(event){if(event.keyCode=='37'){if(vars.running)return false;clearInterval(timer);timer=<I>;vars.currentSlide-=2;nivoRun(slider,kids,settings,'prev');}</I>
if(event.keyCode=='39'){if(vars.running)return false;clearInterval(timer);timer=<I>;nivoRun(slider,kids,settings,'next');}});}</I>
if(settings.pauseOnHover){slider.hover(function(){vars.paused=true;clearInterval(timer);timer=<I>;},function(){vars.paused=false;if(timer==</I>&amp;&amp;!settings.manualAdvance){timer=setInterval(function(){nivoRun(slider,kids,settings,false);},settings.pauseTime);}});}
slider.bind('nivo:animFinished',function(){vars.running=false;$(kids).each(function(){if($(this).is('a')){$(this).css('display','none');}});if($(kids[vars.currentSlide]).is('a')){$(kids[vars.currentSlide]).css('display','block');}
if(timer==<I>&amp;&amp;!vars.paused&amp;&amp;!settings.manualAdvance){timer=setInterval(function(){nivoRun(slider,kids,settings,false);},settings.pauseTime);}</I></P>
settings.afterChange.call(this);});var createSlices=function(slider,settings,vars){for(var i=0;i&lt;settings.slices;i++){var sliceWidth=Math.round(slider.width()/settings.slices);if(i==settings.slices-1){slider.append($('').css({left:(sliceWidth*i)+'px',width:(slider.width()-(sliceWidth*i))+'px',height:'0px',opacity:'0',background:'url(&quot;'+vars.currentImage.attr('src')+'&quot;) no-repeat -'+((sliceWidth+(i*sliceWidth))-sliceWidth)+'px 0%'}));}else{slider.append($('').css({left:(sliceWidth*i)+'px',width:sliceWidth+'px',height:'0px',opacity:'0',background:'url(&quot;'+vars.currentImage.attr('src')+'&quot;) no-repeat -'+((sliceWidth+(i*sliceWidth))-sliceWidth)+'px 0%'}));}}}
var createBoxes=function(slider,settings,vars){var boxWidth=Math.round(slider.width()/settings.boxCols);var boxHeight=Math.round(slider.height()/settings.boxRows);for(var rows=0;rows&lt;settings.boxRows;rows++){for(var cols=0;cols&lt;settings.boxCols;cols++){if(cols==settings.boxCols-1){slider.append($('').css({opacity:0,left:(boxWidth*cols)+'px',top:(boxHeight*rows)+'px',width:(slider.width()-(boxWidth*cols))+'px',height:boxHeight+'px',background:'url(&quot;'+vars.currentImage.attr('src')+'&quot;) no-repeat -'+((boxWidth+(cols*boxWidth))-boxWidth)+'px -'+((boxHeight+(rows*boxHeight))-boxHeight)+'px'}));}else{slider.append($('').css({opacity:0,left:(boxWidth*cols)+'px',top:(boxHeight*rows)+'px',width:boxWidth+'px',height:boxHeight+'px',background:'url(&quot;'+vars.currentImage.attr('src')+'&quot;) no-repeat -'+((boxWidth+(cols*boxWidth))-boxWidth)+'px -'+((boxHeight+(rows*boxHeight))-boxHeight)+'px'}));}}}}
<P>var nivoRun=function(slider,kids,settings,nudge){var vars=slider.data('nivo:vars');if(vars&amp;&amp;(vars.currentSlide==vars.totalSlides-1)){settings.lastSlide.call(this);}
if((!vars||vars.stop)&amp;&amp;!nudge)return false;settings.beforeChange.call(this);if(!nudge){slider.css('background','url(&quot;'+vars.currentImage.attr('src')+'&quot;) no-repeat');}else{if(nudge=='prev'){slider.css('background','url(&quot;'+vars.currentImage.attr('src')+'&quot;) no-repeat');}
if(nudge=='next'){slider.css('background','url(&quot;'+vars.currentImage.attr('src')+'&quot;) no-repeat');}}
vars.currentSlide++;if(vars.currentSlide==vars.totalSlides){vars.currentSlide=0;settings.slideshowEnd.call(this);}
if(vars.currentSlide&lt;0)vars.currentSlide=(vars.totalSlides-1);if($(kids[vars.currentSlide]).is('img')){vars.currentImage=$(kids[vars.currentSlide]);}else{vars.currentImage=$(kids[vars.currentSlide]).find('img:first');}
if(settings.controlNav){$('.nivo-controlNav a',slider).removeClass('active');$('.nivo-controlNav a:eq('+vars.currentSlide+')',slider).addClass('active');}
processCaption(settings);$('.nivo-slice',slider).remove();$('.nivo-box',slider).remove();if(settings.effect=='random'){var anims=new Array('sliceDownRight','sliceDownLeft','sliceUpRight','sliceUpLeft','sliceUpDown','sliceUpDownLeft','fold','fade','boxRandom','boxRain','boxRainReverse','boxRainGrow','boxRainGrowReverse');vars.randAnim=anims[Math.floor(Math.random()*(anims.length+1))];if(vars.randAnim==undefined)vars.randAnim='fade';}
if(settings.effect.indexOf(',')!=-1){var anims=settings.effect.split(',');vars.randAnim=anims[Math.floor(Math.random()*(anims.length))];if(vars.randAnim==undefined)vars.randAnim='fade';}
vars.running=true;if(settings.effect=='sliceDown'||settings.effect=='sliceDownRight'||vars.randAnim=='sliceDownRight'||settings.effect=='sliceDownLeft'||vars.randAnim=='sliceDownLeft'){createSlices(slider,settings,vars);var timeBuff=0;var i=0;var slices=$('.nivo-slice',slider);if(settings.effect=='sliceDownLeft'||vars.randAnim=='sliceDownLeft')slices=$('.nivo-slice',slider)._reverse();slices.each(function(){var slice=$(this);slice.css({'top':'0px'});if(i==settings.slices-1){setTimeout(function(){slice.animate({height:'100%',opacity:'1.0'},settings.animSpeed,<I>,function(){slider.trigger('nivo:animFinished');});},(100+timeBuff));}else{setTimeout(function(){slice.animate({height:'100%',opacity:'1.0'},settings.animSpeed);},(100+timeBuff));}</I>
timeBuff+=50;i++;});}
else if(settings.effect=='sliceUp'||settings.effect=='sliceUpRight'||vars.randAnim=='sliceUpRight'||settings.effect=='sliceUpLeft'||vars.randAnim=='sliceUpLeft'){createSlices(slider,settings,vars);var timeBuff=0;var i=0;var slices=$('.nivo-slice',slider);if(settings.effect=='sliceUpLeft'||vars.randAnim=='sliceUpLeft')slices=$('.nivo-slice',slider)._reverse();slices.each(function(){var slice=$(this);slice.css({'bottom':'0px'});if(i==settings.slices-1){setTimeout(function(){slice.animate({height:'100%',opacity:'1.0'},settings.animSpeed,<I>,function(){slider.trigger('nivo:animFinished');});},(100+timeBuff));}else{setTimeout(function(){slice.animate({height:'100%',opacity:'1.0'},settings.animSpeed);},(100+timeBuff));}</I>
timeBuff+=50;i++;});}
else if(settings.effect=='sliceUpDown'||settings.effect=='sliceUpDownRight'||vars.randAnim=='sliceUpDown'||settings.effect=='sliceUpDownLeft'||vars.randAnim=='sliceUpDownLeft'){createSlices(slider,settings,vars);var timeBuff=0;var i=0;var v=0;var slices=$('.nivo-slice',slider);if(settings.effect=='sliceUpDownLeft'||vars.randAnim=='sliceUpDownLeft')slices=$('.nivo-slice',slider)._reverse();slices.each(function(){var slice=$(this);if(i==0){slice.css('top','0px');i++;}else{slice.css('bottom','0px');i=0;}
if(v==settings.slices-1){setTimeout(function(){slice.animate({height:'100%',opacity:'1.0'},settings.animSpeed,<I>,function(){slider.trigger('nivo:animFinished');});},(100+timeBuff));}else{setTimeout(function(){slice.animate({height:'100%',opacity:'1.0'},settings.animSpeed);},(100+timeBuff));}</I>
timeBuff+=50;v++;});}
else if(settings.effect=='fold'||vars.randAnim=='fold'){createSlices(slider,settings,vars);var timeBuff=0;var i=0;$('.nivo-slice',slider).each(function(){var slice=$(this);var origWidth=slice.width();slice.css({top:'0px',height:'100%',width:'0px'});if(i==settings.slices-1){setTimeout(function(){slice.animate({width:origWidth,opacity:'1.0'},settings.animSpeed,<I>,function(){slider.trigger('nivo:animFinished');});},(100+timeBuff));}else{setTimeout(function(){slice.animate({width:origWidth,opacity:'1.0'},settings.animSpeed);},(100+timeBuff));}</I>
timeBuff+=50;i++;});}
else if(settings.effect=='fade'||vars.randAnim=='fade'){createSlices(slider,settings,vars);var firstSlice=$('.nivo-slice:first',slider);firstSlice.css({'height':'100%','width':slider.width()+'px'});firstSlice.animate({opacity:'1.0'},(settings.animSpeed*2),<I>,function(){slider.trigger('nivo:animFinished');});}</I>
else if(settings.effect=='slideInRight'||vars.randAnim=='slideInRight'){createSlices(slider,settings,vars);var firstSlice=$('.nivo-slice:first',slider);firstSlice.css({'height':'100%','width':'0px','opacity':'1'});firstSlice.animate({width:slider.width()+'px'},(settings.animSpeed*2),<I>,function(){slider.trigger('nivo:animFinished');});}</I>
else if(settings.effect=='slideInLeft'||vars.randAnim=='slideInLeft'){createSlices(slider,settings,vars);var firstSlice=$('.nivo-slice:first',slider);firstSlice.css({'height':'100%','width':'0px','opacity':'1','left':<I>,'right':'0px'});firstSlice.animate({width:slider.width()+'px'},(settings.animSpeed*2),</I>,function(){firstSlice.css({'left':'0px','right':<I>});slider.trigger('nivo:animFinished');});}</I>
else if(settings.effect=='boxRandom'||vars.randAnim=='boxRandom'){createBoxes(slider,settings,vars);var totalBoxes=settings.boxCols*settings.boxRows;var i=0;var timeBuff=0;var boxes=shuffle($('.nivo-box',slider));boxes.each(function(){var box=$(this);if(i==totalBoxes-1){setTimeout(function(){box.animate({opacity:'1'},settings.animSpeed,<I>,function(){slider.trigger('nivo:animFinished');});},(100+timeBuff));}else{setTimeout(function(){box.animate({opacity:'1'},settings.animSpeed);},(100+timeBuff));}</I>
timeBuff+=20;i++;});}
else if(settings.effect=='boxRain'||vars.randAnim=='boxRain'||settings.effect=='boxRainReverse'||vars.randAnim=='boxRainReverse'||settings.effect=='boxRainGrow'||vars.randAnim=='boxRainGrow'||settings.effect=='boxRainGrowReverse'||vars.randAnim=='boxRainGrowReverse'){createBoxes(slider,settings,vars);var totalBoxes=settings.boxCols*settings.boxRows;var i=0;var timeBuff=0;var rowIndex=0;var colIndex=0;var box2Darr=new Array();box2Darr[rowIndex]=new Array();var boxes=$('.nivo-box',slider);if(settings.effect=='boxRainReverse'||vars.randAnim=='boxRainReverse'||settings.effect=='boxRainGrowReverse'||vars.randAnim=='boxRainGrowReverse'){boxes=$('.nivo-box',slider)._reverse();}
boxes.each(function(){box2Darr[rowIndex][colIndex]=$(this);colIndex++;if(colIndex==settings.boxCols){rowIndex++;colIndex=0;box2Darr[rowIndex]=new Array();}});for(var cols=0;cols&lt;(settings.boxCols*2);cols++){var prevCol=cols;for(var rows=0;rows&lt;settings.boxRows;rows++){if(prevCol&gt;=0&amp;&amp;prevCol&lt;settings.boxCols){(function(row,col,time,i,totalBoxes){var box=$(box2Darr[row][col]);var w=box.width();var h=box.height();if(settings.effect=='boxRainGrow'||vars.randAnim=='boxRainGrow'||settings.effect=='boxRainGrowReverse'||vars.randAnim=='boxRainGrowReverse'){box.width(0).height(0);}
if(i==totalBoxes-1){setTimeout(function(){box.animate({opacity:'1',width:w,height:h},settings.animSpeed/1.3,<I>,function(){slider.trigger('nivo:animFinished');});},(100+time));}else{setTimeout(function(){box.animate({opacity:'1',width:w,height:h},settings.animSpeed/1.3);},(100+time));}})(rows,prevCol,timeBuff,i,totalBoxes);i++;}</I>
prevCol--;}
timeBuff+=100;}}}
var shuffle=function(arr){for(var j,x,i=arr.length;i;j=parseInt(Math.random()*i),x=arr[--i],arr[i]=arr[j],arr[j]=x);return arr;}
var trace=function(msg){if(this.console&amp;&amp;typeof console.log!=&quot;undefined&quot;)
console.log(msg);}
this.stop=function(){if(!$(element).data('nivo:vars').stop){$(element).data('nivo:vars').stop=true;trace('Stop Slider');}}
this.start=function(){if($(element).data('nivo:vars').stop){$(element).data('nivo:vars').stop=false;trace('Start Slider');}}
settings.afterLoad.call(this);return this;};$.fn.nivoSlider=function(options){return this.each(function(key,value){var element=$(this);if(element.data('nivoslider'))return element.data('nivoslider');var nivoslider=new NivoSlider(this,options);element.data('nivoslider',nivoslider);});};$.fn.nivoSlider.defaults={effect:'random',slices:15,boxCols:8,boxRows:4,animSpeed:500,pauseTime:3000,startSlide:0,directionNav:true,directionNavHide:true,controlNav:true,controlNavThumbs:false,controlNavThumbsFromRel:false,controlNavThumbsSearch:'.jpg',controlNavThumbsReplace:'_thumb.jpg',keyboardNav:true,pauseOnHover:true,manualAdvance:false,captionOpacity:0.8,prevText:'Prev',nextText:'Next',beforeChange:function(){},afterChange:function(){},slideshowEnd:function(){},lastSlide:function(){},afterLoad:function(){}};$.fn._reverse=[].reverse;})(jQuery);
</P><P>
/**
</P><UL><LI> hoverIntent r6 // 2011.02.26 // jQuery 1.5.1+
</LI><LI>&lt;<A href="http://cherne.net/brian/resources/jquery.hoverIntent.html" class="external free" rel="nofollow">http://cherne.net/brian/resources/jquery.hoverIntent.html</A>&gt;</LI><LI> @param  f  onMouseOver function || An object with configuration options
</LI><LI> @param  g  onMouseOut function  || Nothing (use configuration options object)
</LI><LI> @author    Brian Cherne brian(at)cherne(dot)net
</LI><LI>/
</LI></UL><P>(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:400};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))&lt;cfg.sensitivity){$(ob).unbind(&quot;mousemove&quot;,track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type==&quot;mouseenter&quot;){pX=ev.pageX;pY=ev.pageY;$(ob).bind(&quot;mousemove&quot;,track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind(&quot;mousemove&quot;,track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind('mouseenter',handleHover).bind('mouseleave',handleHover)}})(jQuery);
</P><P>
/**
</P><PRE>* jQuery Galleriffic plugin
*
* Copyright (c) 2008 Trent Foley (<A href="http://trentacular.com" class="external free" rel="nofollow">http://trentacular.com</A>)
* Licensed under the MIT License:
*   <A href="http://www.opensource.org/licenses/mit-license.php" class="external free" rel="nofollow">http://www.opensource.org/licenses/mit-license.php</A>
*
* Much thanks to primary contributer Ponticlaro (<A href="http://www.ponticlaro.com" class="external free" rel="nofollow">http://www.ponticlaro.com</A>)
*/
</PRE><DL><DT>(function($) {
</DT></DL><P>	// Globally keep track of all images by their unique hash.  Each item is an image data object.
	var allImages = {};
	var imageCounter = 0;
</P><P>	// Galleriffic static class
	$.galleriffic = {
		version: '2.0.1',
</P><P>		// Strips invalid characters and any leading # characters
		normalizeHash: function(hash) {
			return hash.replace(/^.*#/, <I>).replace(/\?.*$/, </I>);
		},
</P><P>		getImage: function(hash) {
			if (!hash)
				return undefined;
</P><P>			hash = $.galleriffic.normalizeHash(hash);
			return allImages[hash];
		},
</P><P>		// Global function that looks up an image by its hash and displays the image.
		// Returns false when an image is not found for the specified hash.
		// @param {String} hash This is the unique hash value assigned to an image.
		gotoImage: function(hash) {
			var imageData = $.galleriffic.getImage(hash);
			if (!imageData)
				return false;
</P><P>			var gallery = imageData.gallery;
			gallery.gotoImage(imageData);
</P><P>			return true;
		},
</P><P>		// Removes an image from its respective gallery by its hash.
		// Returns false when an image is not found for the specified hash or the
		// specified owner gallery does match the located images gallery.
		// @param {String} hash This is the unique hash value assigned to an image.
		// @param {Object} ownerGallery (Optional) When supplied, the located images
		// gallery is verified to be the same as the specified owning gallery before
		// performing the remove operation.
		removeImageByHash: function(hash, ownerGallery) {
			var imageData = $.galleriffic.getImage(hash);
			if (!imageData)
				return false;
</P><P>			var gallery = imageData.gallery;
			if (ownerGallery &amp;&amp; ownerGallery != gallery)
				return false;
</P><P>			return gallery.removeImageByIndex(imageData.index);
		}
	};
</P><P>	var defaults = {
		delay:                     3000,
		numThumbs:                 20,
		preloadAhead:              40, // Set to -1 to preload all images
		enableTopPager:            false,
		enableBottomPager:         true,
		maxPagesToShow:            7,
		imageContainerSel:         <I>,</I>
		captionContainerSel:       <I>,</I>
		controlsContainerSel:      <I>,</I>
		loadingContainerSel:       <I>,</I>
		renderSSControls:          true,
		renderNavControls:         true,
		playLinkText:              'Play',
		pauseLinkText:             'Pause',
		prevLinkText:              'Previous',
		nextLinkText:              'Next',
		nextPageLinkText:          'Next ›',
		prevPageLinkText:          '‹ Prev',
		enableHistory:             false,
		enableKeyboardNavigation:  true,
		autoStart:                 false,
		syncTransitions:           false,
		defaultTransitionDuration: 1000,
		onSlideChange:             undefined, // accepts a delegate like such: function(prevIndex, nextIndex) { ... }
		onTransitionOut:           undefined, // accepts a delegate like such: function(slide, caption, isSync, callback) { ... }
		onTransitionIn:            undefined, // accepts a delegate like such: function(slide, caption, isSync) { ... }
		onPageTransitionOut:       undefined, // accepts a delegate like such: function(callback) { ... }
		onPageTransitionIn:        undefined, // accepts a delegate like such: function() { ... }
		onImageAdded:              undefined, // accepts a delegate like such: function(imageData, $li) { ... }
		onImageRemoved:            undefined  // accepts a delegate like such: function(imageData, $li) { ... }
	};
</P><P>	// Primary Galleriffic initialization function that should be called on the thumbnail container.
	$.fn.galleriffic = function(settings) {
		//  Extend Gallery Object
		$.extend(this, {
			// Returns the version of the script
			version: $.galleriffic.version,
</P><P>			// Current state of the slideshow
			isSlideshowRunning: false,
			slideshowTimeout: undefined,
</P><P>			// This function is attached to the click event of generated hyperlinks within the gallery
			clickHandler: function(e, link) {
				this.pause();
</P><P>				if (!this.enableHistory) {
					// The href attribute holds the unique hash for an image
					var hash = $.galleriffic.normalizeHash($(link).attr('href'));
					$.galleriffic.gotoImage(hash);
					e.preventDefault();
				}
			},
</P><P>// Appends an image to the end of the set of images.  Argument listItem can be either a jQuery DOM element or arbitrary html.
			// @param listItem Either a jQuery object or a string of html of the list item that is to be added to the gallery.
			appendImage: function(listItem) {
				this.addImage(listItem, false, false);
				return this;
			},
</P><P>			// Inserts an image into the set of images.  Argument listItem can be either a jQuery DOM element or arbitrary html.
			// @param listItem Either a jQuery object or a string of html of the list item that is to be added to the gallery.
			// @param {Integer} position The index within the gallery where the item shouold be added.
			insertImage: function(listItem, position) {
				this.addImage(listItem, false, true, position);
				return this;
			},
</P><P>			// Adds an image to the gallery and optionally inserts/appends it to the DOM (thumbExists)
			// @param listItem Either a jQuery object or a string of html of the list item that is to be added to the gallery.
			// @param {Boolean} thumbExists Specifies whether the thumbnail already exists in the DOM or if it needs to be added.
			// @param {Boolean} insert Specifies whether the the image is appended to the end or inserted into the gallery.
			// @param {Integer} position The index within the gallery where the item shouold be added.
			addImage: function(listItem, thumbExists, insert, position) {
				var $li = ( typeof listItem === &quot;string&quot; ) ? $(listItem) : listItem;				
				var $aThumb = $li.find('a.thumb');
				var slideUrl = $aThumb.attr('href');
				var title = $aThumb.attr('title');
				var $caption = $li.find('.caption').remove();
				var hash = $aThumb.attr('name');
</P><P>				// Increment the image counter
				imageCounter++;
</P><P>				// Autogenerate a hash value if none is present or if it is a duplicate
				if (!hash || allImages[<I>+hash]) {</I>
					hash = imageCounter;
				}
</P><P>				// Set position to end when not specified
				if (!insert)
					position = this.data.length;
</P><P>			var imageData = {
					title:title,
					slideUrl:slideUrl,
					caption:$caption,
					hash:hash,
					gallery:this,
					index:position
				};
</P><P>				// Add the imageData to this gallery's array of images
				if (insert) {
					this.data.splice(position, 0, imageData);
</P><P>					// Reset index value on all imageData objects
					this.updateIndices(position);
				}
				else {
					this.data.push(imageData);
				}
</P><P>				var gallery = this;
</P><P>				// Add the element to the DOM
				if (!thumbExists) {
					// Update thumbs passing in addition post transition out handler
					this.updateThumbs(function() {
						var $thumbsUl = gallery.find('ul.thumbs');
						if (insert)
							$thumbsUl.children(':eq('+position+')').before($li);
						else
							$thumbsUl.append($li);
</P><P>						if (gallery.onImageAdded)
							gallery.onImageAdded(imageData, $li);
					});
				}
</P><P>				// Register the image globally
				allImages[<I>+hash] = imageData;</I></P><P>				// Setup attributes and click handler
				$aThumb.attr('rel', 'history')
					.attr('href', '#'+hash)
					.removeAttr('name')
					.click(function(e) {
						gallery.clickHandler(e, this);
					});
</P><P>				return this;
			},
</P><P>			// Removes an image from the gallery based on its index.
			// Returns false when the index is out of range.
			removeImageByIndex: function(index) {
				if (index &lt; 0 || index &gt;= this.data.length)
					return false;
</P><P>				var imageData = this.data[index];
				if (!imageData)
					return false;
</P><P>				this.removeImage(imageData);
</P><P>				return true;
			},
</P><P>			// Convenience method that simply calls the global removeImageByHash method.
			removeImageByHash: function(hash) {
				return $.galleriffic.removeImageByHash(hash, this);
			},
</P><P>			// Removes an image from the gallery.
			removeImage: function(imageData) {
				var index = imageData.index;
</P><P>				// Remove the image from the gallery data array
				this.data.splice(index, 1);
</P><P>				// Remove the global registration
				delete allImages[<I>+imageData.hash];</I></P><P>				// Remove the image's list item from the DOM
				this.updateThumbs(function() {
					var $li = gallery.find('ul.thumbs')
						.children(':eq('+index+')')
						.remove();
</P><P>					if (gallery.onImageRemoved)
						gallery.onImageRemoved(imageData, $li);
				});
</P><P>				// Update each image objects index value
				this.updateIndices(index);
</P><P>				return this;
			},
</P><P>			// Updates the index values of the each of the images in the gallery after the specified index
			updateIndices: function(startIndex) {
				for (i = startIndex; i &lt; this.data.length; i++) {
					this.data[i].index = i;
				}
</P><P>				return this;
			},
</P><P>			// Scraped the thumbnail container for thumbs and adds each to the gallery
			initializeThumbs: function() {
				this.data = [];
				var gallery = this;
</P><P>				this.find('ul.thumbs &gt; li').each(function(i) {
					gallery.addImage($(this), true, false);
				});
</P><P>				return this;
			},
</P><P>			isPreloadComplete: false,
</P><P>			// Initalizes the image preloader
			preloadInit: function() {
				if (this.preloadAhead == 0) return this;
</P><P>				this.preloadStartIndex = this.currentImage.index;
				var nextIndex = this.getNextIndex(this.preloadStartIndex);
				return this.preloadRecursive(this.preloadStartIndex, nextIndex);
			},
</P><P>			// Changes the location in the gallery the preloader should work
			// @param {Integer} index The index of the image where the preloader should restart at.
			preloadRelocate: function(index) {
				// By changing this startIndex, the current preload script will restart
				this.preloadStartIndex = index;
				return this;
			},
</P><P>			// Recursive function that performs the image preloading
			// @param {Integer} startIndex The index of the first image the current preloader started on.
			// @param {Integer} currentIndex The index of the current image to preload.
			preloadRecursive: function(startIndex, currentIndex) {
				// Check if startIndex has been relocated
				if (startIndex != this.preloadStartIndex) {
					var nextIndex = this.getNextIndex(this.preloadStartIndex);
					return this.preloadRecursive(this.preloadStartIndex, nextIndex);
				}
</P><P>				var gallery = this;
</P><P>				// Now check for preloadAhead count
				var preloadCount = currentIndex - startIndex;
				if (preloadCount &lt; 0)
					preloadCount = this.data.length-1-startIndex+currentIndex;
				if (this.preloadAhead &gt;= 0 &amp;&amp; preloadCount &gt; this.preloadAhead) {
					// Do this in order to keep checking for relocated start index
					setTimeout(function() { gallery.preloadRecursive(startIndex, currentIndex); }, 500);
					return this;
				}
</P><P>				var imageData = this.data[currentIndex];
				if (!imageData)
					return this;
</P><P>				// If already loaded, continue
				if (imageData.image)
					return this.preloadNext(startIndex, currentIndex); 
</P><P>				// Preload the image
				var image = new Image();
</P><P>				image.onload = function() {
					imageData.image = this;
					gallery.preloadNext(startIndex, currentIndex);
				};
</P><P>				image.alt = imageData.title;
				image.src = imageData.slideUrl;
</P><P>				return this;
			},
</P><P>			// Called by preloadRecursive in order to preload the next image after the previous has loaded.
			// @param {Integer} startIndex The index of the first image the current preloader started on.
			// @param {Integer} currentIndex The index of the current image to preload.
			preloadNext: function(startIndex, currentIndex) {
				var nextIndex = this.getNextIndex(currentIndex);
				if (nextIndex == startIndex) {
					this.isPreloadComplete = true;
				} else {
					// Use setTimeout to free up thread
					var gallery = this;
					setTimeout(function() { gallery.preloadRecursive(startIndex, nextIndex); }, 100);
				}
</P><P>				return this;
			},
</P><P>			// Safe way to get the next image index relative to the current image.
			// If the current image is the last, returns 0
			getNextIndex: function(index) {
				var nextIndex = index+1;
				if (nextIndex &gt;= this.data.length)
					nextIndex = 0;
				return nextIndex;
			},
</P><P>			// Safe way to get the previous image index relative to the current image.
			// If the current image is the first, return the index of the last image in the gallery.
			getPrevIndex: function(index) {
				var prevIndex = index-1;
				if (prevIndex &lt; 0)
					prevIndex = this.data.length-1;
				return prevIndex;
			},
</P><P>			// Pauses the slideshow
			pause: function() {
				this.isSlideshowRunning = false;
				if (this.slideshowTimeout) {
					clearTimeout(this.slideshowTimeout);
					this.slideshowTimeout = undefined;
				}
</P><P>				if (this.$controlsContainer) {
					this.$controlsContainer
						.find('div.ss-controls a').removeClass().addClass('play')
						.attr('title', this.playLinkText)
						.attr('href', '#play')
						.html(this.playLinkText);
				}
</P><P>				return this;
			},
</P><P>			// Plays the slideshow
			play: function() {
				this.isSlideshowRunning = true;
</P><P>				if (this.$controlsContainer) {
					this.$controlsContainer
						.find('div.ss-controls a').removeClass().addClass('pause')
						.attr('title', this.pauseLinkText)
						.attr('href', '#pause')
						.html(this.pauseLinkText);
				}
</P><P>				if (!this.slideshowTimeout) {
					var gallery = this;
					this.slideshowTimeout = setTimeout(function() { gallery.ssAdvance(); }, this.delay);
				}
</P><P>				return this;
			},
</P><P>			// Toggles the state of the slideshow (playing/paused)
			toggleSlideshow: function() {
				if (this.isSlideshowRunning)
					this.pause();
				else
					this.play();
</P><P>				return this;
			},
</P><P>			// Advances the slideshow to the next image and delegates navigation to the
			// history plugin when history is enabled
			// enableHistory is true
			ssAdvance: function() {
				if (this.isSlideshowRunning)
					this.next(true);
</P><P>				return this;
			},
</P><P>			// Advances the gallery to the next image.
			// @param {Boolean} dontPause Specifies whether to pause the slideshow.
			// @param {Boolean} bypassHistory Specifies whether to delegate navigation to the history plugin when history is enabled.  
			next: function(dontPause, bypassHistory) {
				this.gotoIndex(this.getNextIndex(this.currentImage.index), dontPause, bypassHistory);
				return this;
			},
</P><P>			// Navigates to the previous image in the gallery.
			// @param {Boolean} dontPause Specifies whether to pause the slideshow.
			// @param {Boolean} bypassHistory Specifies whether to delegate navigation to the history plugin when history is enabled.
			previous: function(dontPause, bypassHistory) {
				this.gotoIndex(this.getPrevIndex(this.currentImage.index), dontPause, bypassHistory);
				return this;
			},
</P><P>			// Navigates to the next page in the gallery.
			// @param {Boolean} dontPause Specifies whether to pause the slideshow.
			// @param {Boolean} bypassHistory Specifies whether to delegate navigation to the history plugin when history is enabled.
			nextPage: function(dontPause, bypassHistory) {
				var page = this.getCurrentPage();
				var lastPage = this.getNumPages() - 1;
				if (page &lt; lastPage) {
					var startIndex = page * this.numThumbs;
					var nextPage = startIndex + this.numThumbs;
					this.gotoIndex(nextPage, dontPause, bypassHistory);
				}
</P><P>				return this;
			},
</P><P>			// Navigates to the previous page in the gallery.
			// @param {Boolean} dontPause Specifies whether to pause the slideshow.
			// @param {Boolean} bypassHistory Specifies whether to delegate navigation to the history plugin when history is enabled.
			previousPage: function(dontPause, bypassHistory) {
				var page = this.getCurrentPage();
				if (page &gt; 0) {
					var startIndex = page * this.numThumbs;
					var prevPage = startIndex - this.numThumbs;				
					this.gotoIndex(prevPage, dontPause, bypassHistory);
				}
</P><P>				return this;
			},
</P><P>			// Navigates to the image at the specified index in the gallery
			// @param {Integer} index The index of the image in the gallery to display.
			// @param {Boolean} dontPause Specifies whether to pause the slideshow.
			// @param {Boolean} bypassHistory Specifies whether to delegate navigation to the history plugin when history is enabled.
			gotoIndex: function(index, dontPause, bypassHistory) {
				if (!dontPause)
					this.pause();
</P><P>				if (index &lt; 0) index = 0;
				else if (index &gt;= this.data.length) index = this.data.length-1;
</P><P>				var imageData = this.data[index];
</P><P>				if (!bypassHistory &amp;&amp; this.enableHistory)
					$.historyLoad(String(imageData.hash));  // At the moment, historyLoad only accepts string arguments
				else
					this.gotoImage(imageData);
</P><P>				return this;
			},
</P><P>			// This function is garaunteed to be called anytime a gallery slide changes.
			// @param {Object} imageData An object holding the image metadata of the image to navigate to.
			gotoImage: function(imageData) {
				var index = imageData.index;
</P><P>				if (this.onSlideChange)
					this.onSlideChange(this.currentImage.index, index);
</P><P>				this.currentImage = imageData;
				this.preloadRelocate(index);
</P><P>				this.refresh();
</P><P>				return this;
			},
</P><P>			// Returns the default transition duration value.  The value is halved when not
			// performing a synchronized transition.
			// @param {Boolean} isSync Specifies whether the transitions are synchronized.
			getDefaultTransitionDuration: function(isSync) {
				if (isSync)
					return this.defaultTransitionDuration;
				return this.defaultTransitionDuration / 2;
			},
</P><P>			// Rebuilds the slideshow image and controls and performs transitions
			refresh: function() {
				var imageData = this.currentImage;
				if (!imageData)
					return this;
</P><P>				var index = imageData.index;
</P><P>				// Update Controls
				if (this.$controlsContainer) {
					this.$controlsContainer
						.find('div.nav-controls a.prev').attr('href', '#'+this.data[this.getPrevIndex(index)].hash).end()
						.find('div.nav-controls a.next').attr('href', '#'+this.data[this.getNextIndex(index)].hash);
				}
</P><P>				var previousSlide = this.$imageContainer.find('span.current').addClass('previous').removeClass('current');
				var previousCaption = 0;
</P><P>				if (this.$captionContainer) {
					previousCaption = this.$captionContainer.find('span.current').addClass('previous').removeClass('current');
				}
</P><P>				// Perform transitions simultaneously if syncTransitions is true and the next image is already preloaded
				var isSync = this.syncTransitions &amp;&amp; imageData.image;
</P><P>				// Flag we are transitioning
				var isTransitioning = true;
				var gallery = this;
</P><P>				var transitionOutCallback = function() {
					// Flag that the transition has completed
					isTransitioning = false;
</P><P>					// Remove the old slide
					previousSlide.remove();
</P><P>					// Remove old caption
					if (previousCaption)
						previousCaption.remove();
</P><P>					if (!isSync) {
						if (imageData.image &amp;&amp; imageData.hash == gallery.data[gallery.currentImage.index].hash) {
							gallery.buildImage(imageData, isSync);
						} else {
							// Show loading container
							if (gallery.$loadingContainer) {
								gallery.$loadingContainer.show();
							}
						}
					}
				};
</P><P>				if (previousSlide.length == 0) {
					// For the first slide, the previous slide will be empty, so we will call the callback immediately
					transitionOutCallback();
				} else {
					if (this.onTransitionOut) {
						this.onTransitionOut(previousSlide, previousCaption, isSync, transitionOutCallback);
					} else {
						previousSlide.fadeTo(this.getDefaultTransitionDuration(isSync), 0.0, transitionOutCallback);
						if (previousCaption)
							previousCaption.fadeTo(this.getDefaultTransitionDuration(isSync), 0.0);
					}
				}
</P><P>				// Go ahead and begin transitioning in of next image
				if (isSync)
					this.buildImage(imageData, isSync);
</P><P>				if (!imageData.image) {
					var image = new Image();
</P><P>					// Wire up mainImage onload event
					image.onload = function() {
						imageData.image = this;
</P><P>						// Only build image if the out transition has completed and we are still on the same image hash
						if (!isTransitioning &amp;&amp; imageData.hash == gallery.data[gallery.currentImage.index].hash) {
							gallery.buildImage(imageData, isSync);
						}
					};
</P><P>					// set alt and src
					image.alt = imageData.title;
					image.src = imageData.slideUrl;
				}
</P><P>				// This causes the preloader (if still running) to relocate out from the currentIndex
				this.relocatePreload = true;
</P><P>				return this.syncThumbs();
			},
</P><P>			// Called by the refresh method after the previous image has been transitioned out or at the same time
			// as the out transition when performing a synchronous transition.
			// @param {Object} imageData An object holding the image metadata of the image to build.
			// @param {Boolean} isSync Specifies whether the transitions are synchronized.
			buildImage: function(imageData, isSync) {
				var gallery = this;
				var nextIndex = this.getNextIndex(imageData.index);
</P><P>				// Construct new hidden span for the image
				var newSlide = this.$imageContainer
					.append('<SPAN class="image-wrapper current">&lt;a class=&quot;advance-link&quot; rel=&quot;history&quot; href=&quot;#'+this.data[nextIndex].hash+'&quot; title=&quot;'+imageData.title+'&quot;&gt; &lt;/a&gt;</SPAN>')
					.find('span.current').css('opacity', '0');
</P><P>				newSlide.find('a')
					.append(imageData.image)
					.click(function(e) {
						gallery.clickHandler(e, this);
					});
</P><P>				var newCaption = 0;
				if (this.$captionContainer) {
					// Construct new hidden caption for the image
					newCaption = this.$captionContainer
						.append('')
						.find('span.current').css('opacity', '0')
						.append(imageData.caption);
				}
</P><P>				// Hide the loading conatiner
				if (this.$loadingContainer) {
					this.$loadingContainer.hide();
				}
</P><P>				// Transition in the new image
				if (this.onTransitionIn) {
					this.onTransitionIn(newSlide, newCaption, isSync);
				} else {
					newSlide.fadeTo(this.getDefaultTransitionDuration(isSync), 1.0);
					if (newCaption)
						newCaption.fadeTo(this.getDefaultTransitionDuration(isSync), 1.0);
				}
</P><P>				if (this.isSlideshowRunning) {
					if (this.slideshowTimeout)
						clearTimeout(this.slideshowTimeout);
</P><P>					this.slideshowTimeout = setTimeout(function() { gallery.ssAdvance(); }, this.delay);
				}
</P><P>				return this;
			},
</P><P>			// Returns the current page index that should be shown for the currentImage
			getCurrentPage: function() {
				return Math.floor(this.currentImage.index / this.numThumbs);
			},
</P><P>			// Applies the selected class to the current image's corresponding thumbnail.
			// Also checks if the current page has changed and updates the displayed page of thumbnails if necessary.
			syncThumbs: function() {
				var page = this.getCurrentPage();
				if (page != this.displayedPage)
					this.updateThumbs();
</P><P>				// Remove existing selected class and add selected class to new thumb
				var $thumbs = this.find('ul.thumbs').children();
				$thumbs.filter('.selected').removeClass('selected');
				$thumbs.eq(this.currentImage.index).addClass('selected');
</P><P>				return this;
			},
</P><P>			// Performs transitions on the thumbnails container and updates the set of
			// thumbnails that are to be displayed and the navigation controls.
			// @param {Delegate} postTransitionOutHandler An optional delegate that is called after
			// the thumbnails container has transitioned out and before the thumbnails are rebuilt.
			updateThumbs: function(postTransitionOutHandler) {
				var gallery = this;
				var transitionOutCallback = function() {
					// Call the Post-transition Out Handler
					if (postTransitionOutHandler)
						postTransitionOutHandler();
</P><P>					gallery.rebuildThumbs();
</P><P>					// Transition In the thumbsContainer
					if (gallery.onPageTransitionIn)
						gallery.onPageTransitionIn();
					else
						gallery.show();
				};
</P><P>				// Transition Out the thumbsContainer
				if (this.onPageTransitionOut) {
					this.onPageTransitionOut(transitionOutCallback);
				} else {
					this.hide();
					transitionOutCallback();
				}
</P><P>				return this;
			},
</P><P>			// Updates the set of thumbnails that are to be displayed and the navigation controls.
			rebuildThumbs: function() {
				var needsPagination = this.data.length &gt; this.numThumbs;
</P><P>				// Rebuild top pager
				if (this.enableTopPager) {
					var $topPager = this.find('div.top');
					if ($topPager.length == 0)
</P>
						$topPager = this.prepend('').find('div.top');
<P>					else
						$topPager.empty();
</P><P>					if (needsPagination)
						this.buildPager($topPager);
				}
</P><P>				// Rebuild bottom pager
				if (this.enableBottomPager) {
					var $bottomPager = this.find('div.bottom');
					if ($bottomPager.length == 0)
</P>
						$bottomPager = this.append('').find('div.bottom');
<P>					else
						$bottomPager.empty();
</P><P>					if (needsPagination)
						this.buildPager($bottomPager);
				}
</P><P>				var page = this.getCurrentPage();
				var startIndex = page*this.numThumbs;
				var stopIndex = startIndex+this.numThumbs-1;
				if (stopIndex &gt;= this.data.length)
					stopIndex = this.data.length-1;
</P><P>				// Show/Hide thumbs
				var $thumbsUl = this.find('ul.thumbs');
				$thumbsUl.find('li').each(function(i) {
					var $li = $(this);
					if (i &gt;= startIndex &amp;&amp; i &lt;= stopIndex) {
						$li.show();
					} else {
						$li.hide();
					}
				});
</P><P>				this.displayedPage = page;
</P><P>				// Remove the noscript class from the thumbs container ul
				$thumbsUl.removeClass('noscript');
</P><P>				return this;
			},
</P><P>			// Returns the total number of pages required to display all the thumbnails.
			getNumPages: function() {
				return Math.ceil(this.data.length/this.numThumbs);
			},
</P><P>			// Rebuilds the pager control in the specified matched element.
			// @param {jQuery} pager A jQuery element set matching the particular pager to be rebuilt.
			buildPager: function(pager) {
				var gallery = this;
				var numPages = this.getNumPages();
				var page = this.getCurrentPage();
				var startIndex = page * this.numThumbs;
				var pagesRemaining = this.maxPagesToShow - 1;
</P><P>				var pageNum = page - Math.floor((this.maxPagesToShow - 1) / 2) + 1;
				if (pageNum &gt; 0) {
					var remainingPageCount = numPages - pageNum;
					if (remainingPageCount &lt; pagesRemaining) {
						pageNum = pageNum - (pagesRemaining - remainingPageCount);
					}
				}
</P><P>				if (pageNum &lt; 0) {
					pageNum = 0;
				}
</P><P>				// Prev Page Link
				if (page &gt; 0) {
					var prevPage = startIndex - this.numThumbs;
					pager.append('&lt;a rel=&quot;history&quot; href=&quot;#'+this.data[prevPage].hash+'&quot; title=&quot;'+this.prevPageLinkText+'&quot;&gt;'+this.prevPageLinkText+'&lt;/a&gt;');
				}
</P><P>				// Create First Page link if needed
				if (pageNum &gt; 0) {
					this.buildPageLink(pager, 0, numPages);
					if (pageNum &gt; 1)
						pager.append('<SPAN class="ellipsis">…</SPAN>');
</P><P>					pagesRemaining--;
				}
</P><P>				// Page Index Links
				while (pagesRemaining &gt; 0) {
					this.buildPageLink(pager, pageNum, numPages);
					pagesRemaining--;
					pageNum++;
				}
</P><P>				// Create Last Page link if needed
				if (pageNum &lt; numPages) {
					var lastPageNum = numPages - 1;
					if (pageNum &lt; lastPageNum)
						pager.append('<SPAN class="ellipsis">…</SPAN>');
</P><P>					this.buildPageLink(pager, lastPageNum, numPages);
				}
</P><P>				// Next Page Link
				var nextPage = startIndex + this.numThumbs;
				if (nextPage &lt; this.data.length) {
					pager.append('&lt;a rel=&quot;history&quot; href=&quot;#'+this.data[nextPage].hash+'&quot; title=&quot;'+this.nextPageLinkText+'&quot;&gt;'+this.nextPageLinkText+'&lt;/a&gt;');
				}
</P><P>				pager.find('a').click(function(e) {
					gallery.clickHandler(e, this);
				});
</P><P>				return this;
			},
</P><P>			// Builds a single page link within a pager.  This function is called by buildPager
			// @param {jQuery} pager A jQuery element set matching the particular pager to be rebuilt.
			// @param {Integer} pageNum The page number of the page link to build.
			// @param {Integer} numPages The total number of pages required to display all thumbnails.
			buildPageLink: function(pager, pageNum, numPages) {
				var pageLabel = pageNum + 1;
				var currentPage = this.getCurrentPage();
				if (pageNum == currentPage)
					pager.append('<SPAN class="current">'+pageLabel+'</SPAN>');
				else if (pageNum &lt; numPages) {
					var imageIndex = pageNum*this.numThumbs;
					pager.append('&lt;a rel=&quot;history&quot; href=&quot;#'+this.data[imageIndex].hash+'&quot; title=&quot;'+pageLabel+'&quot;&gt;'+pageLabel+'&lt;/a&gt;');
				}
</P><P>				return this;
			}
		});
</P><P>		// Now initialize the gallery
		$.extend(this, defaults, settings);
</P><P>		// Verify the history plugin is available
		if (this.enableHistory &amp;&amp; !$.historyInit)
			this.enableHistory = false;
</P><P>		// Select containers
		if (this.imageContainerSel) this.$imageContainer = $(this.imageContainerSel);
		if (this.captionContainerSel) this.$captionContainer = $(this.captionContainerSel);
		if (this.loadingContainerSel) this.$loadingContainer = $(this.loadingContainerSel);
</P><P>		// Initialize the thumbails
		this.initializeThumbs();
</P><P>		if (this.maxPagesToShow &lt; 3)
			this.maxPagesToShow = 3;
</P><P>		this.displayedPage = -1;
		this.currentImage = this.data[0];
		var gallery = this;
</P><P>		// Hide the loadingContainer
		if (this.$loadingContainer)
			this.$loadingContainer.hide();
</P><P>		// Setup controls
		if (this.controlsContainerSel) {
			this.$controlsContainer = $(this.controlsContainerSel).empty();
</P><P>			if (this.renderSSControls) {
				if (this.autoStart) {
					this.$controlsContainer
</P>
						.append('<DIV class="ss-controls">&lt;a href=&quot;#pause&quot; class=&quot;pause&quot; title=&quot;'+this.pauseLinkText+'&quot;&gt;'+this.pauseLinkText+'&lt;/a&gt;</DIV>');
<P>				} else {
					this.$controlsContainer
</P>
						.append('<DIV class="ss-controls">&lt;a href=&quot;#play&quot; class=&quot;play&quot; title=&quot;'+this.playLinkText+'&quot;&gt;'+this.playLinkText+'&lt;/a&gt;</DIV>');
<P>				}
</P><P>				this.$controlsContainer.find('div.ss-controls a')
					.click(function(e) {
						gallery.toggleSlideshow();
						e.preventDefault();
						return false;
					});
			}
</P><P>			if (this.renderNavControls) {
				this.$controlsContainer
</P>
					.append('<DIV class="nav-controls">&lt;a class=&quot;prev&quot; rel=&quot;history&quot; title=&quot;'+this.prevLinkText+'&quot;&gt;'+this.prevLinkText+'&lt;/a&gt;&lt;a class=&quot;next&quot; rel=&quot;history&quot; title=&quot;'+this.nextLinkText+'&quot;&gt;'+this.nextLinkText+'&lt;/a&gt;</DIV>')
<P>					.find('div.nav-controls a')
					.click(function(e) {
						gallery.clickHandler(e, this);
					});
			}
		}
</P><P>		var initFirstImage = !this.enableHistory || !location.hash;
		if (this.enableHistory &amp;&amp; location.hash) {
			var hash = $.galleriffic.normalizeHash(location.hash);
			var imageData = allImages[hash];
			if (!imageData)
				initFirstImage = true;
		}
</P><P>		// Setup gallery to show the first image
		if (initFirstImage)
			this.gotoIndex(0, false, true);
</P><P>		// Setup Keyboard Navigation
		if (this.enableKeyboardNavigation) {
			$(document).keydown(function(e) {
				var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;
				switch(key) {
					case 32: // space
						gallery.next();
						e.preventDefault();
						break;
					case 33: // Page Up
						gallery.previousPage();
						e.preventDefault();
						break;
					case 34: // Page Down
						gallery.nextPage();
						e.preventDefault();
						break;
					case 35: // End
						gallery.gotoIndex(gallery.data.length-1);
						e.preventDefault();
						break;
					case 36: // Home
						gallery.gotoIndex(0);
						e.preventDefault();
						break;
					case 37: // left arrow
						gallery.previous();
						e.preventDefault();
						break;
					case 39: // right arrow
						gallery.next();
						e.preventDefault();
						break;
				}
			});
		}
</P><P>		// Auto start the slideshow
		if (this.autoStart)
			this.play();
</P><P>		// Kickoff Image Preloader after 1 second
		setTimeout(function() { gallery.preloadInit(); }, 1000);
</P><P>		return this;
	};
})(jQuery);
</P><P>/**
</P><PRE>* jQuery Opacity Rollover plugin
*
* Copyright (c) 2009 Trent Foley (<A href="http://trentacular.com" class="external free" rel="nofollow">http://trentacular.com</A>)
* Licensed under the MIT License:
*   <A href="http://www.opensource.org/licenses/mit-license.php" class="external free" rel="nofollow">http://www.opensource.org/licenses/mit-license.php</A>
*/
</PRE><DL><DT>(function($) {
</DT></DL><P>	var defaults = {
		mouseOutOpacity:   0.67,
		mouseOverOpacity:  1.0,
		fadeSpeed:         'fast',
		exemptionSelector: '.selected'
	};
</P><P>	$.fn.opacityrollover = function(settings) {
		// Initialize the effect
		$.extend(this, defaults, settings);
</P><P>		var config = this;
</P><P>		function fadeTo(element, opacity) {
			var $target = $(element);
</P><P>			if (config.exemptionSelector)
				$target = $target.not(config.exemptionSelector);	
</P><P>			$target.fadeTo(config.fadeSpeed, opacity);
		}
</P><P>		this.css('opacity', this.mouseOutOpacity)
			.hover(
				function () {
					fadeTo(this, config.mouseOverOpacity);
				},
				function () {
					fadeTo(this, config.mouseOutOpacity);
				});
</P><P>		return this;
	};
})(jQuery);
</P><P>
/*
</P><PRE>* jQuery history plugin
* 
* sample page: <A href="http://www.mikage.to/jquery/jquery_history.html" class="external free" rel="nofollow">http://www.mikage.to/jquery/jquery_history.html</A>
*
* Copyright (c) 2006-2009 Taku Sano (Mikage Sawatari)
* Licensed under the MIT License:
*   <A href="http://www.opensource.org/licenses/mit-license.php" class="external free" rel="nofollow">http://www.opensource.org/licenses/mit-license.php</A>
*
* Modified by Lincoln Cooper to add Safari support and only call the callback once during initialization
* for msie when no initial hash supplied.
*/
</PRE><P>
jQuery.extend({
	historyCurrentHash: undefined,
	historyCallback: undefined,
	historyIframeSrc: undefined,
</P><P>	historyInit: function(callback, src){
		jQuery.historyCallback = callback;
		if (src) jQuery.historyIframeSrc = src;
		var current_hash = location.hash.replace(/\?.*$/, <I>);</I></P><P>		jQuery.historyCurrentHash = current_hash;
		// if ((jQuery.browser.msie) &amp;&amp; (jQuery.browser.version &lt; 8)) {
		if (jQuery.browser.msie) {
			// To stop the callback firing twice during initilization if no hash present
			if (jQuery.historyCurrentHash == <I>) {</I>
			jQuery.historyCurrentHash = '#';
		}
</P><P>			// add hidden iframe for IE
			jQuery(&quot;body&quot;).prepend('&lt;iframe id=&quot;jQuery_history&quot; style=&quot;display: none;&quot;'+
				(jQuery.historyIframeSrc ? ' src=&quot;'+jQuery.historyIframeSrc+'&quot;' : <I>)</I>
				+'&gt;&lt;/iframe&gt;'
			);
			var ihistory = jQuery(&quot;#jQuery_history&quot;)[0];
			var iframe = ihistory.contentWindow.document;
			iframe.open();
			iframe.close();
			iframe.location.hash = current_hash;
		}
		else if (jQuery.browser.safari) {
			// etablish back/forward stacks
			jQuery.historyBackStack = [];
			jQuery.historyBackStack.length = history.length;
			jQuery.historyForwardStack = [];
			jQuery.lastHistoryLength = history.length;
</P><P>			jQuery.isFirst = true;
		}
		if(current_hash)
			jQuery.historyCallback(current_hash.replace(/^#/, <I>));</I>
		setInterval(jQuery.historyCheck, 100);
	},
</P><P>	historyAddHistory: function(hash) {
		// This makes the looping function do something
		jQuery.historyBackStack.push(hash);
</P><P>		jQuery.historyForwardStack.length = 0; // clear forwardStack (true click occured)
		this.isFirst = true;
	},
</P><P>	historyCheck: function(){
		// if ((jQuery.browser.msie) &amp;&amp; (jQuery.browser.version &lt; 8)) {
		if (jQuery.browser.msie) {
			// On IE, check for location.hash of iframe
			var ihistory = jQuery(&quot;#jQuery_history&quot;)[0];
			var iframe = ihistory.contentDocument || ihistory.contentWindow.document;
			var current_hash = iframe.location.hash.replace(/\?.*$/, <I>);</I>
			if(current_hash != jQuery.historyCurrentHash) {
</P><P>				location.hash = current_hash;
				jQuery.historyCurrentHash = current_hash;
				jQuery.historyCallback(current_hash.replace(/^#/, <I>));</I></P><P>			}
		} else if (jQuery.browser.safari) {
			if(jQuery.lastHistoryLength == history.length &amp;&amp; jQuery.historyBackStack.length &gt; jQuery.lastHistoryLength) {
				jQuery.historyBackStack.shift();
			}
			if (!jQuery.dontCheck) {
				var historyDelta = history.length - jQuery.historyBackStack.length;
				jQuery.lastHistoryLength = history.length;
</P><P>				if (historyDelta) { // back or forward button has been pushed
					jQuery.isFirst = false;
					if (historyDelta &lt; 0) { // back button has been pushed
						// move items to forward stack
						for (var i = 0; i &lt; Math.abs(historyDelta); i++) jQuery.historyForwardStack.unshift(jQuery.historyBackStack.pop());
					} else { // forward button has been pushed
						// move items to back stack
						for (var i = 0; i &lt; historyDelta; i++) jQuery.historyBackStack.push(jQuery.historyForwardStack.shift());
					}
					var cachedHash = jQuery.historyBackStack[jQuery.historyBackStack.length - 1];
					if (cachedHash != undefined) {
						jQuery.historyCurrentHash = location.hash.replace(/\?.*$/, <I>);</I>
						jQuery.historyCallback(cachedHash);
					}
				} else if (jQuery.historyBackStack[jQuery.historyBackStack.length - 1] == undefined &amp;&amp; !jQuery.isFirst) {
					// back button has been pushed to beginning and URL already pointed to hash (e.g. a bookmark)
					// document.URL doesn't change in Safari
					if (location.hash) {
						var current_hash = location.hash;
						jQuery.historyCallback(location.hash.replace(/^#/, <I>));</I>
					} else {
						var current_hash = <I>;</I>
						jQuery.historyCallback(<I>);</I>
					}
					jQuery.isFirst = true;
				}
			}
		} else {
			// otherwise, check for location.hash
			var current_hash = location.hash.replace(/\?.*$/, <I>);</I>
			if(current_hash != jQuery.historyCurrentHash) {
				jQuery.historyCurrentHash = current_hash;
				jQuery.historyCallback(current_hash.replace(/^#/, <I>));</I>
			}
		}
	},
	historyLoad: function(hash){
		var newhash;
		hash = decodeURIComponent(hash.replace(/\?.*$/, <I>));</I></P><P>		if (jQuery.browser.safari) {
			newhash = hash;
		}
		else {
			newhash = '#' + hash;
			location.hash = newhash;
		}
		jQuery.historyCurrentHash = newhash;
</P><P>		// if ((jQuery.browser.msie) &amp;&amp; (jQuery.browser.version &lt; 8)) {
		if (jQuery.browser.msie) {
			var ihistory = jQuery(&quot;#jQuery_history&quot;)[0];
			var iframe = ihistory.contentWindow.document;
			iframe.open();
			iframe.close();
			iframe.location.hash = newhash;
			jQuery.lastHistoryLength = history.length;
			jQuery.historyCallback(hash);
		}
		else if (jQuery.browser.safari) {
			jQuery.dontCheck = true;
			// Manually keep track of the history values for Safari
			this.historyAddHistory(hash);
</P><P>			// Wait a while before allowing checking so that Safari has time to update the &quot;history&quot; object
			// correctly (otherwise the check loop would detect a false change in hash).
			var fn = function() {jQuery.dontCheck = false;};
			window.setTimeout(fn, 200);
			jQuery.historyCallback(hash);
			// N.B. &quot;location.hash=&quot; must be the last line of code for Safari as execution stops afterwards.
			//      By explicitly using the &quot;location.hash&quot; command (instead of using a variable set to &quot;location.hash&quot;) the
			//      URL in the browser and the &quot;history&quot; object are both updated correctly.
			location.hash = newhash;
		}
		else {
		  jQuery.historyCallback(hash);
		}
	}
});
</P><P>
//build menu with DIV ID=&quot;myslidemenu&quot; on page:
droplinemenu.buildmenu(&quot;mydroplinemenu&quot;)
</P><P>//Nivoslider
</P><PRE>   $(window).load(function() {
       $('#slider').nivoSlider({
</PRE><P>			effect:'fade',
			pauseOnHover:true
		});
</P><PRE>   });
</PRE><P>//Profile script from <A href="http://www.willmaster.com/library/web-development/replace-div-content.php" class="external free" rel="nofollow">http://www.willmaster.com/library/web-development/replace-div-content.php</A>
function ReplaceContentInContainer(id,content) {
var container = document.getElementById(id);
container.innerHTML = content;
</P><P>}
</P><P>/*
</P><PRE>* Superfish v1.4.8 - jQuery menu widget
* Copyright (c) 2008 Joel Birch
*
* Dual licensed under the MIT and GPL licenses:
* 	<A href="http://www.opensource.org/licenses/mit-license.php" class="external free" rel="nofollow">http://www.opensource.org/licenses/mit-license.php</A>
* 	<A href="http://www.gnu.org/licenses/gpl.html" class="external free" rel="nofollow">http://www.gnu.org/licenses/gpl.html</A>
*
* CHANGELOG: <A href="http://users.tpg.com.au/j_birch/plugins/superfish/changelog.txt" class="external free" rel="nofollow">http://users.tpg.com.au/j_birch/plugins/superfish/changelog.txt</A>
*/
</PRE><DL><DT>(function($){
</DT></DL><P>	$.fn.superfish = function(op){
</P><P>		var sf = $.fn.superfish,
			c = sf.c,
			$arrow = $(['<SPAN class="',c.arrowClass,'">»</SPAN>'].join(<I>)),</I>
			over = function(){
				var $$ = $(this), menu = getMenu($$);
				clearTimeout(menu.sfTimer);
				$$.showSuperfishUl().siblings().hideSuperfishUl();
			},
			out = function(){
				var $$ = $(this), menu = getMenu($$), o = sf.op;
				clearTimeout(menu.sfTimer);
				menu.sfTimer=setTimeout(function(){
					o.retainPath=($.inArray($$[0],o.$path)&gt;-1);
					$$.hideSuperfishUl();
					if (o.$path.length &amp;&amp; $$.parents(['li.',o.hoverClass].join(<I>)).length&lt;1){over.call(o.$path);}</I>
				},o.delay);	
			},
			getMenu = function($menu){
				var menu = $menu.parents(['ul.',c.menuClass,':first'].join(<I>))[0];</I>
				sf.op = sf.o[menu.serial];
				return menu;
			},
			addArrow = function($a){ $a.addClass(c.anchorClass).append($arrow.clone()); };
</P><P>		return this.each(function() {
			var s = this.serial = sf.o.length;
			var o = $.extend({},sf.defaults,op);
			o.$path = $('li.'+o.pathClass,this).slice(0,o.pathLevels).each(function(){
				$(this).addClass([o.hoverClass,c.bcClass].join(' '))
					.filter('li:has(ul)').removeClass(o.pathClass);
			});
			sf.o[s] = sf.op = o;
</P><P>			$('li:has(ul)',this)[($.fn.hoverIntent &amp;&amp; !o.disableHI) ? 'hoverIntent' : 'hover'](over,out).each(function() {
				if (o.autoArrows) addArrow( $('&gt;a:first-child',this) );
			})
			.not('.'+c.bcClass)
				.hideSuperfishUl();
</P><P>			var $a = $('a',this);
			$a.each(function(i){
				var $li = $a.eq(i).parents('li');
				$a.eq(i).focus(function(){over.call($li);}).blur(function(){out.call($li);});
			});
			o.onInit.call(this);
</P><P>		}).each(function() {
			var menuClasses = [c.menuClass];
			if (sf.op.dropShadows  &amp;&amp; !($.browser.msie &amp;&amp; $.browser.version &lt; 7)) menuClasses.push(c.shadowClass);
			$(this).addClass(menuClasses.join(' '));
		});
	};
</P><P>	var sf = $.fn.superfish;
	sf.o = [];
	sf.op = {};
	sf.IE7fix = function(){
		var o = sf.op;
		if ($.browser.msie &amp;&amp; $.browser.version &gt; 6 &amp;&amp; o.dropShadows &amp;&amp; o.animation.opacity!=undefined)
			this.toggleClass(sf.c.shadowClass+'-off');
		};
	sf.c = {
		bcClass     : 'sf-breadcrumb',
		menuClass   : 'sf-js-enabled',
		anchorClass : 'sf-with-ul',
		arrowClass  : 'sf-sub-indicator',
		shadowClass : 'sf-shadow'
	};
	sf.defaults = {
		hoverClass	: 'sfHover',
		pathClass	: 'overideThisToUse',
		pathLevels	: 1,
		delay		: 800,
		animation	: {opacity:'show'},
		speed		: 'normal',
		autoArrows	: true,
		dropShadows : true,
		disableHI	: false,		// true disables hoverIntent detection
		onInit		: function(){}, // callback functions
		onBeforeShow: function(){},
		onShow		: function(){},
		onHide		: function(){}
	};
	$.fn.extend({
		hideSuperfishUl : function(){
			var o = sf.op,
				not = (o.retainPath===true) ? o.$path : <I>;</I>
			o.retainPath = false;
			var $ul = $(['li.',o.hoverClass].join(<I>),this).add(this).not(not).removeClass(o.hoverClass)</I>
					.find('&gt;ul').hide().css('visibility','hidden');
			o.onHide.call($ul);
			return this;
		},
		showSuperfishUl : function(){
			var o = sf.op,
				sh = sf.c.shadowClass+'-off',
				$ul = this.addClass(o.hoverClass)
					.find('&gt;ul:hidden').css('visibility','visible');
			sf.IE7fix.call($ul);
			o.onBeforeShow.call($ul);
			$ul.animate(o.animation,o.speed,function(){ sf.IE7fix.call($ul); o.onShow.call($ul); });
			return this;
		}
	});
</P><P>})(jQuery);
</P><P>/* jQuery Image Magnify script v1.1
</P><UL><LI> This notice must stay intact for usage 
</LI><LI> Author: Dynamic Drive at <A href="http://www.dynamicdrive.com/" class="external free" rel="nofollow">http://www.dynamicdrive.com/</A></LI><LI> Visit <A href="http://www.dynamicdrive.com/" class="external free" rel="nofollow">http://www.dynamicdrive.com/</A> for full source code
</LI></UL><UL><LI> Nov 16th, 09 (v1.1): Adds ability to dynamically apply/reapply magnify effect to an image, plus magnify to a specific width in pixels.
</LI><LI> Feb 8th, 11 (v1.11): Fixed bug that caused script to not work in newever versions of jQuery (ie: v1.4.4)
</LI><LI>/
</LI></UL><P>jQuery.imageMagnify={
	dsettings: {
		magnifyby: 3, //default increase factor of enlarged image
		duration: 500, //default duration of animation, in millisec
		imgopacity: 0.2 //opacify of original image when enlarged image overlays it
</P><PRE>	},
</PRE><P>	cursorcss: 'url(<A href="http://www.dynamicdrive.com/dynamicindex4/magnify.cur" class="external free" rel="nofollow">http://www.dynamicdrive.com/dynamicindex4/magnify.cur</A>), -moz-zoom-in', //Value for CSS's 'cursor' attribute, added to original image
	zIndexcounter: 100,
</P><P>	refreshoffsets:function($window, $target, warpshell){
		var $offsets=$target.offset()
		var winattrs={x:$window.scrollLeft(), y:$window.scrollTop(), w:$window.width(), h:$window.height()}
		warpshell.attrs.x=$offsets.left //update x position of original image relative to page
		warpshell.attrs.y=$offsets.top
		warpshell.newattrs.x=winattrs.x+winattrs.w/2-warpshell.newattrs.w/2
		warpshell.newattrs.y=winattrs.y+winattrs.h/2-warpshell.newattrs.h/2
		if (warpshell.newattrs.x&lt;winattrs.x+5){ //no space to the left?
			warpshell.newattrs.x=winattrs.x+5	
		}
		else if (warpshell.newattrs.x+warpshell.newattrs.w &gt; winattrs.x+winattrs.w){//no space to the right?
			warpshell.newattrs.x=winattrs.x+5
		}
		if (warpshell.newattrs.y&lt;winattrs.y+5){ //no space at the top?
			warpshell.newattrs.y=winattrs.y+5
		}
	},
</P><P>	magnify:function($, $target, options){
		var setting={} //create blank object to store combined settings
		var setting=jQuery.extend(setting, this.dsettings, options)
		var attrs=(options.thumbdimensions)? {w:options.thumbdimensions[0], h:options.thumbdimensions[1]} : {w:$target.outerWidth(), h:$target.outerHeight()}
		var newattrs={}
		newattrs.w=(setting.magnifyto)? setting.magnifyto : Math.round(attrs.w*setting.magnifyby)
		newattrs.h=(setting.magnifyto)? Math.round(attrs.h*newattrs.w/attrs.w) : Math.round(attrs.h*setting.magnifyby)
		$target.css('cursor', jQuery.imageMagnify.cursorcss)
		if ($target.data('imgshell')){
			$target.data('imgshell').$clone.remove()
			$target.css({opacity:1}).unbind('click.magnify')
		}	
		var $clone=$target.clone().css({position:'absolute', left:0, top:0, visibility:'hidden', border:'1px solid gray', cursor:'pointer'}).appendTo(document.body)
		$clone.data('$relatedtarget', $target) //save $target image this enlarged image is associated with
		$target.data('imgshell', {$clone:$clone, attrs:attrs, newattrs:newattrs})
		$target.bind('click.magnify', function(e){ //action when original image is clicked on
			var $this=$(this).css({opacity:setting.imgopacity})
			var imageinfo=$this.data('imgshell')
			jQuery.imageMagnify.refreshoffsets($(window), $this, imageinfo) //refresh offset positions of original and warped images
			var $clone=imageinfo.$clone
			$clone.stop().css({zIndex:++jQuery.imageMagnify.zIndexcounter, left:imageinfo.attrs.x, top:imageinfo.attrs.y, width:imageinfo.attrs.w, height:imageinfo.attrs.h, opacity:0, visibility:'visible', display:'block'})
			.animate({opacity:1, left:imageinfo.newattrs.x, top:imageinfo.newattrs.y, width:imageinfo.newattrs.w, height:imageinfo.newattrs.h}, setting.duration,
			function(){ //callback function after warping is complete
				//none added		
			}) //end animate
		}) //end click
		$clone.click(function(e){ //action when magnified image is clicked on
			var $this=$(this)
			var imageinfo=$this.data('$relatedtarget').data('imgshell')
			jQuery.imageMagnify.refreshoffsets($(window), $this.data('$relatedtarget'), imageinfo) //refresh offset positions of original and warped images
			$this.stop().animate({opacity:0, left:imageinfo.attrs.x, top:imageinfo.attrs.y, width:imageinfo.attrs.w, height:imageinfo.attrs.h},  setting.duration,
			function(){
				$this.hide()
				$this.data('$relatedtarget').css({opacity:1}) //reveal original image
			}) //end animate
		}) //end click
	}
};
</P><P>jQuery.fn.imageMagnify=function(options){
	var $=jQuery
	return this.each(function(){ //return jQuery obj
		var $imgref=$(this)
		if (this.tagName!=&quot;IMG&quot;)
			return true //skip to next matched element
		if (parseInt($imgref.css('width'))&gt;0 &amp;&amp; parseInt($imgref.css('height'))&gt;0 || options.thumbdimensions){ //if image has explicit width/height attrs defined
			jQuery.imageMagnify.magnify($, $imgref, options)
		}
		else if (this.complete){ //account for IE not firing image.onload
			jQuery.imageMagnify.magnify($, $imgref, options)
		}
		else{
			$(this).bind('load', function(){
				jQuery.imageMagnify.magnify($, $imgref, options)
			})
		}
	})
};
</P><P>jQuery.fn.applyMagnifier=function(options){ //dynamic version of imageMagnify() to apply magnify effect to an image dynamically
	var $=jQuery
	return this.each(function(){ //return jQuery obj
		var $imgref=$(this)
		if (this.tagName!=&quot;IMG&quot;)
			return true //skip to next matched element
</P><P>	})	
</P><P>};
</P><P>
//** The following applies the magnify effect to images with class=&quot;magnify&quot; and optional &quot;data-magnifyby&quot; and &quot;data-magnifyduration&quot; attrs
//** It also looks for links with attr rel=&quot;magnify[targetimageid]&quot; and makes them togglers for that image
</P><P>jQuery(document).ready(function($){
	var $targets=$('.magnify')
	$targets.each(function(i){
		var $target=$(this)
		var options={}
		if ($target.attr('data-magnifyto'))
			options.magnifyto=parseFloat($target.attr('data-magnifyto'))
		if ($target.attr('data-magnifyby'))
			options.magnifyby=parseFloat($target.attr('data-magnifyby'))
		if ($target.attr('data-magnifyduration'))
			options.duration=parseInt($target.attr('data-magnifyduration'))
		$target.imageMagnify(options)
	})
	var $triggers=$('a[rel^=&quot;magnify[&quot;]')
	$triggers.each(function(i){
		var $trigger=$(this)
		var targetid=$trigger.attr('rel').match(/\[.+\]/)[0].replace(/[\[\]']/g, <I>) //parse 'id' from rel='magnify[id]'</I>
		$trigger.data('magnifyimageid', targetid)
		$trigger.click(function(e){
			$('#'+$(this).data('magnifyimageid')).trigger('click.magnify')
			e.preventDefault()
		})
	})
})
</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2012.igem.org/Team:UC_Chile/js/finaljs">http://2012.igem.org/Team:UC_Chile/js/finaljs</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:UC_Chile/js/finaljs" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:UC_Chile/js/finaljs" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:UC_Chile/js/finaljs&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:UC_Chile/js/finaljs&amp;oldid=106571" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2012.igem.org:Privacy_policy" title="2012.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2012.igem.org:General_disclaimer" title="2012.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>