<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Carnegie_Mellon_Mod-Matlab"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Carnegie_Mellon/Mod-Matlab">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Carnegie_Mellon/Mod-Matlab&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Carnegie_Mellon/Mod-Matlab&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Carnegie_Mellon/Mod-Matlab&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Carnegie_Mellon/Mod-Matlab" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform">Â </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Carnegie Mellon/Mod-Matlab</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2012.igem.org</H3><P><UL class="sf-menu sf-navbar"><LI style="width: 193px"><A href="https://2012.igem.org/Team:Carnegie_Mellon">Home</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon">Overview</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hom-Introduction">Introduction</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hom-Team">Team</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hom-Attributions">Attributions</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hom-Acknowledgements">Acknowledgements</A></LI></UL><LI style="width: 193px"><A href="https://2012.igem.org/Team:Carnegie_Mellon/Bio-Overview">BioBricks</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Bio-Overview">Overview</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Bio-Submitted">Submitted Parts</A></LI><LI style="width: 193px"><A href="https://2012.igem.org/Team:Carnegie_Mellon/Met-Overview">Methods and Results</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Met-Overview">Overview</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Met-Results">Results</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Met-Protocols">Protocols</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Met-Challenges">Challenges</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Met-Notebook">Notebook</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Met-Safety">Safety</A></LI><LI class="current" style="width: 193px"><A href="https://2012.igem.org/Team:Carnegie_Mellon/Mod-Overview">Modeling</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Mod-Overview">Overview</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Mod-Derivations">Derivations</A></LI><LI class="current"><A href="https://2012.igem.org/Team:Carnegie_Mellon/Mod-Matlab">Matlab</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Mod-Expanded">Expanded</A></LI><LI style="width: 193px"><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hum-Overview">Human Practices</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hum-Overview">Overview</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hum-Outreach">Outreach</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hum-Circuit">Circuit Kit</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hum-Software">Software</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hum-Team">Team Presentation</A></LI><LI><A href="https://2012.igem.org/Team:Carnegie_Mellon/Hum-Teaching">Teaching Presentation</A></LI></P><DIV id="main"><DIV class="main_content"><H1 id="section1-1">Inputs</H1><P>
    The inputs to the model are the measurement tables of concentration of dye vs. time. Optional inputs to the model include an <I>in vitro</I> measurement of
    saturation of the dye, and measurements of the fluorescence of the dye with mRNA and protein synthesis turned off. The first optional measurement can be
    used to compare the <I>in vitro</I> fluorescence saturation levels with the <I>in vivo</I> fluorescence saturation levels in order to give a scaling factor for the all
    the measurements in the input. Estimations can be used in place of these to simplify the number of inputs. The second optional measurement can be used to
    determine the degradation rates of mRNA and protein.
</P><P>
The equations for the model can be found <A rel="external" href="https://2012.igem.org/Team:Carnegie_Mellon/Mod-Derivations">here</A>.
</P><H1 id="section1-2">Walkthrough</H1><P><STRONG>Fluoro2.m</STRONG></P><P>
    This function is the function that is called to run the entire program. In addition, it takes the mRNA titration tables (modeldata) and converts it into
    fluorescent mRNA concentrations. It then passes the degradation data to the degradation functions, Degradation.m and DegradationP.m to return alpha2 and
    beta2, the degradation coefficients.
</P><DIV class="slide" style="cursor: pointer; color: #990000;">--&gt;Click to Show/Hide Code&lt;--</DIV><DIV class="view"><PRE><SPAN class="lnr"> 1 </SPAN><SPAN class="Identifier">function</SPAN><SPAN class="Identifier">[</SPAN> PoPSans <SPAN class="Identifier">]</SPAN> = Fluoro2( matrix, matrix2, DNA, modeldata )
<SPAN class="lnr"> 2 </SPAN><SPAN class="Comment">%Fluoro 2: This function takes in a matrix of titrations and determines</SPAN><SPAN class="lnr"> 3 </SPAN><SPAN class="Comment">%both the possible percentage for bound mRNA as well as the actual</SPAN><SPAN class="lnr"> 4 </SPAN><SPAN class="Comment">%fluorescent mRNA concentration from fluorescent input values.</SPAN><SPAN class="lnr"> 5 </SPAN><SPAN class="lnr"> 6 </SPAN><SPAN class="lnr"> 7 </SPAN>controlc = matrix(<SPAN class="Statement">end</SPAN>,:)<SPAN class="Special">;</SPAN><SPAN class="Comment">%concentration and fluorescence of the control</SPAN><SPAN class="lnr"> 8 </SPAN>controlconc = controlc(<SPAN class="Constant">1</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="Comment">%concentration of dye for the control</SPAN><SPAN class="lnr"> 9 </SPAN>controldat = controlc(<SPAN class="Constant">1</SPAN>:<SPAN class="Statement">end</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="Comment">%fluorescence of the control</SPAN><SPAN class="lnr">10 </SPAN>maxc = <SPAN class="Statement">max</SPAN>(controldat)<SPAN class="Special">;</SPAN><SPAN class="lnr">11 </SPAN>concs = matrix(:,<SPAN class="Constant">1</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="Comment">%concentrations of the dye in the wells</SPAN><SPAN class="lnr">12 </SPAN>concs1 = concs(<SPAN class="Constant">1</SPAN>:(<SPAN class="Statement">end</SPAN><SPAN class="Statement">-</SPAN><SPAN class="Constant">2</SPAN>))<SPAN class="Special">;</SPAN><SPAN class="lnr">13 </SPAN>controlmax = maxc<SPAN class="Special">;</SPAN><SPAN class="lnr">14 </SPAN><SPAN class="lnr">15 </SPAN>Rf = <SPAN class="Identifier">[]</SPAN><SPAN class="Special">;</SPAN><SPAN class="lnr">16 </SPAN><SPAN class="lnr">17 </SPAN><SPAN class="Statement">for</SPAN> i = <SPAN class="Constant">2</SPAN>:<SPAN class="Statement">size</SPAN>(matrix, <SPAN class="Constant">2</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr">18 </SPAN>    fluordat = matrix(:,i)<SPAN class="Special">;</SPAN><SPAN class="Comment">%fluoroscence data at some time point</SPAN><SPAN class="lnr">19 </SPAN>    fluordat1 = fluordat(<SPAN class="Constant">1</SPAN>:(<SPAN class="Statement">end</SPAN><SPAN class="Statement">-</SPAN><SPAN class="Constant">2</SPAN>))<SPAN class="Special">;</SPAN><SPAN class="lnr">20 </SPAN>    s = fitoptions(<SPAN class="String">'Method'</SPAN>, <SPAN class="String">'NonlinearLeastSquares'</SPAN>, <SPAN class="String">'Startpoint'</SPAN>,<SPAN class="Comment">...</SPAN><SPAN class="lnr">21 </SPAN><SPAN class="Identifier">[</SPAN>fluordat1(<SPAN class="Statement">end</SPAN>), <SPAN class="Constant">1</SPAN><SPAN class="Statement">/</SPAN>(controlconc)<SPAN class="Identifier">]</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr">22 </SPAN>    g = fittype(<SPAN class="String">'a * (1 - exp(b * (-x)))'</SPAN>, <SPAN class="String">'coefficients'</SPAN>, {<SPAN class="String">'a'</SPAN>, <SPAN class="String">'b'</SPAN>},<SPAN class="Comment">...</SPAN><SPAN class="lnr">23 </SPAN><SPAN class="String">'options'</SPAN>, s)<SPAN class="Special">;</SPAN><SPAN class="lnr">24 </SPAN>    h = fit(concs1, fluordat1, g)<SPAN class="Special">;</SPAN><SPAN class="lnr">25 </SPAN>    coeffvals = coeffvalues(h)<SPAN class="Special">;</SPAN><SPAN class="lnr">26 </SPAN><SPAN class="Comment">%figure(i);</SPAN><SPAN class="lnr">27 </SPAN><SPAN class="Comment">%plot(h, concs1, fluordat1)</SPAN><SPAN class="lnr">28 </SPAN>    factorScale = coeffvals(<SPAN class="Constant">1</SPAN>) <SPAN class="Statement">/</SPAN> controlmax<SPAN class="Special">;</SPAN><SPAN class="lnr">29 </SPAN><SPAN class="Comment">%scaling factor from in vitro to in vivo</SPAN><SPAN class="lnr">30 </SPAN><SPAN class="Statement">for</SPAN> j = <SPAN class="Constant">1</SPAN>:<SPAN class="Statement">size</SPAN>(concs1)<SPAN class="Special">;</SPAN><SPAN class="lnr">31 </SPAN><SPAN class="Statement">if</SPAN><SPAN class="Statement">abs</SPAN>(h(concs1(j)) <SPAN class="Statement">-</SPAN> h(<SPAN class="Constant">1</SPAN>)) <SPAN class="Statement">&lt;=</SPAN> (<SPAN class="Constant">.2</SPAN><SPAN class="Statement">*</SPAN> h(<SPAN class="Constant">1</SPAN>))<SPAN class="Special">;</SPAN><SPAN class="lnr">32 </SPAN>            Rf(i <SPAN class="Statement">-</SPAN><SPAN class="Constant">1</SPAN>) = concs1(j) <SPAN class="Statement">*</SPAN> factorScale<SPAN class="Special">;</SPAN><SPAN class="lnr">33 </SPAN><SPAN class="Statement">break</SPAN><SPAN class="lnr">34 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">35 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">36 </SPAN><SPAN class="lnr">37 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">38 </SPAN>time = matrix(<SPAN class="Constant">1</SPAN>,:)<SPAN class="Special">;</SPAN><SPAN class="lnr">39 </SPAN>fluortime = time(<SPAN class="Constant">2</SPAN>:<SPAN class="Statement">size</SPAN>(matrix, <SPAN class="Constant">2</SPAN>))<SPAN class="Special">;</SPAN><SPAN class="lnr">40 </SPAN><SPAN class="lnr">41 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">42 </SPAN><SPAN class="Comment">%Section for Transcriptional Efficiency      %</SPAN><SPAN class="lnr">43 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">44 </SPAN><SPAN class="lnr">45 </SPAN>Rt = FluoroLR(Rf, fluortime)<SPAN class="Special">;</SPAN><SPAN class="lnr">46 </SPAN><SPAN class="lnr">47 </SPAN><SPAN class="lnr">48 </SPAN>alpha2 = Degradation(modeldata)<SPAN class="Special">;</SPAN><SPAN class="lnr">49 </SPAN><SPAN class="lnr">50 </SPAN>ETF = mRNAexpress(fluortime, DNA, Rt, alpha2)<SPAN class="Special">;</SPAN><SPAN class="lnr">51 </SPAN><SPAN class="Comment">%ETF = mean(ETF);</SPAN><SPAN class="lnr">52 </SPAN><SPAN class="lnr">53 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">54 </SPAN><SPAN class="Comment">%Section for Translational Efficiency        %</SPAN><SPAN class="lnr">55 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">56 </SPAN><SPAN class="lnr">57 </SPAN>Pt = ProteinFunctions(matrix2)<SPAN class="Special">;</SPAN><SPAN class="lnr">58 </SPAN><SPAN class="lnr">59 </SPAN>beta2 = DegradationP(modeldata)<SPAN class="Special">;</SPAN><SPAN class="lnr">60 </SPAN><SPAN class="lnr">61 </SPAN>Tl = proteinexpress(DNA, Pt, ETF, alpha2, beta2)<SPAN class="Special">;</SPAN><SPAN class="lnr">62 </SPAN><SPAN class="lnr">63 </SPAN><SPAN class="Comment">%Tl = proteinexpress(DNA, 1.6, ETF, alpha2, beta2)</SPAN><SPAN class="lnr">64 </SPAN><SPAN class="lnr">65 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">66 </SPAN><SPAN class="Comment">%Section for Polymerase per Second           %</SPAN><SPAN class="lnr">67 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">68 </SPAN><SPAN class="lnr">69 </SPAN>PoPSans = PoPS(alpha2, beta2, Pt, Tl)<SPAN class="Special">;</SPAN><SPAN class="lnr">70 </SPAN><SPAN class="lnr">71 </SPAN><SPAN class="Statement">end</SPAN></PRE></DIV><P><STRONG>Degradation.m</STRONG></P><P>
    This function takes in mRNA fluorescence data with mRNA synthesis turned off. This makes determining degradation rates easier, as all the change (as we
    will define degradation) in the mRNA concentration will be due to degradation. The function takes the data and fits a curve to the data, in the process
    calculating the degradation rate.
</P><DIV class="slide" style="cursor: pointer; color: #990000;">--&gt;Click to Show/Hide Code&lt;--</DIV><DIV class="view"><PRE><SPAN class="lnr"> 1 </SPAN><SPAN class="Identifier">function</SPAN><SPAN class="Identifier">[</SPAN> alpha2 <SPAN class="Identifier">]</SPAN> = Degradation ( modeldata )
<SPAN class="lnr"> 2 </SPAN>dRi = modeldata(:,<SPAN class="Constant">3</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr"> 3 </SPAN>time = modeldata(:,<SPAN class="Constant">1</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr"> 4 </SPAN><SPAN class="Comment">%dRi(length(dRi),:) = [];</SPAN><SPAN class="lnr"> 5 </SPAN>C = <SPAN class="Statement">max</SPAN>(dRi)<SPAN class="Special">;</SPAN><SPAN class="lnr"> 6 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr"> 7 </SPAN><SPAN class="Comment">%Differential Equation: dRi./dt = alpha * Rt%</SPAN><SPAN class="lnr"> 8 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr"> 9 </SPAN><SPAN class="lnr">10 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">11 </SPAN><SPAN class="Comment">%dRi is the fluorescence measurements of RNA during degradation only%</SPAN><SPAN class="lnr">12 </SPAN><SPAN class="Comment">%alpha is the desired result, so we solve the diff eq               %</SPAN><SPAN class="lnr">13 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">14 </SPAN><SPAN class="lnr">15 </SPAN><SPAN class="Statement">for</SPAN> i = <SPAN class="Constant">1</SPAN>:(length(dRi))<SPAN class="Special">;</SPAN><SPAN class="lnr">16 </SPAN><SPAN class="Statement">if</SPAN> dRi(i) <SPAN class="Statement">~</SPAN>= <SPAN class="Constant">0</SPAN><SPAN class="Statement">&amp;&amp;</SPAN> time(i) <SPAN class="Statement">~</SPAN>= <SPAN class="Constant">0</SPAN><SPAN class="lnr">17 </SPAN>        alpha(i) = <SPAN class="Statement">log</SPAN>(dRi(i) <SPAN class="Statement">./</SPAN> C) <SPAN class="Statement">./</SPAN> time(i)<SPAN class="Special">;</SPAN><SPAN class="lnr">18 </SPAN><SPAN class="Statement">else</SPAN><SPAN class="lnr">19 </SPAN>        alpha(i) = <SPAN class="Statement">log</SPAN>(dRi(<SPAN class="Constant">2</SPAN>) <SPAN class="Statement">./</SPAN> C) <SPAN class="Statement">./</SPAN> time(<SPAN class="Constant">2</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr">20 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">21 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">22 </SPAN>alpha<SPAN class="Special">;</SPAN><SPAN class="lnr">23 </SPAN>alpha2 = <SPAN class="Statement">-</SPAN><SPAN class="Statement">mean</SPAN>(alpha)<SPAN class="Special">;</SPAN><SPAN class="lnr">24 </SPAN><SPAN class="Comment">%Rdegra = Rt * alpha2;</SPAN><SPAN class="lnr">25 </SPAN><SPAN class="lnr">26 </SPAN><SPAN class="Statement">end</SPAN></PRE></DIV><P><STRONG>DegradationP.m</STRONG></P><P>
    This function has a similar role to Degradation.m. This function takes in protein fluorescence data with protein synthesis turned off. This function,
    similarly to Degradation.m, takes the data and fits a curve to the data.
</P><P>
    The degradation functions return alpha2 and beta2 to Fluoro2.m. Fluoro2.m then calls ProteinFunctions.m to convert the protein titration data to
    fluorescent protein concentrations.
</P><DIV class="slide" style="cursor: pointer; color: #990000;">--&gt;Click to Show/Hide Code&lt;--</DIV><DIV class="view"><PRE><SPAN class="lnr"> 1 </SPAN><SPAN class="Identifier">function</SPAN><SPAN class="Identifier">[</SPAN> beta2 <SPAN class="Identifier">]</SPAN> = DegradationP ( modeldata )
<SPAN class="lnr"> 2 </SPAN><SPAN class="Comment">%DegradationP</SPAN><SPAN class="lnr"> 3 </SPAN><SPAN class="lnr"> 4 </SPAN>dPi = modeldata(:,<SPAN class="Constant">6</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr"> 5 </SPAN>timeP = modeldata(:,<SPAN class="Constant">1</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr"> 6 </SPAN><SPAN class="Comment">%dRi ./ dt = alpha * Ri, solution: R = Ce^(alpha t) ./ alpha</SPAN><SPAN class="lnr"> 7 </SPAN>C1 = <SPAN class="Statement">max</SPAN>(dPi)<SPAN class="Special">;</SPAN><SPAN class="lnr"> 8 </SPAN><SPAN class="Comment">%ln(Ri ./ C) ./ t = alpha</SPAN><SPAN class="lnr"> 9 </SPAN><SPAN class="Statement">for</SPAN> i = <SPAN class="Constant">1</SPAN>:length(dPi)
<SPAN class="lnr">10 </SPAN><SPAN class="Statement">if</SPAN> dPi(i) <SPAN class="Statement">~</SPAN>= <SPAN class="Constant">0</SPAN><SPAN class="Statement">&amp;&amp;</SPAN> timeP(i) <SPAN class="Statement">~</SPAN>= <SPAN class="Constant">0</SPAN><SPAN class="lnr">11 </SPAN>        beta(i) = <SPAN class="Statement">log</SPAN>(dPi(i) <SPAN class="Statement">./</SPAN> C1) <SPAN class="Statement">./</SPAN> timeP(i)<SPAN class="Special">;</SPAN><SPAN class="lnr">12 </SPAN><SPAN class="Statement">else</SPAN><SPAN class="lnr">13 </SPAN>        beta(i) = <SPAN class="Statement">log</SPAN>(dPi(<SPAN class="Constant">2</SPAN>) <SPAN class="Statement">./</SPAN> C1) <SPAN class="Statement">./</SPAN> timeP(<SPAN class="Constant">2</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr">14 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">15 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">16 </SPAN><SPAN class="lnr">17 </SPAN>beta2 = <SPAN class="Statement">-</SPAN><SPAN class="Statement">mean</SPAN>(beta)<SPAN class="Special">;</SPAN><SPAN class="lnr">18 </SPAN><SPAN class="Comment">%Pdegra = beta2 * Pt;</SPAN><SPAN class="lnr">19 </SPAN><SPAN class="Statement">end</SPAN></PRE></DIV><P><STRONG>ProteinFunctions.m</STRONG></P><P>
    This function does the same thing as Fluoro2.m with the mRNA titration data. It returns fluorescent protein concentrations over time.
</P><P>
    Fluoro2.m takes the fluorescent protein and fluorescent mRNA concentrations and passes them to FluoroLR.m and FluoroLP.m to convert to total protein and
    total mRNA concentrations.
</P><DIV class="slide" style="cursor: pointer; color: #990000;">--&gt;Click to Show/Hide Code&lt;--</DIV><DIV class="view"><PRE><SPAN class="lnr"> 1 </SPAN><SPAN class="Identifier">function</SPAN><SPAN class="Identifier">[</SPAN> Pt <SPAN class="Identifier">]</SPAN> = ProteinFunctions( matrix)
<SPAN class="lnr"> 2 </SPAN><SPAN class="Comment">%UNTITLED Summary of this function goes here</SPAN><SPAN class="lnr"> 3 </SPAN><SPAN class="Comment">%   Detailed explanation goes here</SPAN><SPAN class="lnr"> 4 </SPAN><SPAN class="lnr"> 5 </SPAN>controlc = matrix(<SPAN class="Statement">end</SPAN>,:)<SPAN class="Special">;</SPAN><SPAN class="Comment">%concentration and fluorescence of the control</SPAN><SPAN class="lnr"> 6 </SPAN>controlconc = controlc(<SPAN class="Constant">1</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="Comment">%concentration of dye for the control</SPAN><SPAN class="lnr"> 7 </SPAN>controldat = controlc(<SPAN class="Constant">1</SPAN>:<SPAN class="Statement">end</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="Comment">%fluorescence of the control</SPAN><SPAN class="lnr"> 8 </SPAN>maxc = <SPAN class="Statement">max</SPAN>(controldat)<SPAN class="Special">;</SPAN><SPAN class="lnr"> 9 </SPAN>concs = matrix(:,<SPAN class="Constant">1</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="Comment">%concentrations of the dye in the wells</SPAN><SPAN class="lnr">10 </SPAN>concs1 = concs(<SPAN class="Constant">1</SPAN>:(<SPAN class="Statement">end</SPAN><SPAN class="Statement">-</SPAN><SPAN class="Constant">2</SPAN>))<SPAN class="Special">;</SPAN><SPAN class="lnr">11 </SPAN>controlmax = maxc<SPAN class="Special">;</SPAN><SPAN class="lnr">12 </SPAN><SPAN class="lnr">13 </SPAN>Pf = <SPAN class="Identifier">[]</SPAN><SPAN class="Special">;</SPAN><SPAN class="lnr">14 </SPAN><SPAN class="lnr">15 </SPAN><SPAN class="Statement">for</SPAN> i = <SPAN class="Constant">2</SPAN>:<SPAN class="Statement">size</SPAN>(matrix, <SPAN class="Constant">2</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr">16 </SPAN>    fluordat = matrix(:,i)<SPAN class="Special">;</SPAN><SPAN class="Comment">%fluoroscence data at some time point</SPAN><SPAN class="lnr">17 </SPAN>    fluordat1 = fluordat(<SPAN class="Constant">1</SPAN>:(<SPAN class="Statement">end</SPAN><SPAN class="Statement">-</SPAN><SPAN class="Constant">2</SPAN>))<SPAN class="Special">;</SPAN><SPAN class="lnr">18 </SPAN><SPAN class="lnr">19 </SPAN>    s = fitoptions(<SPAN class="String">'Method'</SPAN>, <SPAN class="String">'NonlinearLeastSquares'</SPAN>, <SPAN class="String">'Startpoint'</SPAN>,<SPAN class="Comment">...</SPAN><SPAN class="lnr">20 </SPAN><SPAN class="Identifier">[</SPAN>fluordat1(<SPAN class="Statement">end</SPAN>), <SPAN class="Constant">1</SPAN><SPAN class="Statement">/</SPAN>(controlconc)<SPAN class="Identifier">]</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr">21 </SPAN><SPAN class="lnr">22 </SPAN>    g = fittype(<SPAN class="String">'a * (1 - exp(b * (-x)))'</SPAN>, <SPAN class="String">'coefficients'</SPAN>, {<SPAN class="String">'a'</SPAN>, <SPAN class="String">'b'</SPAN>},<SPAN class="Comment">...</SPAN><SPAN class="lnr">23 </SPAN><SPAN class="String">'options'</SPAN>, s)<SPAN class="Special">;</SPAN><SPAN class="lnr">24 </SPAN><SPAN class="lnr">25 </SPAN>    h = fit(concs1, fluordat1, g)<SPAN class="Special">;</SPAN><SPAN class="lnr">26 </SPAN>    coeffvals = coeffvalues(h)<SPAN class="Special">;</SPAN><SPAN class="lnr">27 </SPAN><SPAN class="Comment">%figure(i);</SPAN><SPAN class="lnr">28 </SPAN><SPAN class="Comment">%plot(h, concs1, fluordat1)</SPAN><SPAN class="lnr">29 </SPAN>    factorScale = coeffvals(<SPAN class="Constant">1</SPAN>) <SPAN class="Statement">/</SPAN> controlmax<SPAN class="Special">;</SPAN><SPAN class="Comment">...</SPAN><SPAN class="lnr">30 </SPAN><SPAN class="Comment">%scaling factor from in vitro to in vivo</SPAN><SPAN class="lnr">31 </SPAN><SPAN class="Statement">for</SPAN> j = <SPAN class="Constant">1</SPAN>:<SPAN class="Statement">size</SPAN>(concs1)<SPAN class="Special">;</SPAN><SPAN class="lnr">32 </SPAN><SPAN class="Statement">if</SPAN><SPAN class="Statement">abs</SPAN>(h(concs1(j)) <SPAN class="Statement">-</SPAN> h(<SPAN class="Constant">1</SPAN>)) <SPAN class="Statement">&lt;=</SPAN> (<SPAN class="Constant">.2</SPAN><SPAN class="Statement">*</SPAN> h(<SPAN class="Constant">1</SPAN>))<SPAN class="Special">;</SPAN><SPAN class="lnr">33 </SPAN>            Pf(i <SPAN class="Statement">-</SPAN><SPAN class="Constant">1</SPAN>) = concs1(j) <SPAN class="Statement">*</SPAN> factorScale<SPAN class="Special">;</SPAN><SPAN class="lnr">34 </SPAN><SPAN class="Statement">break</SPAN><SPAN class="lnr">35 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">36 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">37 </SPAN><SPAN class="lnr">38 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">39 </SPAN>time = matrix(<SPAN class="Constant">1</SPAN>,:)<SPAN class="Special">;</SPAN><SPAN class="lnr">40 </SPAN>fluortime = time(<SPAN class="Constant">2</SPAN>:<SPAN class="Statement">size</SPAN>(matrix, <SPAN class="Constant">2</SPAN>))<SPAN class="Special">;</SPAN><SPAN class="lnr">41 </SPAN><SPAN class="lnr">42 </SPAN>Pt = FluoroLP (Pf, fluortime)<SPAN class="Special">;</SPAN><SPAN class="lnr">43 </SPAN><SPAN class="lnr">44 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">45 </SPAN></PRE></DIV><P><STRONG>FluoroLR.m</STRONG></P><P>
    This function takes in fluorescent mRNA concentrations and converts it to mRNA concentrations using first-order chemical reactions. One dye molecule will
    bond to one mRNA molecule, creating an mRNA-dye complex. This leads to a rather simple conversion using the known dye concentration.
</P>
\begin{equation}K_{D_R} = \frac{[R_f]}{([R]_0 - [R_f])([D_R]_0 - [R_f])}\end{equation}
<P>
    where KDR is the dissociation constant, $[Rf]$ is the fluorescent mRNA concentration, $[R]$ is the mRNA concentration, and $[D_R]$ is the dye concentration.
</P><DIV class="slide" style="cursor: pointer; color: #990000;">--&gt;Click to Show/Hide Code&lt;--</DIV><DIV class="view"><PRE><SPAN class="lnr"> 1 </SPAN><SPAN class="Identifier">function</SPAN><SPAN class="Identifier">[</SPAN>Rt<SPAN class="Identifier">]</SPAN> = FluoroLR (Rf, concentrations)
<SPAN class="lnr"> 2 </SPAN><SPAN class="Comment">%DFHBI = 1*10^(-9); %concentration of dye</SPAN><SPAN class="lnr"> 3 </SPAN><SPAN class="Comment">%Rfmax = 1*10^(-10);%max concentration of the mRNA</SPAN><SPAN class="lnr"> 4 </SPAN>KD = <SPAN class="Constant">464</SPAN><SPAN class="Statement">*</SPAN><SPAN class="Constant">10</SPAN><SPAN class="Statement">^</SPAN>(<SPAN class="Statement">-</SPAN><SPAN class="Constant">9</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr"> 5 </SPAN><SPAN class="lnr"> 6 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr"> 7 </SPAN><SPAN class="Comment">%Relates the mRNA fluorescence levels with the total mRNA levels%</SPAN><SPAN class="lnr"> 8 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr"> 9 </SPAN><SPAN class="lnr">10 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">11 </SPAN><SPAN class="Comment">%fluorescence is measured, Rf is the fluorescent mRNA concentration%</SPAN><SPAN class="lnr">12 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">13 </SPAN><SPAN class="lnr">14 </SPAN><SPAN class="Comment">%a = max(fluorescence) ./ Rfmax;</SPAN><SPAN class="lnr">15 </SPAN><SPAN class="Comment">%Rf = zeros(length(fluorescence) - 1, 1);</SPAN><SPAN class="lnr">16 </SPAN><SPAN class="Comment">%for i = 1:(length(fluorescence) - 1)</SPAN><SPAN class="lnr">17 </SPAN><SPAN class="Comment">%    Rf(i) = fluorescence(i) ./ a;    </SPAN><SPAN class="lnr">18 </SPAN><SPAN class="Comment">%end</SPAN><SPAN class="lnr">19 </SPAN><SPAN class="lnr">20 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">21 </SPAN><SPAN class="Comment">%Rt is the total mRNA%</SPAN><SPAN class="lnr">22 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">23 </SPAN><SPAN class="lnr">24 </SPAN>Rt = <SPAN class="Identifier">[]</SPAN><SPAN class="Special">;</SPAN><SPAN class="lnr">25 </SPAN><SPAN class="Statement">for</SPAN> j = <SPAN class="Constant">1</SPAN>:(length(Rf))
<SPAN class="lnr">26 </SPAN>    Rt(j) = Rf(j) <SPAN class="Statement">*</SPAN> (<SPAN class="Constant">1</SPAN><SPAN class="Statement">+</SPAN> KD <SPAN class="Statement">./</SPAN> (concentrations(j) <SPAN class="Statement">-</SPAN> Rf(j)))<SPAN class="Special">;</SPAN><SPAN class="lnr">27 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">28 </SPAN><SPAN class="lnr">29 </SPAN><SPAN class="Statement">end</SPAN></PRE></DIV><P><STRONG>FluoroLP.m</STRONG></P><P>
    This function has a similar role to FluoroLR.m, except using fluorescent protein concentrations and converting it to protein concentration.
</P><DIV class="slide" style="cursor: pointer; color: #990000;">--&gt;Click to Show/Hide Code&lt;--</DIV><DIV class="view"><PRE><SPAN class="lnr"> 1 </SPAN><SPAN class="Identifier">function</SPAN><SPAN class="Identifier">[</SPAN>Pt<SPAN class="Identifier">]</SPAN> = FluoroLP (Pf, concentrationsP)
<SPAN class="lnr"> 2 </SPAN>MAG = <SPAN class="Constant">1</SPAN><SPAN class="Statement">*</SPAN><SPAN class="Constant">10</SPAN><SPAN class="Statement">^</SPAN>(<SPAN class="Statement">-</SPAN><SPAN class="Constant">9</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="Comment">%concentration of dye</SPAN><SPAN class="lnr"> 3 </SPAN>Pfmax = <SPAN class="Constant">1</SPAN><SPAN class="Statement">*</SPAN><SPAN class="Constant">10</SPAN><SPAN class="Statement">^</SPAN>(<SPAN class="Statement">-</SPAN><SPAN class="Constant">10</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="Comment">%max concentration of the protein</SPAN><SPAN class="lnr"> 4 </SPAN>KD2 = <SPAN class="Constant">464</SPAN><SPAN class="Statement">*</SPAN><SPAN class="Constant">10</SPAN><SPAN class="Statement">^</SPAN>(<SPAN class="Statement">-</SPAN><SPAN class="Constant">9</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr"> 5 </SPAN><SPAN class="lnr"> 6 </SPAN><SPAN class="lnr"> 7 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr"> 8 </SPAN><SPAN class="Comment">%Relates the protein fluorescence levels with the total protein levels%</SPAN><SPAN class="lnr"> 9 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">10 </SPAN><SPAN class="lnr">11 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">12 </SPAN><SPAN class="Comment">%fluorescence is measured, Pf is the fluorescent protein concentration%</SPAN><SPAN class="lnr">13 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">14 </SPAN><SPAN class="lnr">15 </SPAN><SPAN class="Comment">%b = max(fluorescenceP) ./ Pfmax;</SPAN><SPAN class="lnr">16 </SPAN><SPAN class="Comment">%Pf = zeros(length(fluorescenceP), 1);</SPAN><SPAN class="lnr">17 </SPAN><SPAN class="Comment">%for i = 1:(length(fluorescenceP))</SPAN><SPAN class="lnr">18 </SPAN><SPAN class="Comment">%    Pf(i) = fluorescenceP(i) ./ b;</SPAN><SPAN class="lnr">19 </SPAN><SPAN class="Comment">%end</SPAN><SPAN class="lnr">20 </SPAN><SPAN class="lnr">21 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">22 </SPAN><SPAN class="Comment">%Pt is the total protein concentration%</SPAN><SPAN class="lnr">23 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">24 </SPAN><SPAN class="lnr">25 </SPAN>Pt = <SPAN class="Identifier">[]</SPAN><SPAN class="Special">;</SPAN><SPAN class="lnr">26 </SPAN><SPAN class="Statement">for</SPAN> j = <SPAN class="Constant">1</SPAN>:(length(concentrationsP))
<SPAN class="lnr">27 </SPAN>    Pt(j) = Pf(j) <SPAN class="Statement">*</SPAN> (<SPAN class="Constant">1</SPAN><SPAN class="Statement">+</SPAN> KD2 <SPAN class="Statement">./</SPAN> (concentrationsP(j) <SPAN class="Statement">-</SPAN> Pf(j)))<SPAN class="Special">;</SPAN><SPAN class="lnr">28 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">29 </SPAN><SPAN class="Statement">end</SPAN></PRE></DIV><P><STRONG>mRNAexpress.m</STRONG></P><P>
    Fluoro2.m then takes the total mRNA concentrations passed by FluoroLR.m and passes it to mRNAexpress.m, which calculates the transcriptional efficiency.
    This is done via the differential equation
</P>

    \begin{equation}\frac{d[R]}{dt} = Ts \cdot [D] - \alpha \cdot [R]\end{equation}

<P>
    to which the solution is
</P><P>
\begin{equation} Ts = \frac{[R] \cdot \alpha}{[D] \cdot (1 - e^{-\alpha \cdot t})}\end{equation}
</P><P>
    where $[R]$ is mRNA concentration, $Ts$ is transcriptional efficiency, $[D]$ is DNA concentration, and $\alpha$ is the mRNA degradation coefficient.
</P><DIV class="slide" style="cursor: pointer; color: #990000;">--&gt;Click to Show/Hide Code&lt;--</DIV><DIV class="view"><PRE><SPAN class="lnr"> 1 </SPAN><SPAN class="Identifier">function</SPAN><SPAN class="Identifier">[</SPAN> ETF <SPAN class="Identifier">]</SPAN> = mRNAexpress ( fluortime, DNA, Rt, alpha2 )
<SPAN class="lnr"> 2 </SPAN><SPAN class="Comment">%mRNA expression model</SPAN><SPAN class="lnr"> 3 </SPAN><SPAN class="lnr"> 4 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr"> 5 </SPAN><SPAN class="Comment">%DNA is measured%</SPAN><SPAN class="lnr"> 6 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr"> 7 </SPAN><SPAN class="lnr"> 8 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr"> 9 </SPAN><SPAN class="Comment">%ET is the transcriptional efficiency, ETF is the average%</SPAN><SPAN class="lnr">10 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr">11 </SPAN><SPAN class="lnr">12 </SPAN><SPAN class="Statement">for</SPAN> k = <SPAN class="Constant">1</SPAN>:(length(Rt))
<SPAN class="lnr">13 </SPAN><SPAN class="Statement">if</SPAN> fluortime(k) <SPAN class="Statement">~</SPAN>= <SPAN class="Constant">0</SPAN><SPAN class="lnr">14 </SPAN>        ET(k) = Rt(k) <SPAN class="Statement">*</SPAN> alpha2 <SPAN class="Statement">./</SPAN> DNA <SPAN class="Statement">./</SPAN>(<SPAN class="Constant">1</SPAN><SPAN class="Statement">-</SPAN><SPAN class="Statement">exp</SPAN>(<SPAN class="Statement">-</SPAN>alpha2 <SPAN class="Statement">*</SPAN> (fluortime(k))))<SPAN class="Special">;</SPAN><SPAN class="lnr">15 </SPAN><SPAN class="Statement">else</SPAN><SPAN class="lnr">16 </SPAN>        ET(k) = Rt(k) <SPAN class="Statement">*</SPAN> alpha2 <SPAN class="Statement">./</SPAN> DNA <SPAN class="Statement">./</SPAN>(<SPAN class="Constant">1</SPAN><SPAN class="Statement">-</SPAN><SPAN class="Statement">exp</SPAN>(<SPAN class="Statement">-</SPAN>alpha2 <SPAN class="Statement">*</SPAN> (<SPAN class="Constant">.2</SPAN>)))<SPAN class="Special">;</SPAN><SPAN class="lnr">17 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">18 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">19 </SPAN>ET<SPAN class="Special">;</SPAN><SPAN class="lnr">20 </SPAN>ET = ET(<SPAN class="Constant">2</SPAN>:<SPAN class="Statement">end</SPAN>)<SPAN class="Special">;</SPAN><SPAN class="lnr">21 </SPAN>ETF = <SPAN class="Statement">mean</SPAN>(ET)<SPAN class="Special">;</SPAN><SPAN class="lnr">22 </SPAN><SPAN class="Comment">%ETF = ET;</SPAN><SPAN class="lnr">23 </SPAN><SPAN class="Statement">end</SPAN></PRE></DIV><P><STRONG>proteinexpress.m</STRONG></P><P>
    Fluoro2.m takes the transcriptional efficiency from mRNAexpress.m, total protein concentrations from FluoroLP.m, and alpha2 and beta2 from Degradation.m
    and DegradationP.m, and passes them to proteinexpress.m. proteinexpress.m computes the translational efficiency using the differential equation
</P><P>
    \begin{equation}\frac{d[P]}{dt} = [R] \cdot Tl - \beta \cdot [P]\end{equation}
</P><P>
    to which the solution is
</P><P>
\begin{equation}Tl = \frac{[P]}{\frac{Ts \cdot [D]}{(\alpha \cdot \beta)} \cdot (1 - e^{-\beta \cdot t}) - \frac{Ts \cdot [D]}{\alpha \cdot (-\alpha + \beta)} \cdot (e^{-\alpha \cdot t} - e^{-\beta \cdot t})} \label{eq:Tl}\end{equation}
</P><P>
    where Tl is translational efficiency, beta is the protein degradation coefficient, and [P] is the protein concentration.
</P><DIV class="slide" style="cursor: pointer; color: #990000;">--&gt;Click to Show/Hide Code&lt;--</DIV><DIV class="view"><PRE><SPAN class="lnr"> 1 </SPAN><SPAN class="Identifier">function</SPAN><SPAN class="Identifier">[</SPAN> Tl <SPAN class="Identifier">]</SPAN> = proteinexpress (DNA, Pt, ETF, alpha2, beta2)
<SPAN class="lnr"> 2 </SPAN><SPAN class="Comment">%proteinexpress</SPAN><SPAN class="lnr"> 3 </SPAN><SPAN class="lnr"> 4 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr"> 5 </SPAN><SPAN class="Comment">%differential equation comes from: dP./dt = Trans * RNA - beta * P%</SPAN><SPAN class="lnr"> 6 </SPAN><SPAN class="Comment">%want to solve for Trans, the translational efficiency            %</SPAN><SPAN class="lnr"> 7 </SPAN><SPAN class="Comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</SPAN><SPAN class="lnr"> 8 </SPAN><SPAN class="lnr"> 9 </SPAN><SPAN class="Statement">for</SPAN> k = <SPAN class="Constant">1</SPAN>:length(Pt)
<SPAN class="lnr">10 </SPAN>    Trans(k) = Pt(k) <SPAN class="Statement">./</SPAN> (ETF <SPAN class="Statement">*</SPAN> DNA <SPAN class="Statement">./</SPAN> (alpha2 <SPAN class="Statement">*</SPAN> beta2) <SPAN class="Statement">*</SPAN><SPAN class="Comment">...</SPAN><SPAN class="lnr">11 </SPAN>    (<SPAN class="Constant">1</SPAN><SPAN class="Statement">-</SPAN><SPAN class="Statement">exp</SPAN>(<SPAN class="Statement">-</SPAN>beta2 <SPAN class="Statement">*</SPAN> (k <SPAN class="Statement">-</SPAN><SPAN class="Constant">1</SPAN>))) <SPAN class="Statement">-</SPAN> ETF <SPAN class="Statement">*</SPAN> DNA <SPAN class="Statement">./</SPAN> (alpha2 <SPAN class="Statement">*</SPAN><SPAN class="Comment">...</SPAN><SPAN class="lnr">12 </SPAN>    (<SPAN class="Statement">-</SPAN>alpha2 <SPAN class="Statement">+</SPAN> beta2)) <SPAN class="Statement">*</SPAN> (<SPAN class="Statement">exp</SPAN>(<SPAN class="Statement">-</SPAN>alpha2 <SPAN class="Statement">*</SPAN> (k <SPAN class="Statement">-</SPAN><SPAN class="Constant">1</SPAN>)) <SPAN class="Statement">-</SPAN><SPAN class="Statement">exp</SPAN>(<SPAN class="Statement">-</SPAN>beta2 <SPAN class="Statement">*</SPAN> (k <SPAN class="Statement">-</SPAN><SPAN class="Constant">1</SPAN>))))<SPAN class="Special">;</SPAN><SPAN class="lnr">13 </SPAN><SPAN class="Statement">end</SPAN><SPAN class="lnr">14 </SPAN><SPAN class="lnr">15 </SPAN><SPAN class="Comment">%for k = 1:length(ETF)</SPAN><SPAN class="lnr">16 </SPAN><SPAN class="Comment">%    Pt(k) = Trans * (ETF(k) * DNA ./ (alpha2 * beta2) * (1 -...</SPAN><SPAN class="lnr">17 </SPAN><SPAN class="Comment">%    exp(-beta2 * (k - 1))) - ETF(k) * DNA ./ (alpha2 *...</SPAN><SPAN class="lnr">18 </SPAN><SPAN class="Comment">%    (-alpha2 + beta2)) * (exp(-alpha2 * (k - 1)) - ...</SPAN><SPAN class="lnr">19 </SPAN><SPAN class="Comment">%    exp(-beta2 * (k - 1))));</SPAN><SPAN class="lnr">20 </SPAN><SPAN class="Comment">%    </SPAN><SPAN class="lnr">21 </SPAN><SPAN class="Comment">%end</SPAN><SPAN class="lnr">22 </SPAN><SPAN class="lnr">23 </SPAN>Tl = <SPAN class="Statement">mean</SPAN>(Trans)<SPAN class="Special">;</SPAN><SPAN class="lnr">24 </SPAN><SPAN class="Statement">end</SPAN></PRE></DIV><P><STRONG>PoPS.m</STRONG></P><P>
    Fluoro2.m passes to the final function alpha2 and beta2 from Degradation.m and DegradationP.m, total protein concentration from FluoroLP.m, and
    translational efficiency from proteinexpress.m. PoPS.m calculates the approximate polymerase per second using the equation
</P><P>
    \begin{equation}PoPS = \frac{\alpha \cdot \beta \cdot [P]}{n \cdot Tl} \label{eq:PoPS}\end{equation}
</P><P>
    where n is the approximate number of the promoters of interest in a cell (i.e., plasmid copy).
</P><DIV class="slide" style="cursor: pointer; color: #990000;">--&gt;Click to Show/Hide Code&lt;--</DIV><DIV class="view"><PRE><SPAN class="lnr">1 </SPAN><SPAN class="Identifier">function</SPAN><SPAN class="Identifier">[</SPAN> PoPS <SPAN class="Identifier">]</SPAN> = PoPS( alpha2, beta2, Pt, Tl )
<SPAN class="lnr">2 </SPAN><SPAN class="Comment">%This function calculates Polymerase per second given a few parameters</SPAN><SPAN class="lnr">3 </SPAN><SPAN class="Comment">%This equation is valid at steady state.</SPAN><SPAN class="lnr">4 </SPAN><SPAN class="lnr">5 </SPAN>n = <SPAN class="Constant">1</SPAN><SPAN class="Special">;</SPAN><SPAN class="lnr">6 </SPAN>PoPS = alpha2 <SPAN class="Statement">*</SPAN> beta2 <SPAN class="Statement">*</SPAN> Pt <SPAN class="Statement">./</SPAN> (n <SPAN class="Statement">*</SPAN> Tl)<SPAN class="Special">;</SPAN><SPAN class="lnr">7 </SPAN><SPAN class="lnr">8 </SPAN><SPAN class="Statement">end</SPAN></PRE></DIV><H1 id="section1-3">Outputs</H1><P>
    The model outputs polymerase per second, although transcriptional efficiency and translational efficiency are also important factors in the model.
    Derivations of these equations can be found on the <A href="https://2012.igem.org/Team:Carnegie_Mellon/Mod-Derivations">derivations page</A>.
</P></DIV></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2012.igem.org/Team:Carnegie_Mellon/Mod-Matlab">http://2012.igem.org/Team:Carnegie_Mellon/Mod-Matlab</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Carnegie_Mellon/Mod-Matlab" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Carnegie_Mellon/Mod-Matlab" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Carnegie_Mellon/Mod-Matlab&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Carnegie_Mellon/Mod-Matlab&amp;oldid=297732" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2012.igem.org:Privacy_policy" title="2012.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2012.igem.org:General_disclaimer" title="2012.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>