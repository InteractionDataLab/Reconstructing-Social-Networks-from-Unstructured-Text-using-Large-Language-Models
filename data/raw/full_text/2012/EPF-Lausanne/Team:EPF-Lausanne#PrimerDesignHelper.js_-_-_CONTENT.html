<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_EPF-Lausanne_PrimerDesignHelper_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:EPF-Lausanne/PrimerDesignHelper.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:EPF-Lausanne/PrimerDesignHelper.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:EPF-Lausanne/PrimerDesignHelper.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:EPF-Lausanne/PrimerDesignHelper.js&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:EPF-Lausanne/PrimerDesignHelper.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform">Â </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:EPF-Lausanne/PrimerDesignHelper.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2012.igem.org</H3><P>/*
Immutable class that makes it possible to work with (very simplified) DNA sequences
</P><UL><LI>/
</LI></UL><P>var DNA,
</P><PRE> __indexOf = Array.prototype.indexOf || function(item) { for (var i = 0, l = this.length; i &lt; l; i++) { if (i in this &amp;&amp; this[i] === item) return i; } return -1; };
</PRE><P>DNA = (function() {
</P><PRE> DNA.allowed = [&quot;A&quot;, &quot;C&quot;, &quot;G&quot;, &quot;T&quot;];
</PRE><PRE> DNA.extendedAllowed = [&quot;A&quot;, &quot;C&quot;, &quot;G&quot;, &quot;T&quot;, &quot;R&quot;, &quot;Y&quot;, &quot;K&quot;, &quot;M&quot;, &quot;S&quot;, &quot;W&quot;, &quot;B&quot;, &quot;D&quot;, &quot;H&quot;, &quot;V&quot;, &quot;N&quot;];
</PRE><PRE> DNA.RS = {
   AatI: &quot;AGGCCT&quot;,
   AatII: &quot;GACGTC&quot;,
   AccI: &quot;GTMKAC&quot;,
   AccIII: &quot;TCCGGA&quot;,
   Acc65I: &quot;GGTACC&quot;,
   AcsI: &quot;RAATTY&quot;,
   AcyI: &quot;GRCGYC&quot;,
   AflI: &quot;GGWCC&quot;,
   AflII: &quot;CTTAAG&quot;,
   AflIII: &quot;ACRYGT&quot;,
   AgeI: &quot;ACCGGT&quot;,
   AhaII: &quot;GRCGYC&quot;,
   AhaIII: &quot;TTTAAA&quot;,
   AluI: &quot;AGCT&quot;,
   Alw44I: &quot;GTGCAC&quot;,
   AlwNI: &quot;CAGNNNCTG&quot;,
   AocI: &quot;CCTNAGG&quot;,
   AosI: &quot;TGCGCA&quot;,
   ApaI: &quot;GGGCCC&quot;,
   ApaLI: &quot;GTGCAC&quot;,
   ApoI: &quot;RAATTY&quot;,
   ApyI: &quot;CCWGG&quot;,
   AscI: &quot;GGCGCGCC&quot;,
   AseI: &quot;ATTAAT&quot;,
   AsnI: &quot;ATTAAT&quot;,
   AspI: &quot;GACNNNGTC&quot;,
   Asp700: &quot;GAANNNNTTC&quot;,
   Asp718: &quot;GGTACC&quot;,
   AspEI: &quot;GACNNNNNGTC&quot;,
   AspHI: &quot;GWGCWC&quot;,
   AsuII: &quot;TTCGAA&quot;,
   AvaI: &quot;CYCGRG&quot;,
   AvaII: &quot;GGWCC&quot;,
   AviII: &quot;TGCGCA&quot;,
   AvrII: &quot;CCTAGG&quot;,
   BalI: &quot;TGGCCA&quot;,
   BamHI: &quot;GGATCC&quot;,
   BanI: &quot;GGYRCC&quot;,
   BanII: &quot;GRGCYC&quot;,
   BbrPI: &quot;CACGTG&quot;,
   BclI: &quot;TGATCA&quot;,
   BfaI: &quot;CTAG&quot;,
   BfrI: &quot;CTTAAG&quot;,
   BglI: &quot;GCCNNNNNGGC&quot;,
   BglII: &quot;AGATCT&quot;,
   BinI: &quot;CCTAGG&quot;,
   BmyI: &quot;GDGCHC&quot;,
   Bpu1102I: &quot;GCTNAGC&quot;,
   BsaAI: &quot;YACGTR&quot;,
   BsaBI: &quot;GATNNNNATC&quot;,
   BsaHI: &quot;GRCGYC&quot;,
   BsaJI: &quot;CCNNGG&quot;,
   BseAI: &quot;TCCGGA&quot;,
   BsePI: &quot;GCGCGC&quot;,
   BsiEI: &quot;CGRYCG&quot;,
   BsiWI: &quot;CGTACG&quot;,
   BsiYI: &quot;CCNNNNNNNGG&quot;,
   BslI: &quot;CCNNNNNNNGG&quot;,
   Bsp1286I: &quot;GDGCHC&quot;,
   Bsp1407I: &quot;TGTACA&quot;,
   BspDI: &quot;ATCGAT&quot;,
   BspEI: &quot;TCCGGA&quot;,
   BspHI: &quot;TCATGA&quot;,
   BspLU11I: &quot;ACATGT&quot;,
   BsrFI: &quot;RCCGGY&quot;,
   BssGI: &quot;CCANNNNNNTGG&quot;,
   BssHII: &quot;GCGCGC&quot;,
   Bst1107I: &quot;GTATAC&quot;,
   BstBI: &quot;TTCGAA&quot;,
   BstEII: &quot;GGTNACC&quot;,
   BstNI: &quot;CCWGG&quot;,
   BstUI: &quot;CGCG&quot;,
   BstXI: &quot;CCANNNNNNTGG&quot;,
   BstYI: &quot;RGATCY&quot;,
   Bsu36I: &quot;CCTNAGG&quot;,
   CelII: &quot;GCTNAGC&quot;,
   CfoI: &quot;GCGC&quot;,
   CfrI: &quot;YGGCCR&quot;,
   Cfr10I: &quot;RCCGGY&quot;,
   ClaI: &quot;ATCGAT&quot;,
   DdeI: &quot;CTNAG&quot;,
   DpnII: &quot;GATC&quot;,
   DraI: &quot;TTTAAA&quot;,
   DraII: &quot;RGGNCCY&quot;,
   DraIII: &quot;CACNNNGTG&quot;,
   DrdI: &quot;GACNNNNNNGTC&quot;,
   DsaI: &quot;CCRYGG&quot;,
   EaeI: &quot;YGGCCR&quot;,
   EagI: &quot;CGGCCG&quot;,
   Eam1105I: &quot;GACNNNNNGTC&quot;,
   Ecl136II: &quot;GAGCTC&quot;,
   EclXI: &quot;CGGCCG&quot;,
   Eco47III: &quot;AGCGCT&quot;,
   EcoNI: &quot;CCTNNNNNAGG&quot;,
   EcoO109I: &quot;RGGNCCY&quot;,
   EcoRI: &quot;GAATTC&quot;,
   EcoRII: &quot;CCWGG&quot;,
   EcoRV: &quot;GATATC&quot;,
   EspI: &quot;GCTNAGC&quot;,
   FnuDII: &quot;CGCG&quot;,
   Fnu4HI: &quot;GCNGC&quot;,
   FseI: &quot;GGCCGGCC&quot;,
   FspI: &quot;TGCGCA&quot;,
   HaeII: &quot;RGCGCY&quot;,
   HaeIII: &quot;GGCC&quot;,
   HgiAI: &quot;GWGCWC&quot;,
   HhaI: &quot;GCGC&quot;,
   HincII: &quot;GTYRAC&quot;,
   HindII: &quot;GTYRAC&quot;,
   HindIII: &quot;AAGCTT&quot;,
   HinfI: &quot;GANTC&quot;,
   HinPI: &quot;GCGC&quot;,
   HpaI: &quot;GTTAAC&quot;,
   HpaII: &quot;CCGG&quot;,
   ItaI: &quot;GCNGC&quot;,
   KasI: &quot;GGCGCC&quot;,
   KpnI: &quot;GGTACC&quot;,
   KspI: &quot;CCGCGG&quot;,
   MaeI: &quot;CTAG&quot;,
   MaeII: &quot;ACGT&quot;,
   MaeIII: &quot;GTNAC&quot;,
   MamI: &quot;GATNNNNATC&quot;,
   MboI: &quot;GATC&quot;,
   MfeI: &quot;CAATTG&quot;,
   MluI: &quot;ACGCGT&quot;,
   MluNI: &quot;TGGCCA&quot;,
   MroI: &quot;TCCGGA&quot;,
   MscI: &quot;TGGCCA&quot;,
   MseI: &quot;TTAA&quot;,
   MspI: &quot;CCGG&quot;,
   MstI: &quot;TGCGCA&quot;,
   MstII: &quot;CCTNAGG&quot;,
   MunI: &quot;CAATTG&quot;,
   MvaI: &quot;CCWGG&quot;,
   MvnI: &quot;CGCG&quot;,
   NaeI: &quot;GCCGGC&quot;,
   NarI: &quot;GGCGCC&quot;,
   NciI: &quot;CCSGG&quot;,
   NcoI: &quot;CCATGG&quot;,
   NdeI: &quot;CATATG&quot;,
   NdeII: &quot;GATC&quot;,
   NgoMI: &quot;GCCGGC&quot;,
   NheI: &quot;GCTAGC&quot;,
   NlaIII: &quot;CATG&quot;,
   NlaIV: &quot;GGNNCC&quot;,
   NotI: &quot;GCGGCCGC&quot;,
   NruI: &quot;TCGCGA&quot;,
   NsiI: &quot;ATGCAT&quot;,
   NspBII: &quot;CMGCKG&quot;,
   NspI: &quot;RCATGY&quot;,
   NspII: &quot;GDGCHC&quot;,
   NspV: &quot;TTCGAA&quot;,
   PacI: &quot;TTAATTAA&quot;,
   PaeR7I: &quot;CTCGAG&quot;,
   PflMI: &quot;CCANNNNNTGG&quot;,
   PinAI: &quot;ACCGGT&quot;,
   PsiI: &quot;TTATAA&quot;,
   PmaCI: &quot;CACGTG&quot;,
   PmeI: &quot;GTTTAAAC&quot;,
   PmlI: &quot;CACGTG&quot;,
   PpuMI: &quot;RGGWCCY&quot;,
   Psp1406I: &quot;AACGTT&quot;,
   PstI: &quot;CTGCAG&quot;,
   PvuI: &quot;CGATCG&quot;,
   PvuII: &quot;CAGCTG&quot;,
   RcaI: &quot;TCATGA&quot;,
   RmaI: &quot;CTAG&quot;,
   RsaI: &quot;GTAC&quot;,
   RsrII: &quot;CGGWCCG&quot;,
   SacI: &quot;GAGCTC&quot;,
   SacII: &quot;CCGCGG&quot;,
   SalI: &quot;GTCGAC&quot;,
   SauI: &quot;CCTNAGG&quot;,
   Sau3AI: &quot;GATC&quot;,
   Sau96I: &quot;GGNCC&quot;,
   ScaI: &quot;AGTACT&quot;,
   ScrFI: &quot;CCNGG&quot;,
   SexAI: &quot;ACCWGGT&quot;,
   SfcI: &quot;CTRYAG&quot;,
   SfiI: &quot;GGCCNNNNNGGCC&quot;,
   SfuI: &quot;TTCGAA&quot;,
   SgrAI: &quot;CRCCGGYG&quot;,
   SmaI: &quot;CCCGGG&quot;,
   SnaBI: &quot;TACGTA&quot;,
   SnoI: &quot;GTGCAC&quot;,
   SpeI: &quot;ACTAGT&quot;,
   SphI: &quot;GCATGC&quot;,
   SrfI: &quot;GCCCGGGC&quot;,
   Sse8387I: &quot;CCTGCAGG&quot;,
   SspI: &quot;AATATT&quot;,
   SspBI: &quot;TGTACA&quot;,
   SstI: &quot;GAGCTC&quot;,
   SstII: &quot;CCGCGG&quot;,
   StuI: &quot;AGGCCT&quot;,
   StyI: &quot;CCWWGG&quot;,
   SwaI: &quot;ATTTAAAT&quot;,
   TaqI: &quot;TCGA&quot;,
   TfiI: &quot;GAWTC&quot;,
   ThaI: &quot;CGCG&quot;,
   Tru9I: &quot;TTAA&quot;,
   Tth111I: &quot;GACNNNGTC&quot;,
   Van91I: &quot;CCANNNNNTGG&quot;,
   XbaI: &quot;TCTAGA&quot;,
   XcmI: &quot;CCANNNNNNNNNTGG&quot;,
   XhoI: &quot;CTCGAG&quot;,
   XhoII: &quot;RGATCY&quot;,
   XmaI: &quot;CCCGGG&quot;,
   XmaIII: &quot;CGGCCG&quot;,
   XmnI: &quot;GAANNNNTTC&quot;
 };
</PRE><PRE> DNA.cutPositions = {
   AatI: 3,
   AatII: 5,
   AccI: 2,
   AccIII: 1,
   Acc65I: 1,
   AcsI: 1,
   AcyI: 2,
   AflI: 1,
   AflII: 1,
   AflIII: 1,
   AgeI: 1,
   AhaII: 2,
   AhaIII: 3,
   AluI: 2,
   Alw44I: 1,
   AlwNI: 6,
   AocI: 2,
   AosI: 3,
   ApaI: 5,
   ApaLI: 1,
   ApoI: 1,
   ApyI: 0,
   AscI: 2,
   AseI: 2,
   AsnI: 2,
   AspI: 4,
   Asp700: 5,
   Asp718: 1,
   AspEI: 6,
   AspHI: 5,
   AsuII: 2,
   AvaI: 1,
   AvaII: 1,
   AviII: 3,
   AvrII: 1,
   BalI: 3,
   BamHI: 1,
   BanI: 1,
   BanII: 5,
   BbrPI: 3,
   BclI: 1,
   BfaI: 1,
   BfrI: 1,
   BglI: 7,
   BglII: 1,
   BinI: 1,
   BmyI: 5,
   Bpu1102I: 2,
   BsaAI: 3,
   BsaBI: 5,
   BsaHI: 2,
   BsaJI: 1,
   BseAI: 1,
   BsePI: 1,
   BsiEI: 4,
   BsiWI: 1,
   BsiYI: 7,
   BslI: 7,
   Bsp1286I: 5,
   Bsp1407I: 1,
   BspDI: 2,
   BspEI: 1,
   BspHI: 1,
   BspLU11I: 1,
   BsrFI: 1,
   BssGI: 8,
   BssHII: 1,
   Bst1107I: 3,
   BstBI: 2,
   BstEII: 1,
   BstNI: 2,
   BstUI: 2,
   BstXI: 8,
   BstYI: 1,
   Bsu36I: 2,
   CelII: 2,
   CfoI: 3,
   CfrI: 1,
   Cfr10I: 1,
   ClaI: 2,
   DdeI: 1,
   DpnII: 0,
   DraI: 3,
   DraII: 2,
   DraIII: 6,
   DrdI: 7,
   DsaI: 1,
   EaeI: 1,
   EagI: 1,
   Eam1105I: 6,
   Ecl136II: 3,
   EclXI: 1,
   Eco47III: 3,
   EcoNI: 5,
   EcoO109I: 2,
   EcoRI: 1,
   EcoRII: 0,
   EcoRV: 3,
   EspI: 2,
   FnuDII: 2,
   Fnu4HI: 2,
   FseI: 6,
   FspI: 3,
   HaeII: 5,
   HaeIII: 2,
   HgiAI: 5,
   HhaI: 3,
   HincII: 3,
   HindII: 3,
   HindIII: 1,
   HinfI: 1,
   HinPI: 1,
   HpaI: 3,
   HpaII: 1,
   ItaI: 2,
   KasI: 1,
   KpnI: 5,
   KspI: 4,
   MaeI: 1,
   MaeII: 1,
   MaeIII: 0,
   MamI: 5,
   MboI: 0,
   MfeI: 1,
   MluI: 1,
   MluNI: 3,
   MroI: 1,
   MscI: 3,
   MseI: 1,
   MspI: 1,
   MstI: 3,
   MstII: 2,
   MunI: 1,
   MvaI: 2,
   MvnI: 2,
   NaeI: 3,
   NarI: 2,
   NciI: 2,
   NcoI: 1,
   NdeI: 2,
   NdeII: 0,
   NgoMI: 1,
   NheI: 1,
   NlaIII: 4,
   NlaIV: 3,
   NotI: 2,
   NruI: 3,
   NsiI: 5,
   NspBII: 3,
   NspI: 5,
   NspII: 5,
   NspV: 2,
   PacI: 5,
   PaeR7I: 1,
   PflMI: 7,
   PinAI: 1,
   PsiI: 3,
   PmaCI: 3,
   PmeI: 4,
   PmlI: 3,
   PpuMI: 2,
   Psp1406I: 2,
   PstI: 5,
   PvuI: 4,
   PvuII: 3,
   RcaI: 1,
   RmaI: 1,
   RsaI: 2,
   RsrII: 2,
   SacI: 5,
   SacII: 4,
   SalI: 1,
   SauI: 2,
   Sau3AI: 0,
   Sau96I: 1,
   ScaI: 3,
   ScrFI: 2,
   SexAI: 1,
   SfcI: 1,
   SfiI: 8,
   SfuI: 2,
   SgrAI: 2,
   SmaI: 3,
   SnaBI: 3,
   SnoI: 1,
   SpeI: 1,
   SphI: 5,
   SrfI: 4,
   Sse8387I: 6,
   SspI: 3,
   SspBI: 1,
   SstI: 5,
   SstII: 4,
   StuI: 3,
   StyI: 1,
   SwaI: 4,
   TaqI: 1,
   TfiI: 1,
   ThaI: 2,
   Tru9I: 1,
   Tth111I: 4,
   Van91I: 7,
   XbaI: 1,
   XcmI: 8,
   XhoI: 1,
   XhoII: 1,
   XmaI: 1,
   XmaIII: 1,
   XmaCI: 1,
   XmnI: 5
 };
</PRE><PRE> DNA.RSFlipped = void 0;
</PRE><PRE> DNA.getRSFlipped = function() {
   var key, name, seq, value, _ref, _ref2;
   if (this.RSFlipped === void 0) {
     this.RSFlipped = {};
     _ref = this.RS;
     for (name in _ref) {
       seq = _ref[name];
       if (this.RSFlipped[seq]) {
         this.RSFlipped[seq].push(name);
       } else {
         this.RSFlipped[seq] = [name];
       }
     }
     _ref2 = this.RSFlipped;
     for (key in _ref2) {
       value = _ref2[key];
       if (value.length &lt;= 2) {
         this.RSFlipped[key] = value.join(&quot; or &quot;);
       } else {
         this.RSFlipped[key] = value.slice(0, value.length - 1).join(&quot;, &quot;) + &quot; or &quot; + value[value.length - 1];
       }
     }
   }
   return this.RSFlipped;
 };
</PRE><PRE> DNA.getCutPosition = function(rs) {
   var k, v, _ref;
   if (DNA.cutPositions[rs]) {
     return DNA.cutPositions[rs];
   } else {
     _ref = DNA.cutPositions;
     for (k in _ref) {
       v = _ref[k];
       if (k.toLowerCase() === rs.toLowerCase()) return v;
     }
     return -1;
   }
 };
</PRE><PRE> DNA.nucleotideMatches = {
   A: [&quot;A&quot;, &quot;R&quot;, &quot;M&quot;, &quot;W&quot;, &quot;D&quot;, &quot;H&quot;, &quot;V&quot;, &quot;N&quot;],
   C: [&quot;C&quot;, &quot;Y&quot;, &quot;M&quot;, &quot;S&quot;, &quot;B&quot;, &quot;H&quot;, &quot;V&quot;, &quot;N&quot;],
   G: [&quot;G&quot;, &quot;R&quot;, &quot;K&quot;, &quot;S&quot;, &quot;B&quot;, &quot;D&quot;, &quot;V&quot;, &quot;N&quot;],
   T: [&quot;T&quot;, &quot;Y&quot;, &quot;K&quot;, &quot;W&quot;, &quot;B&quot;, &quot;D&quot;, &quot;H&quot;, &quot;N&quot;],
   R: [&quot;A&quot;, &quot;G&quot;],
   Y: [&quot;C&quot;, &quot;T&quot;],
   K: [&quot;G&quot;, &quot;T&quot;],
   M: [&quot;A&quot;, &quot;C&quot;],
   S: [&quot;C&quot;, &quot;G&quot;],
   W: [&quot;A&quot;, &quot;T&quot;],
   B: [&quot;C&quot;, &quot;G&quot;, &quot;T&quot;],
   D: [&quot;A&quot;, &quot;G&quot;, &quot;T&quot;],
   H: [&quot;A&quot;, &quot;C&quot;, &quot;T&quot;],
   V: [&quot;A&quot;, &quot;C&quot;, &quot;G&quot;],
   N: [&quot;A&quot;, &quot;C&quot;, &quot;G&quot;, &quot;T&quot;]
 };
</PRE><PRE> DNA.fromString = function(data) {
   var found, name, seq, sequence, _ref;
   found = false;
   if (dataÂ != null) {
     _ref = this.RS;
     for (name in _ref) {
       sequence = _ref[name];
       if (name.toLowerCase() === data.toLowerCase()) {
         seq = new DNA(sequence.split(<I>));</I>
         found = true;
       }
     }
   } else {
     data = &quot;&quot;;
   }
   if (!found) seq = new DNA(data.toUpperCase().replace(/\s/ig, &quot;&quot;).split(<I>));</I>
   seq.validateData();
   return seq;
 };
</PRE><PRE> DNA.fromRandom = function(length) {
   var data, i;
   if (length === 0 || length === &quot;0&quot; ||Â !length || length === void 0) {
     return new DNA([]);
   } else {
     data = (function() {
       var _results;
       _results = [];
       for (i = 1; 1 &lt;= lengthÂ ? i &lt;= lengthÂ : i &gt;= length; 1 &lt;= lengthÂ ? i++Â : i--) {
         _results.push(DNA.allowed[Math.floor(Math.random() * DNA.allowed.length)]);
       }
       return _results;
     })();
     return new DNA(data);
   }
 };
</PRE><PRE> /*
   The constructor assumes the data has been validated (for performance reasons -&gt; premature and non-consequent
   optimization ^^). Anyway, the DNA.fromString function is probably what you were looking for!
 */
</PRE><PRE> function DNA(data) {
   this.data = data;
 }
</PRE><PRE> DNA.prototype.validateData = function(strict) {
   if (strict) {
     if (this.data.some(function(x) {
       return __indexOf.call(DNA.allowed, x) &lt; 0;
     })) {
       throw new Error(&quot;Invalid character encountered&quot;);
     }
   } else {
     if (this.data.some(function(x) {
       return __indexOf.call(DNA.extendedAllowed, x) &lt; 0;
     })) {
       throw new Error(&quot;Invalid character encountered&quot;);
     }
   }
 };
</PRE><PRE> DNA.prototype.matches = function(seq2) {
   var combined;
   if (this.length()Â !== seq2.length()) return false;
   combined = _.zip(this.data, seq2.data);
   return _.all(combined, function(_arg) {
     var i, j, n1, n1Matches, n2, n2Matches, _ref, _ref2;
     n1 = _arg[0], n2 = _arg[1];
     if (n1 === n2) {
       return true;
     } else {
       if (__indexOf.call(DNA.allowed, n1) &gt;= 0) {
         return __indexOf.call(DNA.nucleotideMatches[n1], n2) &gt;= 0;
       }
       if (__indexOf.call(DNA.allowed, n2) &gt;= 0) {
         return __indexOf.call(DNA.nucleotideMatches[n2], n1) &gt;= 0;
       }
       n1Matches = DNA.nucleotideMatches[n1];
       n2Matches = DNA.nucleotideMatches[n2];
       for (i = 0, _ref = n1Matches.length - 1; 0 &lt;= _refÂ ? i &lt;= _refÂ : i &gt;= _ref; 0 &lt;= _refÂ ? i++Â : i--) {
         for (j = 0, _ref2 = n2Matches.length - 1; 0 &lt;= _ref2Â ? j &lt;= _ref2Â : j &gt;= _ref2; 0 &lt;= _ref2Â ? j++Â : j--) {
           if (n1Matches[i] === n2Matches[j]) return true;
         }
       }
       return false;
     }
   });
 };
</PRE><PRE> DNA.prototype.findRS = function(nameOnly) {
   var key, name, rs, rsDNA, seq, _ref;
   if (nameOnly == null) nameOnly = false;
   if (this.length() &gt; 15) return &quot;&quot;;
   key = this.data.join(&quot;&quot;);
   rs = DNA.getRSFlipped();
   if (rs[key]) {
     if (nameOnly) {
       return rs[key];
     } else {
       return rs[key] + &quot; (5' â 3': &quot; + key + &quot;)&quot;;
     }
   } else {
     _ref = DNA.RS;
     for (seq in _ref) {
       name = _ref[seq];
       rsDNA = DNA.fromString(seq);
       if (this.matches(rsDNA)) {
         if (nameOnly) {
           name;
         } else {
           name + &quot; (5' â 3': &quot; + key + &quot;)&quot;;
         }
       }
     }
     return &quot;&quot;;
   }
 };
</PRE><PRE> DNA.prototype.getCutPosition = function() {
   return DNA.getCutPosition(this.findRS(true));
 };
</PRE><PRE> DNA.prototype.containsRS = function(names) {
   var c, comparisons, i, lengths, name, parts, pos, rs, _i, _j, _len, _len2, _ref;
   comparisons = [];
   for (_i = 0, _len = names.length; _i &lt; _len; _i++) {
     name = names[_i];
     comparisons.push(name.toLowerCase());
   }
   lengths = (function() {
     var _results;
     _results = [];
     for (i = 0; i &lt;= 10; i++) {
       _results.push(&quot;&quot;);
     }
     return _results;
   })();
   rs = DNA.getRSFlipped();
   pos = 0;
   _ref = this.data;
   for (_j = 0, _len2 = _ref.length; _j &lt; _len2; _j++) {
     c = _ref[_j];
     for (i = 4; i &lt;= 10; i++) {
       lengths[i] += c;
       if (i &lt;= pos) lengths[i] = lengths[i].substr(1);
       if (rs[lengths[i]]) {
         parts = rs[lengths[i]].toLowerCase().split(&quot; &quot;);
         if (_.some(comparisons, function(obj) {
           return __indexOf.call(parts, obj) &gt;= 0;
         })) {
           return true;
         }
       }
     }
     pos++;
   }
   return false;
 };
</PRE><PRE> DNA.prototype.length = function() {
   return this.data.length;
 };
</PRE><PRE> DNA.prototype.snip = function(length) {
   if (length &gt;= 0 &amp;&amp; length &lt;= this.data.length) {
     return new DNA(this.data.slice(0, length));
   } else {
     throw new Error(&quot;Invalid snip length (tried to snip a piece of length &quot; + length + &quot; in a sequence of &quot; + this.length() + &quot;bp)&quot;);
   }
 };
</PRE><PRE> DNA.prototype.reverseComplement = function() {
   var complement, k, l, revCompl, v, _len, _ref;
   revCompl = [];
   complement = function(x) {
     switch (x) {
       case &quot;A&quot;:
         return &quot;T&quot;;
       case &quot;T&quot;:
         return &quot;A&quot;;
       case &quot;C&quot;:
         return &quot;G&quot;;
       case &quot;G&quot;:
         return &quot;C&quot;;
       default:
         throw new Error(&quot;Invalid character encountered (&quot; + x + &quot;)&quot;);
     }
   };
   l = this.data.length - 1;
   _ref = this.data;
   for (k = 0, _len = _ref.length; k &lt; _len; k++) {
     v = _ref[k];
     revCompl[l - k] = complement(v);
   }
   return new DNA(revCompl);
 };
</PRE><PRE> DNA.prototype.append = function(seqToAdd) {
   return new DNA(this.data.concat(seqToAdd.data));
 };
</PRE><PRE> DNA.prototype.tm = function() {
   return TmCalc.calc(this.data);
 };
</PRE><PRE> DNA.prototype.toString = function() {
   return this.data.join(&quot;&quot;);
 };
</PRE><PRE> DNA.prototype.toJSON = function() {
   return this.toString();
 };
</PRE><PRE> DNA.prototype.clone = function() {
   return new DNA(this.data.slice(0));
 };
</PRE><PRE> return DNA;
</PRE><P>})();
var DNAInput, DNARSInput, DNASmallInput, Input, InputForm, NumberInput, RadioInput, SelectInput, Separator, Submit, TemperatureInput,
</P><PRE> __hasProp = Object.prototype.hasOwnProperty,
 __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor; child.__super__ = parent.prototype; return child; };
</PRE><P>InputForm = (function() {
</P><PRE> InputForm.i = 0;
</PRE><PRE> /*
   [{
     name: &quot;tm&quot;,
     readableName: &quot;Tm&quot;,
     type: &quot;TemperatureInput&quot;,
     label: &quot;Tm&quot;
   }]
 */
</PRE><PRE> InputForm.create = function(options, objects) {
   var f;
   f = new InputForm(options);
   objects.forEach(function(x) {
     return f.addInput(x);
   });
   return f;
 };
</PRE><PRE> function InputForm(_arg) {
   this.update = _arg.update, this.submit = _arg.submit, this.name = _arg.name;
   this.id = &quot;inputform-&quot; + InputForm.i++;
   this.inputs = [];
   this.inputDict = {};
   this.lastValue = {};
 }
</PRE><PRE> InputForm.prototype.save = function(data) {
   var k, tempData, v;
   try {
     if (JSON &amp;&amp; localStorage) {
       tempData = {};
       for (k in data) {
         v = data[k];
         if (k === &quot;leftRS&quot; || k === &quot;rightRS&quot;) v = v.rs;
         tempData[k] = v;
       }
       return localStorage.setItem(&quot;values&quot;, JSON.stringify(tempData));
     }
   } catch (e) {
</PRE><PRE>   }
 };
</PRE><PRE> InputForm.prototype.restore = function() {
   var k, oldVals, v, _results;
   try {
     if (JSON &amp;&amp; localStorage) {
       oldVals = localStorage.getItem(&quot;values&quot;);
       if (oldValsÂ != null) {
         oldVals = JSON.parse(oldVals);
         _results = [];
         for (k in oldVals) {
           v = oldVals[k];
           _results.push(this.inputDict[k].value(v));
         }
         return _results;
       }
     }
   } catch (e) {
</PRE><PRE> }
 };
</PRE><PRE> InputForm.prototype.attach = function(elem) {
   $(elem).append(this.generateDOM());
   $(&quot;.help-block&quot;).hide();
   this.restore();
   return this.updateCallback();
 };
</PRE><PRE> InputForm.prototype.submitCallback = function() {
   var changed, data, error, messages, _ref;
   _ref = this.getFormData(), data = _ref.data, messages = _ref.messages, error = _ref.error, changed = _ref.changed;
   return typeof this.submit === &quot;function&quot;Â ? this.submit(data, messages, error)Â : void 0;
 };
</PRE><PRE> InputForm.prototype.updateCallback = function() {
   var changed, data, error, messages, _ref;
   if (this.disableAuto) return;
   _ref = this.getFormData(), data = _ref.data, messages = _ref.messages, error = _ref.error, changed = _ref.changed;
   if (changed) {
     return typeof this.update === &quot;function&quot;Â ? this.update(data, messages, error)Â : void 0;
   }
 };
</PRE><PRE> InputForm.prototype.getFormData = function() {
   var changed, data, error, messages;
   data = {};
   messages = [];
   error = false;
   this.inputs.forEach(function(x) {
     var val;
     val = void 0;
     try {
       val = x.value();
     } catch (e) {
       messages.push(&quot;Error: &quot; + e.message);
     }
     if (!x.validate(val)) {
       error = true;
       messages.push(&quot;The value of &quot; + x.get(&quot;label&quot;) + &quot; is invalid&quot;);
     }
     if (x.get(&quot;name&quot;)Â != null) return data[x.get(&quot;name&quot;)] = val;
   });
   changed = false;
   if (!_.isEqual(this.lastValue, data)) {
     changed = true;
     this.inputs.forEach(function(x) {
       if (x.visible(data)) {
         return x.show();
       } else {
         return x.hide();
       }
     });
     this.lastValue = data;
     this.save(data);
   }
   return {
     data: data,
     messages: messages,
     error: error,
     changed: changed
   };
 };
</PRE><PRE> InputForm.prototype.addInput = function(input) {
   var callback, inputObj,
     _this = this;
   if (input === &quot;Separator&quot;) {
     this.inputs.push(new Separator());
     return;
   }
   if (!window[input.type] instanceof Function) {
     throw new Error(&quot;Passed input can't be instantiated&quot;);
   }
   callback = function() {
     return _this.updateCallback.apply(_this, arguments);
   };
   if (input.type === &quot;Submit&quot;) {
     callback = function() {
       return _this.submitCallback.apply(_this, arguments);
     };
   }
   inputObj = new window[input.type](callback, input);
   if (!inputObj instanceof Input) throw new Error(&quot;Object isn't an input&quot;);
   this.inputDict[input.name] = inputObj;
   this.inputs.push(inputObj);
   return this;
 };
</PRE><PRE> InputForm.prototype.get = function(field) {
   return this.inputDict[field];
 };
</PRE><PRE> InputForm.prototype.generateDOM = function() {
   var fieldset, form,
     _this = this;
   form = $(&quot;&lt;form&gt;&quot;).attr(&quot;id&quot;, this.id).attr(&quot;class&quot;, &quot;form-horizontal&quot;);
   if (this.nameÂ != null) {
     fieldset = $(&quot;&lt;fieldset&gt;&quot;).append($(&quot;&lt;legend&gt;&quot;).text(this.name));
     form.append(fieldset);
   } else {
     fieldset = form;
   }
   this.inputs.forEach(function(input) {
     return fieldset.append(input.generateDOM());
   });
</PRE>
    fieldset.prepend($(&quot;&quot;)).prepend($(&quot;<DIV>&quot;).attr(&quot;class&quot;, &quot;control-group &quot; + this.rowClass).append($(&quot;&lt;label&gt;&quot;).attr(&quot;class&quot;, &quot;control-label&quot;).attr(&quot;for&quot;, &quot;help-checkbox&quot;).html(&quot;Show help blocks&quot;)).append($(&quot;<DIV>&quot;).attr(&quot;class&quot;, &quot;controls&quot;).append($(&quot;&lt;input&gt;&quot;).attr(&quot;class&quot;, &quot;input-medium&quot;).attr(&quot;type&quot;, &quot;checkbox&quot;).attr(&quot;checked&quot;, false).attr(&quot;id&quot;, &quot;help-checkbox&quot;).on(&quot;change&quot;, function() {
<PRE>     if ($(&quot;#help-checkbox&quot;).attr(&quot;checked&quot;)) {
       return $(&quot;.help-block&quot;).show();
     } else {
       return $(&quot;.help-block&quot;).hide();
     }
</PRE>
    })))).prepend($(&quot;<DIV>&quot;).attr(&quot;class&quot;, &quot;control-group &quot; + this.rowClass).append($(&quot;&lt;label&gt;&quot;).attr(&quot;class&quot;, &quot;control-label&quot;).attr(&quot;for&quot;, &quot;autoUpdate-checkbox&quot;).html(&quot;Automatically update results (CPU-heavy, but way more useable)&quot;)).append($(&quot;<DIV>&quot;).attr(&quot;class&quot;, &quot;controls&quot;).append($(&quot;&lt;input&gt;&quot;).attr(&quot;class&quot;, &quot;input-medium&quot;).attr(&quot;type&quot;, &quot;checkbox&quot;).attr(&quot;checked&quot;, &quot;checked&quot;).attr(&quot;id&quot;, &quot;autoUpdate-checkbox&quot;).on(&quot;change&quot;, function() {
<PRE>     if ($(&quot;#autoUpdate-checkbox&quot;).attr(&quot;checked&quot;)) {
       return _this.disableAuto = false;
     } else {
       return _this.disableAuto = true;
     }
   }))));
   return form;
 };
</PRE><PRE> return InputForm;
</PRE><P>})();
</P><P>Input = (function() {
</P><PRE> Input.i = 0;
</PRE><PRE> function Input(callback, data, rowClass) {
   this.callback = callback;
   this.data = data;
   this.rowClass = rowClassÂ != nullÂ ? rowClassÂ : &quot;&quot;;
   this.id = &quot;input-&quot; + Input.i++;
   this.type = &quot;text&quot;;
 }
</PRE><PRE> Input.prototype.generateDOM = function() {
</PRE>
    return $(&quot;<DIV>&quot;).attr(&quot;id&quot;, &quot;row-&quot; + this.id).attr(&quot;class&quot;, &quot;control-group &quot; + this.rowClass).append(this.generateLabelDOM()).append($(&quot;<DIV>&quot;).attr(&quot;class&quot;, &quot;controls&quot;).append(this.generateElementDOM()).append(this.generateHelpDOM()));
<PRE> };
</PRE><PRE> Input.prototype.generateLabelDOM = function() {
   return $(&quot;&lt;label&gt;&quot;).attr(&quot;class&quot;, &quot;control-label&quot;).attr(&quot;for&quot;, this.id).html(this.data.label);
 };
</PRE><PRE> Input.prototype.generateInputElementDOM = function(id, type, value, callback) {
   var element;
   element = $(&quot;&lt;input&gt;&quot;).attr(&quot;class&quot;, &quot;input-medium&quot;).attr(&quot;type&quot;, type).attr(&quot;id&quot;, id).on(&quot;change&quot;, callback).on(&quot;keyup&quot;, callback);
   element.val(value);
   return element;
 };
</PRE><PRE> Input.prototype.generateElementDOM = function() {
   return this.generateInputElementDOM(this.id, this.type, this.data.value, this.callback);
 };
</PRE><PRE> Input.prototype.generateHelpDOM = function(helpData) {
   if (helpData == null) helpData = this.data.help;
   if ((helpDataÂ != null) &amp;&amp; helpData.length &gt; 0) {
</PRE>
      return $(&quot;<P>&quot;).attr(&quot;class&quot;, &quot;help-block&quot;).html(helpData);
    } else {
      return $(&quot;&lt;p&gt;&quot;).attr(&quot;class&quot;, &quot;help-block&quot;).attr(&quot;style&quot;, &quot;display: none&quot;);
    }
  };

  Input.prototype.get = function(key) {
    return this.data[key];
  };

  Input.prototype.visible = function(vals) {
    if (this.data.visibleÂ != null) {
      return this.data.visible(vals);
    } else {
      return true;
    }
  };

  Input.prototype.hide = function() {
    return $(&quot;#row-&quot; + this.id).hide();
  };

  Input.prototype.show = function() {
    return $(&quot;#row-&quot; + this.id).show();
  };

  Input.prototype.value = function(value) {
    if (value === void 0) {
      return $(&quot;#&quot; + this.id).val();
    } else {
      return $(&quot;#&quot; + this.id).val(value);
    }
  };

  Input.prototype.validate = function(val) {
    return true;
  };

  return Input;

})();

Separator = (function(_super) {

  __extends(Separator, _super);

  function Separator() {
    Separator.__super__.constructor.apply(this, arguments);
  }

  Separator.prototype.generateDOM = function() {
    return $(&quot;</P>&quot;).attr(&quot;id&quot;, &quot;row-&quot; + this.id);
<PRE> };
</PRE><PRE> Separator.prototype.value = function() {};
</PRE><PRE> Separator.prototype.validate = function() {
   return true;
 };
</PRE><PRE> return Separator;
</PRE><P>})(Input);
</P><P>Submit = (function(_super) {
</P><PRE> __extends(Submit, _super);
</PRE><PRE> function Submit() {
   Submit.__super__.constructor.apply(this, arguments);
 }
</PRE><PRE> Submit.prototype.generateElementDOM = function() {
   return $(&quot;&lt;input&gt;&quot;).attr(&quot;type&quot;, &quot;submit&quot;).attr(&quot;value&quot;, this.data.value).attr(&quot;class&quot;, &quot;btn&quot;).click(this.callback, function(e) {
     e.preventDefault();
     e.data(e);
     return false;
   });
 };
</PRE><PRE> Submit.prototype.value = function() {};
</PRE><PRE> Submit.prototype.validate = function() {
   return true;
 };
</PRE><PRE> return Submit;
</PRE><P>})(Input);
</P><P>NumberInput = (function(_super) {
</P><PRE> __extends(NumberInput, _super);
</PRE><PRE> function NumberInput() {
   NumberInput.__super__.constructor.apply(this, arguments);
   this.type = &quot;number&quot;;
 }
</PRE><PRE> NumberInput.prototype.value = function(value) {
   if (value === void 0) {
     return parseInt(NumberInput.__super__.value.call(this), 10);
   } else {
     return NumberInput.__super__.value.call(this, parseInt(value, 10));
   }
 };
</PRE><PRE> NumberInput.prototype.validate = function(val) {
   returnÂ !isNaN(val);
 };
</PRE><PRE> return NumberInput;
</PRE><P>})(Input);
</P><P>TemperatureInput = (function(_super) {
</P><PRE> __extends(TemperatureInput, _super);
</PRE><PRE> function TemperatureInput() {
   TemperatureInput.__super__.constructor.apply(this, arguments);
 }
</PRE><PRE> TemperatureInput.prototype.generateElementDOM = function() {
   var input;
   input = TemperatureInput.__super__.generateElementDOM.call(this);
</PRE>
    return $(&quot;<DIV>&quot;).attr(&quot;class&quot;, &quot;input-append&quot;).append(input).append($(&quot;<SPAN>&quot;).attr(&quot;class&quot;, &quot;add-on&quot;).text(&quot;\u00B0C&quot;));
<PRE> };
</PRE><PRE> return TemperatureInput;
</PRE><P>})(NumberInput);
</P><P>DNAInput = (function(_super) {
</P><PRE> __extends(DNAInput, _super);
</PRE><PRE> function DNAInput() {
   DNAInput.__super__.constructor.apply(this, arguments);
 }
</PRE><PRE> DNAInput.prototype.generateElementDOM = function() {
   var textarea;
   textarea = $(&quot;&lt;textarea&gt;&quot;).attr(&quot;class&quot;, &quot;input-xlarge&quot;).attr(&quot;id&quot;, this.id).on(&quot;change&quot;, this.callback).on(&quot;keyup&quot;, this.callback);
   textarea.val(this.data.value);
   return textarea;
 };
</PRE><PRE> DNAInput.prototype.value = function(value) {
   if (value === void 0) {
     return DNA.fromString(DNAInput.__super__.value.call(this));
   } else {
     return DNAInput.__super__.value.call(this, value.toString());
   }
 };
</PRE><PRE> DNAInput.prototype.validate = function(val) {
   return valÂ !== void 0;
 };
</PRE><PRE> return DNAInput;
</PRE><P>})(Input);
</P><P>DNASmallInput = (function(_super) {
</P><PRE> __extends(DNASmallInput, _super);
</PRE><PRE> function DNASmallInput() {
   DNASmallInput.__super__.constructor.apply(this, arguments);
 }
</PRE><PRE> DNASmallInput.prototype.generateElementDOM = function() {
   var input;
   input = DNASmallInput.__super__.generateElementDOM.call(this);
</PRE>
    return $(&quot;<DIV>&quot;).attr(&quot;class&quot;, &quot;input-prepend input-append&quot;).append($(&quot;<SPAN>&quot;).attr(&quot;class&quot;, &quot;add-on&quot;).text(&quot;5'&quot;)).append(this.generateInputElementDOM(this.id, &quot;text&quot;, this.data.value, this.callback)).append($(&quot;<SPAN>&quot;).attr(&quot;class&quot;, &quot;add-on&quot;).text(&quot;3'&quot;));
<PRE> };
</PRE><PRE> return DNASmallInput;
</PRE><P>})(DNAInput);
</P><P>DNARSInput = (function(_super) {
</P><PRE> __extends(DNARSInput, _super);
</PRE><PRE> function DNARSInput() {
   DNARSInput.__super__.constructor.apply(this, arguments);
 }
</PRE><PRE> DNARSInput.prototype.generateElementDOM = function() {
   var input;
   input = DNARSInput.__super__.generateElementDOM.call(this);
</PRE>
    return $(&quot;<DIV>&quot;).attr(&quot;class&quot;, &quot;input-prepend input-append&quot;).append($(&quot;<SPAN>&quot;).attr(&quot;class&quot;, &quot;add-on&quot;).text(&quot;5'&quot;)).append(this.generateInputElementDOM(this.id, &quot;text&quot;, this.data.value, this.callback)).append($(&quot;<SPAN>&quot;).attr(&quot;class&quot;, &quot;add-on&quot;).text(&quot;3'&quot;)).append($(&quot;<SPAN>&quot;).attr(&quot;id&quot;, this.id + &quot;-rs&quot;).attr(&quot;class&quot;, &quot;add-on&quot;).text(&quot;append 2&quot;));
<PRE> };
</PRE><PRE> DNARSInput.prototype.value = function(value) {
   var val;
   val = DNARSInput.__super__.value.call(this, value);
   if ((valÂ != null) &amp;&amp; val instanceof DNA) {
     $(&quot;#&quot; + this.id + &quot;-rs&quot;).html(val.toString());
   }
   if (val === void 0) val = DNA.fromString(&quot;&quot;);
   return {
     dna: val,
     rs: $(&quot;#&quot; + this.id).val()
   };
 };
</PRE><PRE> return DNARSInput;
</PRE><P>})(DNAInput);
</P><P>SelectInput = (function(_super) {
</P><PRE> __extends(SelectInput, _super);
</PRE><PRE> function SelectInput(callback, obj) {
   SelectInput.__super__.constructor.apply(this, arguments);
   this.choices = obj.choices;
 }
</PRE><PRE> SelectInput.prototype.generateElementDOM = function() {
   var container, input,
     _this = this;
   input = SelectInput.__super__.generateElementDOM.call(this);
   container = $(&quot;&lt;select&gt;&quot;).attr(&quot;class&quot;, &quot;input-medium&quot;).attr(&quot;id&quot;, this.id).on(&quot;change&quot;, this.callback).on(&quot;click&quot;, this.callback);
   this.choices.forEach(function(_arg) {
     var name, value;
     name = _arg.name, value = _arg.value;
     return container.append($(&quot;&lt;option&gt;&quot;).attr(&quot;value&quot;, name).text(value));
   });
   return container;
 };
</PRE><PRE> return SelectInput;
</PRE><P>})(Input);
</P><P>RadioInput = (function(_super) {
</P><PRE> __extends(RadioInput, _super);
</PRE><PRE> function RadioInput(callback, obj) {
   RadioInput.__super__.constructor.apply(this, arguments);
   this.choices = obj.choices;
 }
</PRE><PRE> RadioInput.prototype.generateElementDOM = function() {
   var container, i, input,
     _this = this;
   input = RadioInput.__super__.generateElementDOM.call(this);
</PRE>
    container = $(&quot;<DIV>&quot;);
<PRE>   i = 0;
   this.choices.forEach(function(_arg) {
     var elem, help, label, name;
     name = _arg.name, label = _arg.label, help = _arg.help;
     elem = $(&quot;&lt;label&gt;&quot;).attr(&quot;class&quot;, &quot;radio&quot;).text(label).prepend($(&quot;&lt;input&gt;&quot;).attr(&quot;checked&quot;, _this.data.value === name).attr(&quot;type&quot;, &quot;radio&quot;).attr(&quot;id&quot;, _this.id + &quot;-&quot; + name).attr(&quot;name&quot;, _this.id).on(&quot;change&quot;, _this.callback).on(&quot;click&quot;, _this.callback)).append(_this.generateHelpDOM(help));
     return container.append(elem);
   });
   return container;
 };
</PRE><PRE> RadioInput.prototype.value = function(value) {
   var output,
     _this = this;
   if (value === void 0) {
     output = {};
     this.choices.forEach(function(_arg) {
       var name;
       name = _arg.name;
       return output[name] = $(&quot;#&quot; + _this.id + &quot;-&quot; + name).attr(&quot;checked&quot;) === &quot;checked&quot;;
     });
     return output;
   } else {
     if (value instanceof String) {
       this.choices.forEach(function(_arg) {
         var name;
         name = _arg.name;
         return $(&quot;#&quot; + _this.id + &quot;-&quot; + name).attr(&quot;checked&quot;, name === value);
       });
     } else {
       this.choices.forEach(function(_arg) {
         var name;
         name = _arg.name;
         return $(&quot;#&quot; + _this.id + &quot;-&quot; + name).attr(&quot;checked&quot;, value[name]);
       });
     }
     return value;
   }
 };
</PRE><PRE> return RadioInput;
</PRE><P>})(Input);
</P><P>$(function() {
</P>
  window.output = new Output(&quot;Primer 1 (<B><A href="/wiki/index.php?title=Template:Primer1Tm&amp;action=edit&amp;redlink=1" class="new" title="Template:Primer1Tm (page does not exist)">Template:Primer1Tm</A>\u00B0C</B>, <A href="/wiki/index.php?title=Template:Primer1TailLength&amp;action=edit&amp;redlink=1" class="new" title="Template:Primer1TailLength (page does not exist)">Template:Primer1TailLength</A> + <A href="/wiki/index.php?title=Template:Primer1Length&amp;action=edit&amp;redlink=1" class="new" title="Template:Primer1Length (page does not exist)">Template:Primer1Lengthbp</A>): 5' â 3'\n<PRE class="primer">{{primer1}}</PRE>\nPrimer 2 (<B><A href="/wiki/index.php?title=Template:Primer2Tm&amp;action=edit&amp;redlink=1" class="new" title="Template:Primer2Tm (page does not exist)">Template:Primer2Tm</A>\u00B0C</B>, <A href="/wiki/index.php?title=Template:Primer2TailLength&amp;action=edit&amp;redlink=1" class="new" title="Template:Primer2TailLength (page does not exist)">Template:Primer2TailLength</A> + <A href="/wiki/index.php?title=Template:Primer2Length&amp;action=edit&amp;redlink=1" class="new" title="Template:Primer2Length (page does not exist)">Template:Primer2Lengthbp</A>): 5' â 3'\n<PRE class="primer">{{primer2}}</PRE>\n<B>Annealing temperature:</B><A href="/wiki/index.php?title=Template:AnnealingTm&amp;action=edit&amp;redlink=1" class="new" title="Template:AnnealingTm (page does not exist)">Template:AnnealingTm</A>\u00B0C\n\n\n<H3><SPAN class="mw-headline" id="Messages">Messages</SPAN></H3>\n<A href="/wiki/index.php?title=Template:Messages&amp;action=edit&amp;redlink=1" class="new" title="Template:Messages (page does not exist)">Template:Messages</A>\n\n\n<H3><SPAN class="mw-headline" id="Digestion_result">Digestion result</SPAN></H3>\n<A href="/wiki/index.php?title=Template:RSDisplay:&amp;action=edit&amp;redlink=1" class="new" title="Template:RSDisplay: (page does not exist)">Template:RSDisplay:</A>\n\n<H3><SPAN class="mw-headline" id="PCR_Product">PCR Product</SPAN></H3>\n<A href="/wiki/index.php?title=Template:DNADisplay:full&amp;action=edit&amp;redlink=1" class="new" title="Template:DNADisplay:full (page does not exist)">Template:DNADisplay:full</A>\n&quot;);
<PRE> window.output.attach(&quot;#outputAttach&quot;);
 window.primerFinder = new PrimerFinder({
   output: function(data, messages) {
     window.output.setMessages(messages);
     return window.output.set(data);
   }
 });
 window.form = InputForm.create({
   name: &quot;Primer design helper&quot;,
   submit: function(data, messages, error) {
     return window.primerFinder.calc(data, messages, error);
   },
   update: function(data, messages, error) {
     return window.primerFinder.calc(data, messages, error);
   }
 }, [
   {
     name: &quot;dna&quot;,
     label: &quot;DNA Sequence of interest&quot;,
     type: &quot;DNAInput&quot;,
     value: &quot;&quot;,
     help: &quot;Most of the time you should just paste the DNA sequence (in the 5' â 3' direction) you want to extract/edit in this field&quot;
   }, {
     type: &quot;Separator&quot;
   }, {
     name: &quot;type&quot;,
     label: &quot;Primer type&quot;,
     type: &quot;RadioInput&quot;,
     choices: [
       {
         name: &quot;normal&quot;,
         label: &quot;Primers that extract the whole sequence&quot;,
         help: &quot;Running a PCR using these primers will extract the entire sequence&quot;
       }, {
         name: &quot;rs&quot;,
         label: &quot;Add restriction sites&quot;,
         help: &quot;Running a PCR using these primers will result in the sequence with added standardized restriction sites on both sides.&quot;
       }, {
         name: &quot;known&quot;,
         label: &quot;Add a standard prefix/suffix to the sequence&quot;,
         help: &quot;Running a PCR using these primers will result in the sequence with added standardized tails on both sides (for example for biobricking).&quot;
       }, {
         name: &quot;custom&quot;,
         label: &quot;Add custom tails to the sequence&quot;,
         help: &quot;Running a PCR using these primers will result in the sequence with added tails on both sides.&quot;
       }
     ],
     value: &quot;normal&quot;
   }, {
     type: &quot;Separator&quot;
   }, {
     name: &quot;standardTail&quot;,
     label: &quot;Standardized tails&quot;,
     type: &quot;SelectInput&quot;,
     value: &quot;biobrickGene&quot;,
     choices: [
       {
         name: &quot;biobrickGene&quot;,
         value: &quot;Biobrick (gene)&quot;
       }, {
         name: &quot;biobrickOther&quot;,
         value: &quot;Biobrick (other)&quot;
       }
     ],
     visible: function(_arg) {
       var type;
       type = _arg.type;
       return type.known;
     }
   }, {
     name: &quot;randomBases&quot;,
     label: &quot;Random Bases&quot;,
     type: &quot;NumberInput&quot;,
     value: &quot;4&quot;,
     help: &quot;This is the number of random bases will be added on both ends.&quot;,
     visible: function(_arg) {
       var type;
       type = _arg.type;
       return type.rs;
     }
   }, {
     name: &quot;leftRS&quot;,
     label: &quot;Left restriction site&quot;,
     type: &quot;DNARSInput&quot;,
     value: &quot;&quot;,
     help: &quot;You can also enter the name of the restriction enzyme (i.e. EcoRI).&quot;,
     visible: function(_arg) {
       var type;
       type = _arg.type;
       return type.rs;
     }
   }, {
     name: &quot;rightRS&quot;,
     label: &quot;Right restriction site&quot;,
     type: &quot;DNARSInput&quot;,
     value: &quot;&quot;,
     help: &quot;You can also enter the name of the restriction enzyme (i.e. EcoRI).&quot;,
     visible: function(_arg) {
       var type;
       type = _arg.type;
       return type.rs;
     }
   }, {
     name: &quot;leftTail&quot;,
     label: &quot;Left tail&quot;,
     type: &quot;DNASmallInput&quot;,
     value: &quot;&quot;,
     visible: function(_arg) {
       var type;
       type = _arg.type;
       return type.custom;
     }
   }, {
     name: &quot;rightTail&quot;,
     label: &quot;Right tail&quot;,
     type: &quot;DNASmallInput&quot;,
     value: &quot;&quot;,
     visible: function(_arg) {
       var type;
       type = _arg.type;
       return type.custom;
     }
   }, {
     type: &quot;Separator&quot;,
     visible: function(_arg) {
       var type;
       type = _arg.type;
       returnÂ !type.normal;
     }
   }, {
     name: &quot;tm&quot;,
     label: &quot;Target Tm&quot;,
     type: &quot;TemperatureInput&quot;,
     value: &quot;50&quot;,
     help: &quot;The program will try to create primers that have an annealing temperature close to this one.&quot;
   }, {
     value: &quot;Generate&quot;,
     type: &quot;Submit&quot;
   }
 ]);
 return window.form.attach($(&quot;#formAttach&quot;));
</PRE><P>});
</P><P>window.tails = [
</P><PRE> {
   name: &quot;Biobrick (gene)&quot;,
   value: &quot;biobrickGene&quot;,
   primer1Tail: &quot;GTT TCT TCG AAT TCG CGG CCG CTT CTA G&quot;,
   primer2Tail: &quot;GTT TCT TCC TGC AGC GGC CGC TAC TAG TA TTA TTA&quot;,
   messages: [&quot;Don't forget to include the first ATG and to exclude the stop codon!&quot;, &quot;The recommended minimum length of a BioBrick primer is 20bp&quot;, &quot;The recommended Tm of a BioBrick primer is between 55 and 65\u00B0C&quot;, &quot;Check that the following restriction sites are absent: EcoRI, SpeI, XbaI, PstI, NotI&quot;, &quot;Check out &lt;a href='<A href="http://openwetware.org/wiki/Synthetic_Biology:BioBricks/Part_fabrication'" class="external free" rel="nofollow">http://openwetware.org/wiki/Synthetic_Biology:BioBricks/Part_fabrication'</A>&gt;OpenWetWare's reference page&lt;/a&gt;&quot;],
   validate: function(primer1, primer2, dna) {
     var end, start;
     start = primer1.substr(0, 3).toUpperCase();
     if (startÂ !== &quot;ATG&quot;) return &quot;<B>The starting ATG seems to be absent.</B>&quot;;
     end = primer2.substr(0, 3).toUpperCase();
     if (end === &quot;TTA&quot; || end === &quot;TCA&quot; || end === &quot;CTA&quot;) {
       return &quot;<B>Remove the stop codons from the sequence!</B>&quot;;
     }
     if (dna.containsRS([&quot;EcoRI&quot;, &quot;SpeI&quot;, &quot;XbaI&quot;, &quot;PstI&quot;, &quot;NotI&quot;])) {
       return &quot;<B>One of the following restriction sites is present (and shouldn't be): EcoRI, SpeI, XbaI, PstI, NotI</B>&quot;;
     }
     return;
   }
 }, {
   name: &quot;Biobrick (other)&quot;,
   value: &quot;biobrickOther&quot;,
   primer1Tail: &quot;GTT TCT TCG AAT TCG CGG CCG CTT CTA GAG&quot;,
   primer2Tail: &quot;GTT TCT TCC TGC AGC GGC CGC TAC TAG TA&quot;,
   messages: [&quot;The recommended minimum length of a BioBrick primer is 20bp&quot;, &quot;The recommended Tm of a BioBrick primer is between 55 and 65\u00B0C&quot;, &quot;Check that the following restriction sites are absent: EcoRI, SpeI, XbaI, PstI, NotI&quot;, &quot;Check out &lt;a href='<A href="http://openwetware.org/wiki/Synthetic_Biology:BioBricks/Part_fabrication'" class="external free" rel="nofollow">http://openwetware.org/wiki/Synthetic_Biology:BioBricks/Part_fabrication'</A>&gt;OpenWetWare's reference page&lt;/a&gt;&quot;],
   validate: function(primer1, primer2, dna) {
     if (dna.containsRS([&quot;EcoRI&quot;, &quot;SpeI&quot;, &quot;XbaI&quot;, &quot;PstI&quot;, &quot;NotI&quot;])) {
       return &quot;<B>One of the following restriction sites is present (and shouldn't be): EcoRI, SpeI, XbaI, PstI, NotI</B>&quot;;
     }
     return;
   }
 }
</PRE><P>];
var DNADisplay, Display, Output, RSDisplay, SelfDimerDisplay,
</P><PRE> __hasProp = Object.prototype.hasOwnProperty,
 __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor; child.__super__ = parent.prototype; return child; };
</PRE><P>Output = (function() {
</P><PRE> Output.i = 0;
</PRE><PRE> Output.j = 0;
</PRE><PRE> function Output(template) {
   this.template = template;
   this.id = &quot;output-&quot; + Output.i++;
   this.fields = {};
   this.matches = {};
   this.displays = {};
   this.parsedTemplate = this.parseTemplate(this.template);
 }
</PRE><PRE> Output.prototype.attach = function(elem) {
   var displayClass, displayObj, k, v, _ref, _results;
   this.matches = {};
   $(elem).html(this.parsedTemplate);
   _ref = this.displays;
   _results = [];
   for (k in _ref) {
     v = _ref[k];
     _results.push((function() {
       var _i, _len, _ref2, _results2;
       _results2 = [];
       for (_i = 0, _len = v.length; _i &lt; _len; _i++) {
         _ref2 = v[_i], displayClass = _ref2.displayClass, displayObj = _ref2.displayObj;
         _results2.push(displayObj.attach(&quot;.&quot; + displayClass));
       }
       return _results2;
     })());
   }
   return _results;
 };
</PRE><PRE> Output.prototype.setMessages = function(messages) {
   var output;
   output = messages;
   if (messages.length === 0) output = [&quot;No messages&quot;];
</PRE>
    return this.getFields(&quot;_messages&quot;).html(&quot;<UL><LI>&quot; + output.join(&quot;</LI><LI>&quot;) + &quot;</LI></UL>&quot;);
<PRE> };
</PRE><PRE> Output.prototype.wipe = function() {
   var k, v, _ref;
   _ref = this.fields;
   for (k in _ref) {
     v = _ref[k];
     this.updateValue(k, void 0);
   }
   return this.fields = {};
 };
</PRE><PRE> Output.prototype.set = function(values) {
   var k, v;
   for (k in values) {
     v = values[k];
     this.updateValue(k, v);
   }
   this.updateValue(&quot;__all__&quot;, this.fields);
   return this.fields;
 };
</PRE><PRE> Output.prototype.updateValue = function(k, v) {
   var displayObj, _i, _len, _ref, _results;
   if (this.fields[k]Â !== v) {
     this.fields[k] = v;
     if (vÂ != null) {
       this.getFields(k).html(v.toString());
     } else {
       this.getFields(k).html(&quot;&quot;);
     }
   }
   if (this.displays[k]Â != null) {
     _ref = this.displays[k];
     _results = [];
     for (_i = 0, _len = _ref.length; _i &lt; _len; _i++) {
       displayObj = _ref[_i].displayObj;
       _results.push(displayObj.set(v));
     }
     return _results;
   }
 };
</PRE><PRE> Output.prototype.getFields = function(name) {
   if (!this.matches[name]) {
     this.matches[name] = $(&quot;.&quot; + this.id + &quot;-match-&quot; + name);
   }
   return this.matches[name];
 };
</PRE><PRE> Output.prototype.parseTemplate = function(template) {
   var c1, c2, display, displayClass, displayObj, displayPart, i, inName, key, name, output, skipNext, started, _ref;
   c1 = template[0];
   c2 = template[1];
   output = template + &quot;&quot;;
   skipNext = false;
   inName = false;
   started = -1;
   name = &quot;&quot;;
   for (i = 1, _ref = template.length - 1; 1 &lt;= _refÂ ? i &lt;= _refÂ : i &gt;= _ref; 1 &lt;= _refÂ ? i++Â : i--) {
     c2 = template[i];
     if (!skipNext) {
       if (c1 === &quot;{&quot; &amp;&amp; c2 === &quot;{&quot;) {
         if (inName) {
           throw new Error(&quot;Invalid template, opened brackets in an already opened context&quot;);
         }
         name = &quot;&quot;;
         started = i;
         skipNext = true;
         inName = true;
       } else if (c1 === &quot;}&quot; &amp;&amp; c2 === &quot;}&quot;) {
         if (!inName) {
           throw new Error(&quot;Invalid template, closed unopened brackets&quot;);
         }
         displayPart = name.indexOf(&quot;:&quot;);
         if (displayPart &gt;= 0) {
           display = name.substr(0, displayPart);
           key = name.substr(displayPart + 1);
           if (key === &quot;&quot;) key = &quot;__all__&quot;;
           displayClass = this.id + &quot;-display-&quot; + display + &quot;-&quot; + key;
           output = output.replace(&quot;<A href="/wiki/index.php?title=Template:%22_%2B_name_%2B_%22&amp;action=edit&amp;redlink=1" class="new" title="Template:&quot; + name + &quot; (page does not exist)">Template:&quot; + name + &quot;</A>&quot;, &quot;&quot;);
           displayObj = new window[display](key);
           if (!(this.displays[key]Â != null)) this.displays[key] = [];
           this.displays[key].push({
             displayClass: displayClass,
             displayObj: displayObj
           });
         } else {
           output = output.replace(&quot;<A href="/wiki/index.php?title=Template:%22_%2B_name_%2B_%22&amp;action=edit&amp;redlink=1" class="new" title="Template:&quot; + name + &quot; (page does not exist)">Template:&quot; + name + &quot;</A>&quot;, &quot;&quot;);
         }
         skipNext = true;
         inName = false;
       } else {
         if (inName) name += c1;
       }
     } else {
       skipNext = false;
     }
     c1 = c2;
   }
   return output;
 };
</PRE><PRE> return Output;
</PRE><P>})();
</P><P>Display = (function() {
</P><PRE> function Display(key) {
   this.key = key;
   this.value = void 0;
 }
</PRE><PRE> Display.prototype.attach = function(id) {
   throw new Error(&quot;Not implemented&quot;);
 };
</PRE><PRE> Display.prototype.set = function(values) {
   return this.value = values[this.key];
 };
</PRE><PRE> Display.prototype.pad = function(str, width, padLeft) {
   var length;
   if (str == null) str = &quot;&quot;;
   if (width == null) width = 5;
   if (padLeft == null) padLeft = false;
   str = str.toString();
   length = str.length;
   while (length &lt; width) {
     if (padLeft) {
       str = &quot; &quot; + str;
     } else {
       str += &quot; &quot;;
     }
     length++;
   }
   return str;
 };
</PRE><PRE> Display.prototype.wrap = function(str, width) {
   var i, length, output;
   if (str == null) str = &quot;&quot;;
   if (width == null) width = 40;
   str = str.toString();
   length = str.length;
   output = [];
   i = 0;
   while (length &gt;= width) {
     output.push(str.substr(i, width));
     length -= width;
     i += width;
   }
   if (length &gt; 0) output.push(str.substr(i));
   return output;
 };
</PRE><PRE> return Display;
</PRE><P>})();
</P><P>DNADisplay = (function(_super) {
</P><PRE> __extends(DNADisplay, _super);
</PRE><PRE> DNADisplay.i = 0;
</PRE><PRE> function DNADisplay(key) {
   var that,
     _this = this;
   DNADisplay.__super__.constructor.apply(this, arguments);
   this[&quot;class&quot;] = &quot;dnadisplay-&quot; + DNADisplay.i++;
   this.objects = [];
   that = this;
</PRE>
    this.dom = $(&quot;<DIV>&quot;).attr(&quot;class&quot;, this[&quot;class&quot;]).append($(&quot;&lt;label&gt;&quot;).append($(&quot;&lt;input&gt;&quot;).attr(&quot;class&quot;, this[&quot;class&quot;] + &quot;-toggleLines&quot;).attr(&quot;type&quot;, &quot;checkbox&quot;).attr(&quot;checked&quot;, &quot;on&quot;).on(&quot;change&quot;, function() {
<PRE>     if ($(&quot;.&quot; + _this[&quot;class&quot;] + &quot;-toggleLines&quot;).attr(&quot;checked&quot;)) {
       $(&quot;.&quot; + _this[&quot;class&quot;] + &quot;-lines&quot;).hide();
       $(&quot;.&quot; + _this[&quot;class&quot;] + &quot;-numberedLines&quot;).show();
     } else {
       $(&quot;.&quot; + _this[&quot;class&quot;] + &quot;-lines&quot;).show();
       $(&quot;.&quot; + _this[&quot;class&quot;] + &quot;-numberedLines&quot;).hide();
     }
     return;
</PRE>
    })).append(&quot; Line Numbers&quot;)).append($(&quot;<PRE>&quot;).attr(&quot;class&quot;, this[&quot;class&quot;] + &quot;-lines product&quot;).hide()).append($(&quot;&lt;pre&gt;&quot;).attr(&quot;class&quot;, this[&quot;class&quot;] + &quot;-numberedLines product&quot;));
  }

  DNADisplay.prototype.attach = function(elem) {
    $(elem).append(this.dom);
    return this.objects = $(&quot;.&quot; + this[&quot;class&quot;]);
  };

  DNADisplay.prototype.set = function(value) {
    var i, line, lines, numberWidth, numberedLines, outputLines, width, widthNumbered, _len;
    width = 60;
    numberWidth = 6;
    widthNumbered = 40;
    lines = this.wrap(value, width);
    numberedLines = this.wrap(value, widthNumbered);
    outputLines = [];
    for (i = 0, _len = numberedLines.length; i &lt; _len; i++) {
      line = numberedLines[i];
      if (line.length &gt; 0) {
        outputLines[i] = this.pad(i * widthNumbered + 1, numberWidth, true) + &quot; - &quot; + this.pad((i + 1) * widthNumbered, numberWidth) + &quot;&quot; + line;
      }
    }
    this.full = lines.join(&quot;\n&quot;);
    this.fullNumbered = outputLines.join(&quot;\n&quot;);
    $(&quot;.&quot; + this[&quot;class&quot;] + &quot;-lines&quot;).text(this.full);
    return $(&quot;.&quot; + this[&quot;class&quot;] + &quot;-numberedLines&quot;).text(this.fullNumbered);
  };

  return DNADisplay;

})(Display);

RSDisplay = (function(_super) {

  __extends(RSDisplay, _super);

  RSDisplay.i = 0;

  function RSDisplay(key) {
    var that;
    RSDisplay.__super__.constructor.apply(this, arguments);
    this[&quot;class&quot;] = &quot;rsdisplay-&quot; + RSDisplay.i++;
    this.objects = [];
    that = this;
    this.dom = $(&quot;&lt;div&gt;&quot;).attr(&quot;class&quot;, this[&quot;class&quot;]).append($(&quot;&lt;pre&gt;&quot;).attr(&quot;class&quot;, this[&quot;class&quot;] + &quot;-pre&quot;));
  }

  RSDisplay.prototype.attach = function(elem) {
    $(elem).append(this.dom);
    return this.objects = $(&quot;.&quot; + this[&quot;class&quot;]);
  };

  RSDisplay.prototype.set = function(_arg) {
    var c, complement, full, left, leftCompStr, leftCut, leftRS, leftRSInput, leftStr, overhang, randomBases, right, rightCompStr, rightCut, rightRS, rightRSInput, rightStr, rs, text, type, _i, _j, _len, _len2, _ref, _ref2;
    rs = _arg.rs, type = _arg.type, leftRS = _arg.leftRS, rightRS = _arg.rightRS;
    if (!type.rs) {
      $(&quot;.&quot; + this[&quot;class&quot;] + &quot;-pre&quot;).html(&quot;Not applicable&quot;);
      return;
    }
    leftRSInput = leftRS.rs;
    rightRSInput = rightRS.rs;
    left = rs.left, right = rs.right, full = rs.full, randomBases = rs.randomBases;
    leftCut = DNA.getCutPosition(leftRSInput);
    if (leftCut &lt; 0) {
      leftRS = DNA.fromString(left).findRS(true);
      leftCut = DNA.getCutPosition(leftRS);
    } else {
      leftRS = leftRSInput;
    }
    if (leftRS.length === 0) leftRS = &quot;?&quot;;
    rightCut = DNA.getCutPosition(rightRSInput);
    if (rightCut &lt; 0) {
      rightRS = DNA.fromString(right).findRS(true);
      rightCut = DNA.getCutPosition(rightRS);
    } else {
      rightRS = rightRSInput;
    }
    if (rightRS.length === 0) rightRS = &quot;?&quot;;
    leftStr = full.substr(0, randomBases + left.length + 10);
    rightStr = full.substr(full.length - (randomBases + right.length + 10));
    if (randomBases &gt; 6) {
      leftStr = &quot;...&quot; + leftStr.substr(randomBases - 3);
      rightStr = rightStr.substr(0, rightStr.length - (randomBases - 3)) + &quot;...&quot;;
      randomBases = 6;
    }
    leftCompStr = &quot;&quot;;
    rightCompStr = &quot;&quot;;
    complement = function(c) {
      switch (c) {
        case &quot;A&quot;:
          return &quot;T&quot;;
        case &quot;T&quot;:
          return &quot;A&quot;;
        case &quot;C&quot;:
          return &quot;G&quot;;
        case &quot;G&quot;:
          return &quot;C&quot;;
        default:
          return c;
      }
    };
    _ref = leftStr.split(&quot;&quot;);
    for (_i = 0, _len = _ref.length; _i &lt; _len; _i++) {
      c = _ref[_i];
      leftCompStr += complement(c);
    }
    _ref2 = rightStr.split(&quot;&quot;);
    for (_j = 0, _len2 = _ref2.length; _j &lt; _len2; _j++) {
      c = _ref2[_j];
      rightCompStr += complement(c);
    }
    if (leftCut &gt;= 0) {
      overhang = Math.ceil(Math.abs(left.length / 2 - leftCut)) + 1;
      leftStr = leftStr.substr(0, randomBases + leftCut) + this.pad(&quot;&quot;, overhang + 1) + leftStr.substr(randomBases + leftCut);
      leftCompStr = leftCompStr.substr(0, randomBases + left.length - leftCut) + this.pad(&quot;&quot;, overhang + 1) + leftCompStr.substr(randomBases + left.length - leftCut);
    } else {
      leftStr = leftStr.substr(0, randomBases) + &quot;&quot; + leftStr.substr(randomBases, left.length) + &quot;&quot; + leftStr.substr(randomBases + left.length);
      leftCompStr = leftCompStr.substr(0, randomBases) + &quot;&quot; + leftCompStr.substr(randomBases, left.length) + &quot;&quot; + leftCompStr.substr(randomBases + left.length);
    }
    if (rightCut &gt;= 0) {
      overhang = Math.ceil(Math.abs(right.length / 2 - rightCut)) + 1;
      rightStr = rightStr.substr(0, rightStr.length - (randomBases + right.length - rightCut)) + this.pad(&quot;&quot;, overhang + 1) + rightStr.substr(rightStr.length - (randomBases + right.length - rightCut));
      rightCompStr = rightCompStr.substr(0, rightCompStr.length - (randomBases + rightCut)) + this.pad(&quot;&quot;, overhang + 1) + rightCompStr.substr(rightCompStr.length - (randomBases + rightCut));
    } else {
      rightStr = rightStr.substr(0, rightStr.length - (randomBases + right.length)) + &quot;&quot; + rightStr.substr(rightStr.length - (randomBases + right.length), right.length) + &quot;&quot; + rightStr.substr(rightStr.length - randomBases);
      rightCompStr = rightCompStr.substr(0, rightCompStr.length - (randomBases + right.length)) + &quot;&quot; + rightCompStr.substr(rightCompStr.length - (randomBases + right.length), right.length) + &quot;&quot; + rightCompStr.substr(rightCompStr.length - randomBases);
    }
    text = [];
    text.push(&quot;Left restriction site: &quot; + leftRS + (leftCut &lt; 0Â ? &quot; (cutting site unknown)&quot;Â : &quot;&quot;));
    text.push(&quot;Right restriction site: &quot; + rightRS + (rightCut &lt; 0Â ? &quot; (cutting site unknown)&quot;Â : &quot;&quot;));
    text.push(&quot;&quot;);
    text.push(&quot;5'&quot; + this.pad(&quot;3'&quot;, leftStr.length + rightStr.length + 1, true));
    text.push(leftStr + &quot;...&quot; + rightStr);
    text.push(leftCompStr + &quot;...&quot; + rightCompStr);
    text.push(&quot;3'&quot; + this.pad(&quot;5'&quot;, leftStr.length + rightStr.length + 1, true));
    return $(&quot;.&quot; + this[&quot;class&quot;] + &quot;-pre&quot;).text(text.join(&quot;\n&quot;));
  };

  return RSDisplay;

})(Display);

SelfDimerDisplay = (function(_super) {

  __extends(SelfDimerDisplay, _super);

  SelfDimerDisplay.i = 0;

  function SelfDimerDisplay(key) {
    var that,
      _this = this;
    SelfDimerDisplay.__super__.constructor.apply(this, arguments);
    this[&quot;class&quot;] = &quot;selfdimerdisplay-&quot; + RSDisplay.i++;
    this.objects = [];
    that = this;
    this.dom = $(&quot;&lt;div&gt;&quot;).attr(&quot;class&quot;, this[&quot;class&quot;]).append($(&quot;&lt;span&gt;&quot;).text(&quot;This calculation is quite heavy and is done on demand. Press on the button to start the calculations:&quot;)).append(&quot;&lt;br&gt;&quot;).append($(&quot;&lt;input&gt;&quot;).attr(&quot;type&quot;, &quot;button&quot;).attr(&quot;value&quot;, &quot;Calculate&quot;).attr(&quot;class&quot;, &quot;btn&quot;).click(function() {
      return _this.click();
    })).append(&quot;&lt;br&gt;&quot;).append(&quot;&lt;br&gt;&quot;).append($(&quot;&lt;pre&gt;&quot;).attr(&quot;class&quot;, this[&quot;class&quot;] + &quot;-pre&quot;).html(&quot;Press the calculate button to update this data&quot;));
  }

  SelfDimerDisplay.prototype.attach = function(elem) {
    $(elem).append(this.dom);
    return this.objects = $(&quot;.&quot; + this[&quot;class&quot;] + &quot;-pre&quot;);
  };

  SelfDimerDisplay.prototype.set = function(_arg) {
    var primer1, primer2;
    primer1 = _arg.primer1, primer2 = _arg.primer2;
    if (primer1Â !== this.primer1 || primer2Â !== this.primer2) {
      this.primer1 = primer1;
      this.primer2 = primer2;
      return this.objects.html(&quot;Press the calculate button to update this data&quot;);
    }
  };

  SelfDimerDisplay.prototype.click = function() {
    var report;
    report = this.generateReport(&quot;Primer 1&quot;, this.primer1) + &quot;\n\n&quot; + this.generateReport(&quot;Primer 2&quot;, this.primer2);
    return this.objects.html(report);
  };

  SelfDimerDisplay.prototype.generateReport = function(name, primer) {
    var character, folds, lineC, lineN, lines, matches, number, p, pairs, rna, _i, _j, _len, _ref, _ref2, _results;
    lines = [];
    lines.push(name + &quot;:&quot;);
    rna = RNA.fromString(primer);
    _ref = rna.findKnots(), matches = _ref.matches, folds = _ref.folds;
    lines.push(&quot;Amount of matches: &quot; + matches);
    pairs = _.zip((function() {
      _results = [];
      for (var _i = 1, _ref2 = primer.length; 1 &lt;= _ref2Â ? _i &lt;= _ref2Â : _i &gt;= _ref2; 1 &lt;= _ref2Â ? _i++Â : _i--){ _results.push(_i); }
      return _results;
    }).apply(this), primer.split(&quot;&quot;));
    lineC = &quot;&quot;;
    lineN = &quot;&quot;;
    for (_j = 0, _len = pairs.length; _j &lt; _len; _j++) {
      p = pairs[_j];
      number = p[0] + &quot;&quot;;
      character = this.pad(p[1], number.length - 1, true) + &quot;&quot;;
      if (lineC.length + number.length &gt; 60) {
        lines.push(lineC);
        lines.push(lineN);
        lines.push(&quot;&quot;);
        lineC = &quot;&quot;;
        lineN = &quot;&quot;;
      }
      lineC += character;
      lineN += number;
    }
    if (lineC.length &gt; 0) {
      lines.push(lineC);
      lines.push(lineN);
      lines.push(&quot;&quot;);
    }
    return lines.join(&quot;\n&quot;);
  };

  return SelfDimerDisplay;

})(Display);
var Primer;

Primer = (function() {

  Primer.minLength = 8;

  Primer.maxLength = 50;

  Primer.maxDiff = 8;

  Primer.lastData = &quot;&quot;;

  Primer.lastTail1 = &quot;&quot;;

  Primer.lastTail2 = &quot;&quot;;

  Primer.lastTm = 0;

  Primer.lastRandEdgeSize = -1;

  Primer.reset = function() {
    this.lastData = &quot;&quot;;
    this.lastTm = 0;
    this.lastTail1 = &quot;&quot;;
    this.lastTail2 = &quot;&quot;;
    return this.lastRandEdgeSize = -1;
  };

  function Primer(data) {
    if (data instanceof DNA) {
      this.seq = data.clone();
    } else {
      this.seq = DNA.fromString(data);
    }
    this.tail1 = new DNA([]);
    this.tail2 = new DNA([]);
    this.randEdgeSize = 0;
  }

  Primer.prototype.setTails = function(tail1, tail2) {
    this.tail1 = tail1;
    this.tail2 = tail2;
  };

  Primer.prototype.addRandomEdges = function(randEdgeSize) {
    this.randEdgeSize = randEdgeSize;
  };

  Primer.prototype.isSameAsLast = function(data, tm) {
    return Primer.lastTail1.toString() === this.tail1.toString() &amp;&amp; Primer.lastTail2.toString() === this.tail2.toString() &amp;&amp; Primer.lastData === DNA.fromString(data).toString() &amp;&amp; Primer.lastTm === tm &amp;&amp; Primer.lastRandEdgeSize === this.randEdgeSize;
  };

  Primer.prototype.generate = function(goal) {
    var diff, l1, l2, maxLength, primer1Length, primer1Temp, primer2Length, primer2Temp, rand1, rand2, revCompl, temp, _ref, _ref2;
    if (2 * Primer.minLength &gt; this.seq.length()) {
      throw new Error(&quot;The given sequence is too short&quot;);
    }
    Primer.lastData = this.seq.toString();
    Primer.lastTm = goal;
    Primer.lastTail1 = this.tail1;
    Primer.lastTail2 = this.tail2;
    Primer.lastRandEdgeSize = this.randEdgeSize;
    maxLength = Math.min(Math.floor(this.seq.length() / 2), Primer.maxLength);
    revCompl = this.seq.reverseComplement();
    primer1Length = -1;
    primer1Temp = 0;
    primer2Length = -1;
    primer2Temp = 0;
    for (l1 = _ref = Primer.minLength; _ref &lt;= maxLengthÂ ? l1 &lt;= maxLengthÂ : l1 &gt;= maxLength; _ref &lt;= maxLengthÂ ? l1++Â : l1--) {
      temp = this.seq.snip(l1).tm();
      diff = Math.abs(temp - goal);
      if (diff &lt;= Primer.maxDiff &amp;&amp; (primer1Length === -1 || Math.abs(primer1Temp - goal) &gt; diff)) {
        primer1Length = l1;
        primer1Temp = temp;
      }
      if (temp &gt;= goal) break;
    }
    for (l2 = _ref2 = Primer.minLength; _ref2 &lt;= maxLengthÂ ? l2 &lt;= maxLengthÂ : l2 &gt;= maxLength; _ref2 &lt;= maxLengthÂ ? l2++Â : l2--) {
      temp = revCompl.snip(l2).tm();
      diff = Math.abs(temp - goal);
      if (diff &lt;= Primer.maxDiff &amp;&amp; (primer2Length === -1 || Math.abs(primer2Temp - goal) &gt; diff)) {
        primer2Length = l2;
        primer2Temp = temp;
      }
      if (temp &gt;= goal) break;
    }
    if (primer1Length &lt; 0 || primer2Length &lt; 0) {
      throw new Error(&quot;Couldn't find a primer of correct length that satisfies the conditions&quot;);
    }
    rand1 = DNA.fromRandom(this.randEdgeSize);
    rand2 = DNA.fromRandom(this.randEdgeSize);
    return {
      rs: {
        left: this.tail1.toString(),
        right: this.tail2.toString(),
        randomBases: this.randEdgeSize,
        full: rand1.toString() + this.tail1.toString() + this.seq.toString() + this.tail2.reverseComplement().toString() + rand2.reverseComplement().toString()
      },
      primer1: rand1.toString() + &quot;&quot; + this.tail1.toString() + &quot;&quot; + this.seq.snip(primer1Length).toString(),
      primers: {
        primer1: rand1.toString() + this.tail1.toString() + this.seq.snip(primer1Length).toString(),
        primer2: rand2.toString() + this.tail2.toString() + revCompl.snip(primer2Length).toString()
      },
      primer1NoTail: this.seq.snip(primer1Length).toString(),
      primer1Tm: primer1Temp,
      primer1Length: primer1Length,
      primer1TailLength: rand1.length() + this.tail1.length(),
      primer2: rand2.toString() + &quot;&quot; + this.tail2.toString() + &quot;&quot; + revCompl.snip(primer2Length).toString(),
      primer2NoTail: revCompl.snip(primer2Length).toString(),
      primer2Tm: primer2Temp,
      primer2Length: primer2Length,
      primer2TailLength: rand2.length() + this.tail2.length(),
      full: rand1.toString() + this.tail1.toString() + this.seq.toString() + this.tail2.reverseComplement().toString() + rand2.reverseComplement().toString()
    };
  };

  return Primer;

})();
var PrimerFinder;

PrimerFinder = (function() {

  function PrimerFinder(_arg) {
    this.output = _arg.output;
    this.defaults = {
      primer1: &quot;No data&quot;,
      primer1Tm: &quot;?&quot;,
      primer1Length: 0,
      primer2: &quot;No data&quot;,
      primer2Tm: &quot;?&quot;,
      primer2Length: 0,
      annealingTm: &quot;?&quot;
    };
  }

  PrimerFinder.prototype.calc = function(data, messages, error) {
    var k, match1, match2, p, primers, result, tail, tail1, tail2, v, validate, _i, _len, _ref, _ref2;
    if (error) {
      messages = [&quot;A fatal error occured:&quot;].concat(messages);
      this.output(data, messages);
      return;
    }
    _ref = this.defaults;
    for (k in _ref) {
      v = _ref[k];
      if (!(data[k]Â != null)) data[k] = v;
    }
    try {
      p = new Primer(data.dna);
      validate = function(primer1, primer2, dna) {};
      if (data.type.custom) p.setTails(data.leftTail, data.rightTail);
      if (data.type.rs) {
        match1 = data.leftRS.dna.findRS();
        match2 = data.rightRS.dna.findRS();
        if ((match1Â != null) &amp;&amp; match1.length &gt; 0) {
          messages.push(&quot;The left restriction site is &quot; + match1);
        } else {
          messages.push(&quot;The left restriction site wasn't recognized&quot;);
        }
        if ((match2Â != null) &amp;&amp; match2.length &gt; 0) {
          messages.push(&quot;The right restriction site is &quot; + match2);
        } else {
          messages.push(&quot;The right restriction site wasn't recognized&quot;);
        }
        p.setTails(data.leftRS.dna, data.rightRS.dna.reverseComplement());
        p.addRandomEdges(data.randomBases);
        messages.push(&quot;Click the 'Generate' button to regenerate the random bases added on the end of the primers.&quot;);
        messages.push(&quot;In the case of a plasmid where the piece between A and B is cut out, and A is used for the primer 1 RS (and B for the second).\nThe generated primers will put the RS such that the given DNA starts at the A side and ends at the B side (in short,\nit will probably work as you expected, but still check what happens with some other tool).&quot;);
      }
      if (data.type.known) {
        tail1 = &quot;&quot;;
        tail2 = &quot;&quot;;
        _ref2 = window.tails;
        for (_i = 0, _len = _ref2.length; _i &lt; _len; _i++) {
          tail = _ref2[_i];
          if (tail.value === data.standardTail) {
            tail1 = tail.primer1Tail;
            tail2 = tail.primer2Tail;
            if (tail.messagesÂ != null) messages = [].concat(tail.messages);
            if (tail.validateÂ != null) validate = tail.validate;
          }
        }
        p.setTails(DNA.fromString(tail1), DNA.fromString(tail2));
      }
      primers = p.generate(data.tm);
      result = validate(primers.primer1NoTail, primers.primer2NoTail, data.dna);
      if (resultÂ != null) messages.push(result);
      for (k in primers) {
        v = primers[k];
        data[k] = v;
      }
      messages = messages;
    } catch (e) {
      messages = [e.message];
    }
    data.annealingTm = Math.min(data.primer1Tm, data.primer2Tm);
    if (Math.abs(data.primer1Tm - data.primer2Tm) &gt; 5) {
      messages.push(&quot;The difference between the primer's Tm is more than 5\u00B0C&quot;);
    }
    if (data.annealingTm &gt; 70) {
      messages.push(&quot;Consider using the two-step PCR protocol&quot;);
    }
    if (data.annealingTm &gt; 72) {
      messages.push(&quot;Annealing temperature shouldn't exceed 72\u00B0C&quot;);
      data.annealingTm = 72;
    }
    if (data.annealingTm &lt; 45) {
      messages.push(&quot;The annealing temperature should be more than 45\u00B0C&quot;);
    }
    return this.output(data, messages);
  };

  return PrimerFinder;

})();
var RNA;

RNA = (function() {

  RNA.fromDNA = function(dna) {
    return new RNA(dna.data.map(function(x) {
      switch (x) {
        case &quot;T&quot;:
          return &quot;U&quot;;
        default:
          return x;
      }
    }));
  };

  RNA.fromString = function(data) {
    return RNA.fromDNA(DNA.fromString(data));
  };

  /*
    Note: Just like for the DNA class, you probably didn't want to use the constructor. Use fromDNA or fromString instead!
  */

  function RNA(data) {
    this.data = data;
    this.n = this.data.length;
    this.knots = void 0;
  }

  RNA.prototype.P = function(i, j) {
    if ((this.data[i] === &quot;A&quot;&amp;&amp; this.data[j] === &quot;U&quot;) || (this.data[i] === &quot;U&quot;&amp;&amp; this.data[j] === &quot;C&quot;)) {
      return 1;
    } else if ((this.data[i] === &quot;G&quot;&amp;&amp; this.data[j] === &quot;C&quot;) || (this.data[i] === &quot;C&quot;&amp;&amp; this.data[j] === &quot;G&quot;)) {
      return 1;
    } else {
      return 0;
    }
  };

  RNA.prototype.isTooSelfComplementary = function() {
    var fold, folds, i, matches, seq, _i, _len, _ref, _ref2;
    _ref = this.findKnots(), matches = _ref.matches, folds = _ref.folds;
    for (_i = 0, _len = folds.length; _i &lt; _len; _i++) {
      fold = folds[_i];
      seq = [];
      console.log(fold);
      for (i = 0, _ref2 = fold.length - 1; 0 &lt;= _ref2Â ? i &lt;= _ref2Â : i &gt;= _ref2; 0 &lt;= _ref2Â ? i++Â : i--) {
        if (fold[i] === &quot;(&quot;) {
          if (i &gt; 0 &amp;&amp; fold[i - 1] === &quot;(&quot;) {
            seq[seq.length - 1] += this.data[i];
          } else {
            seq[seq.length] = this.data[i];
          }
        }
      }
      console.log(seq);
    }
    return false;
  };

  RNA.prototype.findKnots = function(minSize) {
    var HM, M, a, a1, a2, createSolution, hashSet, hm, hs, i, j, k, l, m, max, output, p, sol, str, tmp, _i, _j, _k, _l, _len, _len2, _len3, _len4, _ref, _ref10, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9,
      _this = this;
    if (minSize == null) minSize = 2;
    if (this.knotsÂ !== void 0) return this.knots;
    createSolution = function() {
      var i, _ref, _results;
      _results = [];
      for (i = 1, _ref = _this.n; 1 &lt;= _refÂ ? i &lt;= _refÂ : i &gt;= _ref; 1 &lt;= _refÂ ? i++Â : i--) {
        _results.push(&quot;.&quot;);
      }
      return _results;
    };
    HM = [];
    for (l = 0, _ref = this.n - 1; 0 &lt;= _refÂ ? l &lt;= _refÂ : l &gt;= _ref; 0 &lt;= _refÂ ? l++Â : l--) {
      hm = [];
      for (m = 0, _ref2 = this.n - 1; 0 &lt;= _ref2Â ? m &lt;= _ref2Â : m &gt;= _ref2; 0 &lt;= _ref2Â ? m++Â : m--) {
        hm[m] = [createSolution()];
      }
      HM[l] = hm;
    }
    M = (function() {
      var _ref3, _results;
      _results = [];
      for (i = 1, _ref3 = this.n; 1 &lt;= _ref3Â ? i &lt;= _ref3Â : i &gt;= _ref3; 1 &lt;= _ref3Â ? i++Â : i--) {
        _results.push((function() {
          var _ref4, _results2;
          _results2 = [];
          for (j = 1, _ref4 = this.n; 1 &lt;= _ref4Â ? j &lt;= _ref4Â : j &gt;= _ref4; 1 &lt;= _ref4Â ? j++Â : j--) {
            _results2.push(0);
          }
          return _results2;
        }).call(this));
      }
      return _results;
    }).call(this);
    for (i = _ref3 = this.n - 1; _ref3 &lt;= 0Â ? i &lt;= 0Â : i &gt;= 0; _ref3 &lt;= 0Â ? i++Â : i--) {
      for (j = i, _ref4 = this.n - 1; i &lt;= _ref4Â ? j &lt;= _ref4Â : j &gt;= _ref4; i &lt;= _ref4Â ? j++Â : j--) {
        max = 0;
        if (i &lt; j - minSize) {
          max = M[i + 1][j - 1] + this.P(i, j);
          hs = [];
          _ref5 = HM[i + 1][j - 1];
          for (_i = 0, _len = _ref5.length; _i &lt; _len; _i++) {
            sol = _ref5[_i];
            if (this.P(i, j) === 1) {
              sol[i] = &quot;(&quot;;
              sol[j] = &quot;)&quot;;
            } else {
              sol[i] = &quot;.&quot;;
              sol[j] = &quot;.&quot;;
            }
            if (hs.length &lt; 50) hs.push(sol);
          }
          for (k = i, _ref6 = j - 1; i &lt;= _ref6Â ? k &lt;= _ref6Â : k &gt;= _ref6; i &lt;= _ref6Â ? k++Â : k--) {
            tmp = M[i][k] + M[k + 1][j];
            if (tmp &gt; max) {
              max = tmp;
              hs = [];
            }
            if (tmp &gt;= max) {
              _ref7 = HM[i][k];
              for (_j = 0, _len2 = _ref7.length; _j &lt; _len2; _j++) {
                a1 = _ref7[_j];
                _ref8 = HM[k + 1][j];
                for (_k = 0, _len3 = _ref8.length; _k &lt; _len3; _k++) {
                  a2 = _ref8[_k];
                  a = createSolution(this.n);
                  for (p = 0; 0 &lt;= kÂ ? p &lt;= kÂ : p &gt;= k; 0 &lt;= kÂ ? p++Â : p--) {
                    a[p] = a1[p];
                  }
                  for (p = _ref9 = k + 1; _ref9 &lt;= jÂ ? p &lt;= jÂ : p &gt;= j; _ref9 &lt;= jÂ ? p++Â : p--) {
                    a[p] = a2[p];
                  }
                  if (hs.length &lt; 50) hs.push(a);
                }
              }
            }
          }
          M[i][j] = max;
          HM[i][j] = hs;
        }
      }
    }
    output = [];
    hashSet = {};
    _ref10 = HM[0][this.n - 1];
    for (_l = 0, _len4 = _ref10.length; _l &lt; _len4; _l++) {
      sol = _ref10[_l];
      str = sol.join(&quot;&quot;);
      if (hashSet[str] === void 0) {
        hashSet[str] = true;
        output.push(str);
      }
    }
    return this.knots = {
      matches: M[0][this.n - 1],
      folds: output
    };
  };

  return RNA;

})();
/*
Container class that helps with Tm calculations. It has been seperated to enable easy improvements to the
algorithm.
*/
var TmCalc;

TmCalc = (function() {

  function TmCalc() {}

  TmCalc.maxCacheSize = 500;

  TmCalc.cache = {};

  TmCalc.calc = function(data) {
    var key, keys, result;
    if (!this.cache[data]) {
      result = Math.round(this.calcFull(data) * 10) / 10;
      if (this.cache.length &gt;= this.maxCacheSize) {
        keys = Object.keys(TmCalc.cache);
        key = keys[Math.floor(Math.random() * keys.length)];
        delete TmCalc.cache[key];
      }
      this.cache[data] = result;
    }
    return this.cache[data];
  };

  TmCalc.complement = function(n) {
    switch (n) {
      case &quot;A&quot;:
        return &quot;T&quot;;
      case &quot;T&quot;:
        return &quot;A&quot;;
      case &quot;C&quot;:
        return &quot;G&quot;;
      case &quot;G&quot;:
        return &quot;C&quot;;
      default:
        throw new Error(&quot;Invalid character encountered (&quot; + n + &quot;)&quot;);
    }
  };

  TmCalc.neighborH = {
    AA: 9.1,
    AT: 8.6,
    TA: 6.0,
    CA: 5.8,
    GT: 6.5,
    CT: 7.8,
    GA: 5.6,
    CG: 11.9,
    GC: 11.1,
    GG: 11.0
  };

  TmCalc.getH = function(n1, n2) {
    return this.get(this.neighborH, n1, n2);
  };

  TmCalc.neighborG = {
    AA: 1.9,
    AT: 1.5,
    TA: 0.9,
    CA: 1.9,
    GT: 1.3,
    CT: 1.6,
    GA: 1.6,
    CG: 3.6,
    GC: 3.1,
    GG: 3.1
  };

  TmCalc.getG = function(n1, n2) {
    return this.get(this.neighborG, n1, n2);
  };

  TmCalc.neighborS = {
    AA: 24.0,
    AT: 23.9,
    TA: 16.9,
    CA: 12.9,
    GT: 17.3,
    CT: 20.8,
    GA: 13.5,
    CG: 27.8,
    GC: 26.7,
    GG: 26.6
  };

  TmCalc.getS = function(n1, n2) {
    return this.get(this.neighborS, n1, n2);
  };

  TmCalc.get = function(searchVar, n1, n2) {
    switch (n1 + n2) {
      case &quot;AA&quot;:
        return searchVar[&quot;AA&quot;];
      case &quot;TT&quot;:
        return searchVar[&quot;AA&quot;];
      case &quot;AT&quot;:
        return searchVar[&quot;AT&quot;];
      case &quot;TA&quot;:
        return searchVar[&quot;TA&quot;];
      case &quot;TT&quot;:
        return searchVar[&quot;TA&quot;];
      case &quot;CA&quot;:
        return searchVar[&quot;CA&quot;];
      case &quot;TG&quot;:
        return searchVar[&quot;CA&quot;];
      case &quot;GT&quot;:
        return searchVar[&quot;GT&quot;];
      case &quot;AC&quot;:
        return searchVar[&quot;GT&quot;];
      case &quot;CT&quot;:
        return searchVar[&quot;CT&quot;];
      case &quot;AG&quot;:
        return searchVar[&quot;CT&quot;];
      case &quot;GA&quot;:
        return searchVar[&quot;GA&quot;];
      case &quot;TC&quot;:
        return searchVar[&quot;GA&quot;];
      case &quot;CG&quot;:
        return searchVar[&quot;CG&quot;];
      case &quot;TC&quot;:
        return searchVar[&quot;CG&quot;];
      case &quot;GC&quot;:
        return searchVar[&quot;GC&quot;];
      case &quot;TC&quot;:
        return searchVar[&quot;GC&quot;];
      case &quot;GG&quot;:
        return searchVar[&quot;GG&quot;];
      case &quot;CC&quot;:
        return searchVar[&quot;GG&quot;];
      default:
        throw new Error(&quot;No idea what happened... (tried getting &quot; + n1 + n2 + &quot;)&quot;);
    }
  };

  TmCalc.calcFull = function(data) {
    /* See (Breslauer et al. 1986): http://www.pnas.org/content/83/11/3746.full.pdf
    */
    var R, dh, ds, dsinit, i, n1, n2, naConc, predG, predH, predS, primerConc, primerc_local, _ref;
    predH = 0;
    predG = -(5 + 0.4);
    predS = 0;
    primerConc = 500 * 10e-3;
    naConc = 50 * 10e-3;
    R = 1.987;
    n1 = data[0];
    for (i = 1, _ref = data.length - 1; 1 &lt;= _refÂ ? i &lt;= _refÂ : i &gt;= _ref; 1 &lt;= _refÂ ? i++Â : i--) {
      n2 = data[i];
      predH -= this.getH(n1, n2);
      predG -= this.getG(n1, n2);
      predS -= this.getS(n1, n2);
      n1 = n2;
    }
    dh = 1000 * predH;
    ds = predS;
    dsinit = -10.8;
    primerc_local = primerConc / 4 * 1e-6;
    return dh / (dsinit + ds + R * Math.log(primerc_local / 10)) - 273.15 + 16.6 * Math.log(naConc / 10) / Math.LN10;
  };

  /* Again, old
  @calcFull: (data, options) -&gt;
    ##
    For more details see: http://www.basic.northwestern.edu/biotools/oligocalc.html
    ##
    freq = @calcFrequencies(data)
    
    if not options
      options = {}
    
    if not options.Na
      options.Na = 0.05
    
    GC = freq[&quot;G&quot;] + freq[&quot;C&quot;]
    AT = freq[&quot;A&quot;] + freq[&quot;T&quot;]
    N = data.length
    
    if N &lt; 14
      AT*2 + GC*4 - 16.6*Math.log(0.050)/Math.log(10) + 16.6*Math.log(options.Na)/Math.log(10)
    else if N &lt; 50 #18
      100.5 + (41 * GC/N) - (820/N) + 16.6*Math.log(options.Na)/Math.log(10)
    #else if N &lt; 50
    #  81.5 + (41 * GC/N) - (500/N) + 16.6*Math.log(options.Na) - 0.62*options.F
    else
      79.8 + 18.5*Math.log(options.Na)/Math.log(10) + (58.4 * GC/N) + (11.8 * (GC/N) * (GC/N)) - (820/N) 
    
    
  
  @calcFrequencies: (data) -&gt;
    freq = {A: 0, C: 0, G: 0, T: 0}
    data.forEach (x) -&gt;
      freq[x]++
    freq
  */

  return TmCalc;

})();

/* Old version (not very accurate):
  @calc: (data) -&gt;
    Math.round(@calcFull(data)*100)/100
  
  @calcFull: (data) -&gt;
    freq = @calcFrequencies(data)
    if data.length &lt; 14
      4 * (freq[&quot;G&quot;] + freq[&quot;C&quot;]) + 2 * (freq[&quot;A&quot;] + freq[&quot;T&quot;])
    else
      64.9 + 41 * (freq[&quot;G&quot;] + freq[&quot;C&quot;] - 16.4)/data.length
  
  @calcFrequencies: (data) -&gt;
    freq = {A: 0, C: 0, G: 0, T: 0}
    data.forEach (x) -&gt;
      freq[x]++
    freq
*/
// Underscore.js 1.3.3
// (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Underscore is freely distributable under the MIT license.
// Portions of Underscore are inspired or borrowed from Prototype,
// Oliver Steele's Functional, and John Resig's Micro-Templating.
// For all details and documentation:
// http://documentcloud.github.com/underscore
(function(){function r(a,c,d){if(a===c)return 0!==a||1/a==1/c;if(null==a||null==c)return a===c;a._chain&amp;&amp;(a=a._wrapped);c._chain&amp;&amp;(c=c._wrapped);if(a.isEqual&amp;&amp;b.isFunction(a.isEqual))return a.isEqual(c);if(c.isEqual&amp;&amp;b.isFunction(c.isEqual))return c.isEqual(a);var e=l.call(a);if(e!=l.call(c))return!1;switch(e){case &quot;[object String]&quot;:return a==&quot;&quot;+c;case &quot;[object Number]&quot;:return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case &quot;[object Date]&quot;:case &quot;[object Boolean]&quot;:return+a==+c;case &quot;[object RegExp]&quot;:return a.source==
c.source&amp;&amp;a.global==c.global&amp;&amp;a.multiline==c.multiline&amp;&amp;a.ignoreCase==c.ignoreCase}if(&quot;object&quot;!=typeof a||&quot;object&quot;!=typeof c)return!1;for(var f=d.length;f--;)if(d[f]==a)return!0;d.push(a);var f=0,g=!0;if(&quot;[object Array]&quot;==e){if(f=a.length,g=f==c.length)for(;f--&amp;&amp;(g=f in a==f in c&amp;&amp;r(a[f],c[f],d)););}else{if(&quot;constructor&quot;in a!=&quot;constructor&quot;in c||a.constructor!=c.constructor)return!1;for(var h in a)if(b.has(a,h)&amp;&amp;(f++,!(g=b.has(c,h)&amp;&amp;r(a[h],c[h],d))))break;if(g){for(h in c)if(b.has(c,h)&amp;&amp;!f--)break;
g=!f}}d.pop();return g}var s=this,I=s._,o={},k=Array.prototype,p=Object.prototype,i=k.slice,J=k.unshift,l=p.toString,K=p.hasOwnProperty,y=k.forEach,z=k.map,A=k.reduce,B=k.reduceRight,C=k.filter,D=k.every,E=k.some,q=k.indexOf,F=k.lastIndexOf,p=Array.isArray,L=Object.keys,t=Function.prototype.bind,b=function(a){return new m(a)};&quot;undefined&quot;!==typeof exports?(&quot;undefined&quot;!==typeof module&amp;&amp;module.exports&amp;&amp;(exports=module.exports=b),exports._=b):s._=b;b.VERSION=&quot;1.3.3&quot;;var j=b.each=b.forEach=function(a,
c,d){if(a!=null)if(y&amp;&amp;a.forEach===y)a.forEach(c,d);else if(a.length===+a.length)for(var e=0,f=a.length;e&lt;f;e++){if(e in a&amp;&amp;c.call(d,a[e],e,a)===o)break}else for(e in a)if(b.has(a,e)&amp;&amp;c.call(d,a[e],e,a)===o)break};b.map=b.collect=function(a,c,b){var e=[];if(a==null)return e;if(z&amp;&amp;a.map===z)return a.map(c,b);j(a,function(a,g,h){e[e.length]=c.call(b,a,g,h)});if(a.length===+a.length)e.length=a.length;return e};b.reduce=b.foldl=b.inject=function(a,c,d,e){var f=arguments.length&gt;2;a==null&amp;&amp;(a=[]);if(A&amp;&amp;
a.reduce===A){e&amp;&amp;(c=b.bind(c,e));return f?a.reduce(c,d):a.reduce(c)}j(a,function(a,b,i){if(f)d=c.call(e,d,a,b,i);else{d=a;f=true}});if(!f)throw new TypeError(&quot;Reduce of empty array with no initial value&quot;);return d};b.reduceRight=b.foldr=function(a,c,d,e){var f=arguments.length&gt;2;a==null&amp;&amp;(a=[]);if(B&amp;&amp;a.reduceRight===B){e&amp;&amp;(c=b.bind(c,e));return f?a.reduceRight(c,d):a.reduceRight(c)}var g=b.toArray(a).reverse();e&amp;&amp;!f&amp;&amp;(c=b.bind(c,e));return f?b.reduce(g,c,d,e):b.reduce(g,c)};b.find=b.detect=function(a,
c,b){var e;G(a,function(a,g,h){if(c.call(b,a,g,h)){e=a;return true}});return e};b.filter=b.select=function(a,c,b){var e=[];if(a==null)return e;if(C&amp;&amp;a.filter===C)return a.filter(c,b);j(a,function(a,g,h){c.call(b,a,g,h)&amp;&amp;(e[e.length]=a)});return e};b.reject=function(a,c,b){var e=[];if(a==null)return e;j(a,function(a,g,h){c.call(b,a,g,h)||(e[e.length]=a)});return e};b.every=b.all=function(a,c,b){var e=true;if(a==null)return e;if(D&amp;&amp;a.every===D)return a.every(c,b);j(a,function(a,g,h){if(!(e=e&amp;&amp;c.call(b,
a,g,h)))return o});return!!e};var G=b.some=b.any=function(a,c,d){c||(c=b.identity);var e=false;if(a==null)return e;if(E&amp;&amp;a.some===E)return a.some(c,d);j(a,function(a,b,h){if(e||(e=c.call(d,a,b,h)))return o});return!!e};b.include=b.contains=function(a,c){var b=false;if(a==null)return b;if(q&amp;&amp;a.indexOf===q)return a.indexOf(c)!=-1;return b=G(a,function(a){return a===c})};b.invoke=function(a,c){var d=i.call(arguments,2);return b.map(a,function(a){return(b.isFunction(c)?c||a:a[c]).apply(a,d)})};b.pluck=
function(a,c){return b.map(a,function(a){return a[c]})};b.max=function(a,c,d){if(!c&amp;&amp;b.isArray(a)&amp;&amp;a[0]===+a[0])return Math.max.apply(Math,a);if(!c&amp;&amp;b.isEmpty(a))return-Infinity;var e={computed:-Infinity};j(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b&gt;=e.computed&amp;&amp;(e={value:a,computed:b})});return e.value};b.min=function(a,c,d){if(!c&amp;&amp;b.isArray(a)&amp;&amp;a[0]===+a[0])return Math.min.apply(Math,a);if(!c&amp;&amp;b.isEmpty(a))return Infinity;var e={computed:Infinity};j(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b&lt;e.computed&amp;&amp;
(e={value:a,computed:b})});return e.value};b.shuffle=function(a){var b=[],d;j(a,function(a,f){d=Math.floor(Math.random()*(f+1));b[f]=b[d];b[d]=a});return b};b.sortBy=function(a,c,d){var e=b.isFunction(c)?c:function(a){return a[c]};return b.pluck(b.map(a,function(a,b,c){return{value:a,criteria:e.call(d,a,b,c)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c===void 0?1:d===void 0?-1:c&lt;d?-1:c&gt;d?1:0}),&quot;value&quot;)};b.groupBy=function(a,c){var d={},e=b.isFunction(c)?c:function(a){return a[c]};
j(a,function(a,b){var c=e(a,b);(d[c]||(d[c]=[])).push(a)});return d};b.sortedIndex=function(a,c,d){d||(d=b.identity);for(var e=0,f=a.length;e&lt;f;){var g=e+f&gt;&gt;1;d(a[g])&lt;d(c)?e=g+1:f=g}return e};b.toArray=function(a){return!a?[]:b.isArray(a)||b.isArguments(a)?i.call(a):a.toArray&amp;&amp;b.isFunction(a.toArray)?a.toArray():b.values(a)};b.size=function(a){return b.isArray(a)?a.length:b.keys(a).length};b.first=b.head=b.take=function(a,b,d){return b!=null&amp;&amp;!d?i.call(a,0,b):a[0]};b.initial=function(a,b,d){return i.call(a,
0,a.length-(b==null||d?1:b))};b.last=function(a,b,d){return b!=null&amp;&amp;!d?i.call(a,Math.max(a.length-b,0)):a[a.length-1]};b.rest=b.tail=function(a,b,d){return i.call(a,b==null||d?1:b)};b.compact=function(a){return b.filter(a,function(a){return!!a})};b.flatten=function(a,c){return b.reduce(a,function(a,e){if(b.isArray(e))return a.concat(c?e:b.flatten(e));a[a.length]=e;return a},[])};b.without=function(a){return b.difference(a,i.call(arguments,1))};b.uniq=b.unique=function(a,c,d){var d=d?b.map(a,d):a,
e=[];a.length&lt;3&amp;&amp;(c=true);b.reduce(d,function(d,g,h){if(c?b.last(d)!==g||!d.length:!b.include(d,g)){d.push(g);e.push(a[h])}return d},[]);return e};b.union=function(){return b.uniq(b.flatten(arguments,true))};b.intersection=b.intersect=function(a){var c=i.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)&gt;=0})})};b.difference=function(a){var c=b.flatten(i.call(arguments,1),true);return b.filter(a,function(a){return!b.include(c,a)})};b.zip=function(){for(var a=
i.call(arguments),c=b.max(b.pluck(a,&quot;length&quot;)),d=Array(c),e=0;e&lt;c;e++)d[e]=b.pluck(a,&quot;&quot;+e);return d};b.indexOf=function(a,c,d){if(a==null)return-1;var e;if(d){d=b.sortedIndex(a,c);return a[d]===c?d:-1}if(q&amp;&amp;a.indexOf===q)return a.indexOf(c);d=0;for(e=a.length;d&lt;e;d++)if(d in a&amp;&amp;a[d]===c)return d;return-1};b.lastIndexOf=function(a,b){if(a==null)return-1;if(F&amp;&amp;a.lastIndexOf===F)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&amp;&amp;a[d]===b)return d;return-1};b.range=function(a,b,d){if(arguments.length&lt;=
1){b=a||0;a=0}for(var d=arguments[2]||1,e=Math.max(Math.ceil((b-a)/d),0),f=0,g=Array(e);f&lt;e;){g[f++]=a;a=a+d}return g};var H=function(){};b.bind=function(a,c){var d,e;if(a.bind===t&amp;&amp;t)return t.apply(a,i.call(arguments,1));if(!b.isFunction(a))throw new TypeError;e=i.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(c,e.concat(i.call(arguments)));H.prototype=a.prototype;var b=new H,g=a.apply(b,e.concat(i.call(arguments)));return Object(g)===g?g:b}};b.bindAll=function(a){var c=
i.call(arguments,1);c.length==0&amp;&amp;(c=b.functions(a));j(c,function(c){a[c]=b.bind(a[c],a)});return a};b.memoize=function(a,c){var d={};c||(c=b.identity);return function(){var e=c.apply(this,arguments);return b.has(d,e)?d[e]:d[e]=a.apply(this,arguments)}};b.delay=function(a,b){var d=i.call(arguments,2);return setTimeout(function(){return a.apply(null,d)},b)};b.defer=function(a){return b.delay.apply(b,[a,1].concat(i.call(arguments,1)))};b.throttle=function(a,c){var d,e,f,g,h,i,j=b.debounce(function(){h=
g=false},c);return function(){d=this;e=arguments;f||(f=setTimeout(function(){f=null;h&amp;&amp;a.apply(d,e);j()},c));g?h=true:i=a.apply(d,e);j();g=true;return i}};b.debounce=function(a,b,d){var e;return function(){var f=this,g=arguments;d&amp;&amp;!e&amp;&amp;a.apply(f,g);clearTimeout(e);e=setTimeout(function(){e=null;d||a.apply(f,g)},b)}};b.once=function(a){var b=false,d;return function(){if(b)return d;b=true;return d=a.apply(this,arguments)}};b.wrap=function(a,b){return function(){var d=[a].concat(i.call(arguments,0));
return b.apply(this,d)}};b.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;d&gt;=0;d--)b=[a[d].apply(this,b)];return b[0]}};b.after=function(a,b){return a&lt;=0?b():function(){if(--a&lt;1)return b.apply(this,arguments)}};b.keys=L||function(a){if(a!==Object(a))throw new TypeError(&quot;Invalid object&quot;);var c=[],d;for(d in a)b.has(a,d)&amp;&amp;(c[c.length]=d);return c};b.values=function(a){return b.map(a,b.identity)};b.functions=b.methods=function(a){var c=[],d;for(d in a)b.isFunction(a[d])&amp;&amp;
c.push(d);return c.sort()};b.extend=function(a){j(i.call(arguments,1),function(b){for(var d in b)a[d]=b[d]});return a};b.pick=function(a){var c={};j(b.flatten(i.call(arguments,1)),function(b){b in a&amp;&amp;(c[b]=a[b])});return c};b.defaults=function(a){j(i.call(arguments,1),function(b){for(var d in b)a[d]==null&amp;&amp;(a[d]=b[d])});return a};b.clone=function(a){return!b.isObject(a)?a:b.isArray(a)?a.slice():b.extend({},a)};b.tap=function(a,b){b(a);return a};b.isEqual=function(a,b){return r(a,b,[])};b.isEmpty=
function(a){if(a==null)return true;if(b.isArray(a)||b.isString(a))return a.length===0;for(var c in a)if(b.has(a,c))return false;return true};b.isElement=function(a){return!!(a&amp;&amp;a.nodeType==1)};b.isArray=p||function(a){return l.call(a)==&quot;[object Array]&quot;};b.isObject=function(a){return a===Object(a)};b.isArguments=function(a){return l.call(a)==&quot;[object Arguments]&quot;};b.isArguments(arguments)||(b.isArguments=function(a){return!(!a||!b.has(a,&quot;callee&quot;))});b.isFunction=function(a){return l.call(a)==&quot;[object Function]&quot;};
b.isString=function(a){return l.call(a)==&quot;[object String]&quot;};b.isNumber=function(a){return l.call(a)==&quot;[object Number]&quot;};b.isFinite=function(a){return b.isNumber(a)&amp;&amp;isFinite(a)};b.isNaN=function(a){return a!==a};b.isBoolean=function(a){return a===true||a===false||l.call(a)==&quot;[object Boolean]&quot;};b.isDate=function(a){return l.call(a)==&quot;[object Date]&quot;};b.isRegExp=function(a){return l.call(a)==&quot;[object RegExp]&quot;};b.isNull=function(a){return a===null};b.isUndefined=function(a){return a===void 0};b.has=function(a,
b){return K.call(a,b)};b.noConflict=function(){s._=I;return this};b.identity=function(a){return a};b.times=function(a,b,d){for(var e=0;e&lt;a;e++)b.call(d,e)};b.escape=function(a){return(&quot;&quot;+a).replace(/&amp;/g,&quot;&amp;&quot;).replace(/&lt;/g,&quot;&lt;&quot;).replace(/&gt;/g,&quot;&gt;&quot;).replace(/&quot;/g,&quot;&quot;&quot;).replace(/'/g,&quot;'&quot;).replace(/\//g,&quot;/&quot;)};b.result=function(a,c){if(a==null)return null;var d=a[c];return b.isFunction(d)?d.call(a):d};b.mixin=function(a){j(b.functions(a),function(c){M(c,b[c]=a[c])})};var N=0;b.uniqueId=
function(a){var b=N++;return a?a+b:b};b.templateSettings={evaluate:/&lt;%([\s\S]+?)%&gt;/g,interpolate:/&lt;%=([\s\S]+?)%&gt;/g,escape:/&lt;%-([\s\S]+?)%&gt;/g};var u=/.^/,n={&quot;\\&quot;:&quot;\\&quot;,&quot;'&quot;:&quot;'&quot;,r:&quot;\r&quot;,n:&quot;\n&quot;,t:&quot;\t&quot;,u2028:&quot;\u2028&quot;,u2029:&quot;\u2029&quot;},v;for(v in n)n[n[v]]=v;var O=/\\|'|\r|\n|\t|\u2028|\u2029/g,P=/\\(\\|'|r|n|t|u2028|u2029)/g,w=function(a){return a.replace(P,function(a,b){return n[b]})};b.template=function(a,c,d){d=b.defaults(d||{},b.templateSettings);a=&quot;__p+='&quot;+a.replace(O,function(a){return&quot;\\&quot;+n[a]}).replace(d.escape||
u,function(a,b){return&quot;'+\n_.escape(&quot;+w(b)+&quot;)+\n'&quot;}).replace(d.interpolate||u,function(a,b){return&quot;'+\n(&quot;+w(b)+&quot;)+\n'&quot;}).replace(d.evaluate||u,function(a,b){return&quot;';\n&quot;+w(b)+&quot;\n;__p+='&quot;})+&quot;';\n&quot;;d.variable||(a=&quot;with(obj||{}){\n&quot;+a+&quot;}\n&quot;);var a=&quot;var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n&quot;+a+&quot;return __p;\n&quot;,e=new Function(d.variable||&quot;obj&quot;,&quot;_&quot;,a);if(c)return e(c,b);c=function(a){return e.call(this,a,b)};c.source=&quot;function(&quot;+(d.variable||&quot;obj&quot;)+&quot;){\n&quot;+a+&quot;}&quot;;return c};
b.chain=function(a){return b(a).chain()};var m=function(a){this._wrapped=a};b.prototype=m.prototype;var x=function(a,c){return c?b(a).chain():a},M=function(a,c){m.prototype[a]=function(){var a=i.call(arguments);J.call(a,this._wrapped);return x(c.apply(b,a),this._chain)}};b.mixin(b);j(&quot;pop,push,reverse,shift,sort,splice,unshift&quot;.split(&quot;,&quot;),function(a){var b=k[a];m.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);var e=d.length;(a==&quot;shift&quot;||a==&quot;splice&quot;)&amp;&amp;e===0&amp;&amp;delete d[0];return x(d,
this._chain)}});j([&quot;concat&quot;,&quot;join&quot;,&quot;slice&quot;],function(a){var b=k[a];m.prototype[a]=function(){return x(b.apply(this._wrapped,arguments),this._chain)}});m.prototype.chain=function(){this._chain=true;return this};m.prototype.value=function(){return this._wrapped}}).call(this);</PRE></DIV></DIV></SPAN></SPAN></SPAN></DIV></SPAN></SPAN></DIV></SPAN></DIV></DIV></DIV></DIV></DIV></DIV></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2012.igem.org/Team:EPF-Lausanne/PrimerDesignHelper.js">http://2012.igem.org/Team:EPF-Lausanne/PrimerDesignHelper.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:EPF-Lausanne/PrimerDesignHelper.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:EPF-Lausanne/PrimerDesignHelper.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:EPF-Lausanne/PrimerDesignHelper.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:EPF-Lausanne/PrimerDesignHelper.js&amp;oldid=50025" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2012.igem.org:Privacy_policy" title="2012.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2012.igem.org:General_disclaimer" title="2012.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>