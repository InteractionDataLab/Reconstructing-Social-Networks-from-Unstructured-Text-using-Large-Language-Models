<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Amsterdam_maarten_canvas-tools_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Amsterdam/maarten/canvas-tools.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Amsterdam/maarten/canvas-tools.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Amsterdam/maarten/canvas-tools.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Amsterdam/maarten/canvas-tools.js&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Amsterdam/maarten/canvas-tools.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform">Â </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Amsterdam/maarten/canvas-tools.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2012.igem.org</H3><P>/*
</P><PRE>A class to parse color values
@author Stoyan Stefanov &lt;sstoo@gmail.com&gt;
@link   <A href="http://www.phpied.com/rgb-color-parser-in-javascript/" class="external free" rel="nofollow">http://www.phpied.com/rgb-color-parser-in-javascript/</A>
Use it if you like it
</PRE><PRE>canvg.js - Javascript SVG parser and renderer on Canvas
MIT Licensed 
Gabe Lerner (gabelerner@gmail.com)
<A href="http://code.google.com/p/canvg/" class="external free" rel="nofollow">http://code.google.com/p/canvg/</A></PRE><PRE>Requires: rgbcolor.js - <A href="http://www.phpied.com/rgb-color-parser-in-javascript/" class="external free" rel="nofollow">http://www.phpied.com/rgb-color-parser-in-javascript/</A></PRE><PRE>Highcharts JS v2.2.5 (2012-06-08)
CanVGRenderer Extension module
</PRE><PRE>(c) 2011-2012 Torstein H?nsi, Erik Olsson
</PRE><PRE>License: www.highcharts.com/license
</PRE><UL><LI>/
</LI></UL><P>function RGBColor(m){this.ok=!1;m.charAt(0)==&quot;#&quot;&amp;&amp;(m=m.substr(1,6));var m=m.replace(/ /g,&quot;&quot;),m=m.toLowerCase(),a={aliceblue:&quot;f0f8ff&quot;,antiquewhite:&quot;faebd7&quot;,aqua:&quot;00ffff&quot;,aquamarine:&quot;7fffd4&quot;,azure:&quot;f0ffff&quot;,beige:&quot;f5f5dc&quot;,bisque:&quot;ffe4c4&quot;,black:&quot;000000&quot;,blanchedalmond:&quot;ffebcd&quot;,blue:&quot;0000ff&quot;,blueviolet:&quot;8a2be2&quot;,brown:&quot;a52a2a&quot;,burlywood:&quot;deb887&quot;,cadetblue:&quot;5f9ea0&quot;,chartreuse:&quot;7fff00&quot;,chocolate:&quot;d2691e&quot;,coral:&quot;ff7f50&quot;,cornflowerblue:&quot;6495ed&quot;,cornsilk:&quot;fff8dc&quot;,crimson:&quot;dc143c&quot;,cyan:&quot;00ffff&quot;,darkblue:&quot;00008b&quot;,
darkcyan:&quot;008b8b&quot;,darkgoldenrod:&quot;b8860b&quot;,darkgray:&quot;a9a9a9&quot;,darkgreen:&quot;006400&quot;,darkkhaki:&quot;bdb76b&quot;,darkmagenta:&quot;8b008b&quot;,darkolivegreen:&quot;556b2f&quot;,darkorange:&quot;ff8c00&quot;,darkorchid:&quot;9932cc&quot;,darkred:&quot;8b0000&quot;,darksalmon:&quot;e9967a&quot;,darkseagreen:&quot;8fbc8f&quot;,darkslateblue:&quot;483d8b&quot;,darkslategray:&quot;2f4f4f&quot;,darkturquoise:&quot;00ced1&quot;,darkviolet:&quot;9400d3&quot;,deeppink:&quot;ff1493&quot;,deepskyblue:&quot;00bfff&quot;,dimgray:&quot;696969&quot;,dodgerblue:&quot;1e90ff&quot;,feldspar:&quot;d19275&quot;,firebrick:&quot;b22222&quot;,floralwhite:&quot;fffaf0&quot;,forestgreen:&quot;228b22&quot;,fuchsia:&quot;ff00ff&quot;,
gainsboro:&quot;dcdcdc&quot;,ghostwhite:&quot;f8f8ff&quot;,gold:&quot;ffd700&quot;,goldenrod:&quot;daa520&quot;,gray:&quot;808080&quot;,green:&quot;008000&quot;,greenyellow:&quot;adff2f&quot;,honeydew:&quot;f0fff0&quot;,hotpink:&quot;ff69b4&quot;,indianred:&quot;cd5c5c&quot;,indigo:&quot;4b0082&quot;,ivory:&quot;fffff0&quot;,khaki:&quot;f0e68c&quot;,lavender:&quot;e6e6fa&quot;,lavenderblush:&quot;fff0f5&quot;,lawngreen:&quot;7cfc00&quot;,lemonchiffon:&quot;fffacd&quot;,lightblue:&quot;add8e6&quot;,lightcoral:&quot;f08080&quot;,lightcyan:&quot;e0ffff&quot;,lightgoldenrodyellow:&quot;fafad2&quot;,lightgrey:&quot;d3d3d3&quot;,lightgreen:&quot;90ee90&quot;,lightpink:&quot;ffb6c1&quot;,lightsalmon:&quot;ffa07a&quot;,lightseagreen:&quot;20b2aa&quot;,lightskyblue:&quot;87cefa&quot;,
lightslateblue:&quot;8470ff&quot;,lightslategray:&quot;778899&quot;,lightsteelblue:&quot;b0c4de&quot;,lightyellow:&quot;ffffe0&quot;,lime:&quot;00ff00&quot;,limegreen:&quot;32cd32&quot;,linen:&quot;faf0e6&quot;,magenta:&quot;ff00ff&quot;,maroon:&quot;800000&quot;,mediumaquamarine:&quot;66cdaa&quot;,mediumblue:&quot;0000cd&quot;,mediumorchid:&quot;ba55d3&quot;,mediumpurple:&quot;9370d8&quot;,mediumseagreen:&quot;3cb371&quot;,mediumslateblue:&quot;7b68ee&quot;,mediumspringgreen:&quot;00fa9a&quot;,mediumturquoise:&quot;48d1cc&quot;,mediumvioletred:&quot;c71585&quot;,midnightblue:&quot;191970&quot;,mintcream:&quot;f5fffa&quot;,mistyrose:&quot;ffe4e1&quot;,moccasin:&quot;ffe4b5&quot;,navajowhite:&quot;ffdead&quot;,navy:&quot;000080&quot;,
oldlace:&quot;fdf5e6&quot;,olive:&quot;808000&quot;,olivedrab:&quot;6b8e23&quot;,orange:&quot;ffa500&quot;,orangered:&quot;ff4500&quot;,orchid:&quot;da70d6&quot;,palegoldenrod:&quot;eee8aa&quot;,palegreen:&quot;98fb98&quot;,paleturquoise:&quot;afeeee&quot;,palevioletred:&quot;d87093&quot;,papayawhip:&quot;ffefd5&quot;,peachpuff:&quot;ffdab9&quot;,peru:&quot;cd853f&quot;,pink:&quot;ffc0cb&quot;,plum:&quot;dda0dd&quot;,powderblue:&quot;b0e0e6&quot;,purple:&quot;800080&quot;,red:&quot;ff0000&quot;,rosybrown:&quot;bc8f8f&quot;,royalblue:&quot;4169e1&quot;,saddlebrown:&quot;8b4513&quot;,salmon:&quot;fa8072&quot;,sandybrown:&quot;f4a460&quot;,seagreen:&quot;2e8b57&quot;,seashell:&quot;fff5ee&quot;,sienna:&quot;a0522d&quot;,silver:&quot;c0c0c0&quot;,skyblue:&quot;87ceeb&quot;,slateblue:&quot;6a5acd&quot;,
slategray:&quot;708090&quot;,snow:&quot;fffafa&quot;,springgreen:&quot;00ff7f&quot;,steelblue:&quot;4682b4&quot;,tan:&quot;d2b48c&quot;,teal:&quot;008080&quot;,thistle:&quot;d8bfd8&quot;,tomato:&quot;ff6347&quot;,turquoise:&quot;40e0d0&quot;,violet:&quot;ee82ee&quot;,violetred:&quot;d02090&quot;,wheat:&quot;f5deb3&quot;,white:&quot;ffffff&quot;,whitesmoke:&quot;f5f5f5&quot;,yellow:&quot;ffff00&quot;,yellowgreen:&quot;9acd32&quot;},c;for(c in a)m==c&amp;&amp;(m=a[c]);var d=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:[&quot;rgb(123, 234, 45)&quot;,&quot;rgb(255,234,245)&quot;],process:function(b){return[parseInt(b[1]),parseInt(b[2]),parseInt(b[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,
example:[&quot;#00ff00&quot;,&quot;336699&quot;],process:function(b){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:[&quot;#fb0&quot;,&quot;f0f&quot;],process:function(b){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}}];for(c=0;c&lt;d.length;c++){var b=d[c].process,k=d[c].re.exec(m);if(k)channels=b(k),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0}this.r=this.r&lt;0||isNaN(this.r)?0:this.r&gt;255?255:this.r;this.g=this.g&lt;0||isNaN(this.g)?0:
this.g&gt;255?255:this.g;this.b=this.b&lt;0||isNaN(this.b)?0:this.b&gt;255?255:this.b;this.toRGB=function(){return&quot;rgb(&quot;+this.r+&quot;, &quot;+this.g+&quot;, &quot;+this.b+&quot;)&quot;};this.toHex=function(){var b=this.r.toString(16),a=this.g.toString(16),d=this.b.toString(16);b.length==1&amp;&amp;(b=&quot;0&quot;+b);a.length==1&amp;&amp;(a=&quot;0&quot;+a);d.length==1&amp;&amp;(d=&quot;0&quot;+d);return&quot;#&quot;+b+a+d};this.getHelpXML=function(){for(var b=[],k=0;k&lt;d.length;k++)for(var c=d[k].example,j=0;j&lt;c.length;j++)b[b.length]=c[j];for(var h in a)b[b.length]=h;c=document.createElement(&quot;ul&quot;);
c.setAttribute(&quot;id&quot;,&quot;rgbcolor-examples&quot;);for(k=0;k<B> &quot;+o.toRGB()+&quot; -&gt; &quot;+o.toHex());l.appendChild(n);l.appendChild(q);c.appendChild(l)}catch(p){}return c}}
if(!window.console)window.console={},window.console.log=function(){},window.console.dir=function(){};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(m){for(var a=0;a&lt;this.length;a++)if(this[a]==m)return a;return-1};
(function(){function m(){var a={FRAMERATE:30,MAX_VIRTUAL_PIXELS:3E4};a.init=function(c){a.Definitions={};a.Styles={};a.Animations=[];a.Images=[];a.ctx=c;a.ViewPort=new function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=[]};this.SetCurrent=function(a,b){this.viewPorts.push({width:a,height:b})};this.RemoveCurrent=function(){this.viewPorts.pop()};this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};this.height=function(){return this.Current().height};
this.ComputeSize=function(a){return a!=null&amp;&amp;typeof a==&quot;number&quot;?a:a==&quot;x&quot;?this.width():a==&quot;y&quot;?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}};a.init();a.ImagesLoaded=function(){for(var c=0;c&lt;a.Images.length;c++)if(!a.Images[c].loaded)return!1;return!0};a.trim=function(a){return a.replace(/^\s+|\s+$/g,&quot;&quot;)};a.compressSpaces=function(a){return a.replace(/[\s\r\t\n]+/gm,&quot; &quot;)};a.ajax=function(a){var d;return(d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;))?
(d.open(&quot;GET&quot;,a,!1),d.send(null),d.responseText):null};a.parseXml=function(a){if(window.DOMParser)return(new DOMParser).parseFromString(a,&quot;text/xml&quot;);else{var a=a.replace(/&lt;!DOCTYPE svg[^&gt;]*&gt;/,&quot;&quot;),d=new ActiveXObject(&quot;Microsoft.XMLDOM&quot;);d.async=&quot;false&quot;;d.loadXML(a);return d}};a.Property=function(c,d){this.name=c;this.value=d;this.hasValue=function(){return this.value!=null&amp;&amp;this.value!==&quot;&quot;};this.numValue=function(){if(!this.hasValue())return 0;var b=parseFloat(this.value);(this.value+&quot;&quot;).match(/%$/)&amp;&amp;
(b/=100);return b};this.valueOrDefault=function(b){return this.hasValue()?this.value:b};this.numValueOrDefault=function(b){return this.hasValue()?this.numValue():b};var b=this;this.Color={addOpacity:function(d){var c=b.value;if(d!=null&amp;&amp;d!=&quot;&quot;){var f=new RGBColor(b.value);f.ok&amp;&amp;(c=&quot;rgba(&quot;+f.r+&quot;, &quot;+f.g+&quot;, &quot;+f.b+&quot;, &quot;+d+&quot;)&quot;)}return new a.Property(b.name,c)}};this.Definition={getDefinition:function(){var d=b.value.replace(/^(url\()?#([^\)]+)\)?$/,&quot;$2&quot;);return a.Definitions[d]},isUrl:function(){return b.value.indexOf(&quot;url(&quot;)==
0},getFillStyle:function(b){var d=this.getDefinition();return d!=null&amp;&amp;d.createGradient?d.createGradient(a.ctx,b):d!=null&amp;&amp;d.createPattern?d.createPattern(a.ctx,b):null}};this.Length={DPI:function(){return 96},EM:function(b){var d=12,c=new a.Property(&quot;fontSize&quot;,a.Font.Parse(a.ctx.font).fontSize);c.hasValue()&amp;&amp;(d=c.Length.toPixels(b));return d},toPixels:function(d){if(!b.hasValue())return 0;var c=b.value+&quot;&quot;;return c.match(/em$/)?b.numValue()*this.EM(d):c.match(/ex$/)?b.numValue()*this.EM(d)/2:c.match(/px$/)?
b.numValue():c.match(/pt$/)?b.numValue()*1.25:c.match(/pc$/)?b.numValue()*15:c.match(/cm$/)?b.numValue()*this.DPI(d)/2.54:c.match(/mm$/)?b.numValue()*this.DPI(d)/25.4:c.match(/in$/)?b.numValue()*this.DPI(d):c.match(/%$/)?b.numValue()*a.ViewPort.ComputeSize(d):b.numValue()}};this.Time={toMilliseconds:function(){if(!b.hasValue())return 0;var a=b.value+&quot;&quot;;if(a.match(/s$/))return b.numValue()*1E3;a.match(/ms$/);return b.numValue()}};this.Angle={toRadians:function(){if(!b.hasValue())return 0;var a=b.value+
&quot;&quot;;return a.match(/deg$/)?b.numValue()*(Math.PI/180):a.match(/grad$/)?b.numValue()*(Math.PI/200):a.match(/rad$/)?b.numValue():b.numValue()*(Math.PI/180)}}};a.Font=new function(){this.Styles=[&quot;normal&quot;,&quot;italic&quot;,&quot;oblique&quot;,&quot;inherit&quot;];this.Variants=[&quot;normal&quot;,&quot;small-caps&quot;,&quot;inherit&quot;];this.Weights=&quot;normal,bold,bolder,lighter,100,200,300,400,500,600,700,800,900,inherit&quot;.split(&quot;,&quot;);this.CreateFont=function(d,b,c,e,f,g){g=g!=null?this.Parse(g):this.CreateFont(&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,a.ctx.font);return{fontFamily:f||
g.fontFamily,fontSize:e||g.fontSize,fontStyle:d||g.fontStyle,fontWeight:c||g.fontWeight,fontVariant:b||g.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(&quot; &quot;)}}};var c=this;this.Parse=function(d){for(var b={},d=a.trim(a.compressSpaces(d||&quot;&quot;)).split(&quot; &quot;),k=!1,e=!1,f=!1,g=!1,j=&quot;&quot;,h=0;h&lt;d.length;h++)if(!e&amp;&amp;c.Styles.indexOf(d[h])!=-1){if(d[h]!=&quot;inherit&quot;)b.fontStyle=d[h];e=!0}else if(!g&amp;&amp;c.Variants.indexOf(d[h])!=-1){if(d[h]!=&quot;inherit&quot;)b.fontVariant=
d[h];e=g=!0}else if(!f&amp;&amp;c.Weights.indexOf(d[h])!=-1){if(d[h]!=&quot;inherit&quot;)b.fontWeight=d[h];e=g=f=!0}else if(k)d[h]!=&quot;inherit&quot;&amp;&amp;(j+=d[h]);else{if(d[h]!=&quot;inherit&quot;)b.fontSize=d[h].split(&quot;/&quot;)[0];e=g=f=k=!0}if(j!=&quot;&quot;)b.fontFamily=j;return b}};a.ToNumberArray=function(c){for(var c=a.trim(a.compressSpaces((c||&quot;&quot;).replace(/,/g,&quot; &quot;))).split(&quot; &quot;),d=0;d&lt;c.length;d++)c[d]=parseFloat(c[d]);return c};a.Point=function(a,d){this.x=a;this.y=d;this.angleTo=function(b){return Math.atan2(b.y-this.y,b.x-this.x)};this.applyTransform=
function(b){var a=this.x*b[1]+this.y*b[3]+b[5];this.x=this.x*b[0]+this.y*b[2]+b[4];this.y=a}};a.CreatePoint=function(c){c=a.ToNumberArray(c);return new a.Point(c[0],c[1])};a.CreatePath=function(c){for(var c=a.ToNumberArray(c),d=[],b=0;b&lt;c.length;b+=2)d.push(new a.Point(c[b],c[b+1]));return d};a.BoundingBox=function(a,d,b,k){this.y2=this.x2=this.y1=this.x1=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-
this.y1};this.addPoint=function(b,a){if(b!=null){if(isNaN(this.x1)||isNaN(this.x2))this.x2=this.x1=b;if(b&lt;this.x1)this.x1=b;if(b&gt;this.x2)this.x2=b}if(a!=null){if(isNaN(this.y1)||isNaN(this.y2))this.y2=this.y1=a;if(a&lt;this.y1)this.y1=a;if(a&gt;this.y2)this.y2=a}};this.addX=function(b){this.addPoint(b,null)};this.addY=function(b){this.addPoint(null,b)};this.addBoundingBox=function(b){this.addPoint(b.x1,b.y1);this.addPoint(b.x2,b.y2)};this.addQuadraticCurve=function(b,a,d,c,k,l){d=b+2/3*(d-b);c=a+2/3*(c-
a);this.addBezierCurve(b,a,d,d+1/3*(k-b),c,c+1/3*(l-a),k,l)};this.addBezierCurve=function(b,a,d,c,k,l,o,n){var q=[b,a],p=[d,c],t=[k,l],m=[o,n];this.addPoint(q[0],q[1]);this.addPoint(m[0],m[1]);for(i=0;i&lt;=1;i++)b=function(b){return Math.pow(1-b,3)*q[i]+3*Math.pow(1-b,2)*b*p[i]+3*(1-b)*Math.pow(b,2)*t[i]+Math.pow(b,3)*m[i]},a=6*q[i]-12*p[i]+6*t[i],d=-3*q[i]+9*p[i]-9*t[i]+3*m[i],c=3*p[i]-3*q[i],d==0?a!=0&amp;&amp;(a=-c/a,0&lt;a&amp;&amp;a&lt;1&amp;&amp;(i==0&amp;&amp;this.addX(b(a)),i==1&amp;&amp;this.addY(b(a)))):(c=Math.pow(a,2)-4*c*d,c&lt;0||(k=
(-a+Math.sqrt(c))/(2*d),0&lt;k&amp;&amp;k&lt;1&amp;&amp;(i==0&amp;&amp;this.addX(b(k)),i==1&amp;&amp;this.addY(b(k))),a=(-a-Math.sqrt(c))/(2*d),0&lt;a&amp;&amp;a&lt;1&amp;&amp;(i==0&amp;&amp;this.addX(b(a)),i==1&amp;&amp;this.addY(b(a)))))};this.isPointInBox=function(b,a){return this.x1&lt;=b&amp;&amp;b&lt;=this.x2&amp;&amp;this.y1&lt;=a&amp;&amp;a&lt;=this.y2};this.addPoint(a,d);this.addPoint(b,k)};a.Transform=function(c){var d=this;this.Type={};this.Type.translate=function(b){this.p=a.CreatePoint(b);this.apply=function(b){b.translate(this.p.x||0,this.p.y||0)};this.applyToPoint=function(b){b.applyTransform([1,
0,0,1,this.p.x||0,this.p.y||0])}};this.Type.rotate=function(b){b=a.ToNumberArray(b);this.angle=new a.Property(&quot;angle&quot;,b[0]);this.cx=b[1]||0;this.cy=b[2]||0;this.apply=function(b){b.translate(this.cx,this.cy);b.rotate(this.angle.Angle.toRadians());b.translate(-this.cx,-this.cy)};this.applyToPoint=function(b){var a=this.angle.Angle.toRadians();b.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]);b.applyTransform([Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a),0,0]);b.applyTransform([1,0,0,1,-this.p.x||
0,-this.p.y||0])}};this.Type.scale=function(b){this.p=a.CreatePoint(b);this.apply=function(b){b.scale(this.p.x||1,this.p.y||this.p.x||1)};this.applyToPoint=function(b){b.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}};this.Type.matrix=function(b){this.m=a.ToNumberArray(b);this.apply=function(b){b.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])};this.applyToPoint=function(b){b.applyTransform(this.m)}};this.Type.SkewBase=function(b){this.base=d.Type.matrix;this.base(b);this.angle=
new a.Property(&quot;angle&quot;,b)};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(b){this.base=d.Type.SkewBase;this.base(b);this.m=[1,0,Math.tan(this.angle.Angle.toRadians()),1,0,0]};this.Type.skewX.prototype=new this.Type.SkewBase;this.Type.skewY=function(b){this.base=d.Type.SkewBase;this.base(b);this.m=[1,Math.tan(this.angle.Angle.toRadians()),0,1,0,0]};this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(b){for(var a=0;a&lt;this.transforms.length;a++)this.transforms[a].apply(b)};
this.applyToPoint=function(b){for(var a=0;a&lt;this.transforms.length;a++)this.transforms[a].applyToPoint(b)};for(var c=a.trim(a.compressSpaces(c)).split(/\s(?=[a-z])/),b=0;b&lt;c.length;b++){var k=c[b].split(&quot;(&quot;)[0],e=c[b].split(&quot;(&quot;)[1].replace(&quot;)&quot;,&quot;&quot;);this.transforms.push(new this.Type[k](e))}};a.AspectRatio=function(c,d,b,k,e,f,g,j,h,l){var d=a.compressSpaces(d),d=d.replace(/^defer\s/,&quot;&quot;),o=d.split(&quot; &quot;)[0]||&quot;xMidYMid&quot;,d=d.split(&quot; &quot;)[1]||&quot;meet&quot;,n=b/k,q=e/f,p=Math.min(n,q),m=Math.max(n,q);d==&quot;meet&quot;&amp;&amp;(k*=
p,f*=p);d==&quot;slice&quot;&amp;&amp;(k*=m,f*=m);h=new a.Property(&quot;refX&quot;,h);l=new a.Property(&quot;refY&quot;,l);h.hasValue()&amp;&amp;l.hasValue()?c.translate(-p*h.Length.toPixels(&quot;x&quot;),-p*l.Length.toPixels(&quot;y&quot;)):(o.match(/^xMid/)&amp;&amp;(d==&quot;meet&quot;&amp;&amp;p==q||d==&quot;slice&quot;&amp;&amp;m==q)&amp;&amp;c.translate(b/2-k/2,0),o.match(/YMid$/)&amp;&amp;(d==&quot;meet&quot;&amp;&amp;p==n||d==&quot;slice&quot;&amp;&amp;m==n)&amp;&amp;c.translate(0,e/2-f/2),o.match(/^xMax/)&amp;&amp;(d==&quot;meet&quot;&amp;&amp;p==q||d==&quot;slice&quot;&amp;&amp;m==q)&amp;&amp;c.translate(b-k,0),o.match(/YMax$/)&amp;&amp;(d==&quot;meet&quot;&amp;&amp;p==n||d==&quot;slice&quot;&amp;&amp;m==n)&amp;&amp;c.translate(0,e-f));o==&quot;none&quot;?c.scale(n,
q):d==&quot;meet&quot;?c.scale(p,p):d==&quot;slice&quot;&amp;&amp;c.scale(m,m);c.translate(g==null?0:-g,j==null?0:-j)};a.Element={};a.Element.ElementBase=function(c){this.attributes={};this.styles={};this.children=[];this.attribute=function(b,d){var c=this.attributes[b];if(c!=null)return c;c=new a.Property(b,&quot;&quot;);d==!0&amp;&amp;(this.attributes[b]=c);return c};this.style=function(b,d){var c=this.styles[b];if(c!=null)return c;c=this.attribute(b);if(c!=null&amp;&amp;c.hasValue())return c;c=this.parent;if(c!=null&amp;&amp;(c=c.style(b),c!=null&amp;&amp;c.hasValue()))return c;
c=new a.Property(b,&quot;&quot;);d==!0&amp;&amp;(this.styles[b]=c);return c};this.render=function(b){if(this.style(&quot;display&quot;).value!=&quot;none&quot;&amp;&amp;this.attribute(&quot;visibility&quot;).value!=&quot;hidden&quot;){b.save();this.setContext(b);if(this.attribute(&quot;mask&quot;).hasValue()){var a=this.attribute(&quot;mask&quot;).Definition.getDefinition();a!=null&amp;&amp;a.apply(b,this)}else this.style(&quot;filter&quot;).hasValue()?(a=this.style(&quot;filter&quot;).Definition.getDefinition(),a!=null&amp;&amp;a.apply(b,this)):this.renderChildren(b);this.clearContext(b);b.restore()}};this.setContext=
function(){};this.clearContext=function(){};this.renderChildren=function(b){for(var a=0;a&lt;this.children.length;a++)this.children[a].render(b)};this.addChild=function(b,d){var c=b;d&amp;&amp;(c=a.CreateElement(b));c.parent=this;this.children.push(c)};if(c!=null&amp;&amp;c.nodeType==1){for(var d=0;d&lt;c.childNodes.length;d++){var b=c.childNodes[d];b.nodeType==1&amp;&amp;this.addChild(b,!0)}for(d=0;d&lt;c.attributes.length;d++)b=c.attributes[d],this.attributes[b.nodeName]=new a.Property(b.nodeName,b.nodeValue);b=a.Styles[c.nodeName];
if(b!=null)for(var k in b)this.styles[k]=b[k];if(this.attribute(&quot;class&quot;).hasValue())for(var d=a.compressSpaces(this.attribute(&quot;class&quot;).value).split(&quot; &quot;),e=0;e&lt;d.length;e++){b=a.Styles[&quot;.&quot;+d[e]];if(b!=null)for(k in b)this.styles[k]=b[k];b=a.Styles[c.nodeName+&quot;.&quot;+d[e]];if(b!=null)for(k in b)this.styles[k]=b[k]}if(this.attribute(&quot;style&quot;).hasValue()){b=this.attribute(&quot;style&quot;).value.split(&quot;;&quot;);for(d=0;d&lt;b.length;d++)a.trim(b[d])!=&quot;&quot;&amp;&amp;(c=b[d].split(&quot;:&quot;),k=a.trim(c[0]),c=a.trim(c[1]),this.styles[k]=new a.Property(k,
c))}this.attribute(&quot;id&quot;).hasValue()&amp;&amp;a.Definitions[this.attribute(&quot;id&quot;).value]==null&amp;&amp;(a.Definitions[this.attribute(&quot;id&quot;).value]=this)}};a.Element.RenderedElementBase=function(c){this.base=a.Element.ElementBase;this.base(c);this.setContext=function(d){if(this.style(&quot;fill&quot;).Definition.isUrl()){var b=this.style(&quot;fill&quot;).Definition.getFillStyle(this);if(b!=null)d.fillStyle=b}else if(this.style(&quot;fill&quot;).hasValue())b=this.style(&quot;fill&quot;),this.style(&quot;fill-opacity&quot;).hasValue()&amp;&amp;(b=b.Color.addOpacity(this.style(&quot;fill-opacity&quot;).value)),
d.fillStyle=b.value==&quot;none&quot;?&quot;rgba(0,0,0,0)&quot;:b.value;if(this.style(&quot;stroke&quot;).Definition.isUrl()){if(b=this.style(&quot;stroke&quot;).Definition.getFillStyle(this),b!=null)d.strokeStyle=b}else if(this.style(&quot;stroke&quot;).hasValue())b=this.style(&quot;stroke&quot;),this.style(&quot;stroke-opacity&quot;).hasValue()&amp;&amp;(b=b.Color.addOpacity(this.style(&quot;stroke-opacity&quot;).value)),d.strokeStyle=b.value==&quot;none&quot;?&quot;rgba(0,0,0,0)&quot;:b.value;if(this.style(&quot;stroke-width&quot;).hasValue())d.lineWidth=this.style(&quot;stroke-width&quot;).Length.toPixels();if(this.style(&quot;stroke-linecap&quot;).hasValue())d.lineCap=
this.style(&quot;stroke-linecap&quot;).value;if(this.style(&quot;stroke-linejoin&quot;).hasValue())d.lineJoin=this.style(&quot;stroke-linejoin&quot;).value;if(this.style(&quot;stroke-miterlimit&quot;).hasValue())d.miterLimit=this.style(&quot;stroke-miterlimit&quot;).value;if(typeof d.font!=&quot;undefined&quot;)d.font=a.Font.CreateFont(this.style(&quot;font-style&quot;).value,this.style(&quot;font-variant&quot;).value,this.style(&quot;font-weight&quot;).value,this.style(&quot;font-size&quot;).hasValue()?this.style(&quot;font-size&quot;).Length.toPixels()+&quot;px&quot;:&quot;&quot;,this.style(&quot;font-family&quot;).value).toString();
this.attribute(&quot;transform&quot;).hasValue()&amp;&amp;(new a.Transform(this.attribute(&quot;transform&quot;).value)).apply(d);this.attribute(&quot;clip-path&quot;).hasValue()&amp;&amp;(b=this.attribute(&quot;clip-path&quot;).Definition.getDefinition(),b!=null&amp;&amp;b.apply(d));if(this.style(&quot;opacity&quot;).hasValue())d.globalAlpha=this.style(&quot;opacity&quot;).numValue()}};a.Element.RenderedElementBase.prototype=new a.Element.ElementBase;a.Element.PathElementBase=function(c){this.base=a.Element.RenderedElementBase;this.base(c);this.path=function(d){d!=null&amp;&amp;d.beginPath();
return new a.BoundingBox};this.renderChildren=function(d){this.path(d);a.Mouse.checkPath(this,d);d.fillStyle!=&quot;&quot;&amp;&amp;d.fill();d.strokeStyle!=&quot;&quot;&amp;&amp;d.stroke();var b=this.getMarkers();if(b!=null){if(this.style(&quot;marker-start&quot;).Definition.isUrl()){var c=this.style(&quot;marker-start&quot;).Definition.getDefinition();c.render(d,b[0][0],b[0][1])}if(this.style(&quot;marker-mid&quot;).Definition.isUrl())for(var c=this.style(&quot;marker-mid&quot;).Definition.getDefinition(),e=1;e&lt;b.length-1;e++)c.render(d,b[e][0],b[e][1]);this.style(&quot;marker-end&quot;).Definition.isUrl()&amp;&amp;
(c=this.style(&quot;marker-end&quot;).Definition.getDefinition(),c.render(d,b[b.length-1][0],b[b.length-1][1]))}};this.getBoundingBox=function(){return this.path()};this.getMarkers=function(){return null}};a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase;a.Element.svg=function(c){this.base=a.Element.RenderedElementBase;this.base(c);this.baseClearContext=this.clearContext;this.clearContext=function(d){this.baseClearContext(d);a.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;
this.setContext=function(d){d.strokeStyle=&quot;rgba(0,0,0,0)&quot;;d.lineCap=&quot;butt&quot;;d.lineJoin=&quot;miter&quot;;d.miterLimit=4;this.baseSetContext(d);this.attribute(&quot;x&quot;).hasValue()&amp;&amp;this.attribute(&quot;y&quot;).hasValue()&amp;&amp;d.translate(this.attribute(&quot;x&quot;).Length.toPixels(&quot;x&quot;),this.attribute(&quot;y&quot;).Length.toPixels(&quot;y&quot;));var b=a.ViewPort.width(),c=a.ViewPort.height();if(typeof this.root==&quot;undefined&quot;&amp;&amp;this.attribute(&quot;width&quot;).hasValue()&amp;&amp;this.attribute(&quot;height&quot;).hasValue()){var b=this.attribute(&quot;width&quot;).Length.toPixels(&quot;x&quot;),c=this.attribute(&quot;height&quot;).Length.toPixels(&quot;y&quot;),
e=0,f=0;this.attribute(&quot;refX&quot;).hasValue()&amp;&amp;this.attribute(&quot;refY&quot;).hasValue()&amp;&amp;(e=-this.attribute(&quot;refX&quot;).Length.toPixels(&quot;x&quot;),f=-this.attribute(&quot;refY&quot;).Length.toPixels(&quot;y&quot;));d.beginPath();d.moveTo(e,f);d.lineTo(b,f);d.lineTo(b,c);d.lineTo(e,c);d.closePath();d.clip()}a.ViewPort.SetCurrent(b,c);if(this.attribute(&quot;viewBox&quot;).hasValue()){var e=a.ToNumberArray(this.attribute(&quot;viewBox&quot;).value),f=e[0],g=e[1],b=e[2],c=e[3];a.AspectRatio(d,this.attribute(&quot;preserveAspectRatio&quot;).value,a.ViewPort.width(),b,a.ViewPort.height(),
c,f,g,this.attribute(&quot;refX&quot;).value,this.attribute(&quot;refY&quot;).value);a.ViewPort.RemoveCurrent();a.ViewPort.SetCurrent(e[2],e[3])}}};a.Element.svg.prototype=new a.Element.RenderedElementBase;a.Element.rect=function(c){this.base=a.Element.PathElementBase;this.base(c);this.path=function(d){var b=this.attribute(&quot;x&quot;).Length.toPixels(&quot;x&quot;),c=this.attribute(&quot;y&quot;).Length.toPixels(&quot;y&quot;),e=this.attribute(&quot;width&quot;).Length.toPixels(&quot;x&quot;),f=this.attribute(&quot;height&quot;).Length.toPixels(&quot;y&quot;),g=this.attribute(&quot;rx&quot;).Length.toPixels(&quot;x&quot;),
j=this.attribute(&quot;ry&quot;).Length.toPixels(&quot;y&quot;);this.attribute(&quot;rx&quot;).hasValue()&amp;&amp;!this.attribute(&quot;ry&quot;).hasValue()&amp;&amp;(j=g);this.attribute(&quot;ry&quot;).hasValue()&amp;&amp;!this.attribute(&quot;rx&quot;).hasValue()&amp;&amp;(g=j);d!=null&amp;&amp;(d.beginPath(),d.moveTo(b+g,c),d.lineTo(b+e-g,c),d.quadraticCurveTo(b+e,c,b+e,c+j),d.lineTo(b+e,c+f-j),d.quadraticCurveTo(b+e,c+f,b+e-g,c+f),d.lineTo(b+g,c+f),d.quadraticCurveTo(b,c+f,b,c+f-j),d.lineTo(b,c+j),d.quadraticCurveTo(b,c,b+g,c),d.closePath());return new a.BoundingBox(b,c,b+e,c+f)}};a.Element.rect.prototype=
new a.Element.PathElementBase;a.Element.circle=function(c){this.base=a.Element.PathElementBase;this.base(c);this.path=function(d){var b=this.attribute(&quot;cx&quot;).Length.toPixels(&quot;x&quot;),c=this.attribute(&quot;cy&quot;).Length.toPixels(&quot;y&quot;),e=this.attribute(&quot;r&quot;).Length.toPixels();d!=null&amp;&amp;(d.beginPath(),d.arc(b,c,e,0,Math.PI*2,!0),d.closePath());return new a.BoundingBox(b-e,c-e,b+e,c+e)}};a.Element.circle.prototype=new a.Element.PathElementBase;a.Element.ellipse=function(c){this.base=a.Element.PathElementBase;this.base(c);
this.path=function(d){var b=4*((Math.sqrt(2)-1)/3),c=this.attribute(&quot;rx&quot;).Length.toPixels(&quot;x&quot;),e=this.attribute(&quot;ry&quot;).Length.toPixels(&quot;y&quot;),f=this.attribute(&quot;cx&quot;).Length.toPixels(&quot;x&quot;),g=this.attribute(&quot;cy&quot;).Length.toPixels(&quot;y&quot;);d!=null&amp;&amp;(d.beginPath(),d.moveTo(f,g-e),d.bezierCurveTo(f+b*c,g-e,f+c,g-b*e,f+c,g),d.bezierCurveTo(f+c,g+b*e,f+b*c,g+e,f,g+e),d.bezierCurveTo(f-b*c,g+e,f-c,g+b*e,f-c,g),d.bezierCurveTo(f-c,g-b*e,f-b*c,g-e,f,g-e),d.closePath());return new a.BoundingBox(f-c,g-e,f+c,g+e)}};a.Element.ellipse.prototype=
new a.Element.PathElementBase;a.Element.line=function(c){this.base=a.Element.PathElementBase;this.base(c);this.getPoints=function(){return[new a.Point(this.attribute(&quot;x1&quot;).Length.toPixels(&quot;x&quot;),this.attribute(&quot;y1&quot;).Length.toPixels(&quot;y&quot;)),new a.Point(this.attribute(&quot;x2&quot;).Length.toPixels(&quot;x&quot;),this.attribute(&quot;y2&quot;).Length.toPixels(&quot;y&quot;))]};this.path=function(d){var b=this.getPoints();d!=null&amp;&amp;(d.beginPath(),d.moveTo(b[0].x,b[0].y),d.lineTo(b[1].x,b[1].y));return new a.BoundingBox(b[0].x,b[0].y,b[1].x,b[1].y)};
this.getMarkers=function(){var a=this.getPoints(),b=a[0].angleTo(a[1]);return[[a[0],b],[a[1],b]]}};a.Element.line.prototype=new a.Element.PathElementBase;a.Element.polyline=function(c){this.base=a.Element.PathElementBase;this.base(c);this.points=a.CreatePath(this.attribute(&quot;points&quot;).value);this.path=function(d){var b=new a.BoundingBox(this.points[0].x,this.points[0].y);d!=null&amp;&amp;(d.beginPath(),d.moveTo(this.points[0].x,this.points[0].y));for(var c=1;c&lt;this.points.length;c++)b.addPoint(this.points[c].x,
this.points[c].y),d!=null&amp;&amp;d.lineTo(this.points[c].x,this.points[c].y);return b};this.getMarkers=function(){for(var a=[],b=0;b&lt;this.points.length-1;b++)a.push([this.points[b],this.points[b].angleTo(this.points[b+1])]);a.push([this.points[this.points.length-1],a[a.length-1][1]]);return a}};a.Element.polyline.prototype=new a.Element.PathElementBase;a.Element.polygon=function(c){this.base=a.Element.polyline;this.base(c);this.basePath=this.path;this.path=function(a){var b=this.basePath(a);a!=null&amp;&amp;(a.lineTo(this.points[0].x,
this.points[0].y),a.closePath());return b}};a.Element.polygon.prototype=new a.Element.polyline;a.Element.path=function(c){this.base=a.Element.PathElementBase;this.base(c);c=this.attribute(&quot;d&quot;).value;c=c.replace(/,/gm,&quot; &quot;);c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,&quot;$1 $2&quot;);c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,&quot;$1 $2&quot;);c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,&quot;$1 $2&quot;);c=c.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,&quot;$1 $2&quot;);c=c.replace(/([0-9])([+\-])/gm,
&quot;$1 $2&quot;);c=c.replace(/(\.[0-9]*)(\.)/gm,&quot;$1 $2&quot;);c=c.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,&quot;$1 $3 $4 &quot;);c=a.compressSpaces(c);c=a.trim(c);this.PathParser=new function(d){this.tokens=d.split(&quot; &quot;);this.reset=function(){this.i=-1;this.previousCommand=this.command=&quot;&quot;;this.start=new a.Point(0,0);this.control=new a.Point(0,0);this.current=new a.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i&gt;=this.tokens.length-1};this.isCommandOrEnd=function(){return this.isEnd()?
!0:this.tokens[this.i+1].match(/^[A-Za-z]$/)!=null};this.isRelativeCommand=function(){return this.command==this.command.toLowerCase()};this.getToken=function(){this.i+=1;return this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};this.getPoint=function(){return this.makeAbsolute(new a.Point(this.getScalar(),this.getScalar()))};this.getAsControlPoint=function(){var b=this.getPoint();
return this.control=b};this.getAsCurrentPoint=function(){var b=this.getPoint();return this.current=b};this.getReflectedControlPoint=function(){return this.previousCommand.toLowerCase()!=&quot;c&quot;&amp;&amp;this.previousCommand.toLowerCase()!=&quot;s&quot;?this.current:new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)};this.makeAbsolute=function(b){if(this.isRelativeCommand())b.x=this.current.x+b.x,b.y=this.current.y+b.y;return b};this.addMarker=function(b,a,d){d!=null&amp;&amp;this.angles.length&gt;0&amp;&amp;this.angles[this.angles.length-
1]==null&amp;&amp;(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(d));this.addMarkerAngle(b,a==null?null:a.angleTo(b))};this.addMarkerAngle=function(b,a){this.points.push(b);this.angles.push(a)};this.getMarkerPoints=function(){return this.points};this.getMarkerAngles=function(){for(var b=0;b&lt;this.angles.length;b++)if(this.angles[b]==null)for(var a=b+1;a&lt;this.angles.length;a++)if(this.angles[a]!=null){this.angles[b]=this.angles[a];break}return this.angles}}(c);this.path=function(d){var b=
this.PathParser;b.reset();var c=new a.BoundingBox;for(d!=null&amp;&amp;d.beginPath();!b.isEnd();)switch(b.nextCommand(),b.command.toUpperCase()){case &quot;M&quot;:var e=b.getAsCurrentPoint();b.addMarker(e);c.addPoint(e.x,e.y);d!=null&amp;&amp;d.moveTo(e.x,e.y);for(b.start=b.current;!b.isCommandOrEnd();)e=b.getAsCurrentPoint(),b.addMarker(e,b.start),c.addPoint(e.x,e.y),d!=null&amp;&amp;d.lineTo(e.x,e.y);break;case &quot;L&quot;:for(;!b.isCommandOrEnd();){var f=b.current,e=b.getAsCurrentPoint();b.addMarker(e,f);c.addPoint(e.x,e.y);d!=null&amp;&amp;
d.lineTo(e.x,e.y)}break;case &quot;H&quot;:for(;!b.isCommandOrEnd();)e=new a.Point((b.isRelativeCommand()?b.current.x:0)+b.getScalar(),b.current.y),b.addMarker(e,b.current),b.current=e,c.addPoint(b.current.x,b.current.y),d!=null&amp;&amp;d.lineTo(b.current.x,b.current.y);break;case &quot;V&quot;:for(;!b.isCommandOrEnd();)e=new a.Point(b.current.x,(b.isRelativeCommand()?b.current.y:0)+b.getScalar()),b.addMarker(e,b.current),b.current=e,c.addPoint(b.current.x,b.current.y),d!=null&amp;&amp;d.lineTo(b.current.x,b.current.y);break;case &quot;C&quot;:for(;!b.isCommandOrEnd();){var g=
b.current,f=b.getPoint(),j=b.getAsControlPoint(),e=b.getAsCurrentPoint();b.addMarker(e,j,f);c.addBezierCurve(g.x,g.y,f.x,f.y,j.x,j.y,e.x,e.y);d!=null&amp;&amp;d.bezierCurveTo(f.x,f.y,j.x,j.y,e.x,e.y)}break;case &quot;S&quot;:for(;!b.isCommandOrEnd();)g=b.current,f=b.getReflectedControlPoint(),j=b.getAsControlPoint(),e=b.getAsCurrentPoint(),b.addMarker(e,j,f),c.addBezierCurve(g.x,g.y,f.x,f.y,j.x,j.y,e.x,e.y),d!=null&amp;&amp;d.bezierCurveTo(f.x,f.y,j.x,j.y,e.x,e.y);break;case &quot;Q&quot;:for(;!b.isCommandOrEnd();)g=b.current,j=b.getAsControlPoint(),
e=b.getAsCurrentPoint(),b.addMarker(e,j,j),c.addQuadraticCurve(g.x,g.y,j.x,j.y,e.x,e.y),d!=null&amp;&amp;d.quadraticCurveTo(j.x,j.y,e.x,e.y);break;case &quot;T&quot;:for(;!b.isCommandOrEnd();)g=b.current,j=b.getReflectedControlPoint(),b.control=j,e=b.getAsCurrentPoint(),b.addMarker(e,j,j),c.addQuadraticCurve(g.x,g.y,j.x,j.y,e.x,e.y),d!=null&amp;&amp;d.quadraticCurveTo(j.x,j.y,e.x,e.y);break;case &quot;A&quot;:for(;!b.isCommandOrEnd();){var g=b.current,h=b.getScalar(),l=b.getScalar(),f=b.getScalar()*(Math.PI/180),o=b.getScalar(),j=b.getScalar(),
e=b.getAsCurrentPoint(),n=new a.Point(Math.cos(f)*(g.x-e.x)/2+Math.sin(f)*(g.y-e.y)/2,-Math.sin(f)*(g.x-e.x)/2+Math.cos(f)*(g.y-e.y)/2),q=Math.pow(n.x,2)/Math.pow(h,2)+Math.pow(n.y,2)/Math.pow(l,2);q&gt;1&amp;&amp;(h*=Math.sqrt(q),l*=Math.sqrt(q));o=(o==j?-1:1)*Math.sqrt((Math.pow(h,2)*Math.pow(l,2)-Math.pow(h,2)*Math.pow(n.y,2)-Math.pow(l,2)*Math.pow(n.x,2))/(Math.pow(h,2)*Math.pow(n.y,2)+Math.pow(l,2)*Math.pow(n.x,2)));isNaN(o)&amp;&amp;(o=0);var p=new a.Point(o*h*n.y/l,o*-l*n.x/h),g=new a.Point((g.x+e.x)/2+Math.cos(f)*
p.x-Math.sin(f)*p.y,(g.y+e.y)/2+Math.sin(f)*p.x+Math.cos(f)*p.y),m=function(b,a){return(b[0]*a[0]+b[1]*a[1])/(Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2))*Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)))},s=function(b,a){return(b[0]*a[1]&lt;b[1]*a[0]?-1:1)*Math.acos(m(b,a))},o=s([1,0],[(n.x-p.x)/h,(n.y-p.y)/l]),q=[(n.x-p.x)/h,(n.y-p.y)/l],p=[(-n.x-p.x)/h,(-n.y-p.y)/l],n=s(q,p);if(m(q,p)&lt;=-1)n=Math.PI;m(q,p)&gt;=1&amp;&amp;(n=0);j==0&amp;&amp;n&gt;0&amp;&amp;(n-=2*Math.PI);j==1&amp;&amp;n&lt;0&amp;&amp;(n+=2*Math.PI);q=new a.Point(g.x-h*Math.cos((o+n)/
2),g.y-l*Math.sin((o+n)/2));b.addMarkerAngle(q,(o+n)/2+(j==0?1:-1)*Math.PI/2);b.addMarkerAngle(e,n+(j==0?1:-1)*Math.PI/2);c.addPoint(e.x,e.y);d!=null&amp;&amp;(m=h&gt;l?h:l,e=h&gt;l?1:h/l,h=h&gt;l?l/h:1,d.translate(g.x,g.y),d.rotate(f),d.scale(e,h),d.arc(0,0,m,o,o+n,1-j),d.scale(1/e,1/h),d.rotate(-f),d.translate(-g.x,-g.y))}break;case &quot;Z&quot;:d!=null&amp;&amp;d.closePath(),b.current=b.start}return c};this.getMarkers=function(){for(var a=this.PathParser.getMarkerPoints(),b=this.PathParser.getMarkerAngles(),c=[],e=0;e&lt;a.length;e++)c.push([a[e],
b[e]]);return c}};a.Element.path.prototype=new a.Element.PathElementBase;a.Element.pattern=function(c){this.base=a.Element.ElementBase;this.base(c);this.createPattern=function(d){var b=new a.Element.svg;b.attributes.viewBox=new a.Property(&quot;viewBox&quot;,this.attribute(&quot;viewBox&quot;).value);b.attributes.x=new a.Property(&quot;x&quot;,this.attribute(&quot;x&quot;).value);b.attributes.y=new a.Property(&quot;y&quot;,this.attribute(&quot;y&quot;).value);b.attributes.width=new a.Property(&quot;width&quot;,this.attribute(&quot;width&quot;).value);b.attributes.height=new a.Property(&quot;height&quot;,
this.attribute(&quot;height&quot;).value);b.children=this.children;var c=document.createElement(&quot;canvas&quot;);c.width=this.attribute(&quot;width&quot;).Length.toPixels(&quot;x&quot;);c.height=this.attribute(&quot;height&quot;).Length.toPixels(&quot;y&quot;);b.render(c.getContext(&quot;2d&quot;));return d.createPattern(c,&quot;repeat&quot;)}};a.Element.pattern.prototype=new a.Element.ElementBase;a.Element.marker=function(c){this.base=a.Element.ElementBase;this.base(c);this.baseRender=this.render;this.render=function(d,b,c){d.translate(b.x,b.y);this.attribute(&quot;orient&quot;).valueOrDefault(&quot;auto&quot;)==
&quot;auto&quot;&amp;&amp;d.rotate(c);this.attribute(&quot;markerUnits&quot;).valueOrDefault(&quot;strokeWidth&quot;)==&quot;strokeWidth&quot;&amp;&amp;d.scale(d.lineWidth,d.lineWidth);d.save();var e=new a.Element.svg;e.attributes.viewBox=new a.Property(&quot;viewBox&quot;,this.attribute(&quot;viewBox&quot;).value);e.attributes.refX=new a.Property(&quot;refX&quot;,this.attribute(&quot;refX&quot;).value);e.attributes.refY=new a.Property(&quot;refY&quot;,this.attribute(&quot;refY&quot;).value);e.attributes.width=new a.Property(&quot;width&quot;,this.attribute(&quot;markerWidth&quot;).value);e.attributes.height=new a.Property(&quot;height&quot;,
this.attribute(&quot;markerHeight&quot;).value);e.attributes.fill=new a.Property(&quot;fill&quot;,this.attribute(&quot;fill&quot;).valueOrDefault(&quot;black&quot;));e.attributes.stroke=new a.Property(&quot;stroke&quot;,this.attribute(&quot;stroke&quot;).valueOrDefault(&quot;none&quot;));e.children=this.children;e.render(d);d.restore();this.attribute(&quot;markerUnits&quot;).valueOrDefault(&quot;strokeWidth&quot;)==&quot;strokeWidth&quot;&amp;&amp;d.scale(1/d.lineWidth,1/d.lineWidth);this.attribute(&quot;orient&quot;).valueOrDefault(&quot;auto&quot;)==&quot;auto&quot;&amp;&amp;d.rotate(-c);d.translate(-b.x,-b.y)}};a.Element.marker.prototype=
new a.Element.ElementBase;a.Element.defs=function(c){this.base=a.Element.ElementBase;this.base(c);this.render=function(){}};a.Element.defs.prototype=new a.Element.ElementBase;a.Element.GradientBase=function(c){this.base=a.Element.ElementBase;this.base(c);this.gradientUnits=this.attribute(&quot;gradientUnits&quot;).valueOrDefault(&quot;objectBoundingBox&quot;);this.stops=[];for(c=0;c&lt;this.children.length;c++)this.stops.push(this.children[c]);this.getGradient=function(){};this.createGradient=function(d,b){var c=this;this.attribute(&quot;xlink:href&quot;).hasValue()&amp;&amp;
(c=this.attribute(&quot;xlink:href&quot;).Definition.getDefinition());for(var e=this.getGradient(d,b),f=0;f&lt;c.stops.length;f++)e.addColorStop(c.stops[f].offset,c.stops[f].color);if(this.attribute(&quot;gradientTransform&quot;).hasValue()){c=a.ViewPort.viewPorts[0];f=new a.Element.rect;f.attributes.x=new a.Property(&quot;x&quot;,-a.MAX_VIRTUAL_PIXELS/3);f.attributes.y=new a.Property(&quot;y&quot;,-a.MAX_VIRTUAL_PIXELS/3);f.attributes.width=new a.Property(&quot;width&quot;,a.MAX_VIRTUAL_PIXELS);f.attributes.height=new a.Property(&quot;height&quot;,a.MAX_VIRTUAL_PIXELS);
var g=new a.Element.g;g.attributes.transform=new a.Property(&quot;transform&quot;,this.attribute(&quot;gradientTransform&quot;).value);g.children=[f];f=new a.Element.svg;f.attributes.x=new a.Property(&quot;x&quot;,0);f.attributes.y=new a.Property(&quot;y&quot;,0);f.attributes.width=new a.Property(&quot;width&quot;,c.width);f.attributes.height=new a.Property(&quot;height&quot;,c.height);f.children=[g];g=document.createElement(&quot;canvas&quot;);g.width=c.width;g.height=c.height;c=g.getContext(&quot;2d&quot;);c.fillStyle=e;f.render(c);return c.createPattern(g,&quot;no-repeat&quot;)}return e}};
a.Element.GradientBase.prototype=new a.Element.ElementBase;a.Element.linearGradient=function(c){this.base=a.Element.GradientBase;this.base(c);this.getGradient=function(a,b){var c=b.getBoundingBox(),e=this.gradientUnits==&quot;objectBoundingBox&quot;?c.x()+c.width()*this.attribute(&quot;x1&quot;).numValue():this.attribute(&quot;x1&quot;).Length.toPixels(&quot;x&quot;),f=this.gradientUnits==&quot;objectBoundingBox&quot;?c.y()+c.height()*this.attribute(&quot;y1&quot;).numValue():this.attribute(&quot;y1&quot;).Length.toPixels(&quot;y&quot;),g=this.gradientUnits==&quot;objectBoundingBox&quot;?
c.x()+c.width()*this.attribute(&quot;x2&quot;).numValue():this.attribute(&quot;x2&quot;).Length.toPixels(&quot;x&quot;),c=this.gradientUnits==&quot;objectBoundingBox&quot;?c.y()+c.height()*this.attribute(&quot;y2&quot;).numValue():this.attribute(&quot;y2&quot;).Length.toPixels(&quot;y&quot;);return a.createLinearGradient(e,f,g,c)}};a.Element.linearGradient.prototype=new a.Element.GradientBase;a.Element.radialGradient=function(c){this.base=a.Element.GradientBase;this.base(c);this.getGradient=function(a,b){var c=b.getBoundingBox(),e=this.gradientUnits==&quot;objectBoundingBox&quot;?
c.x()+c.width()*this.attribute(&quot;cx&quot;).numValue():this.attribute(&quot;cx&quot;).Length.toPixels(&quot;x&quot;),f=this.gradientUnits==&quot;objectBoundingBox&quot;?c.y()+c.height()*this.attribute(&quot;cy&quot;).numValue():this.attribute(&quot;cy&quot;).Length.toPixels(&quot;y&quot;),g=e,j=f;this.attribute(&quot;fx&quot;).hasValue()&amp;&amp;(g=this.gradientUnits==&quot;objectBoundingBox&quot;?c.x()+c.width()*this.attribute(&quot;fx&quot;).numValue():this.attribute(&quot;fx&quot;).Length.toPixels(&quot;x&quot;));this.attribute(&quot;fy&quot;).hasValue()&amp;&amp;(j=this.gradientUnits==&quot;objectBoundingBox&quot;?c.y()+c.height()*this.attribute(&quot;fy&quot;).numValue():
this.attribute(&quot;fy&quot;).Length.toPixels(&quot;y&quot;));c=this.gradientUnits==&quot;objectBoundingBox&quot;?(c.width()+c.height())/2*this.attribute(&quot;r&quot;).numValue():this.attribute(&quot;r&quot;).Length.toPixels();return a.createRadialGradient(g,j,0,e,f,c)}};a.Element.radialGradient.prototype=new a.Element.GradientBase;a.Element.stop=function(c){this.base=a.Element.ElementBase;this.base(c);this.offset=this.attribute(&quot;offset&quot;).numValue();c=this.style(&quot;stop-color&quot;);this.style(&quot;stop-opacity&quot;).hasValue()&amp;&amp;(c=c.Color.addOpacity(this.style(&quot;stop-opacity&quot;).value));
this.color=c.value};a.Element.stop.prototype=new a.Element.ElementBase;a.Element.AnimateBase=function(c){this.base=a.Element.ElementBase;this.base(c);a.Animations.push(this);this.duration=0;this.begin=this.attribute(&quot;begin&quot;).Time.toMilliseconds();this.maxDuration=this.begin+this.attribute(&quot;dur&quot;).Time.toMilliseconds();this.getProperty=function(){var a=this.attribute(&quot;attributeType&quot;).value,b=this.attribute(&quot;attributeName&quot;).value;return a==&quot;CSS&quot;?this.parent.style(b,!0):this.parent.attribute(b,!0)};this.initialValue=
null;this.removed=!1;this.calcValue=function(){return&quot;&quot;};this.update=function(a){if(this.initialValue==null)this.initialValue=this.getProperty().value;if(this.duration&gt;this.maxDuration)if(this.attribute(&quot;repeatCount&quot;).value==&quot;indefinite&quot;)this.duration=0;else return this.attribute(&quot;fill&quot;).valueOrDefault(&quot;remove&quot;)==&quot;remove&quot;&amp;&amp;!this.removed?(this.removed=!0,this.getProperty().value=this.initialValue,!0):!1;this.duration+=a;a=!1;if(this.begin&lt;this.duration)a=this.calcValue(),this.attribute(&quot;type&quot;).hasValue()&amp;&amp;
(a=this.attribute(&quot;type&quot;).value+&quot;(&quot;+a+&quot;)&quot;),this.getProperty().value=a,a=!0;return a};this.progress=function(){return(this.duration-this.begin)/(this.maxDuration-this.begin)}};a.Element.AnimateBase.prototype=new a.Element.ElementBase;a.Element.animate=function(c){this.base=a.Element.AnimateBase;this.base(c);this.calcValue=function(){var a=this.attribute(&quot;from&quot;).numValue(),b=this.attribute(&quot;to&quot;).numValue();return a+(b-a)*this.progress()}};a.Element.animate.prototype=new a.Element.AnimateBase;a.Element.animateColor=
function(c){this.base=a.Element.AnimateBase;this.base(c);this.calcValue=function(){var a=new RGBColor(this.attribute(&quot;from&quot;).value),b=new RGBColor(this.attribute(&quot;to&quot;).value);if(a.ok&amp;&amp;b.ok){var c=a.r+(b.r-a.r)*this.progress(),e=a.g+(b.g-a.g)*this.progress(),a=a.b+(b.b-a.b)*this.progress();return&quot;rgb(&quot;+parseInt(c,10)+&quot;,&quot;+parseInt(e,10)+&quot;,&quot;+parseInt(a,10)+&quot;)&quot;}return this.attribute(&quot;from&quot;).value}};a.Element.animateColor.prototype=new a.Element.AnimateBase;a.Element.animateTransform=function(c){this.base=
a.Element.animate;this.base(c)};a.Element.animateTransform.prototype=new a.Element.animate;a.Element.font=function(c){this.base=a.Element.ElementBase;this.base(c);this.horizAdvX=this.attribute(&quot;horiz-adv-x&quot;).numValue();this.isArabic=this.isRTL=!1;this.missingGlyph=this.fontFace=null;this.glyphs=[];for(c=0;c&lt;this.children.length;c++){var d=this.children[c];if(d.type==&quot;font-face&quot;)this.fontFace=d,d.style(&quot;font-family&quot;).hasValue()&amp;&amp;(a.Definitions[d.style(&quot;font-family&quot;).value]=this);else if(d.type==&quot;missing-glyph&quot;)this.missingGlyph=
d;else if(d.type==&quot;glyph&quot;)d.arabicForm!=&quot;&quot;?(this.isArabic=this.isRTL=!0,typeof this.glyphs[d.unicode]==&quot;undefined&quot;&amp;&amp;(this.glyphs[d.unicode]=[]),this.glyphs[d.unicode][d.arabicForm]=d):this.glyphs[d.unicode]=d}};a.Element.font.prototype=new a.Element.ElementBase;a.Element.fontface=function(c){this.base=a.Element.ElementBase;this.base(c);this.ascent=this.attribute(&quot;ascent&quot;).value;this.descent=this.attribute(&quot;descent&quot;).value;this.unitsPerEm=this.attribute(&quot;units-per-em&quot;).numValue()};a.Element.fontface.prototype=
new a.Element.ElementBase;a.Element.missingglyph=function(c){this.base=a.Element.path;this.base(c);this.horizAdvX=0};a.Element.missingglyph.prototype=new a.Element.path;a.Element.glyph=function(c){this.base=a.Element.path;this.base(c);this.horizAdvX=this.attribute(&quot;horiz-adv-x&quot;).numValue();this.unicode=this.attribute(&quot;unicode&quot;).value;this.arabicForm=this.attribute(&quot;arabic-form&quot;).value};a.Element.glyph.prototype=new a.Element.path;a.Element.text=function(c){this.base=a.Element.RenderedElementBase;
this.base(c);if(c!=null){this.children=[];for(var d=0;d&lt;c.childNodes.length;d++){var b=c.childNodes[d];b.nodeType==1?this.addChild(b,!0):b.nodeType==3&amp;&amp;this.addChild(new a.Element.tspan(b),!1)}}this.baseSetContext=this.setContext;this.setContext=function(b){this.baseSetContext(b);if(this.style(&quot;dominant-baseline&quot;).hasValue())b.textBaseline=this.style(&quot;dominant-baseline&quot;).value;if(this.style(&quot;alignment-baseline&quot;).hasValue())b.textBaseline=this.style(&quot;alignment-baseline&quot;).value};this.renderChildren=
function(b){for(var a=this.style(&quot;text-anchor&quot;).valueOrDefault(&quot;start&quot;),c=this.attribute(&quot;x&quot;).Length.toPixels(&quot;x&quot;),d=this.attribute(&quot;y&quot;).Length.toPixels(&quot;y&quot;),j=0;j&lt;this.children.length;j++){var h=this.children[j];h.attribute(&quot;x&quot;).hasValue()?h.x=h.attribute(&quot;x&quot;).Length.toPixels(&quot;x&quot;):(h.attribute(&quot;dx&quot;).hasValue()&amp;&amp;(c+=h.attribute(&quot;dx&quot;).Length.toPixels(&quot;x&quot;)),h.x=c);c=h.measureText(b);if(a!=&quot;start&quot;&amp;&amp;(j==0||h.attribute(&quot;x&quot;).hasValue())){for(var l=c,o=j+1;o&lt;this.children.length;o++){var n=this.children[o];
if(n.attribute(&quot;x&quot;).hasValue())break;l+=n.measureText(b)}h.x-=a==&quot;end&quot;?l:l/2}c=h.x+c;h.attribute(&quot;y&quot;).hasValue()?h.y=h.attribute(&quot;y&quot;).Length.toPixels(&quot;y&quot;):(h.attribute(&quot;dy&quot;).hasValue()&amp;&amp;(d+=h.attribute(&quot;dy&quot;).Length.toPixels(&quot;y&quot;)),h.y=d);d=h.y;h.render(b)}}};a.Element.text.prototype=new a.Element.RenderedElementBase;a.Element.TextElementBase=function(c){this.base=a.Element.RenderedElementBase;this.base(c);this.getGlyph=function(a,b,c){var e=b[c],f=null;if(a.isArabic){var g=&quot;isolated&quot;;if((c==0||b[c-
1]==&quot; &quot;)&amp;&amp;c&lt;b.length-2&amp;&amp;b[c+1]!=&quot; &quot;)g=&quot;terminal&quot;;c&gt;0&amp;&amp;b[c-1]!=&quot; &quot;&amp;&amp;c&lt;b.length-2&amp;&amp;b[c+1]!=&quot; &quot;&amp;&amp;(g=&quot;medial&quot;);if(c&gt;0&amp;&amp;b[c-1]!=&quot; &quot;&amp;&amp;(c==b.length-1||b[c+1]==&quot; &quot;))g=&quot;initial&quot;;typeof a.glyphs[e]!=&quot;undefined&quot;&amp;&amp;(f=a.glyphs[e][g],f==null&amp;&amp;a.glyphs[e].type==&quot;glyph&quot;&amp;&amp;(f=a.glyphs[e]))}else f=a.glyphs[e];if(f==null)f=a.missingGlyph;return f};this.renderChildren=function(c){var b=this.parent.style(&quot;font-family&quot;).Definition.getDefinition();if(b!=null){var k=this.parent.style(&quot;font-size&quot;).numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),
e=this.parent.style(&quot;font-style&quot;).valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),f=this.getText();b.isRTL&amp;&amp;(f=f.split(&quot;&quot;).reverse().join(&quot;&quot;));for(var g=a.ToNumberArray(this.parent.attribute(&quot;dx&quot;).value),j=0;j&lt;f.length;j++){var h=this.getGlyph(b,f,j),l=k/b.fontFace.unitsPerEm;c.translate(this.x,this.y);c.scale(l,-l);var o=c.lineWidth;c.lineWidth=c.lineWidth*b.fontFace.unitsPerEm/k;e==&quot;italic&quot;&amp;&amp;c.transform(1,0,0.4,1,0,0);h.render(c);e==&quot;italic&quot;&amp;&amp;c.transform(1,0,-0.4,1,0,0);c.lineWidth=o;c.scale(1/
l,-1/l);c.translate(-this.x,-this.y);this.x+=k*(h.horizAdvX||b.horizAdvX)/b.fontFace.unitsPerEm;typeof g[j]!=&quot;undefined&quot;&amp;&amp;!isNaN(g[j])&amp;&amp;(this.x+=g[j])}}else c.strokeStyle!=&quot;&quot;&amp;&amp;c.strokeText(a.compressSpaces(this.getText()),this.x,this.y),c.fillStyle!=&quot;&quot;&amp;&amp;c.fillText(a.compressSpaces(this.getText()),this.x,this.y)};this.getText=function(){};this.measureText=function(c){var b=this.parent.style(&quot;font-family&quot;).Definition.getDefinition();if(b!=null){var c=this.parent.style(&quot;font-size&quot;).numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),
k=0,e=this.getText();b.isRTL&amp;&amp;(e=e.split(&quot;&quot;).reverse().join(&quot;&quot;));for(var f=a.ToNumberArray(this.parent.attribute(&quot;dx&quot;).value),g=0;g&lt;e.length;g++){var j=this.getGlyph(b,e,g);k+=(j.horizAdvX||b.horizAdvX)*c/b.fontFace.unitsPerEm;typeof f[g]!=&quot;undefined&quot;&amp;&amp;!isNaN(f[g])&amp;&amp;(k+=f[g])}return k}b=a.compressSpaces(this.getText());if(!c.measureText)return b.length*10;c.save();this.setContext(c);b=c.measureText(b).width;c.restore();return b}};a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase;
a.Element.tspan=function(c){this.base=a.Element.TextElementBase;this.base(c);this.text=c.nodeType==3?c.nodeValue:c.childNodes.length&gt;0?c.childNodes[0].nodeValue:c.text;this.getText=function(){return this.text}};a.Element.tspan.prototype=new a.Element.TextElementBase;a.Element.tref=function(c){this.base=a.Element.TextElementBase;this.base(c);this.getText=function(){var a=this.attribute(&quot;xlink:href&quot;).Definition.getDefinition();if(a!=null)return a.children[0].getText()}};a.Element.tref.prototype=new a.Element.TextElementBase;
a.Element.a=function(c){this.base=a.Element.TextElementBase;this.base(c);this.hasText=!0;for(var d=0;d&lt;c.childNodes.length;d++)if(c.childNodes[d].nodeType!=3)this.hasText=!1;this.text=this.hasText?c.childNodes[0].nodeValue:&quot;&quot;;this.getText=function(){return this.text};this.baseRenderChildren=this.renderChildren;this.renderChildren=function(b){if(this.hasText){this.baseRenderChildren(b);var c=new a.Property(&quot;fontSize&quot;,a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,
this.y-c.Length.toPixels(&quot;y&quot;),this.x+this.measureText(b),this.y))}else c=new a.Element.g,c.children=this.children,c.parent=this,c.render(b)};this.onclick=function(){window.open(this.attribute(&quot;xlink:href&quot;).value)};this.onmousemove=function(){a.ctx.canvas.style.cursor=&quot;pointer&quot;}};a.Element.a.prototype=new a.Element.TextElementBase;a.Element.image=function(c){this.base=a.Element.RenderedElementBase;this.base(c);a.Images.push(this);this.img=document.createElement(&quot;img&quot;);this.loaded=!1;var d=this;this.img.onload=
function(){d.loaded=!0};this.img.src=this.attribute(&quot;xlink:href&quot;).value;this.renderChildren=function(b){var c=this.attribute(&quot;x&quot;).Length.toPixels(&quot;x&quot;),d=this.attribute(&quot;y&quot;).Length.toPixels(&quot;y&quot;),f=this.attribute(&quot;width&quot;).Length.toPixels(&quot;x&quot;),g=this.attribute(&quot;height&quot;).Length.toPixels(&quot;y&quot;);f==0||g==0||(b.save(),b.translate(c,d),a.AspectRatio(b,this.attribute(&quot;preserveAspectRatio&quot;).value,f,this.img.width,g,this.img.height,0,0),b.drawImage(this.img,0,0),b.restore())}};a.Element.image.prototype=new a.Element.RenderedElementBase;
a.Element.g=function(c){this.base=a.Element.RenderedElementBase;this.base(c);this.getBoundingBox=function(){for(var c=new a.BoundingBox,b=0;b&lt;this.children.length;b++)c.addBoundingBox(this.children[b].getBoundingBox());return c}};a.Element.g.prototype=new a.Element.RenderedElementBase;a.Element.symbol=function(c){this.base=a.Element.RenderedElementBase;this.base(c);this.baseSetContext=this.setContext;this.setContext=function(c){this.baseSetContext(c);if(this.attribute(&quot;viewBox&quot;).hasValue()){var b=
a.ToNumberArray(this.attribute(&quot;viewBox&quot;).value),k=b[0],e=b[1];width=b[2];height=b[3];a.AspectRatio(c,this.attribute(&quot;preserveAspectRatio&quot;).value,this.attribute(&quot;width&quot;).Length.toPixels(&quot;x&quot;),width,this.attribute(&quot;height&quot;).Length.toPixels(&quot;y&quot;),height,k,e);a.ViewPort.SetCurrent(b[2],b[3])}}};a.Element.symbol.prototype=new a.Element.RenderedElementBase;a.Element.style=function(c){this.base=a.Element.ElementBase;this.base(c);for(var c=c.childNodes[0].nodeValue+(c.childNodes.length&gt;1?c.childNodes[1].nodeValue:
&quot;&quot;),c=c.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,&quot;&quot;),c=a.compressSpaces(c),c=c.split(&quot;}&quot;),d=0;d&lt;c.length;d++)if(a.trim(c[d])!=&quot;&quot;)for(var b=c[d].split(&quot;{&quot;),k=b[0].split(&quot;,&quot;),b=b[1].split(&quot;;&quot;),e=0;e&lt;k.length;e++){var f=a.trim(k[e]);if(f!=&quot;&quot;){for(var g={},j=0;j&lt;b.length;j++){var h=b[j].indexOf(&quot;:&quot;),l=b[j].substr(0,h),h=b[j].substr(h+1,b[j].length-h);l!=null&amp;&amp;h!=null&amp;&amp;(g[a.trim(l)]=new a.Property(a.trim(l),a.trim(h)))}a.Styles[f]=g;if(f==&quot;@font-face&quot;){f=g[&quot;font-family&quot;].value.replace(/&quot;/g,
&quot;&quot;);g=g.src.value.split(&quot;,&quot;);for(j=0;j&lt;g.length;j++)if(g[j].indexOf('format(&quot;svg&quot;)')&gt;0){l=g[j].indexOf(&quot;url&quot;);h=g[j].indexOf(&quot;)&quot;,l);l=g[j].substr(l+5,h-l-6);l=a.parseXml(a.ajax(l)).getElementsByTagName(&quot;font&quot;);for(h=0;h&lt;l.length;h++){var o=a.CreateElement(l[h]);a.Definitions[f]=o}}}}}};a.Element.style.prototype=new a.Element.ElementBase;a.Element.use=function(c){this.base=a.Element.RenderedElementBase;this.base(c);this.baseSetContext=this.setContext;this.setContext=function(a){this.baseSetContext(a);
this.attribute(&quot;x&quot;).hasValue()&amp;&amp;a.translate(this.attribute(&quot;x&quot;).Length.toPixels(&quot;x&quot;),0);this.attribute(&quot;y&quot;).hasValue()&amp;&amp;a.translate(0,this.attribute(&quot;y&quot;).Length.toPixels(&quot;y&quot;))};this.getDefinition=function(){var a=this.attribute(&quot;xlink:href&quot;).Definition.getDefinition();if(this.attribute(&quot;width&quot;).hasValue())a.attribute(&quot;width&quot;,!0).value=this.attribute(&quot;width&quot;).value;if(this.attribute(&quot;height&quot;).hasValue())a.attribute(&quot;height&quot;,!0).value=this.attribute(&quot;height&quot;).value;return a};this.path=function(a){var b=
this.getDefinition();b!=null&amp;&amp;b.path(a)};this.renderChildren=function(a){var b=this.getDefinition();b!=null&amp;&amp;b.render(a)}};a.Element.use.prototype=new a.Element.RenderedElementBase;a.Element.mask=function(c){this.base=a.Element.ElementBase;this.base(c);this.apply=function(a,b){var c=this.attribute(&quot;x&quot;).Length.toPixels(&quot;x&quot;),e=this.attribute(&quot;y&quot;).Length.toPixels(&quot;y&quot;),f=this.attribute(&quot;width&quot;).Length.toPixels(&quot;x&quot;),g=this.attribute(&quot;height&quot;).Length.toPixels(&quot;y&quot;),j=b.attribute(&quot;mask&quot;).value;b.attribute(&quot;mask&quot;).value=
&quot;&quot;;var h=document.createElement(&quot;canvas&quot;);h.width=c+f;h.height=e+g;var l=h.getContext(&quot;2d&quot;);this.renderChildren(l);var o=document.createElement(&quot;canvas&quot;);o.width=c+f;o.height=e+g;var n=o.getContext(&quot;2d&quot;);b.render(n);n.globalCompositeOperation=&quot;destination-in&quot;;n.fillStyle=l.createPattern(h,&quot;no-repeat&quot;);n.fillRect(0,0,c+f,e+g);a.fillStyle=n.createPattern(o,&quot;no-repeat&quot;);a.fillRect(0,0,c+f,e+g);b.attribute(&quot;mask&quot;).value=j};this.render=function(){}};a.Element.mask.prototype=new a.Element.ElementBase;a.Element.clipPath=
function(c){this.base=a.Element.ElementBase;this.base(c);this.apply=function(a){for(var b=0;b&lt;this.children.length;b++)this.children[b].path&amp;&amp;(this.children[b].path(a),a.clip())};this.render=function(){}};a.Element.clipPath.prototype=new a.Element.ElementBase;a.Element.filter=function(c){this.base=a.Element.ElementBase;this.base(c);this.apply=function(a,b){var c=b.getBoundingBox(),e=this.attribute(&quot;x&quot;).Length.toPixels(&quot;x&quot;),f=this.attribute(&quot;y&quot;).Length.toPixels(&quot;y&quot;);if(e==0||f==0)e=c.x1,f=c.y1;var g=
this.attribute(&quot;width&quot;).Length.toPixels(&quot;x&quot;),j=this.attribute(&quot;height&quot;).Length.toPixels(&quot;y&quot;);if(g==0||j==0)g=c.width(),j=c.height();c=b.style(&quot;filter&quot;).value;b.style(&quot;filter&quot;).value=&quot;&quot;;var h=0.2*g,l=0.2*j,o=document.createElement(&quot;canvas&quot;);o.width=g+2*h;o.height=j+2*l;var n=o.getContext(&quot;2d&quot;);n.translate(-e+h,-f+l);b.render(n);for(var q=0;q&lt;this.children.length;q++)this.children[q].apply(n,0,0,g+2*h,j+2*l);a.drawImage(o,0,0,g+2*h,j+2*l,e-h,f-l,g+2*h,j+2*l);b.style(&quot;filter&quot;,!0).value=c};this.render=
function(){}};a.Element.filter.prototype=new a.Element.ElementBase;a.Element.feGaussianBlur=function(c){function d(a,c,d,f,g){for(var j=0;j&lt;g;j++)for(var h=0;h&lt;f;h++)for(var l=a[j*f*4+h*4+3]/255,o=0;o&lt;4;o++){for(var n=d[0]*(l==0?255:a[j*f*4+h*4+o])*(l==0||o==3?1:l),q=1;q&lt;d.length;q++){var p=Math.max(h-q,0),m=a[j*f*4+p*4+3]/255,p=Math.min(h+q,f-1),p=a[j*f*4+p*4+3]/255,s=d[q],r;m==0?r=255:(r=Math.max(h-q,0),r=a[j*f*4+r*4+o]);m=r*(m==0||o==3?1:m);p==0?r=255:(r=Math.min(h+q,f-1),r=a[j*f*4+r*4+o]);n+=
s*(m+r*(p==0||o==3?1:p))}c[h*g*4+j*4+o]=n}}this.base=a.Element.ElementBase;this.base(c);this.apply=function(a,c,e,f,g){var e=this.attribute(&quot;stdDeviation&quot;).numValue(),c=a.getImageData(0,0,f,g),e=Math.max(e,0.01),j=Math.ceil(e*4)+1;mask=[];for(var h=0;h&lt;j;h++)mask[h]=Math.exp(-0.5*(h/e)*(h/e));e=mask;j=0;for(h=1;h&lt;e.length;h++)j+=Math.abs(e[h]);j=2*j+Math.abs(e[0]);for(h=0;h&lt;e.length;h++)e[h]/=j;tmp=[];d(c.data,tmp,e,f,g);d(tmp,c.data,e,g,f);a.clearRect(0,0,f,g);a.putImageData(c,0,0)}};a.Element.filter.prototype=
new a.Element.feGaussianBlur;a.Element.title=function(){};a.Element.title.prototype=new a.Element.ElementBase;a.Element.desc=function(){};a.Element.desc.prototype=new a.Element.ElementBase;a.Element.MISSING=function(a){console.log(&quot;ERROR: Element '&quot;+a.nodeName+&quot;' not yet implemented.&quot;)};a.Element.MISSING.prototype=new a.Element.ElementBase;a.CreateElement=function(c){var d=c.nodeName.replace(/^[^:]+:/,&quot;&quot;),d=d.replace(/\-/g,&quot;&quot;),b=null,b=typeof a.Element[d]!=&quot;undefined&quot;?new a.Element[d](c):new a.Element.MISSING(c);
b.type=c.nodeName;return b};a.load=function(c,d){a.loadXml(c,a.ajax(d))};a.loadXml=function(c,d){a.loadXmlDoc(c,a.parseXml(d))};a.loadXmlDoc=function(c,d){a.init(c);var b=function(a){for(var b=c.canvas;b;)a.x-=b.offsetLeft,a.y-=b.offsetTop,b=b.offsetParent;window.scrollX&amp;&amp;(a.x+=window.scrollX);window.scrollY&amp;&amp;(a.y+=window.scrollY);return a};if(a.opts.ignoreMouse!=!0)c.canvas.onclick=function(c){c=b(new a.Point(c!=null?c.clientX:event.clientX,c!=null?c.clientY:event.clientY));a.Mouse.onclick(c.x,c.y)},
c.canvas.onmousemove=function(c){c=b(new a.Point(c!=null?c.clientX:event.clientX,c!=null?c.clientY:event.clientY));a.Mouse.onmousemove(c.x,c.y)};var k=a.CreateElement(d.documentElement),e=k.root=!0,f=function(){a.ViewPort.Clear();c.canvas.parentNode&amp;&amp;a.ViewPort.SetCurrent(c.canvas.parentNode.clientWidth,c.canvas.parentNode.clientHeight);if(a.opts.ignoreDimensions!=!0){if(k.style(&quot;width&quot;).hasValue())c.canvas.width=k.style(&quot;width&quot;).Length.toPixels(&quot;x&quot;),c.canvas.style.width=c.canvas.width+&quot;px&quot;;if(k.style(&quot;height&quot;).hasValue())c.canvas.height=
k.style(&quot;height&quot;).Length.toPixels(&quot;y&quot;),c.canvas.style.height=c.canvas.height+&quot;px&quot;}var b=c.canvas.clientWidth||c.canvas.width,d=c.canvas.clientHeight||c.canvas.height;a.ViewPort.SetCurrent(b,d);if(a.opts!=null&amp;&amp;a.opts.offsetX!=null)k.attribute(&quot;x&quot;,!0).value=a.opts.offsetX;if(a.opts!=null&amp;&amp;a.opts.offsetY!=null)k.attribute(&quot;y&quot;,!0).value=a.opts.offsetY;if(a.opts!=null&amp;&amp;a.opts.scaleWidth!=null&amp;&amp;a.opts.scaleHeight!=null){var f=1,g=1;k.attribute(&quot;width&quot;).hasValue()&amp;&amp;(f=k.attribute(&quot;width&quot;).Length.toPixels(&quot;x&quot;)/
a.opts.scaleWidth);k.attribute(&quot;height&quot;).hasValue()&amp;&amp;(g=k.attribute(&quot;height&quot;).Length.toPixels(&quot;y&quot;)/a.opts.scaleHeight);k.attribute(&quot;width&quot;,!0).value=a.opts.scaleWidth;k.attribute(&quot;height&quot;,!0).value=a.opts.scaleHeight;k.attribute(&quot;viewBox&quot;,!0).value=&quot;0 0 &quot;+b*f+&quot; &quot;+d*g;k.attribute(&quot;preserveAspectRatio&quot;,!0).value=&quot;none&quot;}a.opts.ignoreClear!=!0&amp;&amp;c.clearRect(0,0,b,d);k.render(c);e&amp;&amp;(e=!1,a.opts!=null&amp;&amp;typeof a.opts.renderCallback==&quot;function&quot;&amp;&amp;a.opts.renderCallback())},g=!0;a.ImagesLoaded()&amp;&amp;(g=!1,f());
a.intervalID=setInterval(function(){var b=!1;g&amp;&amp;a.ImagesLoaded()&amp;&amp;(g=!1,b=!0);a.opts.ignoreMouse!=!0&amp;&amp;(b|=a.Mouse.hasEvents());if(a.opts.ignoreAnimation!=!0)for(var c=0;c&lt;a.Animations.length;c++)b|=a.Animations[c].update(1E3/a.FRAMERATE);a.opts!=null&amp;&amp;typeof a.opts.forceRedraw==&quot;function&quot;&amp;&amp;a.opts.forceRedraw()==!0&amp;&amp;(b=!0);b&amp;&amp;(f(),a.Mouse.runEvents())},1E3/a.FRAMERATE)};a.stop=function(){a.intervalID&amp;&amp;clearInterval(a.intervalID)};a.Mouse=new function(){this.events=[];this.hasEvents=function(){return this.events.length!=
0};this.onclick=function(a,d){this.events.push({type:&quot;onclick&quot;,x:a,y:d,run:function(a){if(a.onclick)a.onclick()}})};this.onmousemove=function(a,d){this.events.push({type:&quot;onmousemove&quot;,x:a,y:d,run:function(a){if(a.onmousemove)a.onmousemove()}})};this.eventElements=[];this.checkPath=function(a,d){for(var b=0;b&lt;this.events.length;b++){var k=this.events[b];d.isPointInPath&amp;&amp;d.isPointInPath(k.x,k.y)&amp;&amp;(this.eventElements[b]=a)}};this.checkBoundingBox=function(a,d){for(var b=0;b&lt;this.events.length;b++){var k=
this.events[b];d.isPointInBox(k.x,k.y)&amp;&amp;(this.eventElements[b]=a)}};this.runEvents=function(){a.ctx.canvas.style.cursor=&quot;&quot;;for(var c=0;c&lt;this.events.length;c++)for(var d=this.events[c],b=this.eventElements[c];b;)d.run(b),b=b.parent;this.events=[];this.eventElements=[]}};return a}this.canvg=function(a,c,d){if(a==null&amp;&amp;c==null&amp;&amp;d==null)for(var c=document.getElementsByTagName(&quot;svg&quot;),b=0;b&lt;c.length;b++){a=c[b];d=document.createElement(&quot;canvas&quot;);d.width=a.clientWidth;d.height=a.clientHeight;a.parentNode.insertBefore(d,
a);a.parentNode.removeChild(a);var k=document.createElement(&quot;div&quot;);k.appendChild(a);canvg(d,k.innerHTML)}else d=d||{},typeof a==&quot;string&quot;&amp;&amp;(a=document.getElementById(a)),a.svg==null?(b=m(),a.svg=b):(b=a.svg,b.stop()),b.opts=d,a=a.getContext(&quot;2d&quot;),typeof c.documentElement!=&quot;undefined&quot;?b.loadXmlDoc(a,c):c.substr(0,1)==&quot;&lt;&quot;?b.loadXml(a,c):b.load(a,c)}})();
if(CanvasRenderingContext2D)CanvasRenderingContext2D.prototype.drawSvg=function(m,a,c,d,b){canvg(this.canvas,m,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:a,offsetY:c,scaleWidth:d,scaleHeight:b})};
(function(m){var a=m.css,c=m.CanVGRenderer,d=m.SVGRenderer,b=m.extend,k=m.merge,e=m.addEvent,f=m.createElement,g=m.discardElement;b(c.prototype,d.prototype);b(c.prototype,{create:function(a,b,c,d){this.setContainer(b,c,d);this.configure(a)},setContainer:function(a,b,c){var d=a.style,e=a.parentNode,g=d.left,d=d.top,k=a.offsetWidth,m=a.offsetHeight,s={visibility:&quot;hidden&quot;,position:&quot;absolute&quot;};this.init.apply(this,[a,b,c]);this.canvas=f(&quot;canvas&quot;,{width:k,height:m},{position:&quot;relative&quot;,left:g,top:d},a);
this.ttLine=f(&quot;div&quot;,null,s,e);this.ttDiv=f(&quot;div&quot;,null,s,e);this.ttTimer=void 0;this.hiddenSvg=a=f(&quot;div&quot;,{width:k,height:m},{visibility:&quot;hidden&quot;,left:g,top:d},e);a.appendChild(this.box)},configure:function(b){var c=this,d=b.options.tooltip,f=d.borderWidth,g=c.ttDiv,m=d.style,p=c.ttLine,t=parseInt(m.padding,10),m=k(m,{padding:t+&quot;px&quot;,&quot;background-color&quot;:d.backgroundColor,&quot;border-style&quot;:&quot;solid&quot;,&quot;border-width&quot;:f+&quot;px&quot;,&quot;border-radius&quot;:d.borderRadius+&quot;px&quot;});d.shadow&amp;&amp;(m=k(m,{&quot;box-shadow&quot;:&quot;1px 1px 3px gray&quot;,
&quot;-webkit-box-shadow&quot;:&quot;1px 1px 3px gray&quot;}));a(g,m);a(p,{&quot;border-left&quot;:&quot;1px solid darkgray&quot;});e(b,&quot;tooltipRefresh&quot;,function(d){var e=b.container,f=e.offsetLeft,e=e.offsetTop,k;g.innerHTML=d.text;k=b.tooltip.getPosition(g.offsetWidth,g.offsetHeight,{plotX:d.x,plotY:d.y});a(g,{visibility:&quot;visible&quot;,left:k.x+&quot;px&quot;,top:k.y+&quot;px&quot;,&quot;border-color&quot;:d.borderColor});a(p,{visibility:&quot;visible&quot;,left:f+d.x+&quot;px&quot;,top:e+b.plotTop+&quot;px&quot;,height:b.plotHeight+&quot;px&quot;});c.ttTimer!==void 0&amp;&amp;clearTimeout(c.ttTimer);c.ttTimer=setTimeout(function(){a(g,
{visibility:&quot;hidden&quot;});a(p,{visibility:&quot;hidden&quot;})},3E3)})},destroy:function(){g(this.canvas);this.ttTimer!==void 0&amp;&amp;clearTimeout(this.ttTimer);g(this.ttLine);g(this.ttDiv);g(this.hiddenSvg);return d.prototype.destroy.apply(this)},color:function(a,b,c){a&amp;&amp;a.linearGradient&amp;&amp;(a=a.stops[a.stops.length-1][1]);return d.prototype.color.call(this,a,b,c)},draw:function(){window.canvg(this.canvas,this.hiddenSvg.innerHTML)}})})(Highcharts);</B></P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2012.igem.org/Team:Amsterdam/maarten/canvas-tools.js">http://2012.igem.org/Team:Amsterdam/maarten/canvas-tools.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Amsterdam/maarten/canvas-tools.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Amsterdam/maarten/canvas-tools.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Amsterdam/maarten/canvas-tools.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Amsterdam/maarten/canvas-tools.js&amp;oldid=14476" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2012.igem.org:Privacy_policy" title="2012.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2012.igem.org:General_disclaimer" title="2012.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>