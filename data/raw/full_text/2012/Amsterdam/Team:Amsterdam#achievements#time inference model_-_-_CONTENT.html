<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Amsterdam_achievements_time_inference_model"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Amsterdam/achievements/time_inference_model">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Amsterdam/achievements/time_inference_model&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Amsterdam/achievements/time_inference_model&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Amsterdam/achievements/time_inference_model&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Amsterdam/achievements/time_inference_model" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Amsterdam/achievements/time inference model</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2012.igem.org</H3><DIV id="main"><DIV id="main-area"><DIV id="sidebar-area"><DIV class="content-block"><DIV id="navmenu"><UL><LI><A href="/Team:Amsterdam">Home</A></LI><LI><A href="#">Team</A></LI><LI><A href="/Team:Amsterdam/team/members">Members</A></LI><LI><A href="/Team:Amsterdam/team/advisors">Advisors</A></LI></UL><LI><A href="/Team:Amsterdam/achievements">Achievements</A></LI><LI><A href="#">Project</A></LI><LI><A href="/Team:Amsterdam/project/molecular_design">Molecular Design</A></LI><LI><A href="/Team:Amsterdam/project/biobricks">BioBricks</A></LI><LI><A href="/Team:Amsterdam/project/features_and_applications">Features and Applications</A></LI><LI><A href="#">Data</A></LI><LI><A href="/Team:Amsterdam/data/experimental">Experimental Results</A></LI><LI><A href="/Team:Amsterdam/data/time_inference_model">Time Inference Model</A></LI><LI><A href="/Team:Amsterdam/data/background_activity">Background activity</A></LI><LI><A href="/Team:Amsterdam/project/diary/">Logbook Designer</A></LI><LI><A href="/Team:Amsterdam/software/logbook_designer/webtool">Webtool</A></LI><LI><A href="/Team:Amsterdam/software/logbook_designer/setup">Setup</A></LI><LI><A href="/Team:Amsterdam/software/logbook_designer/manual">Manual</A></LI><LI><A href="/Team:Amsterdam/software/logbook_designer/future_perspective">Future Perspective</A></LI><LI><A href="#">Human Practices</A></LI><LI><A href="/Team:Amsterdam/practices/overview">Overview</A></LI><LI><A href="/Team:Amsterdam/practices/methods">Methods</A></LI><LI><A href="/Team:Amsterdam/practices/results">Results</A></LI><LI><A href="/Team:Amsterdam/practices/conclusion">Conclusion</A></LI><LI><A href="#">Safety</A></LI><LI><A href="/Team:Amsterdam/safety/questions">Questions</A></LI><LI><A href="#">Extra</A></LI><LI><A href="/Team:Amsterdam/extra/protocols">Protocols</A></LI><LI><A href="/Team:Amsterdam/extra/diary">Lab Diary</A></LI><LI><A href="/Team:Amsterdam/extra/faq">FAQ</A></LI><LI><A href="/Team:Amsterdam/extra/software">Software</A></LI></DIV></DIV></DIV><DIV id="content-area"><DIV id="sub-menu" class="content-block"><H1><SPAN class="mw-headline" id="Inferring_the_time_of_signal_onset">Inferring the time of signal onset</SPAN></H1><TABLE id="toc" class="toc"><TBODY><TR><TD><DIV id="toctitle"><H2>Contents</H2></DIV><UL><LI class="toclevel-1"><A href="#Inferring_the_time_of_signal_onset"><SPAN class="tocnumber">1</SPAN><SPAN class="toctext">Inferring the time of signal onset</SPAN></A></LI><LI class="toclevel-2"><A href="#Methylated_bits_over_time"><SPAN class="tocnumber">1.1</SPAN><SPAN class="toctext">Methylated bits over time</SPAN></A></LI><LI class="toclevel-2"><A href="#Model_definition"><SPAN class="tocnumber">1.2</SPAN><SPAN class="toctext">Model definition</SPAN></A></LI><LI class="toclevel-2"><A href="#In_theory"><SPAN class="tocnumber">1.3</SPAN><SPAN class="toctext">In theory</SPAN></A></LI><LI class="toclevel-2"><A href="#In_practice"><SPAN class="tocnumber">1.4</SPAN><SPAN class="toctext">In practice</SPAN></A></LI></UL></TD></TR></TBODY></TABLE><P>Using the here presented model, we will examine how to infer the signal detection time from the amount of methylated plasmids. The cellular division rate determines how long a signal is stored in the <I>Cellular Logbook</I>. 
All units are dimensionless in this model, as its sole purpose is clarification of practical usage of the <I>Cellular Logbook</I>.
</P><H2><SPAN class="mw-headline" id="Methylated_bits_over_time">Methylated bits over time</SPAN></H2><P>Numerous identical plasmids are often present in single cells and plasmids replicate independently of the bacterial chromosome (Scott 1984). A plasmid copy number (PCN) has been determined for all plasmids in the Parts Registry, which indicates a likely amount of copies of the plasmid to be present in each cell. Unlike eukaryotes, prokaryotes do not copy DNA methylation patterns to the newly synthesized strand during DNA replication. This will lead to a dilution of the amount of ‘written’-plasmids over time, mostly due to cell replication and the ensuing binomial division of the plasmids in the parent cell among the two daughter cells. 
</P><DIV class="thumb tright"><DIV class="thumbinner" style="width:302px;"><DIV class="thumbcaption">Due to cell division, the amount of methylated plasmids will be approximately halved during each division cycle. In this picture a lower opacity indicates a lower amount of methylated plasmids</DIV></DIV></DIV><P>The volatilty of this memory design seemed a downside at first, but quickly opened our eyes to a very exciting feature of this system. By analyzing the fraction:
</P><CENTER><P>&lt;math&gt;F(t) = \frac{\text{written plasmids}}{\text{written + unwritten plasmids}}&lt;/math&gt;</P></CENTER><P>at the time of memory read-out, the time at which the signal was registered can be inferred.
</P><H2><SPAN class="mw-headline" id="Model_definition">Model definition</SPAN></H2><P>First, let’s model the input signal/compound which is to be reported on. Imagine the to be stationary and positioned along a fluidic stream so that the signal to be registered can pass the <I>Cellular Logbook</I>. Modelling the signal using the piecewise function &lt;math&gt;S(t)&lt;/math&gt; now seems appropriate. Here, &lt;math&gt;s_{\text{on}}&lt;/math&gt; is defined as the time at which the signal is first encountered and &lt;math&gt;s_{\text{off}}&lt;/math&gt; as the time at which the signal is turned off.
</P><DIV class="thumb tright"><DIV class="thumbinner" style="width:302px;"><DIV class="thumbcaption">Plot of the input signal &lt;math&gt;S(t)&lt;/math&gt; with &lt;math&gt;s_{\text{on}}&lt;/math&gt; at 3 and &lt;math&gt;s_{{\text{off}}}&lt;/math&gt; at 4</DIV></DIV></DIV><P>We will model a single cell with multiple identical plasmids. Each of the plasmid copies contain the gene for the methyltransferase and the so called <I>bit region</I>, which is the region especially purposed to be methylated in presence of a signal. The following assumptions/conditions are made:
</P><UL><LI> A well stirred cellular system with no spatial concentrations differences and all species' concentrations large enough to be approximated by continuous functions. Hence we will use a set of ordinary differential equations (ODE’s)
</LI><LI> To ease the analysis of the model, a single unique bit with multiple copies per cell is considered here
</LI><LI>&lt;math&gt;P_{0}&lt;/math&gt; denote plasmids that have the single bit set to 0, no write event has taken place in these cells
</LI><LI>&lt;math&gt;P_{1}&lt;/math&gt; denote plasmids in which the bit has been flipped to 1 in response to encountering the signalling compound
</LI><LI>&lt;math&gt;P_{\text{T}}&lt;/math&gt; denotes the total amount of cells in the sytem, &lt;math&gt;P_{0} + P_{1}&lt;/math&gt;</LI><LI> Assumed is a high response rate (3 min) termed &lt;math&gt;\omega&lt;/math&gt;, which is the constant rate with which the system responds with methylation of the bit region to the detection of the signal.
</LI><LI> Logistic growth for the plasmid population inside the cell, with a capacity limit of &lt;math&gt;Ca = 40&lt;/math&gt;, the copy number of a low copy number plasmid.
</LI><LI> Alternatively, this maximal plasmid number could also be described as the fraction between the plasmid proliferation rate (&lt;math&gt;\beta&lt;/math&gt;) and degradation rate (&lt;math&gt;\alpha&lt;/math&gt;). The steady state amount of plasmids in the cell will be determined by &lt;math&gt;P_{\text{SS}} = \frac{\beta}{\alpha}&lt;/math&gt;, the solution to the differential equation &lt;math&gt;P'(t) = \beta P - \alpha P&lt;/math&gt;.
</LI><LI> Accumulation of cells in which the bit has been written is assumed to result in non-written cells; methylation patterns are not copied to the progeny in prokaryotes.
</LI></UL><P>From these rules, the following system of ODE’s has been constructed:
$$
\begin{aligned}
\frac{dP_{0}}{dt} &amp;=&amp; k\ P_{0+1}\ (1 - \frac{P_{0+1}}{\text{Ca}}) - \omega\ S(t)\ P_{0} - \alpha\ P_{0} \\
\frac{dP_{1}}{dt} &amp;=&amp; \omega\ S(t)\ P_{0} - \alpha\ P_{1}
\end{aligned}
$$
</P><TABLE align="right"><TBODY><TR><TH align="left">Parameter</TH><TH align="right">Value</TH></TR><TR class="even"><TD align="left">k</TD><TD align="right">0.8</TD></TR><TR class="even"><TD align="left">&lt;math&gt;\alpha&lt;/math&gt;</TD><TD align="right">.06</TD></TR><TR class="odd"><TD align="left">Ca</TD><TD align="right">200</TD></TR><TR class="even"><TD align="left">&lt;math&gt;\omega&lt;/math&gt;</TD><TD align="right">4</TD></TR><TR><TD colspan="2"><B>Table 1</B>: Parameter values for the  plasmid methylation model</TD></TR></TBODY></TABLE><P>Using the parameter values of Table 1 a simulation with a duration of 40 time units is shown in Figure 2. The plasmid population within a <I>Cellular Logbook</I> is shown to be completely converted to methylated plasmids shortly after &lt;math&gt;s_{\text{on}}&lt;/math&gt;. As long as the signal is still present – until &lt;math&gt;s_{\text{off}}&lt;/math&gt;, – the bit on all newly copied plasmids will be immediately methylated as the signal is still present. After &lt;math&gt;s_{\text{off}}&lt;/math&gt;, &lt;math&gt;F(t)&lt;/math&gt; will start to decrease. This is mostly due to cell division, during which the cell’s plasmids will be binomially distributed between the two two daughter cells, halving the plasmid amount every division cycle. In this simulation, this degradation due to cell division has been accounted for in the constant degradation rate &lt;math&gt;\alpha&lt;/math&gt;. The duration of time after which a small trail of methylated plasmids is still present is related to two factors: positively to the amount of methylated cells at &lt;math&gt;s_{\text{off}}&lt;/math&gt; and negatively to the plasmid degradation rate.
</P><TABLE align="right"><TBODY><TR><TH align="left"><B>Species</B></TH><TH align="right"><B>Value</B></TH></TR><TR class="even"><TD align="left">&lt;math&gt;P_{0}(0)&lt;/math&gt;</TD><TD align="right">10</TD></TR><TR class="odd"><TD align="left">&lt;math&gt;P_{1}(0)&lt;/math&gt;</TD><TD align="right">0</TD></TR><TR><TD colspan="2"><B>Table 2</B>: Initial species values for the  plasmid methylation model</TD></TR></TBODY></TABLE><P>To reinforce that:
$$
P_{0} + P_{1} = P_{\text{T}} \le \text{Ca}
$$
is always true in the model, the total amount of plasmids has also been plotted (purple). This clearly shows the limiting value of the plasmid population count, specified by the capacity limit (&lt;math&gt;Ca&lt;/math&gt;). This is reached around &lt;math&gt;t=10&lt;/math&gt; with the parameter set used here.
</P><DIV class="center"><DIV class="thumb tnone"><DIV class="thumbinner" style="width:502px;"><DIV class="thumbcaption">Time simulation of the system of ODE’s. Input signal &lt;math&gt;S(t)&lt;/math&gt; with &lt;math&gt;s_{\text{on}} = 3&lt;/math&gt; and &lt;math&gt;s_{{\text{off}}} = 4&lt;/math&gt;. Detection of the signal converts all &lt;math&gt;P_{0}&lt;/math&gt; (red) to &lt;math&gt;P_{1}&lt;/math&gt; (blue) on a short time scale. After the amount &lt;math&gt;P_{1}&lt;/math&gt; will start to diminish due to cell division. Eventually, the steady state will be restored once again and the cell’s capacity for plasmids will be completely taken up by &lt;math&gt;P_{0}&lt;/math&gt; plasmids.</DIV></DIV></DIV></DIV><P>Unknown variables affecting &lt;math&gt;F(t)&lt;/math&gt; in a real-life setting would be the time of signal onset, signal duration and signal strength. Knowing the values for two of these three values, the value of the third can be solved for. Here we will simply assume maximal signal strength during &lt;math&gt;s_{\text{on}}&lt;/math&gt; and &lt;math&gt;s_{\text{off}}&lt;/math&gt;.
</P><P>The response rate &lt;math&gt;\omega&lt;/math&gt; of the <I>Cellular Logbook</I> could limit &lt;math&gt;F(t)&lt;/math&gt;, as a low &lt;math&gt;\omega&lt;/math&gt; might yield incomplete methylation of all plasmids before &lt;math&gt;s_{\text{off}}&lt;/math&gt;. This rate should be experimentally determinable before actual deployment and application of our system and is more closely looked at in the next section. It is likely to be several magnitudes greater than the cellular division rate, however. Every single gene on a plasmid is thus expected to be methylated within at most 5 minutes of registering of the signal.
</P><P>Assuming that the plasmid population will have reached its stationary state level before is plausible and eases the analysis somewhat. If the capacity limit has not been reached yet before, a lower value of results than had the capacity limit been reached. This could fool an experimentalist into thinking that the signal was detected relatively long ago, when in fact the amount of plasmids was still very low at &lt;math&gt;s_{\text{on}}&lt;/math&gt;, such that total plasmid population &lt;math&gt;P_{\text{T}}&lt;/math&gt; has continued to expand since &lt;math&gt;s_{\text{on}}&lt;/math&gt;.
</P><H2><SPAN class="mw-headline" id="In_theory">In theory</SPAN></H2><P>The monotonically decreasing value of &lt;math&gt;F(t) = \frac{\text{methylated plasmids}}{\text{total plasmids}}&lt;/math&gt; can be used to infer &lt;math&gt;s_{\text{off}}&lt;/math&gt;, given that the degradation rate (&lt;math&gt;\alpha&lt;/math&gt;) and capacity constraint &lt;math&gt;Ca&lt;/math&gt; are known and constant. Also assumed is that all bits are methylated during signal presence, this implicates &lt;math&gt;\omega&lt;/math&gt; is sufficient to methylate all bits during presence of the signal. Irrespective of the initial amount of plasmids, the population of plasmids within the single cell will have reached a steady state value of &lt;math&gt;\frac{\beta}{\alpha}&lt;/math&gt;. As we see in the Figure 2, &lt;math&gt;F(t)&lt;/math&gt; will start to decrease as a function of the degradation rate after the signal has left the medium following the following function:
</P><P>$$
\frac{dP_{1}}{dt} = - \alpha\ P_{1}
$$
</P><P>Integrating this differential equation and multiplying by the steady value &lt;math&gt;\frac{\beta}{\alpha}&lt;/math&gt; will yield the amount of methylated plasmids at time &lt;math&gt;t&lt;/math&gt;, given that there were &lt;math&gt;\frac{\beta}{\alpha}&lt;/math&gt; methylated plasmids at &lt;math&gt;t = 0&lt;/math&gt;.
</P><P>$$
P_{1}(t) = \frac{\beta}{\alpha} e^{-\alpha t} = \frac{\beta}{\alpha} F(t)
$$
</P><P>By solving the previous equation, we can calculate the time &lt;math&gt;t&lt;/math&gt; that has passed after &lt;math&gt;s_{\text{off}}&lt;/math&gt; from &lt;math&gt;F(t)&lt;/math&gt;:
</P><P>$$
t = \frac{\ln(F(t))}{-\alpha}
$$
</P><H2><SPAN class="mw-headline" id="In_practice">In practice</SPAN></H2><DIV class="center"><DIV class="thumb tnone"><DIV class="thumbinner" style="width:502px;"><DIV class="thumbcaption">Gel representations for a range of different &lt;math&gt;F(t)&lt;/math&gt; values. Complete methylation of all bits results in a single, bright band at the top of the gel. This indicates the undigested, linearized plasmid. Decreasing the amount of methylated bits shifts the intensity of the top band away to the two bottom bands. These indicate the linearized &amp; successfully digested plasmid</DIV></DIV></DIV></DIV><P>In a typical laboratory situation, doing a restriction enzyme assay on the miniprep-extracted plasmid DNA out of followed by gel electrophoresis will be the most convenient way to assess the methylation status of the bits. The relative intensities of the gel bands can then be used to infer &lt;math&gt;F(t)&lt;/math&gt;. Unmethylated bits will result in successfully digested DNA fragments and thus two bands of shorter DNA fragments. Methylated bits will not be cut and will therefore result in one longer band, shown more to the top of the gel. Thus the top and two bottom gel bands are mutually exclusive as they indicate the same (linearized) plasmid DNA to either be digested, resulting in the two bottom bands, or undigested, resulting in the top band. A high value for &lt;math&gt;F(t)&lt;/math&gt; indicates recent detection of the signal, whereas a low value indicates detection to have occurred longer ago. 
</P><P>To get a hands-on feel of the effects that the plasmid degradation and replication rate have on &lt;math&gt;F(t)&lt;/math&gt;, an interactive version in Mathematica is hosted on <A href="https://www.dropbox.com/s/2b32sys01ywdotl/timeinferrance.nb" class="external text" rel="nofollow">Dropbox</A>.
This file contains the code for all analyses and graphics (except for the cell division scheme) on this page.
</P></DIV></DIV></DIV></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2012.igem.org/Team:Amsterdam/achievements/time_inference_model">http://2012.igem.org/Team:Amsterdam/achievements/time_inference_model</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Amsterdam/achievements/time_inference_model" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Amsterdam/achievements/time_inference_model" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Amsterdam/achievements/time_inference_model&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Amsterdam/achievements/time_inference_model&amp;oldid=207483" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2012.igem.org:Privacy_policy" title="2012.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2012.igem.org:General_disclaimer" title="2012.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>