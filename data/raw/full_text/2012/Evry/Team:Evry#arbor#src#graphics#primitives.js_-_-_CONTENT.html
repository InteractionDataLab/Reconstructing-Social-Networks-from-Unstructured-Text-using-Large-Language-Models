<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Evry_arbor_src_graphics_primitives_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Evry/arbor/src/graphics/primitives.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Evry/arbor/src/graphics/primitives.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Evry/arbor/src/graphics/primitives.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Evry/arbor/src/graphics/primitives.js&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Evry/arbor/src/graphics/primitives.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Evry/arbor/src/graphics/primitives.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2012.igem.org</H3><P>//
//  primitives
//
//  Created by Christian Swinehart on 2010-12-08.
//  Copyright (c) 2011 Samizdat Drafting Co. All rights reserved.
//
</P><P>
var Primitives = function(ctx, _drawStyle, _fontStyle){
</P><PRE>   ///MACRO:primitives-start
   var _Oval = function(x,y,w,h,style){
     this.x = x
     this.y = y
     this.w = w
     this.h = h
     this.style = (style!==undefined) ? style : {}
   }
   _Oval.prototype = {
     draw:function(overrideStyle){
       this._draw(overrideStyle)
     },
</PRE><PRE>     _draw:function(x,y,w,h, style){
       if (objcontains(x, 'stroke', 'fill', 'width')) style = x
       if (this.x!==undefined){
         x=this.x, y=this.y, w=this.w, h=this.h;
         style = objmerge(this.style, style)
       }
       style = objmerge(_drawStyle, style)
       if (!style.stroke &amp;&amp; !style.fill) return
</PRE><PRE>       var kappa = .5522848;
           ox = (w / 2) * kappa, // control point offset horizontal
           oy = (h / 2) * kappa, // control point offset vertical
           xe = x + w,           // x-end
           ye = y + h,           // y-end
           xm = x + w / 2,       // x-middle
           ym = y + h / 2;       // y-middle
</PRE><PRE>       ctx.save()
         ctx.beginPath();
         ctx.moveTo(x, ym);
         ctx.bezierCurveTo(x, ym - oy, xm - ox, y, xm, y);
         ctx.bezierCurveTo(xm + ox, y, xe, ym - oy, xe, ym);
         ctx.bezierCurveTo(xe, ym + oy, xm + ox, ye, xm, ye);
         ctx.bezierCurveTo(xm - ox, ye, x, ym + oy, x, ym);
         ctx.closePath();
</PRE><PRE>         // trace(style.fill, style.stroke)
         if (style.fill!==null){
           // trace(&quot;fill&quot;,fillColor, Colors.encode(fillColor))
           if (style.alpha!==undefined) ctx.fillStyle = Colors.blend(style.fill, style.alpha)
           else ctx.fillStyle = Colors.encode(style.fill)
           ctx.fill()
         }
</PRE><PRE>         if (style.stroke!==null){
           ctx.strokeStyle = Colors.encode(style.stroke)
           if (!isNaN(style.width)) ctx.lineWidth = style.width
           ctx.stroke()
         }      
       ctx.restore()
     }
</PRE><PRE>   }
</PRE><PRE>   var _Rect = function(x,y,w,h,r,style){
     if (objcontains(r, 'stroke', 'fill', 'width')){
        style = r
        r = 0
     }
     this.x = x
     this.y = y
     this.w = w
     this.h = h
     this.r = (r!==undefined) ? r : 0
     this.style = (style!==undefined) ? style : {}
   }
   _Rect.prototype = {
     draw:function(overrideStyle){
       this._draw(overrideStyle)
     },
</PRE><PRE>     _draw:function(x,y,w,h,r, style){
       if (objcontains(r, 'stroke', 'fill', 'width', 'alpha')){
         style = r; r=0;
       }else if (objcontains(x, 'stroke', 'fill', 'width', 'alpha')){
         style = x
       }
       if (this.x!==undefined){
         x=this.x, y=this.y, w=this.w, h=this.h;
         style = objmerge(this.style, style)
       }
       style = objmerge(_drawStyle, style)
       if (!style.stroke &amp;&amp; !style.fill) return
</PRE><PRE>       var rounded = (r&gt;0)
       ctx.save()
       ctx.beginPath();
       ctx.moveTo(x+r, y);
       ctx.lineTo(x+w-r, y);
       if (rounded) ctx.quadraticCurveTo(x+w, y, x+w, y+r);
       ctx.lineTo(x+w, y+h-r);
       if (rounded) ctx.quadraticCurveTo(x+w, y+h, x+w-r, y+h);
       ctx.lineTo(x+r, y+h);
       if (rounded) ctx.quadraticCurveTo(x, y+h, x, y+h-r);
       ctx.lineTo(x, y+r);
       if (rounded) ctx.quadraticCurveTo(x, y, x+r, y);      
</PRE><PRE>       if (style.fill!==null){
         if (style.alpha!==undefined) ctx.fillStyle = Colors.blend(style.fill, style.alpha)
         else ctx.fillStyle = Colors.encode(style.fill)
         ctx.fill()
       }
</PRE><PRE>       if (style.stroke!==null){
         ctx.strokeStyle = Colors.encode(style.stroke)
         if (!isNaN(style.width)) ctx.lineWidth = style.width
         ctx.stroke()
       }      
       ctx.restore()
     }
   }
</PRE><PRE>   var _Path = function(x1, y1, x2, y2, style){
     // calling patterns:
     // Æ’( x1, y1, x2, y2, &lt;style&gt; )
     // Æ’( {x:1, y:1}, {x:2, y:2}, &lt;style&gt; )
     // Æ’( [ {x:1, y:1}, {x:2, y:2}, ...], &lt;style&gt; ) one continuous line
     // Æ’( [ [{x,y}, {x,y}], [{x,y}, {x,y}], ...], &lt;style&gt; ) separate lines
</PRE><PRE>     if (style!==undefined || typeof y2=='number'){
       // Æ’( x1, y1, x2, y2, &lt;style&gt; )
       this.points = [ {x:x1,y:y1}, {x:x2,y:y2} ]
       this.style = style || {}
     }else if ($.isArray(x1)){
       // Æ’( [ {x:1, y:1}, {x:2, y:2}, ...], &lt;style&gt; )
       this.points = x1
       this.style = y1 || {}
     }else{
       // Æ’( {x:1, y:1}, {x:2, y:2}, &lt;style&gt; )
       this.points = [ x1, y1 ]
       this.style = x2 || {}
     }
   }
   _Path.prototype = {
     draw:function(overrideStyle){
       if (this.points.length&lt;2) return
</PRE><PRE>       var sublines = []
       if (!$.isArray(this.points[0])) sublines.push(this.points)
       else sublines = this.points
       
       ctx.save()
         ctx.beginPath();
         $.each(sublines, function(i, lineseg){
           ctx.moveTo(lineseg[0].x+.5, lineseg[0].y+.5);
           $.each(lineseg, function(i, pt){
             if (i==0) return
             ctx.lineTo(pt.x+.5, pt.y+.5);
           })
         })
</PRE><PRE>         var style = $.extend(objmerge(_drawStyle, this.style), overrideStyle)
         if (style.closed) ctx.closePath()
</PRE><PRE>         if (style.fill!==undefined){
           var fillColor = Colors.decode(style.fill, (style.alpha!==undefined) ? style.alpha : 1)
           if (fillColor) ctx.fillStyle = Colors.encode(fillColor)
             ctx.fill()
         }
</PRE><PRE>         if (style.stroke!==undefined){
           var strokeColor = Colors.decode(style.stroke, (style.alpha!==undefined) ? style.alpha : 1)
           if (strokeColor) ctx.strokeStyle = Colors.encode(strokeColor)
           if (!isNaN(style.width)) ctx.lineWidth = style.width
           ctx.stroke()
         }
 			ctx.restore()
     }
   }
   
</PRE><PRE>   var _Color = function(a,b,c,d){
     var rgba = Colors.decode(a,b,c,d)
     if (rgba){
       this.r = rgba.r
       this.g = rgba.g
       this.b = rgba.b
       this.a = rgba.a
     }
   }
</PRE><PRE>   _Color.prototype = {
     toString:function(){
       return Colors.encode(this)
     },
     blend:function(){
       trace(&quot;blend&quot;,this.r,this.g,this.b,this.a)
     }
   }
</PRE><PRE>   // var _Font = function(face, size){
   //   this.face = (face!=undefined) ? face : &quot;sans-serif&quot;
   //   this.size = (size!=undefined) ? size : 12
   //   // this.alignment = (opts.alignment!=undefined) ? alignment : &quot;left&quot;
   //   // this.baseline = (opts.baseline!=undefined) ? baseline : &quot;ideographic&quot;
   //   // this.color = (opts.color!=undefined) ? Colors.decode(opts.color) : Colors.decode(&quot;black&quot;)
   // }
   // _Font.prototype = {
   //   _use:function(face, size){
   //     // var params = $.extend({face:face, size:size}, opts)
   //     // $.each('face size alignment baseline color'.split(&quot; &quot;), function(i, param){
   //     //   if (params[param]!==undefined){
   //     //     if (param=='color') _fontStyle[param] = Colors.decode(params[param])
   //     //     else _fontStyle[param] = params[param]
   //     //   }
   //     // })
   // 
   //     // ctx.textAlign = _fontStyle.alignment
   //     // ctx.textBaseline = _fontStyle.baseline
   //     ctx.font = nano(&quot;{size}px {face}&quot;, {face:face, size:size})
   //     // trace(ctx.font,face,size)      
   //     // ctx.fillStyle = Colors.encode(_fontStyle)
   //     // _fontStyle = {face:face, size:size, alignment:opts.alignment, baseline:opts.baseline, color:opts.color}
   //   },
   //   use:function(){
   //     ctx.font = nano(&quot;{size}px {face}&quot;, this)
   //   }
   // }
   // 
   // 
</PRE><PRE> ///MACRO:primitives-end
</PRE><PRE> return {
   _Oval:_Oval,
   _Rect:_Rect,
   _Color:_Color,
   _Path:_Path
   // _Frame:Frame
 }
</PRE><P>}
</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2012.igem.org/Team:Evry/arbor/src/graphics/primitives.js">http://2012.igem.org/Team:Evry/arbor/src/graphics/primitives.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Evry/arbor/src/graphics/primitives.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Evry/arbor/src/graphics/primitives.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Evry/arbor/src/graphics/primitives.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Evry/arbor/src/graphics/primitives.js&amp;oldid=124547" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2012.igem.org:Privacy_policy" title="2012.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2012.igem.org:General_disclaimer" title="2012.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>