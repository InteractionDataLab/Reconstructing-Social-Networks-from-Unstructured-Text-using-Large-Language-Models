<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_TU_Munich_Modeling_Methods"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:TU_Munich/Modeling/Methods">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:TU_Munich/Modeling/Methods&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:TU_Munich/Modeling/Methods&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:TU_Munich/Modeling/Methods&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:TU_Munich/Modeling/Methods" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:TU Munich/Modeling/Methods</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2012.igem.org</H3><DIV id="navigation"><UL><LI><B><A href="https://2012.igem.org/Team:TU_Munich/Project/Overview">Project</A></B></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Overview">Results</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Safety">Safety</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Vector_Design">Vector Design</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Limonene">Limonene</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Thaumatin">Thaumatin</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Caffeine">Caffeine</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Xanthohumol">Xanthohumol</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Constitutive_Promoter">Constitutive Promoter</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Light_Switchable_Promoter">Light-Switchable Promoter</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Ethanol_Inducible_Promoter">Ethanol-Inducible Promoter</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Genome_Integration">Genome Integration</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Project/Brewing">Brewing</A></LI></UL><LI><B><A href="https://2012.igem.org/Team:TU_Munich/Results/Biobricks">BioBricks</A></B></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Results/Biobricks">Data Page</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Results/RFC">RFC</A></LI><LI><B><A href="https://2012.igem.org/Team:TU_Munich/Modeling/Methods">Modeling</A></B></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Modeling/Methods">Methods</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Modeling/Priors">Priors</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Modeling/Gal1_Promoter">Gal1 Promoter</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Modeling/Yeast_Growth">Yeast Growth</A></LI><LI><B><A href="https://2012.igem.org/Team:TU_Munich/Human_Practice/Overview">Human Practice</A></B></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Human_Practice/Overview">Overview</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Human_Practice/School_Visit">School Visit</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Human_Practice/Public">Public Relations</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Human_Practice/Comic_children">Comic</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Human_Practice/Information_Day">Action Day</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Human_Practice/Politics">Politics</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Human_Practice/Movie">Movie</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Human_Practice/Radio">Radio Interview</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Human_Practice/Survey">Survey</A></LI><LI><B><A href="https://2012.igem.org/Team:TU_Munich/Notebook/Labjournal">Notebook</A></B></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Notebook/Protocols">Methods</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Notebook/Labjournal">Labjournal</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Notebook/Meetings">Meetings</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Notebook/Attribution">Attributions</A></LI><LI><B><A href="https://2012.igem.org/Team:TU_Munich/Team/Members">Team</A></B></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Team/Members">Members</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Team/Activities">Activities</A></LI><LI><A href="https://2012.igem.org/Team:TU_Munich/Team/Collaborations">Collaborations</A></LI></DIV><TABLE id="toc" class="toc"><TBODY><TR><TD><DIV id="toctitle"><H2>Contents</H2></DIV><UL><LI class="toclevel-1 tocsection-1"><A href="#Modeling_Methods"><SPAN class="tocnumber">1</SPAN><SPAN class="toctext">Modeling Methods</SPAN></A></LI><LI class="toclevel-2 tocsection-2"><A href="#Why_Mathematical_Models.3F"><SPAN class="tocnumber">1.1</SPAN><SPAN class="toctext">Why Mathematical Models?</SPAN></A></LI><LI class="toclevel-2 tocsection-3"><A href="#Why_are_we_not_necessarily_interested_in_the_best_fit.3F"><SPAN class="tocnumber">1.2</SPAN><SPAN class="toctext">Why are we not necessarily interested in the best fit?</SPAN></A></LI><LI class="toclevel-2 tocsection-4"><A href="#What_is_the_benefit_of_assuming_a_stochastic_distribution_of_parameters.3F"><SPAN class="tocnumber">1.3</SPAN><SPAN class="toctext">What is the benefit of assuming a stochastic distribution of parameters?</SPAN></A></LI><LI class="toclevel-2 tocsection-5"><A href="#How_did_Modeling_affect_our_work_in_the_lab.3F"><SPAN class="tocnumber">1.4</SPAN><SPAN class="toctext">How did Modeling affect our work in the lab?</SPAN></A></LI><LI class="toclevel-2 tocsection-6"><A href="#Bayesian_Inference"><SPAN class="tocnumber">1.5</SPAN><SPAN class="toctext">Bayesian Inference</SPAN></A></LI><LI class="toclevel-3 tocsection-7"><A href="#Derivation"><SPAN class="tocnumber">1.5.1</SPAN><SPAN class="toctext">Derivation</SPAN></A></LI><LI class="toclevel-3 tocsection-8"><A href="#Relation_to_least_squares"><SPAN class="tocnumber">1.5.2</SPAN><SPAN class="toctext">Relation to least squares</SPAN></A></LI><LI class="toclevel-3 tocsection-9"><A href="#Monte_Carlo_Methods"><SPAN class="tocnumber">1.5.3</SPAN><SPAN class="toctext">Monte Carlo Methods</SPAN></A></LI></UL><LI class="toclevel-2 tocsection-10"><A href="#Identifiability"><SPAN class="tocnumber">1.6</SPAN><SPAN class="toctext">Identifiability</SPAN></A></LI><LI class="toclevel-3 tocsection-11"><A href="#What_is_the_problem.3F"><SPAN class="tocnumber">1.6.1</SPAN><SPAN class="toctext">What is the problem?</SPAN></A></LI><LI class="toclevel-3 tocsection-12"><A href="#Profile_Likelihood"><SPAN class="tocnumber">1.6.2</SPAN><SPAN class="toctext">Profile Likelihood</SPAN></A></LI><LI class="toclevel-2 tocsection-13"><A href="#CVode_Wrapper"><SPAN class="tocnumber">1.7</SPAN><SPAN class="toctext">CVode Wrapper</SPAN></A></LI><LI class="toclevel-2 tocsection-14"><A href="#Sensitivity_Analysis"><SPAN class="tocnumber">1.8</SPAN><SPAN class="toctext">Sensitivity Analysis</SPAN></A></LI><LI class="toclevel-2 tocsection-15"><A href="#Vision"><SPAN class="tocnumber">1.9</SPAN><SPAN class="toctext">Vision</SPAN></A></LI><LI class="toclevel-2 tocsection-16"><A href="#Reference"><SPAN class="tocnumber">1.10</SPAN><SPAN class="toctext">Reference</SPAN></A></LI></TD></TR></TBODY></TABLE><H1><SPAN class="mw-headline" id="Modeling_Methods"> Modeling Methods </SPAN></H1><DIV class="thumb tright"><DIV class="thumbinner" style="width:182px;"><DIV class="thumbcaption">Responsible: Fabian Fröhlich</DIV></DIV></DIV><H3><SPAN class="mw-headline" id="Why_Mathematical_Models.3F"> Why Mathematical Models? </SPAN></H3><DIV class="show"><P>To be able to predict the behavior of a given biological system, one has to create a mathematical model of the system.
The model is usually generated according to the Law of Mass Action and then simplified by assuming certain reactions to be fast. This model then could e.g. facilitate optimizations of bio-synthetic pathways by regulating the relative expression levels of the involved enzymes.
</P></DIV><H3><SPAN class="mw-headline" id="Why_are_we_not_necessarily_interested_in_the_best_fit.3F"> Why are we not necessarily interested in the best fit? </SPAN></H3><DIV><P>To create a model that produces quantitative predictions, one needs to tune the parameters to fit experimental data. This procedure is called inference and is usually accomplished by computing the least squares approximation of the model to the experimental data with respect to the parameters.
</P><P>There are several difficulties with this approach:
In the case of a non-convex least squares error function several local minima may exist and optimizations algorithms will struggle to find all of them. This means one might not be able to find the best fit or even a biologically reasonable fit.
</P><P>Another issue with this approach is the fact that it provides no information on the shape of the error function in the neighborhood of the obtained fit. Although it is possible to obtain information about the curvature by computing the hessian of the error function, this can be very computationally intensive if no analytical expression is given and only provides local information.
</P><P>This poses problems if the error function is very flat. Then in the neighborhood of the set of best fit parameters, a broad range of parameters exist, that produce very similar results. This however drastically reduces the significance of the best fit parameters
</P></DIV><H3><SPAN class="mw-headline" id="What_is_the_benefit_of_assuming_a_stochastic_distribution_of_parameters.3F"> What is the benefit of assuming a stochastic distribution of parameters? </SPAN></H3><DIV><P>Usually biological systems exhibit some sort of stochasticity. If the behavior of a sufficiently large amount of cells is observed, it is justifiable to take only the mean value into consideration and thereby assume a deterministic behavior.
On the one hand this means we can describe the system with ordinary and partial differential equations instead of stochastic differential equations, which reduces the computational cost of simulating the system. On the other hand this means that we lose the information we could infer from the variance of our measurements as well as higher order moments.
</P><P>Assuming that parameter are distributed according to some density allows us, to deduce information from variance of measurements, while still describing the system in a deterministic fashion.
</P></DIV><H3><SPAN class="mw-headline" id="How_did_Modeling_affect_our_work_in_the_lab.3F"> How did Modeling affect our work in the lab? </SPAN></H3><DIV><P>When planning an experiment, the choice of time intervals and concentrations to use was based on the collaboration between Fabian and the experimenter. Here, previous experiments and literature served as guidance during the decision making.
</P></DIV><H2><SPAN class="mw-headline" id="Bayesian_Inference"> Bayesian Inference </SPAN></H2><H3><SPAN class="mw-headline" id="Derivation"> Derivation </SPAN></H3><DIV><P>Bayes' Rule allow the expression of the probability of A given B in terms of the probability of A, B and B given A.
</P><P>We can remove the dependence on the probability of B by applying the law of total probability:
</P><P>Now as we want to get an expression for the probability of the parameters given our measured data, we plug in parameters for A and data for B we get
</P><P>As the denominator is constant and only needed to normalize the distribution, we will omit this factor in the future.
</P><P>Furthermore we will call 
</P><P>P(parameters|data): posterior
</P><P>P(data|parameters): likelihood
</P><P>P(parameters): prior
</P><P>The likelihood tells us how probable it is the systems will produce the data from the experiments given the selected parameters according to our model.
</P><P>The prior gives the probability of our parameters, independent of our model or our data. As the name already suggests, the prior gives the option to incorporate prior knowledge about the distribution of the parameters.
</P></DIV><H3><SPAN class="mw-headline" id="Relation_to_least_squares"> Relation to least squares </SPAN></H3><DIV><P>If we do not know anything about the parameters, e.g. they all have the same probability we can omit the prior. This means that the posterior is equal to the likelihood. 
</P><P>Now if the likelihood is a Gaussian distribution, maximizing the logarithm of the likelihood, as function of the parameters, is the same as finding the least squares approximation.
</P></DIV><H3><SPAN class="mw-headline" id="Monte_Carlo_Methods"> Monte Carlo Methods </SPAN></H3><DIV><P>Usually it is not possible to give any closed expression for the posterior distribution. When working with high dimensional posteriors where the location of the support of the distribution is not clear, interpolating the posterior will be very hard. Hence alternative methods are necessary to get an idea of the shape of the posterior distribution.
The book by David MacKay [<A href="http://www.inference.phy.cam.ac.uk/mackay/itila/book.html" class="external text" rel="nofollow">MacKay, 2003</A>] gives an good overview of available algorithms.
</P><P>The general idea of Monte Carlo methods is to draw random samples and accept or reject them, in such a manner that the samples will eventually be drawn according to a certain, evaluable distribution.
</P><P>We will use the Metropolis Hastings algorithm as it is easy to implement and sufficiently fast to sample our posteriors.
</P></DIV><H2><SPAN class="mw-headline" id="Identifiability"> Identifiability </SPAN></H2><H3><SPAN class="mw-headline" id="What_is_the_problem.3F"> What is the problem? </SPAN></H3><DIV><P>Another problem that was not yet addressed is the question of identifiablity.
When it is only possible to measure the cumulative amount of the two A and B where the system is governed by the equation
</P><P>the measurement will, apart from errors always produce the same value. This means that it is impossible to infer the value of the measurement b.
As all values of will b produce an equivalent fit, all results of optimization routines will be meaningless.
</P><P>In actual inference task we will most likely not deal with such extreme non-identifiabilities but it could happen that for example only the ratio between two parameters is identifiable but not the individual values. Such behavior can be visible in marginal joint distributions generated by Markov Methods, but one will have a hard time spotting more complex non-identifiabilities from joint distributions.
</P></DIV><H3><SPAN class="mw-headline" id="Profile_Likelihood"> Profile Likelihood </SPAN></H3><DIV><P>In that cases one normally looks at the <B>profile likelihood</B> of the distribution. The profile likelihood is generated by maximizing the likelihood/posterior for a set fixed value of one parameter with respect to the other remaining parameters. When this profile likelihood for one parameter is flat, all changes to this parameter can be balanced by a change of the other parameters and the examined parameters is not identifiable[<A href="http://www.ncbi.nlm.nih.gov/pubmed/22355081" class="external text" rel="nofollow">Vanlier et al., 2012b</A>].
</P></DIV><H2><SPAN class="mw-headline" id="CVode_Wrapper"> CVode Wrapper </SPAN></H2><DIV><DIV class="thumb tright"><DIV class="thumbinner" style="width:502px;"><DIV class="thumbcaption"><B>Fig. 1</B> Comparison of CVode speedup. Picture taken from Vanlier J. 2010</DIV></DIV></DIV><P>When every evaluation of the posterior requires solving a set of ordinary differential equation, generating several thousand samples can be quite time consuming. Hence speeding up the solving routine is desirable.
</P><P>By replacing the Matlab ode solvers by C++ scripts one can achieve a speedup of the calculations of up to two magnitudes.
</P><P>A Wrapper to easily migrate from Matlab ode code to c++ scripts is easily done with the CVode Wrapper provided by the Systems Biology group from TU Eindhoven [Vanlier, 2010] .
</P></DIV><H2><SPAN class="mw-headline" id="Sensitivity_Analysis"> Sensitivity Analysis </SPAN></H2><DIV><P>To assess in what magnitude changes in parameters are reflected in the simulation, one can perform sensitivity analysis.
Absolute sensitivity is obtained by computing the total differential of the right hand side of the differential equation with respect to each parameter.
</P><P>The solution to this matrix valued differential equation gives us the <B>absolute sensitivity</B> for every species with respect to every parameter. Multiplying every entry of this matrix with the value of the species and divide it by the value of the parameter for every point in time gives the <B>relative sensitivity</B>.
</P></DIV><H2><SPAN class="mw-headline" id="Vision"> Vision </SPAN></H2><DIV><P>Bayesian Inference fits into the setting of BioBricks very well: Priors are small parts that are added to your simulation, and either you improve them by performing inference yourself and adding the resulting marginal distribution of the parameter as new, improved prior or you only use them to simulate the system.
</P><P>As the number of teams increases every year and more and more data is generated over the years, the incremental nature of the method will great improvements to the quality of models.
</P><P>The repertoire of methods displayed here represents only a small fraction of the methods available via Bayesian Inference.
Bayesian Inference also offer powerful tools to 
</P><UL><LI> Compare the performance of different models [<A href="http://projecteuclid.org/euclid.aos/1176344136" class="external text" rel="nofollow">Schwarz, 1978</A>]
</LI><LI> Facilitate well-founded experimental design [<A href="http://www.ncbi.nlm.nih.gov/pubmed/22368245" class="external text" rel="nofollow">Vanlier et al., 2012a</A>]
</LI></UL></DIV><H2><SPAN class="mw-headline" id="Reference"> Reference </SPAN></H2><UL><LI>[<A href="http://www.inference.phy.cam.ac.uk/mackay/itila/book.html" class="external text" rel="nofollow">MacKay, 2003</A>] MacKay, D. J. C. (2003). Information Theory, Inference, and Learning Algorithms. Cambridge University Press.
</LI><LI>[<A href="http://projecteuclid.org/euclid.aos/1176344136" class="external text" rel="nofollow">Schwarz, 1978</A>] Schwarz, G. (1978). Estimating the dimension of a model. Annals of Statistics, 6(2):461–464.
</LI><LI>[Vanlier, 2010] Vanlier, J. (2010). Installation and usage instructions for the cvode wrapper.
</LI><LI>[<A href="http://www.ncbi.nlm.nih.gov/pubmed/22368245" class="external text" rel="nofollow">Vanlier et al., 2012a</A>] Vanlier, J., Tiemann, C. A., Hilbers, P. A. J., and van Riel, N. A. W. (2012a). A bayesian approach to targeted experiment design. <I>Bioinformatics</I>, 28(8):1136–42.
</LI><LI>[<A href="http://www.ncbi.nlm.nih.gov/pubmed/22355081" class="external text" rel="nofollow">Vanlier et al., 2012b</A>] Vanlier, J., Tiemann, C. A., Hilbers, P. A. J., and van Riel, N. A. W. (2012b). An integrated strategy for prediction uncertainty analysis. <I>Bioinformatics</I>, 28(8):1130–5.
</LI></UL><DIV class="printfooter">
Retrieved from &quot;<A href="http://2012.igem.org/Team:TU_Munich/Modeling/Methods">http://2012.igem.org/Team:TU_Munich/Modeling/Methods</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:TU_Munich/Modeling/Methods" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:TU_Munich/Modeling/Methods" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:TU_Munich/Modeling/Methods&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:TU_Munich/Modeling/Methods&amp;oldid=288578" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2012.igem.org:Privacy_policy" title="2012.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2012.igem.org:General_disclaimer" title="2012.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>