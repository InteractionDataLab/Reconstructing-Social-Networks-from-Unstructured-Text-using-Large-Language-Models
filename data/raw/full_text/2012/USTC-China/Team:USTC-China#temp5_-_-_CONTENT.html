<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_USTC-China_temp5"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:USTC-China/temp5">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:USTC-China/temp5&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:USTC-China/temp5&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:USTC-China/temp5&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:USTC-China/temp5" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:USTC-China/temp5</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2012.igem.org</H3><P>//----------------------------------------------------------
// WebPlus LightBox
//----------------------------------------------------------
</P><P>(function($)
{
</P><PRE>   jQuery.fn.wplightbox = function( settings )
   {
       //-----------------------------------
       // Extend jQuery settings to include arguments
       //-----------------------------------
       settings = jQuery.extend(
       {
           bShowToolTip: false,
           strCloseToolTip: 'Close (Esc)',
           strPrevToolTip: 'Previous (&lt;)',
           strNextToolTip: 'Next (&gt;)',
           strPlayToolTip: 'Play',
           strPauseToolTip: 'Pause',
</PRE><PRE>           bBkgrndClickable: true,
           strBkgrndCol: '#000000',
           nBkgrndOpacity: 0.5,
           strContentCol: '#ffffff',
           nContentOpacity: 0.8,
           strCaptionCol: '#555555',
           nCaptionOpacity: 1.0,
           nCaptionType: 1,
           bCaptionCount: true,
           strCaptionFontType: 'Tahoma,Serif',
           strCaptionFontCol: '#ffffff',
           nCaptionFontSz: 15,
           bShowPlay: true,
           bAnimateOpenClose: true,
           nPlayPeriod: 2000,
</PRE><PRE>       //-----------------------------------
       // Permanent Settings
       //-----------------------------------
</PRE><P>			nZIndex: 151,
</P><PRE>           nPlayBtnOffset: 18,
           nNextBtnSz: 35,
           nLoadBtnSz: 50,
           nPlayBtnSz: 40,
           nBtnOffset: 10,
           nTableBorderSz: 10,
           nCaptionPadding: 15,
           nCaptionOffset: 10,
           bShowTranspBkgrndDiv: true,
</PRE><PRE>           loadBtnSrc: ( settings.strImgDir + 'lightbox_load.gif' ),
           blankSrc: ( settings.strScriptDir + 'blank.gif' ),
           playBtnSrc: ( settings.strImgDir + 'lightbox_play.png' ),
           playOverBtnSrc: ( settings.strImgDir + 'lightbox_play_over.png' ),
           pauseBtnSrc: ( settings.strImgDir + 'lightbox_pause.png' ),
           pauseOverBtnSrc: ( settings.strImgDir + 'lightbox_pause_over.png' )	,		
</PRE><PRE>           closeBtnSrc: ( settings.strImgDir + 'lightbox_close_' + settings.nButtonType + '.png' ),
           closeOverBtnSrc: ( settings.strImgDir + 'lightbox_close_over_' + settings.nButtonType + '.png' ),
           nextBtnSrc: ( settings.strImgDir + 'lightbox_next_' + settings.nButtonType + '.png' ),
           nextOverBtnSrc: ( settings.strImgDir + 'lightbox_next_over_' + settings.nButtonType + '.png' ),
           prevBtnSrc: ( settings.strImgDir + 'lightbox_prev_' + settings.nButtonType + '.png' ),
           prevOverBtnSrc: ( settings.strImgDir + 'lightbox_prev_over_' + settings.nButtonType + '.png' ),
</PRE><PRE>           border_n: ( settings.strImgDir + 'lightbox_n_' + settings.nBorderType + '.png' ),          
           border_e: ( settings.strImgDir + 'lightbox_e_' + settings.nBorderType + '.png' ),             
           border_s: ( settings.strImgDir + 'lightbox_s_' + settings.nBorderType + '.png' ),             
           border_w: ( settings.strImgDir + 'lightbox_w_' + settings.nBorderType + '.png' ),             
           border_ne: ( settings.strImgDir + 'lightbox_ne_' + settings.nBorderType + '.png' ),             
           border_nw: ( settings.strImgDir + 'lightbox_nw_' + settings.nBorderType + '.png' ),             
           border_se: ( settings.strImgDir + 'lightbox_se_' + settings.nBorderType + '.png' ),             
           border_sw: ( settings.strImgDir + 'lightbox_sw_' + settings.nBorderType + '.png' )        
</PRE><PRE>       }, settings);
       
       //-----------------------------------
       // Declare browser enumeration
       //-----------------------------------
       var eBrowser = 
       { 
           Msie:0,
           Mozilla:1,
           Safari:2,
           Opera:3,
           Chrome:4
       };
</PRE><PRE>       //-----------------------------------
       // Declare rev enumeration
       //-----------------------------------
       var eRev = 
       { 
           GalleryId:0,
           UniqueId:1,
           Caption:2,
           Width:3,
           Height:4
      };
</PRE><PRE>       //-----------------------------------
       // Declare content enumeration
       //-----------------------------------
       var eContent = 
       { 
           Image:0,
           Iframe:1,
           Flash:2,
           QuickTime:3
       };
</PRE><PRE>       //-----------------------------------
       // Declare caption position enumeration
       //-----------------------------------
       var eCaption = 
       { 
           NoCaption:0,
           ExternalDivBottom:1,
           ExternalDivTop:2
       };
</PRE><PRE>       //-----------------------------------
       // Declare mouse over enumeration
       //-----------------------------------
       var eMouseOver = 
       { 
           None:0,
           Next:1,
           Prev:2
       };
</PRE><PRE>       //-----------------------------------
       // Declare member variables
       //-----------------------------------
       var m_nContentType = eContent.Image;
       var m_AnchorArray = new Array();
       var m_nArrayPos = 0;
       var m_nArraySize = 0;
</PRE><PRE>       var $m_BackgroundDiv = null;
       var $m_Table = null;
       var $m_Content = null;
       var $m_ContentContainer = null;
       var $m_CloseDiv = null;
       var $m_NextDiv = null;
       var $m_PrevDiv = null;
       var $m_PlayDiv = null;
       var $m_CaptionContainer = null;
       var $m_Caption = null;
</PRE><PRE>       var m_strCloseTitle = settings.bShowToolTip ? 'title=&quot;' + settings.strCloseToolTip + '&quot;' : <I>;</I>
       var m_strPrevTitle = settings.bShowToolTip ? 'title=&quot;' + settings.strPrevToolTip + '&quot;' : <I>;</I>
       var m_strNextTitle = settings.bShowToolTip ? 'title=&quot;' + settings.strNextToolTip + '&quot;' : <I>;</I>
       var m_strPlayTitle = settings.bShowToolTip ? 'title=&quot;' + settings.strPlayToolTip + '&quot;' : <I>;</I>
       var m_strPauseTitle = settings.bShowToolTip ? 'title=&quot;' + settings.strPauseToolTip + '&quot;' : <I>;</I></PRE><PRE>       var m_bResizing = false;
       var m_bClosing = false;
       var m_nResizeStep = 0;
       var m_nResizeTimerId = 0;
       var m_bChangingContent = false;
       var m_bSingleItem = false;
       var m_strSource;
       var m_strCaption;
       
       var m_nContentWidth = 0;
       var m_nContentHeight = 0;
       var m_nContentLeft = 0;
       var m_nContentTop = 0;
       var m_nOldContentWidth = m_nContentWidth;
       var m_nOldContentHeight = m_nContentHeight;
       var m_nOldContentLeft = m_nContentLeft;
       var m_nOldContentTop = m_nContentTop;
       var m_nDefaultWidth = 600;
       var m_nDefaultHeight = 400;
       var m_nCaptionHeight = settings.nCaptionFontSz + settings.nCaptionPadding;
       
       var m_bPlaying = false;
       var m_nPlayTimerId = 0;
       var m_nMouseOverPos = 0;
</PRE><PRE>       var m_nBrowser = eBrowser.Opera;
       if( jQuery.browser.mozilla )
           m_nBrowser = eBrowser.Mozilla;
       if( jQuery.browser.msie )
           m_nBrowser = eBrowser.Msie;
       else if( /chrome/.test( navigator.userAgent.toLowerCase() ) )
           m_nBrowser = eBrowser.Chrome;
       else if( jQuery.browser.safari )
           m_nBrowser = eBrowser.Safari;
</PRE><PRE>       var m_bPngHack = ( jQuery.browser.msie &amp;&amp; jQuery.browser.version &lt; 7 );
</PRE><PRE>       //-----------------------------------
       // Initialise gallery
       //-----------------------------------
       this.click(function() 
       {
           if( !$m_Table )
               Initialise( this );
</PRE><PRE>           return false;
       });       
</PRE><PRE>       //--------------------------------------
       // Main initialisation function which registers events and configures lightbox
       //--------------------------------------
       function Initialise( anchor ) 
       {
           // Reset content dimensions
           m_nContentWidth = 200;
           m_nContentHeight = 200;
           m_nContentLeft = GetContentLeft();
           m_nContentTop = GetContentTop();
           StoreOldDimensions();
</PRE><PRE>           // Preload loading image
</PRE><P>	        imgLoad = new Image();
	        imgLoad.src = settings.loadBtnSrc;
</P><PRE>           //-----------------------------------
           // Add lightbox elements
           //-----------------------------------
</PRE><PRE>           // Add transparent background Div
           if( settings.bShowTranspBkgrndDiv )            
           {
</PRE>
                $('body').append('');
<PRE>               $m_BackgroundDiv = $('#wplightbox_bkgrnd');
           }
</PRE><PRE>           // Add table to hold image contents
</PRE>
            var strTable =   '<TABLE id="wplightbox_table" cellpadding="0" cellspacing="0" style="margin: auto 0px; text-align:center; align:center; vertical-align:middle; position:absolute; top:' + ( GetContentTop() - settings.nTableBorderSz ) + '; left:' + ( GetContentLeft() - settings.nTableBorderSz ) + '; width:'+ ( m_nContentWidth + ( settings.nTableBorderSz * 2 ) ) +'; height:'+ ( m_nContentHeight + ( settings.nTableBorderSz * 2 ) ) +'; z-index:' + ( settings.nZIndex + 1 ) + '; display:none;">\
                                    &lt;tbody&gt;\
                                        <TBODY><TR style="height:'+settings.nTableBorderSz+'px;">\
                                            \
                                            \
                                            \
                                        </TR>\
                                        <TR>\
                                            \
                                            <TD id="wplightbox_contentcol" style="background-color:'+settings.strContentCol+';">&lt;img id=&quot;wplightbox_content&quot; src=&quot;' + settings.loadBtnSrc + '&quot; style=&quot;border:1px #000000;&quot;/&gt;</TD>\
                                            \
                                        </TR>\
                                        <TR style="height:'+settings.nTableBorderSz+'px;">\
                                            \
                                            \
                                            \
                                        </TR>\
                                    &lt;/tbody&gt;\
                                </TBODY></TABLE>';
<PRE>           // Append contents table
           $('body').append( strTable );
           $m_Table = $('#wplightbox_table');
           $m_ContentContainer = $('#wplightbox_contentcol');
           $m_Content = $('#wplightbox_content');
</PRE><PRE>           // Add close button
</PRE>
            $('body').append('');
<PRE>           $m_CloseDiv = $('#wplightbox_closediv');
</PRE><PRE>           // Add next and previous buttons
</PRE>
            $('body').append('');
            $('body').append('');
<PRE>           $m_NextDiv = $('#wplightbox_nextdiv');
           $m_PrevDiv = $('#wplightbox_prevdiv');
</PRE><PRE>           // Add play button
           if( settings.bShowPlay )
           {
</PRE>
                $('body').append('');
<PRE>               $m_PlayDiv = $('#wplightbox_playdiv');
           }
</PRE><PRE>           // Initialise captions            
           InitCaption();
</PRE><PRE>           // Register mouse click
           if( settings.bShowTranspBkgrndDiv &amp;&amp; settings.bBkgrndClickable )
           {
               $m_BackgroundDiv.click(function()
               {
                  StartClose();
                  return false;
               });
           }
</PRE><PRE>           //-----------------------------------
           // Bind lightbox events
           //-----------------------------------
    
           // Register resize event 
           $(window).bind('resize', function() 
           {
               m_nContentLeft = GetContentLeft();
               m_nContentTop = GetContentTop();
               
               if( settings.bShowTranspBkgrndDiv )    
                   $m_BackgroundDiv.css({ 'width':GetPageWidth(), 'height':GetPageHeight(), 'overflow':'hidden' });   
</PRE><PRE>               // Remove and re-append contents table - this fixes a bug with 
               // safari where resizing the table causes table border artefacts
               if( $m_CaptionContainer )
               {
                   $m_CaptionContainer.remove();
                   $m_CaptionContainer = null;
               }
</PRE><PRE>               $m_Table.remove();
               $('body').append( strTable );
               $m_Table = $('#wplightbox_table');
               $m_ContentContainer = $('#wplightbox_contentcol');
               $m_Content = $('#wplightbox_content');
               $m_Content.attr({ 'src':m_strSource, 'width':m_nContentWidth, 'height':m_nContentHeight });
               $m_Table.css({ 'left':(m_nContentLeft - settings.nTableBorderSz), 'top':(m_nContentTop - settings.nTableBorderSz), 'width':(m_nContentWidth + (settings.nTableBorderSz * 2)), 'height':(m_nContentHeight + (settings.nTableBorderSz * 2)) }); 
               $m_Table.show();                
</PRE><PRE>               InitCaption();
               SetCaptionText( true );
               SetCaptionPosition(); 
               ShowCaption( HasCaption() );  
</PRE><PRE>               PositionCloseBtn();
               if( settings.bShowPlay )
                   PositionPlayBtn();
               PositionNextAndPrevBtn();
</PRE><PRE>               ShowImg();
           });
</PRE><PRE>           // Split the lightbox tag into its component parts
           var optionArray = anchor.rev.split('~#~');
</PRE><PRE>           // Reset the m_AnchorArray
           if( m_nArraySize &gt; 0 ) 
               m_AnchorArray = [];
           m_nArrayPos = 0;
</PRE><PRE>           // Load single item
           if( optionArray[0] === 'wplightbox' )
           { 
               m_nArraySize = 1;
               m_AnchorArray[ m_nArrayPos ] = anchor;
</PRE><PRE>               if( settings.bAnimateOpenClose )
                   GetPositionFromAnchor( $(anchor), true );
               Load( anchor, true );
               RegisterEvents( true );
               $m_Table.show();
           }  
           else // Load multiple items
           {
               var nCount = 0;
</PRE><PRE>               // Populate the m_AnchorArray
               $('a').each( function(i) 
               { 
                   if( this.rev )
                   {
                       var tmpArray = this.rev.split('~#~');
                       if( optionArray[0] === tmpArray[0] )
                       {
                           // Ignore anchors surrounding maps as these are duplicates
                           // required for a hack to get lightbox working with areas.
                           var map = jQuery( &quot;map&quot;, this );
                           if( map.size() &lt; 1 ) // If can't find map then safe to continue
                           {
                               m_AnchorArray[ nCount ] = this;
                               ++nCount; 
                           }
                       }
                   }          
               });
</PRE><PRE>               m_nArraySize = nCount;
               m_bSingleItem = ( m_nArraySize &lt; 2 );
               
               // Find current anchor position
               for( nCount = 0; nCount &lt; m_nArraySize; ++nCount )
               {
                   if( m_AnchorArray[ nCount ].href === anchor.href
                       &amp;&amp; m_AnchorArray[ nCount ].rev === anchor.rev )
                       m_nArrayPos = nCount;
               }
               
               if( settings.bAnimateOpenClose )
                   GetPositionFromAnchor( $(m_AnchorArray[ m_nArrayPos ]), true );
               Load( m_AnchorArray[ m_nArrayPos ], m_bSingleItem );
               RegisterEvents( m_bSingleItem );
               $m_Table.show();
           }
</PRE><PRE>           if( m_bPngHack )
           {
               $('#ne,#n,#nw,#e,#w,#se,#s,#sw,#cne,#cn,#cnw,#ce,#cw,#cse,#cs,#csw,#wplightbox_closediv,#wplightbox_nextdiv,#wplightbox_prevdiv').PngHack();
</PRE><PRE>               if( settings.bShowPlay &amp;&amp; !m_bSingleItem )
                  $m_PlayDiv.PngHack();
           }
       };
</PRE><PRE>       //--------------------------------------
       // Configures next and previous buttons according to mouse over pos
       //--------------------------------------
       function SetMouseOverPos( nPos ) 
       {
           if( !m_bResizing )
           {
               m_nMouseOverPos = nPos;
</PRE><PRE>               switch( m_nMouseOverPos )
               {
                   case eMouseOver.None:
                       $m_NextDiv.hide();
                       $m_PrevDiv.hide();
                       $m_Content.css({ 'cursor':'default' });
                       break;
</PRE><PRE>                   case eMouseOver.Next:
                       $m_NextDiv.show();
                       $m_PrevDiv.hide();
                       $m_Content.css({ 'cursor':'pointer' });
                       break;
</PRE><PRE>                   case eMouseOver.Prev:
                       $m_NextDiv.hide();
                       $m_PrevDiv.show();
                       $m_Content.css({ 'cursor':'pointer' });
                       break;
               }
           }
       };
</PRE><PRE>       //--------------------------------------
       // Get position from objAnchor
       //--------------------------------------
       function GetPositionFromAnchor( objAnchor, bStart ) 
       {
           var span = objAnchor.parent('span');
           if( span.size() &gt; 0 ) // If artistic text then extract position from grand-parent div
           {
               // This works ok as long as WP exports artistic text using
</PRE>
                //<DIV><DIV class="class"><SPAN>&lt;a&gt;Text&lt;/a&gt;</SPAN></DIV></DIV><PRE>               // If export format changes then update code below.
</PRE><PRE>               var positionDiv = span.parent().parent();
               var divOffset = positionDiv.offset();
               m_nContentLeft = divOffset.left;
               m_nContentTop = divOffset.top;
               m_nContentWidth = positionDiv.width();
               m_nContentHeight = positionDiv.height();
           }
           else
           {
               var img = jQuery( &quot;img&quot;, objAnchor );
               if( img.size() &lt; 1 ) // If can't find image, search siblings
               {
                   var parentDiv = $(objAnchor).parent('div');
                   if( parentDiv.size() &gt; 0 )
                       img = jQuery( 'img', parentDiv );
               }
</PRE><PRE>               if( img.size() &gt; 0 ) // For a standard image, extract position from image coords
               {
                   var imgOffset = img.offset();
                   m_nContentLeft = imgOffset.left;
                   m_nContentTop = imgOffset.top;
                   m_nContentWidth = img.width();
                   m_nContentHeight = img.height();
               }
               else // Else use raw anchor coords
               {
                   var anchorOffset = objAnchor.offset();
                   m_nContentLeft = anchorOffset.left;
                   m_nContentTop = anchorOffset.top;
                   m_nContentWidth = objAnchor.width();
                   m_nContentHeight = objAnchor.height();
               }
           }
</PRE><PRE>           if( bStart )
           {
               $m_Table.css({ 'left':(m_nContentLeft - settings.nTableBorderSz), 'top':(m_nContentTop - settings.nTableBorderSz), 'width':(m_nContentWidth + (settings.nTableBorderSz * 2)), 'height':(m_nContentHeight + (settings.nTableBorderSz * 2)) }); 
           }
       }
</PRE><PRE>       //--------------------------------------
       // Loads content from objAnchor
       //--------------------------------------
       function Load( objAnchor, bSingleItem ) 
       {
           var bItemLoaded = false;
           m_bSingleItem = bSingleItem;
</PRE><PRE>           var objArray = objAnchor.rev.split('~#~');
           if( objArray.length &gt; 1 )
               m_strCaption = objArray[eRev.Caption];
           else
               m_strCaption = <I>;</I></PRE><PRE>           m_strSource = objAnchor.href;
           if( !m_strSource.length )
           {
               // If not a standard &lt;a rev=&quot;wplightbox&quot; href=&quot;url&quot;&gt; 
               // extract image url from the area's href  
               var parentDiv = $(objAnchor).parent('div');
               if( parentDiv.size() &gt; 0 )
               {
                   var area = jQuery( 'area', parentDiv );
                   if( area.size() &gt; 0 )
                       m_strSource = area[0].href;
               }
           }
</PRE><PRE>           SetContentToImage();
</PRE><PRE>           var urlType = m_strSource.toLowerCase().slice( m_strSource.lastIndexOf( '.' ) );
           m_nContentType = eContent.Iframe; // Use Iframe as default content
</PRE><PRE>           switch( urlType )
           {
               case '.jpg':
               case '.jpeg':
               case '.png':
               case '.gif':
               case '.bmp':
                   m_nContentType = eContent.Image;
                   break;
               case '.swf':
                   m_nContentType = eContent.Flash;
                   break;
               case '.mov':
                   m_nContentType = eContent.QuickTime;
                   break;
           }
</PRE><PRE>           if( m_nContentType != eContent.Image )
               GetRevDimensions( objAnchor, m_nContentType );
</PRE><PRE>           HideControls();
</PRE><PRE>           if( m_nContentType == eContent.Image )	
           {
               var image = new Image();
               image.onload = function() 
               { 
                   bItemLoaded = true;
                   image.onload = null;
</PRE><PRE>                   StoreOldDimensions();
</PRE><PRE>                   m_nContentWidth = image.width;
                   m_nContentHeight = image.height;
</PRE><PRE>                   if( settings.nCaptionType == eCaption.ExternalDivTop ) 
                   {
                       SetCaptionText( true );
                       SetCaptionPosition();
                   }
</PRE><PRE>                   m_nContentLeft = GetContentLeft();
                   m_nContentTop = GetContentTop();
</PRE><PRE>                   StartResize();
               };
               image.src = m_strSource;
           }
           else
           {
               StartResize();
           }
       };
</PRE><PRE>       //--------------------------------------
       // Displays new image
       //--------------------------------------
       function ShowImg()
       {
           StopResize();    
</PRE><PRE>           switch( m_nContentType )
           {
               case eContent.Image:
                   $m_ContentContainer.append( '&lt;img id=&quot;wplightbox_content&quot; src=&quot;' + settings.blankSrc + '&quot; style=&quot;border:1px #000000;&quot;/&gt;' );
                   break;
</PRE><PRE>               case eContent.Iframe:
                   $m_ContentContainer.append( '&lt;iframe id=&quot;wplightbox_content&quot; src=&quot;' + settings.blankSrc + '&quot; frameborder=0 style=&quot;border:1px #000000;&quot;/&gt;' );
                   break;
</PRE><PRE>               case eContent.QuickTime:
                   {
</PRE>
                        var strObject = '<DIV id="wplightbox_content" style="z-index:' + ( settings.nZIndex + 1 ) + ';">&lt;object classid=&quot;CLSID:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B&quot; ';
<PRE>                       strObject += 'codebase=&quot;<A href="http://www.apple.com/qtactivex/qtplugin.cab" class="external free" rel="nofollow">http://www.apple.com/qtactivex/qtplugin.cab</A>&quot; ';
                       strObject += 'standby=&quot;Loading Player...&quot; ';
                       strObject += 'type=&quot;application/x-oleobject&quot; ';
                       strObject += 'id=&quot;wplightbox_quicktime&quot; ';
</PRE><P>			            strObject += 'width=&quot;' + m_nContentWidth + 'px&quot; ';
			            strObject += 'height=&quot;' + m_nContentHeight + 'px&quot;&gt;';
</P><PRE> 			            strObject += '&lt;param name=&quot;src&quot; value=&quot;' + m_strSource + '&quot;/&gt;'
 			            strObject += '&lt;param name=&quot;autoplay&quot; value=&quot;true&quot;/&gt;';
 			            strObject += '&lt;param name=&quot;loop&quot; value=&quot;true&quot;/&gt;';
 			            strObject += '&lt;embed src=&quot;' + m_strSource + '&quot; ';
                       strObject += 'autoplay=&quot;true&quot; '; 
                       strObject += 'loop=&quot;true&quot; '; 
                       strObject += 'type=&quot;video/quicktime&quot; ';
                       strObject += 'pluginspage=&quot;<A href="http://www.apple.com/quicktime/" class="external free" rel="nofollow">http://www.apple.com/quicktime/</A>&quot; '; 
                       strObject += 'width=&quot;' + m_nContentWidth + 'px&quot; ';
 			            strObject += 'height=&quot;' + m_nContentHeight + 'px&quot;&gt;&lt;/embed&gt;';
</PRE>
                        strObject += '&lt;/object&gt;</DIV>';
<PRE>                       $m_ContentContainer.append( strObject );
                       StopPlayTimer();
                   }
                   break;
</PRE><PRE>               case eContent.Flash:
                   {
                       if( DetectFlashVer( 8, 0, 0 ) )
                       {
</PRE>
                            var strFlashObject = '<DIV id="wplightbox_content">&lt;object classid=&quot;clsid:d27cdb6e-ae6d-11cf-96b8-444553540000&quot; ';
<PRE>                           strFlashObject += 'codebase=&quot;<A href="http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab" class="external free" rel="nofollow">http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab</A>&quot; ';
                           strFlashObject += 'id=&quot;wplightbox_flashobj&quot; ';
                           strFlashObject += 'width=&quot;' + m_nContentWidth + 'px&quot; ';
                           strFlashObject += 'height=&quot;' + m_nContentHeight + 'px&quot;&gt;';
 			                strFlashObject += '&lt;param name=&quot;movie&quot; value=&quot;' + m_strSource + '&quot;/&gt;'
 			                strFlashObject += '&lt;param name=&quot;quality&quot; value=&quot;high&quot;/&gt;';
 			                strFlashObject += '&lt;embed src=&quot;' + m_strSource + '&quot; ';
                           strFlashObject += 'quality=&quot;high&quot; '; 
                           strFlashObject += 'type=&quot;application/x-shockwave-flash&quot; ';
                           strFlashObject += 'pluginspage=&quot;<A href="http://www.macromedia.com/go/getflashplayer" class="external free" rel="nofollow">http://www.macromedia.com/go/getflashplayer</A>&quot; ';
                           strFlashObject += 'width=&quot;' + m_nContentWidth + 'px&quot; ';
                           strFlashObject += 'height=&quot;' + m_nContentHeight + 'px&quot;&gt;&lt;/embed&gt;';
</PRE>
                            strFlashObject += '&lt;/object&gt;</DIV>';
<PRE>                          $m_ContentContainer.append( strFlashObject );
                       }
                       else
                       {
                           $m_ContentContainer.append( '&lt;div id=&quot;wplightbox_content&quot; frameborder=0 style=&quot;border:1px #000000;&quot;/&gt;An old version of the Flash plugin was detected. <STRONG>&lt;a href=&quot;<A href="http://www.macromedia.com/go/getflash/" class="external free" rel="nofollow">http://www.macromedia.com/go/getflash/</A>&quot;&gt;Please upgrade your Flash plugin.&lt;\/a&gt;&lt;\/strong&gt;&lt;\/div&gt;' );
                       }
                       StopPlayTimer();
                   }
                   break;
           }
</STRONG></PRE><PRE>           $m_Content.remove();
           $m_Content = $('#wplightbox_content');
           $m_Content.attr({ 'src':m_strSource });
           
           $m_Content.animate( { opacity:1.0 }, 10, function()
           { 
               $m_Content.attr({ 'width':m_nContentWidth, 'height':m_nContentHeight }); 
               $m_ContentContainer.animate( { 'opacity':1.0, '-moz-opacity':1.0, 'filter:alpha:opacity':100 }, 100, function() 
               { 
                   m_bChangingContent = false; 
</PRE><PRE>                   PositionCloseBtn();
                   $m_CloseDiv.show();
</PRE><PRE>                   if( !m_bSingleItem )
                   {
                       if( settings.bShowPlay )
                       {
                           PositionPlayBtn();
                           $m_PlayDiv.show();
                       }
</PRE><PRE>                       PositionNextAndPrevBtn();
                       $m_NextDiv.show();
                       $m_PrevDiv.show();
                   }
               });
           });
</PRE><PRE>           ShowCaption( HasCaption() )
       };

       //--------------------------------------
       // Extracts dimensions from 'rev' attribute of anchor
       //--------------------------------------
       function GetRevDimensions( objAnchor, nContentType )
       {
           if( objAnchor )
           {
               StoreOldDimensions();
</PRE><PRE>               var revArray = objAnchor.rev.split('~#~');
</PRE><PRE>               // Read in rev width if it has been set
               if( revArray[eRev.Width] )
                   m_nContentWidth = eval( revArray[eRev.Width] );
               else
                   m_nContentWidth = m_nDefaultWidth;
</PRE><PRE>               // Read in rev height if it has been set
               if( revArray[eRev.Height] )
                   m_nContentHeight = eval( revArray[eRev.Height] );
               else
                   m_nContentHeight = m_nDefaultHeight;
</PRE><PRE>               // Update content position relative to new size
               m_nContentLeft = GetContentLeft();
               m_nContentTop = GetContentTop();
           }
       };
   
       //--------------------------------------
       // Start resize animation timer
       //--------------------------------------
       function StartResize()
       {
           if( !m_bResizing )
           {
               m_bResizing = true;
               m_nResizeStep = 0;
               m_nResizeTimerId = setInterval( OnResize, 12 );
           }
       };
</PRE><PRE>       //--------------------------------------
       // Switches main content to an image
       //--------------------------------------
       function SetContentToImage()
       {
           if( m_nContentType != eContent.Image )
           {
               $m_Content.remove();
               $m_ContentContainer.append('&lt;img id=&quot;wplightbox_content&quot; src=&quot;' + settings.loadBtnSrc + '&quot; style=&quot;width=' + settings.nLoadBtnSz + 'px; height=' + settings.nLoadBtnSz + 'px; border:1px #000000;&quot;/&gt;');
               $m_Content = $('#wplightbox_content');
           }
       };
</PRE><PRE>       //--------------------------------------
       // Stop resize animation timer
       //--------------------------------------
       function StopResize()
       {
           if( m_bResizing )
           {
              m_bResizing = false;
              clearInterval( m_nResizeTimerId );
           }  
       };
</PRE><PRE>       //--------------------------------------
       // Update resize animation
       //--------------------------------------
       function OnResize()
       {
           if( !settings.bAnimateOpenClose )
               m_nResizeStep = 14;
</PRE><PRE>           m_nResizeStep += 1;
</PRE><P>	        var nProgress = ( m_nResizeStep / 15 );   
			var nTop	= Math.round( m_nOldContentTop	+ ( m_nContentTop - m_nOldContentTop ) * nProgress );
			var nLeft	= Math.round( m_nOldContentLeft + ( m_nContentLeft - m_nOldContentLeft ) * nProgress );
</P><PRE>           var nWidth	= Math.round( m_nOldContentWidth + ( m_nContentWidth - m_nOldContentWidth ) * nProgress );
           var nHeight = Math.round( m_nOldContentHeight + ( m_nContentHeight - m_nOldContentHeight ) * nProgress );
           
           var nTableLeft = nLeft - settings.nTableBorderSz;
           var nTableTop = nTop - settings.nTableBorderSz;
           var nTableWidth = nWidth + ( settings.nTableBorderSz * 2 );
           var nTableHeight = nHeight + ( settings.nTableBorderSz * 2 );
</PRE><PRE>           $m_Table.css({ 'left':nTableLeft, 'top':nTableTop, 'width':nTableWidth, 'height':nTableHeight }); 
</PRE><PRE>           if( m_nResizeStep &gt;= 15 )
           {
               if( m_bClosing )                
                   Close();
               else
                   ShowImg();
           }
       };
</PRE><PRE>       //--------------------------------------
       // Starts play timer
       //--------------------------------------
       function StartPlayTimer()
       {
           if( !m_bPlaying )
           {
               m_bPlaying = true;
               
               if( settings.bShowToolTip )
                   $m_PlayDiv.attr({ 'title':settings.strPauseToolTip });
</PRE><PRE>               if( m_bPngHack )
                   $m_PlayDiv.ImgPngHack( settings.pauseBtnSrc );
               else
                   $m_PlayDiv.css({ 'backgroundImage':'url(' + settings.pauseBtnSrc + ')' });
</PRE><PRE>               OnPlayTimer();
               m_nPlayTimerId = setInterval( OnPlayTimer, settings.nPlayPeriod );
           }
       };
</PRE><PRE>       //--------------------------------------
       // Stop play timer
       //--------------------------------------
       function StopPlayTimer()
       {
           if( m_bPlaying )
           {
               m_bPlaying = false;
               
               if( settings.bShowToolTip )
                   $m_PlayDiv.attr({ 'title':settings.strPlayToolTip });
</PRE><PRE>               if( m_bPngHack )
                   $m_PlayDiv.ImgPngHack( settings.playBtnSrc );
               else
                   $m_PlayDiv.css({ 'backgroundImage':'url(' + settings.playBtnSrc + ')' });
</PRE><PRE>               clearInterval( m_nPlayTimerId );
           }  
       };
</PRE><PRE>       //--------------------------------------
       // Updates play
       //--------------------------------------
       function OnPlayTimer()
       {
           Next( false );
       };
</PRE><PRE>       //--------------------------------------
       // Close wp lightbox
       //--------------------------------------
       function HideControls() 
       {
           $m_Content.attr({ 'src':settings.loadBtnSrc, 'width':settings.nLoadBtnSz, 'height':settings.nLoadBtnSz });
           $m_ContentContainer.css({ 'opacity':settings.nContentOpacity, '-moz-opacity':settings.nContentOpacity, 'filter:alpha:opacity':( settings.nContentOpacity * 100 ) });
           $m_CloseDiv.hide();
</PRE><PRE>           ShowCaption( false );
           if( !m_bSingleItem )
           {
               SetMouseOverPos( eMouseOver.None );
               if( settings.bShowPlay )
                   $m_PlayDiv.hide();
           }
       }
</PRE><PRE>       //--------------------------------------
       // Close wp lightbox
       //--------------------------------------
       function StartClose() 
       {
           if( !m_bClosing )
           {
               m_bClosing = true;
</PRE><PRE>               if( settings.bAnimateOpenClose )
               {
                   HideControls();
                   StoreOldDimensions();
                   SetContentToImage();
                   GetPositionFromAnchor( $(m_AnchorArray[ m_nArrayPos ]), false );
                   StartResize();
               }
               else
               {
                   Close();
               }
           }
       }
</PRE><PRE>       //--------------------------------------
       // Close wp lightbox
       //--------------------------------------
       function Close() 
       {
           if( settings.bAnimateOpenClose )
               StopResize();             
           m_bClosing = false; 
</PRE><PRE>           $(document).unbind('keyup');
           $(window).unbind('resize');
</PRE><PRE>           $(&quot;#wplightbox_bkgrnd&quot;).unbind(&quot;click&quot;);
           $(&quot;#wplightbox_close&quot;).unbind(&quot;click&quot;);
</PRE><PRE>           if( $m_CaptionContainer )
           {
               $m_CaptionContainer.remove();
               $m_CaptionContainer = null;
           }
</PRE><PRE>           $m_Table.remove();
           $m_CloseDiv.remove();
</PRE><PRE>           if( !m_bSingleItem )
           {
               $(&quot;#wplightbox_next&quot;).unbind(&quot;click&quot;);
               $(&quot;#wplightbox_prev&quot;).unbind(&quot;click&quot;);
               $m_NextDiv.remove();
               $m_PrevDiv.remove();
               
               if( settings.bShowPlay )
               {                   
                   StopPlayTimer();
                   $m_PlayDiv.unbind(&quot;click&quot;);
                   $m_PlayDiv.remove();
               }
           }
</PRE><PRE>           if( settings.bShowTranspBkgrndDiv )
               $m_BackgroundDiv.animate({ 'opacity':0.0, '-moz-opacity':0.0, 'filter:alpha:opacity':0 }, 300, function() { $('#wplightbox_bkgrnd').remove(); m_nContentWidth = 200; m_nContentHeight = 200; });
       
           $m_Table = null;
           $m_CloseDiv = null;
           $m_NextDiv = null;
           $m_PrevDiv = null;
           $m_PlayDiv = null;
           $m_BackgroundDiv = null;
       };
       
       //--------------------------------------
       // Move to next item
       //--------------------------------------
       function Next( bStopPlayTimer ) 
       {
           if( !m_bChangingContent )
           {
               if( bStopPlayTimer )
                   StopPlayTimer();
</PRE><PRE>               m_bChangingContent = true;
               ++m_nArrayPos;
               
               if( m_nArrayPos &gt;= m_nArraySize )
                   m_nArrayPos = 0;
                   
               Load( m_AnchorArray[ m_nArrayPos ], false );     
           }
       };
</PRE><PRE>       //--------------------------------------
       // Move to previous item
       //--------------------------------------
       function Prev() 
       {
           if( !m_bChangingContent )
           {
               StopPlayTimer();
               
               m_bChangingContent = true;
               --m_nArrayPos;
               
               if( m_nArrayPos &lt; 0 )
                   m_nArrayPos = m_nArraySize - 1;
     
               Load( m_AnchorArray[ m_nArrayPos ], false );   
           }  
       };
       
       //--------------------------------------
       // Register keyboard, mouse hover and mouse click events
       //--------------------------------------
       function RegisterEvents( bSingleItem )
       {
           $(document).bind('keyup', function(e) 
           { 
</PRE><P>		        if(e == null) keycode = event.keyCode; // IE			        
</P><PRE>               else keycode = e.which;  // Mozilla
</PRE><P>			    if( bSingleItem )
			    {
				    if( keycode == 27 )
			             StartClose(); 
			    }
			    else
			    {
			        switch( keycode )   
			        {
			             case 27:   
			                 StartClose();   
			                 break;
</P><P>			             case 190: 
			             case 39:   
			                 Next( true );    
			                 break; 
</P><P>			             case 188: 
			             case 37:   
			                 Prev();    
			                 break;
			        } 
			    }
</P><PRE>           });
          
           $m_CloseDiv.click( function(){ StartClose(); } );
           $m_CloseDiv.hover(function() { if( m_bPngHack ) $(this).ImgPngHack( settings.closeOverBtnSrc ); else $(this).css({ 'backgroundImage':'url(' + settings.closeOverBtnSrc + ')' }); }, function() { if( m_bPngHack ) $(this).ImgPngHack( settings.closeBtnSrc ); else $(this).css({ 'backgroundImage':'url(' + settings.closeBtnSrc + ')' }); });
           
           if( !bSingleItem )
           {
               if( settings.bShowPlay &amp;&amp; !m_bSingleItem )
               {
                   $m_PlayDiv.click( function()
                   { 
                       if( !m_bPlaying )
                           StartPlayTimer();
                       else
                           StopPlayTimer();
                   });
               }
</PRE><PRE>               $m_PrevDiv.click( function(){ Prev(); } );
               $m_NextDiv.click( function(){ Next( true ); } );
               $m_PrevDiv.hover(function() { if( m_bPngHack ) $(this).ImgPngHack( settings.prevOverBtnSrc ); else $(this).css({ 'backgroundImage':'url(' + settings.prevOverBtnSrc + ')' }); }, function() { if( m_bPngHack ) $(this).ImgPngHack( settings.prevBtnSrc ); else $(this).css({ 'backgroundImage':'url(' + settings.prevBtnSrc + ')' }); });
               $m_NextDiv.hover(function() { if( m_bPngHack ) $(this).ImgPngHack( settings.nextOverBtnSrc ); else $(this).css({ 'backgroundImage':'url(' + settings.nextOverBtnSrc + ')' }); }, function() { if( m_bPngHack ) $(this).ImgPngHack( settings.nextBtnSrc ); else $(this).css({ 'backgroundImage':'url(' + settings.nextBtnSrc + ')' }); });
   
               if( settings.bShowPlay )
               {
                   $m_PlayDiv.hover(function() 
                   { 
                       if( m_bPlaying ) { if( m_bPngHack ) $(this).ImgPngHack( settings.pauseOverBtnSrc ); else $(this).css({ 'backgroundImage':'url(' + settings.pauseOverBtnSrc + ')' }); }
                       else { if( m_bPngHack ) $(this).ImgPngHack( settings.playOverBtnSrc ); else $(this).css({ 'backgroundImage':'url(' + settings.playOverBtnSrc + ')' }); }
                   }, 
                   function() 
                   { 
                       if( m_bPlaying ) { if( m_bPngHack ) $(this).ImgPngHack( settings.pauseBtnSrc ); else $(this).css({ 'backgroundImage':'url(' + settings.pauseBtnSrc + ')' }); }
                       else { if( m_bPngHack ) $(this).ImgPngHack( settings.playBtnSrc ); else $(this).css({ 'backgroundImage':'url(' + settings.playBtnSrc + ')' }); }
                   });
               }
           }
       };
</PRE><PRE>       //--------------------------------------
       // Positions next and previous buttons
       //--------------------------------------
       function PositionNextAndPrevBtn() 
       {
           var nTopPos = m_nContentTop + ( m_nContentHeight / 2 ) - ( settings.nNextBtnSz / 2 );
           $m_NextDiv.css({ 'left':( m_nContentLeft + m_nContentWidth - 3 + settings.nBtnOffset ), 'top': nTopPos }); 
           $m_PrevDiv.css({ 'left':( m_nContentLeft - settings.nNextBtnSz - settings.nBtnOffset ), 'top': nTopPos }); 
      };   
</PRE><PRE>       //--------------------------------------
       // Positions close button
       //--------------------------------------
       function PositionCloseBtn() 
       {
           var nTop = m_nContentTop - settings.nNextBtnSz - settings.nBtnOffset;           
</PRE><PRE>           if( settings.nCaptionType == eCaption.ExternalDivTop &amp;&amp; HasCaption() )
               nTop -= $m_CaptionContainer.height();
</PRE><PRE>           $m_CloseDiv.css({ 'left':( m_nContentLeft + m_nContentWidth - settings.nNextBtnSz ), 'top':nTop }); 
       }
</PRE><PRE>       //--------------------------------------
       // Positions play button
       //--------------------------------------
       function PositionPlayBtn() 
       {
           $m_PlayDiv.css({ 'left':( m_nContentLeft + m_nContentWidth - ( settings.nPlayBtnSz + settings.nPlayBtnOffset ) ), 'top':( m_nContentTop + m_nContentHeight - ( settings.nPlayBtnSz + settings.nPlayBtnOffset ) ) }); 
       };
</PRE><PRE>       //--------------------------------------
       // Gets left position
       //--------------------------------------
       function GetContentLeft() 
       {
           return Math.max( 0, ( $(window).width() - m_nContentWidth ) / 2 );
       };   
</PRE><PRE>       //--------------------------------------
       // Gets top position
       //--------------------------------------
       function GetContentTop() 
       {
           if( settings.nCaptionType == eCaption.ExternalDivTop )
           {
               if( $m_CaptionContainer &amp;&amp; HasCaption() )
               {
                   var nCaptionHt = GetCaptionHeight();
                   return Math.max( ( settings.nNextBtnSz + settings.nBtnOffset + GetCaptionHeight() ), ( GetPageScrollY() + ( Math.min( ( $(window).height() / 10 ) + nCaptionHt, ( ( $(window).height() - ( m_nContentHeight + 20 - nCaptionHt ) ) / 2 ) ) ) ) );
               }
               else
                   return Math.max( ( settings.nNextBtnSz + settings.nBtnOffset ), ( GetPageScrollY() + ( Math.min( ( $(window).height() / 10 ) + ( ( settings.nTableBorderSz * 2 ) + m_nCaptionHeight ), ( ( $(window).height() - ( m_nContentHeight + 20 + ( ( settings.nTableBorderSz * 2 ) + m_nCaptionHeight ) ) ) / 2 ) ) ) ) );
           }
           else
           {
               return Math.max( ( settings.nNextBtnSz + settings.nBtnOffset ), ( GetPageScrollY() + ( Math.min( ( $(window).height() / 10 ), ( ( $(window).height() - ( m_nContentHeight + 20 ) ) / 2 ) ) ) ) );
           }
       };
</PRE><PRE>       //--------------------------------------
       // Gets page width
       //--------------------------------------
       function GetPageWidth() 
       {
           var nPageWidth = ( m_nBrowser == eBrowser.Msie ) ? $(window).width() : Math.max( $(window).width(), $(document).width() ); 
           nPageWidth = Math.max( nPageWidth, ( m_nContentWidth + 40 ) );
</PRE><PRE>           return nPageWidth;
       };
</PRE><PRE>       //--------------------------------------
       // Gets page height
       //--------------------------------------
       function GetPageHeight() 
       {
           var nPageHeight = ( m_nBrowser == eBrowser.Msie ) ? $(document).height() : Math.max( $(window).height(), $(document).height() ); 
           nPageHeight = Math.max( nPageHeight, ( GetContentTop() + m_nContentHeight + 100 ) );
</PRE><PRE>           return nPageHeight;
       };
</PRE><PRE>       //--------------------------------------
       // Gets page scroll values
       //--------------------------------------
       function GetPageScrollY() 
       {
           var yScroll = 0;
</PRE><PRE>           if( window.pageYOffset )
               yScroll = window.pageYOffset;
           else if( document.body &amp;&amp; document.body.scrollTop )
               yScroll = document.body.scrollTop;
           else if( document.documentElement &amp;&amp; document.documentElement.scrollTop )
               yScroll = document.documentElement.scrollTop;
           else if( window.scrollY )
               yScroll = window.scrollY;
</PRE><P>			return yScroll;
</P><PRE>       };
</PRE><PRE>       //--------------------------------------
       // Records old content dimensions
       //--------------------------------------
       function StoreOldDimensions() 
       {
           m_nOldContentWidth = m_nContentWidth;
           m_nOldContentHeight = m_nContentHeight;
           m_nOldContentTop = m_nContentTop;
           m_nOldContentLeft = m_nContentLeft;
       };
</PRE><PRE>       //--------------------------------------
       // Performs png hack
       //--------------------------------------
</PRE><P>		$.fn.PngHack = function()
</P><PRE>       {
</PRE><P>			this.each(function () 
</P><PRE>           {
</PRE><P>				var img = $(this).css('backgroundImage');
				if( img.match(/^url\((.*\.png)\)$/i) ) 
</P><PRE>               {
</PRE><P>					img = RegExp.$1;
					$(this).css(
</P><PRE>                   {
</PRE><P>						'backgroundImage': 'none',
						'filter': &quot;progid:DXImageTransform.Microsoft.AlphaImageLoader(src='&quot; + img + &quot;', sizingMethod=&quot; + ($(this).css('background-repeat') == 'no-repeat' ? 'crop' : 'scale') + &quot;)&quot;
					});
				}
			});
</P><PRE>       };
</PRE><PRE>       //--------------------------------------
       // Performs png hack
       //--------------------------------------
</PRE><P>		$.fn.ImgPngHack = function( strImgUrl )
</P><PRE>       {
           $(this).css(
           {
</PRE><P>				'backgroundImage': 'none',
				'filter': &quot;progid:DXImageTransform.Microsoft.AlphaImageLoader( src='&quot; + strImgUrl + &quot;' )&quot;
			});
</P><PRE>       };
</PRE><PRE>       //--------------------------------------
       // Initialise captions
       //--------------------------------------
       function InitCaption() 
       {
           // If caption container already initialised then don't continue
           if( $m_CaptionContainer )
               return;
</PRE><PRE>           switch( settings.nCaptionType )
           {
               case eCaption.ExternalDivBottom:
               case eCaption.ExternalDivTop:
               {
</PRE>
                    var strCaptionTable = '<TABLE id="wplightbox_captiontable" cellpadding="0" cellspacing="0" style="margin: auto 0px; text-align:center; align:center; vertical-align:middle; position:absolute; top:' + (GetContentTop() + (settings.nTableBorderSz * 2) + m_nContentHeight) + 'px; left:' + (GetContentLeft() - settings.nTableBorderSz) + 'px; width:' + (m_nContentWidth + (settings.nTableBorderSz * 2)) + 'px; height:' + m_nCaptionHeight + 'px; z-index:' + (settings.nZIndex + 3) + ';">\
                                            &lt;tbody&gt;\
                                                <TBODY><TR style="height:'+settings.nTableBorderSz+'px;">\
                                                    \
                                                    \
                                                    \
                                                </TR>\
                                                <TR style="height:' + m_nCaptionHeight + 'px;">\
                                                    \
                                                    <TD id="wplightbox_captioncol" style="background-color:' + settings.strCaptionCol + '; padding:' + settings.nCaptionPadding + 'px;"><SPAN id="wplightbox_caption" style="font-family:' + settings.strCaptionFontType + '; color:' + settings.strCaptionFontCol + '; font-size:' + settings.nCaptionFontSz + 'px; font-weight:normal;">Caption</SPAN></TD>\
                                                    \
                                                </TR>\
                                                <TR style="height:'+settings.nTableBorderSz+'px;">\
                                                    \
                                                    \
                                                    \
                                                </TR>\
                                            &lt;/tbody&gt;\
                                        </TBODY></TABLE>';
<PRE>                   // Add caption table
                   $('body').append( strCaptionTable );
                   $m_CaptionContainer = $('#wplightbox_captiontable');
                   $m_Caption = $('#wplightbox_caption');
</PRE><PRE>                   $('#wplightbox_captioncol').css({ 'opacity':settings.nCaptionOpacity, '-moz-opacity':settings.nCaptionOpacity, 'filter:alpha:opacity':( settings.nCaptionOpacity * 100 ) });
               }
               break;
           };
       }
</PRE><PRE>       //--------------------------------------
       // Sets caption position
       //--------------------------------------
       function SetCaptionPosition() 
       {
           switch( settings.nCaptionType )
           {
               case eCaption.ExternalDivBottom:
                   $m_CaptionContainer.css({ 'left':(m_nContentLeft - settings.nTableBorderSz), 'top':( m_nContentTop + settings.nCaptionOffset + m_nContentHeight ), 'width':(m_nContentWidth + (settings.nTableBorderSz * 2)) }); 
                   break;
               
               case eCaption.ExternalDivTop:
                   $m_CaptionContainer.css({ 'left':(m_nContentLeft - settings.nTableBorderSz), 'width':(m_nContentWidth + (settings.nTableBorderSz * 2)) }); 
                   var nContentTop = GetContentTop();
                   var nCaptionHeight = GetCaptionHeight();
                   $m_CaptionContainer.css({ 'top':( m_nContentTop - ( settings.nCaptionOffset + nCaptionHeight ) ) }); 
                   break;
           };
       }
</PRE><PRE>       //--------------------------------------
       // Returns true if content item has a caption
       //--------------------------------------
       function HasCaption()
       {
           if( settings.nCaptionType == eCaption.NoCaption )
               return false;
           if( m_strCaption &amp;&amp; m_strCaption.length &gt; 0 )
               return true;
           if( settings.bCaptionCount &amp;&amp; !m_bSingleItem )
               return true;
           return false;
       }
</PRE><PRE>       //--------------------------------------
       // Sets caption position
       //--------------------------------------
       function SetCaptionText( bShow )
       {
           if( $m_Caption )
           {
               if( bShow ) // Apply caption text
               {
                   if( settings.bCaptionCount &amp;&amp; !m_bSingleItem )
                   {
                       var nImagePos = m_nArrayPos + 1;
                       var strCount = nImagePos + '/' +  m_nArraySize + ' ';
                       $m_Caption.text( strCount +  m_strCaption );  
                   }
                   else
                   {
                       $m_Caption.text( m_strCaption );  
                   }
               }
               else // Else clear caption text
               {
                   $m_Caption.text( <I> );  </I>
               }
           }
       }
</PRE><PRE>       //--------------------------------------
       // Displays or hides lightbox caption
       //--------------------------------------
       function ShowCaption( bShow )
       {
           switch( settings.nCaptionType )
           {
               case eCaption.ExternalDivBottom:
               case eCaption.ExternalDivTop:
                   {
                       if( $m_CaptionContainer )
                       {
                           if( bShow )
                           {
                               SetCaptionText( true );              
                               SetCaptionPosition();  
                               $m_CaptionContainer.show();
                           }
                           else
                           {
                               SetCaptionText( false );              
                               $m_CaptionContainer.hide();
                           }
                       }
                   }
                   break;
           };
       }
</PRE><PRE>       //--------------------------------------
       // Returns caption height
       //--------------------------------------
       function GetCaptionHeight()
       {
           if( m_nBrowser == eBrowser.Msie )
           {
               return $m_CaptionContainer.height();
           }
           else
           {
               // This fixes a bug in the remaining browsers where the height of the 
               // caption container is only correct when the caption is displayed.
               $m_CaptionContainer.show();
               var nCaptionHeight = $m_CaptionContainer.height();
               $m_CaptionContainer.hide();
               return nCaptionHeight;
           }
       }
   };
</PRE><P>})(jQuery);</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2012.igem.org/Team:USTC-China/temp5">http://2012.igem.org/Team:USTC-China/temp5</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:USTC-China/temp5" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:USTC-China/temp5" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:USTC-China/temp5&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:USTC-China/temp5&amp;oldid=38196" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2012.igem.org:Privacy_policy" title="2012.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2012.igem.org:General_disclaimer" title="2012.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>