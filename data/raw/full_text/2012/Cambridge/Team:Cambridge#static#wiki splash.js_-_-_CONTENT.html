<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Cambridge_static_wiki_splash_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Cambridge/static/wiki_splash.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Cambridge/static/wiki_splash.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Cambridge/static/wiki_splash.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Cambridge/static/wiki_splash.js&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Cambridge/static/wiki_splash.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Cambridge/static/wiki splash.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2012.igem.org</H3><P>/*
</P><PRE>This file is part of the cambridge 2011 igem teams wiki. nothing is guaranteed.
</PRE><PRE>DO WHAT THE F*CK YOU WANT TO PUBLIC LICENSE
                   Version 2, December 2004
</PRE><PRE>Copyright (C) 2011 Haydn King hjking734@gmail.com
</PRE><PRE>           DO WHAT THE F*CK YOU WANT TO PUBLIC LICENSE
  TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
</PRE><PRE> 0. You just DO WHAT THE F*CK YOU WANT TO. 
</PRE><UL><LI>/
</LI></UL><P>//current area/subarea
var area = 'overview';
var subarea = 'home';
//the url that's loaded
var the_url = window.location.pathname;//the url that's being displayed
//the interval
var int;
</P><P>var set_hash = function(path)
{//set the hash to the path given
</P><PRE> int = window.clearInterval(int);
 
 //turn the path into a presentable hash
 var hash = path.replace(/http:\/\/2011.igem.org/i, <I>).replace(/\/Team:Cambridge/i, </I>);
 
 window.location.hash = hash;
 the_url = get_hash(false);
 
 int = setInterval('check_hash();', 500);
</PRE><P>}
</P><P>var get_hash = function(absolute)
{
</P><PRE> var hash = window.location.hash.substr(1);
 if(!absolute || (absolute == undefined))
   return &quot;/Team:Cambridge&quot; + hash;
 return &quot;<A href="https://2011.igem.org/Team:Cambridge" class="external free" rel="nofollow">https://2011.igem.org/Team:Cambridge</A>&quot; + hash;
</PRE><P>}
</P><P>var check_hash = function()
{//check if the hash has changed (e.g. back button press)
</P><PRE> if(the_url != get_hash(false))
 {
   int = clearInterval(int);//pause
   if((window.location.hash.charAt(1) == '/') || (window.location.hash == <I>))</I>
     load_url(get_hash(false));
   int = setInterval('check_hash();', 500);
 }
</PRE><P>}
</P><P>//update the edit, login and logout links after page change
var update_links = function(current_url)
{
</P><PRE> $('#edit-link').attr('href', current_url + '?action=edit');
 $('#edit-intro-link').attr('href', '/Team:Cambridge/desc/' + area + '/' + subarea + '?action=edit');
 $('#login-link' ).attr('href', '/wiki/index.php?title=Special:UserLogin&amp;returnto=' + current_url);
 $('#logout-link').attr('href', '/wiki/index.php?title=Special:UserLogout&amp;returnto=' + current_url);
</PRE><P>}
</P><P>var is_internal = function(obj)
{
</P><PRE> if($(obj).hasClass('cam-external')) return false;
 return /\/Team:Cambridge/i.test($(obj).attr(&quot;href&quot;));
</PRE><P>}
var is_external = function(obj) { return !is_internal(obj);}
</P><P>var areas = [ 
</P><PRE> [/\/Team:Cambridge\/project/i, 'project',],
 [/\/Team:Cambridge\/(experiments|constructs|protocols|safety|labwork)/i, 'labwork',],
 [/\/Team:Cambridge\/society/i, 'society',],
 [/\/Team:Cambridge\/team/i, 'team',],
 [/\/Team:Cambridge/i, 'overview'],
 [/./i, 'overview'],
</PRE><P>];
</P><P>var subareas = {
</P><PRE> 'overview': [
   [/\/Team:Cambridge\/Media/i, 'media'],
   [/\/Team:Cambridge\/Parts/i, 'parts'],
   [/\/Team:Cambridge\/Blog/i, 'blog'],
   [/./i, 'home'],
</PRE><P>],
</P><PRE> 'project':  [
   [/\/Team:Cambridge\/Project\/Background/i, 'background'],
   [/\/Team:Cambridge\/Project\/Microscopy/i, 'microscopy'],
   [/\/Team:Cambridge\/Project\/in_vitro/i, 'invitro'],
   [/\/Team:Cambridge\/Project\/in_vivo/i, 'invivo'],
   [/\/Team:Cambridge\/Project\/gibthon/i, 'gibthon'],
   [/\/Team:Cambridge\/Project\/future/i, 'future'],
   [/\/Team:Cambridge\/Project/i, 'overview'],
</PRE><P>],
</P><PRE> 'labwork':  [
   [/\/Team:Cambridge\/Experiments\/Plasmid_Constructs/i, 'constructs'],
   [/\/Team:Cambridge\/experiments/i, 'experiments'],
   [/\/Team:Cambridge\/protocols/i, 'protocols'],
   [/\/Team:Cambridge\/safety/i, 'safety'],
   [/\/Team:Cambridge\/labwork/i, 'overview'],
</PRE><P>],
</P><PRE> 'society':  [
   [/\/Team:Cambridge\/Society\/report/i, 'report'],
   [/\/Team:Cambridge\/Society\/interviews/i, 'interviews'],
   [/\/Team:Cambridge\/Society/i, 'overview'],
</PRE><P>],
</P><PRE> 'team':     [
   [/\/Team:Cambridge\/Team\/Students/i, 'students'],
   [/\/Team:Cambridge\/Team\/Academics/i, 'academics'],
   [/\/Team:Cambridge\/Team\/Sponsors/i, 'sponsors'],
   [/\/Team:Cambridge\/Team/i, 'overview'],
</PRE><P>],
};
</P><P>var get_main_area = function(path)
{
</P><PRE> for ( var a in areas)
</PRE><P>	{
		if(areas[a][0].test(path))
		{
			return areas[a][1];
		}
	}
</P><PRE> return 'default';
</PRE><P>}
</P><P>var get_sub_area = function(path, area)
{
</P><PRE> if(area == 'default') return 'default';
 for ( var a in subareas[area])
</PRE><P>	{
		if(subareas[area][a][0].test(path))
		{
			return subareas[area][a][1];
		}
	}
</P><PRE> return 'overview';
</PRE><P>}
</P><P>var get_area = function(path) 
{ //figure out which area of the site we are in
</P><PRE> if(path == undefined)
</PRE><P>		var path = location.pathname;
	var ar = get_main_area(path);
	var sub = get_sub_area(path, ar);
	return [ar, sub];
}
</P><P>var apply_area = function()
{
	$('.cam-selected').removeClass('cam-selected');
	$('.cam-menu-item.cam-' + area).addClass('cam-selected');
	$('.cam-' + area + '-' + subarea).addClass('cam-selected');
}
</P><P>var set_area = function(path)
{
	var as = get_area(path);
	area = as[0];
	subarea = as[1];
	apply_area();
}
</P><P>var colorize_links = function($container) //colourise all the links in the container based on where the go
{
</P><PRE> $container.find('a').each( function(i) {
   var $this = $(this);
   if($this.hasClass('cam-color-exempt'))
     return;
   var ar = <I>;</I>
   if(is_external($this))
     ar = 'ext';
   else 
     ar = get_main_area($this.attr('href'));
   
   $(this).addClass('cam-' + ar);
 });
</PRE><P>}
</P><P>var loading_timeout;
</P><P>var show_loading = function() {
</P><PRE> //only show the loading bar if it's taking more than 500ms to display
 loading_timeout = setTimeout(&quot;$('#cam_loading').slideDown('fast');&quot;, 500);
</PRE><P>}
</P><P>var hide_loading = function() {
</P><PRE> clearTimeout(loading_timeout);
 $('#cam_loading').slideUp('fast');
</PRE><P>}
</P><P>var load_url = function(url)
{
</P><PRE> if(url == undefined)
   url = '/Team:Cambridge';
</PRE><PRE> var after_hash = <I>;</I>
 var match = url.match(/#.+/i);
 if(match != null)
   after_hash = match[0].substr(1);
 var hash_start = url.search('#');
 if(hash_start &gt; 0)
 {
   url = url.substr(0, hash_start);
 }
 var load = url + '?action=render';
</PRE><PRE> show_loading();
 $.ajax({
   'url': load,
   'dataType': 'html',
   'error': function(jqXHR, textStatus, errorThrown) {
     hide_loading();
     set_hash(url);
</PRE>
      var $c = $('<H2 class="error"><SPAN class="mw-headline" id="AjaxError">AjaxError</SPAN></H2><H4><SPAN class="mw-headline" id="Got_error_.22.27_.2B_errorThrown_.2B_.27.22_while_attempting_to_load_url_.22.27_.2B_load_.2B_.27.22">Got error &quot;' + errorThrown + '&quot; while attempting to load url &quot;' + load + '&quot;</SPAN></H4>');
<PRE>     $('#cam_pagecontent').hide().html($c).show();	
     window.scrollTo(0,0);	
   },
   'success': function(data){
     var $c = $('#wiki_content', data);
     $('#cam_pagecontent').hide().html($c.html()).show();	
     colorize_links($('#cam_pagecontent'));
     window.scrollTo(0,0);
     hide_loading();
     if(after_hash != <I>)</I>
       window.location.hash = after_hash;
     set_hash(url);
     
     //load the parts if we're on the parts page. This is hacky but I don't give a fark
     if((area == 'overview') &amp;&amp; (subarea == 'parts'))
     {
       $('#groupparts').load('/cgi/api/groupparts.cgi?t=iGEM011\&amp;g=Cambridge',function(){ $('#groupparts .tablesorter').tablesorter();} );
     }
   },
 });
 set_area(url);
 $('#cam_desc').introduction('setArea', area, subarea);
 update_links(url);
</PRE><P>};
</P><P>var wiki_main = function() {
</P><PRE> $('.cam-menu-item a').mouseenter( function(event) {//in
</PRE><P>	$(event.currentTarget).next().children('.cam-menu-drop').slideDown('fast');
</P><PRE> });
 $('.cam-menu-item').mouseleave( function(event) {//out
   $(event.currentTarget).find('.cam-menu-drop').slideUp('fast');
 }).click( function(event) {//hide on click
   $(event.currentTarget).find('.cam-menu-drop').slideUp('fast');
 });
</PRE><PRE> $('.cam-social-link').hover(
   function(event) {
     $(this).children().animate({top:0}, 75);
   },
   function(event) {
     $(this).children().animate({'top':12}, 250);
   }		
 ).click( function() {
   window.location = $(this).attr('href');
 });
</PRE><PRE> $('a').live('click', function(event) {
   if(event.ctrlKey) return true;
   if(is_internal(this))
   {
     event.preventDefault();
     load_url($(this).attr('href'));
     return false;
   }
   return true;
 });
</PRE><P>	$('#cam_topbar a').hover(
		function() {
			$(this).prev('.cam-ui-icon').addClass('cam-hover');
		},
		function() {
			$(this).prev('.cam-ui-icon').removeClass('cam-hover');
		}
	);
</P><PRE> int = window.setInterval('check_hash();', 500);
 if((window.location.hash == <I>) || (window.location.hash == undefined) || !(window.location.hash.charAt(1) == '/'))</I>
 {
   set_area(the_url);
   set_hash(the_url);
   update_links(the_url);
   colorize_links($('#wiki_content'));
   $('#cam_desc').introduction('setArea', area, subarea);
 }
 else
 {
   load_url(get_hash());
 }
</PRE><P>}
</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2012.igem.org/Team:Cambridge/static/wiki_splash.js">http://2012.igem.org/Team:Cambridge/static/wiki_splash.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Cambridge/static/wiki_splash.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Cambridge/static/wiki_splash.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Cambridge/static/wiki_splash.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Cambridge/static/wiki_splash.js&amp;oldid=43379" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2012.igem.org:Privacy_policy" title="2012.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2012.igem.org:General_disclaimer" title="2012.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>