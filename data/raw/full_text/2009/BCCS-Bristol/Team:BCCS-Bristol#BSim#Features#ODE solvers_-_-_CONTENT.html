<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_BCCS-Bristol_BSim_Features_ODE_solvers"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu"><UL><LI class="selected"><A href="/Team:BCCS-Bristol/BSim/Features/ODE_solvers">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:BCCS-Bristol/BSim/Features/ODE_solvers&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:BCCS-Bristol/BSim/Features/ODE_solvers&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:BCCS-Bristol/BSim/Features/ODE_solvers&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:BCCS-Bristol/BSim/Features/ODE_solvers" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:BCCS-Bristol/BSim/Features/ODE solvers</H1><DIV id="bodyContent"><H3 id="siteSub">From 2009.igem.org</H3><P><UL id="nav"><LI><A href="https://2009.igem.org/Team:BCCS-Bristol">Home</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Project">VESECURE</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Project/Wet_lab">Wet lab</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Project/Wet_lab/BioBricks">BioBricks</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Project/Wet_lab/Notebook">Notebook</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Project/Wet_lab/Lab_photos">Lab photos</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Project/Wet_lab#Safety_Issues">Safety</A></LI></UL><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Project/Modelling">Modelling</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/BSim">BSim</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/BSim#Features">Features</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/BSim/Tutorials">Tutorials</A></LI><LI><A href="http://code.google.com/p/bsim-bccs/downloads">Download</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/BSim/Case_studies">Case studies</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/BSim/Case_studies/VESECURE">VESECURE</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/BSim/Case_studies/Magnetotaxis">Magnetotaxis</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/BSim/Case_studies/Repressilators">Repressilators</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Bioscaffold">Bioscaffold</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Bioscaffold/Protein_Fusion_Problem">Fusion Problem</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Bioscaffold/BCCS_Bioscaffold">BCCS Bioscaffold</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Team">Team</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Team/Calendar">Calendar</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Team/Brainstorm">Brainstorm</A></LI><LI><A href="https://2009.igem.org/Team:BCCS-Bristol/Team/Preliminary_meetings">Preliminary meetings</A></LI></P><DIV style="position: relative; width: 965px; height: 150px; background: url('https://static.igem.org/mediawiki/2009/c/c2/BCCSBanner.jpg'); clear: both;  "><DIV style="position: absolute; bottom: 12px; right: 25px; color: black; z-index: 3; font-size: 1.5em">
BCCS-Bristol
<SPAN style="font-size: small">iGEM 2009</SPAN></DIV></DIV><TABLE id="toc" class="toc"><TBODY><TR><TD><DIV id="toctitle"><H2>Contents</H2></DIV><UL><LI class="toclevel-1 tocsection-1"><A href="#GRNs"><SPAN class="tocnumber">1</SPAN><SPAN class="toctext">GRNs</SPAN></A></LI><LI class="toclevel-1 tocsection-2"><A href="#Solvers"><SPAN class="tocnumber">2</SPAN><SPAN class="toctext">Solvers</SPAN></A></LI><LI class="toclevel-1 tocsection-3"><A href="#BSimOdeSingle"><SPAN class="tocnumber">3</SPAN><SPAN class="toctext">BSimOdeSingle</SPAN></A></LI><LI class="toclevel-2 tocsection-4"><A href="#An_Example_ODE"><SPAN class="tocnumber">3.1</SPAN><SPAN class="toctext">An Example ODE</SPAN></A></LI></UL><LI class="toclevel-1 tocsection-5"><A href="#BSimOdeSystem"><SPAN class="tocnumber">4</SPAN><SPAN class="toctext">BSimOdeSystem</SPAN></A></LI><LI class="toclevel-2 tocsection-6"><A href="#An_Example_ODE_System"><SPAN class="tocnumber">4.1</SPAN><SPAN class="toctext">An Example ODE System</SPAN></A></LI></TD></TR></TBODY></TABLE><H2><SPAN class="mw-headline" id="GRNs"> GRNs </SPAN></H2><P>BSim 2008: &quot;Each of the modelling approaches [GRNs and agent-based modelling] have been considered in separate contexts, mainly due to the differing aspects of the system they are concerned with. Now, having working models for each, it would be possible to bring these together with the aim of improving simulation accuracy and allowing for the internal cellular dynamics to be studied in an ever changing physical environment. Such a hybrid model may also help shed light on the critical aspects of project as a whole.&quot;
</P><P>BSim 2009 provides a robust implementation of the second and fourth order Runge-Kutta methods for systems of ordinary differential equations. It is possible to easily specify systems of ODEs as objects within the simulation. These ODE systems can be &quot;attached&quot; to objects in the simulation if necessary and can be used to simulate any aspect of the environment to which they are coupled, depending on the user's requirements. An example would be attaching an ODE system to each bacterium and coupling these systems via an external chemical field. See the overview of our ongoing quorum-coupled repressilators simulation for an example application of this.
</P><P>As a result of the modular nature of the solver implementation it would also be possible to implement stochastic ODEs, and delay differential equations in a similar manner. These features are likely to be implemented soon to assist with the modelling of more complex GRN systems across a population. 
</P><H2><SPAN class="mw-headline" id="Solvers"> Solvers </SPAN></H2><P>Currently we can specify custom ODEs by creating a class that implements BSimOdeSingle or BSimOdeSystem.
</P><P>The custom classes can be passed directly to any solver, however the solvers are only single-step to make them more adaptable, therefore implementing actual iteration along a time series is left up to the programmer.
</P><P>The interfaces are designed such that a user defined set of equations can be an external class or in fact an inner class. In general it is useful to define GRNs or other ODEs as inner classes as part of the simulation definition, mostly for reasons of convenience when coupling systems or accessing variables. However, in general the choice of implementation of a specific ODE or system of equations is left up to the user.
</P><H2><SPAN class="mw-headline" id="BSimOdeSingle">BSimOdeSingle</SPAN></H2><P>This interface allows you to specify a single ODE. The interface requires two methods, one to define the derivatives and one to return the initial conditions for the initial value problem.
</P><H3><SPAN class="mw-headline" id="An_Example_ODE">An Example ODE</SPAN></H3><P>To define the problem
</P><P>dy/dt = t
</P><P>One would create a new class defining the ODE with the following code:
</P><PRE>
//Package, Imports etc here

// An example ODE
public class Linear implements BSimOdeSingle {
	public double derivative(double x, double y){
		dy = x;
		return dy;
	}

	public double getIC(){ return 0.0; }
}
</PRE><P>The class <I>Linear</I> would then be passed to a solver along with current <I>x</I> (in this case <I>x</I> is in fact <I>t</I>) and <I>y</I> values. However in complex biological systems such as GRNs which oscillate, there are likely to be multiple ODEs, therefore it is reccommended that BSimOdeSystem be employed in general.
</P><H2><SPAN class="mw-headline" id="BSimOdeSystem">BSimOdeSystem</SPAN></H2><P>With this interface it is possible to define a system of multiple (potentially coupled) ODEs. In a similar manner to BSimOdeSingle, it is necessary to specify the derivatives and the initial conditions, however they must now be in the form of arrays as there are multiple values to consider. There is also a third method which must be specified which returns the number of equations present in the system. The implementation of these methods is left up to the user.
</P><H3><SPAN class="mw-headline" id="An_Example_ODE_System">An Example ODE System</SPAN></H3><P>As an example, we show here how one would define a simple (damped) <A href="http://en.wikipedia.org/wiki/Harmonic_oscillator#Damped_harmonic_oscillator" class="external text" rel="nofollow">harmonic oscillator</A>.
</P><P>This is a second order ODE and so must be simplified to a system of first order equations via a substitution. One can then specify the initial conditions.
</P><P>The Java implementation of this system is illustrated in the following segment of code:
</P><PRE>
//Package, Imports etc here

// An example ODE system - Damped Simple Harmonic Motion
public class SHM implements BSimOdeSytem{
	private int numEq = 2;

        public int getNumEq(){return numEq ;}

	public double[] derivativeSystem(double x, double[] y){
		double[] dy = new double[numEq];
		dy[0] = y[1];
		dy[1] = -2*y[0] - 0.1*y[1];
		return dy;
	}
		
	public double[] getICs(){
		double[] y0 = new double[numEq];
		y0[0] = 0;
		y0[1] = 1;
		return y0;
	}
}
</PRE><P>The class <I>SHM</I> can then be passed to the solver of choice at each time step, and the values of <I>y</I> extracted and either logged or displayed to the user.
</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2009.igem.org/Team:BCCS-Bristol/BSim/Features/ODE_solvers">http://2009.igem.org/Team:BCCS-Bristol/BSim/Features/ODE_solvers</A>&quot;</DIV></DIV></DIV><DIV id="footer-box"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:BCCS-Bristol/BSim/Features/ODE_solvers" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:BCCS-Bristol/BSim/Features/ODE_solvers" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:BCCS-Bristol/BSim/Features/ODE_solvers&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:BCCS-Bristol/BSim/Features/ODE_solvers&amp;oldid=163599" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2009.igem.org:Privacy_policy" title="2009.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2009.igem.org:General_disclaimer" title="2009.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>