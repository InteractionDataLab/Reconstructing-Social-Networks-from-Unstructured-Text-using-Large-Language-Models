<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_EPF-Lausanne_Modeling_Simulation"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu"><UL><LI class="selected"><A href="/Team:EPF-Lausanne/Modeling/Simulation">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:EPF-Lausanne/Modeling/Simulation&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:EPF-Lausanne/Modeling/Simulation&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:EPF-Lausanne/Modeling/Simulation&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:EPF-Lausanne/Modeling/Simulation" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:EPF-Lausanne/Modeling/Simulation</H1><DIV id="bodyContent"><H3 id="siteSub">From 2009.igem.org</H3><DIV style="position: relative; left: 190px; top: -134px; padding: 0px; margin: 0px; border: 0px solid white;z-index:1;"><DIV class="wrapper1"><DIV class="wrapper" style="width:650px;"><DIV class="nav-wrapper"><DIV class="nav"><UL id="navigation" style="width:600px"><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne" target="_self"><SPAN class="menu-mid">Home</SPAN></A></LI><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Team" target="_self"><SPAN class="menu-mid">Team</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Team" target="_self">Presentation</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Team#Where_we_are_from" target="_self">School</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Team_Management" target="_self">Team Management</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Brainstorming" target="_self">Brainstorming</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Sponsors" target="_self">Sponsors</A></LI></UL></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Project_Abstract" target="_self"><SPAN class="menu-mid">Project</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Project_Abstract" target="_self">Abstract</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/LOVTAP" target="_self">Theory</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Strategy" target="_self">Strategy</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Experimental_Setup" target="_self">Experimental Setup</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/LOVTAP_Results" target="_self">Results</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Parts" target="_self">Parts submitted to the Registry</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Future_directions" target="_self">Future directions</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/References" target="_self">References</A></LI></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Modeling_overview" target="_self"><SPAN class="menu-mid">Modeling</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Modeling_overview" target="_self">Modeling overview</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Analysis methods" target="_self">Analysis Methods</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Results" target="_self">Results</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Information_&amp;_references" target="_self">References</A></LI></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Social_overview" target="_self"><SPAN class="menu-mid">Human practices</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Social_overview" target="_self">Overview</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Talks" target="_self">Talks</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Survey" target="_self">Survey</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Media" target="_self">Media</A></LI></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Safety" target="_self"><SPAN class="menu-mid">Safety</SPAN></A></LI><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Notebook" target="_self"><SPAN class="menu-mid">Lab</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Last_News" target="_self">Last News</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Notebook" target="_self">Notebook</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Protocols" target="_self">Protocols used</A></LI></DIV></DIV></DIV></DIV><DIV class="epfltrick"><TABLE id="toc" class="toc"><TBODY><TR><TD><DIV id="toctitle"><H2>Contents</H2></DIV><UL><LI class="toclevel-1 tocsection-1"><A href="#Creating_input_files_for_namd"><SPAN class="tocnumber">1</SPAN><SPAN class="toctext">Creating input files for namd</SPAN></A></LI><LI class="toclevel-2 tocsection-2"><A href="#Nomenclature"><SPAN class="tocnumber">1.1</SPAN><SPAN class="toctext">Nomenclature</SPAN></A></LI><LI class="toclevel-2 tocsection-3"><A href="#Creation_of_the_pdb_file"><SPAN class="tocnumber">1.2</SPAN><SPAN class="toctext">Creation of the pdb file</SPAN></A></LI><LI class="toclevel-2 tocsection-4"><A href="#Creation_of_the_psf_file"><SPAN class="tocnumber">1.3</SPAN><SPAN class="toctext">Creation of the psf file</SPAN></A></LI><LI class="toclevel-3 tocsection-5"><A href="#Unique_segment:"><SPAN class="tocnumber">1.3.1</SPAN><SPAN class="toctext">Unique segment:</SPAN></A></LI><LI class="toclevel-3 tocsection-6"><A href="#Case_of_multiple_segments:"><SPAN class="tocnumber">1.3.2</SPAN><SPAN class="toctext">Case of multiple segments:</SPAN></A></LI></UL><LI class="toclevel-2 tocsection-7"><A href="#Solvating_the_protein"><SPAN class="tocnumber">1.4</SPAN><SPAN class="toctext">Solvating the protein</SPAN></A></LI><LI class="toclevel-2 tocsection-8"><A href="#Add_ions"><SPAN class="tocnumber">1.5</SPAN><SPAN class="toctext">Add ions</SPAN></A></LI><LI class="toclevel-2 tocsection-9"><A href="#Measurement_of_the_water_box_coordinates"><SPAN class="tocnumber">1.6</SPAN><SPAN class="toctext">Measurement of the water box coordinates</SPAN></A></LI><LI class="toclevel-1 tocsection-10"><A href="#More_informations_from_the_tutorial"><SPAN class="tocnumber">2</SPAN><SPAN class="toctext">More informations from the tutorial</SPAN></A></LI><LI class="toclevel-2 tocsection-11"><A href="#NOT_NEEDED.21_Simulation_with_Periodic_Boundary_Conditions"><SPAN class="tocnumber">2.1</SPAN><SPAN class="toctext">NOT NEEDED! Simulation with Periodic Boundary Conditions</SPAN></A></LI><LI class="toclevel-2 tocsection-12"><A href="#VMD_-_Make_a_movie_from_the_.dcd"><SPAN class="tocnumber">2.2</SPAN><SPAN class="toctext">VMD - Make a movie from the .dcd</SPAN></A></LI></TD></TR></TBODY></TABLE></DIV><DIV class="epfl09"><H1><SPAN class="mw-headline" id="Creating_input_files_for_namd"> Creating input files for namd </SPAN></H1><P>We start with the PDB file of the protein, obtained through the Protein Data Bank.
</P><P>We open VMD, and lauch our protein.
</P><H2><SPAN class="mw-headline" id="Nomenclature">Nomenclature</SPAN></H2><P>Here are the convention we are using to name files:
</P><DL><DD>PROT.pdb : pdb of the protein downloaded from the internet(in capital letters)
</DD><DD>prot.pdb : pdb after removing unwanted atoms (step 3 on this page)
</DD><DD>protp.pdb : pdb after processing by psfgen
</DD><DD>protp.psf : psf after processing by psfgen
</DD><DD>protp_wb.pdb : pdb after solvating
</DD><DD>protp_wb.psf : psf after solvating
</DD><DD>protp_wb_i.pdb : pdb after adding ions (final version of the file)
</DD><DD>protp_wb_i.psf : psf after adding ions (final version of the file)
</DD></DL><H2><SPAN class="mw-headline" id="Creation_of_the_pdb_file">Creation of the pdb file</SPAN></H2><DL><DD><I>.pdb from the web → .pdb file ready for vmd processing (removing some atoms)</I></DD></DL><P>
After creating the molecule containing the .pdb downloaded from internet, in the Tk Console menu of VMD we open the VMD TkCon window, and type the following commands: 
</P><DL><DD> set our_protein [atomselect top &quot;not water and not resname GOL&quot;]
</DD><DD> $our_protein writepdb 2v0u.pdb 
</DD></DL><P>This will select all the protein except the water and except the glycerol, with the cofactor.
If we have multiple sequences, we can simply select them and write them to different .pdb.
</P><P>We have created the ﬁle 2v0u.pdb, which contains the coordinates of the protein alone without hydrogens.
Quit VMD.
</P><H2><SPAN class="mw-headline" id="Creation_of_the_psf_file">Creation of the psf file</SPAN></H2><DL><DD><I>.pdb file + topology file (*.rtf) → .psf file + matching .pdb file</I></DD><DD>.psf file contains atom parameters derived from topology, but is not human readable.
</DD></DL><P>There are 2 ways to create a psf:
</P><UL><LI> in VMD, Extensions → Modeling → Automatic PSF Builder (psfgen GUI) (WARNING: bug prevent from dealing with multile chains!)
</LI><LI> We first make a pgn file, which is a script file that will command psfgen. 
</LI></UL><H3><SPAN class="mw-headline" id="Unique_segment:">Unique segment:</SPAN></H3><P>In a Terminal window, open a text editor and create a file that you'll call 2v0w.pgn:  
</P><DL><DD> package require psfgen 
</DD><DD> topology <A href="/wiki/images/b/b6/Top_all27_prot_lipid-fmc.txt" class="internal" title="Top all27 prot lipid-fmc.txt">top_all27_prot_lipid.inp</A></DD></DL><DL><DD> pdbalias residue HIS HSE 
</DD><DD> pdbalias atom ILE CD1 CD 
</DD></DL><DL><DD> segment U 
</DD><DD> {pdb 2v0w.pdb} 
</DD><DD> coordpdb 2v0w.pdb U 
</DD></DL><DL><DD> guesscoord 
</DD><DD> writepdb 2v0wp.pdb 
</DD><DD> writepsf 2v0wp.psf
</DD></DL><P>You'll need to place the topology file within same directory. Here is the current <A href="/wiki/images/b/b6/Top_all27_prot_lipid-fmc.txt" class="internal" title="Top all27 prot lipid-fmc.txt">topology file</A>, please rename to Top_all27_prot_lipid-fmc.rtf after download. The topology file is specific for the .pdb we have, ask if you need one for dark/light FMN.
</P><P>In a Terminal window, type the following command: 
</P><DL><DD>&gt; vmd -dispdev text -e 2v0w.pgn 
</DD></DL><P>This will run the psfgen from the ﬁle 2v0w.pgn and generate the psf (2v0wp.psf) and the pdb (2v0wp.pdb) ﬁle of the protein with hydrogens.
A new pdb file with the complete coordinates of all atoms is written, including H; and a psf ﬁle with the complete structural information of the protein.
</P><H3><SPAN class="mw-headline" id="Case_of_multiple_segments:">Case of multiple segments:</SPAN></H3><P>This section is based on <A href="/wiki/images/1/18/Ug.pdf" class="internal" title="Ug.pdf">psfgen manual</A>.
</P><P>Psfgen is not able to deal with multiple sequences within a single .pdb (even using TER and different seg names). We have to separate them, either by hand, either using grep. So you should have as many .pdb files as chains (2v0u_prot.pdb, 2v0u_fmn.pdb).
</P><P>and .pgn gets. I added some comments to explain the commands(//), please remove them before run.
</P><DL><DD>package require psfgen //check if plugin available
</DD><DD>topology <A href="/wiki/images/9/97/Top_all27_prot_lipid-fmn_dark.txt" class="internal" title="Top all27 prot lipid-fmn dark.txt">top_all27_prot_lipid-fmn_dark.inp</A> //loads topology file
</DD></DL><DL><DD>pdbalias residue HIS HSE //some aliases
</DD><DD>pdbalias atom ILE CD1 CD //some aliases
</DD></DL><DL><DD>segment 2v0u { //creates a chain that'll contain the prot
</DD><DD>pdb 2v0u_prot.pdb //loads list of atoms
</DD><DD>} 
</DD><DD>coordpdb 2v0u_prot.pdb 2v0u //loads coord. of atoms
</DD></DL><DL><DD>segment fmn { //creates the second chain
</DD><DD>pdb 2v0u_fmn.pdb //loads atoms from FMN
</DD><DD>first none //prevents psfgen from &quot;capping&quot; the first residue
</DD><DD>last none //prevents psfgen from &quot;capping&quot; the last residue
</DD><DD>} 
</DD><DD>coordpdb 2v0u_fmn.pdb fmn //loads coord. of atoms
</DD></DL><DL><DD>guesscoord //complete missing coord.
</DD><DD>writepdb 2v0up.pdb //write .pdb containing all previously loaded chains
</DD><DD>writepsf 2v0up.psf //write .psf containing all previously loaded chains
</DD></DL><P>The structure is quite important, as psfgen applies some patch at the end of loaded chains (NTERM, CTERM). In the case of FMN without link to the cystein, we have to prevent psfgen from adding atoms to neutralize the molecule as if it was a protein. That's the purpose of <I>first none</I> and <I>last none</I>.
</P><H2><SPAN class="mw-headline" id="Solvating_the_protein">Solvating the protein </SPAN></H2><DL><DD><I>.pdb + .psf containing the protein → .pdb + .psf containing the protein and water molecules</I></DD></DL><P>
Now, the protein needs to be solvated, i.e., put inside water, to more closely resemble the cellular environment. This will be done by placing the protein in a water box, in preparation for minimization and equilibration with periodic boundary conditions.
</P><P>In the VMD Main window, open the Tk Console, and type:
</P><DL><DD> package require solvate 
</DD><DD> solvate 2v0up.psf 2v0up.pdb -t 12 -o 2v0up_wb 
</DD></DL><P>The &quot;solvate package&quot; will put the protein in a box of water. The -t option creates the water box dimensions such that there is a layer of water 12 Angström in each direction from the atom with the largest coordinate in that direction. We have to take a special care to <B>be sure we don't have interaction</B> with the protein in the next periodic box. Minimization usually shrinks the water box. Minimal distance between nearer atoms of 2 boxes should be higher than ~12 Angstroem. As we have a small protein, we can increase the size of the box without having too many atoms. The -o option creates the output ﬁles our_prot_in_a_water_box .pdb and our_prot_in_a_water_box.psf.
</P><H2><SPAN class="mw-headline" id="Add_ions">Add ions </SPAN></H2><DL><DD><I>add ions in .pdb + .psf</I></DD></DL><P>
In VMD, we load the psf and the pdb created with the pgn. Under Extension/Modeling/Add Ions, and knowing the charge of the protein (for exemple -7), we add 7 atoms of Na.
Instead of concentrations, we click user defined to add 7 Na, and neutralize.
The automatic mode works quite well. At least it is really efficient to calculate the total charge of the system, but it might add both positive and negative charges to reach neutral potential. So we prefer to add a given number of ions by hand.
</P><DIV class="center"><DIV class="thumb tnone"><DIV class="thumbinner" style="width:400px;"><DIV class="thumbcaption">Ionization</DIV></DIV></DIV></DIV><H2><SPAN class="mw-headline" id="Measurement_of_the_water_box_coordinates">Measurement of the water box coordinates</SPAN></H2><DL><DD><I>we need the origin and 3 dimension vectors of the system as initial conditions for namd</I></DD></DL><P>
In VMD, load 2v0up_wb_i.psf and 2v0up_wb_i.pdb. This will display our protein in a water box. 
In the VMD TkCon window type: 
</P><DL><DD> set everyone [atomselect top all] 
</DD><DD> measure minmax $everyone 
</DD></DL><P>This gives the minimum and maximum values of x, y and z coordinates of the entire protein-water system, relative to the origin of the coordinate system. 
</P><P>The center of the water box may be determined by typing:
</P><DL><DD> measure center $everyone 
</DD></DL><P>These coordinates have to be kept and recorded for the referential of namd.
</P><P>You now have all the input files for namd!
</P><H1><SPAN class="mw-headline" id="More_informations_from_the_tutorial"> More informations from the tutorial </SPAN></H1><H2><SPAN class="mw-headline" id="NOT_NEEDED.21_Simulation_with_Periodic_Boundary_Conditions">NOT NEEDED! Simulation with Periodic Boundary Conditions </SPAN></H2><DL><DD><I>.psf + .pdb + .prm + .conf → namd → anything you want</I></DD></DL><P>This part of the tutorial doesn't have its place here anymore, as we have to detail much more the process of launching namd. Please go back to the <A href="/Team:EPF-Lausanne/Implementation" title="Team:EPF-Lausanne/Implementation">root</A> for more informations.
</P><P>The use of periodic boundary conditions are eﬀective in eliminating surface interaction of the water molecules and creating a more faithful representation of the in vivo environment than a water sphere surrounded by vacuum provides. 
</P><P><B>We first create a configuration file: </B>From the tutorial of VMD, we can download the configuration files for the minimization and equilibration of the protein in a water box. The process of editing .conf will be explained on a separate page.
Look at the tutorial for a more detailed explanation of the different parameters listed.
</P><P>The simulation can be run by typing in a Terminal window: 
</P><DL><DD> namd2 our_prot_configuration_file.conf &gt; output_file.log 
</DD></DL><P>Output of the water sphere minimization-equilibration simulation will yield eleven output ﬁles. See the tutorial for a more detailed explanation of each file.
</P><H2><SPAN class="mw-headline" id="VMD_-_Make_a_movie_from_the_.dcd">VMD - Make a movie from the .dcd</SPAN></H2><P>This step occurs after the namd calculation.
Open VMD, load first the file 2v0up_wb_i.psf, and then the file .dcd automatically created. The protein will appear surrounded by molecules of water. 
To see it more clearly, go in Graphics → Representation, and create 3 replicates.
</P><P>In the first replicates, type in selected atoms &quot;protein&quot; to select all residues in the protein, and choose NewCartoon as the drawing method for example. It will identify how many helices, betasheets and coils are present in the protein. 
In the second replicate, type &quot;resname FMN&quot; to select only the cofactor, and choose CPK for example to display the atoms of the cofactor.
Finally, type &quot;water&quot; in the last replicate, and you can choose to deselect all molecules of water for a clearest view by double-clicking on it.
</P><P>Now, to make a movie, just go on the VMD Main menu, and click on the triangle in the right bottom of the menu, and go to the Extension → Vizualization → Movie Maker
Here, just change the name of the movie, the working directory and make the movie!
</P><DIV class="center"><DIV class="thumb tnone"><DIV class="thumbinner" style="width:743px;"><DIV class="thumbcaption">Movie Maker</DIV></DIV></DIV></DIV></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2009.igem.org/Team:EPF-Lausanne/Modeling/Simulation">http://2009.igem.org/Team:EPF-Lausanne/Modeling/Simulation</A>&quot;</DIV><DIV id="footer-box"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:EPF-Lausanne/Modeling/Simulation" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:EPF-Lausanne/Modeling/Simulation" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:EPF-Lausanne/Modeling/Simulation&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:EPF-Lausanne/Modeling/Simulation&amp;oldid=118633" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2009.igem.org:Privacy_policy" title="2009.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2009.igem.org:General_disclaimer" title="2009.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></BODY></HTML>