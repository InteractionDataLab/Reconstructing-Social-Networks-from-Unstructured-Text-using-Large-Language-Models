<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_EPF-Lausanne_Analysis_methods"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu"><UL><LI class="selected"><A href="/Team:EPF-Lausanne/Analysis_methods">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:EPF-Lausanne/Analysis_methods&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:EPF-Lausanne/Analysis_methods&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:EPF-Lausanne/Analysis_methods&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:EPF-Lausanne/Analysis_methods" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:EPF-Lausanne/Analysis methods</H1><DIV id="bodyContent"><H3 id="siteSub">From 2009.igem.org</H3><DIV style="position: relative; left: 190px; top: -134px; padding: 0px; margin: 0px; border: 0px solid white;z-index:1;"><DIV class="wrapper1"><DIV class="wrapper" style="width:650px;"><DIV class="nav-wrapper"><DIV class="nav"><UL id="navigation" style="width:600px"><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne" target="_self"><SPAN class="menu-mid">Home</SPAN></A></LI><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Team" target="_self"><SPAN class="menu-mid">Team</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Team" target="_self">Presentation</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Team#Where_we_are_from" target="_self">School</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Team_Management" target="_self">Team Management</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Brainstorming" target="_self">Brainstorming</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Sponsors" target="_self">Sponsors</A></LI></UL></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Project_Abstract" target="_self"><SPAN class="menu-mid">Project</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Project_Abstract" target="_self">Abstract</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/LOVTAP" target="_self">Theory</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Strategy" target="_self">Strategy</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Experimental_Setup" target="_self">Experimental Setup</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/LOVTAP_Results" target="_self">Results</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Parts" target="_self">Parts submitted to the Registry</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Future_directions" target="_self">Future directions</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/References" target="_self">References</A></LI></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Modeling_overview" target="_self"><SPAN class="menu-mid">Modeling</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Modeling_overview" target="_self">Modeling overview</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Analysis methods" target="_self">Analysis Methods</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Results" target="_self">Results</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Information_&amp;_references" target="_self">References</A></LI></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Social_overview" target="_self"><SPAN class="menu-mid">Human practices</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Social_overview" target="_self">Overview</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Talks" target="_self">Talks</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Survey" target="_self">Survey</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Media" target="_self">Media</A></LI></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Safety" target="_self"><SPAN class="menu-mid">Safety</SPAN></A></LI><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Notebook" target="_self"><SPAN class="menu-mid">Lab</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Last_News" target="_self">Last News</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Notebook" target="_self">Notebook</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Protocols" target="_self">Protocols used</A></LI></DIV></DIV></DIV></DIV><DIV class="epfltrick"><TABLE id="toc" class="toc"><TBODY><TR><TD><DIV id="toctitle"><H2>Contents</H2></DIV><UL><LI class="toclevel-1 tocsection-1"><A href="#Softwares_used"><SPAN class="tocnumber">1</SPAN><SPAN class="toctext">Softwares used</SPAN></A></LI><LI class="toclevel-2 tocsection-2"><A href="#VMD"><SPAN class="tocnumber">1.1</SPAN><SPAN class="toctext">VMD</SPAN></A></LI><LI class="toclevel-2 tocsection-3"><A href="#NAMD"><SPAN class="tocnumber">1.2</SPAN><SPAN class="toctext">NAMD</SPAN></A></LI></UL><LI class="toclevel-1 tocsection-4"><A href="#Information_needed"><SPAN class="tocnumber">2</SPAN><SPAN class="toctext">Information needed</SPAN></A></LI><LI class="toclevel-2 tocsection-5"><A href="#Generating_input_files"><SPAN class="tocnumber">2.1</SPAN><SPAN class="toctext">Generating input files</SPAN></A></LI><LI class="toclevel-2 tocsection-6"><A href="#Launch_a_simulation"><SPAN class="tocnumber">2.2</SPAN><SPAN class="toctext">Launch a simulation</SPAN></A></LI><LI class="toclevel-2 tocsection-7"><A href="#Namd_.conf_parameters"><SPAN class="tocnumber">2.3</SPAN><SPAN class="toctext">Namd .conf parameters</SPAN></A></LI><LI class="toclevel-2 tocsection-8"><A href="#Scripts_used"><SPAN class="tocnumber">2.4</SPAN><SPAN class="toctext">Scripts used</SPAN></A></LI><LI class="toclevel-1 tocsection-9"><A href="#Step_by_step_analysis"><SPAN class="tocnumber">3</SPAN><SPAN class="toctext">Step by step analysis</SPAN></A></LI><LI class="toclevel-2 tocsection-10"><A href="#Maxwell-Boltzmann_Energy_Distribution"><SPAN class="tocnumber">3.1</SPAN><SPAN class="toctext">Maxwell-Boltzmann Energy Distribution</SPAN></A></LI><LI class="toclevel-2 tocsection-11"><A href="#Energies"><SPAN class="tocnumber">3.2</SPAN><SPAN class="toctext">Energies</SPAN></A></LI><LI class="toclevel-2 tocsection-12"><A href="#Temperature_distribution"><SPAN class="tocnumber">3.3</SPAN><SPAN class="toctext">Temperature distribution</SPAN></A></LI><LI class="toclevel-2 tocsection-13"><A href="#Density"><SPAN class="tocnumber">3.4</SPAN><SPAN class="toctext">Density</SPAN></A></LI><LI class="toclevel-2 tocsection-14"><A href="#Pressure_as_a_function_of_simulation_time"><SPAN class="tocnumber">3.5</SPAN><SPAN class="toctext">Pressure as a function of simulation time</SPAN></A></LI><LI class="toclevel-2 tocsection-15"><A href="#RMSD_for_individual_residues"><SPAN class="tocnumber">3.6</SPAN><SPAN class="toctext">RMSD for individual residues</SPAN></A></LI><LI class="toclevel-2 tocsection-16"><A href="#RMSD_of_selected_atoms_compared_to_initial_position_along_time"><SPAN class="tocnumber">3.7</SPAN><SPAN class="toctext">RMSD of selected atoms compared to initial position along time</SPAN></A></LI><LI class="toclevel-2 tocsection-17"><A href="#Salt_bridges"><SPAN class="tocnumber">3.8</SPAN><SPAN class="toctext">Salt bridges</SPAN></A></LI><LI class="toclevel-2 tocsection-18"><A href="#RMSF"><SPAN class="tocnumber">3.9</SPAN><SPAN class="toctext">RMSF</SPAN></A></LI><LI class="toclevel-2 tocsection-19"><A href="#Angles"><SPAN class="tocnumber">3.10</SPAN><SPAN class="toctext">Angles</SPAN></A></LI><LI class="toclevel-2 tocsection-20"><A href="#H_bonds_and_distance_measurments"><SPAN class="tocnumber">3.11</SPAN><SPAN class="toctext">H bonds and distance measurments</SPAN></A></LI><LI class="toclevel-2 tocsection-21"><A href="#Dihedral_angles"><SPAN class="tocnumber">3.12</SPAN><SPAN class="toctext">Dihedral angles</SPAN></A></LI><LI class="toclevel-2 tocsection-22"><A href="#PCA_Analysis"><SPAN class="tocnumber">3.13</SPAN><SPAN class="toctext">PCA Analysis</SPAN></A></LI></TD></TR></TBODY></TABLE></DIV><DIV class="epfl09model"><P><CENTER>                                             </CENTER></P><P><CENTER><FONT size="12" color="#007CBC">Analysis Methods</FONT></CENTER></P><H1><SPAN class="mw-headline" id="Softwares_used">Softwares used</SPAN></H1><H3><SPAN class="mw-headline" id="VMD">VMD</SPAN></H3><P>VMD is a molecular visualization program for displaying, animating, and analyzing biomolecular systems using 3-D graphics and built-in scripting. It provides a wide range of molecular representations, and includes tools for working with volumetric data, sequence data, and arbitrary graphics objects. You can have more information on their <A href="http://www.ks.uiuc.edu/Research/vmd/" class="external text" rel="nofollow">webpage</A>.
</P><H3><SPAN class="mw-headline" id="NAMD">NAMD</SPAN></H3><P>NAMD is a molecular dynamics code designed for simulation of large biomolecular systems. It is based on Charm++ parallel programming model, and uses VMD for simulation setup and trajectory analysis.
See their website <A href="http://www.ks.uiuc.edu/Research/namd/" class="external text" rel="nofollow">here</A>.
</P><H1><SPAN class="mw-headline" id="Information_needed">Information needed</SPAN></H1><H3><SPAN class="mw-headline" id="Generating_input_files">Generating input files</SPAN></H3><P>In this section, we explain all the steps to create needed files for NAMD, except the .conf file, which is just <A href="https://2009.igem.org/Team:EPF-Lausanne/Analysis_methods#Namd_.conf_parameters" class="external text" rel="nofollow">below</A>.
We need a compatible .pdb in addition to parameter and topology files to go through. Steps to generate all the input files are explained in detail on this page:
<A href="/Team:EPF-Lausanne/Modeling/Simulation" title="Team:EPF-Lausanne/Modeling/Simulation">How to generate input files</A>. This is a kind of summary of the tutorial.
</P><H3><SPAN class="mw-headline" id="Launch_a_simulation">Launch a simulation</SPAN></H3><P>We start from .pdb, .psf, .rtf generated in the previous sections and we explain how to launch NAMD on both clusters we have access to. Complete process is on a separate page <A href="/Team:EPF-Lausanne/Modeling/RunSimulation" title="Team:EPF-Lausanne/Modeling/RunSimulation">How to launch a simulation</A>.
</P><H3><SPAN class="mw-headline" id="Namd_.conf_parameters">Namd .conf parameters</SPAN></H3><P>Namd can run different kind of simulations, from minimization to MD simulations. Here are the .conf file we used. <A href="/Team:EPF-Lausanne/Modeling/NamdConf" title="Team:EPF-Lausanne/Modeling/NamdConf">NamdConf</A></P><H3><SPAN class="mw-headline" id="Scripts_used">Scripts used</SPAN></H3><P>We stored all our scripts, which were highly modified compared to the original ones, in order to fit our needs. You can find them on <A href="https://2009.igem.org/Team:EPF-Lausanne/Scripts" class="external text" rel="nofollow">this page</A>. 
</P><H1><SPAN class="mw-headline" id="Step_by_step_analysis">Step by step analysis</SPAN></H1><P>The following section is a kind of tutorial, which describes step by step how to obtain our different results.
</P><P>This analysis will check whether the minimization, the heating and the equilibration took place correctly and whether the protein did not explode.
</P><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH align="left" valign="top" style="background:#ffffff;"><H2><SPAN class="mw-headline" id="Maxwell-Boltzmann_Energy_Distribution"> Maxwell-Boltzmann Energy Distribution </SPAN></H2><P>Here we will conﬁrm that the kinetic energy distribution of the atoms in a system corresponds to the Maxwell distribution for a given temperature.

</P><P><A href="javascript:ReverseDisplay('hs1')">         Click here to expand</A></P><DIV id="hs1" style="display:none;"><P><B>1.</B> In VMD, load the <I>.psf file</I>. Browse for the restart velocity file (in our case, it was <I>2v0w_hydr_wb_i_eq.restart.vel</I>), the type of ﬁle need this time to be selected. In the Determine ﬁle type: pull-down menu, choose NAMD Binary Coordinates, and load again.

The molecule looks terrible! That is because VMD is reading the velocities as if they were coordinates, but how it looks doesn't matter: we just need VMD to make a file containing the masses and velocities for every atom.
<B>2.</B> We create a selection with all the atoms in the system, by typing in the TkCon window: 
<SPAN style="font-family: Courier;">      set all [atomselect top all] </SPAN> Open a ﬁle energy.dat for writing: 
<SPAN style="font-family: Courier;">      set fil [open energy.dat w] </SPAN><B>3.</B> For each atom in the system, calculate the kinetic energy, and write it to a ﬁle :
<SPAN style="font-family: Courier;">      foreach m [$all get mass] v [$all get {x y z}] { 
      puts $fil [expr 0.5 * $m * [vecdot $v $v] ] 
      } </SPAN>Close the ﬁle: 
<SPAN style="font-family: Courier;">      close $fil  </SPAN>All these steps can be avoided by typing in the Terminal Window:
<SPAN style="font-family: Courier;">      vmd -dispdev text -e get energy.tcl </SPAN>We now have a ﬁle of raw data that can be used to ﬁt the obtained energy distribution to the Maxwell-Boltzmann distribution. The temperature of the distribution can be obtained from that ﬁt.
<B>1.</B> In a Terminal window, type xmgrace. In the xmgrace window, choose the Data → Import → ASCI I menu item. In the Files box, select the ﬁle <I>energy.dat</I>. Click on the OK button. You should see a black trace which correspond to the raw data. 
<B>2.</B> To look at the distribution of points, we will make a histogram of this data. Choose the Data → Transformations → Histograms menu item. In the Source → Set window, click on the ﬁrst line, in order to make a histogram of the data just loaded. 

Click on the Normalize option. 

Fill in Start: 0, Stop at: 10, and # of bins: 100, and Apply. 
<B>3.</B> The plot has been created, but cannot be seen yet. Use the right button of the mouse to click on the ﬁrst set (in the Source → Set window). 
Click on Hide. Now, go to the main Grace window and click on the button labeled AS: it will resize the plot to ﬁt the existing values. This is the distribution of energies. 

Now, we will ﬁt a Maxwell-Boltzmann distribution to this plot and ﬁnd out the temperature that the distribution corresponds to.
<B>4.</B> Choose the Data → Transformations → Non-linear curve ﬁtting menu item. In the Source → Set window, click on the last line, which corresponds to the histogram you created. 
In the Main tab, type in the Formula window: 
<SPAN style="font-family: Courier;">      y = (2/ sqrt(Pi * a0 ∧3 )) * sqrt(x) * exp (-x / a0) </SPAN>This will ﬁt the curve and get a ﬁt for the parameter a0, which corresponds to kB T in units of kcal/mol.
<B>5.</B> In the Parameters drop-down menu, choose 1.  You can give an initial value to A0, so that the iterations will look for a value in the vicinity of your initial guess. In the A0 window, type 0.6, which in kcal/mol corresponds to a temperature of ∼ 300K.
Click on the Apply button. This will open a window with the new value for a0, as well as some statistical measures, including the Correlation Coefficient, which is a measure of the ﬁt.
The value of a<SUB>0</SUB> obtained corresponds to k<SUB>B</SUB>T . Obtain the temperature T for this distribution with k<SUB>B</SUB> = 0.00198657 kcal 
/mol /K.
</P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#ffffff; color:black"><H2><SPAN class="mw-headline" id="Energies"> Energies </SPAN></H2><P>Here we will calculate the average of various energies such as kinetic energy and different internal ones so called bonded energies (bonds, 
angles and dihedrals). Moreover, we will calculate non-bonded energy (electrostatic, van der Waals)) over the course of the equilibration.

</P><P><A href="javascript:ReverseDisplay('hs2')">         Click here to expand</A></P><DIV id="hs2" style="display:none;"><P><B>1.</B> We start with a file obtained from NAMD: http://www.ks.uiuc.edu/Research/namd/utilities/ and download <I> namdstats.tcl </I><B>2.</B> In the VMD TkCon window, type :
<SPAN style="font-family: Courier;">     source namdstats.tcl 
     data avg ../namd_log 101 last </SPAN>The second line will call a procedure which will calculate the average for all output variables in the log ﬁle from the ﬁrst logged timestep after 101 to the end of the simulation.
</P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#ffffff; color:black"><H2><SPAN class="mw-headline" id="Temperature_distribution"> Temperature distribution </SPAN></H2><P>Here we will analyze the temperature distribution over the simulation. The temperature might increase linearly during the heating step and then it might remain stable.
</P><P>We obtained the expected <A href="https://2009.igem.org/wiki/index.php?title=Team:EPF-Lausanne/Results/Validation#Temperature" class="external text" rel="nofollow">results</A>.
</P><P><A href="javascript:ReverseDisplay('hs3')">         Click here to expand</A></P><DIV id="hs3" style="display:none;"><P>In order to obtain the data for the temperature from the log ﬁle we will again use the script <I>namdstats.tcl</I>, which was already sourced. Type in a terminal window:
<SPAN style="font-family: Courier;">      data_time TEMP namd_log </SPAN>It will store each timestep and its corresponding temperature in the file TEMP.dat.
</P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#ffffff; color:black"><H2><SPAN class="mw-headline" id="Density"> Density </SPAN></H2><P>Here we will analyze the behavior of the protein density over the simulation. Normally during the equilibration step density might remain more or less stable. Particularly during the NVT equilibration the density might remain constant. 
</P><P>We obtained the expected <A href="https://2009.igem.org/wiki/index.php?title=Team:EPF-Lausanne/Results/Validation#Density" class="external text" rel="nofollow">results</A>.

</P><P><A href="javascript:ReverseDisplay('hs4')">         Click here to expand</A></P><DIV id="hs4" style="display:none;"><P>

In order to obtain the data for the volume from the log ﬁle we will again use the script <I>namdstats.tcl</I>, which was already sourced. Type in a terminal window:
<SPAN style="font-family: Courier;">      data_time VOLUME namd_log </SPAN>It will store each timestep and its corresponding volume in the file VOLUME.dat.
</P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#ffffff; color:black"><H2><SPAN class="mw-headline" id="Pressure_as_a_function_of_simulation_time"> Pressure as a function of simulation time </SPAN></H2><P>Here we will analyze the pressure behavior along the minimization and the equilibration. This quantity might stabilize after the heating and remain more or less stable during the equilibration. Particularly during the NPT steps the pressure might be strictly constant.
</P><P>We obtained the expected <A href="https://2009.igem.org/wiki/index.php?title=Team:EPF-Lausanne/Results/Validation#Pressure" class="external text" rel="nofollow">results</A>.

</P><P><A href="javascript:ReverseDisplay('hs5')">         Click here to expand</A></P><DIV id="hs5" style="display:none;"><P>

In order to obtain the data for the pressure from the log ﬁle we will again use the script <I>namdstats.tcl</I>, which has been updated for the occasion.
The file can be found <A href="https://static.igem.org/mediawiki/2009/6/67/Namdstats_igem09.txt"> here </A>. Please rename to namdstats<B>.tcl</B> after download.

Here are the steps to use this script:
<SPAN style="font-family: Courier;">      source namdstats.tcl
      data_time DATA_NAME LOG_FILE </SPAN>It will extract data from LOG_FILE, creating a DATA_NAME.dat containing values and time informations.

Available DATA_NAME can be: BOND, ANGLE, DIHED, IMPRP, ELECT, VDW, BOUNDARY, MISC, KINETIC, TOTAL, TEMP, TOTAL2, TOTAL3, TEMPAVG, PRESSURE, GPRESSURE, VOLUME, PRESSAVG, GPRESSAVG.

So, to extract pressure from our first simulation, the command is: data_time PRESSURE namd_log
</P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#E5E9FF; color:black"><H2><SPAN class="mw-headline" id="RMSD_for_individual_residues">RMSD for individual residues</SPAN></H2><P>Here we will calculate the RMSD for each residue to determine which residue move the most. This analysis will help us to see which residue is more or less stable.
After that we will try after that to select the amino acids to mutate in order to stabilize the light activated state of our LOV domain.
</P><P>Click <A href="https://2009.igem.org/wiki/index.php?title=Team:EPF-Lausanne/Results/Validation#RMSD" class="external text" rel="nofollow">here</A> to see the results.

</P><P><A href="javascript:ReverseDisplay('hs6')">         Click here to expand</A></P><DIV id="hs6" style="display:none;"><P>

We aim at finding the average RMSD over time for each residue in the protein using VMD.
<B>1.</B> We load the <I>.psf</I> and <I>.dcd</I> files obtained after the first round of simulation.
<B>2.</B> In the TkCon window type:
<SPAN style="font-family: Courier;">      source residue_rmsd.tcl
      set sel_resid [[atomselect top &quot;protein and alpha&quot;] get resid] </SPAN>This will get all the residues number of all alpha-carbons in the protein. Since there is just one and only one α-carbon per residue, it is a good option.
<B>3.</B> Now we will calculate the RMSD values of all atoms in the newly created selection: 
<SPAN style="font-family: Courier;">      rmsd_residue_over_time top $sel_resid </SPAN>At the end of the calculation, we have a list of the avergae RMSD per residue (in the file residue_rmsd.dat)
<B>Remark</B>: we updated <A href="https://static.igem.org/mediawiki/2009/1/1f/Residue_rmsd_v2.txt"> the script residue_rmsd.tcl</A> to be able to specify on which frames the rsmd has to be computed. Please have a look on this wiki for a more up-to-date version of the file... Command is:
<SPAN style="font-family: Courier;">      rmsd_residue_over_time top $sel resid FIRST_FRAME LAST_FRAME </SPAN><B>4.</B> In VMD, in Graphics → Representations, do the following actions: 
<UL><LI> create two replicates: protein and resname FMN in selected atoms
</LI><LI> for the FMN, choose CPK as a drawing method
</LI><LI> for the protein, choose tube as drawing method, and <I>user</I> as coloring method. Now click on the Trajectory tab, and in the Color Scale Data Range, type 0.40 and 1.00.
</LI></UL>
The protein is colored according to its average RMSD values. The residues displayed in blue are more mobile while the ones in red move less. 

Here is a movie with the protein colored according to average RMSD values: <A href="https://static.igem.org/mediawiki/2009/4/4d/Moving_residue.mov"> video </A><B>5.</B> Now we can plot the RMSD value per residue by typing in a Terminal window :
<SPAN style="font-family: Courier;">      xmgrace residue rmsd.dat </SPAN></P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#E5E9FF; color:black"><H2><SPAN class="mw-headline" id="RMSD_of_selected_atoms_compared_to_initial_position_along_time"> RMSD of selected atoms compared to initial position along time </SPAN></H2><P>Here we will analyze the RMSD of each atom to check whether the protein remains more or less stable during the equilibration.
</P><P>Click <A href="https://2009.igem.org/wiki/index.php?title=Team:EPF-Lausanne/Results/EDS#RMSD" class="external text" rel="nofollow">here</A> to see the results for the dark state simulation.
</P><P>Click <A href="https://2009.igem.org/Team:EPF-Lausanne/Results/ELS#RMSD" class="external text" rel="nofollow">here</A> to see the results for the light state simulation.
</P><P><A href="javascript:ReverseDisplay('hs7')">         Click here to expand</A></P><DIV id="hs7" style="display:none;"><P><B>This script was highly updated, please go to the <A href="https://2009.igem.org/Team:EPF-Lausanne/Scripts">script page</A> if you encounter a problem!!!

Selections are not precise here!</B>

We made a small TCL script to calculate RMSD from selected atoms compared to their initial position along timestep.
The file can be found <A href="https://static.igem.org/mediawiki/2009/a/ad/Residue_rmsd_igem09.txt">here</A>. Please rename to Residue_rmsd_igem09<B>.tcl</B> after download.

Example to run the script:
<SPAN style="font-family: Courier;">     load ''.dcd'' + ''.psf'' on VMD
     source residue_rmsd_igem09.tcl
     set sel_resid [[atomselect top &quot;protein and alpha&quot;] get resid]
     rmsd_residue_over_time top $sel_resid 0 0  </SPAN>
We tried to select only backbone from protein + FMN → change
<SPAN style="font-family: Courier;">     <I>set sel_resid [[atomselect top &quot;backbone&quot;] get resid] </I></SPAN><B>The script was updated to be able to define reference frame and first frame were RMSD will be calculated.</B> We usually don't need to compute RMSD during heating, for instance. RMSD takes a lot of time. In our first run 1 frame = 100 timesteps * 2 fs*timesteps^-1 = 200 fs

complete form for run is:
<SPAN style="font-family: Courier;">     <I>rmsd_residue_over_time top $sel_resid FIRST_FRAME REFERENCE_FRAME</I></SPAN>
For our first run, if we want to select only the 295°K NPT plateau, and set its first frame as reference, we have to launch:
<SPAN style="font-family: Courier;">     <I>rmsd_residue_over_time top $sel_resid 1115 1115</I></SPAN>
Here is how the script processes:
<UL><LI>calculate how many frames are in .dcd
</LI><LI>for each timestep, the script aligns (best fit) the backbone of the protein to the eference position to minimize RMDS. (Test: &quot;and not mass 1,008000&quot; == and noh was added in selection to remove hydrogen)
</LI><LI>for each residue (selected by sel_resid), RMSD is computed and the sum of all RMSD (one for each residue) is stored for current timestep
</LI><LI>script's output is data_rmsd.dat
</LI></UL></P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#ffffff; color:black"><H2><SPAN class="mw-headline" id="Salt_bridges">Salt bridges</SPAN></H2><P>Salt bridges are non-bonded interactions between charged residues. 
</P><P>Here we will analyze the evolution of these interactions over the equilibration in order to check how these interactions change over the equilibration.
</P><P>Click <A href="https://2009.igem.org/wiki/index.php?title=Team:EPF-Lausanne/Results/Validation#Salt_bridges" class="external text" rel="nofollow">here</A> to see the results.
</P><P><A href="javascript:ReverseDisplay('hs8')">         Click here to expand</A></P><DIV id="hs8" style="display:none;"><P>
As we wanted to redo the analysis from Schulten's article, we looked for salt bridges. VMD can easily compute this, it even propose an easy GUI. Standard configuration is just fine for now. You'll have a log file containing the list of nitrogen-oxygen susceptible of forming a salt bridge. You'll also get a file for each bridge containing the distance between both atoms along the simulation.

In the light state, we have 9 salt bridges witin the protein and 12 if we consider the protein and the flavin (use &quot;protein or resname FMN&quot; as selection).
<SPAN style="font-family: Courier;">     ASP471-ARG467
     GLU409-ARG442
     FMN450-FMN450
     ASP540-LYS544
     ASP432-ARG442
     <B>FMN450-ARG451</B>     GLU457-LYS489
     GLU444-LYS485
     ASP522-ARG521
     ASP424-ARG451
     GLU475-LYS533
     <B>FMN450-ARG467</B></SPAN></P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#e7edfd; color:black"><H2><SPAN class="mw-headline" id="RMSF">RMSF</SPAN></H2><P>This is quite similar to the RMSD analysis. Here we will analyze how the RMSF vary for each residues. 
</P><P>Click <A href="https://2009.igem.org/Team:EPF-Lausanne/Results/EDS#RMSF" class="external text" rel="nofollow">here</A> to see the results for the dark state simulation.
</P><P>Click <A href="https://2009.igem.org/Team:EPF-Lausanne/Results/ELS#RMSF" class="external text" rel="nofollow">here</A> to see the results for the light state simulation.
</P><P><A href="javascript:ReverseDisplay('hs9')">         Click here to expand</A></P><DIV id="hs9" style="display:none;"><P>

After changing the script [see <A href="https://2009.igem.org/Team:EPF-Lausanne/Scripts#RMSF_from_namd_.dcd"> here</A>], we perform an interesting analysis from these 2 files. First, we have to correct the RMSF, that can be linked to beta factor using this equation:
If you plot beta factor and RMSF, you get such a thing.

</P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#E5E9FF; color:black"><H2><SPAN class="mw-headline" id="Angles"> Angles </SPAN></H2><P>This part is made to measure the angle between two chains. The procedure is described below.
</P><P>Click <A href="https://2009.igem.org/Team:EPF-Lausanne/Results/EDS#Angle_between_beta_sheet_and_alpha_helix" class="external text" rel="nofollow">here</A> to see the results for the dark state simulation.
</P><P>Click <A href="https://2009.igem.org/Team:EPF-Lausanne/Results/ELS#Angle_between_beta_sheet_and_alpha_helix" class="external text" rel="nofollow">here</A> to see the results for the light state simulation.

</P><P><A href="javascript:ReverseDisplay('hs10')">         Click here to expand</A></P><DIV id="hs10" style="display:none;"><P><OL><LI> open vmd and load the trajectory </LI><LI> go to extensions and choose Tk console </LI><LI> write : <SPAN style="font-family: Courier;"> source <A href="https://static.igem.org/mediawiki/2009/c/c7/Fit_angle.txt"> fit_angle.tcl </A></SPAN></LI><LI> to analyse the trajectory tip the following </LI><UL type="disc"><LI><SPAN style="font-family: Courier;"> sel_angle_frames 0 &quot;resid 522 to 543 and protein&quot; {1 0 0} </SPAN></LI><LI><SPAN style="font-family: Courier;"> sel_sel_angle_frames 0 &quot;resid 522 to 543 and protein&quot; &quot;resid 493 to 498 and protein&quot; </SPAN></LI></UL></OL>
You will obtain a file called angle.dat that contains the angle between the 2 objects that you selected to calculate the angle.

</P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#E5E9FF;"><H2><SPAN class="mw-headline" id="H_bonds_and_distance_measurments"> H bonds and distance measurments </SPAN></H2><P>This part aim at finding characteristic distances, in particular for H-bonds.
</P><P>Click <A href="https://2009.igem.org/Team:EPF-Lausanne/Results/EDS#Some_useful_distances" class="external text" rel="nofollow">here</A> to see the results for the dark state simulation.
</P><P><A href="javascript:ReverseDisplay('hs11')">         Click here to expand</A></P><DIV id="hs11" style="display:none;"><P>
The Jα helix is anchored to the β structure by two H-bond networks involving:
<UL><LI> first Lys533 (in the Jα) and the couple Glu475, Gln497 (β structure) </LI><LI>the second involving Lys413 (Jα) and Thr535 (β structure)</LI></UL>
Here we explain how to plot the relevant H-bond distances (two in the former and one in the latter) for both ‘dark’ and ‘light’ state.

We first load the .psf and .dcd in VMD. Now we will consider the distance between the α carbon of Lysine 533 and of the C carbon of Glu475 and Gln497. 

By typing in the Tk Console window :
<SPAN style="font-family: Courier;">     set sel [atomselect top &quot;resid 533 475 and name CA&quot;]     $sel get index  </SPAN>This gives the indices 533 and 475, and by typing in the Representations window on VMD:
<SPAN style="font-family: Courier;">      resid 533</SPAN> the Lysine in position 533 should appear. Do the same for the other residue.

Now that the two residues are visible, choose the Mouse → Label → Bonds menu item from the VMD Main menu. Click on each atom one after the other. 

In VMD Main menu, select Graphics → Labels. By chosing <I>Bonds</I> we select the distance labeled. The graph tab will create a plot of the distance between these two atoms over time. 
</P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#E5E9FF;"><H2><SPAN class="mw-headline" id="Dihedral_angles"> Dihedral angles </SPAN></H2><P>Dihedral angles measure angle between four atoms.
</P><P>Click <A href="https://2009.igem.org/Team:EPF-Lausanne/Results/EDS#CYS450_-_FMN" class="external text" rel="nofollow">here</A> to see the results for the dark state simulation.
</P><P>Click <A href="https://2009.igem.org/Team:EPF-Lausanne/Results/ELS#CYS450_-_FMN" class="external text" rel="nofollow">here</A> to see the results for the light state simulation.
</P><P><A href="javascript:ReverseDisplay('hs13')">         Click here to expand</A></P><DIV id="hs13" style="display:none;"><P>

The calculation of dihedral angles is very similar to the distance measurement. We first load the .psf and .dcd in VMD.

In the window which displays the protein, zoom on the region of interest, press &quot;4&quot; on your keyboard and select the four atoms within which you would like to calculate the dihedral angle.

Then, open the VMD window &quot;label&quot;, select dihedral, click on the created dihedral, click on the tab &quot;Graph&quot; and finally save the calculated data.

</P></DIV></TH></TR></TBODY></TABLE><TABLE class="wikitable" border="0" cellpadding="10" cellspacing="1" style="padding: 1px; background-color:#007CBC; text-align:center"><TBODY><TR><TH width="20%" align="left" valign="top" style="background:#ffffff; color:black"><H2><SPAN class="mw-headline" id="PCA_Analysis"> PCA Analysis </SPAN></H2><P>PCA is a useful technique used for compression and data classification.
</P><P><A href="javascript:ReverseDisplay('hs14')">         Click here to expand</A></P><DIV id="hs14" style="display:none;"><P>

The aim is to reduce the dimensionality (number of dimensions) of a data ensemble (sample), by finding a new set of variables with a smaller size than the original set of variables. However, this new set must contain the main part of the information: most of the information is kept in a smaller number of variables. 

Information means variation in the sample, et given by the correlation between the original variables. The new variables are called principal components (PC), and are not correlated. They are given by splitting the total information contained in each one.

</P></DIV></TH></TR></TBODY></TABLE></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2009.igem.org/Team:EPF-Lausanne/Analysis_methods">http://2009.igem.org/Team:EPF-Lausanne/Analysis_methods</A>&quot;</DIV><DIV id="footer-box"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:EPF-Lausanne/Analysis_methods" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:EPF-Lausanne/Analysis_methods" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:EPF-Lausanne/Analysis_methods&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:EPF-Lausanne/Analysis_methods&amp;oldid=152099" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2009.igem.org:Privacy_policy" title="2009.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2009.igem.org:General_disclaimer" title="2009.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></BODY></HTML>