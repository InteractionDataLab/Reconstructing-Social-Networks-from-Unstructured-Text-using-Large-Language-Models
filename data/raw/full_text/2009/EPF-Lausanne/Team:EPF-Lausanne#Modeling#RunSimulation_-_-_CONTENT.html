<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_EPF-Lausanne_Modeling_RunSimulation"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu"><UL><LI class="selected"><A href="/Team:EPF-Lausanne/Modeling/RunSimulation">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:EPF-Lausanne/Modeling/RunSimulation&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:EPF-Lausanne/Modeling/RunSimulation&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:EPF-Lausanne/Modeling/RunSimulation&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:EPF-Lausanne/Modeling/RunSimulation" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:EPF-Lausanne/Modeling/RunSimulation</H1><DIV id="bodyContent"><H3 id="siteSub">From 2009.igem.org</H3><DIV style="position: relative; left: 190px; top: -134px; padding: 0px; margin: 0px; border: 0px solid white;z-index:1;"><DIV class="wrapper1"><DIV class="wrapper" style="width:650px;"><DIV class="nav-wrapper"><DIV class="nav"><UL id="navigation" style="width:600px"><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne" target="_self"><SPAN class="menu-mid">Home</SPAN></A></LI><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Team" target="_self"><SPAN class="menu-mid">Team</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Team" target="_self">Presentation</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Team#Where_we_are_from" target="_self">School</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Team_Management" target="_self">Team Management</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Brainstorming" target="_self">Brainstorming</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Sponsors" target="_self">Sponsors</A></LI></UL></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Project_Abstract" target="_self"><SPAN class="menu-mid">Project</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Project_Abstract" target="_self">Abstract</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/LOVTAP" target="_self">Theory</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Strategy" target="_self">Strategy</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Experimental_Setup" target="_self">Experimental Setup</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/LOVTAP_Results" target="_self">Results</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Parts" target="_self">Parts submitted to the Registry</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Future_directions" target="_self">Future directions</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/References" target="_self">References</A></LI></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Modeling_overview" target="_self"><SPAN class="menu-mid">Modeling</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Modeling_overview" target="_self">Modeling overview</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Analysis methods" target="_self">Analysis Methods</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Results" target="_self">Results</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Information_&amp;_references" target="_self">References</A></LI></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Social_overview" target="_self"><SPAN class="menu-mid">Human practices</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Social_overview" target="_self">Overview</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Talks" target="_self">Talks</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Survey" target="_self">Survey</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Media" target="_self">Media</A></LI></DIV><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Safety" target="_self"><SPAN class="menu-mid">Safety</SPAN></A></LI><LI class="#"><A href="https://2009.igem.org/Team:EPF-Lausanne/Notebook" target="_self"><SPAN class="menu-mid">Lab</SPAN></A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Last_News" target="_self">Last News</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Notebook" target="_self">Notebook</A></LI><LI><A href="https://2009.igem.org/Team:EPF-Lausanne/Protocols" target="_self">Protocols used</A></LI></DIV></DIV></DIV></DIV><DIV class="epfltrick"><TABLE id="toc" class="toc"><TBODY><TR><TD><DIV id="toctitle"><H2>Contents</H2></DIV><UL><LI class="toclevel-1 tocsection-1"><A href="#Theory"><SPAN class="tocnumber">1</SPAN><SPAN class="toctext">Theory</SPAN></A></LI><LI class="toclevel-2 tocsection-2"><A href="#Initial_minimization"><SPAN class="tocnumber">1.1</SPAN><SPAN class="toctext">Initial minimization</SPAN></A></LI><LI class="toclevel-2 tocsection-3"><A href="#Heating"><SPAN class="tocnumber">1.2</SPAN><SPAN class="toctext">Heating</SPAN></A></LI><LI class="toclevel-2 tocsection-4"><A href="#First_NPT"><SPAN class="tocnumber">1.3</SPAN><SPAN class="toctext">First NPT</SPAN></A></LI><LI class="toclevel-2 tocsection-5"><A href="#NVT"><SPAN class="tocnumber">1.4</SPAN><SPAN class="toctext">NVT</SPAN></A></LI><LI class="toclevel-2 tocsection-6"><A href="#Second_NPT"><SPAN class="tocnumber">1.5</SPAN><SPAN class="toctext">Second NPT</SPAN></A></LI><LI class="toclevel-2 tocsection-7"><A href="#Final_NPT"><SPAN class="tocnumber">1.6</SPAN><SPAN class="toctext">Final NPT</SPAN></A></LI></UL><LI class="toclevel-1 tocsection-8"><A href="#Launch_the_simulation"><SPAN class="tocnumber">2</SPAN><SPAN class="toctext">Launch the simulation</SPAN></A></LI><LI class="toclevel-2 tocsection-9"><A href="#On_a_single_processor"><SPAN class="tocnumber">2.1</SPAN><SPAN class="toctext">On a single processor</SPAN></A></LI><LI class="toclevel-2 tocsection-10"><A href="#On_a_cluster"><SPAN class="tocnumber">2.2</SPAN><SPAN class="toctext">On a cluster</SPAN></A></LI><LI class="toclevel-2 tocsection-11"><A href="#updalpe1pc9_.epfl.ch_.28UPDALPE1PC9.29"><SPAN class="tocnumber">2.3</SPAN><SPAN class="toctext">updalpe1pc9 .epfl.ch (UPDALPE1PC9)</SPAN></A></LI><LI class="toclevel-2 tocsection-12"><A href="#updalpe1linuxsrv1_.epfl.ch_.28master.cluster.29"><SPAN class="tocnumber">2.4</SPAN><SPAN class="toctext">updalpe1linuxsrv1 .epfl.ch (master.cluster)</SPAN></A></LI></TD></TR></TBODY></TABLE></DIV><DIV class="epfl09"><H1><SPAN class="mw-headline" id="Theory">Theory</SPAN></H1><P>The .pdb is generated from X-ray diffraction crystallography. This process requires a crystal of the protein, which occurs only at low temperature (~5°K). Taking this in consideration, we have to go through different steps to bring our protein to lab conditions.
<B>Please refer to the page on <A href="/Team:EPF-Lausanne/Modeling/NamdConf" title="Team:EPF-Lausanne/Modeling/NamdConf">.conf parameters</A> to see how to perform these steps in namd.</B></P><H2><SPAN class="mw-headline" id="Initial_minimization">Initial minimization</SPAN></H2><P>We start with a few minimization rounds, to reach a minimum in the sense of potential energy.
</P><H2><SPAN class="mw-headline" id="Heating">Heating</SPAN></H2><P>When the protein is stable, we have to add heat (kinetic energy) to reach a higher temperature (~300°K). We have to take a special care not to add heat too fast, which would result in protein burst and explosion of our system.
</P><H2><SPAN class="mw-headline" id="First_NPT">First NPT</SPAN></H2><P>This is a relaxation step, with the number of atoms N, the pressure P and the temperature T all kept constant (NPT step). This is a kind of homogenization of the distribution of atoms inside our box.
</P><H2><SPAN class="mw-headline" id="NVT">NVT</SPAN></H2><P>This is also a relaxation step, with atom number, volume and temperature constant.
</P><H2><SPAN class="mw-headline" id="Second_NPT">Second NPT</SPAN></H2><P>Now we perform another relaxation NPT to reach lab conditions.
</P><H2><SPAN class="mw-headline" id="Final_NPT">Final NPT</SPAN></H2><P>This is the final NPT, which last much longer and gives us the ouput of the simulation.
</P><H1><SPAN class="mw-headline" id="Launch_the_simulation">Launch the simulation</SPAN></H1><H2><SPAN class="mw-headline" id="On_a_single_processor">On a single processor</SPAN></H2><P>Here is a safe command. It will send the output to a file (&gt; outpu...) and be run in the background (&amp;).
</P><DL><DD><I>namd2 CONFIG_FILE.conf &gt; output/namd_log &amp;</I></DD></DL><H2><SPAN class="mw-headline" id="On_a_cluster">On a cluster</SPAN></H2><P>This is performed using a library that will split the process between nodes.
</P><H2><SPAN class="mw-headline" id="updalpe1pc9_.epfl.ch_.28UPDALPE1PC9.29">updalpe1pc9 .epfl.ch (UPDALPE1PC9)</SPAN></H2><P>The path to the binary has to be localized using: <I>which namd2</I>. The option +p4 specifies how many procs we are using (don't ue more than 4 on this cluster!). The rest is similar to single processor launch. We use this computer to visualize or perform small stabilization.
</P><DL><DD><I>charmrun /usr/local/bin/namd2 +p4 ++local 2v0w_hydr_wb_eq_try.conf &gt; ./output_eq2/namd_log &amp;</I></DD></DL><H2><SPAN class="mw-headline" id="updalpe1linuxsrv1_.epfl.ch_.28master.cluster.29">updalpe1linuxsrv1 .epfl.ch (master.cluster)</SPAN></H2><P>This is the real cluster.
We need to create a script to launch the job using the mpi.
Here is a sample:
</P><DL><DD><OL><LI><I>#!/bin/bash</I></LI><LI><I>#$ -N 2v0u_16</I></LI><LI><I>#$ -S /bin/bash</I></LI><LI><I>#$ -cwd</I></LI><LI><I>#$ -j y</I></LI><LI><I>#$ -pe mpi 64</I></LI><LI><I>source /home/igem/.bashrc</I></LI><LI><I>cd /home/igem/2v0u</I></LI><LI><I>#iniciate mpd on every node (needed when using intel MPI)</I></LI><LI><I>export MPD_CON_EXT=&quot;sge_$JOB_ID.$TASK_ID&quot;</I></LI><LI><I>sort -u &lt; $TMPDIR/machines &gt; $TMPDIR/mpdhosts</I></LI><LI><I>mpdboot -n 8 -f $TMPDIR/mpdhosts -r ssh</I></LI><LI><I>#launch job</I></LI><LI><I>mpiexec -genv I_MPI_FALLBACK_DEVICE 0 -genv I_MPI_DEVICE rdssm  -machinefile $TMPDIR/machines -np 64 /opt/namd/namd2  NPT_simulation_2v0u_64.conf &gt; ./output_sim_64/namd_log</I></LI><LI><I>#terminate mpd at the end of execution</I></LI><LI><I>mpdallexit</I></LI><LI><I>rm -f $TMPDIR/mpdhosts</I></LI></OL></DD></DL><P>line 1-6 are not comments, they are interpreted by the mpi. Here are the lines that have to be customized before launch:
</P><DL><DD>2.  This is the name that will be displayed for the job, precise the prot you are working on.
</DD><DD>6.  Number of procs you want to use. We use only power of 2 because of PME and multiple of 8 because of the architecture of the cluster.
</DD><DD>8.  Working directory
</DD><DD>12. You have to launch one mpd on each node you are using. Each node has 8 procs, so start the superior integer of #procs/8. For instance, if you want to start 27 procs (baaaaad but representative example...), you have to write mpdboot -n 4
</DD><DD>14. -np otions precise once again how many procs are used
</DD></DL></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2009.igem.org/Team:EPF-Lausanne/Modeling/RunSimulation">http://2009.igem.org/Team:EPF-Lausanne/Modeling/RunSimulation</A>&quot;</DIV><DIV id="footer-box"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:EPF-Lausanne/Modeling/RunSimulation" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:EPF-Lausanne/Modeling/RunSimulation" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:EPF-Lausanne/Modeling/RunSimulation&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:EPF-Lausanne/Modeling/RunSimulation&amp;oldid=118641" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2009.igem.org:Privacy_policy" title="2009.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2009.igem.org:General_disclaimer" title="2009.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></BODY></HTML>