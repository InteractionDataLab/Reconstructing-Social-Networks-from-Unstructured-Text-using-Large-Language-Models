<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Freiburg_Software_Developer_Guide"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Freiburg_Software/Developer/Guide">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Freiburg_Software/Developer/Guide&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Freiburg_Software/Developer/Guide&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Freiburg_Software/Developer/Guide&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Freiburg_Software/Developer/Guide" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform">Â </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Freiburg Software/Developer/Guide</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2010.igem.org</H3><DIV id="menu_top"><DIV class="menu_button_top" id="home"><A href="https://2010.igem.org/Team:Freiburg_Software">Home</A></DIV><DIV class="menu_button_top" id="notebook"><A href="https://2010.igem.org/Team:Freiburg_Software/Notebook">Notebook</A></DIV><DIV class="menu_button_top" id="meetings"><A href="https://2010.igem.org/Team:Freiburg_Software/Meetings">Meetings</A></DIV></DIV><DIV id="menu_left"><DIV class="menu_button_left" id="team"><A href="https://2010.igem.org/Team:Freiburg_Software/Team">Team</A></DIV><DIV class="menu_button_left_sub" id="subTeam2010"><A href="https://2010.igem.org/Team:Freiburg_Software/Team/2010">2010</A></DIV><DIV class="menu_button_left_sub" id="subTeamPic"><A href="https://2010.igem.org/Team:Freiburg_Software/Team/Photos">Photos</A></DIV><DIV class="menu_button_left_sub" id="subTeamCol"><A href="https://2010.igem.org/Team:Freiburg_Software/Team/Collaboration">Collaboration</A></DIV><DIV class="menu_button_left" id="project"><A href="https://2010.igem.org/Team:Freiburg_Software/Project">Project</A></DIV><DIV class="menu_button_left_sub" id="subProjectProspect"><A href="https://2010.igem.org/Team:Freiburg_Software/Project/Prospect">Prospect</A></DIV><DIV class="menu_button_left_sub" id="subProjectHistory"><A href="https://2010.igem.org/Team:Freiburg_Software/Project/History">History</A></DIV><DIV class="menu_button_left" id="user"><A href="https://2010.igem.org/Team:Freiburg_Software/User">User</A></DIV><DIV class="menu_button_left_sub" id="subUserGuide"><A href="https://2010.igem.org/Team:Freiburg_Software/User/Guide">User Guide</A></DIV><DIV class="menu_button_left_sub" id="subUserRobot"><A href="https://2010.igem.org/Team:Freiburg_Software/User/Robots">The Robots</A></DIV><DIV class="menu_button_left" id="developer"><A href="https://2010.igem.org/Team:Freiburg_Software/Developer">Developer</A></DIV><DIV class="menu_button_left_sub" id="subDeveloperGuide"><A href="https://2010.igem.org/Team:Freiburg_Software/Developer/Guide">Guide</A></DIV><DIV class="menu_button_left_sub" id="subDeveloperTech"><A href="https://2010.igem.org/Team:Freiburg_Software/Developer/Technologies">Technologies</A></DIV><DIV class="menu_button_left_sub" id="subDeveloperArch"><A href="https://2010.igem.org/Team:Freiburg_Software/Developer/Architecture">Architecture</A></DIV><DIV class="menu_button_left_sub" id="subDeveloperAvai"><A href="https://2010.igem.org/Team:Freiburg_Software/Developer/Availability">Availability</A></DIV><DIV class="menu_button_left" id="human"><A href="https://2010.igem.org/Team:Freiburg_Software/HumanPractise">Human Practice</A></DIV></DIV><DIV id="main_area"><H1>Developer Guide</H1><P class="main">
One main goal of SynBioWave is extendability. If you are missing some functionality using SynBioWave, you can create your own robot implementing it.</P><H2>1. Basic setup</H2><P class="main">
A SynBioWave-Robot is an extended Wave-Robot. So first, you need to create a normal Wave-Robot following the steps described in the <A href="http://code.google.com/intl/de-DE/apis/wave/extensions/robots/java-tutorial.html" target="_blank">Google Robot Tutorial</A>. Reading is highly recommended, since this forms the basis for our robots. We have put a lot of effort in extending Wave-Robot programming to include robot-robot communication and the use of a common pull-down menu structure.

Following the Google Robot Tutorial, you should get a servlet class in the <CODE>src/</CODE> directory, some jar's under <CODE>war/WEB-INF/lib</CODE> and configured  <CODE>war/WEB-INF/appengine-web.xml</CODE> and <CODE>war/WEB-INF/web.xml</CODE> files.

We now need to further extend this layout to add the SynBioWave-functionality:
</P><H3>Add the jar files used by SynBioWave</H3><P class="main">
Download biojava.jar from <A href="http://biojava.org/wiki/BioJava:Download">http://biojava.org/wiki/BioJava:Download</A> and the latest latest version of synbiowave.jar from <A href="http://sourceforge.net/projects/synbiowave/">http://sourceforge.net/projects/synbiowave/</A> (<A href="https://static.igem.org/mediawiki/2010/1/18/SynBioWave-V2.zip">or this wiki)</A>) to your <CODE>war/WEB-INF/lib</CODE> folder and add these libraries to your project <A href="http://code.google.com/intl/de-DE/apis/wave/extensions/robots/java-tutorial.html#Hello_Robot">as you did before</A>.
</P><H3>Add the OAuth login for the Active API</H3><P class="main">
First register your robot on Google's <A href="http://wave.google.com/wave/robot/register" target="_blank">robot registration page</A>.
After submitting the form, you will receive a &quot;<EM>Verification Token&quot;</EM> and a &quot;<EM>Security Token&quot;.
<SPAN style="font-style: normal;">At the end of the received text, you see a &quot;verify&quot; - button. Keep the browser tab open, as you will need this a little later. </SPAN></EM>

Create a public constructor in your robots servlet class with the following content:</P><PRE class="box_code"><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">public YourRobot() {
  String verificationToken = &quot;<EM>VERIFICATION_TOKEN</EM>&quot;;
</SPAN><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">  String securityToken = &quot;<EM>SECURITY_TOKEN</EM>&quot;;
</SPAN><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">  super.setupVerificationToken(verificationToken, securityToken);
</SPAN><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">}</SPAN></PRE><P class="main">
Upload your robot to AppEngine and go back to the browser tab. Press the &quot;verify&quot;-button and you will be presented with your robots OAuth login information ( &quot;<EM>Consumer Key</EM>&quot; and &quot;<EM>Consumer Secret</EM>&quot; ).

Now change the basic contructor of your robot such that it looks like the following:
</P><PRE class="box_code"><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">public YourRobot() {
</SPAN><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">  super.setupOAuth(&quot;Consumer Key&quot;,&quot;Consumer Secret&quot;,&quot;http://gmodules.com/api/rpc&quot;);
</SPAN><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">  super.setupOAuth(&quot;Consumer Key&quot;,&quot;Consumer Secret&quot;,&quot;http://sandbox.gmodules.com/api/rpc&quot;);
</SPAN><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">  super.setAllowUnsignedRequests(true);
</SPAN><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">}</SPAN></PRE><P class="main">
Now your robot is ready for the use of the Active API, both in the preview and the sandbox client. This is required for the use of the SynBioWave API, especially for the use of the sequence workspace.

For further information please have a look on the <A href="http://code.google.com/intl/de-DE/apis/wave/extensions/robots/operations.html#ActiveRobotAPI" target="_blank">official Active API page</A>.
</P><H3>Extend the servlet</H3><P class="main">
Now open the main servlet, and let your main class extend the <EM>AbstractSynBioWaveRobo</EM>t class instead of the normal <EM>AbstractRobot </EM>class:

Change</P><PRE class="box_code">public class RobotServlet extends AbstractRobot {</PRE><P class="main">to</P><PRE class="box_code">public class RobotServlet extends AbstractSynBioWaveRobot {</PRE><P class="main">SynBioWave needs to be called by the onGadgetStateChanged and onWaveletSelfAdded-event, so add the lines</P><PRE class="box_code">@Override
public void onGadgetStateChanged(GadgetStateChangedEvent event){
   super.onSynBioWaveGadgetChanged(event);
}

@Override
public void onWaveletSelfAdded(WaveletSelfAddedEvent event) {
   super.onSynBioWaveRobotSelfAdded(event);
}</PRE><P class="main">
It is important that the super.onSynBioWaveRobotSelfAdded() and super.onSynBioWaveGadgetChanged() functions are called. Of course you can add code to these events (best after the existing function) and/or register other wave-events as well.

Furthermore, you need a function to extend SynBioWave's user interface, so add:</P><PRE class="box_code">@Override
public void createMenu(MenuItem menu, MenuItemFactory mif, Event event) throws Exception {
}</PRE><P class="main">
The last thing to do is to import the required classes:</P><PRE class="box_code">import org.synbiowave.AbstractSynBioWaveRobot;
import org.synbiowave.menu.MenuItem;
import org.synbiowave.menu.MenuItemFactory;</PRE><P class="main">
This completes the basic layout. You can compare your file with our <A href="http://synbiowave.svn.sourceforge.net/viewvc/synbiowave/stable/robot-blueprint/src/org/synbiowave/robotblueprint/RobotBlueprintServlet.java?view=markup">blueprint robot</A>.</P><H2>2. Creating menu items</H2><P class="main">
To add an item to the SynBioWave menu bar, you can create the item using the <CODE>MenuItemFactory</CODE> you got as parameter in the <CODE>createMenu</CODE> function:</P><PRE class="box_code">MenuItem hello = mif.createButton(&quot;Hello World&quot;);</PRE><P class="main">
Where &quot;Hello World&quot; is the label of the button.
This button is added to the toolbar by adding it to the given</P><PRE class="box_code">MenuItem menu</PRE><P class="main">(which repesents the menu-toolbar) as a subitem:</P><PRE class="box_code">menu.appendSubItem(hello);</PRE><P class="main">The whole function should now look like</P><PRE class="box_code">public void createMenu(MenuItem menu, MenuItemFactory mif) throws Exception {
	MenuItem hello = mif.createButton(&quot;Hello World&quot;);
	menu.appendSubItem(hello);
}</PRE><P class="main">
Now, it's a good time to <A href="http://code.google.com/intl/de-DE/apis/wave/extensions/robots/java-tutorial.html#Deploying">deploy</A> the robot to AppEngine, create a new Wave, add the SynBioWave-Robot, add your robot to the wave and watch the new &quot;Hello World&quot;-button appear.</P><H2>3. Add functionality to menu items</H2><P class="main">
At the moment, the button doesn't do anything when clicked. SynBioWave uses callbacks to react on menu events.
First, you need to create a new class (in this example named Callback.java) extending MenuCallBack:</P><PRE class="box_code">public final class BlastCallback extends MenuCallBack {
	public void onButtonClicked(Event event, MenuItem menuItem,
				 AbstractSynBioWaveRobot servlet) {}
}</PRE><P class="main">
The function onButtonClicked is called when the corresponding button is pressed. As you get an event, you can do everything you could do on &quot;normal&quot; wave events, for example add an new blip to the wave:</P><PRE class="box_code">public final class BlastCallback extends MenuCallBack {
	public void onButtonClicked(Event event, MenuItem menuItem,
				 AbstractSynBioWaveRobot servlet) {
		event.getBlip().reply().append(&quot;Button pressed\n&quot;);
	}
}</PRE><P class="main">
Now that you completed the callback, you need to connect it with the button you created before. Go back to the main servlet and add</P><PRE class="box_code">this.connectMenuCallBack(hello, new Callback());</PRE><P class="main">inside of the createMenu function (again import your Callback class of course):</P><PRE class="box_code">public void createMenu(MenuItem menu, MenuItemFactory mif) throws Exception {
	MenuItem hello = mif.createButton(&quot;Hello World&quot;);
	menu.appendSubItem(hello);
	this.connectMenuCallBack(hello, new callback());
}</PRE><P class="main">
Now your robot should add a reply with &quot;Button pressed&quot; to the root-blip of the wave, which contains the menu and therefore is referred to as active blip in the &quot;event&quot; event.</P><H2>4. Create and receive sequences</H2><P class="main">
This chapter will give you a brief introduction in SynBioWave's internal sequence usage.</P><H3>Create a new sequence</H3><P class="main">Nothing easier like this:</P><PRE class="box_code"><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">Sequence sequence=new Sequence(&quot;<EM>Name</EM>&quot;,&quot;<EM>Sequence</EM>&quot;);
sequence.setAuthor(&quot;<EM>Author</EM>&quot;);
sequence.addAnnotation(&quot;<EM>Feature Name</EM>&quot;,1,15);
sequence.publish(robot,wavelet,true);</SPAN></PRE><P class="main">
With the publish() method of your created sequence class, you add the sequence to the workspace. The boolean parameter of the publish() method sets the initial active state of the sequence in the workspace.

You can work on this sequence and change the values as needed. The changes will be presented in the workspace as soon as you use the publish() function again.</P><H3>Receiving sequences from the workspace</H3><P class="main">
Again, very easy:</P><PRE class="box_code"><SPAN style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; line-height: 18px; font-size: 12px; white-space: pre;">List&lt;Sequence&gt; sequences=Workspace.getActiveSequences(servlet,event.getWavelet());
if(sequences!=null){
  for(Sequence sequence:sequences){
    //do everything you want with the sequences
    //remember that you have to use the publish()
    //function of the sequence to update the
    //sequence changes in the workspace
  }
}</SPAN></PRE><P class="main">
For further information, please have a look at our <A href="http://www.synbiowave.org/docu/api/" target="_blank">SynBioWave API doc</A> (http://www.synbiowave.org/docu/api/).
</P></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2010.igem.org/Team:Freiburg_Software/Developer/Guide">http://2010.igem.org/Team:Freiburg_Software/Developer/Guide</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Freiburg_Software/Developer/Guide" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Freiburg_Software/Developer/Guide" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Freiburg_Software/Developer/Guide&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Freiburg_Software/Developer/Guide&amp;oldid=157715" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2010.igem.org:Privacy_policy" title="2010.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2010.igem.org:General_disclaimer" title="2010.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>