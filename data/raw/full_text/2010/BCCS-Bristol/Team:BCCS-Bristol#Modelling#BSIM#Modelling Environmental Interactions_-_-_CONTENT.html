<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_BCCS-Bristol_Modelling_BSIM_Modelling_Environmental_Interactions"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:BCCS-Bristol/Modelling/BSIM/Modelling Environmental Interactions</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2010.igem.org</H3><DIV id="headwrapper"><DIV id="header_image"><DIV id="header_text">
BCCS-Bristol
<SPAN style="font-size: small">iGEM 2010</SPAN></DIV></DIV><DIV id="navwrapper"><UL id="nav"><LI><A href="https://2010.igem.org/Team:BCCS-Bristol">Home</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Project">Project Abstract</A></LI></UL><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab">Wet lab</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Achievements">Achievements</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Part_Design/BioBricks/PyeaR">Our Biobrick»</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Part_Design/BioBricks/PyeaR">BBa_K381001</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Part_Design/Components/Promoters">Promoters</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Part_Design/Components/Reporters">Reporters</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Part_Design/BioBricks/PyeaR%2BLacZ">PyeaR + LacZ</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Part_Design/Components/LacZ">LacZ</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Beads">Beads »</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Beads/Gellan">Gellan</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/making_beads">Procedure</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Beads/ImageGallery">Image Gallery</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Experiments">Lab Work »</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/standard_protocols">Standard Protocols</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/K381001_Construction">K381001 Construction</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/K381001_Characterisation">K381001 Characterisation</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/signal_soil">Detecting Signals in Soil</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/making_beads">Making Beads</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/difference_solution">Beads in Solution</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/difference_soil">Beads in Soil</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/characterising_ratio">Signal Calibration</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/RFPbead_tests">Final Beads</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/BetaGalactosidaseAssays">Miller Assays</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Improvements">Improvements</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Wetlab/Safety">Safety</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Modelling">Modelling</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Modelling/BSIM">BSim »</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions">Environmental Modelling</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Modelling/BSIM/GUI">GUI</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Modelling/BSIM/Results">Results</A></LI><LI><A href="http://code.google.com/p/bsim-bccs/">Download</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Modelling/GRN">GRN »</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Modelling/GRN/Derivation">Derivation</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Modelling/GRN/Methodology">Methodology</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Modelling/GRN/Results">Results</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Modelling/Supporting_Human_Practices">Cost Calculation</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Human_Practices">Human Practices</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Human_Practices/Marketing_Campaign">Publicity Campaign »</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Human_Practices/Marketing_Campaign/Motivation">Motivation</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Human_Practices/Marketing_Campaign/Product_Specification">Product Spec.</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Human_Practices/Marketing_Campaign/Public_Perception">Public Perception</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Human_Practices/Marketing_Campaign/Materials_and_Description">Materials</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Human_Practices/Marketing_Campaign/Campaign_Development">Campaign</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Human_Practices/Public_Engagement">Public Engagement</A></LI><LI><A href="https://2010.igem.org/Team:BCCS-Bristol/Team">Team</A></LI></DIV></DIV><CENTER> • <B>Modelling Environmental Interactions</B>  • <B><A href="/Team:BCCS-Bristol/Modelling/BSIM/GUI" title="Team:BCCS-Bristol/Modelling/BSIM/GUI">Graphical User Interface</A></B> • <B><A href="/Team:BCCS-Bristol/Modelling/BSIM/Results" title="Team:BCCS-Bristol/Modelling/BSIM/Results"> Results</A></B> • 
<B><A href="http://code.google.com/p/bsim-bccs/" class="external text" rel="nofollow">Install BSIM</A></B> • </CENTER><H1><SPAN class="mw-headline" id="Modelling_Environmental_Interactions">Modelling Environmental Interactions</SPAN></H1><H2><SPAN class="mw-headline" id="Introduction">Introduction</SPAN></H2><DIV style="float: right; margin: 0 1em 1em 2em; width: 40%"><TABLE id="toc" class="toc"><TBODY><TR><TD><DIV id="toctitle"><H2>Contents</H2></DIV><UL><LI class="toclevel-1 tocsection-1"><A href="#Modelling_Environmental_Interactions"><SPAN class="tocnumber">1</SPAN><SPAN class="toctext">Modelling Environmental Interactions</SPAN></A></LI><LI class="toclevel-2 tocsection-2"><A href="#Introduction"><SPAN class="tocnumber">1.1</SPAN><SPAN class="toctext">Introduction</SPAN></A></LI></UL><LI class="toclevel-1 tocsection-3"><A href="#Implementation"><SPAN class="tocnumber">2</SPAN><SPAN class="toctext">Implementation</SPAN></A></LI><LI class="toclevel-2 tocsection-4"><A href="#Overview"><SPAN class="tocnumber">2.1</SPAN><SPAN class="toctext">Overview</SPAN></A></LI><LI class="toclevel-2 tocsection-5"><A href="#Representing_3D_Shapes"><SPAN class="tocnumber">2.2</SPAN><SPAN class="toctext">Representing 3D Shapes</SPAN></A></LI><LI class="toclevel-2 tocsection-6"><A href="#Collisions"><SPAN class="tocnumber">2.3</SPAN><SPAN class="toctext">Collisions</SPAN></A></LI><LI class="toclevel-2 tocsection-7"><A href="#Computing_Diffusion"><SPAN class="tocnumber">2.4</SPAN><SPAN class="toctext">Computing Diffusion</SPAN></A></LI><LI class="toclevel-1 tocsection-8"><A href="#Octrees"><SPAN class="tocnumber">3</SPAN><SPAN class="toctext">Octrees</SPAN></A></LI><LI class="toclevel-2 tocsection-9"><A href="#Overview_2"><SPAN class="tocnumber">3.1</SPAN><SPAN class="toctext">Overview</SPAN></A></LI><LI class="toclevel-2 tocsection-10"><A href="#Methods"><SPAN class="tocnumber">3.2</SPAN><SPAN class="toctext">Methods</SPAN></A></LI><LI class="toclevel-2 tocsection-11"><A href="#Splitting_the_Octree"><SPAN class="tocnumber">3.3</SPAN><SPAN class="toctext">Splitting the Octree</SPAN></A></LI></TD></TR></TBODY></TABLE></DIV><P>BSim carries out its simulations in a three dimensional space. This is necessary for many simulations
involving populations of bacteria and modelling their interactions. In ﬁgure 1, for example, you
can see an example of bacteria emitting and merging with vesicles in three dimensions. They are
modelled as being in water, with periodic boundary conditions (meaning that if you go out of
the top of the box you re-appear at the bottom). This creates a continuous domain, which is ﬁne
for modelling the conditions inside a test tube where the environment is large enough compared to
the items being modelled that it is effectively infinite.
</P><P>Some of the modelling questions that we want to answer in this project pertain to environments
that are of the same scale as the bacteria. One important question is how <I>E. coli</I> move inside the
micro-structure of the gellan beads' gel matrix (figure 2). This is important as it will determine how much of the <I>E. coli</I> escapes the bead environment over time. Another question that could be answered via accurate
modelling of surfaces in BSim would be how exactly nitrate diffuses from the soil contact area of
the bead and into the micro-structure of the gellan bead. This would provide an insight into how
homogeneous the nitrate concentrations inside the bead are.
</P><TABLE class="gallery" cellspacing="0" cellpadding="0"><TBODY><TR><TD><DIV class="gallerybox" style="width: 235px;"><DIV class="gallerytext"><P>Figure 1
</P></DIV></DIV></TD><TD><DIV class="gallerybox" style="width: 235px;"><DIV class="gallerytext"><P>Figure 2
</P></DIV></DIV></TD></TR></TBODY></TABLE><H1><SPAN class="mw-headline" id="Implementation">Implementation</SPAN></H1><H2><SPAN class="mw-headline" id="Overview">Overview</SPAN></H2><P>There are two computational structures that need to take account of complex three dimensional
structures if these features are to be implemented. One is the ability to represent a 3D shape inside
the BSim environment, for example to provide a boundary, the other is the ability to represent a
chemical ﬁeld deﬁned by such a 3D shape.
</P><H2><SPAN class="mw-headline" id="Representing_3D_Shapes">Representing 3D Shapes</SPAN></H2><P>In the early design phase of AgrEcoli, it quickly became evident that we would need to simulate some form of interaction between a bacterial population and its environment. Common analytical shapes (those that can be defined directly via a set of equations, for example a sphere) are somewhat limited when it comes to representing real-world objects. Fortunately there are a number of methods for specifying an arbitrary boundary in three dimensional space, such as through a set of parametric curves or via constructive solid geometry (often this involves combining a set of analytical shapes). However, the most common method throughout the field of computational geometry is to use a polyhedral mesh.
</P><P>A polyhedral mesh can represent almost any three dimensional structure to an arbitrary degree of precision, so it was this type of 3D structure that we decided to use to represent boundaries. BSim currently supports arbitrary triangle-based meshes, which may contain both convex and concave regions as well as holes. Triangle meshes are the most common type of mesh output from computational geometry algorithms and from 3D modelling software, and are the simplest and most robust type of mesh one can use; almost any meshes of greater complexity can be simplified to a triangle mesh. BSim implements triangle meshes using a face-vertex representation internally. It currently supports direct import of .OBJ files, one of the most common file formats used for exchange of 3D mesh information, and standardised across the industry.
</P><H2><SPAN class="mw-headline" id="Collisions">Collisions</SPAN></H2><DIV class="thumb tleft"><DIV class="thumbinner" style="width:202px;"><DIV class="thumbcaption">fig 1</DIV></DIV></DIV><P>As well as implementing meshes into BSim, we also added routines for computing collision events. This allows the user to detect when any object comes into contact with a mesh boundary and to respond as required. Although the default behaviour of BSim is to use the mesh as a boundary to restrict bacterial movement, it is trivial to add other responses. Possible complex responses include detecting the collision of chemicals, for example proteins, with a cell surface represented by a mesh boundary, or extending BSim to include biofilms. 
</P><H2><SPAN class="mw-headline" id="Computing_Diffusion">Computing Diffusion</SPAN></H2><P>The diffusion of chemicals across the chemical field must be also computed. This involves
solving a differential equation across an arbitrarily shaped 3D space. There are two broad classes
of methods that are used to do this, finite element methods and finite difference methods.
</P><P>A finite element approach would use the mesh as a basis to generate a series of discrete units
across which to calculate a discretised approximation system of ordinary differential equations. This
is difficult to do reliably with arbitrary shapes. There exist several different algorithms that work
well with different types of spaces (smooth, jagged, convex, concave) but it is difficult to implement
a finite element method that works reliably in an arbitrary geometry without numerical instability.
An example of a tessellation of triangles used to compute a finite element method approach can be
seen in fig. 2(a). An accurate finite element model would converge to the analytical solution as the
mesh became finer and finer, unfortunately this is difficult to do in generality, such a model which
would be necessary for a robust addition to this modelling framework.
</P><P>A finite difference method discretises and computes a differential equation over a regular lattice,
e.g. fig. 2(b) This means that it is much more numerically stable than the finite element method.
The trade-off is that you have to partition the space along the lines of this regular grid. Which is not
a very accurate representation of curves unless the resolution of the lattice is very high compared
to the resolution of the curved object that you wanted to represent.
</P><TABLE class="gallery" cellspacing="0" cellpadding="0"><TBODY><TR><TD><DIV class="gallerybox" style="width: 235px;"><DIV class="gallerytext"><P>fig 2a
</P></DIV></DIV></TD><TD><DIV class="gallerybox" style="width: 235px;"><DIV class="gallerytext"><P>fig 2b
</P></DIV></DIV></TD></TR></TBODY></TABLE><P>The solution that we decided to use to implement the chemical ﬁeld processing is an ' <A href="/Team:BCCS-Bristol/Modelling/BSIM/Geometric_Modelling/Octrees" title="Team:BCCS-Bristol/Modelling/BSIM/Geometric Modelling/Octrees">octree</A>' structure. This is a hybrid between the two methods, though is more closely related to the ﬁnite
diﬀerence method. This uses a regular lattice of cubes, but changes the resolution of the lattice
as it is partitioned by a mesh surface. This technique is visualized in ﬁg. 10, note how the lattice
resolution increases around the sphere mesh, this allows for a more accurate division of the lattice
into a sphere shape. An octree structure will never be able to perfectly duplicate the shape of the
mesh that it is cast from, but the maximum resolution can be far higher than a regular lattice
with respect to its memory requirements because it only divides itself into a high resolution where
necessary.
</P><H1><SPAN class="mw-headline" id="Octrees">Octrees</SPAN></H1><H2><SPAN class="mw-headline" id="Overview_2">Overview</SPAN></H2><DIV class="thumb tright"><DIV class="thumbinner" style="width:252px;"><DIV class="thumbcaption">Fig. 1. Schematic illustration of how an octree subdividies in space (left) and how this is represented as a node and leaf data structure (right). In this example the highest resolution node is of depth 3.</DIV></DIV></DIV><P>The octree is a tree type data structure. This a hierarchical data structure comprised of nested
nodes. Each node has one parent and either eight or zero children. Nodes with zero children are
called leaves. A node's children subdivide the volume of their parent into eight smaller volumes.
Figure 1 shows how an octree partitions space into smaller and smaller volumes and how this can
be represented by a tree data structure.
</P><H2><SPAN class="mw-headline" id="Methods">Methods</SPAN></H2><P>Each node stores the quantity of chemical and the diﬀusivity constant for its ﬁeld. Nodes know
what depth they are inside the octree structure and which nodes are their neighbours. This is
re-computed each time a node is split it is necessary to know who your neighbors are in order to
compute the diﬀusion of chemicals through the ﬁeld from one node to those spatially adjacent (i.e.
not necessarily nodes of the same parent).
</P><P>To be able to perform operations across an octree data structure it is necessary to use a traversal
algorithm. This is an algorithm that visits each node. There are many diﬀerent ways of doing this,
the method used in BSim is the ‘full post-order’ traverse. This visits each node from deepest depth
ﬁrst, then the second deepest etcetera until it reaches the parent node.
</P><PRE>
PostOrderTraverse(Node)

{
    IF(Node != leaf){
        FOR(i=0:8){
        PostOrderTraverse(Node.subNodes[i])}
        VISIT(Node)
   }

}
</PRE><H2><SPAN class="mw-headline" id="Splitting_the_Octree">Splitting the Octree</SPAN></H2><DIV class="thumb tright"><DIV class="thumbinner" style="width:252px;"><DIV class="thumbcaption">Fig. 2. An example of quadtree partitioning, as the maximum depth increases, the partition more closely approximates the curve</DIV></DIV></DIV><P>The octree data structure is used for holding and computing the chemical ﬁeld because it is able
to approximately represent ﬁelds of arbitrary shapes. This is done by splitting an octree from a
parent node around a mesh shape. It is easier to explain in terms of the two dimensional quadtree,
the principle is exactly the same for an octree, an example is shown in ﬁg. 2.
</P><P>This example has a maximum depth of three, the example of an octree partition in ﬁg. 2 has a depth of 5. The
maximum resolution increases exponentially with depth, a depth of 7 appears to be adequate for
reasonably complex shapes, e.g. the mesh of a gel strand.
</P><P>The algorithm for splitting the octree around a mesh is relatively simple. It uses the post order
traverse function above to access each octree node from the bottom to the top. The following
function would be in place of the ‘VISIT’ command:
</P><PRE>
FOR each Edge of Mesh{
   FOR each Edge of Node{
     IF(Node Edge is crossed by a Mesh Edge)
       Divide Node into SubNodes
     ELSE
       Check next Mesh Edge
   }
}
</PRE><P>It is relatively ineﬃcient, each edge of the octree is tested against each edge of the mesh. It
could be optimised to try and exclude mesh edges that are extremely unlikely to cross the node
edge. It would also be prudent to exclude mesh edges that are too far away from the node to
intersect it, as this algorithm would require only addition and subtraction, whereas the collision
detection algorithm operates with vector products.
</P><P>An example of how an octree is split around a mesh in BSim can be seen in the video below. Here you can see how the octree structure looks at each stage of its generation. The maximum resolution increases from 1 at the start, to 8 in the final frame. 
</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2010.igem.org/Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions">http://2010.igem.org/Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:BCCS-Bristol/Modelling/BSIM/Modelling_Environmental_Interactions&amp;oldid=194024" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2010.igem.org:Privacy_policy" title="2010.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2010.igem.org:General_disclaimer" title="2010.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>