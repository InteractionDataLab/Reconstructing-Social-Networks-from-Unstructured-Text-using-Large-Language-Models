<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Paris_Liliane_Bettencourt_Project_Population_counter_model"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Paris_Liliane_Bettencourt/Project/Population_counter/model">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Paris_Liliane_Bettencourt/Project/Population_counter/model&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Paris_Liliane_Bettencourt/Project/Population_counter/model&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Paris_Liliane_Bettencourt/Project/Population_counter/model&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Paris_Liliane_Bettencourt/Project/Population_counter/model" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Paris Liliane Bettencourt/Project/Population counter/model</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2010.igem.org</H3><DIV id="header"><DIV id="logo_left"><SPAN class="plainlinks"><A title="igem.org" href="https://2010.igem.org/"> </A></SPAN></DIV></DIV><DIV id="menu"><UL><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt">home</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Project">projects</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Parts">parts</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Team">team</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Notebook">notebook</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Safety">safety</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Brainstorming">Brainstorming</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Acknowledgements">acknowledgements</A></LI></UL></DIV><DIV id="content"><DIV id="frame"><P style="display:block;"><FONT size="4">Population counter</FONT></P><DIV class="submenu"><UL id="submenu_1"><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Project/Population_counter" target="_self">Introduction</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Project/Population_counter/Design" target="_self">Design</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Project/Population_counter/Microfluidics" target="_self">Microfluidics</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Project/Population_counter/model" target="_self">Modelling</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Project/Population_counter/Results" target="_self">Results</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Project/Parts" target="_self">Parts</A></LI><LI><A href="https://2010.igem.org/Team:Paris_Liliane_Bettencourt/Project/Population_counter/References" target="_self">References</A></LI></UL></DIV><H2> Introduction </H2>

We aim at setting up a biological device counting random events occuring in a microfluidic device (see figure 1). These events are recombinations in the cells of the device, stimulated by pulses of arabinose coming from the tunnel. Once a certain number of pulses have been triggered, we expect our device to start emitting green fluorescence. First, we shall describe the dynamics of the population of bacteria in our device as for instance its recombinations, which further lead to the rise of the concentration of produced AHL. AHL is a quorum sensing molecule that, once a certain concentration threshold is reached, triggers in our device the production of GFP. It then alerts us of the end of counting. To count how many recombinations (so how many events) are needed to get the quorum sensing response, we shall determine the role and assess the value of a few critical parameters in our model.


<H2> The process </H2>

To be able to model the system, we first need to have a feeling of how the components of the system react and interact with one another. First, we send a pulse of arabinose through the tunnel which triggers, with a certain probability, the recombination of some bacteria. Those bacteria are then expected to become red (RFP expression) and start producing LuxI, which in turns promotes the production of AHL. AHL will play two roles: <UL><LI> it can bind with intracellular LuxR, which is a constitutively expressed protein so that its concentration inside the cell will be considered as constant. We call it LuxR<SUP>f</SUP> as long as it is free from AHL, LuxR* otherwise;</LI><LI> it can cross the cell membrane to bind with LuxR of other bacteria in the device.</LI></UL>

Every time a pulse of arabinose is injected, the production of AHL increases as a result of more recombinations. Once a certain level of AHL has been reached, all the cells respond to the quorum sensing signal and start producing GFP, which is the event putting an end to the counting.<CENTER>Figure 1: Scheme of the microfluidic device</CENTER><H2> The physical model </H2>

We can develop the information we have in a system of equations:<UL><LI><H5>Recombination</H5>
In all our simulations, we assumed that recombination would happened after 20 minutes in contact of arabinose, plus a certain random time following an exponential law of average 10 minutes. After this random time, it is not certain that the bacteria will recombinate. In our simulations, we decided that our cell would recombinate with a probability of 0.05
</LI><LI><H5>LuxI</H5> 
Once a bacteria has recombinated, there is necesarily a latent time before LuxI is actually synthetised. There is then some more time before a bacteria produces full rate. The amount of LuxI produced inside a bacteria stays in this very bacteria, and it is commonly accepted that the concentration of LuxI reaches a plateau and keep this value. According to the data found in the literature, we chose to set the latent time to 10 minutes. Then the concentration increases during 10 minutes linearly until the maximum concentration is reached.
</LI><LI><H5> LuxR </H5>Let's call <EM>R</EM> the constant concentration of LuxR in a cell. Some of it binded with AHL and we call it LuxR*, so this gives:

The complexation between LuxR and AHL gives a chemical equilibrium determined by the constant K<SUB>reac</SUB>:

so at the equilibrium:

which gives:</LI><LI><H5>AHL</H5> Following the paper &quot;A synchronized quorum of genetic clocks&quot; by Hasty and al., we define the intracellular concentration of AHL, [AHL<SUB>i</SUB>], and the external one, [AHL<SUB>e</SUB>].
Internal and external AHL concentrations change as AHL is produced by the cells and can go throuh the cell membrane (kinetic constant k<SUB>I</SUB> and k<SUB>membrane</SUB> respectively).

The first term says that if the cell produces LuxI, then it produces AHL at a certain rate. The second term concerns the exchange between the cell and the medium, and is proportional to the difference of concentration. The concentration of AHL in the room [AHL<SUB>e</SUB>] decreases as the microfluidic device evacuates it, which gives birth to a diffusion term in the equation caracterized by the kinetic constant k<SUB>diff</SUB>.
where k<SUB>diff</SUB> is related to parameters of the fluid and of the device, k<SUB>membrane</SUB> is the same as previously, but is now compensated by <EM>d</EM>, the cell density, so that the exchanges between cells and the medium is balanced.

Here we consider only the case where the concentration of AHL is homogeneous, ie the concentration inside and outside the cell are the same. This is justified since the caracteristic time of diffusion of AHL between the outside and the inside of a cell is short compared k<SUB>I</SUB> and k<SUB>diff</SUB>. We end up with this equation:
In Hasty et al., k<SUB>I</SUB> is taken to be <EM>0.06</EM>, which value we kept. Then, k<SUB>diff</SUB> would have had to be determined experimentally. Instead, we followed Hasty et al.'s demarche, making the computations with some &quot;reasonable&quot; values.

</LI></UL><H3> The synthesis of LuxI.</H3>
 Above, we introduced directly the concentration of LuxI without giving more details. However, we need to model the production of LuxI to calibrate the counter. This means modelling how the bacteria evolve in the device and how they react to arabinose.<UL><LI><EM>Arabinose</EM> is modeled simply in the model with a diffusion equation: 
with the boundary condition at the border between the device and the tunnel corresponding to: a positive value if a pulse is being sent, and 0 otherwise. Thus we get the profile of arabinose independently of everything else, except the pulse itself. k<SUB>A</SUB> was chosen arbitrarily (but close to values for similar molecules found in the literature) to be <EM>10<SUP>-5</SUP> mm<SUP>2</SUP>.min<SUP>-1</SUP></EM> . The pulse of arabinose in the channel corresponds to a concentration of <EM>0.04%</EM>, which concentration was used in the lab.
To trigger the production of LuxI, a bacteria needs to be exposed to a minimum concentration <EM>C<SUB>c</SUB></EM> of arabinose for at least <EM>T<SUB>c</SUB></EM> minutes. For the sake of the simulation, we chose values for which we knew that recombinations would happen, here <EM>C<SUB>c</SUB> = 0.001%</EM> during <EM>T<SUB>c</SUB> = 1.5 min</EM>.
</LI><LI> Our devices have several sizes, however one device will not ever host more than 2.10<SUP>5</SUP> cells. We can indeed approximate the maximum number of bacteria as the ratio between the volume of a device and the volume of a cell. Moreover, considering both populations, switched and unswitched, we will consider the bacteria are in exponential growth, and their excess is evacuated through the path to the tunnel. Therefore, we need a model for the behaviour of the bacteria (movement and birth/death) that allows us to deal with a few cells (when we have a few recombinated cells for instance) up to more than 10<SUP>5</SUP> cells. An individually-centered model would be computationnaly inefficient, while a continuous model would perform wrong computations for small numbers of bacteria.
Birth and death happen randomly, but we know how often they happen in average. We will describe in the next section the algorithm we used to model this.
As for diffusion of bacteria, a model relying on a binomial distribution was implemented: among n cells, we pick a random number of them to move; this random number being ruled by a probability p proportional to the gradient of concentration of bacteria. Discretising time and space, one can draw at every step time a random binomial number:
where <EM>f</EM> and <EM>f<SUB>2</SUB></EM> are described in the next section.
</LI><H2> Algorithm and simulations </H2>

In this paragraph, we use several constants suggested in the <EM>paper of Hasty et al.</EM> (see references), or sometimes some approximations. We shall mention these numerical values along this paragraph.
We use a discrete lattice to make the computations, considering that the cavity of the microfluidic device can be divided in several slices of constant width <EM>dx</EM>. It has been further assumed (for simplicity of computations essentially) that diffusion only takes place along the <EM>x</EM> axis (see figure 1 above). The discrete step time wil be denoted <EM>dt</EM>. Thus our equations will depend on a one-dimensional space parameter and on time.<H3> Solving the diffusion equation using an implicit scheme </H3>

One can simply solve numerically a partial differential equation by discrete differentiation. The simplest way gives directly the solution at time step n+1 thanks to what we know at time n. However, this discrete explicit scheme gives a stable solution only if <EM>k<SUB>diff</SUB>.dt/dx<SUP>2</SUP></EM> is less than 1. Therefore, we considered the Crank-Nicholson discretisation scheme. Unconditional to <EM>k<SUB>diff</SUB></EM>, <EM>dt</EM> and <EM>dx</EM>, this scheme produces stable computations.

However, it appears to be more complicated to solve since <EM>u(x,t+dt)</EM> cannot be obtained explicitly knowing the solution <EM>u</EM> at time <EM>t</EM>. Fortunately it can be expressed as a tridiagonal system of equations that we solved numerically.<H3> Stochastic Gillespie algorithm </H3>

The basic idea lying here is to compute random times for a population rather than computing them for each individual (which is much more computer intensive). Those random times appear in the recombinations and the birth-death calculus; Gillespie's idea, which we are about to describe, allows to compute the time of the next recombination (resp. birth or death) within the population instead of making the calculus and storing the result for each cell in the device.
Under the assumption that cells' recombination times are independent from one bacteria to the other, and that these times follow an exponential law of parameter λ, Gillespie tells us that the next recombination time (resp. birth or death time) follows an exponential law of parameter <EM>N<SUB>pop</SUB>.λ</EM>.<H3> Stochastic movement of the cells </H3>
As promised before, we give the two functions describing the movement of the bacteria in the microfluidic device:


where <EM>N<SUB>sw/unsw</SUB></EM> denotes either the number of switched bacteria (or recombinated bacteria) or unswitched bacteria. The idea here is to have, on average at each step time, <EM>dt.k<SUB>diff</SUB>.f(x,t)</EM> bacteria that will move, a result we would get from usual diffusion. As previously mentioned, we cannot use regular diffusion since our algorithm must apply to discrete data lying on a wide range of integers.

<H3> Simulations </H3>
Now let's present the graphical display of our simulation tool. Once the user has selected a refreshment speed x, the software will draw every x minutes the unswitched bacteria in grey, the switched ones in red and the arabinose in small blue points.

We see on the following picture that after a certain amount of time, both cells and arabinose are distributed rather uniformly, and that the concentration of arabinose decreases near the tunnel as it is washed away by the flow. 

The software also gives us the dynamics of recombined bacteria, LuxI and AHL slice by slice. This is what we will exploit here.

In the following simulations, the device was divided into 15 slices. We exhibit some results on the fifth slice. To count, one can either look at the number of recombined bacteria thanks to RFP, or set up the timer thanks to AHL. We will see that depending on the parameters, one or other may not be possible. For the first one, it is necessary to have clear steps, implying that the time between the pulses will be large enough to allow the system to stabilise. For the second, distinct steps on the AHL graph are necessary to set up the timer. Indeed, this allows to design the bacteria in the way that they will produce GFP only once a certain treshold in AHL was reached. However, admitting that this timer is set up, then it is possible to count more frequent events even without steps as we shall see in figure 4. In the sequel, the time between two pulses will be denoted <EM>T<SUB>2</SUB></EM>.
<CENTER> Figure 2: Switched bact., AHL, LuxI for T<SUB>2</SUB> = 160 and k<SUB>diff</SUB> = 8.10<SUP>-2</SUP></CENTER>

In the following figure, we show that it is still possible to count the number of pulses thanks to the number of recombined bacteria, although it might become uncertain. Nevertheless, it seems that we can still choose a threshold of AHL beyond which bacteria should be designed to luminesce. For instance, if we wanted our timer to stop at 4, then a threshold of 0.70 in standardised unit seems reasonable.
<CENTER> Figure 3: Switched bact., AHL, LuxI for T<SUB>2</SUB> = 120 and k<SUB>diff</SUB> = 2.10<SUP>-2</SUP></CENTER>


Although we have been able to count six pulses thanks to the previous graph of AHL, it is not always possible to do so. For instance, if we shorten the time between two pulses, decreasing the diffusion coefficient, then it is no longer possible to distinguish pulses:<CENTER> Figure 4: AHL for T<SUB>2</SUB> = 100 and k<SUB>diff</SUB> = 10<SUP>-3</SUP></CENTER><H2> Achievements of our model</H2>

Our model gave us a better understanding of the dynamics and helped us explain and suggest experiments <EM>a posteriori</EM>. Together with the results of the experiments, we may be able:
<UL><LI> to have a better determination of some parameters such as caracteristic times for recombination and their statistical distribution, which we can then plug in;</LI><LI> to set up parameters in a way that allow us to count with RFP, or to make a timer thanks to AHL and GFP. Those parameters are for instance the speed of the flow in the microfluidic device, the dimensions of the microfluidic device, the initial number of bacteria or the viscosity of the medium fluid.</LI></UL><H2> Sources of the simulation software </H2>

You may download the sources by clicking <A href="https://2010.igem.org/Image:Simu_paris.zip">here</A>. It is written in C and all the interesting parameters are in the file &quot;constants.h&quot;. The files &quot;nrutil.c&quot; and &quot;nrutil.h&quot; are taken from the internet.<H2> References </H2><UL><LI> T.Danino, O.Mondragon-Palomino, L.Tsimring, J.Hasty: A synchronized quorum of genetic clocks. Nature 2009, 463:326 - 330</LI><LI> T.Lu, D.Volfson, L.Tsimring, J. Hasty: Cellular growth and division in the Gillespie algorithm. Systems biology, IEEE proceedings 2004, 1:121 - 128 </LI><LI> D.Gillespie: A general method for numerically simulating the stochastic time evolution of coupled chemical reactions. The Journal of Computational Physics 1976, 22:403 - 434 </LI><LI> D.Gillespie: Exact stochastic simulation of coupled chemical reactions. The Journal of Physical Chemistry 1977, 81:2340 - 2361 </LI><LI> S.Lampoudi, D.Gillespie, L.Petzold: The multinomial simulation algorithm for discrete stochastic simulation of reaction-diffusion systems. 2009 </LI><LI> R.Bustin, H.Messer: An equivalent Markov model for Gillespie’s stochastic simulation algorithm for biochemical systems. 2006 </LI><LI> W.H.Press, S.A.Teukolsky, W.T.Vetterling, B.P.Flannery: Numerical recipes in C. Cambridge University Press, 1992.</LI></UL><DIV class="printfooter">
Retrieved from &quot;<A href="http://2010.igem.org/Team:Paris_Liliane_Bettencourt/Project/Population_counter/model">http://2010.igem.org/Team:Paris_Liliane_Bettencourt/Project/Population_counter/model</A>&quot;</DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Paris_Liliane_Bettencourt/Project/Population_counter/model" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Paris_Liliane_Bettencourt/Project/Population_counter/model" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Paris_Liliane_Bettencourt/Project/Population_counter/model&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Paris_Liliane_Bettencourt/Project/Population_counter/model&amp;oldid=208480" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2010.igem.org:Privacy_policy" title="2010.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2010.igem.org:General_disclaimer" title="2010.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></UL></DIV></DIV></DIV></DIV></DIV></BODY></HTML>