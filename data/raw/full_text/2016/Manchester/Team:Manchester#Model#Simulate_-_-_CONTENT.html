<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Manchester_Model_Simulate skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Manchester/Model/Simulate</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><TITLE> Manchester iGEM 2016 </TITLE><NAV><UL id="nav_bar"><LI><A href="https://2016.igem.org/Team:Manchester/Team"><STRONG>Team</STRONG></A></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Team">Team</A></STRONG></LI><LI class="dropdown_content"><STRONG><A href="https://2016.igem.org/Team:Manchester/Attributions">Attributions</A></STRONG></LI></UL><LI><A href="https://2016.igem.org/Team:Manchester/Description"><STRONG>Project</STRONG></A></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Description">Overview</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Description/mechanism1">Cell-free Mechanism</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Description/mechanism2">Inducible Gene Switch</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Proof">Proof of Concept</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Notebook">Notebook</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Project/Protocols">Protocol</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Safety">Safety</A></STRONG></LI><LI class="dropdown_content"><A href="https://2016.igem.org/Team:Manchester/Achievement"><STRONG>Achievement</STRONG></A></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Achievement">Overview</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Judging">Judging Criteria</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Collaborations">Collaborations</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Parts">Parts</A></STRONG></LI><LI class="dropdown_content"><A href="https://2016.igem.org/Team:Manchester/Human_Practices"><STRONG>Human Practices</STRONG></A></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Human_Practices">Overview</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Human_Practices/Charities">Charities</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Human_Practices/Industries">Industries</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Human_Practices/Outreach">Outreach</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Human_Practices/Professional_Bodies">Professional Bodies</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Integrated_Practices">Integrated Practices</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Engagement">Engagement</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/HP/Gold">HP Gold</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/HP/Silver">HP Silver</A></STRONG></LI><LI class="dropdown_content"><A href="https://2016.igem.org/Team:Manchester/Model"><STRONG>Modelling</STRONG></A></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Model">Overview</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Model/hp">Modelling Integration</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Model/result">Results</A></STRONG></LI><LI><STRONG><A href="https://2016.igem.org/Team:Manchester/Model/ModelExplorer">Model Explorer</A></STRONG></LI><LI class="dropdown_content"><A href="https://2016.igem.org/Team:Manchester/Safety"><STRONG>Safety</STRONG></A></LI></NAV><H1 class="title11">System Simulation</H1><DIV class="team"><DIV class="navbutton onethird_size"><B>Contents</B><OL style="text-align:left"><LI style="text-align:left"><A href="#heading1">ODEs applicability</A></LI><LI style="text-align:left"><A href="#heading2">Equations at equilibrium</A></LI><LI style="text-align:left"><A href="#heading3">Concentration Time Graphs</A></LI><LI style="text-align:left"><A href="#heading4">Solving ODEs</A></LI><LI style="text-align:left"><A href="#heading5">Why we chose our 4 models</A></LI><LI style="text-align:left"><A href="#heading6">Extension to ensemble modelling</A></LI><LI style="text-align:left"><A href="#heading7">Constraints - Improving Data</A></LI><LI style="text-align:left"><A href="#heading8">Constraints - Illustration of concept</A></LI><LI style="text-align:left"><A href="#heading9">How our code works: Constraints</A></LI></OL></DIV><H1 class="bigtitle">ODE</H1><P id="heading1" class="title2" style="font-size:25px;">ODEs applicability to enzyme kinetics</P><P style="font-size:17px;">
Ordinary Differential Equations (ODEs) are at the heart of modeling enzyme kinetics. They are equations describing the rate of change of a variable e.g. product concentration. To illustrate their applicability consider the following reaction scheme:
</P><P style="font-size:17px;">Consider the rate of change of the enzyme complex (AE<SUB>A</SUB>). There are 3 possibilities:</P>
$$A+E_A \rightarrow AE_A $$
$$AE_A \rightarrow A + E_A$$
$$AE_A \rightarrow H + E_A$$
<P style="font-size:17px;">
It can break down into H and E<SUB>A</SUB> or it could break down into A and E<SUB>A</SUB> or it could be formed by A and E<SUB>A</SUB>. The first two possibilities will happen proportional to the amount of AE<SUB>A</SUB>. the latter possibility is proportional to the product of the concentrations as it’s proportional to the number of collisions. 

Given that the rate of change of AE<SUB>A</SUB> is the amount made minus the amount consumed. Therefore you get the following equation, where k's represent the probability of each process.

$$\dot{AE_A} = k_1[A][E_A]-(k_2+k_3)[AE_A]$$
</P><P id="heading2" class="title2" style="font-size:25px;">Equations at equilibrium</P><P style="font-size:17px;">
The equations described above are called mass action equations and their rate constants are not widely documented. What are actually documented are constants that describe a reaction scheme under the assumption that all enzyme complexes are at steady state (the rate of change is zero).  In doing this you are able to remove enzyme and enzyme complex concentrations entirely from your equations. This is ideal as these concentrations are hard to measure in the lab.

In most cases these equations have been derived and documented, especially when you note the equations are modular (you can chop the reaction scheme up into a series of smaller reaction schemes). If you have an abnormal reaction pathway you may need to derive it for yourself.
</P><P id="heading3" class="title2" style="font-size:25px;">Generating concentration time graphs</P><P style="font-size:17px;">
The experimental data available to us was concentration time graphs, ODEs are perfect for creating these. We mainly used a MATLAB solver which uses a predictor-corrector method. We also have a n<SUP>th</SUP> order ODE solver written in C++ and that uses RK4. 

It will now be explained how knowing the rate of change of your concentrations can lead to concentration over time in practice via such methods. The Forward Euler method will be used to illustrate. 

You must know your starting concentrations, these are your “initial conditions” and represent your starting concentration of reagents (mM). The differential equation is used to find the rate of change at this point. You take a small step in time along this gradient. Then you recalculate the gradient at the new point before taking another small step and so on. See below figure for a visual representation.
</P><CENTER><P style="text-align:center">Figure representing the euler method the dots represent recalculation points</P></CENTER><P style="font-size:17px;">
A question we tried to answer is what reaction scheme is our cell free mechanism actually following. What follows are the possibilities we investigated for the reaction scheme. How to then predict which models are closest to the truth is explained in the <A href="https://2016.igem.org/Team:Manchester/Model/MechanismUncertainty">network mechanism analysis.</A>
Before we proceed it’s important to know that our schemes are broken up in two steps.  Step 1 alcohol/glucose as a substrate with H<SUB>2</SUB>O<SUB>2</SUB> as a product step 2 H<SUB>2</SUB>O<SUB>2</SUB> as a substrate with ABTS<SUB>oxidised</SUB> as a product. 
The final selection is shown in the chart below where pairing from each column is suitable e.g. Reversible Michaelis-Menten and Bi-uni. The reason for these distinctions apart from saying &quot;Irreversible Michaelis-Menten is too far removed from reality&quot; is that they make no sense as the other step this will soon become clear.
</P><CENTER><TABLE><TBODY><TR><TD>Type of reaction</TD><TD>GOx reaction</TD><TD>HRP reaction</TD></TR><TR><TD>Irreversible Michaelis-Menten</TD><TD>n</TD><TD>n</TD></TR><TR><TD>Reversible Michaelis-Menten</TD><TD>y</TD><TD>n</TD></TR><TR><TD>Bi-Uni Michaelis-Menten</TD><TD>n</TD><TD>y</TD></TR><TR><TD>Uni-Bi Michaelis-Menten</TD><TD>y</TD><TD>n</TD></TR><TR><TD>Ping-Pong</TD><TD>n</TD><TD>y</TD></TR></TBODY></TABLE></CENTER><P style="font-size:17px;">
For all the equations and variable definitions follow this<A href="http://tellurium.analogmachine.org/wp-content/uploads/2014/08/RateLawList.pdf"> link, </A>
Note: </P>
$$\text{T} = \frac{\prod_{i=1}^nP_i}{\prod_{j=1}^kS_j}$$
$$\nu = \frac{dP}{dt}=\text{rate of change of product}$$
<P style="font-size:17px;">
Irreversible Michaelis-Menten. 
This model has very poor physical relevance to our experiment so it's not discussed here.
While useful for initial testing the irreversible nature easily hides properties of the system and this is highly undesirable.

Reversible Michaelis-Menten:</P><P style="font-size:17px;">This reaction scheme is saying alcohol and AOx can combine to make H<SUB>2</SUB>O<SUB>2</SUB> and that this reaction can happen reversibly and so some sort of equilibrium will occur.

The mass action scheme is:</P><P style="font-size:17px;">As you can see the two schemes are very similar.
 We know that Ethanal is actually the second product in this reaction. Our question is, does it make a difference to the kinetics? This question can be assessed with the use of <A href="https://2016.igem.org/Team:Manchester/Model/MechanismUncertainty">ensemble outputs</A> and comparison to results using the Uni-Bi Michaelis-Menten rate law. 


Uni-Bi Michaelis-Menten:</P><P style="font-size:17px;">This reaction is saying that alcohol and AOx can combine to make H<SUB>2</SUB>O<SUB>2</SUB> and Ethanal and that this can occur reversibly
The mass action scheme is:</P><P style="font-size:17px;">This mechanism does include Ethanal. The order the substrates dissociate does matter, as you can imagine if Ethanal does break off first you will end up with a large amount of Ethanal forcing the back reaction, this would be alleviated if H<SUB>2</SUB>O<SUB>2</SUB> could break off first as then H<SUB>2</SUB>O<SUB>2</SUB> would be more available for the next use. In literature there are two equations for this, however the ordered case is the random order case in the limit some of its rates go to zero. We assumed that if this were the case the sampling of our system would account for this, sampling many tiny parameters, rather than us making that judgement ourselves.

Bi-Uni Michaelis-Menten:</P><P style="font-size:17px;">This reaction is saying H<SUB>2</SUB>O<SUB>2</SUB> and ABTS and HRP can combine to make ABTS<SUB>oxidised</SUB> with HRP acting as a catalyst. 

The mass action scheme is:</P><P style="font-size:17px;">This mechanism takes into account that there are two substrates, the same implementation was used as in Uni-Bi Michaelis-Menten. Physically it is saying there is some mechanism by which HRP acts directly as a catalyst in one step. Ping pong proposes something different. 

 
Ping-Pong:</P><P style="font-size:17px;">This reaction is saying H<SUB>2</SUB>O<SUB>2</SUB> and HRP can combine oxidising HRP and reducing H<SUB>2</SUB>O<SUB>2</SUB>, The resultant H<SUB>2</SUB>O molecule takes no further place in this reaction but now the ABTS does. In this next step the reaction is saying ABTS and HRP* react reducing HRP and oxidising ABTS, The result is oxidised ABTS and HRP being regenerated as the catalyst for the first the stage again.

The mass action scheme is:</P><P style="font-size:17px;">There is another alternative for a Ping-Pong scheme and that is HRP and ABTS combine first oxidising the ABTS and reducing the HRP. The H<SUB>2</SUB>O<SUB>2</SUB> would come along later and reform the HRP catalyst. This wasn’t considered as you would expect to see a jump in ABTS<SUB>oxidised</SUB> at the start of your reaction and this wasn’t observed.

</P><H1 style="margin-top: 60px;" class="title11">Practical considerations</H1><P id="heading4" class="title2" style="font-size:25px;">Solving ODEs code</P><P style="font-size:17px;">
As mentioned in the theory section MATLAB has its own <A target="_blank" href="https://uk.mathworks.com/help/matlab/math/choose-an-ode-solver.html">solvers</A>.We used ode45. 

The C++ code uses the 4th order Runge Kutta method. Its a n<SUB>th</SUB> order solver. Requiring n initial conditions for the n equations.

Note that all the above assumes your using first order differential equations only. However if you have a n<SUB>th</SUB> order differential equation it can be written as a system of first order equations. This mathematical step will need to be done first. 
</P><P id="heading5" class="title2" style="font-size:25px;">Discussion of why we chose our 4 models</P><P style="font-size:17px;">When modelling the cell free system of the AlcoPatch there are a bank of potential rate equations, each with a differing underlying mechanism, for each of the two steps.</P><CENTER><TABLE><TBODY><TR><TD>GOx reaction</TD><TD>HRP reaction</TD></TR><TR><TD>Irreversible Michaelis-Menten</TD><TD>Irreversible Michaelis-Menten</TD></TR><TR><TD>Reversible Michaelis-Menten</TD><TD>Reversible Michaelis-Menten</TD></TR><TR><TD>Random order Uni-Bi Michaelis-Menten</TD><TD>Random order Bi-Uni Michaelis-Menten</TD></TR></TBODY></TABLE></CENTER><P style="font-size:17px;">This many potential equations mean there are 9 different combinations of rate laws.
More generally the this can be expressed as:

$$n_{permutation}=\prod_{i=1}^{n_{steps}}n_{equations,i}$$


This can very quickly lead to huge numbers, a 5 step reaction pathway with 5 potential equations per step has 3125 possible combinations. The first step when building the reaction pathway is to eliminate any infeasible reaction schemes. Just removing one potential reaction per step reduces this number by 2101. A short amount of critical consideration to remove equations is much better spent than trying to use brute force on a larger number of equations.

 We chose four as they encapsulate the two questions we are asking, does Ethanal/GDL make a difference? And does the concentration of ABTS have an effect? These four are irreversible Michaelis-Menten both steps, reversible Michaelis-Menten both steps. Reversible Michaelis-Menten followed by Random order Bi-Uni and Random order Uni-Bi followed by Random order Bi-Uni. Ping pong was not used further due to time constraints.

 </P><P id="heading6" class="title2" style="font-size:25px;">Extension to ensemble modelling </P><P style="font-size:17px;">
Extending to ensemble modelling is simple. You simply loop through the process multiple times using different rate constants generated from your PDFs and save all the resulting concentration vs time arrays.
</P><H1 style="margin-top:90px;" class="bigtitle">Thermodynamic Constraints</H1><P id="heading7" class="title2" style="font-size:25px;">Improving data</P><P style="font-size:17px;">
In some situations there are constraints (representing physical limitations) that can be applied to the parameters to further improve your data set. These constraints come from thermodynamic laws, one well known example is the Haldane relationship which relates kinetic parameters to the equilibrium constant. </P>
$$K_{eq} = \frac{V_f}{V_b} \frac{K_{m,b}}{K_{m,f}}$$

<P style="font-size:17px;">
For our system we also noticed the K<SUB>cat</SUB>/K<SUB>m</SUB> ratio was constant.

As such only parameters that were consistent with this ratio were used.

In doing this kind of step you not only save computer time but also can provide a tighter prediction on what you would expect to observe if the model is accurate.

Below you will find a figure showing the difference to the simulation using a data set consistent with our constraint (filtered) and a data set not filtered by a constraint. 
</P><P style="font-size: 17px;">The above figures illustrate the difference in simulation results when applying constraints to your parameters. One is a concentration graph with no constraints applied, the other is a concentration graph with constraints applied. As you can see the constrained simulation produces less results that take much longer to reach steady state, this was consistent with experimental data. 
</P><P id="heading9" class="title2" style="font-size:25px;">How constraint code works</P><P style="font-size:17px;"><A href="https://github.com/Manchester-iGem-2016/UoMiGem2016">Link to github homepage</A>
The code works not exactly like you would expect from the theory explanation. Specifically the constraint is not applied to the original PDFs to create a new PDF consistent with the constraint, to do this you need to look into multivariate distributions. We actually took the much easier option of while running the simulation sampling from both K<SUB>cat</SUB> and K<SUB>m</SUB> distributions (K<SUB>cat</SUB>/K<SUB>m</SUB> is the constraint.) Only keeping values that are within 0.5 standard deviations of the K<SUB>cat</SUB>/K<SUB>m</SUB> value  where standard deviation was calculated from the literature ratio. The K<SUB>cat</SUB>/K<SUB>m</SUB> was drawn from literature data.

The downside of our simpler method is that we waste computer time. As we only had one constraint this wasn’t much of a problem, however if you have many constraints you will have to look into multivariate techniques, or overcome the slowness with high performance computing (supercomputers).  
</P><P id="heading8" class="title2" style="font-size:25px;">Illustration of concept</P><P style="font-size:17px;">
Below some imaginary constraints are given by the 2 blue curves. Any point which falls between the 2 curves would be accepted (in green) and any point which lies outside these bounds is rejected (in red). This is repeated until enough suitable points are generated. So to run the required number of simulations.</P></DIV><DIV class="footer" style="z-index: 99; position: relative"><H1 id="footer" style="color:white"><STRONG> Sponsors </STRONG></H1><DIV class="box"><P style="font-size:medium"><STRONG>Follow us on</STRONG></P><DIV><P><STRONG>Email: <A href="mailto:uomigem16@gmail.com">uomigem16@gmail.com</A></STRONG></P></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>