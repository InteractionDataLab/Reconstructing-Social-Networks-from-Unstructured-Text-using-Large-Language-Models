<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Tianjin_Experiment_lightbox_js skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Tianjin/Experiment/lightbox.js</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P>/*
</P><PRE>* SimpleModal 1.4.4 - jQuery Plugin
</PRE><UL><LI>/</LI></UL><P>(function(b){&quot;function&quot;===typeof define&amp;&amp;define.amd?define([&quot;jquery&quot;],b):b(jQuery)})(function(b){var j=[],n=b(document),k=navigator.userAgent.toLowerCase(),l=b(window),g=[],o=null,p=/msie/.test(k)&amp;&amp;!/opera/.test(k),q=/opera/.test(k),m,r;m=p&amp;&amp;/msie 6./.test(k)&amp;&amp;&quot;object&quot;!==typeof window.XMLHttpRequest;r=p&amp;&amp;/msie 7.0/.test(k);b.modal=function(a,h){return b.modal.impl.init(a,h)};b.modal.close=function(){b.modal.impl.close()};b.modal.focus=function(a){b.modal.impl.focus(a)};b.modal.setContainerDimensions=
function(){b.modal.impl.setContainerDimensions()};b.modal.setPosition=function(){b.modal.impl.setPosition()};b.modal.update=function(a,h){b.modal.impl.update(a,h)};b.fn.modal=function(a){return b.modal.impl.init(this,a)};b.modal.defaults={appendTo:&quot;body&quot;,focus:!0,opacity:50,overlayId:&quot;simplemodal-overlay&quot;,overlayCss:{},containerId:&quot;simplemodal-container&quot;,containerCss:{},dataId:&quot;simplemodal-data&quot;,dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1E3,
close:!0,closeHTML:'&lt;a class=&quot;modalCloseImg&quot; title=&quot;Close&quot;&gt;&lt;/a&gt;',closeClass:&quot;simplemodal-close&quot;,escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null};b.modal.impl={d:{},init:function(a,h){if(this.d.data)return!1;o=p&amp;&amp;!b.support.boxModel;this.o=b.extend({},b.modal.defaults,h);this.zIndex=this.o.zIndex;this.occb=!1;if(&quot;object&quot;===typeof a){if(a=a instanceof b?a:b(a),this.d.placeholder=!1,0&lt;a.parent().parent().size()&amp;&amp;(a.before(b(&quot;&quot;).attr(&quot;id&quot;,
</P>
&quot;simplemodal-placeholder&quot;).css({display:&quot;none&quot;})),this.d.placeholder=!0,this.display=a.css(&quot;display&quot;),!this.o.persist))this.d.orig=a.clone(!0)}else if(&quot;string&quot;===typeof a||&quot;number&quot;===typeof a)a=b(&quot;&quot;).html(a);else return alert(&quot;SimpleModal Error: Unsupported data type: &quot;+typeof a),this;this.create(a);this.open();b.isFunction(this.o.onShow)&amp;&amp;this.o.onShow.apply(this,[this.d]);return this},create:function(a){this.getDimensions();if(this.o.modal&amp;&amp;m)this.d.iframe=b('&lt;iframe src=&quot;javascript:false;&quot;&gt;&lt;/iframe&gt;').css(b.extend(this.o.iframeCss,
{display:&quot;none&quot;,opacity:0,position:&quot;fixed&quot;,height:g[0],width:g[1],zIndex:this.o.zIndex,top:0,left:0})).appendTo(this.o.appendTo);this.d.overlay=b(&quot;&quot;).attr(&quot;id&quot;,this.o.overlayId).addClass(&quot;simplemodal-overlay&quot;).css(b.extend(this.o.overlayCss,{display:&quot;none&quot;,opacity:this.o.opacity/100,height:this.o.modal?j[0]:0,width:this.o.modal?j[1]:0,position:&quot;fixed&quot;,left:0,top:0,zIndex:this.o.zIndex+1})).appendTo(this.o.appendTo);this.d.container=b(&quot;&quot;).attr(&quot;id&quot;,this.o.containerId).addClass(&quot;simplemodal-container&quot;).css(b.extend({position:this.o.fixed?
&quot;fixed&quot;:&quot;absolute&quot;},this.o.containerCss,{display:&quot;none&quot;,zIndex:this.o.zIndex+2})).append(this.o.close&amp;&amp;this.o.closeHTML?b(this.o.closeHTML).addClass(this.o.closeClass):&quot;&quot;).appendTo(this.o.appendTo);this.d.wrap=b(&quot;&quot;).attr(&quot;tabIndex&quot;,-1).addClass(&quot;simplemodal-wrap&quot;).css({height:&quot;100%&quot;,outline:0,width:&quot;100%&quot;}).appendTo(this.d.container);this.d.data=a.attr(&quot;id&quot;,a.attr(&quot;id&quot;)||this.o.dataId).addClass(&quot;simplemodal-data&quot;).css(b.extend(this.o.dataCss,{display:&quot;none&quot;})).appendTo(&quot;body&quot;);this.setContainerDimensions();
<P>this.d.data.appendTo(this.d.wrap);(m||o)&amp;&amp;this.fixIE()},bindEvents:function(){var a=this;b(&quot;.&quot;+a.o.closeClass).bind(&quot;click.simplemodal&quot;,function(b){b.preventDefault();a.close()});a.o.modal&amp;&amp;a.o.close&amp;&amp;a.o.overlayClose&amp;&amp;a.d.overlay.bind(&quot;click.simplemodal&quot;,function(b){b.preventDefault();a.close()});n.bind(&quot;keydown.simplemodal&quot;,function(b){a.o.modal&amp;&amp;9===b.keyCode?a.watchTab(b):a.o.close&amp;&amp;a.o.escClose&amp;&amp;27===b.keyCode&amp;&amp;(b.preventDefault(),a.close())});l.bind(&quot;resize.simplemodal orientationchange.simplemodal&quot;,
function(){a.getDimensions();a.o.autoResize?a.setContainerDimensions():a.o.autoPosition&amp;&amp;a.setPosition();m||o?a.fixIE():a.o.modal&amp;&amp;(a.d.iframe&amp;&amp;a.d.iframe.css({height:g[0],width:g[1]}),a.d.overlay.css({height:j[0],width:j[1]}))})},unbindEvents:function(){b(&quot;.&quot;+this.o.closeClass).unbind(&quot;click.simplemodal&quot;);n.unbind(&quot;keydown.simplemodal&quot;);l.unbind(&quot;.simplemodal&quot;);this.d.overlay.unbind(&quot;click.simplemodal&quot;)},fixIE:function(){var a=this.o.position;b.each([this.d.iframe||null,!this.o.modal?null:this.d.overlay,
&quot;fixed&quot;===this.d.container.css(&quot;position&quot;)?this.d.container:null],function(b,e){if(e){var f=e[0].style;f.position=&quot;absolute&quot;;if(2&gt;b)f.removeExpression(&quot;height&quot;),f.removeExpression(&quot;width&quot;),f.setExpression(&quot;height&quot;,'document.body.scrollHeight &gt; document.body.clientHeight ? document.body.scrollHeight : document.body.clientHeight + &quot;px&quot;'),f.setExpression(&quot;width&quot;,'document.body.scrollWidth &gt; document.body.clientWidth ? document.body.scrollWidth : document.body.clientWidth + &quot;px&quot;');else{var c,d;a&amp;&amp;a.constructor===
Array?(c=a[0]?&quot;number&quot;===typeof a[0]?a[0].toString():a[0].replace(/px/,&quot;&quot;):e.css(&quot;top&quot;).replace(/px/,&quot;&quot;),c=-1===c.indexOf(&quot;%&quot;)?c+' + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + &quot;px&quot;':parseInt(c.replace(/%/,&quot;&quot;))+' * ((document.documentElement.clientHeight || document.body.clientHeight) / 100) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + &quot;px&quot;',a[1]&amp;&amp;(d=&quot;number&quot;===typeof a[1]?
a[1].toString():a[1].replace(/px/,&quot;&quot;),d=-1===d.indexOf(&quot;%&quot;)?d+' + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + &quot;px&quot;':parseInt(d.replace(/%/,&quot;&quot;))+' * ((document.documentElement.clientWidth || document.body.clientWidth) / 100) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + &quot;px&quot;')):(c='(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + &quot;px&quot;',
d='(document.documentElement.clientWidth || document.body.clientWidth) / 2 - (this.offsetWidth / 2) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + &quot;px&quot;');f.removeExpression(&quot;top&quot;);f.removeExpression(&quot;left&quot;);f.setExpression(&quot;top&quot;,c);f.setExpression(&quot;left&quot;,d)}}})},focus:function(a){var h=this,a=a&amp;&amp;-1!==b.inArray(a,[&quot;first&quot;,&quot;last&quot;])?a:&quot;first&quot;,e=b(&quot;:input:enabled:visible:&quot;+a,h.d.wrap);setTimeout(function(){0&lt;e.length?e.focus():h.d.wrap.focus()},
10)},getDimensions:function(){var a=&quot;undefined&quot;===typeof window.innerHeight?l.height():window.innerHeight;j=[n.height(),n.width()];g=[a,l.width()]},getVal:function(a,b){return a?&quot;number&quot;===typeof a?a:&quot;auto&quot;===a?0:0&lt;a.indexOf(&quot;%&quot;)?parseInt(a.replace(/%/,&quot;&quot;))/100*(&quot;h&quot;===b?g[0]:g[1]):parseInt(a.replace(/px/,&quot;&quot;)):null},update:function(a,b){if(!this.d.data)return!1;this.d.origHeight=this.getVal(a,&quot;h&quot;);this.d.origWidth=this.getVal(b,&quot;w&quot;);this.d.data.hide();a&amp;&amp;this.d.container.css(&quot;height&quot;,a);b&amp;&amp;this.d.container.css(&quot;width&quot;,
b);this.setContainerDimensions();this.d.data.show();this.o.focus&amp;&amp;this.focus();this.unbindEvents();this.bindEvents()},setContainerDimensions:function(){var a=m||r,b=this.d.origHeight?this.d.origHeight:q?this.d.container.height():this.getVal(a?this.d.container[0].currentStyle.height:this.d.container.css(&quot;height&quot;),&quot;h&quot;),a=this.d.origWidth?this.d.origWidth:q?this.d.container.width():this.getVal(a?this.d.container[0].currentStyle.width:this.d.container.css(&quot;width&quot;),&quot;w&quot;),e=this.d.data.outerHeight(!0),f=
this.d.data.outerWidth(!0);this.d.origHeight=this.d.origHeight||b;this.d.origWidth=this.d.origWidth||a;var c=this.o.maxHeight?this.getVal(this.o.maxHeight,&quot;h&quot;):null,d=this.o.maxWidth?this.getVal(this.o.maxWidth,&quot;w&quot;):null,c=c&amp;&amp;c&lt;g[0]?c:g[0],d=d&amp;&amp;d&lt;g[1]?d:g[1],i=this.o.minHeight?this.getVal(this.o.minHeight,&quot;h&quot;):&quot;auto&quot;,b=b?this.o.autoResize&amp;&amp;b&gt;c?c:b&lt;i?i:b:e?e&gt;c?c:this.o.minHeight&amp;&amp;&quot;auto&quot;!==i&amp;&amp;e&lt;i?i:e:i,c=this.o.minWidth?this.getVal(this.o.minWidth,&quot;w&quot;):&quot;auto&quot;,a=a?this.o.autoResize&amp;&amp;a&gt;d?d:a&lt;c?c:a:f?
f&gt;d?d:this.o.minWidth&amp;&amp;&quot;auto&quot;!==c&amp;&amp;f&lt;c?c:f:c;this.d.container.css({height:b,width:a});this.d.wrap.css({overflow:e&gt;b||f&gt;a?&quot;auto&quot;:&quot;visible&quot;});this.o.autoPosition&amp;&amp;this.setPosition()},setPosition:function(){var a,b;a=g[0]/2-this.d.container.outerHeight(!0)/2;b=g[1]/2-this.d.container.outerWidth(!0)/2;var e=&quot;fixed&quot;!==this.d.container.css(&quot;position&quot;)?l.scrollTop():0;this.o.position&amp;&amp;&quot;[object Array]&quot;===Object.prototype.toString.call(this.o.position)?(a=e+(this.o.position[0]||a),b=this.o.position[1]||b):
a=e+a;this.d.container.css({left:b,top:a})},watchTab:function(a){if(0&lt;b(a.target).parents(&quot;.simplemodal-container&quot;).length){if(this.inputs=b(&quot;:input:enabled:visible:first, :input:enabled:visible:last&quot;,this.d.data[0]),!a.shiftKey&amp;&amp;a.target===this.inputs[this.inputs.length-1]||a.shiftKey&amp;&amp;a.target===this.inputs[0]||0===this.inputs.length)a.preventDefault(),this.focus(a.shiftKey?&quot;last&quot;:&quot;first&quot;)}else a.preventDefault(),this.focus()},open:function(){this.d.iframe&amp;&amp;this.d.iframe.show();b.isFunction(this.o.onOpen)?
this.o.onOpen.apply(this,[this.d]):(this.d.overlay.show(),this.d.container.show(),this.d.data.show());this.o.focus&amp;&amp;this.focus();this.bindEvents()},close:function(){if(!this.d.data)return!1;this.unbindEvents();if(b.isFunction(this.o.onClose)&amp;&amp;!this.occb)this.occb=!0,this.o.onClose.apply(this,[this.d]);else{if(this.d.placeholder){var a=b(&quot;#simplemodal-placeholder&quot;);this.o.persist?a.replaceWith(this.d.data.removeClass(&quot;simplemodal-data&quot;).css(&quot;display&quot;,this.display)):(this.d.data.hide().remove(),a.replaceWith(this.d.orig))}else this.d.data.hide().remove();
this.d.container.hide().remove();this.d.overlay.hide();this.d.iframe&amp;&amp;this.d.iframe.hide().remove();this.d.overlay.remove();this.d={}}}}});
</P><P>/*
</P><PRE>* SimpleModal Image Gallery
</PRE><UL><LI>/</LI></UL><P>jQuery(function ($) {
	var G = {
		active: false,
		/*
		 * Calls SimpleModal with appropriate options 
		 */
		init: function () {
			G.images = $('.flickr_badge_image a');
			G.images.click(function () {
				G.current_idx = G.images.index(this);
				$(G.create()).modal({
					closeHTML: <I>,</I>
					overlayId: 'gallery-overlay',
					containerId: 'gallery-container',
					containerCss: {left:0, width:'100%'},
					opacity: 80,
					position: ['10%', null],
					onOpen: G.open,
					onClose: G.close
				});
</P><P>				return false;
			});
		},
		/*
		 * Creates the HTML for the viewer 
		 */
		create: function () {
</P>
			return $(&quot;<DIV id="gallery"> \
					<DIV id="gallery-image-container"> \
						<DIV id="gallery-controls"> \
							<DIV id="gallery-previous"> \
<P>&lt;a href='#' id='gallery-previous-link'&gt;« Prev&lt;/a&gt; \
</P></DIV> \
							<DIV id="gallery-next"> \
<P>&lt;a href='#' id='gallery-next-link'&gt;Next »&lt;/a&gt; \
</P></DIV> \
						</DIV> \
					</DIV> \
					<DIV id="gallery-meta-container"> \
						<DIV id="gallery-meta"> \
							 \
							<DIV id="gallery-close">&lt;a href='#' class='simplemodal-close'&gt;X&lt;/a&gt;</DIV> \
						</DIV> \
					</DIV> \
				</DIV>&quot;);
<P>		},
		/*
		 * SimpleModal callback to create the 
		 * viewer and open it with animations 
		 */
		open: function (d) {
			G.container = d.container[0];
			G.gallery = $('#gallery', G.container);
			G.image_container = $('#gallery-image-container', G.container);
			G.controls = $('#gallery-controls', G.container);
			G.next = $('#gallery-next-link', G.container);
			G.previous = $('#gallery-previous-link', G.container);
			G.meta_container = $('#gallery-meta-container', G.container);
			G.meta = $('#gallery-meta', G.container);
			G.title = $('#gallery-title', G.container);
			G.pages = $('#gallery-pages', G.container);
</P><P>			d.overlay.slideDown(300, function () {
				d.container
					.css({height:0})
					.show(function () {
						d.data.slideDown(300, function () {
							// load the first image
							G.display();
						});
					});
			});
		},
		/*
		 * SimpleModal callback to close the 
		 * viewer with animations
		 */
		close: function (d) {
			var self = this;
			G.meta.slideUp(function () {
				G.image_container.fadeOut('fast', function () {
					d.data.slideUp(500, function () {
						d.container.fadeOut(500, function () {
							d.overlay.slideUp(500, function () {
								self.close(); // or $.modal.close();	
							});
						});
					});
					G.unbind();
				});
			});
		},
		/*
		 * Display the previous/next image 
		 */
		browse: function (link) {
			G.current_idx = $(link).parent().is('#gallery-next') ? (G.current_idx + 1) : (G.current_idx - 1);
			G.display();
		},
		/* display the requested image and animate the height/width of the container */
		display: function () {
			G.controls.hide();
			G.meta.slideUp(300, function () {
				G.meta_container.hide();
				G.image_container.fadeOut('fast', function () {
					$('#gallery-image', G.container).remove();
</P><P>					var img = new Image();
					img.onload = function () {
						G.load(img);
					};
					img.src = G.images.eq(G.current_idx).find('img').attr('src').replace(/_(s|t|m)\.jpg$/, '.jpg');
</P><P>					if (G.current_idx !== 0) {
						// pre-load prev img
						var p = new Image();
						p.src = G.images.eq(G.current_idx - 1).find('img').attr('src').replace(/_(s|t|m)\.jpg$/, '.jpg');
					}
					if (G.current_idx !== (G.images.length - 1)) {
						// pre-load next img
						var n = new Image();
						n.src = G.images.eq(G.current_idx + 1).find('img').attr('src').replace(/_(s|t|m)\.jpg$/, '.jpg');
					}
				});
			});
		},
		load: function (img) {
			var i = $(img);
			i.attr('id', 'gallery-image').hide().appendTo('body');
			var h = i.outerHeight(true),
				w = i.outerWidth(true);
</P><P>			if (G.gallery.height() !== h || G.gallery.width() !== w) {
				G.gallery.animate(
					{height: h},
					300,
					function () {
						G.gallery.animate(
							{width: w},
							300,
							function () {
								G.show(i);
							}
						);
					}
				);
			}
			else {
				G.show(i);
			}
		},
		/* 
		 * Show the image and then the controls and meta 
		 */
		show: function (img) {
			img.show();
			G.image_container.prepend(img).fadeIn('slow', function () {
				G.showControls();
				G.showMeta();
			});
		},
		/*
		 * Show the image controls; previous and next 
		 */
		showControls: function () {
			G.next.hide().removeClass('disabled');
			G.previous.hide().removeClass('disabled');
			G.unbind();
</P><P>			if (G.current_idx === 0) {
				G.previous.addClass('disabled');
			}
			if (G.current_idx === (G.images.length - 1)) {
				G.next.addClass('disabled');
			}
			G.controls.show();
</P><P>			$('a', G.controls[0]).bind('click.gallery', function () {
				G.browse(this);
				return false;
			});
			$(document).bind('keydown.gallery', function (e) {
				if (!G.active) {
					if ((e.keyCode === 37 || e.keyCode === 80) &amp;&amp; G.current_idx !== 0) {
						G.active = true;
						G.previous.trigger('click.gallery');
					}
					else if ((e.keyCode === 39 || e.keyCode === 78) &amp;&amp; G.current_idx !== (G.images.length - 1)) {
						G.active = true;
						G.next.trigger('click.gallery');
					}
				}
			});
			$('div', G.controls[0]).hover(
				function () {
					var self = this,
						l = $(self).find('a:not(.disabled)');
					if (l.length &gt; 0) {
						l.show();
					}
				},
				function () {
					$(this).find('a').hide();
				}
			);
		},
		/*
		 * Show the image meta; title, image x of x and the close X 
		 */
		showMeta: function () {
			var link = G.images.eq(G.current_idx).clone(),
				title = link.find('img').attr('title');
</P><P>			G.title.html(link.attr('title', 'View on Flickr').html(title));
			G.pages.html('Image ' + (G.current_idx + 1) + ' of ' + G.images.length);
			G.meta_container.show()
			G.meta.slideDown(function () {
				G.active = false;	
			});
		},
		/*
		 * Unbind gallery control events 
		 */
		unbind: function () {
			$('a', G.controls[0]).unbind('click.gallery');
			$(document).unbind('keydown.gallery');
			$('div', G.controls[0]).unbind('mouseenter mouseleave');
		}
	};
</P><P>	G.init();
</P><P>});
</P></DIV></DIV></DIV></DIV></DIV></BODY></HTML>