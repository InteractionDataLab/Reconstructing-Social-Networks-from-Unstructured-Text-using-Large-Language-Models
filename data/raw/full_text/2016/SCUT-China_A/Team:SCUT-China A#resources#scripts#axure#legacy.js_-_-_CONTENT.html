<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_SCUT-China_A_resources_scripts_axure_legacy_js skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:SCUT-China A/resources/scripts/axure/legacy.js</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P>//stored on each browser event
var windowEvent;
</P><P>$axure.internal(function($ax) {
</P><PRE>   var _legacy = {};
   $ax.legacy = _legacy;
</PRE><PRE>   // ************************** GLOBAL VARS *********************************//
</PRE><PRE>   // ************************************************************************//
   //Check if IE
   //var bIE = false;
   //if ((index = navigator.userAgent.indexOf(&quot;MSIE&quot;)) &gt;= 0) {
   //    bIE = true;
   //}
</PRE><PRE>   var Forms = window.document.getElementsByTagName(&quot;FORM&quot;);
   for(var i = 0; i &lt; Forms.length; i++) {
       var Form = Forms[i];
       Form.onclick = $ax.legacy.SuppressBubble;
   }
</PRE><PRE>   $ax.legacy.SuppressBubble = function(event) {
       if(IE_10_AND_BELOW) {
           window.event.cancelBubble = true;
           window.event.returnValue = false;
       } else {
           if(event) {
               event.stopPropagation();
           }
       }
   };
</PRE><PRE>   //    function InsertAfterBegin(dom, html) {
   //        if(!IE) {
   //            var phtml;
   //            var range = dom.ownerDocument.createRange();
   //            range.selectNodeContents(dom);
   //            range.collapse(true);
   //            phtml = range.createContextualFragment(html);
   //            dom.insertBefore(phtml, dom.firstChild);
   //        } else {
   //            dom.insertAdjacentHTML(&quot;afterBegin&quot;, html);
   //        }
   //    }
</PRE><PRE>   //    function InsertBeforeEnd(dom, html) {
   //        if(!IE) {
   //            var phtml;
   //            var range = dom.ownerDocument.createRange();
   //            range.selectNodeContents(dom);
   //            range.collapse(dom);
   //            phtml = range.createContextualFragment(html);
   //            dom.appendChild(phtml);
   //        } else {
   //            dom.insertAdjacentHTML(&quot;beforeEnd&quot;, html);
   //        }
   //    }
</PRE><PRE>   //Get the id of the Workflow Dialog belonging to element with id = id
</PRE><PRE>   //    function Workflow(id) {
   //        return id + 'WF';
   //    }
</PRE><PRE>   $ax.legacy.BringToFront = function(id, skipFixed) {
       _bringToFrontHelper(id);
       if(!skipFixed) $ax.legacy.BringFixedToFront();
   };
</PRE><PRE>   var _bringToFrontHelper = function(id) {
       var target = window.document.getElementById(id);
       if(target == null) return;
       $ax.globals.MaxZIndex = $ax.globals.MaxZIndex + 1;
       target.style.zIndex = $ax.globals.MaxZIndex;
   };
</PRE><PRE>   $ax.legacy.BringFixedToFront = function() {
       $ax(function(diagramObject) { return diagramObject.fixedKeepInFront; }).each(function(diagramObject, scriptId) {
           _bringToFrontHelper(scriptId);
       });
   };
</PRE><PRE>   $ax.legacy.SendToBack = function(id) {
       var target = window.document.getElementById(id);
       if(target == null) return;
       target.style.zIndex = $ax.globals.MinZIndex = $ax.globals.MinZIndex - 1;
   };
</PRE><PRE>   $ax.legacy.RefreshScreen = function() {
       var oldColor = window.document.body.style.backgroundColor;
       var setColor = (oldColor == &quot;rgb(0,0,0)&quot;) ? &quot;#FFFFFF&quot; : &quot;#000000&quot;;
       window.document.body.style.backgroundColor = setColor;
       window.document.body.style.backgroundColor = oldColor;
   };
</PRE><PRE>   $ax.legacy.getAbsoluteLeft = function(currentNode, elementId) {
       var oldDisplay = currentNode.css('display');
       var displaySet = false;
       if(oldDisplay == 'none') {
           currentNode.css('display', <I>);</I>
           displaySet = true;
       }
       var left = currentNode.offset().left;
</PRE><PRE>       // Special Layer code
       if($ax.getTypeFromElementId(elementId) == 'layer') {
           var first = true;
           var children = currentNode.children();
           for(var i = 0; i &lt; children.length; i++) {
               var child = $(children[i]);
               var subDisplaySet = false;
               if(child.css('display') == 'none') {
                   child.css('display', <I>);</I>
                   subDisplaySet = true;
               }
               if(first) left = child.offset().left;
               else left = Math.min(child.offset().left, left);
               first = false;
</PRE><PRE>               if(subDisplaySet) child.css('display', 'none');
           }
       }
</PRE><PRE>       if (displaySet) currentNode.css('display', oldDisplay);
</PRE><PRE>       return $axure.fn.bodyToWorld(left, true);
   };
</PRE><PRE>   $ax.legacy.getAbsoluteTop = function(currentNode, elementId) {
       var oldDisplay = currentNode.css('display');
       var displaySet = false;
       if(oldDisplay == 'none') {
           currentNode.css('display', <I>);</I>
           displaySet = true;
       }
       var top = currentNode.offset().top;
</PRE><PRE>       // Special Layer code
       if ($ax.getTypeFromElementId(elementId) == 'layer') {
           var first = true;
           var children = currentNode.children();
           for (var i = 0; i &lt; children.length; i++) {
               var child = $(children[i]);
               var subDisplaySet = false;
               if (child.css('display') == 'none') {
                   child.css('display', <I>);</I>
                   subDisplaySet = true;
               }
               if (first) top = child.offset().top;
               else top = Math.min(child.offset().top, top);
               first = false;
</PRE><PRE>               if (subDisplaySet) child.css('display', 'none');
           }
       }
</PRE><PRE>       if(displaySet) currentNode.css('display', oldDisplay);
       return top;
   };
</PRE><PRE>   // ******************  Annotation and Link Functions ****************** //
</PRE><PRE>   $ax.legacy.GetAnnotationHtml = function(annJson) {
       var retVal = &quot;&quot;;
       for(var noteName in annJson) {
           if(noteName != &quot;label&quot; &amp;&amp; noteName != &quot;id&quot;) {
</PRE>
                retVal += &quot;<DIV class="annotationName">&quot; + noteName + &quot;</DIV>&quot;;
                retVal += &quot;<DIV class="annotationValue">&quot; + linkify(annJson[noteName]) + &quot;</DIV>&quot;;
<PRE>           }
       }
       return retVal;
</PRE><PRE>       function linkify(text) {
           var urlRegex = /(\b(((https?|ftp|file):\/\/)|(www\.))[-A-Z0-9+&amp;@#\/%?=~_|!:,.;]*[-A-Z0-9+&amp;@#\/%=~_|])/ig;
           return text.replace(urlRegex, function (url, b, c) {
               var url2 = (c == 'www.') ? '<A rel="nofollow" class="external free" href="http://'">http://'</A> + url : url;
               return '&lt;a href=&quot;' + url2 + '&quot; target=&quot;_blank&quot; class=&quot;noteLink&quot;&gt;' + url + '&lt;/a&gt;';
           });
       }
   };
</PRE><PRE>   $ax.legacy.GetScrollable = function(target) {
       var $target = $(target);
       var last = $target;
       // Start past inital target. Can't scroll to target in itself, must be some ancestor.
       var current = last.parent();
</PRE><PRE>       while(!current.is('body') &amp;&amp; !current.is('html')) {
           var elementId = current.attr('id');
           var diagramObject = elementId &amp;&amp; $ax.getObjectFromElementId(elementId);
           if (diagramObject &amp;&amp; $ax.public.fn.IsDynamicPanel(diagramObject.type) &amp;&amp; diagramObject.scrollbars != 'none') {
               //returns the panel diagram div which handles scrolling
               return window.document.getElementById(last.attr('id'));
           }
           last = current;
           current = current.parent();
       }
       // Need to do this because of ie
       if(IE_10_AND_BELOW) return window.document.documentElement;
       else return window.document.body;
   };
</PRE><P>});
</P></DIV></DIV></DIV></DIV></DIV></BODY></HTML>