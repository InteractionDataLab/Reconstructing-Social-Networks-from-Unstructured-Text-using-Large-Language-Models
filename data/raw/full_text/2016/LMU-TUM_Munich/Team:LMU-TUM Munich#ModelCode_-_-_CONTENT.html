<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_LMU-TUM_Munich_ModelCode skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:LMU-TUM Munich/ModelCode</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P>&lt;!DOCTYPE html&gt;<TITLE>simulation</TITLE></P><DIV tabindex="-1" id="notebook" class="border-box-sizing"><DIV class="container" id="notebook-container"><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [1]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="kn">import</SPAN><SPAN class="nn">numpy</SPAN><SPAN class="kn">as</SPAN><SPAN class="nn">np</SPAN><SPAN class="kn">import</SPAN><SPAN class="nn">matplotlib.pylab</SPAN><SPAN class="kn">as</SPAN><SPAN class="nn">plt</SPAN><SPAN class="o">%</SPAN><SPAN class="k">matplotlib</SPAN> inline
</PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [2]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="kn">from</SPAN><SPAN class="nn">monomers</SPAN><SPAN class="kn">import</SPAN><SPAN class="o">*</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [3]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="k">def</SPAN><SPAN class="nf">init_monomers</SPAN><SPAN class="p">(</SPAN><SPAN class="n">n_cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_cell_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">30</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_protein_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">4</SPAN><SPAN class="p">):</SPAN><SPAN class="n">Cell</SPAN><SPAN class="o">.</SPAN><SPAN class="n">n_cells</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="n">cells</SPAN><SPAN class="o">=</SPAN><SPAN class="p">[]</SPAN><SPAN class="k">for</SPAN><SPAN class="n">i</SPAN><SPAN class="ow">in</SPAN><SPAN class="nb">range</SPAN><SPAN class="p">(</SPAN><SPAN class="n">n_cells</SPAN><SPAN class="p">):</SPAN><SPAN class="n">cells</SPAN><SPAN class="o">.</SPAN><SPAN class="n">append</SPAN><SPAN class="p">(</SPAN><SPAN class="n">Cell</SPAN><SPAN class="p">(</SPAN><SPAN class="n">n_cell_binding</SPAN><SPAN class="p">))</SPAN><SPAN class="n">Protein</SPAN><SPAN class="o">.</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="n">proteins</SPAN><SPAN class="o">=</SPAN><SPAN class="p">[]</SPAN><SPAN class="k">for</SPAN><SPAN class="n">i</SPAN><SPAN class="ow">in</SPAN><SPAN class="nb">range</SPAN><SPAN class="p">(</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="p">):</SPAN><SPAN class="n">proteins</SPAN><SPAN class="o">.</SPAN><SPAN class="n">append</SPAN><SPAN class="p">(</SPAN><SPAN class="n">Protein</SPAN><SPAN class="p">(</SPAN><SPAN class="n">n_protein_binding</SPAN><SPAN class="p">))</SPAN><SPAN class="k">return</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">proteins</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [4]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="k">def</SPAN><SPAN class="nf">polymerize</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">):</SPAN><SPAN class="n">free_cell_bindings</SPAN><SPAN class="o">=</SPAN><SPAN class="p">[]</SPAN><SPAN class="k">for</SPAN><SPAN class="n">c</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">:</SPAN><SPAN class="n">free_cell_bindings</SPAN><SPAN class="o">+=</SPAN><SPAN class="n">c</SPAN><SPAN class="o">.</SPAN><SPAN class="n">free_bindings</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="o">=</SPAN><SPAN class="p">[]</SPAN><SPAN class="k">for</SPAN><SPAN class="n">p</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">:</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="o">+=</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">free_bindings</SPAN><SPAN class="k">while</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="p">)</SPAN><SPAN class="o">&gt;</SPAN><SPAN class="mi">0</SPAN><SPAN class="ow">and</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">free_cell_bindings</SPAN><SPAN class="p">)</SPAN><SPAN class="o">&gt;</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">:</SPAN><SPAN class="n">p_binding_idx</SPAN><SPAN class="o">=</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">random</SPAN><SPAN class="o">.</SPAN><SPAN class="n">randint</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="p">))</SPAN><SPAN class="n">p_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="o">.</SPAN><SPAN class="n">pop</SPAN><SPAN class="p">(</SPAN><SPAN class="n">p_binding_idx</SPAN><SPAN class="p">)</SPAN><SPAN class="n">c_binding_idx</SPAN><SPAN class="o">=</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">random</SPAN><SPAN class="o">.</SPAN><SPAN class="n">randint</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">free_cell_bindings</SPAN><SPAN class="p">))</SPAN><SPAN class="n">c_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="n">free_cell_bindings</SPAN><SPAN class="o">.</SPAN><SPAN class="n">pop</SPAN><SPAN class="p">(</SPAN><SPAN class="n">c_binding_idx</SPAN><SPAN class="p">)</SPAN><SPAN class="c1">#print c_binding.parent.id, p_binding.parent.id</SPAN><SPAN class="n">p_binding</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bind</SPAN><SPAN class="p">(</SPAN><SPAN class="n">c_binding</SPAN><SPAN class="p">)</SPAN><SPAN class="k">return</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="p">)</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">free_cell_bindings</SPAN><SPAN class="p">)</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [49]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="k">def</SPAN><SPAN class="nf">polymerize_spacial</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_protein_binding</SPAN><SPAN class="p">,</SPAN><SPAN class="n">concentration</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.01</SPAN><SPAN class="p">,</SPAN><SPAN class="n">reactivity</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.2</SPAN><SPAN class="p">,</SPAN><SPAN class="n">mobility</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.05</SPAN><SPAN class="p">,</SPAN><SPAN class="n">max_time</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">10.</SPAN><SPAN class="p">):</SPAN><SPAN class="n">time</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.</SPAN><SPAN class="n">position_variance</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">1.</SPAN><SPAN class="n">distance_binding_probability</SPAN><SPAN class="o">=</SPAN><SPAN class="k">lambda</SPAN><SPAN class="n">x</SPAN><SPAN class="p">:</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">exp</SPAN><SPAN class="p">(</SPAN><SPAN class="o">-</SPAN><SPAN class="n">x</SPAN><SPAN class="o">**</SPAN><SPAN class="mi">2</SPAN><SPAN class="o">/</SPAN><SPAN class="n">position_variance</SPAN><SPAN class="o">**</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">)</SPAN><SPAN class="o">/</SPAN><SPAN class="p">(</SPAN><SPAN class="mi">2</SPAN><SPAN class="o">*</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">pi</SPAN><SPAN class="o">*</SPAN><SPAN class="n">position_variance</SPAN><SPAN class="o">**</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">)</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="o">=</SPAN><SPAN class="p">[]</SPAN><SPAN class="k">for</SPAN><SPAN class="n">p</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">:</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="o">+=</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">free_bindings</SPAN><SPAN class="k">while</SPAN><SPAN class="p">(</SPAN><SPAN class="n">time</SPAN><SPAN class="o">&lt;</SPAN><SPAN class="n">max_time</SPAN><SPAN class="p">):</SPAN><SPAN class="k">for</SPAN><SPAN class="n">i</SPAN><SPAN class="ow">in</SPAN><SPAN class="nb">range</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">int</SPAN><SPAN class="p">(</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">ceil</SPAN><SPAN class="p">(</SPAN><SPAN class="n">reactivity</SPAN><SPAN class="o">*</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="p">)))):</SPAN><SPAN class="c1"># choose a random PBS</SPAN><SPAN class="n">p_binding_idx</SPAN><SPAN class="o">=</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">random</SPAN><SPAN class="o">.</SPAN><SPAN class="n">randint</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="p">))</SPAN><SPAN class="n">p_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="p">[</SPAN><SPAN class="n">p_binding_idx</SPAN><SPAN class="p">]</SPAN><SPAN class="c1"># do tests on parent protein</SPAN><SPAN class="n">p</SPAN><SPAN class="o">=</SPAN><SPAN class="n">p_binding</SPAN><SPAN class="o">.</SPAN><SPAN class="n">parent</SPAN><SPAN class="c1"># position: the liwer to concentration, the higher the distance</SPAN><SPAN class="n">p_pos</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">float</SPAN><SPAN class="p">(</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">id</SPAN><SPAN class="p">)</SPAN><SPAN class="o">/</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">)</SPAN><SPAN class="o">*</SPAN><SPAN class="n">concentration</SPAN><SPAN class="p">)</SPAN><SPAN class="c1"># (float) idx of nearest cell</SPAN><SPAN class="n">c_id_mean</SPAN><SPAN class="o">=</SPAN><SPAN class="n">p_pos</SPAN><SPAN class="o">*</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">)</SPAN><SPAN class="o">*</SPAN><SPAN class="n">concentration</SPAN><SPAN class="c1"># max distance of reachable cells from nearest cell</SPAN><SPAN class="n">max_range</SPAN><SPAN class="o">=</SPAN><SPAN class="n">position_variance</SPAN><SPAN class="o">*</SPAN><SPAN class="mf">3.2</SPAN><SPAN class="n">c_id_range</SPAN><SPAN class="o">=</SPAN><SPAN class="n">max_range</SPAN><SPAN class="o">*</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">)</SPAN><SPAN class="o">*</SPAN><SPAN class="n">concentration</SPAN><SPAN class="n">c_id_min</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">max</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">int</SPAN><SPAN class="p">(</SPAN><SPAN class="n">c_id_mean</SPAN><SPAN class="o">-</SPAN><SPAN class="n">c_id_range</SPAN><SPAN class="p">),</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN><SPAN class="n">c_id_max</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">min</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">int</SPAN><SPAN class="p">(</SPAN><SPAN class="n">c_id_mean</SPAN><SPAN class="o">+</SPAN><SPAN class="n">c_id_range</SPAN><SPAN class="p">),</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">))</SPAN><SPAN class="n">candidate_cells</SPAN><SPAN class="o">=</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">[</SPAN><SPAN class="n">c_id_min</SPAN><SPAN class="p">:</SPAN><SPAN class="n">c_id_max</SPAN><SPAN class="p">]</SPAN><SPAN class="c1"># each has a probability according to the distance</SPAN><SPAN class="k">if</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">candidate_cells</SPAN><SPAN class="p">)</SPAN><SPAN class="o">==</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">:</SPAN><SPAN class="k">continue</SPAN><SPAN class="n">min_distance</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">max</SPAN><SPAN class="p">(</SPAN><SPAN class="n">p_pos</SPAN><SPAN class="o">-</SPAN><SPAN class="n">position_variance</SPAN><SPAN class="o">*</SPAN><SPAN class="mf">3.2</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">)</SPAN><SPAN class="o">-</SPAN><SPAN class="n">p_pos</SPAN><SPAN class="n">max_distance</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">min</SPAN><SPAN class="p">(</SPAN><SPAN class="o">-</SPAN><SPAN class="n">p_pos</SPAN><SPAN class="o">+</SPAN><SPAN class="n">position_variance</SPAN><SPAN class="o">*</SPAN><SPAN class="mf">3.2</SPAN><SPAN class="p">,</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">)</SPAN><SPAN class="o">-</SPAN><SPAN class="mi">1</SPAN><SPAN class="o">/</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">)</SPAN><SPAN class="o">/</SPAN><SPAN class="n">concentration</SPAN><SPAN class="p">)</SPAN><SPAN class="o">+</SPAN><SPAN class="n">p_pos</SPAN><SPAN class="n">probabilities</SPAN><SPAN class="o">=</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">arange</SPAN><SPAN class="p">(</SPAN><SPAN class="n">min_distance</SPAN><SPAN class="p">,</SPAN><SPAN class="n">max_distance</SPAN><SPAN class="p">,</SPAN><SPAN class="p">(</SPAN><SPAN class="n">max_distance</SPAN><SPAN class="o">-</SPAN><SPAN class="n">min_distance</SPAN><SPAN class="p">)</SPAN><SPAN class="o">/</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">candidate_cells</SPAN><SPAN class="p">))[:</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">candidate_cells</SPAN><SPAN class="p">)]</SPAN><SPAN class="n">probabilities</SPAN><SPAN class="o">=</SPAN><SPAN class="n">distance_binding_probability</SPAN><SPAN class="p">(</SPAN><SPAN class="n">probabilities</SPAN><SPAN class="p">)</SPAN><SPAN class="n">probabilities</SPAN><SPAN class="o">/=</SPAN><SPAN class="nb">sum</SPAN><SPAN class="p">(</SPAN><SPAN class="n">probabilities</SPAN><SPAN class="p">)</SPAN><SPAN class="c1"># pick one</SPAN><SPAN class="n">cell</SPAN><SPAN class="o">=</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">random</SPAN><SPAN class="o">.</SPAN><SPAN class="n">choice</SPAN><SPAN class="p">(</SPAN><SPAN class="n">candidate_cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">p</SPAN><SPAN class="o">=</SPAN><SPAN class="n">probabilities</SPAN><SPAN class="p">)</SPAN><SPAN class="k">try</SPAN><SPAN class="p">:</SPAN><SPAN class="n">cell</SPAN><SPAN class="o">.</SPAN><SPAN class="n">free_bindings</SPAN><SPAN class="o">.</SPAN><SPAN class="n">next</SPAN><SPAN class="p">()</SPAN><SPAN class="k">except</SPAN><SPAN class="ne">StopIteration</SPAN><SPAN class="p">:</SPAN><SPAN class="c1"># no free bindings left in this cell</SPAN><SPAN class="k">continue</SPAN><SPAN class="c1"># let react with probability respective to free bindings</SPAN><SPAN class="n">protein_partners</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">list</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">set</SPAN><SPAN class="p">([</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">partner</SPAN><SPAN class="o">.</SPAN><SPAN class="n">parent</SPAN><SPAN class="k">for</SPAN><SPAN class="n">b</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bindings</SPAN><SPAN class="k">if</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">partner</SPAN><SPAN class="ow">is</SPAN><SPAN class="ow">not</SPAN><SPAN class="bp">None</SPAN><SPAN class="p">]))</SPAN><SPAN class="k">if</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">protein_partners</SPAN><SPAN class="p">)</SPAN><SPAN class="o">==</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">:</SPAN><SPAN class="c1"># if a protein is already attatched to a cell it will most likely not bind to other cells</SPAN><SPAN class="k">if</SPAN><SPAN class="n">cell</SPAN><SPAN class="ow">not</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">protein_partners</SPAN><SPAN class="ow">and</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">random</SPAN><SPAN class="o">.</SPAN><SPAN class="n">rand</SPAN><SPAN class="p">()</SPAN><SPAN class="o">&lt;</SPAN><SPAN class="mf">0.9</SPAN><SPAN class="p">:</SPAN><SPAN class="k">continue</SPAN><SPAN class="k">if</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">protein_partners</SPAN><SPAN class="p">)</SPAN><SPAN class="o">&gt;</SPAN><SPAN class="mi">1</SPAN><SPAN class="ow">and</SPAN><SPAN class="n">cell</SPAN><SPAN class="ow">not</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">protein_partners</SPAN><SPAN class="p">:</SPAN><SPAN class="c1"># if a protein was binding to two cells already, it will not bind to any other</SPAN><SPAN class="k">continue</SPAN><SPAN class="c1">#            if np.random.rand() &lt; float(4 - len(list(p.free_bindings))) / 3.:</SPAN><SPAN class="c1">#                # can only bind to cells it's already bound to</SPAN><SPAN class="c1">#                if cell not in [b.partner.parent for b in p.bindings if b.partner is not None]:</SPAN><SPAN class="c1">#                    continue</SPAN><SPAN class="n">cell</SPAN><SPAN class="o">.</SPAN><SPAN class="n">free_bindings</SPAN><SPAN class="o">.</SPAN><SPAN class="n">next</SPAN><SPAN class="p">()</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bind</SPAN><SPAN class="p">(</SPAN><SPAN class="n">p_binding</SPAN><SPAN class="p">)</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="o">.</SPAN><SPAN class="n">pop</SPAN><SPAN class="p">(</SPAN><SPAN class="n">p_binding_idx</SPAN><SPAN class="p">)</SPAN><SPAN class="n">position_variance</SPAN><SPAN class="o">+=</SPAN><SPAN class="n">mobility</SPAN><SPAN class="n">time</SPAN><SPAN class="o">+=</SPAN><SPAN class="mf">0.01</SPAN><SPAN class="n">free_cell_bindings</SPAN><SPAN class="o">=</SPAN><SPAN class="p">[]</SPAN><SPAN class="k">for</SPAN><SPAN class="n">c</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">:</SPAN><SPAN class="n">free_cell_bindings</SPAN><SPAN class="o">+=</SPAN><SPAN class="n">c</SPAN><SPAN class="o">.</SPAN><SPAN class="n">free_bindings</SPAN><SPAN class="k">return</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">free_protein_bindings</SPAN><SPAN class="p">),</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">free_cell_bindings</SPAN><SPAN class="p">)</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [89]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">draw</SPAN><SPAN class="o">=</SPAN><SPAN class="bp">True</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [ ]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">_</SPAN><SPAN class="p">,</SPAN><SPAN class="n">_</SPAN><SPAN class="p">,</SPAN><SPAN class="n">_</SPAN><SPAN class="o">=</SPAN><SPAN class="n">random_graph</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cell_graph</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">30</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">120</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_cell_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">400</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_protein_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">4</SPAN><SPAN class="p">,</SPAN><SPAN class="n">concentration</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.02</SPAN><SPAN class="p">,</SPAN><SPAN class="n">reactivity</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.1</SPAN><SPAN class="p">,</SPAN><SPAN class="n">mobility</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.05</SPAN><SPAN class="p">,</SPAN><SPAN class="n">max_time</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">5.0</SPAN><SPAN class="p">)</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [ ]:</DIV></DIV></DIV><DIV class="cell border-box-sizing text_cell rendered"><DIV class="inner_cell"><DIV class="text_cell_render border-box-sizing rendered_html"><H2 id="Analysis">Analysis<A class="anchor-link" href="#Analysis">¶</A></H2></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [ ]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">draw</SPAN><SPAN class="o">=</SPAN><SPAN class="bp">False</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [11]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="kn">from</SPAN><SPAN class="nn">graph_tool.all</SPAN><SPAN class="kn">import</SPAN><SPAN class="o">*</SPAN><SPAN class="kn">from</SPAN><SPAN class="nn">graph_tool</SPAN><SPAN class="kn">import</SPAN><SPAN class="n">clustering</SPAN><SPAN class="p">,</SPAN><SPAN class="n">stats</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [16]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="k">def</SPAN><SPAN class="nf">cell_graph</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">draw</SPAN><SPAN class="o">=</SPAN><SPAN class="bp">False</SPAN><SPAN class="p">):</SPAN><SPAN class="sd">'''vertices are cells, cells connected via a protein are connected in the graph with an edge'''</SPAN><SPAN class="n">g</SPAN><SPAN class="o">=</SPAN><SPAN class="n">Graph</SPAN><SPAN class="p">(</SPAN><SPAN class="n">directed</SPAN><SPAN class="o">=</SPAN><SPAN class="bp">False</SPAN><SPAN class="p">)</SPAN><SPAN class="n">vertices</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">list</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">add_vertex</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">)))</SPAN><SPAN class="k">for</SPAN><SPAN class="n">c_id</SPAN><SPAN class="ow">in</SPAN><SPAN class="nb">range</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">)):</SPAN><SPAN class="k">for</SPAN><SPAN class="n">c_b</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">[</SPAN><SPAN class="n">c_id</SPAN><SPAN class="p">]</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bindings</SPAN><SPAN class="p">:</SPAN><SPAN class="k">try</SPAN><SPAN class="p">:</SPAN><SPAN class="k">for</SPAN><SPAN class="n">p_b</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">c_b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">partner</SPAN><SPAN class="o">.</SPAN><SPAN class="n">parent</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bindings</SPAN><SPAN class="p">:</SPAN><SPAN class="k">try</SPAN><SPAN class="p">:</SPAN><SPAN class="n">c2_id</SPAN><SPAN class="o">=</SPAN><SPAN class="n">p_b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">partner</SPAN><SPAN class="o">.</SPAN><SPAN class="n">parent</SPAN><SPAN class="o">.</SPAN><SPAN class="n">id</SPAN><SPAN class="k">if</SPAN><SPAN class="ow">not</SPAN><SPAN class="n">c_id</SPAN><SPAN class="o">==</SPAN><SPAN class="n">c2_id</SPAN><SPAN class="p">:</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">add_edge</SPAN><SPAN class="p">(</SPAN><SPAN class="n">vertices</SPAN><SPAN class="p">[</SPAN><SPAN class="n">c_id</SPAN><SPAN class="p">],</SPAN><SPAN class="n">vertices</SPAN><SPAN class="p">[</SPAN><SPAN class="n">c2_id</SPAN><SPAN class="p">])</SPAN><SPAN class="k">except</SPAN><SPAN class="ne">AttributeError</SPAN><SPAN class="p">:</SPAN><SPAN class="k">pass</SPAN><SPAN class="k">except</SPAN><SPAN class="ne">AttributeError</SPAN><SPAN class="p">:</SPAN><SPAN class="k">pass</SPAN><SPAN class="k">if</SPAN><SPAN class="n">draw</SPAN><SPAN class="p">:</SPAN><SPAN class="n">graph_draw</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">,</SPAN><SPAN class="n">vertex_text</SPAN><SPAN class="o">=</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex_index</SPAN><SPAN class="p">,</SPAN><SPAN class="n">edge_pen_width</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">,</SPAN><SPAN class="n">vertex_font_size</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">30</SPAN><SPAN class="p">,</SPAN><SPAN class="n">output</SPAN><SPAN class="o">=</SPAN><SPAN class="s2">&quot;/tmp/graph.png&quot;</SPAN><SPAN class="p">,</SPAN><SPAN class="n">output_size</SPAN><SPAN class="o">=</SPAN><SPAN class="p">(</SPAN><SPAN class="mi">2000</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">2000</SPAN><SPAN class="p">))</SPAN><SPAN class="k">return</SPAN><SPAN class="n">g</SPAN><SPAN class="c1">#graph_draw(g, vertex_text=g.vertex_index, vertex_font_size=18, output=&quot;/tmp/graph.png&quot;,</SPAN><SPAN class="c1">#            output_size=(2000, 2000))</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [29]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="k">def</SPAN><SPAN class="nf">random_graph</SPAN><SPAN class="p">(</SPAN><SPAN class="n">graph_method</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_cell_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">30</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_protein_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">4</SPAN><SPAN class="p">,</SPAN><SPAN class="n">concentration</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.02</SPAN><SPAN class="p">,</SPAN><SPAN class="n">reactivity</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.01</SPAN><SPAN class="p">,</SPAN><SPAN class="n">mobility</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.1</SPAN><SPAN class="p">,</SPAN><SPAN class="n">max_time</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">2.</SPAN><SPAN class="p">):</SPAN><SPAN class="c1">#    cells,proteins=init_monomers(n_cells, n_proteins, n_cell_binding, n_protein_binding)</SPAN><SPAN class="c1">#    polymerize(cells,proteins)</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">proteins</SPAN><SPAN class="o">=</SPAN><SPAN class="n">init_monomers</SPAN><SPAN class="p">(</SPAN><SPAN class="n">n_cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_cell_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">30</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_protein_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">4</SPAN><SPAN class="p">)</SPAN><SPAN class="n">polymerize_spacial</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_protein_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="n">n_protein_binding</SPAN><SPAN class="p">,</SPAN><SPAN class="n">concentration</SPAN><SPAN class="o">=</SPAN><SPAN class="n">concentration</SPAN><SPAN class="p">,</SPAN><SPAN class="n">reactivity</SPAN><SPAN class="o">=</SPAN><SPAN class="n">reactivity</SPAN><SPAN class="p">,</SPAN><SPAN class="n">mobility</SPAN><SPAN class="o">=</SPAN><SPAN class="n">mobility</SPAN><SPAN class="p">,</SPAN><SPAN class="n">max_time</SPAN><SPAN class="o">=</SPAN><SPAN class="n">max_time</SPAN><SPAN class="p">)</SPAN><SPAN class="k">return</SPAN><SPAN class="n">graph_method</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">draw</SPAN><SPAN class="p">),</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">proteins</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [83]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">results</SPAN><SPAN class="o">=</SPAN><SPAN class="p">[]</SPAN><SPAN class="n">draw</SPAN><SPAN class="o">=</SPAN><SPAN class="bp">False</SPAN><SPAN class="k">for</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">arange</SPAN><SPAN class="p">(</SPAN><SPAN class="o">-</SPAN><SPAN class="mf">1.5</SPAN><SPAN class="p">,</SPAN><SPAN class="mf">1.5</SPAN><SPAN class="p">,</SPAN><SPAN class="mf">0.1</SPAN><SPAN class="p">):</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">int</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">)</SPAN><SPAN class="o">*</SPAN><SPAN class="mi">10</SPAN><SPAN class="o">**</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="p">)</SPAN><SPAN class="n">g</SPAN><SPAN class="p">,</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">proteins</SPAN><SPAN class="o">=</SPAN><SPAN class="n">random_graph</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cell_graph</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">30</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_cell_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">400</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_protein_binding</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">4</SPAN><SPAN class="p">,</SPAN><SPAN class="n">concentration</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.02</SPAN><SPAN class="p">,</SPAN><SPAN class="n">reactivity</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.1</SPAN><SPAN class="p">,</SPAN><SPAN class="n">mobility</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">0.05</SPAN><SPAN class="p">,</SPAN><SPAN class="n">max_time</SPAN><SPAN class="o">=</SPAN><SPAN class="mf">5.0</SPAN><SPAN class="p">)</SPAN><SPAN class="n">global_clustering</SPAN><SPAN class="o">=</SPAN><SPAN class="n">clustering</SPAN><SPAN class="o">.</SPAN><SPAN class="n">global_clustering</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="n">tmp</SPAN><SPAN class="o">=</SPAN><SPAN class="n">graph_tool</SPAN><SPAN class="o">.</SPAN><SPAN class="n">topology</SPAN><SPAN class="o">.</SPAN><SPAN class="n">max_cardinality_matching</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)</SPAN><SPAN class="n">n_max_matching</SPAN><SPAN class="o">=</SPAN><SPAN class="n">tmp</SPAN><SPAN class="o">.</SPAN><SPAN class="n">count</SPAN><SPAN class="p">(</SPAN><SPAN class="n">tmp</SPAN><SPAN class="p">)</SPAN><SPAN class="n">max_shortest_path</SPAN><SPAN class="o">=</SPAN><SPAN class="n">graph_tool</SPAN><SPAN class="o">.</SPAN><SPAN class="n">topology</SPAN><SPAN class="o">.</SPAN><SPAN class="n">pseudo_diameter</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="n">tmp</SPAN><SPAN class="o">=</SPAN><SPAN class="n">graph_tool</SPAN><SPAN class="o">.</SPAN><SPAN class="n">topology</SPAN><SPAN class="o">.</SPAN><SPAN class="n">label_largest_component</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)</SPAN><SPAN class="n">biggest_cluster</SPAN><SPAN class="o">=</SPAN><SPAN class="n">tmp</SPAN><SPAN class="o">.</SPAN><SPAN class="n">get_array</SPAN><SPAN class="p">()</SPAN><SPAN class="o">.</SPAN><SPAN class="n">shape</SPAN><SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="n">tmp</SPAN><SPAN class="o">=</SPAN><SPAN class="n">graph_tool</SPAN><SPAN class="o">.</SPAN><SPAN class="n">topology</SPAN><SPAN class="o">.</SPAN><SPAN class="n">label_components</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN><SPAN class="n">tmp</SPAN><SPAN class="o">=</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">sort</SPAN><SPAN class="p">(</SPAN><SPAN class="n">tmp</SPAN><SPAN class="p">)[::</SPAN><SPAN class="o">-</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]</SPAN><SPAN class="n">n_clusters</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">tmp</SPAN><SPAN class="p">)</SPAN><SPAN class="n">biggest_cluster</SPAN><SPAN class="o">=</SPAN><SPAN class="n">tmp</SPAN><SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="n">mean_cluster</SPAN><SPAN class="o">=</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">mean</SPAN><SPAN class="p">(</SPAN><SPAN class="n">tmp</SPAN><SPAN class="p">)</SPAN><SPAN class="n">n_free_protein_bindings</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="n">n_free_proteins</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="k">for</SPAN><SPAN class="n">p</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">:</SPAN><SPAN class="n">p_free</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">list</SPAN><SPAN class="p">(</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">free_bindings</SPAN><SPAN class="p">))</SPAN><SPAN class="n">n_free_protein_bindings</SPAN><SPAN class="o">+=</SPAN><SPAN class="n">p_free</SPAN><SPAN class="k">if</SPAN><SPAN class="n">p_free</SPAN><SPAN class="o">==</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bindings</SPAN><SPAN class="p">):</SPAN><SPAN class="n">n_free_proteins</SPAN><SPAN class="o">+=</SPAN><SPAN class="mi">1</SPAN><SPAN class="n">n_free_cell_bindings</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="n">n_free_cells</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="k">for</SPAN><SPAN class="n">c</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">:</SPAN><SPAN class="n">c_free</SPAN><SPAN class="o">=</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">list</SPAN><SPAN class="p">(</SPAN><SPAN class="n">c</SPAN><SPAN class="o">.</SPAN><SPAN class="n">free_bindings</SPAN><SPAN class="p">))</SPAN><SPAN class="n">n_free_cell_bindings</SPAN><SPAN class="o">+=</SPAN><SPAN class="n">c_free</SPAN><SPAN class="k">if</SPAN><SPAN class="n">c_free</SPAN><SPAN class="o">==</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">c</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bindings</SPAN><SPAN class="p">):</SPAN><SPAN class="n">n_free_cells</SPAN><SPAN class="o">+=</SPAN><SPAN class="mi">1</SPAN><SPAN class="k">print</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_free_cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_free_cell_bindings</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_free_proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_free_protein_bindings</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_clusters</SPAN><SPAN class="p">,</SPAN><SPAN class="n">mean_cluster</SPAN><SPAN class="p">,</SPAN><SPAN class="n">biggest_cluster</SPAN><SPAN class="p">,</SPAN><SPAN class="n">global_clustering</SPAN><SPAN class="p">,</SPAN><SPAN class="n">max_shortest_path</SPAN><SPAN class="c1">#, n_max_matching, biggest_cluster</SPAN><SPAN class="n">results</SPAN><SPAN class="o">.</SPAN><SPAN class="n">append</SPAN><SPAN class="p">([</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_free_cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_free_cell_bindings</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_free_proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_free_protein_bindings</SPAN><SPAN class="p">,</SPAN><SPAN class="n">n_clusters</SPAN><SPAN class="p">,</SPAN><SPAN class="n">mean_cluster</SPAN><SPAN class="p">,</SPAN><SPAN class="n">biggest_cluster</SPAN><SPAN class="p">,</SPAN><SPAN class="n">global_clustering</SPAN><SPAN class="p">,</SPAN><SPAN class="n">max_shortest_path</SPAN><SPAN class="p">])</SPAN></PRE></DIV></DIV></DIV></DIV><DIV class="output_wrapper"><DIV class="output"><DIV class="output_area"><DIV class="output_subarea output_stream output_stdout output_text"><PRE>0 30 900 0 0 30 1.0 1 nan 0
1 29 896 0 0 30 1.0 1 nan 0
1 29 896 0 0 30 1.0 1 nan 0
1 29 896 0 0 30 1.0 1 nan 0
2 27 892 0 0 29 1.03448275862 2 0.0 1.0
3 27 888 0 0 30 1.0 1 nan 0
3 27 888 0 0 30 1.0 1 nan 0
4 25 884 0 0 29 1.03448275862 2 0.0 0
5 23 880 0 0 28 1.07142857143 2 0.0 0
7 21 872 0 0 28 1.07142857143 2 0.0 0
9 17 864 0 0 26 1.15384615385 2 0.0 0
11 18 856 0 0 29 1.03448275862 2 0.0 0
15 11 840 0 0 24 1.25 2 0.0 0
18 7 828 0 0 22 1.36363636364 3 0.0 0
23 7 808 0 0 25 1.2 3 0.0 0
30 7 780 0 0 21 1.42857142857 4 0.0 3.0
37 4 752 0 0 23 1.30434782609 3 0.0 1.0
47 0 712 0 0 14 2.14285714286 6 0.0 0
59 1 664 0 0 13 2.30769230769 5 0.0 0
75 0 600 0 0 12 2.5 10 0.0 3.0
94 0 524 0 0 9 3.33333333333 8 0.164890633763 1.0
119 0 424 0 0 7 4.28571428571 9 0.165856155618 1.0
150 0 304 0 4 2 15.0 17 0.229697260932 8.0
189 0 150 0 6 2 15.0 28 0.238134206219 1.0
238 0 24 0 76 1 30.0 30 0.273657289003 15.0
300 0 22 1 322 4 7.5 14 0.215702479339 8.0
377 0 11 4 619 6 5.0 16 0.0472049689441 3.0
475 0 0 17 1000 11 2.72727272727 7 0.0336605890603 1.0
598 0 9 61 1501 16 1.875 4 0.0 2.0
753 0 0 152 2112 22 1.36363636364 3 0.0 0
</PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [84]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">tmp_res</SPAN><SPAN class="o">=</SPAN><SPAN class="n">results</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [85]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">results</SPAN><SPAN class="o">=</SPAN><SPAN class="n">np</SPAN><SPAN class="o">.</SPAN><SPAN class="n">asarray</SPAN><SPAN class="p">(</SPAN><SPAN class="n">results</SPAN><SPAN class="p">)</SPAN><SPAN class="o">.</SPAN><SPAN class="n">T</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="o">=</SPAN><SPAN class="n">results</SPAN><SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [86]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">results</SPAN><SPAN class="o">=</SPAN><SPAN class="n">results</SPAN><SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">:]</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [ ]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">titles</SPAN><SPAN class="o">=</SPAN><SPAN class="p">[</SPAN><SPAN class="s2">&quot;n_free_cells&quot;</SPAN><SPAN class="p">,</SPAN><SPAN class="s2">&quot;n_free_cell_bindings&quot;</SPAN><SPAN class="p">,</SPAN><SPAN class="s2">&quot;n_free_proteins&quot;</SPAN><SPAN class="p">,</SPAN><SPAN class="s2">&quot;n_free_protein_bindings&quot;</SPAN><SPAN class="p">,</SPAN><SPAN class="s2">&quot;n_clusters&quot;</SPAN><SPAN class="p">,</SPAN><SPAN class="s2">&quot;mean_cluster&quot;</SPAN><SPAN class="p">,</SPAN><SPAN class="s2">&quot;biggest_cluster&quot;</SPAN><SPAN class="p">,</SPAN><SPAN class="s2">&quot;global_clustering&quot;</SPAN><SPAN class="p">,</SPAN><SPAN class="s2">&quot;max_shortest_path&quot;</SPAN><SPAN class="p">]</SPAN><SPAN class="n">f</SPAN><SPAN class="p">,</SPAN><SPAN class="n">axes</SPAN><SPAN class="o">=</SPAN><SPAN class="n">plt</SPAN><SPAN class="o">.</SPAN><SPAN class="n">subplots</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">titles</SPAN><SPAN class="p">)</SPAN><SPAN class="o">/</SPAN><SPAN class="mi">2</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">,</SPAN><SPAN class="n">figsize</SPAN><SPAN class="o">=</SPAN><SPAN class="p">(</SPAN><SPAN class="mi">16</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">8</SPAN><SPAN class="o">*</SPAN><SPAN class="p">(</SPAN><SPAN class="nb">len</SPAN><SPAN class="p">(</SPAN><SPAN class="n">titles</SPAN><SPAN class="p">)</SPAN><SPAN class="o">/</SPAN><SPAN class="mi">2</SPAN><SPAN class="o">+</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">)))</SPAN><SPAN class="k">for</SPAN><SPAN class="n">i</SPAN><SPAN class="p">,</SPAN><SPAN class="n">result</SPAN><SPAN class="ow">in</SPAN><SPAN class="nb">enumerate</SPAN><SPAN class="p">(</SPAN><SPAN class="n">results</SPAN><SPAN class="p">):</SPAN><SPAN class="n">ax</SPAN><SPAN class="o">=</SPAN><SPAN class="n">axes</SPAN><SPAN class="p">[</SPAN><SPAN class="n">i</SPAN><SPAN class="o">/</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">,</SPAN><SPAN class="n">i</SPAN><SPAN class="o">%</SPAN><SPAN class="k">2</SPAN>]
    <SPAN class="n">ax</SPAN><SPAN class="o">.</SPAN><SPAN class="n">set_title</SPAN><SPAN class="p">(</SPAN><SPAN class="n">titles</SPAN><SPAN class="p">[</SPAN><SPAN class="n">i</SPAN><SPAN class="p">])</SPAN><SPAN class="n">ax</SPAN><SPAN class="o">.</SPAN><SPAN class="n">plot</SPAN><SPAN class="p">(</SPAN><SPAN class="n">n_proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">result</SPAN><SPAN class="o">.</SPAN><SPAN class="n">T</SPAN><SPAN class="p">,</SPAN><SPAN class="s2">&quot;-x&quot;</SPAN><SPAN class="p">)</SPAN><SPAN class="n">ax</SPAN><SPAN class="o">.</SPAN><SPAN class="n">set_xscale</SPAN><SPAN class="p">(</SPAN><SPAN class="s2">&quot;log&quot;</SPAN><SPAN class="p">)</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [26]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">clustering</SPAN><SPAN class="o">.</SPAN><SPAN class="n">global_clustering</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)</SPAN></PRE></DIV></DIV></DIV></DIV><DIV class="output_wrapper"><DIV class="output"><DIV class="output_area"><DIV class="prompt output_prompt">Out[26]:</DIV><DIV class="output_text output_subarea output_execute_result"><PRE>(0.4555753617923612, 0.0034127709652872246)</PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [37]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">stats</SPAN><SPAN class="o">.</SPAN><SPAN class="n">distance_histogram</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)</SPAN></PRE></DIV></DIV></DIV></DIV><DIV class="output_wrapper"><DIV class="output"><DIV class="output_area"><DIV class="prompt output_prompt">Out[37]:</DIV><DIV class="output_text output_subarea output_execute_result"><PRE>[array([    0.,  4534.,  5366.]), array([0, 1, 2, 3], dtype=uint64)]</PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [46]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">tmp</SPAN><SPAN class="o">=</SPAN><SPAN class="n">graph_tool</SPAN><SPAN class="o">.</SPAN><SPAN class="n">topology</SPAN><SPAN class="o">.</SPAN><SPAN class="n">max_cardinality_matching</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)</SPAN><SPAN class="n">tmp</SPAN><SPAN class="o">.</SPAN><SPAN class="n">count</SPAN><SPAN class="p">(</SPAN><SPAN class="n">tmp</SPAN><SPAN class="p">)</SPAN></PRE></DIV></DIV></DIV></DIV><DIV class="output_wrapper"><DIV class="output"><DIV class="output_area"><DIV class="prompt output_prompt">Out[46]:</DIV><DIV class="output_text output_subarea output_execute_result"><PRE>0</PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [48]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">graph_tool</SPAN><SPAN class="o">.</SPAN><SPAN class="n">topology</SPAN><SPAN class="o">.</SPAN><SPAN class="n">max_independent_vertex_set</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)</SPAN></PRE></DIV></DIV></DIV></DIV><DIV class="output_wrapper"><DIV class="output"><DIV class="output_area"><DIV class="prompt output_prompt">Out[48]:</DIV><DIV class="output_text output_subarea output_execute_result"><PRE>&lt;PropertyMap object with key type 'Vertex' and value type 'bool', for Graph 0x7f5770624b10, at 0x7f5775aac210&gt;</PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [49]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">graph_tool</SPAN><SPAN class="o">.</SPAN><SPAN class="n">topology</SPAN><SPAN class="o">.</SPAN><SPAN class="n">pseudo_diameter</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)</SPAN></PRE></DIV></DIV></DIV></DIV><DIV class="output_wrapper"><DIV class="output"><DIV class="output_area"><DIV class="prompt output_prompt">Out[49]:</DIV><DIV class="output_text output_subarea output_execute_result"><PRE>(2.0,
 (&lt;Vertex object with index '0' at 0x7f577062e250&gt;,
  &lt;Vertex object with index '56' at 0x7f577062e3d0&gt;))</PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [54]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">tmp</SPAN><SPAN class="o">=</SPAN><SPAN class="n">graph_tool</SPAN><SPAN class="o">.</SPAN><SPAN class="n">topology</SPAN><SPAN class="o">.</SPAN><SPAN class="n">label_largest_component</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)</SPAN><SPAN class="n">tmp</SPAN><SPAN class="o">.</SPAN><SPAN class="n">get_array</SPAN><SPAN class="p">()</SPAN><SPAN class="o">.</SPAN><SPAN class="n">shape</SPAN><SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN></PRE></DIV></DIV></DIV></DIV><DIV class="output_wrapper"><DIV class="output"><DIV class="output_area"><DIV class="prompt output_prompt">Out[54]:</DIV><DIV class="output_text output_subarea output_execute_result"><PRE>(100,)</PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing text_cell rendered"><DIV class="inner_cell"><DIV class="text_cell_render border-box-sizing rendered_html"><H3 id="Cells-and-Protein-bindings-vertices">Cells and Protein bindings vertices<A class="anchor-link" href="#Cells-and-Protein-bindings-vertices">¶</A></H3></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [ ]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">g</SPAN><SPAN class="o">=</SPAN><SPAN class="n">Graph</SPAN><SPAN class="p">(</SPAN><SPAN class="n">directed</SPAN><SPAN class="o">=</SPAN><SPAN class="bp">False</SPAN><SPAN class="p">)</SPAN><SPAN class="n">v_size</SPAN><SPAN class="o">=</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">new_vertex_property</SPAN><SPAN class="p">(</SPAN><SPAN class="s2">&quot;int&quot;</SPAN><SPAN class="p">,</SPAN><SPAN class="n">val</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">20</SPAN><SPAN class="p">)</SPAN><SPAN class="n">v_group</SPAN><SPAN class="o">=</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">new_vertex_property</SPAN><SPAN class="p">(</SPAN><SPAN class="s2">&quot;int32_t&quot;</SPAN><SPAN class="p">)</SPAN><SPAN class="c1">#v_color = vprop_vint = g.new_vertex_property(&quot;vector&lt;int&gt;&quot;, vals=[])</SPAN><SPAN class="c1">#cell_vertices = list(g.add_vertex(n_cells))</SPAN><SPAN class="k">for</SPAN><SPAN class="n">cell</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">:</SPAN><SPAN class="n">cell</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="o">=</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">add_vertex</SPAN><SPAN class="p">()</SPAN><SPAN class="n">v_size</SPAN><SPAN class="p">[</SPAN><SPAN class="n">cell</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="p">]</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">100</SPAN><SPAN class="k">for</SPAN><SPAN class="n">p</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">:</SPAN><SPAN class="n">last_vertex</SPAN><SPAN class="o">=</SPAN><SPAN class="bp">None</SPAN><SPAN class="k">for</SPAN><SPAN class="n">b</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bindings</SPAN><SPAN class="p">:</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="o">=</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">add_vertex</SPAN><SPAN class="p">()</SPAN><SPAN class="n">v_size</SPAN><SPAN class="p">[</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="p">]</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">10</SPAN><SPAN class="n">v_group</SPAN><SPAN class="p">[</SPAN><SPAN class="n">cell</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="p">]</SPAN><SPAN class="o">=</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">id</SPAN><SPAN class="c1">#intraprotein connections</SPAN><SPAN class="k">if</SPAN><SPAN class="n">last_vertex</SPAN><SPAN class="ow">is</SPAN><SPAN class="ow">not</SPAN><SPAN class="bp">None</SPAN><SPAN class="p">:</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">add_edge</SPAN><SPAN class="p">(</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="p">,</SPAN><SPAN class="n">last_vertex</SPAN><SPAN class="p">)</SPAN><SPAN class="n">last_vertex</SPAN><SPAN class="o">=</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="c1">#cell connections</SPAN><SPAN class="k">if</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">partner</SPAN><SPAN class="ow">is</SPAN><SPAN class="ow">not</SPAN><SPAN class="bp">None</SPAN><SPAN class="p">:</SPAN><SPAN class="n">cell_vertex</SPAN><SPAN class="o">=</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">partner</SPAN><SPAN class="o">.</SPAN><SPAN class="n">parent</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">add_edge</SPAN><SPAN class="p">(</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="p">,</SPAN><SPAN class="n">cell_vertex</SPAN><SPAN class="p">)</SPAN><SPAN class="n">pos</SPAN><SPAN class="o">=</SPAN><SPAN class="n">sfdp_layout</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">,</SPAN><SPAN class="n">groups</SPAN><SPAN class="o">=</SPAN><SPAN class="n">v_group</SPAN><SPAN class="p">)</SPAN><SPAN class="c1">#graph_draw(g, vertex_text=g.vertex_index, vertex_font_size=18, output=&quot;/tmp/graph.png&quot;,</SPAN><SPAN class="c1">#            output_size=(2000, 2000))</SPAN><SPAN class="n">graph_draw</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">,</SPAN><SPAN class="n">pos</SPAN><SPAN class="o">=</SPAN><SPAN class="n">pos</SPAN><SPAN class="p">,</SPAN><SPAN class="n">edge_pen_width</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">,</SPAN><SPAN class="n">vertex_text</SPAN><SPAN class="o">=</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex_index</SPAN><SPAN class="p">,</SPAN><SPAN class="n">vertex_size</SPAN><SPAN class="o">=</SPAN><SPAN class="n">v_size</SPAN><SPAN class="p">,</SPAN><SPAN class="n">vertex_font_size</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">,</SPAN><SPAN class="n">output_size</SPAN><SPAN class="o">=</SPAN><SPAN class="p">(</SPAN><SPAN class="mi">2000</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">2000</SPAN><SPAN class="p">))</SPAN><SPAN class="c1">#graphviz_draw(g, elen=100, vsize=v_size, size=(2000, 2000))</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing text_cell rendered"><DIV class="inner_cell"><DIV class="text_cell_render border-box-sizing rendered_html"><H3 id="protein-vertices-and-cell-vertices">protein vertices and cell vertices<A class="anchor-link" href="#protein-vertices-and-cell-vertices">¶</A></H3></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [48]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="k">def</SPAN><SPAN class="nf">pc_graph</SPAN><SPAN class="p">(</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">,</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">,</SPAN><SPAN class="n">draw</SPAN><SPAN class="o">=</SPAN><SPAN class="bp">False</SPAN><SPAN class="p">):</SPAN><SPAN class="n">g</SPAN><SPAN class="o">=</SPAN><SPAN class="n">Graph</SPAN><SPAN class="p">(</SPAN><SPAN class="n">directed</SPAN><SPAN class="o">=</SPAN><SPAN class="bp">False</SPAN><SPAN class="p">)</SPAN><SPAN class="n">v_size</SPAN><SPAN class="o">=</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">new_vertex_property</SPAN><SPAN class="p">(</SPAN><SPAN class="s2">&quot;int&quot;</SPAN><SPAN class="p">)</SPAN><SPAN class="c1">#v_group = g.new_vertex_property(&quot;i'nt32_t&quot;)</SPAN><SPAN class="c1">#v_color = vprop_vint = g.new_vertex_property(&quot;vector&lt;int&gt;&quot;, vals=[])</SPAN><SPAN class="k">for</SPAN><SPAN class="n">cell</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">cells</SPAN><SPAN class="p">:</SPAN><SPAN class="n">cell</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="o">=</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">add_vertex</SPAN><SPAN class="p">()</SPAN><SPAN class="n">v_size</SPAN><SPAN class="p">[</SPAN><SPAN class="n">cell</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="p">]</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">120</SPAN><SPAN class="k">for</SPAN><SPAN class="n">p</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">proteins</SPAN><SPAN class="p">:</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="o">=</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">add_vertex</SPAN><SPAN class="p">()</SPAN><SPAN class="n">v_size</SPAN><SPAN class="p">[</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="p">]</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">40</SPAN><SPAN class="k">for</SPAN><SPAN class="n">b</SPAN><SPAN class="ow">in</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bindings</SPAN><SPAN class="p">:</SPAN><SPAN class="c1">#cell connections</SPAN><SPAN class="k">if</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">partner</SPAN><SPAN class="ow">is</SPAN><SPAN class="ow">not</SPAN><SPAN class="bp">None</SPAN><SPAN class="p">:</SPAN><SPAN class="n">cell_vertex</SPAN><SPAN class="o">=</SPAN><SPAN class="n">b</SPAN><SPAN class="o">.</SPAN><SPAN class="n">partner</SPAN><SPAN class="o">.</SPAN><SPAN class="n">parent</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="k">if</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">edge</SPAN><SPAN class="p">(</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="p">,</SPAN><SPAN class="n">cell_vertex</SPAN><SPAN class="p">)</SPAN><SPAN class="ow">is</SPAN><SPAN class="bp">None</SPAN><SPAN class="p">:</SPAN><SPAN class="c1">#only one connection per pair</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">add_edge</SPAN><SPAN class="p">(</SPAN><SPAN class="n">p</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex</SPAN><SPAN class="p">,</SPAN><SPAN class="n">cell_vertex</SPAN><SPAN class="p">)</SPAN><SPAN class="n">pos</SPAN><SPAN class="o">=</SPAN><SPAN class="n">fruchterman_reingold_layout</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">)</SPAN><SPAN class="c1">#graph_draw(g, vertex_text=g.vertex_index, vertex_font_size=18, output=&quot;/tmp/graph.png&quot;,</SPAN><SPAN class="c1">#            output_size=(2000, 2000))</SPAN><SPAN class="k">if</SPAN><SPAN class="n">draw</SPAN><SPAN class="p">:</SPAN><SPAN class="n">graph_draw</SPAN><SPAN class="p">(</SPAN><SPAN class="n">g</SPAN><SPAN class="p">,</SPAN><SPAN class="n">edge_pen_width</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">2</SPAN><SPAN class="p">,</SPAN><SPAN class="n">vertex_text</SPAN><SPAN class="o">=</SPAN><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex_index</SPAN><SPAN class="p">,</SPAN><SPAN class="n">vertex_size</SPAN><SPAN class="o">=</SPAN><SPAN class="n">v_size</SPAN><SPAN class="p">,</SPAN><SPAN class="n">vertex_font_size</SPAN><SPAN class="o">=</SPAN><SPAN class="mi">15</SPAN><SPAN class="p">,</SPAN><SPAN class="n">output_size</SPAN><SPAN class="o">=</SPAN><SPAN class="p">(</SPAN><SPAN class="mi">2000</SPAN><SPAN class="p">,</SPAN><SPAN class="mi">2000</SPAN><SPAN class="p">))</SPAN><SPAN class="k">return</SPAN><SPAN class="n">g</SPAN></PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [18]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">g</SPAN><SPAN class="o">.</SPAN><SPAN class="n">vertex_index</SPAN><SPAN class="p">[</SPAN><SPAN class="n">vertices</SPAN><SPAN class="p">[</SPAN><SPAN class="mi">1</SPAN><SPAN class="p">]]</SPAN></PRE></DIV></DIV></DIV></DIV><DIV class="output_wrapper"><DIV class="output"><DIV class="output_area"><DIV class="prompt output_prompt">Out[18]:</DIV><DIV class="output_text output_subarea output_execute_result"><PRE>1</PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [29]:</DIV><DIV class="inner_cell"><DIV class="input_area"><DIV class=" highlight hl-ipython2"><PRE><SPAN class="n">cells</SPAN><SPAN class="p">[</SPAN><SPAN class="mi">23</SPAN><SPAN class="p">]</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bindings</SPAN><SPAN class="p">[</SPAN><SPAN class="mi">5</SPAN><SPAN class="p">]</SPAN><SPAN class="o">.</SPAN><SPAN class="n">partner</SPAN><SPAN class="o">.</SPAN><SPAN class="n">parent</SPAN><SPAN class="o">.</SPAN><SPAN class="n">bindings</SPAN><SPAN class="p">[</SPAN><SPAN class="mi">0</SPAN><SPAN class="p">]</SPAN><SPAN class="o">.</SPAN><SPAN class="n">partner</SPAN><SPAN class="o">.</SPAN><SPAN class="n">parent</SPAN></PRE></DIV></DIV></DIV></DIV><DIV class="output_wrapper"><DIV class="output"><DIV class="output_area"><DIV class="prompt output_prompt">Out[29]:</DIV><DIV class="output_text output_subarea output_execute_result"><PRE>&lt;__main__.Cell instance at 0x7f05b3f2a7e8&gt;</PRE></DIV></DIV></DIV></DIV></DIV><DIV class="cell border-box-sizing code_cell rendered"><DIV class="input"><DIV class="prompt input_prompt">In [ ]:</DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>