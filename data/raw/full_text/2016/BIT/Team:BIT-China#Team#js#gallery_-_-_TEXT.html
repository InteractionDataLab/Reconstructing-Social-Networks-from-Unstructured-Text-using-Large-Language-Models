Team:BIT-China/Team/js/gallery
"use strict";!function(i){function n(n,o){o.jsSetup&&t(n,o.margin),n.addClass("xgallerify"),l?e(n,o):i(window).on("load",function(){e(n,o)}),i(window).resize(function(){e(n,o)})}function t(n,t){var e=i(n.children());e.css("display","inline-block").css("margin",t).find("img").css("width","100%").addClass("ximage-loaded")}function e(n,t){var e,r=[],m=[],s=n.children(),u=t.width||n.width(),l=d(u,t.mode),c=t.imagesPerRow||l.itemsPerRow;t.width&&n.width(u);for(var g=0;g<s.length;g++){var f=i(s[g]);f.width()&&(r.push(f),(r.length>=c||g==s.length-1)&&(m.push(r),g==s.length-1&&r.length<l.itemsPerRow&&"fullwidth"!=t.lastRow?"hidden"===t.lastRow&&1!==c?h(r):a(m[m.length-1],u,t.margin,e):e=o(m[m.length-1],u,t.margin,l.maxHeight),e<l.maxHeight&&(r=[])))}}function o(i,n,t,e){return r(i,e),m(i,n,t)}function a(n,t,e,o){o=r(n,o);var a=0;return i(n).each(function(){a+=i(this).width()}),a>t&&(o=m(n,t,e)),o}function h(n){return i(n).each(function(){i(this).css("display","none")}),0}function r(i,n){for(var t=0;t<i.length;t++){var e=n/i[t].height();i[t].width(i[t].width()*e)}return i[0].height()}function m(n,t,e){var o=0;i(n).each(function(){o+=i(this).width()});for(var a=(t-n.length*(e+4)*2)/o,h=0;h<n.length;h++)n[h].css("width",n[h].width()*a);return n[0].height()}function s(i){return"object"==typeof i?i:"bootstrap"==i?{maxHeight:.5*screen.height,breakPoints:[{minWidth:1170,columns:4},{minWidth:970,columns:3},{minWidth:750,columns:2},{maxWidth:750,columns:.4}]}:"bootstrapv4"==i?{maxHeight:.5*screen.height,breakPoints:[{minWidth:1200,columns:4},{minWidth:992,columns:3},{minWidth:768,columns:2},{maxWidth:768,columns:.4}]}:"flickr"==i?{maxHeight:.4*screen.height,breakPoints:[{minWidth:1800,columns:4},{minWidth:1300,columns:3},{minWidth:610,columns:2},{maxWidth:610,columns:1}]}:"small"==i?{maxHeight:.4*screen.height,breakPoints:[{minWidth:1800,columns:14},{minWidth:1300,columns:10},{minWidth:610,columns:6},{maxWidth:610,columns:4}]}:{maxHeight:.5*screen.height,breakPoints:[{minWidth:1800,columns:4},{minWidth:1200,columns:3},{minWidth:768,columns:2},{maxWidth:768,columns:1}]}}function d(i,n){var t={itemsPerRow:void 0,maxHeight:void 0};768>=i&&(t.maxHeight=screen.height);for(var e=s(n),o=e.breakPoints.length-1;o>=0;o--)e.breakPoints[o].minWidth&&e.breakPoints[o].minWidth<i?t.itemsPerRow=e.breakPoints[o].columns:e.breakPoints[o].maxWidth&&e.breakPoints[o].maxWidth>i&&(t.itemsPerRow=e.breakPoints[o].columns);return e.maxHeight&&(t.maxHeight=e.maxHeight),t}function u(i,n,t){var e;return function(){var o=this,a=arguments,h=function(){e=null,t||i.apply(o,a)},r=t&&!e;clearTimeout(e),e=setTimeout(h,n),r&&i.apply(o,a)}}var l=!1;i(window).load(function(){l=!0}),i.fn.gallerify=i.fn.xgallerify=i.fn.xGallerify=function(i){var o=this;i=i||{},i.margin=void 0!==i.margin&&null!==i.margin?i.margin:10,i.width=i.width||void 0,i.mode=i.mode||"default",i.jsSetup=void 0!==i.jsSetup&&null!==i.jsSetup?i.jsSetup:!0,i.imagesPerRow=i.imagesPerRow||void 0,i.debounceLoad=void 0!==i.debounceLoad&&null!==i.debounceLoad?i.debounceLoad:!0,i.debounceTime=void 0!==i.debounceTime&&null!==i.debounceTime?i.debounceTime:50,i.lastRow=i.lastRow||"adjust",n(o,i),this.gallerify.render=function(){t(o,i.margin),e(o,i)};var a=u(function(){e(o,i)},i.debounceTime);return this.gallerify.renderAsyncImages=function(){t(o,i.margin),i.debounceLoad?o.find("img").load(function(){a()}):o.find("img").load(function(){e(o,i)})},o}}(jQuery);
