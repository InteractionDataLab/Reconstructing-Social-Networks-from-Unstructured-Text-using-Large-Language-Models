Team:NYMU-Taipei/StyleSheets/sheetjavascriptone
//** Accordion Content script: By Dynamic Drive, at http://www.dynamicdrive.com //** Created: Jan 7th, 08'. Last updated: June 7th, 2010 to v1.9  //Version 1.9: June 7th, 2010': //**1) Ajax content support added, so a given header's content can be dynamically fetched from an external file and on demand. //**2) Optimized script performance by caching header and content container references   var ddaccordion={  ajaxloadingmsg: '
Loading Content...', //customize HTML to output while Ajax content is being fetched (if applicable)   headergroup: {}, //object to store corresponding header group based on headerclass value  contentgroup: {}, //object to store corresponding content group based on headerclass value   preloadimages:function($images){   $images.each(function(){    var preloadimage=new Image()    preloadimage.src=this.src   })  },   expandone:function(headerclass, selected){ //PUBLIC function to expand a particular header   this.toggleone(headerclass, selected, "expand")  },   collapseone:function(headerclass, selected){ //PUBLIC function to collapse a particular header   this.toggleone(headerclass, selected, "collapse")  },   expandall:function(headerclass){ //PUBLIC function to expand all headers based on their shared CSS classname   var $headers=this.headergroup[headerclass]   this.contentgroup[headerclass].filter(':hidden').each(function(){    $headers.eq(parseInt($(this).attr('contentindex'))).trigger("evt_accordion")   })  },   collapseall:function(headerclass){ //PUBLIC function to collapse all headers based on their shared CSS classname   var $headers=this.headergroup[headerclass]   this.contentgroup[headerclass].filter(':visible').each(function(){    $headers.eq(parseInt($(this).attr('contentindex'))).trigger("evt_accordion")   })  },   toggleone:function(headerclass, selected, optstate){ //PUBLIC function to expand/ collapse a particular header   var $targetHeader=this.headergroup[headerclass].eq(selected)   var $subcontent=this.contentgroup[headerclass].eq(selected)   if (typeof optstate=="undefined" || optstate=="expand" && $subcontent.is(":hidden") || optstate=="collapse" && $subcontent.is(":visible"))    $targetHeader.trigger("evt_accordion")  },   ajaxloadcontent:function($targetHeader, $targetContent, config, callback){   var ajaxinfo=$targetHeader.data('ajaxinfo')    function handlecontent(content){ //nested function    if (content){ //if ajax content has loaded     ajaxinfo.cacheddata=content //remember ajax content      ajaxinfo.status="cached" //set ajax status to cached     if ($targetContent.queue("fx").length==0){ //if this content isn't currently expanding or collapsing      $targetContent.hide().html(content) //hide loading message, then set sub content's HTML to ajax content      ajaxinfo.status="complete" //set ajax status to complete      callback() //execute callback function- expand this sub content     }    }    if (ajaxinfo.status!="complete"){     setTimeout(function(){handlecontent(ajaxinfo.cacheddata)}, 100) //call handlecontent() again until ajax content has loaded (ajaxinfo.cacheddata contains data)    }   } //end nested function    if (ajaxinfo.status=="none"){ //ajax data hasn't been fetched yet    $targetContent.html(this.ajaxloadingmsg)    $targetContent.slideDown(config.animatespeed)    ajaxinfo.status="loading" //set ajax status to "loading"    $.ajax({     url: ajaxinfo.url, //path to external menu file     error:function(ajaxrequest){      handlecontent('Error fetching content. Server Response: '+ajaxrequest.responseText)     },     success:function(content){      content=(content=="")? " " : content //if returned content is empty, set it to "space" is content no longer returns false/empty (hasn't loaded yet)      handlecontent(content)     }    })   }   else if (ajaxinfo.status=="loading")    handlecontent(ajaxinfo.cacheddata)  },   expandit:function($targetHeader, $targetContent, config, useractivated, directclick, skipanimation){   var ajaxinfo=$targetHeader.data('ajaxinfo')   if (ajaxinfo){ //if this content should be fetched via Ajax    if (ajaxinfo.status=="none" || ajaxinfo.status=="loading")     this.ajaxloadcontent($targetHeader, $targetContent, config, function(){ddaccordion.expandit($targetHeader, $targetContent, config, useractivated, directclick)})    else if (ajaxinfo.status=="cached"){     $targetContent.html(ajaxinfo.cacheddata)     ajaxinfo.cacheddata=null     ajaxinfo.status="complete"    }   }   this.transformHeader($targetHeader, config, "expand")   $targetContent.slideDown(skipanimation? 0 : config.animatespeed, function(){    config.onopenclose($targetHeader.get(0), parseInt($targetHeader.attr('headerindex')), $targetContent.css('display'), useractivated)    if (config.postreveal=="gotourl" && directclick){ //if revealtype is "Go to Header URL upon click", and this is a direct click on the header     var targetLink=($targetHeader.is("a"))? $targetHeader.get(0) : $targetHeader.find('a:eq(0)').get(0)     if (targetLink) //if this header is a link      setTimeout(function(){location=targetLink.href}, 200) //ignore link target, as window.open(targetLink, targetLink.target) doesn't work in FF if popup blocker enabled    }   })  },   collapseit:function($targetHeader, $targetContent, config, isuseractivated){   this.transformHeader($targetHeader, config, "collapse")   $targetContent.slideUp(config.animatespeed, function(){config.onopenclose($targetHeader.get(0), parseInt($targetHeader.attr('headerindex')), $targetContent.css('display'), isuseractivated)})  },   transformHeader:function($targetHeader, config, state){   $targetHeader.addClass((state=="expand")? config.cssclass.expand : config.cssclass.collapse) //alternate btw "expand" and "collapse" CSS classes   .removeClass((state=="expand")? config.cssclass.collapse : config.cssclass.expand)   if (config.htmlsetting.location=='src'){ //Change header image (assuming header is an image)?    $targetHeader=($targetHeader.is("img"))? $targetHeader : $targetHeader.find('img').eq(0) //Set target to either header itself, or first image within header    $targetHeader.attr('src', (state=="expand")? config.htmlsetting.expand : config.htmlsetting.collapse) //change header image   }   else if (config.htmlsetting.location=="prefix") //if change "prefix" HTML, locate dynamically added ".accordprefix" span tag and change it    $targetHeader.find('.accordprefix').html((state=="expand")? config.htmlsetting.expand : config.htmlsetting.collapse)   else if (config.htmlsetting.location=="suffix")    $targetHeader.find('.accordsuffix').html((state=="expand")? config.htmlsetting.expand : config.htmlsetting.collapse)  },   urlparamselect:function(headerclass){   var result=window.location.search.match(new RegExp(headerclass+"=((\\d+)(,(\\d+))*)", "i")) //check for "?headerclass=2,3,4" in URL   if (result!=null)    result=RegExp.$1.split(',')   return result //returns null, [index], or [index1,index2,etc], where index are the desired selected header indices  },   getCookie:function(Name){    var re=new RegExp(Name+"=[^;]+", "i") //construct RE to search for target name/value pair   if (document.cookie.match(re)) //if cookie found    return document.cookie.match(re)[0].split("=")[1] //return its value   return null  },   setCookie:function(name, value){   document.cookie = name + "=" + value + "; path=/"  },   init:function(config){  document.write('
