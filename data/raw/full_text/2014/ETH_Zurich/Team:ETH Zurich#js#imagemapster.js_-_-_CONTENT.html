<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_ETH_Zurich_js_imagemapster_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:ETH_Zurich/js/imagemapster.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:ETH_Zurich/js/imagemapster.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:ETH_Zurich/js/imagemapster.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:ETH_Zurich/js/imagemapster.js&amp;action=history">History               </A></LI><LI style="color:white;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:ETH_Zurich/js/imagemapster.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform">Â </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:ETH Zurich/js/imagemapster.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2014.igem.org</H3><P>/* ImageMapster
</P><PRE>  Version: 1.2.14-beta1 (6/18/2013)
</PRE><P>Copyright 2011-2012 James Treworgy
</P><P><A href="http://www.outsharked.com/imagemapster" class="external free" rel="nofollow">http://www.outsharked.com/imagemapster</A><A href="https://github.com/jamietre/ImageMapster" class="external free" rel="nofollow">https://github.com/jamietre/ImageMapster</A></P><P>A jQuery plugin to enhance image maps.
</P><UL><LI>/
</LI></UL>
(function(e){e(function(){function i(){}function s(t){var n=new i;return n.then=function(e){var n;try{return e&amp;&amp;(n=e(t)),c(n===r?t:n)}catch(i){return o(i)}},e(n)}function o(t){var n=new i;return n.then=function(e,n){var i;try{return n?(i=n(t),c(i===r?t:i)):o(t)}catch(s){return o(s)}},e(n)}function u(e){return l(e,function(e){return o(e)})}function a(){function p(e,t,n){return l(e,t,n)}function d(e){h(s(e))}function v(e){h(o(e))}function m(e){c(e)}var t,n,u,f,l,c,h;return u=[],f=[],l=function(t,n,r){var i=a();return u.push(function(e){e.then(t,n).then(i.resolve,i.reject,i.progress)}),r&amp;&amp;f.push(r),i.promise},c=function(e){var t,n=0;while(t=f[n++])t(e)},h=function(e){var t,n=0;l=e.then,h=c=function(){throw new Error(&quot;already completed&quot;)},f=r;while(t=u[n++])t(e);u=[]},t={},n=new i,n.then=t.then=p,t.promise=e(n),t.resolver=e({resolve:t.resolve=d,reject:t.reject=v,progress:t.progress=m}),t}function f(e){return e&amp;&amp;typeof e.then==&quot;function&quot;}function l(e,t,n,r){var i=c(e);return i.then(t,n,r)}function c(e){var t,n;return e instanceof i?t=e:(n=a(),f(e)?(e.then(n.resolve,n.reject,n.progress),t=n.promise):(n.resolve(e),t=n.promise)),t}function h(e,t,n,r,i){return E(2,arguments),l(e,function(e){function m(e){c(e)}function g(e){h(e)}function y(e){p(e)}function b(){c=h=p=S}var s,o,u,f,c,h,p,d,v;d=e.length&gt;&gt;&gt;0,s=Math.max(0,Math.min(t,d)),o=[],f=a(),u=l(f,n,r,i);if(!s)f.resolve(o);else{c=function(e){o.push(e),--s||(b(),f.resolve(o))},h=function(e){b(),f.reject(e)},p=f.progress;for(v=0;v&lt;d;++v)v in e&amp;&amp;l(e[v],m,g,y)}return u})}function p(e,t,n,r){return E(1,arguments),l(e,function(e){return b(e,d,[])}).then(t,n,r)}function d(e,t,n){return e[n]=t,e}function v(e,t,n,r){function i(e){return t?t(e[0]):e[0]}return h(e,1,i,n,r)}function m(e,t){return l(e,function(e){return g(e,t)})}function g(e,t){var n,r,i;r=e.length&gt;&gt;&gt;0,n=new Array(r);for(i=0;i&lt;r;i++)i in e&amp;&amp;(n[i]=l(e[i],t));return b(n,d,n)}function y(e,t,i){var s=n.call(arguments,1);return l(e,function(e){return b.apply(r,[e].concat(s))})}function b(e,n,r){var i,s;return i=e.length,s=[function(e,t,r){return l(e,function(e){return l(t,function(t){return n(e,t,r,i)})})}],arguments.length&gt;2&amp;&amp;s.push(r),t.apply(e,s)}function w(e,t,n){var r=arguments.length&gt;2;return l(e,function(e){return r&amp;&amp;(e=n),t.resolve(e),e},function(e){return t.reject(e),o(e)},t.progress)}function E(e,t){var n,r=t.length;while(r&gt;e){n=t[--r];if(n!=null&amp;&amp;typeof n!=&quot;function&quot;)throw new Error(&quot;callback is not a function&quot;)}}function S(){}var e,t,n,r;return l.defer=a,l.reject=u,l.isPromise=f,l.all=p,l.some=h,l.any=v,l.map=m,l.reduce=y,l.chain=w,e=Object.freeze||function(e){return e},i.prototype=e({always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(r,e)}}),n=[].slice,t=[].reduce||function(e){var t,n,r,i,s;s=0,t=Object(this),i=t.length&gt;&gt;&gt;0,n=arguments;if(n.length&lt;=1)for(;;){if(s in t){r=t[s++];break}if(++s&gt;=i)throw new TypeError}else r=n[1];for(;s&lt;i;++s)s in t&amp;&amp;(r=e(r,t[s],s,t));return r},l})})(typeof define==&quot;function&quot;?define:function(e){typeof module!=&quot;undefined&quot;?module.exports=e():jQuery.mapster_when=e()}),function($){$.fn.mapster=function(e){var t=$.mapster.impl;if($.isFunction(t[e]))return t[e].apply(this,Array.prototype.slice.call(arguments,1));if(typeof e==&quot;object&quot;||!e)return t.bind.apply(this,arguments);$.error(&quot;Method &quot;+e+&quot; does not exist on jQuery.mapster&quot;)},$.mapster={version:&quot;1.2.14-beta1&quot;,render_defaults:{isSelectable:!0,isDeselectable:!0,fade:!1,fadeDuration:150,fill:!0,fillColor:&quot;000000&quot;,fillColorMask:&quot;FFFFFF&quot;,fillOpacity:.7,highlight:!0,stroke:!1,strokeColor:&quot;ff0000&quot;,strokeOpacity:1,strokeWidth:1,includeKeys:&quot;&quot;,altImage:null,altImageId:null,altImages:{}},defaults:{clickNavigate:!1,wrapClass:null,wrapCss:null,onGetList:null,sortList:!1,listenToList:!1,mapKey:&quot;&quot;,mapValue:&quot;&quot;,singleSelect:!1,listKey:&quot;value&quot;,listSelectedAttribute:&quot;selected&quot;,listSelectedClass:null,onClick:null,onMouseover:null,onMouseout:null,mouseoutDelay:0,onStateChange:null,boundList:null,onConfigured:null,configTimeout:3e4,noHrefIsMask:!0,scaleMap:!0,safeLoad:!1,areas:[]},shared_defaults:{render_highlight:{fade:!0},render_select:{fade:!1},staticState:null,selected:null},area_defaults:{includeKeys:&quot;&quot;,isMask:!1},canvas_style:{position:&quot;absolute&quot;,left:0,top:0,padding:0,border:0},hasCanvas:null,isTouch:null,map_cache:[],hooks:{},addHook:function(e,t){this.hooks[e]=(this.hooks[e]||[]).push(t)},callHooks:function(e,t){$.each(this.hooks[e]||[],function(e,n){n.apply(t)})},utils:{when:$.mapster_when,defer:$.mapster_when.defer,subclass:function(e,t){var n=function(){var n=this,r=Array.prototype.slice.call(arguments,0);n.base=e.prototype,n.base.init=function(){e.prototype.constructor.apply(n,r)},t.apply(n,r)};return n.prototype=new e,n.prototype.constructor=n,n},asArray:function(e){return e.constructor===Array?e:this.split(e)},split:function(e,t){var n,r,i=e.split(&quot;,&quot;);for(n=0;n<I>=0){var i=t[e];$.isPlainObject(i)?r[e]=$.extend(r[e]||{},i):i&amp;&amp;i.constructor===Array?r[e]=i.slice(0):typeof i!=&quot;undefined&quot;&amp;&amp;(r[e]=t[e])}})}),r},isElement:function(e){return typeof HTMLElement==&quot;object&quot;?e instanceof HTMLElement:e&amp;&amp;typeof e==&quot;object&quot;&amp;&amp;e.nodeType===1&amp;&amp;typeof e.nodeName==&quot;string&quot;},indexOf:function(e,t){for(var n=0;n&lt;e.length;n++)if(e[n]===t)return n;return-1},indexOfProp:function(e,t,n){var r=e.constructor===Array?-1:null;return $.each(e,function(e,i){if(i&amp;&amp;(t?i[t]:i)===n)return r=e,!1}),r},boolOrDefault:function(e,t){return this.isBool(e)?e:t||!1},isBool:function(e){return typeof e==&quot;boolean&quot;},isUndef:function(e){return typeof e==&quot;undefined&quot;},ifFunction:function(e,t,n){$.isFunction(e)&amp;&amp;e.call(t,n)},size:function(e,t){var n=$.mapster.utils;return{width:t?e.width||e.naturalWidth:n.imgWidth(e,!0),height:t?e.height||e.naturalHeight:n.imgHeight(e,!0),complete:function(){return!!this.height&amp;&amp;!!this.width}}},setOpacity:function(e,t){$.mapster.hasCanvas()?e.style.opacity=t:$(e).each(function(e,n){typeof n.opacity!=&quot;undefined&quot;?n.opacity=t:$(n).css(&quot;opacity&quot;,t)})},fader:function(){var e={},t=0,n=function(r,i,s,o){var u,a=o/15,f,l=$.mapster.utils;if(typeof r==&quot;number&quot;){f=e[r];if(!f)return}else u=l.indexOfProp(e,null,r),u&amp;&amp;delete e[u],e[++t]=f=r,r=t;s=s||1,i=i+s/a&gt;s-.01?s:i+s/a,l.setOpacity(f,i),i&lt;s&amp;&amp;setTimeout(function(){n(r,i,s,o)},15)};return n}()},getBoundList:function(e,t){if(!e.boundList)return null;var n,r,i=$(),s=$.mapster.utils.split(t);return e.boundList.each(function(t,o){for(n=0;n</I><S><I>=0)return t&gt;=0?this.map_cache[t]:null},queueCommand:function(e,t,n,r){return e?!e.complete||e.currentAction?(e.commands.push({that:t,command:n,args:r}),!0):!1:!1},unload:function(){this.impl.unload(),this.utils=null,this.impl=null,$.fn.mapster=null,$.mapster=null,$(&quot;*&quot;).unbind()}};var m=$.mapster,u=m.utils,ap=Array.prototype;$.each([&quot;width&quot;,&quot;height&quot;],function(e,t){var n=t.substr(0,1).toUpperCase()+t.substr(1);u[&quot;img&quot;+n]=function(e,r){return(r?$(e)[t]():0)||e[t]||e[&quot;natural&quot;+n]||e[&quot;client&quot;+n]||e[&quot;offset&quot;+n]}}),m.Method=function(e,t,n,r){var i=this;i.name=r.name,i.output=e,i.input=e,i.first=r.first||!1,i.args=r.args?ap.slice.call(r.args,0):[],i.key=r.key,i.func_map=t,i.func_area=n,i.name=r.name,i.allowAsync=r.allowAsync||!1},m.Method.prototype={constructor:m.Method,go:function(){var e,t,n,r,i,s=this.input,o=[],u=this;r=s.length;for(e=0;e&lt;r;e++){t=$.mapster.getMapData(s[e]);if(t){if(!u.allowAsync&amp;&amp;m.queueCommand(t,u.input,u.name,u.args)){this.first&amp;&amp;(i=&quot;&quot;);continue}n=t.getData(s[e].nodeName===&quot;AREA&quot;?s[e]:this.key),n?$.inArray(n,o)&lt;0&amp;&amp;o.push(n):i=this.func_map.apply(t,u.args);if(this.first||typeof i!=&quot;undefined&quot;)break}}return $(o).each(function(e,t){i=u.func_area.apply(t,u.args)}),typeof i!=&quot;undefined&quot;?i:this.output}},$.mapster.impl=function(){function hasVml(){var e=$(&quot;&lt;div /&gt;&quot;).appendTo(&quot;body&quot;);e.html('&lt;v:shape id=&quot;vml_flag1&quot; adj=&quot;1&quot; /&gt;');var t=e[0].firstChild;t.style.behavior=&quot;url(#default#VML)&quot;;var n=t?typeof t.adj==&quot;object&quot;:!0;return e.remove(),n}function namespaces(){return typeof document.namespaces==&quot;object&quot;?document.namespaces:null}function hasCanvas(){var e=namespaces();return e&amp;&amp;e.g_vml_?!1:$(&quot;&lt;canvas /&gt;&quot;)[0].getContext?!0:!1}function merge_areas(e,t){var n,r,i=e.options.areas;t&amp;&amp;$.each(t,function(t,s){if(!s||!s.key)return;r=u.indexOfProp(i,&quot;key&quot;,s.key),r&gt;=0?$.extend(i[r],s):i.push(s),n=e.getDataForKey(s.key),n&amp;&amp;$.extend(n.options,s)})}function merge_options(e,t){var n=u.updateProps({},t);delete n.areas,u.updateProps(e.options,n),merge_areas(e,t.areas),u.updateProps(e.area_options,e.options)}var me={},addMap=function(e){return m.map_cache.push(e)-1},removeMap=function(e){m.map_cache.splice(e.index,1);for(var t=m.map_cache.length-1;t&gt;=this.index;t--)m.map_cache[t].index--};return me.get=function(e){var t=m.getMapData(this);if(!t||!t.complete)throw&quot;Can't access data until binding complete.&quot;;return(new m.Method(this,function(){return this.getSelected()},function(){return this.isSelected()},{name:&quot;get&quot;,args:arguments,key:e,first:!0,allowAsync:!0,defaultReturn:&quot;&quot;})).go()},me.data=function(e){return(new m.Method(this,null,function(){return this},{name:&quot;data&quot;,args:arguments,key:e})).go()},me.highlight=function(e){return(new m.Method(this,function(){if(e!==!1){var t=this.highlightId;return t&gt;=0?this.data[t].key:null}this.ensureNoHighlight()},function(){this.highlight()},{name:&quot;highlight&quot;,args:arguments,key:e,first:!0})).go()},me.keys=function(e,t){function i(e){var r,i=[];t?(r=e.areas(),$.each(r,function(e,t){i=i.concat(t.keys)})):i.push(e.key),$.each(i,function(e,t){$.inArray(t,n)&lt;0&amp;&amp;n.push(t)})}var n=[],r=m.getMapData(this);if(!r||!r.complete)throw&quot;Can't access data until binding complete.&quot;;return!r||!r.complete?&quot;&quot;:(typeof e==&quot;string&quot;?t?i(r.getDataForKey(e)):n=[r.getKeysForGroup(e)]:(t=e,this.each(function(e,t){t.nodeName===&quot;AREA&quot;&amp;&amp;i(r.getDataForArea(t))})),n.join(&quot;,&quot;))},me.select=function(){me.set.call(this,!0)},me.deselect=function(){me.set.call(this,!1)},me.set=function(e,t,n){function f(t){var n=e;if(t){switch(e){case!0:t.select(s);break;case!1:t.deselect(!0);break;default:n=t.toggle(s)}return n}}function l(e){e&amp;&amp;$.inArray(e,a)&lt;0&amp;&amp;(a.push(e),o+=(o===&quot;&quot;?&quot;&quot;:&quot;,&quot;)+e.key)}function c(t){$.each(a,function(e,n){var r=f(n);t.options.boundList&amp;&amp;m.setBoundListProperties(t.options,m.getBoundList(t.options,o),r)}),e||t.removeSelectionFinish()}var r,i,s=n,o,a;return this.filter(&quot;img,area&quot;).each(function(n,f){var h;i=m.getMapData(f),i!==r&amp;&amp;(r&amp;&amp;c(r),a=[],o=&quot;&quot;),i&amp;&amp;(h=&quot;&quot;,f.nodeName.toUpperCase()===&quot;IMG&quot;?m.queueCommand(i,$(f),&quot;set&quot;,[e,t,s])||(t instanceof Array?t.length&amp;&amp;(h=t.join(&quot;,&quot;)):h=t,h&amp;&amp;$.each(u.split(h),function(e,t){l(i.getDataForKey(t.toString())),r=i})):(s=t,m.queueCommand(i,$(f),&quot;set&quot;,[e,s])||(l(i.getDataForArea(f)),r=i)))}),i&amp;&amp;c(i),this},me.unbind=function(e){return(new m.Method(this,function(){this.clearEvents(),this.clearMapData(e),removeMap(this)},null,{name:&quot;unbind&quot;,args:arguments})).go()},me.rebind=function(e){return(new m.Method(this,function(){var t=this;t.complete=!1,t.configureOptions(e),t.bindImages().then(function(){t.buildDataset(!0),t.complete=!0})},null,{name:&quot;rebind&quot;,args:arguments})).go()},me.get_options=function(e,t){var n=u.isBool(e)?e:t;return(new m.Method(this,function(){var e=$.extend({},this.options);return n&amp;&amp;(e.render_select=u.updateProps({},m.render_defaults,e,e.render_select),e.render_highlight=u.updateProps({},m.render_defaults,e,e.render_highlight)),e},function(){return n?this.effectiveOptions():this.options},{name:&quot;get_options&quot;,args:arguments,first:!0,allowAsync:!0,key:e})).go()},me.set_options=function(e){return(new m.Method(this,function(){merge_options(this,e)},null,{name:&quot;set_options&quot;,args:arguments})).go()},me.unload=function(){var e;for(e=m.map_cache.length-1;e&gt;=0;e--)m.map_cache[e]&amp;&amp;me.unbind.call($(m.map_cache[e].image));me.graphics=null},me.snapshot=function(){return(new m.Method(this,function(){$.each(this.data,function(e,t){t.selected=!1}),this.base_canvas=this.graphics.createVisibleCanvas(this),$(this.image).before(this.base_canvas)},null,{name:&quot;snapshot&quot;})).go()},me.state=function(){var e,t=null;return $(this).each(function(n,r){if(r.nodeName===&quot;IMG&quot;)return e=m.getMapData(r),e&amp;&amp;(t=e.state()),!1}),t},me.bind=function(e){return this.each(function(t,n){var r,i,s,o;r=$(n),o=m.getMapData(n);if(o){me.unbind.apply(r);if(!o.complete)return r.bind(),!0;o=null}s=this.getAttribute(&quot;usemap&quot;),i=s&amp;&amp;$('map[name=&quot;'+s.substr(1)+'&quot;]');if(!(r.is(&quot;img&quot;)&amp;&amp;s&amp;&amp;i.size()&gt;0))return!0;r.css(&quot;border&quot;,0),o||(o=new m.MapData(this,e),o.index=addMap(o),o.map=i,o.bindImages().then(function(){o.initialize()}))})},me.init=function(e){var t,n;m.hasCanvas=function(){return u.isBool(m.hasCanvas.value)||(m.hasCanvas.value=u.isBool(e)?e:hasCanvas()),m.hasCanvas.value},m.hasVml=function(){if(!u.isBool(m.hasVml.value)){var e=namespaces();e&amp;&amp;!e.v&amp;&amp;(e.add(&quot;v&quot;,&quot;urn:schemas-microsoft-com:vml&quot;),t=document.createStyleSheet(),n=[&quot;shape&quot;,&quot;rect&quot;,&quot;oval&quot;,&quot;circ&quot;,&quot;fill&quot;,&quot;stroke&quot;,&quot;imagedata&quot;,&quot;group&quot;,&quot;textbox&quot;],$.each(n,function(e,n){t.addRule(&quot;v\\:&quot;+n,&quot;behavior: url(#default#VML); antialias:true&quot;)})),m.hasVml.value=hasVml()}return m.hasVml.value},m.isTouch=!!document.documentElement.ontouchstart,u.indexOf=Array.prototype.indexOf||u.indexOf,$.extend(m.defaults,m.render_defaults,m.shared_defaults),$.extend(m.area_defaults,m.render_defaults,m.shared_defaults)},me.test=function(obj){return eval(obj)},me}(),$.mapster.impl.init()}(jQuery),function(e){function o(t,n,r){var i=t,s=i.map_data,o=r.isMask;e.each(n.areas(),function(e,t){r.isMask=o||t.nohref&amp;&amp;s.options.noHrefIsMask,i.addShape(t,r)}),r.isMask=o}function u(e){return Math.max(0,Math.min(parseInt(e,16),255))}function a(e,t){return&quot;rgba(&quot;+u(e.substr(0,2))+&quot;,&quot;+u(e.substr(2,2))+&quot;,&quot;+u(e.substr(4,2))+&quot;,&quot;+t+&quot;)&quot;}function f(){}var t,n=e.mapster,r=n.utils,i,s;n.Graphics=function(e){var t=this;t.active=!1,t.canvas=null,t.width=0,t.height=0,t.shapes=[],t.masks=[],t.map_data=e},t=n.Graphics.prototype={constructor:n.Graphics,begin:function(t,n){var r=e(t);this.elementName=n,this.canvas=t,this.width=r.width(),this.height=r.height(),this.shapes=[],this.masks=[],this.active=!0},addShape:function(e,t){var n=t.isMask?this.masks:this.shapes;n.push({mapArea:e,options:t})},createVisibleCanvas:function(t){return e(this.createCanvasFor(t)).addClass(&quot;mapster_el&quot;).css(n.canvas_style)[0]},addShapeGroup:function(t,i,s){var u=this,a,f,l,c=this.map_data,h=t.effectiveRenderOptions(i);s&amp;&amp;e.extend(h,s),i===&quot;select&quot;?(f=&quot;static_&quot;+t.areaId.toString(),l=c.base_canvas):l=c.overlay_canvas,u.begin(l,f),h.includeKeys&amp;&amp;(a=r.split(h.includeKeys),e.each(a,function(e,t){var n=c.getDataForKey(t.toString());o(u,n,n.effectiveRenderOptions(i))})),o(u,t,h),u.render(),h.fade&amp;&amp;r.fader(n.hasCanvas()?l:e(l).find(&quot;._fill&quot;).not(&quot;.mapster_mask&quot;),0,n.hasCanvas()?1:h.fillOpacity,h.fadeDuration)}},i={renderShape:function(e,t,n){var r,i=t.coords(null,n);switch(t.shape){case&quot;rect&quot;:e.rect(i[0],i[1],i[2]-i[0],i[3]-i[1]);break;case&quot;poly&quot;:e.moveTo(i[0],i[1]);for(r=2;r&lt;t.length;r+=2)e.lineTo(i[r],i[r+1]);e.lineTo(i[0],i[1]);break;case&quot;circ&quot;:case&quot;circle&quot;:e.arc(i[0],i[1],i[2],0,Math.PI*2,!1)}},addAltImage:function(e,t,n,r){e.beginPath(),this.renderShape(e,n),e.closePath(),e.clip(),e.globalAlpha=r.altImageOpacity||r.fillOpacity,e.drawImage(t,0,0,n.owner.scaleInfo.width,n.owner.scaleInfo.height)},render:function(){var t,n,r=this,i=r.map_data,s=r.masks.length,o=r.createCanvasFor(i),u=o.getContext(&quot;2d&quot;),f=r.canvas.getContext(&quot;2d&quot;);return s&amp;&amp;(t=r.createCanvasFor(i),n=t.getContext(&quot;2d&quot;),n.clearRect(0,0,t.width,t.height),e.each(r.masks,function(e,t){n.save(),n.beginPath(),r.renderShape(n,t.mapArea),n.closePath(),n.clip(),n.lineWidth=0,n.fillStyle=&quot;#000&quot;,n.fill(),n.restore()})),e.each(r.shapes,function(e,t){u.save(),t.options.fill&amp;&amp;(t.options.altImageId?r.addAltImage(u,i.images[t.options.altImageId],t.mapArea,t.options):(u.beginPath(),r.renderShape(u,t.mapArea),u.closePath(),u.fillStyle=a(t.options.fillColor,t.options.fillOpacity),u.fill())),u.restore()}),e.each(r.shapes.concat(r.masks),function(e,t){var n=t.options.strokeWidth===1?.5:0;t.options.stroke&amp;&amp;(u.save(),u.strokeStyle=a(t.options.strokeColor,t.options.strokeOpacity),u.lineWidth=t.options.strokeWidth,u.beginPath(),r.renderShape(u,t.mapArea,n),u.closePath(),u.stroke(),u.restore())}),s?(n.globalCompositeOperation=&quot;source-out&quot;,n.drawImage(o,0,0),f.drawImage(t,0,0)):f.drawImage(o,0,0),r.active=!1,r.canvas},createCanvasFor:function(t){return e('&lt;canvas width=&quot;'+t.scaleInfo.width+'&quot; height=&quot;'+t.scaleInfo.height+'&quot;&gt;&lt;/canvas&gt;')[0]},clearHighlight:function(){var e=this.map_data.overlay_canvas;e.getContext(&quot;2d&quot;).clearRect(0,0,e.width,e.height)},refreshSelections:function(){var t,n=this.map_data;t=n.base_canvas,n.base_canvas=this.createVisibleCanvas(n),e(n.base_canvas).hide(),e(t).before(n.base_canvas),n.redrawSelections(),e(n.base_canvas).show(),e(t).remove()}},s={renderShape:function(t,n,r){var i=this,s,o,u,a,f,l,c,h=t.coords();f=i.elementName?'name=&quot;'+i.elementName+'&quot; ':&quot;&quot;,l=r?'class=&quot;'+r+'&quot; ':&quot;&quot;,a='&lt;v:fill color=&quot;#'+n.fillColor+'&quot; class=&quot;_fill&quot; opacity=&quot;'+(n.fill?n.fillOpacity:0)+'&quot; /&gt;&lt;v:stroke class=&quot;_fill&quot; opacity=&quot;'+n.strokeOpacity+'&quot;/&gt;',o=n.stroke?&quot; strokeweight=&quot;+n.strokeWidth+' stroked=&quot;t&quot; strokecolor=&quot;#'+n.strokeColor+'&quot;':' stroked=&quot;f&quot;',s=n.fill?' filled=&quot;t&quot;':' filled=&quot;f&quot;';switch(t.shape){case&quot;rect&quot;:c=&quot;&lt;v:rect &quot;+l+f+s+o+' style=&quot;zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+h[0]+&quot;px;top:&quot;+h[1]+&quot;px;width:&quot;+(h[2]-h[0])+&quot;px;height:&quot;+(h[3]-h[1])+'px;&quot;&gt;'+a+&quot;&lt;/v:rect&gt;&quot;;break;case&quot;poly&quot;:c=&quot;&lt;v:shape &quot;+l+f+s+o+' coordorigin=&quot;0,0&quot; coordsize=&quot;'+i.width+&quot;,&quot;+i.height+'&quot; path=&quot;m '+h[0]+&quot;,&quot;+h[1]+&quot; l &quot;+h.slice(2).join(&quot;,&quot;)+' x e&quot; style=&quot;zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+i.width+&quot;px;height:&quot;+i.height+'px;&quot;&gt;'+a+&quot;&lt;/v:shape&gt;&quot;;break;case&quot;circ&quot;:case&quot;circle&quot;:c=&quot;&lt;v:oval &quot;+l+f+s+o+' style=&quot;zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+(h[0]-h[2])+&quot;px;top:&quot;+(h[1]-h[2])+&quot;px;width:&quot;+h[2]*2+&quot;px;height:&quot;+h[2]*2+'px;&quot;&gt;'+a+&quot;&lt;/v:oval&gt;&quot;}return u=e(c),e(i.canvas).append(u),u},render:function(){var t,n=this;return e.each(this.shapes,function(e,t){n.renderShape(t.mapArea,t.options)}),this.masks.length&amp;&amp;e.each(this.masks,function(e,i){t=r.updateProps({},i.options,{fillOpacity:1,fillColor:i.options.fillColorMask}),n.renderShape(i.mapArea,t,&quot;mapster_mask&quot;)}),this.active=!1,this.canvas},createCanvasFor:function(t){var n=t.scaleInfo.width,r=t.scaleInfo.height;return e('')[0]},clearHighlight:function(){e(this.map_data.overlay_canvas).children().remove()},removeSelections:function(t){t&gt;=0?e(this.map_data.base_canvas).find('[name=&quot;static_'+t.toString()+'&quot;]').remove():e(this.map_data.base_canvas).children().remove()}},e.each([&quot;renderShape&quot;,&quot;addAltImage&quot;,&quot;render&quot;,&quot;createCanvasFor&quot;,&quot;clearHighlight&quot;,&quot;removeSelections&quot;,&quot;refreshSelections&quot;],function(e,r){t[r]=function(e){return function(){return t[e]=(n.hasCanvas()?i[e]:s[e])||f,t[e].apply(this,arguments)}}(r)})}(jQuery),function(e){var t=e.mapster,n=t.utils,r=[];t.MapImages=function(e){this.owner=e,this.clear()},t.MapImages.prototype={constructor:t.MapImages,slice:function(){return r.slice.apply(this,arguments)},splice:function(){r.slice.apply(this.status,arguments);var e=r.slice.apply(this,arguments);return e},complete:function(){return e.inArray(!1,this.status)&lt;0},_add:function(e){var t=r.push.call(this,e)-1;return this.status[t]=!1,t},indexOf:function(e){return n.indexOf(this,e)},clear:function(){var t=this;t.ids&amp;&amp;t.ids.length&gt;0&amp;&amp;e.each(t.ids,function(e,n){delete t[n]}),t.ids=[],t.length=0,t.status=[],t.splice(0)},add:function(t,n){var r,i,s=this;if(!t)return;if(typeof t==&quot;string&quot;){i=t,t=s[i];if(typeof t==&quot;object&quot;)return s.indexOf(t);t=e(&quot;&lt;img /&gt;&quot;).addClass(&quot;mapster_el&quot;).hide(),r=s._add(t[0]),t.bind(&quot;load&quot;,function(e){s.imageLoaded.call(s,e)}).bind(&quot;error&quot;,function(e){s.imageLoadError.call(s,e)}),t.attr(&quot;src&quot;,i)}else r=s._add(e(t)[0]);if(n){if(this[n])throw n+&quot; is already used or is not available as an altImage alias.&quot;;s.ids.push(n),s[n]=s[r]}return r},bind:function(e){var t=this,r,i=t.owner.options.configTimeout/200,s=function(){var e;e=t.length;while(e--&gt;0)if(!t.isLoaded(e))break;t.complete()?t.resolve():i--&gt;0?t.imgTimeout=window.setTimeout(function(){s.call(t,!0)},50):t.imageLoadError.call(t)};return r=t.deferred=n.defer(),s(),r},resolve:function(){var e=this,t=e.deferred;t&amp;&amp;(e.deferred=null,t.resolve())},imageLoaded:function(t){var n=this,r=n.indexOf(t.target);r&gt;=0&amp;&amp;(n.status[r]=!0,e.inArray(!1,n.status)&lt;0&amp;&amp;n.resolve())},imageLoadError:function(e){clearTimeout(this.imgTimeout),this.triesLeft=0;var t=e?&quot;The image &quot;+e.target.src+&quot; failed to load.&quot;:&quot;The images never seemed to finish loading. You may just need to increase the configTimeout if images could take a long time to load.&quot;;throw t},isLoaded:function(e){var t,r=this,i=r.status;return i[e]?!0:(t=r[e],typeof t.complete!=&quot;undefined&quot;?i[e]=t.complete:i[e]=!!n.imgWidth(t),i[e])}}}(jQuery),function(e){function r(t){e.extend(t,{complete:!1,map:null,base_canvas:null,overlay_canvas:null,commands:[],data:[],mapAreas:[],_xref:{},highlightId:-1,currentAreaId:-1,_tooltip_events:[],scaleInfo:null,index:-1,activeAreaEvent:null})}function i(e){return[e,e.render_highlight,e.render_select]}function s(r){var s=r.options,o=r.images;t.hasCanvas()&amp;&amp;(e.each(s.altImages||{},function(e,t){o.add(t,e)}),e.each([s].concat(s.areas),function(t,n){e.each(i(n),function(e,t){t&amp;&amp;t.altImage&amp;&amp;(t.altImageId=o.add(t.altImage))})})),r.area_options=n.updateProps({},t.area_defaults,s)}function o(e,t,r,i){function s(t){e.currentAreaId!==t&amp;&amp;e.highlightId&gt;=0&amp;&amp;i.resolve()}return i=i||n.when.defer(),e.activeAreaEvent&amp;&amp;(window.clearTimeout(e.activeAreaEvent),e.activeAreaEvent=0),t&lt;0?i.reject():r.owner.currentAction||t?e.activeAreaEvent=window.setTimeout(function(){return function(){o(e,0,r,i)}}(r),t||100):s(r.areaId),i}function u(e){t.hasCanvas()||this.blur(),e.preventDefault()}function a(t,n){var r=t.getAllDataForArea(this),i=r.length?r[0]:null;if(!i||i.isNotRendered()||i.owner.currentAction)return;if(t.currentAreaId===i.areaId)return;t.highlightId!==i.areaId&amp;&amp;(t.clearEffects(),i.highlight(),t.options.showToolTip&amp;&amp;e.each(r,function(e,t){t.effectiveOptions().toolTip&amp;&amp;t.showToolTip()})),t.currentAreaId=i.areaId,e.isFunction(t.options.onMouseover)&amp;&amp;t.options.onMouseover.call(this,{e:n,options:i.effectiveOptions(),key:i.key,selected:i.isSelected()})}function f(t,n){var r,i=t.getDataForArea(this),s=t.options;if(t.currentAreaId&lt;0||!i)return;r=t.getDataForArea(n.relatedTarget);if(r===i)return;t.currentAreaId=-1,i.area=null,o(t,s.mouseoutDelay,i).then(t.clearEffects),e.isFunction(s.onMouseout)&amp;&amp;s.onMouseout.call(this,{e:n,options:s,key:i.key,selected:i.isSelected()})}function l(t){var n=t.options;t.ensureNoHighlight(),n.toolTipClose&amp;&amp;e.inArray(&quot;area-mouseout&quot;,n.toolTipClose)&gt;=0&amp;&amp;t.activeToolTip&amp;&amp;t.clearToolTip()}function c(r,i){function v(u){var p,g;l=u.isSelectable()&amp;&amp;(u.isDeselectable()||!u.isSelected()),l?f=!u.isSelected():f=u.isSelected(),a=t.getBoundList(d,u.key);if(e.isFunction(d.onClick)){c=d.onClick.call(h,{e:i,listTarget:a,key:u.key,selected:f});if(n.isBool(c)){if(!c)return!1;g=e(u.area).attr(&quot;href&quot;);if(g!==&quot;#&quot;)return window.location.href=g,!1}}l&amp;&amp;(s=u.toggle()),d.boundList&amp;&amp;d.boundList.length&gt;0&amp;&amp;t.setBoundListProperties(d,a,u.isSelected()),p=u.effectiveOptions(),p.includeKeys&amp;&amp;(o=n.split(p.includeKeys),e.each(o,function(e,t){var n=r.getDataForKey(t.toString());n.options.isMask||v(n)}))}var s,o,a,f,l,c,h=this,p=r.getDataForArea(this),d=r.options;u.call(this,i);if(d.clickNavigate&amp;&amp;p.href){window.location.href=p.href;return}p&amp;&amp;!p.owner.currentAction&amp;&amp;(d=r.options,v(p))}var t=e.mapster,n=t.utils;t.MapData=function(e,n){var i=this;i.image=e,i.images=new t.MapImages(i),i.graphics=new t.Graphics(i),i.imgCssText=e.style.cssText||null,r(i),i.configureOptions(n),i.mouseover=function(e){a.call(this,i,e)},i.mouseout=function(e){f.call(this,i,e)},i.click=function(e){c.call(this,i,e)},i.clearEffects=function(e){l.call(this,i,e)}},t.MapData.prototype={constructor:t.MapData,configureOptions:function(e){this.options=n.updateProps({},t.defaults,e)},bindImages:function(){var e=this,t=e.images;return t.length&gt;2?t.splice(2):t.length===0&amp;&amp;(t.add(e.image),t.add(e.image.src)),s(e),e.images.bind()},isActive:function(){return!this.complete||this.currentAction},state:function(){return{complete:this.complete,resizing:this.currentAction===&quot;resizing&quot;,zoomed:this.zoomed,zoomedArea:this.zoomedArea,scaleInfo:this.scaleInfo}},wrapId:function(){return&quot;mapster_wrap_&quot;+this.index},_idFromKey:function(e){return typeof e==&quot;string&quot;&amp;&amp;this._xref.hasOwnProperty(e)?this._xref[e]:-1},getSelected:function(){var t=&quot;&quot;;return e.each(this.data,function(e,n){n.isSelected()&amp;&amp;(t+=(t?&quot;,&quot;:&quot;&quot;)+this.key)}),t},getAllDataForArea:function(t,r){var i,s,o,u=this,a=e(t).filter(&quot;area&quot;).attr(u.options.mapKey);if(a){o=[],a=n.split(a);for(i=0;i&lt;(r||a.length);i++)s=u.data[u._idFromKey(a[i])],s.area=t.length?t[0]:t,o.push(s)}return o},getDataForArea:function(e){var t=this.getAllDataForArea(e,1);return t?t[0]||null:null},getDataForKey:function(e){return this.data[this._idFromKey(e)]},getKeysForGroup:function(e){var t=this.getDataForKey(e);return t?t.isPrimary?t.key:this.getPrimaryKeysForMapAreas(t.areas()).join(&quot;,&quot;):&quot;&quot;},getPrimaryKeysForMapAreas:function(t){var n=[];return e.each(t,function(t,r){e.inArray(r.keys[0],n)&lt;0&amp;&amp;n.push(r.keys[0])}),n},getData:function(e){return typeof e==&quot;string&quot;?this.getDataForKey(e):e&amp;&amp;e.mapster||n.isElement(e)?this.getDataForArea(e):null},ensureNoHighlight:function(){var e;this.highlightId&gt;=0&amp;&amp;(this.graphics.clearHighlight(),e=this.data[this.highlightId],e.changeState(&quot;highlight&quot;,!1),this.setHighlightId(-1))},setHighlightId:function(e){this.highlightId=e},clearSelections:function(){e.each(this.data,function(e,t){t.selected&amp;&amp;t.deselect(!0)}),this.removeSelectionFinish()},setAreaOptions:function(e){var t,r,i;e=e||[];for(t=e.length-1;t&gt;=0;t--)r=e[t],r&amp;&amp;(i=this.getDataForKey(r.key),i&amp;&amp;(n.updateProps(i.options,r),n.isBool(r.selected)&amp;&amp;(i.selected=r.selected)))},drawSelections:function(e){var t,r=n.asArray(e);for(t=r.length-1;t&gt;=0;t--)this.data[r[t]].drawSelection()},redrawSelections:function(){e.each(this.data,function(e,t){t.isSelectedOrStatic()&amp;&amp;t.drawSelection()})},initialize:function(){var r,i,s,o,u,a,f,l,c,h,p,d,v=this,g=v.options;if(v.complete)return;c=e(v.image),u=c.parent().attr(&quot;id&quot;),u&amp;&amp;u.length&gt;=12&amp;&amp;u.substring(0,12)===&quot;mapster_wrap&quot;?(o=c.parent(),o.attr(&quot;id&quot;,v.wrapId())):(o=e(''),g.wrapClass&amp;&amp;(g.wrapClass===!0?o.addClass(c[0].className):o.addClass(g.wrapClass))),v.wrapper=o,v.scaleInfo=d=n.scaleMap(v.images[0],v.images[1],g.scaleMap),v.base_canvas=i=v.graphics.createVisibleCanvas(v),v.overlay_canvas=s=v.graphics.createVisibleCanvas(v),r=e(v.images[1]).addClass(&quot;mapster_el &quot;+v.images[0].className).attr({id:null,usemap:null}),l=n.size(v.images[0]),l.complete&amp;&amp;r.css({width:l.width,height:l.height}),v.buildDataset(),a={display:&quot;block&quot;,position:&quot;relative&quot;,padding:0,width:d.width,height:d.height},g.wrapCss&amp;&amp;e.extend(a,g.wrapCss),c.parent()[0]!==v.wrapper[0]&amp;&amp;c.before(v.wrapper),o.css(a),e(v.images.slice(2)).hide();for(f=1;f&lt;v.images.length;f++)o.append(v.images[f]);o.append(i).append(s).append(c.css(t.canvas_style)),n.setOpacity(v.images[0],0),e(v.images[1]).show(),n.setOpacity(v.images[1],1),g.isSelectable&amp;&amp;g.onGetList&amp;&amp;(p=v.data.slice(0),g.sortList&amp;&amp;(g.sortList===&quot;desc&quot;?h=function(e,t){return e===t?0:e&gt;t?-1:1}:h=function(e,t){return e===t?0:e&lt;t?-1:1},p.sort(function(e,t){return e=e.value,t=t.value,h(e,t)})),v.options.boundList=g.onGetList.call(v.image,p)),v.complete=!0,v.processCommandQueue(),g.onConfigured&amp;&amp;typeof g.onConfigured==&quot;function&quot;&amp;&amp;g.onConfigured.call(c,!0)},buildDataset:function(n){function E(e,n){var r=new t.AreaData(y,e,n);return r.areaId=y._xref[e]=y.data.push(r)-1,r.areaId}var r,i,s,o,u,a,f,l,c,h,p,d,v,g,y=this,b=y.options,w;y._xref={},y.data=[],n||(y.mapAreas=[]),w=!b.mapKey,w&amp;&amp;(b.mapKey=&quot;data-mapster-key&quot;),r=t.hasVml()?&quot;area&quot;:w?&quot;area[coords]&quot;:&quot;area[&quot;+b.mapKey+&quot;]&quot;,i=e(y.map).find(r).unbind(&quot;.mapster&quot;);for(p=0;p&lt;i.length;p++){o=0,a=i[p],u=e(a);if(!a.coords)continue;w?(f=String(p),u.attr(&quot;data-mapster-key&quot;,f)):f=a.getAttribute(b.mapKey),n?(l=y.mapAreas[u.data(&quot;mapster&quot;)-1],l.configure(f)):(l=new t.MapArea(y,a,f),y.mapAreas.push(l)),h=l.keys;for(s=h.length-1;s&gt;=0;s--)c=h[s],b.mapValue&amp;&amp;(d=u.attr(b.mapValue)),w?(o=E(y.data.length,d),v=y.data[o],v.key=c=o.toString()):(o=y._xref[c],o&gt;=0?(v=y.data[o],d&amp;&amp;!y.data[o].value&amp;&amp;(v.value=d)):(o=E(c,d),v=y.data[o],v.isPrimary=s===0)),l.areaDataXref.push(o),v.areasXref.push(p);g=u.attr(&quot;href&quot;),g&amp;&amp;g!==&quot;#&quot;&amp;&amp;!v.href&amp;&amp;(v.href=g),l.nohref||u.bind(&quot;click.mapster&quot;,y.click).bind(&quot;mouseover.mapster&quot;,y.mouseover).bind(&quot;mouseout.mapster&quot;,y.mouseout).bind(&quot;mousedown.mapster&quot;,y.mousedown),u.data(&quot;mapster&quot;,p+1)}y.setAreaOptions(b.areas),y.redrawSelections()},processCommandQueue:function(){var e,n=this;while(!n.currentAction&amp;&amp;n.commands.length)e=n.commands[0],n.commands.splice(0,1),t.impl[e.command].apply(e.that,e.args)},clearEvents:function(){e(this.map).find(&quot;area&quot;).unbind(&quot;.mapster&quot;),e(this.images).unbind(&quot;.mapster&quot;)},_clearCanvases:function(t){t||e(this.base_canvas).remove(),e(this.overlay_canvas).remove()},clearMapData:function(t){var r=this;this._clearCanvases(t),e.each(this.data,function(e,t){t.reset()}),this.data=null,t||(this.image.style.cssText=this.imgCssText,e(this.wrapper).before(this.image).remove()),r.images.clear(),this.image=null,n.ifFunction(this.clearTooltip,this)},removeSelectionFinish:function(){var e=this.graphics;e.refreshSelections(),e.clearHighlight()}}}(jQuery),function(e){function r(t){var n=this,r=n.owner;r.options.singleSelect&amp;&amp;r.clearSelections(),n.isSelected()||(t&amp;&amp;(n.optsCache=e.extend(n.effectiveRenderOptions(&quot;select&quot;),t,{altImageId:r.images.add(t.altImage)})),n.drawSelection(),n.selected=!0,n.changeState(&quot;select&quot;,!0)),r.options.singleSelect&amp;&amp;r.graphics.refreshSelections()}function i(e){var t=this;t.selected=!1,t.changeState(&quot;select&quot;,!1),t.optsCache=null,t.owner.graphics.removeSelections(t.areaId),e||t.owner.removeSelectionFinish()}function s(e){var t=this;return t.isSelected()?t.deselect():t.select(e),t.isSelected()}var t=e.mapster,n=t.utils;t.AreaData=function(t,n,r){e.extend(this,{owner:t,key:n||&quot;&quot;,isPrimary:!0,areaId:-1,href:&quot;&quot;,value:r||&quot;&quot;,options:{},selected:null,areasXref:[],area:null,optsCache:null})},t.AreaData.prototype={constuctor:t.AreaData,select:r,deselect:i,toggle:s,areas:function(){var e,t=[];for(e=0;e&lt;this.areasXref.length;e++)t.push(this.owner.mapAreas[this.areasXref[e]]);return t},coords:function(t){var n=[];return e.each(this.areas(),function(e,r){n=n.concat(r.coords(t))}),n},reset:function(){e.each(this.areas(),function(e,t){t.reset()}),this.areasXref=[],this.options=null},isSelectedOrStatic:function(){var e=this.effectiveOptions();return n.isBool(e.staticState)?e.staticState:this.isSelected()},isSelected:function(){return n.isBool(this.selected)?this.selected:n.isBool(this.owner.area_options.selected)?this.owner.area_options.selected:!1},isSelectable:function(){return n.isBool(this.effectiveOptions().staticState)?!1:n.isBool(this.owner.options.staticState)?!1:n.boolOrDefault(this.effectiveOptions().isSelectable,!0)},isDeselectable:function(){return n.isBool(this.effectiveOptions().staticState)?!1:n.isBool(this.owner.options.staticState)?!1:n.boolOrDefault(this.effectiveOptions().isDeselectable,!0)},isNotRendered:function(){var t=e(this.area);return t.attr(&quot;nohref&quot;)||!t.attr(&quot;href&quot;)||this.effectiveOptions().isMask},effectiveOptions:function(e){var t=n.updateProps({},this.owner.area_options,this.options,e||{},{id:this.areaId});return t.selected=this.isSelected(),t},effectiveRenderOptions:function(t,r){var i,s=this.optsCache;if(!s||t===&quot;highlight&quot;)i=this.effectiveOptions(r),s=n.updateProps
({},i,i[&quot;render_&quot;+t]),t!==&quot;highlight&quot;&amp;&amp;(this.optsCache=s);return e.extend({},s)},changeState:function(t,n){e.isFunction(this.owner.options.onStateChange)&amp;&amp;this.owner.options.onStateChange.call(this.owner.image,{key:this.key,state:t,selected:n})},highlight:function(e){var t=this.owner;this.effectiveOptions().highlight&amp;&amp;t.graphics.addShapeGroup(this,&quot;highlight&quot;,e),t.setHighlightId(this.areaId),this.changeState(&quot;highlight&quot;,!0)},drawSelection:function(){this.owner.graphics.addShapeGroup(this,&quot;select&quot;)}},t.MapArea=function(t,r,i){if(!t)return;var s=this;s.owner=t,s.area=r,s.areaDataXref=[],s.originalCoords=[],e.each(n.split(r.coords),function(e,t){s.originalCoords.push(parseFloat(t))}),s.length=s.originalCoords.length,s.shape=r.shape.toLowerCase(),s.nohref=r.nohref||!r.href,s.configure(i)},t.MapArea.prototype={constructor:t.MapArea,configure:function(e){this.keys=n.split(e)},reset:function(){this.area=null},coords:function(t){return e.map(this.originalCoords,function(e){return t?e:e+t})}}}(jQuery),function(e){var t=e.mapster.utils;t.areaCorners=function(n,r,i,s,o){var a,f,l,c,h,p,d,v,m,g,y,b,w,E,S=0,x=0,T,N,C,k,L,A,O=[];n=n.length?n:[n],i=i?e(i):e(document.body),a=i.offset(),T=a.left,N=a.top,r&amp;&amp;(a=e(r).offset(),S=a.left,x=a.top);for(E=0;E&lt;n.length;E++){A=n[E];if(A.nodeName===&quot;AREA&quot;){C=t.split(A.coords,parseInt);switch(A.shape){case&quot;circle&quot;:y=C[0],b=C[1],k=C[2],O=[];for(E=0;E&lt;360;E+=20)L=E*Math.PI/180,O.push(y+k*Math.cos(L),b+k*Math.sin(L));break;case&quot;rect&quot;:O.push(C[0],C[1],C[2],C[1],C[2],C[3],C[0],C[3]);break;default:O=O.concat(C)}for(E=0;E&lt;O.length;E+=2)O[E]=parseInt(O[E],10)+S,O[E+1]=parseInt(O[E+1],10)+x}else A=e(A),a=A.position(),O.push(a.left,a.top,a.left+A.width(),a.top,a.left+A.width(),a.top+A.height(),a.left,a.top+A.height())}l=c=d=m=999999,h=p=v=g=-1;for(E=O.length-2;E&gt;=0;E-=2)y=O[E],b=O[E+1],y&lt;l&amp;&amp;(l=y,g=b),y&gt;h&amp;&amp;(h=y,m=b),b&lt;c&amp;&amp;(c=b,v=y),b&gt;p&amp;&amp;(p=b,d=y);return s&amp;&amp;o&amp;&amp;(f=!1,e.each([[v-s,c-o],[d,c-o],[l-s,g-o],[l-s,m],[h,g-o],[h,m],[v-s,p],[d,p]],function(e,t){if(!f&amp;&amp;t[0]&gt;T&amp;&amp;t[1]&gt;N)return w=t,f=!0,!1}),f||(w=[h,p])),w}}(jQuery),function(e){var t=e.mapster,n=t.utils,r=t.MapArea.prototype;t.utils.getScaleInfo=function(e,t){var n;return t?(n=e.width/t.width||e.height/t.height,n&gt;.98&amp;&amp;n&lt;1.02&amp;&amp;(n=1)):(n=1,t=e),{scale:n!==1,scalePct:n,realWidth:t.width,realHeight:t.height,width:e.width,height:e.height,ratio:e.width/e.height}},t.utils.scaleMap=function(e,t,r){var i=n.size(e),s=n.size(t,!0);if(!s.complete())throw&quot;Another script, such as an extension, appears to be interfering with image loading. Please let us know about this.&quot;;return i.complete()||(i=s),this.getScaleInfo(i,r?s:null)},t.MapData.prototype.resize=function(r,i,s,o){function v(n,r,i){t.hasCanvas()?(n.width=r,n.height=i):(e(n).width(r),e(n).height(i))}function g(){d.currentAction=&quot;&quot;,e.isFunction(o)&amp;&amp;o(),d.processCommandQueue()}function y(){v(d.overlay_canvas,r,i);if(h&gt;=0){var e=d.data[h];e.tempOptions={fade:!1},d.getDataForKey(e.key).highlight(),e.tempOptions=null}v(d.base_canvas,r,i),d.redrawSelections(),g()}function b(){e(d.image).css(l),d.scaleInfo=n.getScaleInfo({width:r,height:i},{width:d.scaleInfo.realWidth,height:d.scaleInfo.realHeight}),e.each(d.data,function(t,n){e.each(n.areas(),function(e,t){t.resize()})})}var a,f,l,c,h,p,d=this;o=o||s;if(d.scaleInfo.width===r&amp;&amp;d.scaleInfo.height===i)return;h=d.highlightId,r||(p=i/d.scaleInfo.realHeight,r=Math.round(d.scaleInfo.realWidth*p)),i||(p=r/d.scaleInfo.realWidth,i=Math.round(d.scaleInfo.realHeight*p)),l={width:String(r)+&quot;px&quot;,height:String(i)+&quot;px&quot;},t.hasCanvas()||e(d.base_canvas).children().remove(),c=e(d.wrapper).find(&quot;.mapster_el&quot;).add(d.wrapper),s?(f=[],d.currentAction=&quot;resizing&quot;,c.each(function(t,r){a=n.defer(),f.push(a),e(r).animate(l,{duration:s,complete:a.resolve,easing:&quot;linear&quot;})}),a=n.defer(),f.push(a),n.when.all(f).then(y),b(),a.resolve()):(c.css(l),b(),y())},t.MapArea=n.subclass(t.MapArea,function(){this.base.init(),this.owner.scaleInfo.scale&amp;&amp;this.resize()}),r.coords=function(e,t){var n,r=[],i=e||this.owner.scaleInfo.scalePct,s=t||0;if(i===1&amp;&amp;t===0)return this.originalCoords;for(n=0;n&lt;this.length;n++)r.push(Math.round(this.originalCoords[n]*i)+s);return r},r.resize=function(){this.area.coords=this.coords().join(&quot;,&quot;)},r.reset=function(){this.area.coords=this.coords(1).join(&quot;,&quot;)},t.impl.resize=function(e,n,r,i){if(!e&amp;&amp;!n)return!1;var s=(new t.Method(this,function(){this.resize(e,n,r,i)},null,{name:&quot;resize&quot;,args:arguments})).go();return s}}(jQuery),function(e){function r(t,n,r){var i;return n?(i=typeof n==&quot;string&quot;?e(n):e(n).clone(),i.append(t)):i=e(t),i.css(e.extend(r||{},{display:&quot;block&quot;,position:&quot;absolute&quot;})).hide(),e(&quot;body&quot;).append(i),i.attr(&quot;data-opacity&quot;,i.css(&quot;opacity&quot;)).css(&quot;opacity&quot;,0),i.show()}function i(e,t){var r={left:t.left+&quot;px&quot;,top:t.top+&quot;px&quot;},i=e.attr(&quot;data-opacity&quot;)||0,s=e.css(&quot;z-index&quot;);if(parseInt(s,10)===0||s===&quot;auto&quot;)r[&quot;z-index&quot;]=9999;e.css(r).addClass(&quot;mapster_tooltip&quot;),t.fadeDuration&amp;&amp;t.fadeDuration&gt;0?n.fader(e[0],0,i,t.fadeDuration):n.setOpacity(e[0],i)}function s(t,n,r,i,s,o){var u=r+&quot;.mapster-tooltip&quot;;if(e.inArray(n,t)&gt;=0)return i.unbind(u).bind(u,function(e){if(!s||s.call(this,e))i.unbind(&quot;.mapster-tooltip&quot;),o&amp;&amp;o.call(this)}),{object:i,event:u}}function o(e,t,r,s,o){var u,a={};return o=o||{},t?(u=n.areaCorners(t,r,s,e.outerWidth(!0),e.outerHeight(!0)),a.left=u[0],a.top=u[1]):(a.left=o.left,a.top=o.top),a.left+=o.offsetx||0,a.top+=o.offsety||0,a.css=o.css,a.fadeDuration=o.fadeDuration,i(e,a),e}function u(e){return e?typeof e==&quot;string&quot;||e.jquery?e:e.content:null}var t=e.mapster,n=t.utils;e.extend(t.defaults,{toolTipContainer:'',showToolTip:!1,toolTipFade:!0,toolTipClose:[&quot;area-mouseout&quot;,&quot;image-mouseout&quot;],onShowToolTip:null,onHideToolTip:null}),e.extend(t.area_defaults,{toolTip:null,toolTipClose:null}),t.MapData.prototype.clearToolTip=function(){this.activeToolTip&amp;&amp;(this.activeToolTip.stop().remove(),this.activeToolTip=null,this.activeToolTipID=null,n.ifFunction(this.options.onHideToolTip,this))},t.AreaData.prototype.showToolTip=function(t,i){var u,a,f,l,c,h={},p=this,d=p.owner,v=p.effectiveOptions();i=i?e.extend({},i):{},t=t||v.toolTip,a=i.closeEvents||v.toolTipClose||d.options.toolTipClose||&quot;tooltip-click&quot;,c=typeof i.template!=&quot;undefined&quot;?i.template:d.options.toolTipContainer,i.closeEvents=typeof a==&quot;string&quot;?a=n.split(a):a,i.fadeDuration=i.fadeDuration||(d.options.toolTipFade?d.options.fadeDuration||v.fadeDuration:0),f=p.area?p.area:e.map(p.areas(),function(e){return e.area});if(d.activeToolTipID===p.areaId)return;return d.clearToolTip(),d.activeToolTip=u=r(t,c,i.css),d.activeToolTipID=p.areaId,l=function(){d.clearToolTip()},s(a,&quot;area-click&quot;,&quot;click&quot;,e(d.map),null,l),s(a,&quot;tooltip-click&quot;,&quot;click&quot;,u,null,l),s(a,&quot;image-mouseout&quot;,&quot;mouseout&quot;,e(d.image),function(e){return e.relatedTarget&amp;&amp;e.relatedTarget.nodeName!==&quot;AREA&quot;&amp;&amp;e.relatedTarget!==p.area},l),o(u,f,d.image,i.container,c,i),n.ifFunction(d.options.onShowToolTip,p.area,{toolTip:u,options:h,areaOptions:v,key:p.key,selected:p.isSelected()}),u},t.impl.tooltip=function(n,i){return(new t.Method(this,function(){var a,f,l=this;if(!n)l.clearToolTip();else{f=e(n);if(l.activeToolTipID===f[0])return;l.clearToolTip(),l.activeToolTip=a=r(u(i),i.template||l.options.toolTipContainer,i.css),l.activeToolTipID=f[0],s([&quot;tooltip-click&quot;],&quot;tooltip-click&quot;,&quot;click&quot;,a,null,function(){l.clearToolTip()}),l.activeToolTip=a=o(a,f,l.image,i.container,i)}},function(){e.isPlainObject(n)&amp;&amp;!i&amp;&amp;(i=n),this.showToolTip(u(i),i)},{name:&quot;tooltip&quot;,args:arguments,key:n})).go()}}(jQuery);</I></S><DIV class="printfooter">
Retrieved from &quot;<A href="http://2014.igem.org/Team:ETH_Zurich/js/imagemapster.js">http://2014.igem.org/Team:ETH_Zurich/js/imagemapster.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:ETH_Zurich/js/imagemapster.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:ETH_Zurich/js/imagemapster.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:ETH_Zurich/js/imagemapster.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:ETH_Zurich/js/imagemapster.js&amp;oldid=145406" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2014.igem.org:Privacy_policy" title="2014.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2014.igem.org:General_disclaimer" title="2014.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>