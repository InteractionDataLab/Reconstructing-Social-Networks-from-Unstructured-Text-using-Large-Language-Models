<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Valencia_UPV_javascript_slider"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Valencia_UPV/javascript_slider">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Valencia_UPV/javascript_slider&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Valencia_UPV/javascript_slider&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Valencia_UPV/javascript_slider&amp;action=history">History               </A></LI><LI style="color:white;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Valencia_UPV/javascript_slider" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Valencia UPV/javascript slider</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2014.igem.org</H3><P>/// &lt;reference path=&quot;Jssor.Core.js&quot; /&gt;
/// &lt;reference path=&quot;Jssor.Utils.js&quot; /&gt;</P><P>/*
</P><UL><LI> Jssor.Slider 17.0
</LI><LI><A href="http://www.jssor.com/" class="external free" rel="nofollow">http://www.jssor.com/</A></LI><LI> TERMS OF USE - Jssor.Slider
</LI><LI> Copyright 2014 Jssor
</LI><LI> Permission is hereby granted, free of charge, to any person obtaining
</LI><LI> a copy of this software and associated documentation files (the
</LI><LI> &quot;Software&quot;), to deal in the Software without restriction, including
</LI><LI> without limitation the rights to use, copy, modify, merge, publish,
</LI><LI> distribute, sublicense, and/or sell copies of the Software, and to
</LI><LI> permit persons to whom the Software is furnished to do so, subject to
</LI><LI> the following conditions:
</LI><LI>The above copyright notice and this permission notice shall be
</LI><LI> included in all copies or substantial portions of the Software.
</LI><LI> THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
</LI><LI> EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
</LI><LI> MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
</LI><LI> NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
</LI><LI> LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
</LI><LI> OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
</LI><LI> WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</LI><LI>/
</LI></UL><P>var $JssorSlider$;
var $JssorSlideshowFormations$ = window.$JssorSlideshowFormations$ = {};
var $JssorSlideshowRunner$;
</P><P>new function () {
</P><PRE>   //Constants +++++++
</PRE><PRE>   var COLUMN_INCREASE = 0;
   var COLUMN_DECREASE = 1;
   var ROW_INCREASE = 2;
   var ROW_DECREASE = 3;
</PRE><PRE>   var DIRECTION_HORIZONTAL = 0x0003;
   var DIRECTION_VERTICAL = 0x000C;
</PRE><PRE>   var TO_LEFT = 0x0001;
   var TO_RIGHT = 0x0002;
   var TO_TOP = 0x0004;
   var TO_BOTTOM = 0x0008;
</PRE><PRE>   var FROM_LEFT = 0x0100;
   var FROM_TOP = 0x0200;
   var FROM_RIGHT = 0x0400;
   var FROM_BOTTOM = 0x0800;
</PRE><PRE>   var ASSEMBLY_BOTTOM_LEFT = FROM_BOTTOM + TO_LEFT;
   var ASSEMBLY_BOTTOM_RIGHT = FROM_BOTTOM + TO_RIGHT;
   var ASSEMBLY_TOP_LEFT = FROM_TOP + TO_LEFT;
   var ASSEMBLY_TOP_RIGHT = FROM_TOP + TO_RIGHT;
   var ASSEMBLY_LEFT_TOP = FROM_LEFT + TO_TOP;
   var ASSEMBLY_LEFT_BOTTOM = FROM_LEFT + TO_BOTTOM;
   var ASSEMBLY_RIGHT_TOP = FROM_RIGHT + TO_TOP;
   var ASSEMBLY_RIGHT_BOTTOM = FROM_RIGHT + TO_BOTTOM;
</PRE><PRE>   //Constants -------
</PRE><PRE>   //Formation Definition +++++++
   function isToLeft(roadValue) {
       return (roadValue &amp; TO_LEFT) == TO_LEFT;
   }
</PRE><PRE>   function isToRight(roadValue) {
       return (roadValue &amp; TO_RIGHT) == TO_RIGHT;
   }
</PRE><PRE>   function isToTop(roadValue) {
       return (roadValue &amp; TO_TOP) == TO_TOP;
   }
</PRE><PRE>   function isToBottom(roadValue) {
       return (roadValue &amp; TO_BOTTOM) == TO_BOTTOM;
   }
</PRE><PRE>   function PushFormationOrder(arr, order, formationItem) {
       formationItem.push(order);
       arr[order] = arr[order] || [];
       arr[order].push(formationItem);
   }
</PRE><PRE>   $JssorSlideshowFormations$.$FormationStraight = function (transition) {
       var cols = transition.$Cols;
       var rows = transition.$Rows;
       var formationDirection = transition.$Assembly;
       var count = transition.$Count;
       var a = [];
       var i = 0;
       var col = 0;
       var r = 0;
       var cl = cols - 1;
       var rl = rows - 1;
       var il = count - 1;
       var cr;
       var order;
       for (r = 0; r &lt; rows; r++) {
           for (col = 0; col &lt; cols; col++) {
               cr = r + ',' + col;
               switch (formationDirection) {
                   case ASSEMBLY_BOTTOM_LEFT:
                       order = il - (col * rows + (rl - r));
                       break;
                   case ASSEMBLY_RIGHT_TOP:
                       order = il - (r * cols + (cl - col));
                       break;
                   case ASSEMBLY_TOP_LEFT:
                       order = il - (col * rows + r);
                   case ASSEMBLY_LEFT_TOP:
                       order = il - (r * cols + col);
                       break;
                   case ASSEMBLY_BOTTOM_RIGHT:
                       order = col * rows + r;
                       break;
                   case ASSEMBLY_LEFT_BOTTOM:
                       order = r * cols + (cl - col);
                       break;
                   case ASSEMBLY_TOP_RIGHT:
                       order = col * rows + (rl - r);
                       break;
                   default:
                       order = r * cols + col;
                       break; //ASSEMBLY_RIGHT_BOTTOM
               }
               PushFormationOrder(a, order, [r, col]);
           }
       }
</PRE><PRE>       return a;
   };
</PRE><PRE>   $JssorSlideshowFormations$.$FormationSwirl = function (transition) {
       var cols = transition.$Cols;
       var rows = transition.$Rows;
       var formationDirection = transition.$Assembly;
       var count = transition.$Count;
       var a = [];
       var hit = [];
       var i = 0;
       var col = 0;
       var r = 0;
       var cl = cols - 1;
       var rl = rows - 1;
       var il = count - 1;
       var cr;
       var courses;
       var course = 0;
       switch (formationDirection) {
           case ASSEMBLY_BOTTOM_LEFT:
               col = cl;
               r = 0;
               courses = [ROW_INCREASE, COLUMN_DECREASE, ROW_DECREASE, COLUMN_INCREASE];
               break;
           case ASSEMBLY_RIGHT_TOP:
               col = 0;
               r = rl;
               courses = [COLUMN_INCREASE, ROW_DECREASE, COLUMN_DECREASE, ROW_INCREASE];
               break;
           case ASSEMBLY_TOP_LEFT:
               col = cl;
               r = rl;
               courses = [ROW_DECREASE, COLUMN_DECREASE, ROW_INCREASE, COLUMN_INCREASE];
               break;
           case ASSEMBLY_LEFT_TOP:
               col = cl;
               r = rl;
               courses = [COLUMN_DECREASE, ROW_DECREASE, COLUMN_INCREASE, ROW_INCREASE];
               break;
           case ASSEMBLY_BOTTOM_RIGHT:
               col = 0;
               r = 0;
               courses = [ROW_INCREASE, COLUMN_INCREASE, ROW_DECREASE, COLUMN_DECREASE];
               break;
           case ASSEMBLY_LEFT_BOTTOM:
               col = cl;
               r = 0;
               courses = [COLUMN_DECREASE, ROW_INCREASE, COLUMN_INCREASE, ROW_DECREASE];
               break;
           case ASSEMBLY_TOP_RIGHT:
               col = 0;
               r = rl;
               courses = [ROW_DECREASE, COLUMN_INCREASE, ROW_INCREASE, COLUMN_DECREASE];
               break;
           default:
               col = 0;
               r = 0;
               courses = [COLUMN_INCREASE, ROW_INCREASE, COLUMN_DECREASE, ROW_DECREASE];
               break; //ASSEMBLY_RIGHT_BOTTOM
       }
       i = 0;
       while (i &lt; count) {
           cr = r + ',' + col;
           if (col &gt;= 0 &amp;&amp; col &lt; cols &amp;&amp; r &gt;= 0 &amp;&amp; r &lt; rows &amp;&amp; !hit[cr]) {
               //a[cr] = i++;
               hit[cr] = true;
               PushFormationOrder(a, i++, [r, col]);
           }
           else {
               switch (courses[course++ % courses.length]) {
                   case COLUMN_INCREASE:
                       col--;
                       break;
                   case ROW_INCREASE:
                       r--;
                       break;
                   case COLUMN_DECREASE:
                       col++;
                       break;
                   case ROW_DECREASE:
                       r++;
                       break;
               }
           }
</PRE><PRE>           switch (courses[course % courses.length]) {
               case COLUMN_INCREASE:
                   col++;
                   break;
               case ROW_INCREASE:
                   r++;
                   break;
               case COLUMN_DECREASE:
                   col--;
                   break;
               case ROW_DECREASE:
                   r--;
                   break;
           }
       }
       return a;
   };
</PRE><PRE>   $JssorSlideshowFormations$.$FormationZigZag = function (transition) {
       var cols = transition.$Cols;
       var rows = transition.$Rows;
       var formationDirection = transition.$Assembly;
       var count = transition.$Count;
       var a = [];
       var i = 0;
       var col = 0;
       var r = 0;
       var cl = cols - 1;
       var rl = rows - 1;
       var il = count - 1;
       var cr;
       var courses;
       var course = 0;
       switch (formationDirection) {
           case ASSEMBLY_BOTTOM_LEFT:
               col = cl;
               r = 0;
               courses = [ROW_INCREASE, COLUMN_DECREASE, ROW_DECREASE, COLUMN_DECREASE];
               break;
           case ASSEMBLY_RIGHT_TOP:
               col = 0;
               r = rl;
               courses = [COLUMN_INCREASE, ROW_DECREASE, COLUMN_DECREASE, ROW_DECREASE];
               break;
           case ASSEMBLY_TOP_LEFT:
               col = cl;
               r = rl;
               courses = [ROW_DECREASE, COLUMN_DECREASE, ROW_INCREASE, COLUMN_DECREASE];
               break;
           case ASSEMBLY_LEFT_TOP:
               col = cl;
               r = rl;
               courses = [COLUMN_DECREASE, ROW_DECREASE, COLUMN_INCREASE, ROW_DECREASE];
               break;
           case ASSEMBLY_BOTTOM_RIGHT:
               col = 0;
               r = 0;
               courses = [ROW_INCREASE, COLUMN_INCREASE, ROW_DECREASE, COLUMN_INCREASE];
               break;
           case ASSEMBLY_LEFT_BOTTOM:
               col = cl;
               r = 0;
               courses = [COLUMN_DECREASE, ROW_INCREASE, COLUMN_INCREASE, ROW_INCREASE];
               break;
           case ASSEMBLY_TOP_RIGHT:
               col = 0;
               r = rl;
               courses = [ROW_DECREASE, COLUMN_INCREASE, ROW_INCREASE, COLUMN_INCREASE];
               break;
           default:
               col = 0;
               r = 0;
               courses = [COLUMN_INCREASE, ROW_INCREASE, COLUMN_DECREASE, ROW_INCREASE];
               break; //ASSEMBLY_RIGHT_BOTTOM
       }
       i = 0;
       while (i &lt; count) {
           cr = r + ',' + col;
           if (col &gt;= 0 &amp;&amp; col &lt; cols &amp;&amp; r &gt;= 0 &amp;&amp; r &lt; rows &amp;&amp; typeof (a[cr]) == 'undefined') {
               PushFormationOrder(a, i++, [r, col]);
               //a[cr] = i++;
               switch (courses[course % courses.length]) {
                   case COLUMN_INCREASE:
                       col++;
                       break;
                   case ROW_INCREASE:
                       r++;
                       break;
                   case COLUMN_DECREASE:
                       col--;
                       break;
                   case ROW_DECREASE:
                       r--;
                       break;
               }
           }
           else {
               switch (courses[course++ % courses.length]) {
                   case COLUMN_INCREASE:
                       col--;
                       break;
                   case ROW_INCREASE:
                       r--;
                       break;
                   case COLUMN_DECREASE:
                       col++;
                       break;
                   case ROW_DECREASE:
                       r++;
                       break;
               }
               switch (courses[course++ % courses.length]) {
                   case COLUMN_INCREASE:
                       col++;
                       break;
                   case ROW_INCREASE:
                       r++;
                       break;
                   case COLUMN_DECREASE:
                       col--;
                       break;
                   case ROW_DECREASE:
                       r--;
                       break;
               }
           }
       }
       return a;
   };
</PRE><PRE>   $JssorSlideshowFormations$.$FormationStraightStairs = function (transition) {
       var cols = transition.$Cols;
       var rows = transition.$Rows;
       var formationDirection = transition.$Assembly;
       var count = transition.$Count;
       var a = [];
       var i = 0;
       var col = 0;
       var r = 0;
       var cl = cols - 1;
       var rl = rows - 1;
       var il = count - 1;
       var cr;
       switch (formationDirection) {
           case ASSEMBLY_BOTTOM_LEFT:
           case ASSEMBLY_TOP_RIGHT:
           case ASSEMBLY_TOP_LEFT:
           case ASSEMBLY_BOTTOM_RIGHT:
               var C = 0;
               var R = 0;
               break;
           case ASSEMBLY_LEFT_BOTTOM:
           case ASSEMBLY_RIGHT_TOP:
           case ASSEMBLY_LEFT_TOP:
           case ASSEMBLY_RIGHT_BOTTOM:
               var C = cl;
               var R = 0;
               break;
           default:
               formationDirection = ASSEMBLY_RIGHT_BOTTOM;
               var C = cl;
               var R = 0;
               break;
       }
       col = C;
       r = R;
       while (i &lt; count) {
           cr = r + ',' + col;
           if (isToTop(formationDirection) || isToRight(formationDirection)) {
               PushFormationOrder(a, il - i++, [r, col]);
               //a[cr] = il - i++;
           }
           else {
               PushFormationOrder(a, i++, [r, col]);
               //a[cr] = i++;
           }
           switch (formationDirection) {
               case ASSEMBLY_BOTTOM_LEFT:
               case ASSEMBLY_TOP_RIGHT:
                   col--;
                   r++;
                   break;
               case ASSEMBLY_TOP_LEFT:
               case ASSEMBLY_BOTTOM_RIGHT:
                   col++;
                   r--;
                   break;
               case ASSEMBLY_LEFT_BOTTOM:
               case ASSEMBLY_RIGHT_TOP:
                   col--;
                   r--;
                   break;
               case ASSEMBLY_RIGHT_BOTTOM:
               case ASSEMBLY_LEFT_TOP:
               default:
                   col++;
                   r++;
                   break;
           }
           if (col &lt; 0 || r &lt; 0 || col &gt; cl || r &gt; rl) {
               switch (formationDirection) {
                   case ASSEMBLY_BOTTOM_LEFT:
                   case ASSEMBLY_TOP_RIGHT:
                       C++;
                       break;
                   case ASSEMBLY_LEFT_BOTTOM:
                   case ASSEMBLY_RIGHT_TOP:
                   case ASSEMBLY_TOP_LEFT:
                   case ASSEMBLY_BOTTOM_RIGHT:
                       R++;
                       break;
                   case ASSEMBLY_RIGHT_BOTTOM:
                   case ASSEMBLY_LEFT_TOP:
                   default:
                       C--;
                       break;
               }
               if (C &lt; 0 || R &lt; 0 || C &gt; cl || R &gt; rl) {
                   switch (formationDirection) {
                       case ASSEMBLY_BOTTOM_LEFT:
                       case ASSEMBLY_TOP_RIGHT:
                           C = cl;
                           R++;
                           break;
                       case ASSEMBLY_TOP_LEFT:
                       case ASSEMBLY_BOTTOM_RIGHT:
                           R = rl;
                           C++;
                           break;
                       case ASSEMBLY_LEFT_BOTTOM:
                       case ASSEMBLY_RIGHT_TOP: R = rl; C--;
                           break;
                       case ASSEMBLY_RIGHT_BOTTOM:
                       case ASSEMBLY_LEFT_TOP:
                       default:
                           C = 0;
                           R++;
                           break;
                   }
                   if (R &gt; rl)
                       R = rl;
                   else if (R &lt; 0)
                       R = 0;
                   else if (C &gt; cl)
                       C = cl;
                   else if (C &lt; 0)
                       C = 0;
               }
               r = R;
               col = C;
           }
       }
       return a;
   };
</PRE><PRE>   $JssorSlideshowFormations$.$FormationSquare = function (transition) {
       var cols = transition.$Cols || 1;
       var rows = transition.$Rows || 1;
       var arr = [];
       var i = 0;
       var col;
       var r;
       var dc;
       var dr;
       var cr;
       dc = cols &lt; rows ? (rows - cols) / 2 : 0;
       dr = cols &gt; rows ? (cols - rows) / 2 : 0;
       cr = Math.round(Math.max(cols / 2, rows / 2)) + 1;
       for (col = 0; col &lt; cols; col++) {
           for (r = 0; r &lt; rows; r++)
               PushFormationOrder(arr, cr - Math.min(col + 1 + dc, r + 1 + dr, cols - col + dc, rows - r + dr), [r, col]);
       }
       return arr;
   };
</PRE><PRE>   $JssorSlideshowFormations$.$FormationRectangle = function (transition) {
       var cols = transition.$Cols || 1;
       var rows = transition.$Rows || 1;
       var arr = [];
       var i = 0;
       var col;
       var r;
       var cr;
       cr = Math.round(Math.min(cols / 2, rows / 2)) + 1;
       for (col = 0; col &lt; cols; col++) {
           for (r = 0; r &lt; rows; r++)
               PushFormationOrder(arr, cr - Math.min(col + 1, r + 1, cols - col, rows - r), [r, col]);
       }
       return arr;
   };
</PRE><PRE>   $JssorSlideshowFormations$.$FormationRandom = function (transition) {
       var a = [];
       var r, col, i;
       for (r = 0; r &lt; transition.$Rows; r++) {
           for (col = 0; col &lt; transition.$Cols; col++)
               PushFormationOrder(a, Math.ceil(100000 * Math.random()) % 13, [r, col]);
       }
</PRE><PRE>       return a;
   };
</PRE><PRE>   $JssorSlideshowFormations$.$FormationCircle = function (transition) {
       var cols = transition.$Cols || 1;
       var rows = transition.$Rows || 1;
       var arr = [];
       var i = 0;
       var col;
       var r;
       var hc = cols / 2 - 0.5;
       var hr = rows / 2 - 0.5;
       for (col = 0; col &lt; cols; col++) {
           for (r = 0; r &lt; rows; r++)
               PushFormationOrder(arr, Math.round(Math.sqrt(Math.pow(col - hc, 2) + Math.pow(r - hr, 2))), [r, col]);
       }
       return arr;
   };
</PRE><PRE>   $JssorSlideshowFormations$.$FormationCross = function (transition) {
       var cols = transition.$Cols || 1;
       var rows = transition.$Rows || 1;
       var arr = [];
       var i = 0;
       var col;
       var r;
       var hc = cols / 2 - 0.5;
       var hr = rows / 2 - 0.5;
       for (col = 0; col &lt; cols; col++) {
           for (r = 0; r &lt; rows; r++)
               PushFormationOrder(arr, Math.round(Math.min(Math.abs(col - hc), Math.abs(r - hr))), [r, col]);
       }
       return arr;
   };
</PRE><PRE>   $JssorSlideshowFormations$.$FormationRectangleCross = function (transition) {
       var cols = transition.$Cols || 1;
       var rows = transition.$Rows || 1;
       var arr = [];
       var i = 0;
       var col;
       var r;
       var hc = cols / 2 - 0.5;
       var hr = rows / 2 - 0.5;
       var cr = Math.max(hc, hr) + 1;
       for (col = 0; col &lt; cols; col++) {
           for (r = 0; r &lt; rows; r++)
               PushFormationOrder(arr, Math.round(cr - Math.max(hc - Math.abs(col - hc), hr - Math.abs(r - hr))) - 1, [r, col]);
       }
       return arr;
   };
</PRE><PRE>   function GetFormation(transition) {
</PRE><PRE>       var formationInstance = transition.$Formation(transition);
</PRE><PRE>       return transition.$Reverse ? formationInstance.reverse() : formationInstance;
</PRE><PRE>   } //GetFormation
</PRE><PRE>   //var _PrototypeTransitions = [];
   function EnsureTransitionInstance(options, slideshowInterval) {
</PRE><PRE>       var _SlideshowTransition = {
           $Interval: slideshowInterval,  //Delay to play next frame
           $Duration: 1, //Duration to finish the entire transition
           $Delay: 0,  //Delay to assembly blocks
           $Cols: 1,   //Number of columns
           $Rows: 1,   //Number of rows
           $Opacity: 0,   //Fade block or not
           $Zoom: 0,   //Zoom block or not
           $Clip: 0,   //Clip block or not
           $Move: false,   //Move block or not
           $SlideOut: false,   //Slide the previous slide out to display next slide instead
           $FlyDirection: 0,   //Specify fly transform with direction
           $Reverse: false,    //Reverse the assembly or not
           $Formation: $JssorSlideshowFormations$.$FormationRandom,    //Shape that assembly blocks as
           $Assembly: ASSEMBLY_RIGHT_BOTTOM,   //The way to assembly blocks
           $ChessMode: { $Column: 0, $Row: 0 },    //Chess move or fly direction
           $Easing: $JssorEasing$.$EaseSwing,  //Specify variation of speed during transition
           $Round: {},
           $Blocks: [],
           $During: {}
       };
</PRE><PRE>       $JssorUtils$.$Extend(_SlideshowTransition, options);
</PRE><PRE>   _SlideshowTransition.$Count = _SlideshowTransition.$Cols * _SlideshowTransition.$Rows;
       if ($JssorUtils$.$IsFunction(_SlideshowTransition.$Easing))
           _SlideshowTransition.$Easing = { $Default: _SlideshowTransition.$Easing };
</PRE><PRE>       _SlideshowTransition.$FramesCount = Math.ceil(_SlideshowTransition.$Duration / _SlideshowTransition.$Interval);
       _SlideshowTransition.$EasingInstance = GetEasing(_SlideshowTransition);
</PRE><PRE>       _SlideshowTransition.$GetBlocks = function (width, height) {
           width /= _SlideshowTransition.$Cols;
           height /= _SlideshowTransition.$Rows;
           var wh = width + 'x' + height;
           if (!_SlideshowTransition.$Blocks[wh]) {
               _SlideshowTransition.$Blocks[wh] = { $Width: width, $Height: height };
               for (var col = 0; col &lt; _SlideshowTransition.$Cols; col++) {
                   for (var r = 0; r &lt; _SlideshowTransition.$Rows; r++)
                       _SlideshowTransition.$Blocks[wh][r + ',' + col] = { $Top: r * height, $Right: col * width + width, $Bottom: r * height + height, $Left: col * width };
               }
           }
</PRE><PRE>           return _SlideshowTransition.$Blocks[wh];
       };
</PRE><PRE>       if (_SlideshowTransition.$Brother) {
           _SlideshowTransition.$Brother = EnsureTransitionInstance(_SlideshowTransition.$Brother, slideshowInterval);
           _SlideshowTransition.$SlideOut = true;
       }
</PRE><PRE>       return _SlideshowTransition;
   }
</PRE><PRE>   function GetEasing(transition) {
       var easing = transition.$Easing;
       if (!easing.$Default)
           easing.$Default = $JssorEasing$.$EaseSwing;
</PRE><PRE>       var duration = transition.$FramesCount;
</PRE><PRE>       var cache = easing.$Cache;
       if (!cache) {
           var enumerator = $JssorUtils$.$Extend({}, transition.$Easing, transition.$Round);
           cache = easing.$Cache = {};
</PRE><PRE>           $JssorUtils$.$Each(enumerator, function (v, easingName) {
               var easingFunction = easing[easingName] || easing.$Default;
               var round = transition.$Round[easingName] || 1;
</PRE><PRE>               if (!$JssorUtils$.$IsArray(easingFunction.$Cache))
                   easingFunction.$Cache = [];
</PRE><PRE>               var easingFunctionCache = easingFunction.$Cache[duration] = easingFunction.$Cache[duration] || [];
</PRE><PRE>               if (!easingFunctionCache[round]) {
                   easingFunctionCache[round] = [0];
                   for (var t = 1; t &lt;= duration; t++) {
                       var tRound = t / duration * round;
                       var tRoundFloor = Math.floor(tRound);
                       if (tRound != tRoundFloor)
                           tRound -= tRoundFloor;
                       easingFunctionCache[round][t] = easingFunction(tRound);
                   }
               }
</PRE><PRE>               cache[easingName] = easingFunctionCache;
</PRE><PRE>           });
       }
</PRE><PRE>       return cache;
   } //GetEasing
</PRE><PRE>   //Formation Definition -------
</PRE><PRE>   function JssorSlideshowPlayer(slideContainer, slideElement, slideTransition, beginTime, slideContainerWidth, slideContainerHeight) {
       var _Self = this;
</PRE><PRE>       var _Block;
       var _StartStylesArr = {};
       var _AnimationStylesArrs = {};
       var _AnimationBlockItems = [];
       var _StyleStart;
       var _StyleEnd;
       var _StyleDif;
       var _ChessModeColumn = slideTransition.$ChessMode.$Column || 0;
       var _ChessModeRow = slideTransition.$ChessMode.$Row || 0;
</PRE><PRE>       var _Blocks = slideTransition.$GetBlocks(slideContainerWidth, slideContainerHeight);
       var _FormationInstance = GetFormation(slideTransition);
       var _MaxOrder = _FormationInstance.length - 1;
       var _Period = slideTransition.$Duration + slideTransition.$Delay * _MaxOrder;
       var _EndTime = beginTime + _Period;
</PRE><PRE>       var _SlideOut = slideTransition.$SlideOut;
       var _IsIn;
</PRE><PRE>       _EndTime += $JssorUtils$.$IsBrowserChrome() ? 260 : 50;
</PRE><PRE>       _Self.$EndTime = _EndTime;
</PRE><PRE>       _Self.$ShowFrame = function (time) {
           time -= beginTime;
</PRE><PRE>           var isIn = time &lt; _Period;
</PRE><PRE>           if (isIn || _IsIn) {
               _IsIn = isIn;
</PRE><PRE>               if (!_SlideOut)
                   time = _Period - time;
</PRE><PRE>               var frameIndex = Math.ceil(time / slideTransition.$Interval);
</PRE><PRE>               $JssorUtils$.$Each(_AnimationStylesArrs, function (value, index) {
</PRE><PRE>                   var itemFrameIndex = Math.max(frameIndex, value.$Min);
                   itemFrameIndex = Math.min(itemFrameIndex, value.length - 1);
</PRE><PRE>                   if (value.$LastFrameIndex != itemFrameIndex) {
                       if (!value.$LastFrameIndex &amp;&amp; !_SlideOut) {
                           $JssorUtils$.$ShowElement(_AnimationBlockItems[index]);
                       }
                       else if (itemFrameIndex == value.$Max &amp;&amp; _SlideOut) {
                           $JssorUtils$.$HideElement(_AnimationBlockItems[index]);
                       }
                       value.$LastFrameIndex = itemFrameIndex;
                       $JssorUtils$.$SetStylesEx(_AnimationBlockItems[index], value[itemFrameIndex]);
                   }
               });
           }
       };
</PRE><PRE>       function DisableHWA(elmt) {
           $JssorUtils$.$DisableHWA(elmt);
</PRE><PRE>           var children = $JssorUtils$.$GetChildren(elmt);
</PRE><PRE>           $JssorUtils$.$Each(children, function (child) {
               DisableHWA(child);
           });
       }
</PRE><PRE>       //constructor
       {
           slideElement = $JssorUtils$.$CloneNode(slideElement, true);
           DisableHWA(slideElement);
           if ($JssorUtils$.$IsBrowserIe9Earlier()) {
               var hasImage = !slideElement[&quot;no-image&quot;];
               var slideChildElements = $JssorUtils$.$FindChildrenByTag(slideElement, null, true);
               $JssorUtils$.$Each(slideChildElements, function (slideChildElement) {
                   if (hasImage || slideChildElement[&quot;jssor-slider&quot;])
                       $JssorUtils$.$CssOpacity(slideChildElement, $JssorUtils$.$CssOpacity(slideChildElement), true);
               });
           }
</PRE><PRE>           $JssorUtils$.$Each(_FormationInstance, function (formationItems, order) {
               $JssorUtils$.$Each(formationItems, function (formationItem) {
                   var row = formationItem[0];
                   var col = formationItem[1];
                   {
                       var columnRow = row + ',' + col;
</PRE><PRE>                       var chessHorizontal = false;
                       var chessVertical = false;
                       var chessRotate = false;
</PRE><PRE>                       if (_ChessModeColumn &amp;&amp; col % 2) {
                           if ($JssorDirection$.$IsHorizontal(_ChessModeColumn)) {
                               chessHorizontal = !chessHorizontal;
                           }
                           if ($JssorDirection$.$IsVertical(_ChessModeColumn)) {
                               chessVertical = !chessVertical;
                           }
</PRE><PRE>                           if (_ChessModeColumn &amp; 16)
                               chessRotate = !chessRotate;
                       }
</PRE><PRE>                       if (_ChessModeRow &amp;&amp; row % 2) {
                           if ($JssorDirection$.$IsHorizontal(_ChessModeRow)) {
                               chessHorizontal = !chessHorizontal;
                           }
                           if ($JssorDirection$.$IsVertical(_ChessModeRow)) {
                               chessVertical = !chessVertical;
                           }
                           if (_ChessModeRow &amp; 16)
                               chessRotate = !chessRotate;
                       }
</PRE><PRE>                       slideTransition.$Top = slideTransition.$Top || (slideTransition.$Clip &amp; 4);
                       slideTransition.$Bottom = slideTransition.$Bottom || (slideTransition.$Clip &amp; 8);
                       slideTransition.$Left = slideTransition.$Left || (slideTransition.$Clip &amp; 1);
                       slideTransition.$Right = slideTransition.$Right || (slideTransition.$Clip &amp; 2);
</PRE><PRE>                       var topBenchmark = chessVertical ? slideTransition.$Bottom : slideTransition.$Top;
                       var bottomBenchmark = chessVertical ? slideTransition.$Top : slideTransition.$Bottom;
                       var leftBenchmark = chessHorizontal ? slideTransition.$Right : slideTransition.$Left;
                       var rightBenchmark = chessHorizontal ? slideTransition.$Left : slideTransition.$Right;
</PRE><PRE>                       //$JssorDebug$.$Execute(function () {
                       //    topBenchmark = bottomBenchmark = leftBenchmark = rightBenchmark = false;
                       //});
</PRE><PRE>                       slideTransition.$Clip = topBenchmark || bottomBenchmark || leftBenchmark || rightBenchmark;
</PRE><PRE>                       _StyleDif = {};
                       _StyleEnd = { $Top: 0, $Left: 0, $Opacity: 1, $Width: slideContainerWidth, $Height: slideContainerHeight };
                       _StyleStart = $JssorUtils$.$Extend({}, _StyleEnd);
                       _Block = $JssorUtils$.$Extend({}, _Blocks[columnRow]);
</PRE><PRE>                       if (slideTransition.$Opacity) {
                           _StyleEnd.$Opacity = 2 - slideTransition.$Opacity;
                       }
</PRE><PRE>                       if (slideTransition.$ZIndex) {
                           _StyleEnd.$ZIndex = slideTransition.$ZIndex;
                           _StyleStart.$ZIndex = 0;
                       }
</PRE><PRE>                       var allowClip = slideTransition.$Cols * slideTransition.$Rows &gt; 1 || slideTransition.$Clip;
</PRE><PRE>                       if (slideTransition.$Zoom || slideTransition.$Rotate) {
                           var allowRotate = true;
                           if ($JssorUtils$.$IsBrowserIE() &amp;&amp; $JssorUtils$.$GetBrowserEngineVersion() &lt; 9) {
                               if (slideTransition.$Cols * slideTransition.$Rows &gt; 1)
                                   allowRotate = false;
                               else
                                   allowClip = false;
                           }
</PRE><PRE>                           if (allowRotate) {
                               _StyleEnd.$Zoom = slideTransition.$Zoom ? slideTransition.$Zoom - 1 : 1;
                               _StyleStart.$Zoom = 1;
</PRE><PRE>                               if ($JssorUtils$.$IsBrowserIe9Earlier() || $JssorUtils$.$IsBrowserOpera())
                                   _StyleEnd.$Zoom = Math.min(_StyleEnd.$Zoom, 2);
</PRE><PRE>                               var rotate = slideTransition.$Rotate;
                               if (rotate == true)
                                   rotate = 1;
</PRE><PRE>                               _StyleEnd.$Rotate = rotate * 360 * ((chessRotate) ? -1 : 1);
                               _StyleStart.$Rotate = 0;
                           }
                       }
</PRE><PRE>                       if (allowClip) {
                           if (slideTransition.$Clip) {
                               var clipScale = slideTransition.$ScaleClip || 1;
                               var blockOffset = _Block.$Offset = {};
                               if (topBenchmark &amp;&amp; bottomBenchmark) {
                                   blockOffset.$Top = _Blocks.$Height / 2 * clipScale;
                                   blockOffset.$Bottom = -blockOffset.$Top;
                               }
                               else if (topBenchmark) {
                                   blockOffset.$Bottom = -_Blocks.$Height * clipScale;
                               }
                               else if (bottomBenchmark) {
                                   blockOffset.$Top = _Blocks.$Height * clipScale;
                               }
</PRE><PRE>                               if (leftBenchmark &amp;&amp; rightBenchmark) {
                                   blockOffset.$Left = _Blocks.$Width / 2 * clipScale;
                                   blockOffset.$Right = -blockOffset.$Left;
                               }
                               else if (leftBenchmark) {
                                   blockOffset.$Right = -_Blocks.$Width * clipScale;
                               }
                               else if (rightBenchmark) {
                                   blockOffset.$Left = _Blocks.$Width * clipScale;
                               }
                           }
</PRE><PRE>                           _StyleDif.$Clip = _Block;
                           _StyleStart.$Clip = _Blocks[columnRow];
                       }
</PRE><PRE>                       if (slideTransition.$FlyDirection) {
</PRE><PRE>                           var direction = slideTransition.$FlyDirection;
</PRE><PRE>                           if (!chessHorizontal)
                               direction = $JssorDirection$.$ChessHorizontal(direction);
</PRE><PRE>                           if (!chessVertical)
                               direction = $JssorDirection$.$ChessVertical(direction);
</PRE><PRE>                           var scaleHorizontal = slideTransition.$ScaleHorizontal || 1;
                           var scaleVertical = slideTransition.$ScaleVertical || 1;
</PRE><PRE>                           if ($JssorDirection$.$IsToLeft(direction)) {
                               _StyleEnd.$Left += slideContainerWidth * scaleHorizontal;
                           }
                           else if ($JssorDirection$.$IsToRight(direction)) {
                               _StyleEnd.$Left -= slideContainerWidth * scaleHorizontal;
                           }
                           if ($JssorDirection$.$IsToTop(direction)) {
                               _StyleEnd.$Top += slideContainerHeight * scaleVertical;
                           }
                           else if ($JssorDirection$.$IsToBottom(direction)) {
                               _StyleEnd.$Top -= slideContainerHeight * scaleVertical;
                           }
                       }
</PRE><PRE>                       $JssorUtils$.$Each(_StyleEnd, function (propertyEnd, property) {
                           if ($JssorUtils$.$IsNumeric(propertyEnd)) {
                               if (propertyEnd != _StyleStart[property]) {
                                   _StyleDif[property] = propertyEnd - _StyleStart[property];
                               }
                           }
                       });
</PRE><PRE>                       _StartStylesArr[columnRow] = _SlideOut ? _StyleStart : _StyleEnd;
</PRE><PRE>                       var animationStylesArr = [];
                       var virtualFrameCount = Math.round(order * slideTransition.$Delay / slideTransition.$Interval);
                       _AnimationStylesArrs[columnRow] = new Array(virtualFrameCount);
                       _AnimationStylesArrs[columnRow].$Min = virtualFrameCount;
</PRE><PRE>                       var framesCount = slideTransition.$FramesCount;
                       for (var frameN = 0; frameN &lt;= framesCount; frameN++) {
                           var styleFrameN = {};
</PRE><PRE>                           $JssorUtils$.$Each(_StyleDif, function (propertyDiff, property) {
                               var propertyEasings = slideTransition.$EasingInstance[property] || slideTransition.$EasingInstance.$Default;
                               var propertyEasingArray = propertyEasings[slideTransition.$Round[property] || 1];
</PRE><PRE>                               var propertyDuring = slideTransition.$During[property] || [0, 1];
                               var propertyFrameN = (frameN / framesCount - propertyDuring[0]) / propertyDuring[1] * framesCount;
                               propertyFrameN = Math.round(Math.min(framesCount, Math.max(propertyFrameN, 0)));
</PRE><PRE>                               var propertyEasingValue = propertyEasingArray[propertyFrameN];
</PRE><PRE>                               if ($JssorUtils$.$IsNumeric(propertyDiff)) {
                                   styleFrameN[property] = _StyleStart[property] + propertyDiff * propertyEasingValue;
                               }
                               else {
                                   var value = styleFrameN[property] = $JssorUtils$.$Extend({}, _StyleStart[property]);
                                   value.$Offset = [];
                                   $JssorUtils$.$Each(propertyDiff.$Offset, function (rectX, n) {
                                       var offsetValue = rectX * propertyEasingValue;
                                       value.$Offset[n] = offsetValue;
                                       value[n] += offsetValue;
                                   });
                               }
                           });
</PRE><PRE>                           if (_StyleStart.$Zoom) {
                               styleFrameN.$Transform = { $Rotate: styleFrameN.$Rotate || 0, $Scale: styleFrameN.$Zoom, $OriginalWidth: slideContainerWidth, $OriginalHeight: slideContainerHeight };
                           }
                           if (styleFrameN.$Clip &amp;&amp; slideTransition.$Move) {
                               var styleFrameNClipOffset = styleFrameN.$Clip.$Offset;
                               var offsetY = (styleFrameNClipOffset.$Top || 0) + (styleFrameNClipOffset.$Bottom || 0);
                               var offsetX = (styleFrameNClipOffset.$Left || 0) + (styleFrameNClipOffset.$Right || 0);
</PRE><PRE>                               styleFrameN.$Left = (styleFrameN.$Left || 0) + offsetX;
                               styleFrameN.$Top = (styleFrameN.$Top || 0) + offsetY;
                               styleFrameN.$Clip.$Left -= offsetX;
                               styleFrameN.$Clip.$Right -= offsetX;
                               styleFrameN.$Clip.$Top -= offsetY;
                               styleFrameN.$Clip.$Bottom -= offsetY;
                           }
</PRE><PRE>                           styleFrameN.$ZIndex = styleFrameN.$ZIndex || 1;
</PRE><PRE>                           _AnimationStylesArrs[columnRow].push(styleFrameN);
                       }
</PRE><PRE>                   } //for
               });
           });
</PRE><PRE>           _FormationInstance.reverse();
           $JssorUtils$.$Each(_FormationInstance, function (formationItems) {
               $JssorUtils$.$Each(formationItems, function (formationItem) {
                   var row = formationItem[0];
                   var col = formationItem[1];
</PRE><PRE>                   var columnRow = row + ',' + col;
</PRE><PRE>                   var image = slideElement;
                   if (col || row)
                       image = $JssorUtils$.$CloneNode(slideElement, true);
</PRE><PRE>                   $JssorUtils$.$SetStyles(image, _StartStylesArr[columnRow]);
                   $JssorUtils$.$CssOverflow(image, &quot;hidden&quot;);
</PRE><PRE>                   $JssorUtils$.$CssPosition(image, &quot;absolute&quot;);
                   slideContainer.$AddClipElement(image);
                   _AnimationBlockItems[columnRow] = image;
                   $JssorUtils$.$ShowElement(image, _SlideOut);
               });
           });
       }
   }
</PRE><PRE>   //JssorSlideshowRunner++++++++
   var _SlideshowRunnerCount = 1;
   $JssorSlideshowRunner$ = window.$JssorSlideshowRunner$ = function (slideContainer, slideContainerWidth, slideContainerHeight, slideshowOptions, handleTouchEventOnly) {
</PRE><PRE>       var _SelfSlideshowRunner = this;
</PRE><PRE>       //var _State = 0; //-1 fullfill, 0 clean, 1 initializing, 2 stay, 3 playing
       var _EndTime;
</PRE><PRE>       var _SliderFrameCount;
</PRE><PRE>       var _SlideshowPlayerBelow;
       var _SlideshowPlayerAbove;
</PRE><PRE>       var _PrevItem;
       var _SlideItem;
</PRE><PRE>       var _TransitionIndex = 0;
       var _TransitionsOrder = slideshowOptions.$TransitionsOrder;
</PRE><PRE>       var _SlideshowTransition;
</PRE><PRE>       var _SlideshowPerformance = 16;
</PRE><PRE>       function SlideshowProcessor() {
           var _SelfSlideshowProcessor = this;
           var _CurrentTime = 0;
</PRE><PRE>           $JssorAnimator$.call(_SelfSlideshowProcessor, 0, _EndTime);
</PRE><PRE>           _SelfSlideshowProcessor.$OnPositionChange = function (oldPosition, newPosition) {
               if ((newPosition - _CurrentTime) &gt; _SlideshowPerformance) {
                   _CurrentTime = newPosition;
</PRE><PRE>                   _SlideshowPlayerAbove &amp;&amp; _SlideshowPlayerAbove.$ShowFrame(newPosition);
                   _SlideshowPlayerBelow &amp;&amp; _SlideshowPlayerBelow.$ShowFrame(newPosition);
               }
           };
</PRE><PRE>           _SelfSlideshowProcessor.$Transition = _SlideshowTransition;
       }
</PRE><PRE>       //member functions
       _SelfSlideshowRunner.$GetTransition = function (slideCount) {
           var n = 0;
</PRE><PRE>           var transitions = slideshowOptions.$Transitions;
</PRE><PRE>           var transitionCount = transitions.length;
</PRE><PRE>           if (_TransitionsOrder) { /*Sequence*/
               if (transitionCount &gt; slideCount &amp;&amp; ($JssorUtils$.$IsBrowserChrome() || $JssorUtils$.$IsBrowserSafari() || $JssorUtils$.$IsBrowserFireFox())) {
                   transitionCount -= transitionCount % slideCount;
               }
               n = _TransitionIndex++ % transitionCount;
           }
           else { /*Random*/
               n = Math.floor(Math.random() * transitionCount);
           }
</PRE><PRE>           transitions[n] &amp;&amp; (transitions[n].$Index = n);
</PRE><PRE>           return transitions[n];
       };
</PRE><PRE>       _SelfSlideshowRunner.$Initialize = function (slideIndex, prevIndex, slideItem, prevItem, slideshowTransition) {
           $JssorDebug$.$Execute(function () {
               if (_SlideshowPlayerBelow) {
                   $JssorDebug$.$Fail(&quot;slideshow runner has not been cleared.&quot;);
               }
           });
</PRE><PRE>           _SlideshowTransition = slideshowTransition;
</PRE><PRE>           slideshowTransition = EnsureTransitionInstance(slideshowTransition, _SlideshowPerformance);
</PRE><PRE>           _SlideItem = slideItem;
           _PrevItem = prevItem;
</PRE><PRE>           var prevSlideElement = prevItem.$Item;
           var currentSlideElement = slideItem.$Item;
           prevSlideElement[&quot;no-image&quot;] = !prevItem.$Image;
           currentSlideElement[&quot;no-image&quot;] = !slideItem.$Image;
</PRE><PRE>           var slideElementAbove = prevSlideElement;
           var slideElementBelow = currentSlideElement;
</PRE><PRE>           var slideTransitionAbove = slideshowTransition;
           var slideTransitionBelow = slideshowTransition.$Brother || EnsureTransitionInstance({}, _SlideshowPerformance);
</PRE><PRE>           if (!slideshowTransition.$SlideOut) {
               slideElementAbove = currentSlideElement;
               slideElementBelow = prevSlideElement;
           }
</PRE><PRE>           var shift = slideTransitionBelow.$Shift || 0;
</PRE><PRE>           _SlideshowPlayerBelow = new JssorSlideshowPlayer(slideContainer, slideElementBelow, slideTransitionBelow, Math.max(shift - slideTransitionBelow.$Interval, 0), slideContainerWidth, slideContainerHeight);
           _SlideshowPlayerAbove = new JssorSlideshowPlayer(slideContainer, slideElementAbove, slideTransitionAbove, Math.max(slideTransitionBelow.$Interval - shift, 0), slideContainerWidth, slideContainerHeight);
</PRE><PRE>           _SlideshowPlayerBelow.$ShowFrame(0);
           _SlideshowPlayerAbove.$ShowFrame(0);
</PRE><PRE>           _EndTime = Math.max(_SlideshowPlayerBelow.$EndTime, _SlideshowPlayerAbove.$EndTime);
</PRE><PRE>           _SelfSlideshowRunner.$Index = slideIndex;
       };
</PRE><PRE>       _SelfSlideshowRunner.$Clear = function () {
           slideContainer.$Clear();
           _SlideshowPlayerBelow = null;
           _SlideshowPlayerAbove = null;
       };
</PRE><PRE>       _SelfSlideshowRunner.$GetProcessor = function () {
           var slideshowProcessor = null;
</PRE><PRE>           if (_SlideshowPlayerAbove)
               slideshowProcessor = new SlideshowProcessor();
</PRE><PRE>           return slideshowProcessor;
       };
</PRE><PRE>       //Constructor
       {
           if ($JssorUtils$.$IsBrowserIe9Earlier() || $JssorUtils$.$IsBrowserOpera() || (handleTouchEventOnly &amp;&amp; $JssorUtils$.$GetWebKitVersion &lt; 537)) {
               _SlideshowPerformance = 32;
           }
</PRE><PRE>           $JssorEventManager$.call(_SelfSlideshowRunner);
           $JssorAnimator$.call(_SelfSlideshowRunner, -10000000, 10000000);
</PRE><PRE>           $JssorDebug$.$LiveStamp(_SelfSlideshowRunner, &quot;slideshow_runner_&quot; + _SlideshowRunnerCount++);
       }
   };
   //JssorSlideshowRunner--------
</PRE><PRE>   //JssorSlider
   function JssorSlider(elmt, options) {
       var _SelfSlider = this;
</PRE><PRE>       //private classes
       function Conveyor() {
           var _SelfConveyor = this;
           $JssorAnimator$.call(_SelfConveyor, -100000000, 200000000);
</PRE><PRE>           _SelfConveyor.$GetCurrentSlideInfo = function () {
               var positionDisplay = _SelfConveyor.$GetPosition_Display();
               var virtualIndex = Math.floor(positionDisplay);
               var slideIndex = GetRealIndex(virtualIndex);
               var slidePosition = positionDisplay - Math.floor(positionDisplay);
</PRE><PRE>               return { $Index: slideIndex, $VirtualIndex: virtualIndex, $Position: slidePosition };
           };
</PRE><PRE>           _SelfConveyor.$OnPositionChange = function (oldPosition, newPosition) {
               var index = Math.floor(newPosition);
               if (index != newPosition &amp;&amp; newPosition &gt; oldPosition)
                   index++;
</PRE><PRE>               ResetNavigator(index, true);
</PRE><PRE>               _SelfSlider.$TriggerEvent(JssorSlider.$EVT_POSITION_CHANGE, GetRealIndex(newPosition), GetRealIndex(oldPosition), newPosition, oldPosition);
           };
       }
</PRE><PRE>       //Carousel
       function Carousel() {
           var _SelfCarousel = this;
</PRE><PRE>           $JssorAnimator$.call(_SelfCarousel, 0, 0, { $LoopLength: _SlideCount });
</PRE><PRE>           //Carousel Constructor
           {
               $JssorUtils$.$Each(_SlideItems, function (slideItem) {
                   (_Loop &amp; 1) &amp;&amp; slideItem.$SetLoopLength(_SlideCount);
                   _SelfCarousel.$Chain(slideItem);
                   slideItem.$Shift(_ParkingPosition / _StepLength);
               });
           }
       }
       //Carousel
</PRE><PRE>       //Slideshow
       function Slideshow() {
           var _SelfSlideshow = this;
           var _Wrapper = _SlideContainer.$Elmt;
</PRE><PRE>           $JssorAnimator$.call(_SelfSlideshow, -1, 2, { $Easing: $JssorEasing$.$EaseLinear, $Setter: { $Position: SetPosition }, $LoopLength: _SlideCount }, _Wrapper, { $Position: 1 }, { $Position: -1 });
</PRE><PRE>           _SelfSlideshow.$Wrapper = _Wrapper;
</PRE><PRE>           //Slideshow Constructor
           {
               $JssorDebug$.$Execute(function () {
                   $JssorUtils$.$SetAttribute(_SlideContainer.$Elmt, &quot;debug-id&quot;, &quot;slide_container&quot;);
               });
           }
       }
       //Slideshow
</PRE><PRE>       //CarouselPlayer
       function CarouselPlayer(carousel, slideshow) {
           var _SelfCarouselPlayer = this;
           var _FromPosition;
           var _ToPosition;
           var _Duration;
           var _StandBy;
           var _StandByPosition;
</PRE><PRE>           $JssorAnimator$.call(_SelfCarouselPlayer, -100000000, 200000000);
</PRE><PRE>           _SelfCarouselPlayer.$OnStart = function () {
               _IsSliding = true;
               _LoadingTicket = null;
</PRE><PRE>               //EVT_SWIPE_START
               _SelfSlider.$TriggerEvent(JssorSlider.$EVT_SWIPE_START, GetRealIndex(_Conveyor.$GetPosition()), _Conveyor.$GetPosition());
           };
</PRE><PRE>           _SelfCarouselPlayer.$OnStop = function () {
</PRE><PRE>               _IsSliding = false;
               _StandBy = false;
</PRE><PRE>               var currentSlideInfo = _Conveyor.$GetCurrentSlideInfo();
</PRE><PRE>               //EVT_SWIPE_END
               _SelfSlider.$TriggerEvent(JssorSlider.$EVT_SWIPE_END, GetRealIndex(_Conveyor.$GetPosition()), _Conveyor.$GetPosition());
</PRE><PRE>               if (!currentSlideInfo.$Position) {
                   OnPark(currentSlideInfo.$VirtualIndex, _CurrentSlideIndex);
               }
           };
</PRE><PRE>           _SelfCarouselPlayer.$OnPositionChange = function (oldPosition, newPosition) {
               var toPosition;
</PRE><PRE>               if (_StandBy)
                   toPosition = _StandByPosition;
               else {
                   toPosition = _ToPosition;
</PRE><PRE>                   if (_Duration)
                       toPosition = _Options.$SlideEasing(newPosition / _Duration) * (_ToPosition - _FromPosition) + _FromPosition;
               }
</PRE><PRE>               _Conveyor.$GoToPosition(toPosition);
           };
</PRE><PRE>           _SelfCarouselPlayer.$PlayCarousel = function (fromPosition, toPosition, duration, callback) {
               $JssorDebug$.$Execute(function () {
                   if (_SelfCarouselPlayer.$IsPlaying())
                       $JssorDebug$.$Fail(&quot;The carousel is already playing.&quot;);
               });
</PRE><PRE>               _FromPosition = fromPosition;
               _ToPosition = toPosition;
               _Duration = duration;
</PRE><PRE>               _Conveyor.$GoToPosition(fromPosition);
               _SelfCarouselPlayer.$GoToPosition(0);
</PRE><PRE>               _SelfCarouselPlayer.$PlayToPosition(duration, callback);
           };
</PRE><PRE>           _SelfCarouselPlayer.$StandBy = function (standByPosition) {
               _StandBy = true;
               _StandByPosition = standByPosition;
               _SelfCarouselPlayer.$Play(standByPosition, null, true);
           };
</PRE><PRE>           _SelfCarouselPlayer.$SetStandByPosition = function (standByPosition) {
               _StandByPosition = standByPosition;
           };
</PRE><PRE>           _SelfCarouselPlayer.$MoveCarouselTo = function (position) {
               _Conveyor.$GoToPosition(position);
           };
</PRE><PRE>           //CarouselPlayer Constructor
           {
               _Conveyor = new Conveyor();
</PRE><PRE>               _Conveyor.$Combine(carousel);
               _Conveyor.$Combine(slideshow);
           }
       }
       //CarouselPlayer
</PRE><PRE>       //SlideContainer
       function SlideContainer() {
           var _Self = this;
           var elmt = CreatePanel();
</PRE><PRE>           $JssorUtils$.$CssZIndex(elmt, 0);
</PRE><PRE>           _Self.$Elmt = elmt;
</PRE><PRE>           _Self.$AddClipElement = function (clipElement) {
               $JssorUtils$.$AppendChild(elmt, clipElement);
               $JssorUtils$.$ShowElement(elmt);
           };
</PRE><PRE>           _Self.$Clear = function () {
               $JssorUtils$.$HideElement(elmt);
               $JssorUtils$.$ClearInnerHtml(elmt);
           };
       }
       //SlideContainer
</PRE><PRE>       //SlideItem
       function SlideItem(slideElmt, slideIndex) {
</PRE><PRE>           var _SelfSlideItem = this;
</PRE><PRE>           var _CaptionSliderIn;
           var _CaptionSliderOut;
           var _CaptionSliderCurrent;
           var _IsCaptionSliderPlayingWhenDragStart;
</PRE><PRE>           var _Wrapper;
           var _BaseElement = slideElmt;
</PRE><PRE>           var _LoadingScreen;
</PRE><PRE>           var _ImageItem;
           var _ImageElmts = [];
           var _LinkItemOrigin;
           var _LinkItem;
           var _ImageLoading;
           var _ImageLoaded;
           var _ImageLazyLoading;
           var _ContentRefreshed;
</PRE><PRE>           var _Processor;
</PRE><PRE>           var _PlayerInstanceElement;
           var _PlayerInstance;
</PRE><PRE>           var _SequenceNumber;    //for debug only
</PRE><PRE>           $JssorAnimator$.call(_SelfSlideItem, -_DisplayPieces, _DisplayPieces + 1, { $SlideItemAnimator: true });
</PRE><PRE>           function ResetCaptionSlider(fresh) {
               _CaptionSliderOut &amp;&amp; _CaptionSliderOut.$Revert();
               _CaptionSliderIn &amp;&amp; _CaptionSliderIn.$Revert();
</PRE><PRE>               RefreshContent(slideElmt, fresh);
               _ContentRefreshed = true;
</PRE><PRE>               _CaptionSliderIn = new _CaptionSliderOptions.$Class(slideElmt, _CaptionSliderOptions, 1);
               $JssorDebug$.$LiveStamp(_CaptionSliderIn, &quot;caption_slider_&quot; + _CaptionSliderCount + &quot;_in&quot;);
               _CaptionSliderOut = new _CaptionSliderOptions.$Class(slideElmt, _CaptionSliderOptions);
               $JssorDebug$.$LiveStamp(_CaptionSliderOut, &quot;caption_slider_&quot; + _CaptionSliderCount + &quot;_out&quot;);
</PRE><PRE>               $JssorDebug$.$Execute(function () {
                   _CaptionSliderCount++;
               });
</PRE><PRE>               _CaptionSliderOut.$GoToBegin();
               _CaptionSliderIn.$GoToBegin();
           }
</PRE><PRE>           function EnsureCaptionSliderVersion() {
               if (_CaptionSliderIn.$Version &lt; _CaptionSliderOptions.$Version) {
                   ResetCaptionSlider();
               }
           }
</PRE><PRE>           //event handling begin
           function LoadImageCompleteEventHandler(completeCallback, loadingScreen, image) {
               if (!_ImageLoaded) {
                   _ImageLoaded = true;
</PRE><PRE>                   if (_ImageItem &amp;&amp; image) {
                       var imageWidth = image.width;
                       var imageHeight = image.height;
                       var fillWidth = imageWidth;
                       var fillHeight = imageHeight;
</PRE><PRE>                       if (imageWidth &amp;&amp; imageHeight &amp;&amp; _Options.$FillMode) {
</PRE><PRE>                           //0 stretch, 1 contain (keep aspect ratio and put all inside slide), 2 cover (keep aspect ratio and cover whole slide), 4 actual size, 5 contain for large image, actual size for small image, default value is 0
                           if (_Options.$FillMode &amp; 3 &amp;&amp; (!(_Options.$FillMode &amp; 4) || imageWidth &gt; _SlideWidth || imageHeight &gt; _SlideHeight)) {
                               var fitHeight = false;
                               var ratio = _SlideWidth / _SlideHeight * imageHeight / imageWidth;
</PRE><PRE>                               if (_Options.$FillMode &amp; 1) {
                                   fitHeight = (ratio &gt; 1);
                               }
                               else if (_Options.$FillMode &amp; 2) {
                                   fitHeight = (ratio &lt; 1);
                               }
                               fillWidth = fitHeight ? imageWidth * _SlideHeight / imageHeight : _SlideWidth;
                               fillHeight = fitHeight ? _SlideHeight : imageHeight * _SlideWidth / imageWidth;
                           }
</PRE><PRE>                           $JssorUtils$.$CssWidth(_ImageItem, fillWidth);
                           $JssorUtils$.$CssHeight(_ImageItem, fillHeight);
                           $JssorUtils$.$CssTop(_ImageItem, (_SlideHeight - fillHeight) / 2);
                           $JssorUtils$.$CssLeft(_ImageItem, (_SlideWidth - fillWidth) / 2);
                       }
</PRE><PRE>                       $JssorUtils$.$CssPosition(_ImageItem, &quot;absolute&quot;);
</PRE><PRE>                       _SelfSlider.$TriggerEvent(JssorSlider.$EVT_LOAD_END, slideItem);
                   }
               }
</PRE><PRE>$JssorUtils$.$HideElement(loadingScreen);
               completeCallback &amp;&amp; completeCallback(_SelfSlideItem);
           }
</PRE><PRE>           function LoadSlideshowImageCompleteEventHandler(nextIndex, nextItem, slideshowTransition, loadingTicket) {
               if (loadingTicket == _LoadingTicket &amp;&amp; _CurrentSlideIndex == slideIndex &amp;&amp; _AutoPlay) {
                   if (!_Frozen) {
                       var nextRealIndex = GetRealIndex(nextIndex);
                       _SlideshowRunner.$Initialize(nextRealIndex, slideIndex, nextItem, _SelfSlideItem, slideshowTransition);
                       nextItem.$HideContentForSlideshow();
                       _Slideshow.$Locate(nextRealIndex, 1);
                       _Slideshow.$GoToPosition(nextRealIndex);
                       _CarouselPlayer.$PlayCarousel(nextIndex, nextIndex, 0);
                   }
               }
           }
</PRE><PRE>           function SlideReadyEventHandler(loadingTicket) {
               if (loadingTicket == _LoadingTicket &amp;&amp; _CurrentSlideIndex == slideIndex) {
</PRE><PRE>                   if (!_Processor) {
                       var slideshowProcessor = null;
                       if (_SlideshowRunner) {
                           if (_SlideshowRunner.$Index == slideIndex)
                               slideshowProcessor = _SlideshowRunner.$GetProcessor();
                           else
                               _SlideshowRunner.$Clear();
                       }
</PRE><PRE>                       EnsureCaptionSliderVersion();
</PRE><PRE>                       _Processor = new Processor(slideIndex, slideshowProcessor, _SelfSlideItem.$GetCaptionSliderIn(), _SelfSlideItem.$GetCaptionSliderOut());
                       _Processor.$SetPlayer(_PlayerInstance);
                   }
</PRE><PRE> !_Processor.$IsPlaying() &amp;&amp; _Processor.$Replay();
               }
           }
</PRE><PRE>           function ParkEventHandler(currentIndex, previousIndex) {
               if (currentIndex == slideIndex) {
</PRE><PRE>                   if (currentIndex != previousIndex)
                       _SlideItems[previousIndex] &amp;&amp; _SlideItems[previousIndex].$ParkOut();
</PRE><PRE>                   _PlayerInstance &amp;&amp; _PlayerInstance.$Enable();
</PRE><PRE>                   //park in
                   var loadingTicket = _LoadingTicket = $JssorUtils$.$GetNow();
                   _SelfSlideItem.$LoadImage($JssorUtils$.$CreateCallback(null, SlideReadyEventHandler, loadingTicket));
               }
               else {
                   var distance = Math.abs(slideIndex - currentIndex);
                   var loadRange = _DisplayPieces + _Options.$LazyLoading;
                   if (!_ImageLazyLoading || distance &lt;= loadRange || _SlideCount - distance &lt;= loadRange) {
                       _SelfSlideItem.$LoadImage();
                   }
               }
           }
</PRE><PRE>           function SwipeStartEventHandler() {
               if (_CurrentSlideIndex == slideIndex &amp;&amp; _Processor) {
                   _Processor.$Stop();
                   _PlayerInstance &amp;&amp; _PlayerInstance.$Quit();
                   _PlayerInstance &amp;&amp; _PlayerInstance.$Disable();
                   _Processor.$OpenSlideshowPanel();
               }
           }
</PRE><PRE>           function DragStartEventHandler() {
               if (_CurrentSlideIndex == slideIndex &amp;&amp; _Processor) {
                   _Processor.$Stop();
               }
           }
</PRE><PRE>           function LinkClickEventHandler(event) {
               if (_LastDragSucceded) {
                   $JssorUtils$.$CancelEvent(event);
               }
               else {
                   _SelfSlider.$TriggerEvent(JssorSlider.$EVT_CLICK, slideIndex, event);
               }
           }
</PRE><PRE>           function PlayerAvailableEventHandler() {
               _PlayerInstance = _PlayerInstanceElement.pInstance;
               _Processor &amp;&amp; _Processor.$SetPlayer(_PlayerInstance);
           }
</PRE><PRE>           _SelfSlideItem.$LoadImage = function (completeCallback, loadingScreen) {
               loadingScreen = loadingScreen || _LoadingScreen;
</PRE><PRE>               if (_ImageElmts.length &amp;&amp; !_ImageLoaded) {
</PRE><PRE>                   $JssorUtils$.$ShowElement(loadingScreen);
</PRE><PRE>                   if (!_ImageLoading) {
                       _ImageLoading = true;
                       _SelfSlider.$TriggerEvent(JssorSlider.$EVT_LOAD_START);
</PRE><PRE>                       $JssorUtils$.$Each(_ImageElmts, function (imageElmt) {
</PRE><PRE>                           if (!imageElmt.src) {
                               imageElmt.src = $JssorUtils$.$GetAttributeEx(imageElmt, &quot;src2&quot;);
                               $JssorUtils$.$CssDisplay(imageElmt, imageElmt[&quot;display-origin&quot;]);
                           }
                       });
                   }
                   $JssorUtils$.$LoadImages(_ImageElmts, _ImageItem, $JssorUtils$.$CreateCallback(null, LoadImageCompleteEventHandler, completeCallback, loadingScreen));
               }
               else {
                   LoadImageCompleteEventHandler(completeCallback, loadingScreen);
               }
           };
</PRE><PRE>           _SelfSlideItem.$GoForNextSlide = function () {
               if (_SlideshowRunner) {
                   var slideshowTransition = _SlideshowRunner.$GetTransition(_SlideCount);
</PRE><PRE>                   if (slideshowTransition) {
                       var loadingTicket = _LoadingTicket = $JssorUtils$.$GetNow();
</PRE><PRE>                       var nextIndex = slideIndex + 1 * _PlayReverse;
                       var nextItem = _SlideItems[GetRealIndex(nextIndex)];
                       return nextItem.$LoadImage($JssorUtils$.$CreateCallback(null, LoadSlideshowImageCompleteEventHandler, nextIndex, nextItem, slideshowTransition, loadingTicket), _LoadingScreen);
                   }
               }
</PRE><PRE>               PlayTo(_CurrentSlideIndex + _Options.$AutoPlaySteps * _PlayReverse);
           };
</PRE><PRE>           _SelfSlideItem.$TryActivate = function () {
               ParkEventHandler(slideIndex, slideIndex);
           };
</PRE><PRE>           _SelfSlideItem.$ParkOut = function () {
               //park out
               _PlayerInstance &amp;&amp; _PlayerInstance.$Quit();
               _PlayerInstance &amp;&amp; _PlayerInstance.$Disable();
               _SelfSlideItem.$UnhideContentForSlideshow();
               _Processor &amp;&amp; _Processor.$Abort();
               _Processor = null;
               ResetCaptionSlider();
           };
</PRE><PRE>           //for debug only
           _SelfSlideItem.$StampSlideItemElements = function (stamp) {
               stamp = _SequenceNumber + &quot;_&quot; + stamp;
</PRE><PRE>               $JssorDebug$.$Execute(function () {
                   if (_ImageItem)
                       $JssorUtils$.$SetAttribute(_ImageItem, &quot;debug-id&quot;, stamp + &quot;_slide_item_image_id&quot;);
</PRE><PRE>                   $JssorUtils$.$SetAttribute(slideElmt, &quot;debug-id&quot;, stamp + &quot;_slide_item_item_id&quot;);
               });
</PRE><PRE>               $JssorDebug$.$Execute(function () {
                   $JssorUtils$.$SetAttribute(_Wrapper, &quot;debug-id&quot;, stamp + &quot;_slide_item_wrapper_id&quot;);
               });
</PRE><PRE>               $JssorDebug$.$Execute(function () {
                   $JssorUtils$.$SetAttribute(_LoadingScreen, &quot;debug-id&quot;, stamp + &quot;_loading_container_id&quot;);
               });
           };
</PRE><PRE>           _SelfSlideItem.$HideContentForSlideshow = function () {
               $JssorUtils$.$HideElement(slideElmt);
           };
</PRE><PRE>           _SelfSlideItem.$UnhideContentForSlideshow = function () {
               $JssorUtils$.$ShowElement(slideElmt);
           };
</PRE><PRE>           _SelfSlideItem.$EnablePlayer = function () {
               _PlayerInstance &amp;&amp; _PlayerInstance.$Enable();
           };
</PRE><PRE>           function RefreshContent(elmt, fresh, level) {
               if (elmt[&quot;jssor-slider&quot;])
                   return;
</PRE><PRE>               level = level || 0;
</PRE><PRE>               if (!_ContentRefreshed) {
                   if (elmt.tagName == &quot;IMG&quot;) {
                       _ImageElmts.push(elmt);
</PRE><PRE>                       if (!elmt.src) {
                           _ImageLazyLoading = true;
                           elmt[&quot;display-origin&quot;] = $JssorUtils$.$CssDisplay(elmt);
                           $JssorUtils$.$HideElement(elmt);
                       }
                   }
                   if ($JssorUtils$.$IsBrowserIe9Earlier()) {
                       $JssorUtils$.$CssZIndex(elmt, ($JssorUtils$.$CssZIndex(elmt) || 0) + 1);
                   }
                   if (_Options.$HWA &amp;&amp; $JssorUtils$.$GetWebKitVersion() &gt; 0) {
                       //if ((_HandleTouchEventOnly &amp;&amp; ($JssorUtils$.$GetWebKitVersion() &lt; 534 || !_SlideshowEnabled)) || (!_HandleTouchEventOnly &amp;&amp; $JssorUtils$.$GetWebKitVersion() &lt; 535)) {
                       //    $JssorUtils$.$EnableHWA(elmt);
                       //}
                       if (!_HandleTouchEventOnly || ($JssorUtils$.$GetWebKitVersion() &lt; 534 || !_SlideshowEnabled)) {
                           $JssorUtils$.$EnableHWA(elmt);
                       }
                   }
               }
</PRE><PRE>               var childElements = $JssorUtils$.$GetChildren(elmt);
</PRE><PRE>               $JssorUtils$.$Each(childElements, function (childElement, i) {
</PRE><PRE>                   var uAttribute = $JssorUtils$.$GetAttributeEx(childElement, &quot;u&quot;);
                   if (uAttribute == &quot;player&quot; &amp;&amp; !_PlayerInstanceElement) {
                       _PlayerInstanceElement = childElement;
                       if (_PlayerInstanceElement.pInstance) {
                           PlayerAvailableEventHandler();
                       }
                       else {
                           $JssorUtils$.$AddEvent(_PlayerInstanceElement, &quot;dataavailable&quot;, PlayerAvailableEventHandler);
                       }
                   }
</PRE><PRE>                   if (uAttribute == &quot;caption&quot;) {
                       if (!$JssorUtils$.$IsBrowserIE() &amp;&amp; !fresh) {
                           var captionElement = $JssorUtils$.$CloneNode(childElement, true);
                           $JssorUtils$.$InsertBefore(elmt, captionElement, childElement);
                           $JssorUtils$.$RemoveChild(elmt, childElement);
                           childElement = captionElement;
</PRE><PRE>                           fresh = true;
                       }
                   }
                   else if (!_ContentRefreshed &amp;&amp; !level &amp;&amp; !_ImageItem &amp;&amp; $JssorUtils$.$GetAttributeEx(childElement, &quot;u&quot;) == &quot;image&quot;) {
                       _ImageItem = childElement;
</PRE><PRE>                       if (_ImageItem) {
                           if (_ImageItem.tagName == &quot;A&quot;) {
                               _LinkItemOrigin = _ImageItem;
                               $JssorUtils$.$SetStyles(_LinkItemOrigin, _StyleDef);
</PRE><PRE>                               _LinkItem = $JssorUtils$.$CloneNode(_ImageItem, false);
                               //cancel click event on &lt;A&gt; element when a drag of slide succeeded
                               $JssorUtils$.$AddEvent(_LinkItem, &quot;click&quot;, LinkClickEventHandler);
</PRE><PRE>                               $JssorUtils$.$SetStyles(_LinkItem, _StyleDef);
                               $JssorUtils$.$CssDisplay(_LinkItem, &quot;block&quot;);
                               $JssorUtils$.$CssOpacity(_LinkItem, 0);
                               $JssorUtils$.$Css(_LinkItem, &quot;backgroundColor&quot;, &quot;#000&quot;);
</PRE><PRE>                               _ImageItem = $JssorUtils$.$FindFirstChildByTag(_ImageItem, &quot;IMG&quot;);
</PRE><PRE>                               $JssorDebug$.$Execute(function () {
                                   if (!_ImageItem) {
                                       $JssorDebug$.$Error(&quot;slide html code definition error, no 'IMG' found in a 'image with link' slide.\r\n&quot; + elmt.outerHTML);
                                   }
                               });
                           }
                           _ImageItem.border = 0;
</PRE><PRE>                           $JssorUtils$.$SetStyles(_ImageItem, _StyleDef);
                       }
                   }
</PRE><PRE>                   RefreshContent(childElement, fresh, level + 1);
               });
           }
</PRE><PRE>           _SelfSlideItem.$OnInnerOffsetChange = function (oldOffset, newOffset) {
               var slidePosition = _DisplayPieces - newOffset;
</PRE><PRE>               SetPosition(_Wrapper, slidePosition);
</PRE><PRE>               //following lines are for future usage, not ready yet
               //if (!_IsDragging || !_IsCaptionSliderPlayingWhenDragStart) {
               //    var _DealWithParallax;
               //    if (IsCurrentSlideIndex(slideIndex)) {
               //        if (_CaptionSliderOptions.$PlayOutMode == 2)
               //            _DealWithParallax = true;
               //    }
               //    else {
               //        if (!_CaptionSliderOptions.$PlayInMode) {
               //            //PlayInMode: 0 none
               //            _CaptionSliderIn.$GoToEnd();
               //        }
               //        //else if (_CaptionSliderOptions.$PlayInMode == 1) {
               //        //    //PlayInMode: 1 chain
               //        //    _CaptionSliderIn.$GoToBegin();
               //        //}
               //        else if (_CaptionSliderOptions.$PlayInMode == 2) {
               //            //PlayInMode: 2 parallel
               //            _DealWithParallax = true;
               //        }
               //    }
</PRE><PRE>               //    if (_DealWithParallax) {
               //        _CaptionSliderIn.$GoToPosition((_CaptionSliderIn.$GetPosition_OuterEnd() - _CaptionSliderIn.$GetPosition_OuterBegin()) * Math.abs(newOffset - 1) * .8 + _CaptionSliderIn.$GetPosition_OuterBegin());
               //    }
               //}
           };
</PRE><PRE>           _SelfSlideItem.$GetCaptionSliderIn = function () {
               return _CaptionSliderIn;
           };
</PRE><PRE>           _SelfSlideItem.$GetCaptionSliderOut = function () {
               return _CaptionSliderOut;
           };
</PRE><PRE>           _SelfSlideItem.$Index = slideIndex;
</PRE><PRE>           $JssorEventManager$.call(_SelfSlideItem);
</PRE><PRE>           //SlideItem Constructor
           {
</PRE><PRE>               var thumb = $JssorUtils$.$FindFirstChildByAttribute(slideElmt, &quot;thumb&quot;);
               if (thumb) {
                   _SelfSlideItem.$Thumb = $JssorUtils$.$CloneNode(thumb, true);
                   $JssorUtils$.$RemoveAttribute(thumb, &quot;id&quot;);
                   $JssorUtils$.$HideElement(thumb);
               }
               $JssorUtils$.$ShowElement(slideElmt);
</PRE><PRE>               _LoadingScreen = $JssorUtils$.$CloneNode(_LoadingContainer, true);
               $JssorUtils$.$CssZIndex(_LoadingScreen, 1000);
</PRE><PRE>               //cancel click event on &lt;A&gt; element when a drag of slide succeeded
               $JssorUtils$.$AddEvent(slideElmt, &quot;click&quot;, LinkClickEventHandler);
</PRE><PRE>               ResetCaptionSlider(true);
</PRE><PRE>               _SelfSlideItem.$Image = _ImageItem;
               _SelfSlideItem.$Link = _LinkItem;
</PRE><PRE>               _SelfSlideItem.$Item = slideElmt;
</PRE><PRE>               _SelfSlideItem.$Wrapper = _Wrapper = slideElmt;
               $JssorUtils$.$AppendChild(_Wrapper, _LoadingScreen);
</PRE><PRE>               _SelfSlider.$On(203, ParkEventHandler);
               _SelfSlider.$On(22, DragStartEventHandler);
               _SelfSlider.$On(24, SwipeStartEventHandler);
</PRE><PRE>               $JssorDebug$.$Execute(function () {
                   _SequenceNumber = _SlideItemCreatedCount++;
               });
</PRE><PRE>               $JssorDebug$.$Execute(function () {
                   $JssorUtils$.$SetAttribute(_Wrapper, &quot;debug-id&quot;, &quot;slide-&quot; + slideIndex);
               });
           }
       }
       //SlideItem
</PRE><PRE>       //Processor
       function Processor(slideIndex, slideshowProcessor, captionSliderIn, captionSliderOut) {
</PRE><PRE>           var _SelfProcessor = this;
</PRE><PRE>           var _ProgressBegin = 0;
           var _SlideshowBegin = 0;
           var _SlideshowEnd;
           var _CaptionInBegin;
           var _IdleBegin;
           var _IdleEnd;
           var _ProgressEnd;
</PRE><PRE>           var _IsSlideshowRunning;
           var _IsRollingBack;
</PRE><PRE>           var _PlayerInstance;
           var _IsPlayerOnService;
</PRE><PRE>           var slideItem = _SlideItems[slideIndex];
</PRE><PRE>           $JssorAnimator$.call(_SelfProcessor, 0, 0);
</PRE><PRE>           function UpdateLink() {
</PRE><PRE>               $JssorUtils$.$ClearChildren(_LinkContainer);
</PRE><PRE>               if (_ShowLink &amp;&amp; _IsSlideshowRunning &amp;&amp; slideItem.$Link) {
                   $JssorUtils$.$AppendChild(_LinkContainer, slideItem.$Link);
               }
</PRE><PRE>               $JssorUtils$.$ShowElement(_LinkContainer, _IsSlideshowRunning || !slideItem.$Image);
           }
</PRE><PRE>           function ProcessCompleteEventHandler() {
</PRE><PRE>               if (_IsRollingBack) {
                   _IsRollingBack = false;
                   _SelfSlider.$TriggerEvent(JssorSlider.$EVT_ROLLBACK_END, slideIndex, _IdleEnd, _ProgressBegin, _IdleBegin, _IdleEnd, _ProgressEnd);
                   _SelfProcessor.$GoToPosition(_IdleBegin);
               }
</PRE><PRE>               _SelfProcessor.$Replay();
           }
</PRE><PRE>           function PlayerSwitchEventHandler(isOnService) {
               _IsPlayerOnService = isOnService;
</PRE><PRE>               _SelfProcessor.$Stop();
               _SelfProcessor.$Replay();
           }
</PRE><PRE>           _SelfProcessor.$Replay = function () {
</PRE><PRE>               var currentPosition = _SelfProcessor.$GetPosition_Display();
</PRE><PRE>               if (!_IsDragging &amp;&amp; !_IsSliding &amp;&amp; !_IsPlayerOnService &amp;&amp; _CurrentSlideIndex == slideIndex) {
</PRE><PRE>                   if (!currentPosition) {
                       if (_SlideshowEnd &amp;&amp; !_IsSlideshowRunning) {
                           _IsSlideshowRunning = true;
</PRE><PRE>                           _SelfProcessor.$OpenSlideshowPanel(true);
</PRE><PRE>                           _SelfSlider.$TriggerEvent(JssorSlider.$EVT_SLIDESHOW_START, slideIndex, _ProgressBegin, _SlideshowBegin, _SlideshowEnd, _ProgressEnd);
                       }
</PRE><PRE>                       UpdateLink();
                   }
</PRE><PRE>                   var toPosition;
                   var stateEvent = JssorSlider.$EVT_STATE_CHANGE;
</PRE><PRE>                   if (currentPosition != _ProgressEnd) {
                       if (currentPosition == _IdleEnd) {
                           toPosition = _ProgressEnd;
                       }
                       else if (currentPosition == _IdleBegin) {
                           toPosition = _IdleEnd;
                       }
                       else if (!currentPosition) {
                           toPosition = _IdleBegin;
                       }
                       else if (currentPosition &gt; _IdleEnd) {
                           _IsRollingBack = true;
                           toPosition = _IdleEnd;
                           stateEvent = JssorSlider.$EVT_ROLLBACK_START;
                       }
                       else {
                           //continue from break (by drag or lock)
                           toPosition = _SelfProcessor.$GetPlayToPosition();
                       }
                   }
</PRE><PRE>                   _SelfSlider.$TriggerEvent(stateEvent, slideIndex, currentPosition, _ProgressBegin, _IdleBegin, _IdleEnd, _ProgressEnd);
</PRE><PRE>                   var allowAutoPlay = _AutoPlay &amp;&amp; (!_HoverToPause || _HoverStatus);
</PRE><PRE>                   if (currentPosition == _ProgressEnd) {
                       allowAutoPlay &amp;&amp; slideItem.$GoForNextSlide();
                   }
                   else if (allowAutoPlay || currentPosition != _IdleEnd) {
                       _SelfProcessor.$PlayToPosition(toPosition, ProcessCompleteEventHandler);
                   }
               }
           };
</PRE><PRE>           _SelfProcessor.$Abort = function () {
               _SlideshowRunner &amp;&amp; _SlideshowRunner.$Index == slideIndex &amp;&amp; _SlideshowRunner.$Clear();
</PRE><PRE>               var currentPosition = _SelfProcessor.$GetPosition_Display();
               if (currentPosition &lt; _ProgressEnd) {
                   _SelfSlider.$TriggerEvent(JssorSlider.$EVT_STATE_CHANGE, slideIndex, -currentPosition - 1, _ProgressBegin, _IdleBegin, _IdleEnd, _ProgressEnd);
               }
           };
</PRE><PRE>           _SelfProcessor.$OpenSlideshowPanel = function (open) {
               if (slideshowProcessor) {
                   $JssorUtils$.$CssOverflow(_SlideshowPanel, open &amp;&amp; slideshowProcessor.$Transition.$Outside ? &quot;&quot; : &quot;hidden&quot;);
               }
           };
</PRE><PRE>           _SelfProcessor.$OnInnerOffsetChange = function (oldPosition, newPosition) {
</PRE><PRE>               if (_IsSlideshowRunning &amp;&amp; newPosition &gt;= _SlideshowEnd) {
                   _IsSlideshowRunning = false;
                   UpdateLink();
                   slideItem.$UnhideContentForSlideshow();
                   _SlideshowRunner.$Clear();
</PRE><PRE>                   _SelfSlider.$TriggerEvent(JssorSlider.$EVT_SLIDESHOW_END, slideIndex, _ProgressBegin, _SlideshowBegin, _SlideshowEnd, _ProgressEnd);
               }
</PRE><PRE>               _SelfSlider.$TriggerEvent(JssorSlider.$EVT_PROGRESS_CHANGE, slideIndex, newPosition, _ProgressBegin, _IdleBegin, _IdleEnd, _ProgressEnd);
           };
</PRE><PRE>           _SelfProcessor.$SetPlayer = function (playerInstance) {
               if (playerInstance &amp;&amp; !_PlayerInstance) {
                   _PlayerInstance = playerInstance;
</PRE><PRE>                   playerInstance.$On($JssorPlayer$.$EVT_SWITCH, PlayerSwitchEventHandler);
               }
           };
</PRE><PRE>           //Processor Constructor
           {
               if (slideshowProcessor) {
                   _SelfProcessor.$Chain(slideshowProcessor);
               }
</PRE><PRE>               _SlideshowEnd = _SelfProcessor.$GetPosition_OuterEnd();
               _CaptionInBegin = _SelfProcessor.$GetPosition_OuterEnd();
               _SelfProcessor.$Chain(captionSliderIn);
               _IdleBegin = captionSliderIn.$GetPosition_OuterEnd();
               _IdleEnd = _IdleBegin + _Options.$AutoPlayInterval;
</PRE><PRE>               captionSliderOut.$Shift(_IdleEnd);
               _SelfProcessor.$Combine(captionSliderOut);
               _ProgressEnd = _SelfProcessor.$GetPosition_OuterEnd();
           }
       }
       //Processor
       //private classes
</PRE><PRE>       function SetPosition(elmt, position) {
           var orientation = _DragOrientation &gt; 0 ? _DragOrientation : _PlayOrientation;
           var x = _StepLengthX * position * (orientation &amp; 1);
           var y = _StepLengthY * position * ((orientation &gt;&gt; 1) &amp; 1);
</PRE><PRE>           if (!$JssorUtils$.$IsBrowserChrome()) {
               x = Math.round(x);
               y = Math.round(y);
           }
</PRE><PRE>           if ($JssorUtils$.$IsBrowserIE() &amp;&amp; $JssorUtils$.$GetBrowserVersion() &gt;= 10 &amp;&amp; $JssorUtils$.$GetBrowserVersion() &lt; 11) {
               elmt.style.msTransform = &quot;translate(&quot; + x + &quot;px, &quot; + y + &quot;px)&quot;;
           }
           else if ($JssorUtils$.$IsBrowserChrome() &amp;&amp; $JssorUtils$.$GetBrowserVersion() &gt;= 30 &amp;&amp; $JssorUtils$.$GetBrowserVersion() &lt; 34) {
               elmt.style.WebkitTransition = &quot;transform 0s&quot;;
               elmt.style.WebkitTransform = &quot;translate3d(&quot; + x + &quot;px, &quot; + y + &quot;px, 0px) perspective(2000px)&quot;;
           }
           else {
               $JssorUtils$.$CssLeft(elmt, x);
               $JssorUtils$.$CssTop(elmt, y);
           }
       }
</PRE><PRE>       //Event handling begin
</PRE><PRE>       function OnMouseDown(event) {
           _LastDragSucceded = 0;
</PRE><PRE>           var tagName = $JssorUtils$.$GetEventSrcElement(event).tagName;
           if (!_DragOrientationRegistered &amp;&amp; tagName != &quot;INPUT&quot; &amp;&amp; tagName != &quot;TEXTAREA&quot; &amp;&amp; RegisterDrag()) {
               OnDragStart(event);
           }
       }
</PRE><PRE>       function OnDragStart(event) {
           _DragStart_CarouselPlaying = _IsSliding;
</PRE><PRE>           _IsDragging = true;
           _DragInvalid = false;
           _LoadingTicket = null;
</PRE><PRE>           $JssorUtils$.$AddEvent(document, _MoveEvent, OnDragMove);
</PRE><PRE>           _LastTimeMoveByDrag = $JssorUtils$.$GetNow() - 50;
           _DragStartPlayToPosition = _CarouselPlayer.$GetPlayToPosition();
           _CarouselPlayer.$Stop();
</PRE><PRE>           if (!_DragStart_CarouselPlaying)
               _DragOrientation = 0;
</PRE><PRE>           if (_HandleTouchEventOnly) {
               var touchPoint = event.touches[0];
               _DragStartMouseX = touchPoint.clientX;
               _DragStartMouseY = touchPoint.clientY;
           }
           else {
               var mousePoint = $JssorUtils$.$GetMousePosition(event);
</PRE><PRE>               _DragStartMouseX = mousePoint.x;
               _DragStartMouseY = mousePoint.y;
</PRE><PRE>               $JssorUtils$.$CancelEvent(event);
           }
</PRE><PRE>           _DragOffsetTotal = 0;
           _DragOffsetLastTime = 0;
           _DragIndexAdjust = 0;
           _DragStartPosition = _Conveyor.$GetPosition();
</PRE><PRE>           //Trigger EVT_DRAGSTART
           _SelfSlider.$TriggerEvent(JssorSlider.$EVT_DRAG_START, GetRealIndex(_DragStartPosition), _DragStartPosition, event);
       }
</PRE><PRE>       function OnDragMove(event) {
           if (_IsDragging &amp;&amp; (!$JssorUtils$.$IsBrowserIe9Earlier() || event.button)) {
               var actionPoint;
</PRE><PRE>               if (_HandleTouchEventOnly) {
                   var touches = event.touches;
                   if (touches &amp;&amp; touches.length &gt; 0) {
                       actionPoint = new $JssorPoint$(touches[0].clientX, touches[0].clientY);
                   }
               }
               else {
                   actionPoint = $JssorUtils$.$GetMousePosition(event);
               }
</PRE><PRE>               if (actionPoint) {
                   var distanceX = actionPoint.x - _DragStartMouseX;
                   var distanceY = actionPoint.y - _DragStartMouseY;
</PRE><PRE>                   if (Math.floor(_DragStartPosition) != _DragStartPosition)
                       _DragOrientation = _DragOrientation || (_PlayOrientation &amp; _DragOrientationRegistered);
</PRE><PRE>                   if ((distanceX || distanceY) &amp;&amp; !_DragOrientation) {
                       if (_DragOrientationRegistered == 3) {
                           if (Math.abs(distanceY) &gt; Math.abs(distanceX)) {
                               _DragOrientation = 2;
                           }
                           else
                               _DragOrientation = 1;
                       }
                       else {
                           _DragOrientation = _DragOrientationRegistered;
                       }
</PRE><PRE>                       if (_HandleTouchEventOnly &amp;&amp; _DragOrientation == 1 &amp;&amp; Math.abs(distanceY) - Math.abs(distanceX) &gt; 3) {
                           _DragInvalid = true;
                       }
                   }
</PRE><PRE>                   if (_DragOrientation) {
                       var distance = distanceY;
                       var stepLength = _StepLengthY;
</PRE><PRE>                       if (_DragOrientation == 1) {
                           distance = distanceX;
                           stepLength = _StepLengthX;
                       }
</PRE><PRE>                       if (!(_Loop &amp; 1)) {
                           if (distance &gt; 0) {
                               var normalDistance = stepLength * _CurrentSlideIndex;
                               var sqrtDistance = distance - normalDistance;
                               if (sqrtDistance &gt; 0) {
                                   distance = normalDistance + Math.sqrt(sqrtDistance) * 5;
                               }
                           }
</PRE><PRE>                           if (distance &lt; 0) {
                               var normalDistance = stepLength * (_SlideCount - _DisplayPieces - _CurrentSlideIndex);
                               var sqrtDistance = -distance - normalDistance;
</PRE><PRE>                               if (sqrtDistance &gt; 0) {
                                   distance = -normalDistance - Math.sqrt(sqrtDistance) * 5;
                               }
                           }
                       }
</PRE><PRE>                       if (_DragOffsetTotal - _DragOffsetLastTime &lt; -2) {
                           _DragIndexAdjust = 1;
                       }
                       else if (_DragOffsetTotal - _DragOffsetLastTime &gt; 2) {
                           _DragIndexAdjust = 0;
                       }
</PRE><PRE>                       _DragOffsetLastTime = _DragOffsetTotal;
                       _DragOffsetTotal = distance;
                       _PositionToGoByDrag = _DragStartPosition - _DragOffsetTotal / stepLength / (_ScaleRatio || 1);
</PRE><PRE>                       if (_DragOffsetTotal &amp;&amp; _DragOrientation &amp;&amp; !_DragInvalid) {
                           $JssorUtils$.$CancelEvent(event);
                           if (!_IsSliding) {
                               _CarouselPlayer.$StandBy(_PositionToGoByDrag);
                           }
                           else
                               _CarouselPlayer.$SetStandByPosition(_PositionToGoByDrag);
                       }
                       else if ($JssorUtils$.$IsBrowserIe9Earlier()) {
                           $JssorUtils$.$CancelEvent(event);
                       }
                   }
               }
           }
           else {
               OnDragEnd(event);
           }
       }
</PRE><PRE>       function OnDragEnd(event) {
           UnregisterDrag();
</PRE><PRE>           if (_IsDragging) {
</PRE><PRE>               _IsDragging = false;
</PRE><PRE>               _LastTimeMoveByDrag = $JssorUtils$.$GetNow();
</PRE><PRE>               $JssorUtils$.$RemoveEvent(document, _MoveEvent, OnDragMove);
</PRE><PRE>               _LastDragSucceded = _DragOffsetTotal;
</PRE><PRE>               _LastDragSucceded &amp;&amp; $JssorUtils$.$CancelEvent(event);
</PRE><PRE>               _CarouselPlayer.$Stop();
</PRE><PRE>               var currentPosition = _Conveyor.$GetPosition();
</PRE><PRE>               //Trigger EVT_DRAG_END
               _SelfSlider.$TriggerEvent(JssorSlider.$EVT_DRAG_END, GetRealIndex(currentPosition), currentPosition, GetRealIndex(_DragStartPosition), _DragStartPosition, event);
</PRE><PRE>               var toPosition = Math.floor(_DragStartPosition);
</PRE><PRE>               if (Math.abs(_DragOffsetTotal) &gt;= _Options.$MinDragOffsetToSlide) {
                   toPosition = Math.floor(currentPosition);
                   toPosition += _DragIndexAdjust;
               }
</PRE><PRE>               if (!(_Loop &amp; 1)) {
                   toPosition = Math.min(_SlideCount - _DisplayPieces, Math.max(toPosition, 0));
               }
</PRE><PRE>               var t = Math.abs(toPosition - currentPosition);
               t = 1 - Math.pow(1 - t, 5);
</PRE><PRE>               if (!_LastDragSucceded &amp;&amp; _DragStart_CarouselPlaying) {
                   _CarouselPlayer.$Continue(_DragStartPlayToPosition);
               }
               else if (currentPosition == toPosition) {
                   _CurrentSlideItem.$EnablePlayer();
                   _CurrentSlideItem.$TryActivate();
               }
               else {
                   _CarouselPlayer.$PlayCarousel(currentPosition, toPosition, t * _SlideDuration);
               }
           }
       }
       //Event handling end
</PRE><PRE>       function SetCurrentSlideIndex(index) {
           _PrevSlideItem = _SlideItems[_CurrentSlideIndex];
           _PreviousSlideIndex = _CurrentSlideIndex;
           _CurrentSlideIndex = GetRealIndex(index);
           _CurrentSlideItem = _SlideItems[_CurrentSlideIndex];
           ResetNavigator(index);
           return _CurrentSlideIndex;
       }
</PRE><PRE>       function OnPark(slideIndex, prevIndex) {
           _DragOrientation = 0;
</PRE><PRE>           SetCurrentSlideIndex(slideIndex);
</PRE><PRE>           //Trigger EVT_PARK
           _SelfSlider.$TriggerEvent(JssorSlider.$EVT_PARK, GetRealIndex(slideIndex), prevIndex);
       }
</PRE><PRE>       function ResetNavigator(index, temp) {
           _TempSlideIndex = index;
           $JssorUtils$.$Each(_Navigators, function (navigator) {
               navigator.$SetCurrentIndex(GetRealIndex(index), index, temp);
           });
       }
</PRE><PRE>       function RegisterDrag() {
           var dragRegistry = JssorSlider.$DragRegistry || 0;
           var dragOrientation = _DragEnabled;
           if (_HandleTouchEventOnly)
               (dragOrientation &amp; 1) &amp;&amp; (dragOrientation &amp;= 1);
           JssorSlider.$DragRegistry |= dragOrientation;
</PRE><PRE>           return (_DragOrientationRegistered = dragOrientation &amp; ~dragRegistry);
       }
</PRE><PRE>       function UnregisterDrag() {
           if (_DragOrientationRegistered) {
               JssorSlider.$DragRegistry &amp;= ~_DragEnabled;
               _DragOrientationRegistered = 0;
           }
       }
</PRE><PRE>       function CreatePanel() {
           var div = $JssorUtils$.$CreateDivElement();
</PRE><PRE>           $JssorUtils$.$SetStyles(div, _StyleDef);
           $JssorUtils$.$CssPosition(div, &quot;absolute&quot;);
</PRE><PRE>           return div;
       }
</PRE><PRE>       function GetRealIndex(index) {
           return (index % _SlideCount + _SlideCount) % _SlideCount;
       }
</PRE><PRE>       function IsCurrentSlideIndex(index) {
           return GetRealIndex(index) == _CurrentSlideIndex;
       }
</PRE><PRE>       function IsPreviousSlideIndex(index) {
           return GetRealIndex(index) == _PreviousSlideIndex;
       }
</PRE><PRE>       //Navigation Request Handler
       function NavigationClickHandler(index, relative) {
           if (relative) {
               if (!_Loop) {
                   //Stop at threshold
                   index = Math.min(Math.max(index + _TempSlideIndex, 0), _SlideCount - _DisplayPieces);
                   relative = false;
               }
               else if (_Loop &amp; 2) {
                   //Rewind
                   index = GetRealIndex(index + _TempSlideIndex);
                   relative = false;
               }
           }
           PlayTo(index, _Options.$SlideDuration, relative);
       }
</PRE><PRE>       function ShowNavigators() {
           $JssorUtils$.$Each(_Navigators, function (navigator) {
               navigator.$Show(navigator.$Options.$ChanceToShow &gt; _HoverStatus);
           });
       }
</PRE><PRE>       function MainContainerMouseOutEventHandler(event) {
           event = $JssorUtils$.$GetEvent(event);
           // we have to watch out for a tricky case: a mouseout occurs on a
           // child element, but the mouse is still inside the parent element.
           // the mouseout event will bubble up to us. this happens in all
           // browsers, so we need to correct for this. technique from:
           // <A href="http://www.quirksmode.org/js/events_mouse.html" class="external free" rel="nofollow">http://www.quirksmode.org/js/events_mouse.html</A>
           var from = event.target ? event.target : event.srcElement;
           var to = event.relatedTarget ? event.relatedTarget : event.toElement;
</PRE><PRE>           if (!$JssorUtils$.$IsChild(elmt, from) || $JssorUtils$.$IsChild(elmt, to)) {
               // the mouseout needs to start from this or a child node, and it
               // needs to end on this or an outer node.
               return;
           }
</PRE><PRE>           _HoverStatus = 1;
</PRE><PRE>           ShowNavigators();
</PRE><PRE>           _SlideItems[_CurrentSlideIndex].$TryActivate();
       }
</PRE><PRE>       function MainContainerMouseOverEventHandler() {
           _HoverStatus = 0;
</PRE><PRE>           ShowNavigators();
       }
</PRE><PRE>       function AdjustSlidesContainerSize() {
           _StyleDef = { $Width: _SlideWidth, $Height: _SlideHeight, $Top: 0, $Left: 0 };
</PRE><PRE>           $JssorUtils$.$Each(_SlideElmts, function (slideElmt, i) {
</PRE><PRE>               $JssorUtils$.$SetStyles(slideElmt, _StyleDef);
               $JssorUtils$.$CssPosition(slideElmt, &quot;absolute&quot;);
               $JssorUtils$.$CssOverflow(slideElmt, &quot;hidden&quot;);
</PRE><PRE>               $JssorUtils$.$HideElement(slideElmt);
           });
</PRE><PRE>           $JssorUtils$.$SetStyles(_LoadingContainer, _StyleDef);
       }
</PRE><PRE>       function PlayToOffset(offset, slideDuration) {
           PlayTo(offset, slideDuration, true);
       }
</PRE><PRE>       function PlayTo(slideIndex, slideDuration, relative) {
           ///	&lt;summary&gt;
           ///		PlayTo( slideIndex [, slideDuration] ); //Play slider to position 'slideIndex' within a period calculated base on 'slideDuration'.
           ///	&lt;/summary&gt;
           ///	&lt;param name=&quot;slideIndex&quot; type=&quot;Number&quot;&gt;
           ///		slide slideIndex or position will be playing to
           ///	&lt;/param&gt;
           ///	&lt;param name=&quot;slideDuration&quot; type=&quot;Number&quot; optional=&quot;true&quot;&gt;
           ///		base slide duration in milliseconds to calculate the whole duration to complete this play request.
           ///	    default value is '$SlideDuration' value which is specified when initialize the slider.
           ///	&lt;/param&gt;
           /// <A href="http://msdn.microsoft.com/en-us/library/vstudio/bb385682.aspx" class="external free" rel="nofollow">http://msdn.microsoft.com/en-us/library/vstudio/bb385682.aspx</A>
           /// <A href="http://msdn.microsoft.com/en-us/library/vstudio/hh542720.aspx" class="external free" rel="nofollow">http://msdn.microsoft.com/en-us/library/vstudio/hh542720.aspx</A>
           if (_CarouselEnabled &amp;&amp; (!_IsDragging || _Options.$NaviQuitDrag)) {
               _IsSliding = true;
               _IsDragging = false;
               _CarouselPlayer.$Stop();
</PRE><PRE>               {
                   //Slide Duration
                   if ($JssorUtils$.$IsUndefined(slideDuration))
                       slideDuration = _SlideDuration;
</PRE><PRE>                   var positionDisplay = _Carousel.$GetPosition_Display();
                   var positionTo = slideIndex;
                   if (relative) {
                       positionTo = positionDisplay + slideIndex;
                       if (slideIndex &gt; 0)
                           positionTo = Math.ceil(positionTo);
                       else
                           positionTo = Math.floor(positionTo);
                   }
</PRE><PRE>                   if (!(_Loop &amp; 1)) {
                       positionTo = GetRealIndex(positionTo);
                       positionTo = Math.max(0, Math.min(positionTo, _SlideCount - _DisplayPieces));
                   }
</PRE><PRE>                   var positionOffset = (positionTo - positionDisplay) % _SlideCount;
                   positionTo = positionDisplay + positionOffset;
</PRE><PRE>                   var duration = positionDisplay == positionTo ? 0 : slideDuration * Math.abs(positionOffset);
                   duration = Math.min(duration, slideDuration * _DisplayPieces * 1.5);
</PRE><PRE>                   _CarouselPlayer.$PlayCarousel(positionDisplay, positionTo, duration || 1);
               }
           }
       }
</PRE><PRE>       //private functions
</PRE><PRE>       //member functions
</PRE><PRE>       _SelfSlider.$PlayTo = PlayTo;
</PRE><PRE>       _SelfSlider.$GoTo = function (slideIndex) {
           ///	&lt;summary&gt;
           ///		instance.$GoTo( slideIndex );   //Go to the specifed slide immediately with no play.
           ///	&lt;/summary&gt;
           PlayTo(slideIndex, 1);
       };
</PRE><PRE>       _SelfSlider.$Next = function () {
           ///	&lt;summary&gt;
           ///		instance.$Next();   //Play the slider to next slide.
           ///	&lt;/summary&gt;
           PlayToOffset(1);
       };
</PRE><PRE>       _SelfSlider.$Prev = function () {
           ///	&lt;summary&gt;
           ///		instance.$Prev();   //Play the slider to previous slide.
           ///	&lt;/summary&gt;
           PlayToOffset(-1);
       };
</PRE><PRE>       _SelfSlider.$Pause = function () {
           ///	&lt;summary&gt;
           ///		instance.$Pause();   //Pause the slider, prevent it from auto playing.
           ///	&lt;/summary&gt;
           _AutoPlay = false;
       };
</PRE><PRE>       _SelfSlider.$Play = function () {
           ///	&lt;summary&gt;
           ///		instance.$Play();   //Start auto play if the slider is currently paused.
           ///	&lt;/summary&gt;
           if (!_AutoPlay) {
               _AutoPlay = true;
               _SlideItems[_CurrentSlideIndex] &amp;&amp; _SlideItems[_CurrentSlideIndex].$TryActivate();
           }
       };
</PRE><PRE>       _SelfSlider.$SetSlideshowTransitions = function (transitions) {
           ///	&lt;summary&gt;
           ///		instance.$SetSlideshowTransitions( transitions );   //Reset slideshow transitions for the slider.
           ///	&lt;/summary&gt;
           $JssorDebug$.$Execute(function () {
               if (!transitions || !transitions.length) {
                   $JssorDebug$.$Error(&quot;Can not set slideshow transitions, no transitions specified.&quot;);
               }
           });
</PRE><PRE>           _Options.$SlideshowOptions.$Transitions = transitions;
       };
</PRE><PRE>       _SelfSlider.$SetCaptionTransitions = function (transitions) {
           ///	&lt;summary&gt;
           ///		instance.$SetCaptionTransitions( transitions );   //Reset caption transitions for the slider.
           ///	&lt;/summary&gt;
           $JssorDebug$.$Execute(function () {
               if (!transitions || !transitions.length) {
                   $JssorDebug$.$Error(&quot;Can not set caption transitions, no transitions specified&quot;);
               }
           });
</PRE><PRE>           _CaptionSliderOptions.$CaptionTransitions = transitions;
           _CaptionSliderOptions.$Version = $JssorUtils$.$GetNow();
       };
</PRE><PRE>       _SelfSlider.$SlidesCount = function () {
           ///	&lt;summary&gt;
           ///		instance.$SlidesCount();   //Retrieve slides count of the slider.
           ///	&lt;/summary&gt;
           return _SlideElmts.length;
       };
</PRE><PRE>       _SelfSlider.$CurrentIndex = function () {
           ///	&lt;summary&gt;
           ///		instance.$CurrentIndex();   //Retrieve current slide index of the slider.
           ///	&lt;/summary&gt;
           return _CurrentSlideIndex;
       };
</PRE><PRE>       _SelfSlider.$IsAutoPlaying = function () {
           ///	&lt;summary&gt;
           ///		instance.$IsAutoPlaying();   //Retrieve auto play status of the slider.
           ///	&lt;/summary&gt;
           return _AutoPlay;
       };
</PRE><PRE>       _SelfSlider.$IsDragging = function () {
           ///	&lt;summary&gt;
           ///		instance.$IsDragging();   //Retrieve drag status of the slider.
           ///	&lt;/summary&gt;
           return _IsDragging;
       };
</PRE><PRE>       _SelfSlider.$IsSliding = function () {
           ///	&lt;summary&gt;
           ///		instance.$IsSliding();   //Retrieve right&lt;--&gt;left sliding status of the slider.
           ///	&lt;/summary&gt;
           return _IsSliding;
       };
</PRE><PRE>       _SelfSlider.$IsMouseOver = function () {
           ///	&lt;summary&gt;
           ///		instance.$IsMouseOver();   //Retrieve mouse over status of the slider.
           ///	&lt;/summary&gt;
           return !_HoverStatus;
       };
</PRE><PRE>       _SelfSlider.$LastDragSucceded = function () {
           ///	&lt;summary&gt;
           ///		instance.$IsLastDragSucceded();   //Retrieve last drag succeded status, returns 0 if failed, returns drag offset if succeded
           ///	&lt;/summary&gt;
           return _LastDragSucceded;
       };
</PRE><PRE>       _SelfSlider.$GetOriginalWidth = function () {
           ///	&lt;summary&gt;
           ///		instance.$GetOriginalWidth();   //Retrieve original width of the slider.
           ///	&lt;/summary&gt;
           return $JssorUtils$.$CssWidth(_ScaleWrapper || elmt);
       };
</PRE><PRE>       _SelfSlider.$GetOriginalHeight = function () {
           ///	&lt;summary&gt;
           ///		instance.$GetOriginalWidth();   //Retrieve original height of the slider.
           ///	&lt;/summary&gt;
           return $JssorUtils$.$CssHeight(_ScaleWrapper || elmt);
       };
</PRE><PRE>       _SelfSlider.$GetScaleWidth = function () {
           ///	&lt;summary&gt;
           ///		instance.$GetScaleWidth();   //Retrieve scaled width the slider currently displays.
           ///	&lt;/summary&gt;
           return $JssorUtils$.$CssWidth(elmt);
       };
</PRE><PRE>       _SelfSlider.$GetScaleHeight = function () {
           ///	&lt;summary&gt;
           ///		instance.$GetScaleHeight();   //Retrieve scaled height the slider currently displays.
           ///	&lt;/summary&gt;
           return $JssorUtils$.$CssHeight(elmt);
       };
</PRE><PRE>       _SelfSlider.$SetScaleWidth = function (width) {
           ///	&lt;summary&gt;
           ///		instance.$SetScaleWidth( width );   //Scale the slider to new width and keep aspect ratio.
           ///	&lt;/summary&gt;
           $JssorDebug$.$Execute(function () {
               if (!width || width &lt; 0) {
                   $JssorDebug$.$Fail(&quot;'$SetScaleWidth' error, 'width' should be positive value.&quot;);
               }
           });
</PRE><PRE>           if (!_ScaleWrapper) {
               $JssorDebug$.$Execute(function () {
                   var originalWidthStr = $JssorUtils$.$Css(elmt, &quot;width&quot;);
                   var originalHeightStr = $JssorUtils$.$Css(elmt, &quot;height&quot;);
                   var originalWidth = $JssorUtils$.$CssP(elmt, &quot;width&quot;);
                   var originalHeight = $JssorUtils$.$CssP(elmt, &quot;height&quot;);
</PRE><PRE>                   if (!originalWidthStr) {
                       $JssorDebug$.$Fail(&quot;Cannot scale jssor slider, 'width' of 'outer container' not specified. Please specify 'width' in pixel. e.g. 'width: 600px;'&quot;);
                   }
</PRE><PRE>                   if (!originalHeightStr) {
                       $JssorDebug$.$Fail(&quot;Cannot scale jssor slider, 'height' of 'outer container' not specified. Please specify 'height' in pixel. e.g. 'height: 300px;'&quot;);
                   }
</PRE><PRE>                   if (originalWidthStr.indexOf('%') != -1) {
                       $JssorDebug$.$Fail(&quot;Cannot scale jssor slider, 'width' of 'outer container' not valid. Please specify 'width' in pixel. e.g. 'width: 600px;'&quot;);
                   }
</PRE><PRE>                   if (originalHeightStr.indexOf('%') != -1) {
                       $JssorDebug$.$Fail(&quot;Cannot scale jssor slider, 'height' of 'outer container' not valid. Please specify 'height' in pixel. e.g. 'height: 300px;'&quot;);
                   }
</PRE><PRE>                   if (!originalWidth) {
                       $JssorDebug$.$Fail(&quot;Cannot scale jssor slider, 'width' of 'outer container' not valid. 'width' of 'outer container' should be positive number. e.g. 'width: 600px;'&quot;);
                   }
</PRE><PRE>                   if (!originalHeight) {
                       $JssorDebug$.$Fail(&quot;Cannot scale jssor slider, 'height' of 'outer container' not valid. 'height' of 'outer container' should be positive number. e.g. 'height: 300px;'&quot;);
                   }
               });
</PRE><PRE>               //var innerWrapper = $JssorUtils$.$CloneNode(elmt, false);
               //$JssorUtils$.$RemoveAttribute(innerWrapper, &quot;id&quot;);
               var innerWrapper = $JssorUtils$.$CreateDivElement(document);
               $JssorUtils$.$CssCssText(innerWrapper, $JssorUtils$.$CssCssText(elmt));
               $JssorUtils$.$SetClassName(innerWrapper, $JssorUtils$.$GetClassName(elmt));
</PRE><PRE>               $JssorUtils$.$CssPosition(innerWrapper, &quot;relative&quot;);
               $JssorUtils$.$CssTop(innerWrapper, 0);
               $JssorUtils$.$CssLeft(innerWrapper, 0);
               $JssorUtils$.$CssOverflow(innerWrapper, &quot;visible&quot;);
</PRE><PRE>               //_ScaleWrapper = $JssorUtils$.$CloneNode(elmt, false);
               //$JssorUtils$.$RemoveAttribute(_ScaleWrapper, &quot;id&quot;);
               //$JssorUtils$.$CssCssText(_ScaleWrapper, &quot;&quot;);
               _ScaleWrapper = $JssorUtils$.$CreateDivElement(document);
</PRE><PRE>               $JssorUtils$.$CssPosition(_ScaleWrapper, &quot;absolute&quot;);
               $JssorUtils$.$CssTop(_ScaleWrapper, 0);
               $JssorUtils$.$CssLeft(_ScaleWrapper, 0);
               $JssorUtils$.$CssWidth(_ScaleWrapper, $JssorUtils$.$CssWidth(elmt));
               $JssorUtils$.$CssHeight(_ScaleWrapper, $JssorUtils$.$CssHeight(elmt));
               $JssorUtils$.$SetStyleTransformOrigin(_ScaleWrapper, &quot;0 0&quot;);
</PRE><PRE>               $JssorUtils$.$AppendChild(_ScaleWrapper, innerWrapper);
</PRE><PRE>               var children = $JssorUtils$.$GetChildren(elmt);
               $JssorUtils$.$AppendChild(elmt, _ScaleWrapper);
</PRE><PRE>               $JssorUtils$.$Css(elmt, &quot;backgroundImage&quot;, &quot;&quot;);
</PRE><PRE>               var noMoveElmts = {
                   &quot;navigator&quot;: _BulletNavigatorOptions &amp;&amp; _BulletNavigatorOptions.$Scale == false,
                   &quot;arrowleft&quot;: _ArrowNavigatorOptions &amp;&amp; _ArrowNavigatorOptions.$Scale == false,
                   &quot;arrowright&quot;: _ArrowNavigatorOptions &amp;&amp; _ArrowNavigatorOptions.$Scale == false,
                   &quot;thumbnavigator&quot;: _ThumbnailNavigatorOptions &amp;&amp; _ThumbnailNavigatorOptions.$Scale == false,
                   &quot;thumbwrapper&quot;: _ThumbnailNavigatorOptions &amp;&amp; _ThumbnailNavigatorOptions.$Scale == false
               };
</PRE><PRE>               $JssorUtils$.$Each(children, function (child) {
                   $JssorUtils$.$AppendChild(noMoveElmts[$JssorUtils$.$GetAttributeEx(child, &quot;u&quot;)] ? elmt : innerWrapper, child);
               });
</PRE><PRE>               $JssorUtils$.$ShowElement(innerWrapper);
               $JssorUtils$.$ShowElement(_ScaleWrapper);
           }
</PRE><PRE>           $JssorDebug$.$Execute(function () {
               if (!_InitialScrollWidth) {
                   _InitialScrollWidth = _SelfSlider.$Elmt.scrollWidth;
               }
           });
</PRE><PRE>           _ScaleRatio = width / $JssorUtils$.$CssWidth(_ScaleWrapper);
           $JssorUtils$.$SetStyleScale(_ScaleWrapper, _ScaleRatio);
</PRE><PRE>           $JssorUtils$.$CssWidth(elmt, width);
           $JssorUtils$.$CssHeight(elmt, _ScaleRatio * $JssorUtils$.$CssHeight(_ScaleWrapper));
</PRE><PRE>           $JssorUtils$.$Each(_Navigators, function (navigator) {
               navigator.$Relocate();
           });
       };
</PRE><PRE>       _SelfSlider.$GetVirtualIndex = function (index) {
           var parkingIndex = Math.ceil(GetRealIndex(_ParkingPosition / _StepLength));
           var displayIndex = GetRealIndex(index - _CurrentSlideIndex + parkingIndex);
</PRE><PRE>           if (displayIndex &gt; _DisplayPieces) {
               if (index - _CurrentSlideIndex &gt; _SlideCount / 2)
                   index -= _SlideCount;
               else if (index - _CurrentSlideIndex &lt;= -_SlideCount / 2)
                   index += _SlideCount;
           }
           else {
               index = _CurrentSlideIndex + displayIndex - parkingIndex;
           }
</PRE><PRE>           return index;
       };
</PRE><PRE>       //member functions
</PRE><PRE>       //Inherit $JssorEventManager$
       $JssorEventManager$.call(this);
</PRE><PRE>       //initialize member variables
       _SelfSlider.$Elmt = elmt = $JssorUtils$.$GetElement(elmt);
       //initialize member variables
</PRE><PRE>       var _InitialScrollWidth;    //for debug only
       var _CaptionSliderCount = 1;    //for debug only
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           var outerContainerElmt = $JssorUtils$.$GetElement(elmt);
           if (!outerContainerElmt)
               $JssorDebug$.$Fail(&quot;Outer container '&quot; + elmt + &quot;' not found.&quot;);
       });
</PRE><PRE>       var _Options = $JssorUtils$.$Extend({
           $FillMode: 0,                   //[Optional] The way to fill image in slide, 0 stretch, 1 contain (keep aspect ratio and put all inside slide), 2 cover (keep aspect ratio and cover whole slide), 4 actual size, 5 contain for large image, actual size for small image, default value is 0
           $LazyLoading: 1,                //[Optional] For image with  lazy loading format (&lt;IMG src2=&quot;url&quot; .../&gt;), by default it will be loaded only when the slide comes.
           //But an integer value (maybe 1, 2 or 3) indicates that how far of nearby slides should be loaded immediately as well, default value is 1.
           $StartIndex: 0,                 //[Optional] Index of slide to display when initialize, default value is 0
           $AutoPlay: false,               //[Optional] Whether to auto play, default value is false
           $Loop: 1,                       //[Optional] Enable loop(circular) of carousel or not, 0: stop, 1: loop, 2 rewind, default value is 1
           $HWA: true,                     //[Optional] Enable hardware acceleration or not, default value is true
           $NaviQuitDrag: true,
           $AutoPlaySteps: 1,              //[Optional] Steps to go of every play (this options applys only when slideshow disabled), default value is 1
           $AutoPlayInterval: 3000,        //[Optional] Interval to play next slide since the previous stopped if a slideshow is auto playing, default value is 3000
           $PauseOnHover: 1,               //[Optional] Whether to pause when mouse over if a slider is auto playing, 0 no pause, 1 pause for desktop, 2 pause for touch device, 3 pause for desktop and touch device, default value is 1
           
           $SlideDuration: 500,            //[Optional] Specifies default duration (swipe) for slide in milliseconds, default value is 400
           $SlideEasing: $JssorEasing$.$EaseOutQuad,   //[Optional] Specifies easing for right to left animation, default value is $JssorEasing$.$EaseOutQuad
           $MinDragOffsetToSlide: 20,      //[Optional] Minimum drag offset that trigger slide, default value is 20
           $SlideSpacing: 0, 				//[Optional] Space between each slide in pixels, default value is 0
           $DisplayPieces: 1,              //[Optional] Number of pieces to display (the slideshow would be disabled if the value is set to greater than 1), default value is 1
           $ParkingPosition: 0,            //[Optional] The offset position to park slide (this options applys only when slideshow disabled), default value is 0.
           $UISearchMode: 1,               //[Optional] The way (0 parellel, 1 recursive, default value is recursive) to search UI components (slides container, loading screen, navigator container, arrow navigator container, thumbnail navigator container etc.
           $PlayOrientation: 1,            //[Optional] Orientation to play slide (for auto play, navigation), 1 horizental, 2 vertical, 5 horizental reverse, 6 vertical reverse, default value is 1
           $DragOrientation: 1             //[Optional] Orientation to drag slide, 0 no drag, 1 horizental, 2 vertical, 3 both, default value is 1 (Note that the $DragOrientation should be the same as $PlayOrientation when $DisplayPieces is greater than 1, or parking position is not 0)
</PRE><PRE>       }, options);
</PRE><PRE>       //Sodo statement for development time intellisence only
       $JssorDebug$.$Execute(function () {
           _Options = $JssorUtils$.$Extend({
               $ArrowKeyNavigation: undefined,
               $SlideWidth: undefined,
               $SlideHeight: undefined,
               $SlideshowOptions: undefined,
               $CaptionSliderOptions: undefined,
               $BulletNavigatorOptions: undefined,
               $ArrowNavigatorOptions: undefined,
               $ThumbnailNavigatorOptions: undefined
           },
           _Options);
       });
</PRE><PRE>       var _PlayOrientation = _Options.$PlayOrientation &amp; 3;
       var _PlayReverse = (_Options.$PlayOrientation &amp; 4) / -4 || 1;
</PRE><PRE>       var _SlideshowOptions = _Options.$SlideshowOptions;
       var _CaptionSliderOptions = $JssorUtils$.$Extend({ $Class: $JssorCaptionSliderBase$, $PlayInMode: 1, $PlayOutMode: 1 }, _Options.$CaptionSliderOptions);
       var _BulletNavigatorOptions = _Options.$BulletNavigatorOptions;
       var _ArrowNavigatorOptions = _Options.$ArrowNavigatorOptions;
       var _ThumbnailNavigatorOptions = _Options.$ThumbnailNavigatorOptions;
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (_SlideshowOptions &amp;&amp; !_SlideshowOptions.$Class) {
               $JssorDebug$.$Fail(&quot;Option $SlideshowOptions error, class not specified.&quot;);
           }
       });
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (_Options.$CaptionSliderOptions &amp;&amp; !_Options.$CaptionSliderOptions.$Class) {
               $JssorDebug$.$Fail(&quot;Option $CaptionSliderOptions error, class not specified.&quot;);
           }
       });
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (_BulletNavigatorOptions &amp;&amp; !_BulletNavigatorOptions.$Class) {
               $JssorDebug$.$Fail(&quot;Option $BulletNavigatorOptions error, class not specified.&quot;);
           }
       });
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (_ArrowNavigatorOptions &amp;&amp; !_ArrowNavigatorOptions.$Class) {
               $JssorDebug$.$Fail(&quot;Option $ArrowNavigatorOptions error, class not specified.&quot;);
           }
       });
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (_ThumbnailNavigatorOptions &amp;&amp; !_ThumbnailNavigatorOptions.$Class) {
               $JssorDebug$.$Fail(&quot;Option $ArrowNavigatorOptions error, class not specified.&quot;);
           }
       });
</PRE><PRE>       var _UISearchMode = _Options.$UISearchMode;
       var _ScaleWrapper;
       var _SlidesContainer = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;slides&quot;, null, _UISearchMode);
       var _LoadingContainer = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;loading&quot;, null, _UISearchMode) || $JssorUtils$.$CreateDivElement(document);
       var _NavigatorContainer = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;navigator&quot;, null, _UISearchMode);
</PRE><PRE>       var _ArrowLeft = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;arrowleft&quot;, null, _UISearchMode);
       var _ArrowRight = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;arrowright&quot;, null, _UISearchMode);
</PRE><PRE>       var _ThumbnailNavigatorContainer = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;thumbnavigator&quot;, null, _UISearchMode);
</PRE><PRE>       var _SlidesContainerWidth = $JssorUtils$.$CssWidth(_SlidesContainer);
       var _SlidesContainerHeight = $JssorUtils$.$CssHeight(_SlidesContainer);
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (isNaN(_SlidesContainerWidth))
               $JssorDebug$.$Fail(&quot;Width of slides container wrong specification, it should be specified by inline style in pixels (like style='width: 600px;').&quot;);
</PRE><PRE>           if ($JssorUtils$.$IsUndefined(_SlidesContainerWidth))
               $JssorDebug$.$Fail(&quot;Width of slides container not specified, it should be specified by inline style in pixels (like style='width: 600px;').&quot;);
</PRE><PRE>           if (isNaN(_SlidesContainerHeight))
               $JssorDebug$.$Fail(&quot;Height of slides container wrong specification, it should be specified by inline style in pixels (like style='height: 300px;').&quot;);
</PRE><PRE>           if ($JssorUtils$.$IsUndefined(_SlidesContainerHeight))
               $JssorDebug$.$Fail(&quot;Height of slides container not specified, it should be specified by inline style in pixels (like style='height: 300px;').&quot;);
</PRE><PRE>           var slidesContainerOverflow = $JssorUtils$.$CssOverflow(_SlidesContainer);
           var slidesContainerOverflowX = $JssorUtils$.$Css(_SlidesContainer, &quot;overflowX&quot;);
           var slidesContainerOverflowY = $JssorUtils$.$Css(_SlidesContainer, &quot;overflowY&quot;);
           if (slidesContainerOverflow != &quot;hidden&quot; &amp;&amp; (slidesContainerOverflowX != &quot;hidden&quot; || slidesContainerOverflowY != &quot;hidden&quot;))
               $JssorDebug$.$Fail(&quot;Overflow of slides container wrong specification, it should be specified as 'hidden' (style='overflow:hidden;').&quot;);
</PRE><PRE>           //var slidesContainerTop = $JssorUtils$.$CssTop(_SlidesContainer);
           //var slidesContainerLeft = $JssorUtils$.$CssLeft(_SlidesContainer);
</PRE><PRE>           //if (isNaN(slidesContainerTop))
           //    $JssorDebug$.$Fail(&quot;Top of slides container wrong specification, it should be specified by inline style in pixels (like style='top: 0px;').&quot;);
</PRE><PRE>           //if ($JssorUtils$.$IsUndefined(slidesContainerTop))
           //    $JssorDebug$.$Fail(&quot;Top of slides container not specified, it should be specified by inline style in pixels (like style='top: 0px;').&quot;);
</PRE><PRE>           //if (isNaN(slidesContainerLeft))
           //    $JssorDebug$.$Fail(&quot;Left of slides container wrong specification, it should be specified by inline style in pixels (like style='left: 0px;').&quot;);
</PRE><PRE>           //if ($JssorUtils$.$IsUndefined(slidesContainerLeft))
           //    $JssorDebug$.$Fail(&quot;Left of slides container not specified, it should be specified by inline style in pixels (like style='left: 0px;').&quot;);
       });
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (!$JssorUtils$.$IsNumeric(_Options.$DisplayPieces))
               $JssorDebug$.$Fail(&quot;Option $DisplayPieces error, it should be a numeric value and greater than or equal to 1.&quot;);
</PRE><PRE>           if (_Options.$DisplayPieces &lt; 1)
               $JssorDebug$.$Fail(&quot;Option $DisplayPieces error, it should be greater than or equal to 1.&quot;);
</PRE><PRE>           if (_Options.$DisplayPieces &gt; 1 &amp;&amp; _Options.$DragOrientation &amp;&amp; _Options.$DragOrientation != _PlayOrientation)
               $JssorDebug$.$Fail(&quot;Option $DragOrientation error, it should be 0 or the same of $PlayOrientation when $DisplayPieces is greater than 1.&quot;);
</PRE><PRE>           if (!$JssorUtils$.$IsNumeric(_Options.$ParkingPosition))
               $JssorDebug$.$Fail(&quot;Option $ParkingPosition error, it should be a numeric value.&quot;);
</PRE><PRE>           if (_Options.$ParkingPosition &amp;&amp; _Options.$DragOrientation &amp;&amp; _Options.$DragOrientation != _PlayOrientation)
               $JssorDebug$.$Fail(&quot;Option $DragOrientation error, it should be 0 or the same of $PlayOrientation when $ParkingPosition is not equal to 0.&quot;);
       });
</PRE><PRE>       var _StyleDef;
</PRE><PRE>       var _SlideElmts = [];
</PRE><PRE>       {
           var slideElmts = $JssorUtils$.$GetChildren(_SlidesContainer);
           $JssorUtils$.$Each(slideElmts, function (slideElmt) {
               if (slideElmt.tagName == &quot;DIV&quot; &amp;&amp; !$JssorUtils$.$GetAttributeEx(slideElmt, &quot;u&quot;)) {
                   _SlideElmts.push(slideElmt);
               }
           });
       }
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (_SlideElmts.length &lt; 1) {
               $JssorDebug$.$Error(&quot;Slides html code definition error, there must be at least 1 slide to initialize a slider.&quot;);
           }
       });
</PRE><PRE>       var _SlideItemCreatedCount = 0; //for debug only
       var _SlideItemReleasedCount = 0;    //for debug only
</PRE><PRE>       var _PreviousSlideIndex;
       var _CurrentSlideIndex = -1;
       var _TempSlideIndex;
       var _PrevSlideItem;
       var _CurrentSlideItem;
       var _SlideCount = _SlideElmts.length;
</PRE><PRE>       var _SlideWidth = _Options.$SlideWidth || _SlidesContainerWidth;
       var _SlideHeight = _Options.$SlideHeight || _SlidesContainerHeight;
</PRE><PRE>       var _SlideSpacing = _Options.$SlideSpacing;
       var _StepLengthX = _SlideWidth + _SlideSpacing;
       var _StepLengthY = _SlideHeight + _SlideSpacing;
       var _StepLength = (_PlayOrientation &amp; 1) ? _StepLengthX : _StepLengthY;
       var _DisplayPieces = Math.min(_Options.$DisplayPieces, _SlideCount);
</PRE><PRE>       var _SlideshowPanel;
       var _CurrentBoardIndex = 0;
       var _DragOrientation;
       var _DragOrientationRegistered;
       var _DragInvalid;
</PRE><PRE>       var _HandleTouchEventOnly;
</PRE><PRE>       var _Navigators = [];
       var _BulletNavigator;
       var _ArrowNavigator;
       var _ThumbnailNavigator;
</PRE><PRE>       var _ShowLink;
</PRE><PRE>       var _Frozen;
       var _AutoPlay;
       var _AutoPlaySteps = _Options.$AutoPlaySteps;
       var _HoverToPause = _Options.$PauseOnHover;
       var _AutoPlayInterval = _Options.$AutoPlayInterval;
       var _SlideDuration = _Options.$SlideDuration;
</PRE><PRE>       var _SlideshowRunnerClass;
       var _TransitionsOrder;
</PRE><PRE>       var _SlideshowEnabled;
       var _ParkingPosition;
       var _CarouselEnabled = _DisplayPieces &lt; _SlideCount;
       var _Loop = _CarouselEnabled ? _Options.$Loop : 0;
</PRE><PRE>       var _DragEnabled;
       var _LastDragSucceded;
</PRE><PRE>       var _HoverStatus = 1;   //0 Hovering, 1 Not hovering
</PRE><PRE>       //Variable Definition
       var _IsSliding;
       var _IsDragging;
       var _LoadingTicket;
</PRE><PRE>       //The X position of mouse/touch when a drag start
       var _DragStartMouseX = 0;
       //The Y position of mouse/touch when a drag start
       var _DragStartMouseY = 0;
       var _DragOffsetTotal;
       var _DragOffsetLastTime;
       var _DragIndexAdjust;
</PRE><PRE>       var _Carousel;
       var _Conveyor;
       var _Slideshow;
       var _CarouselPlayer;
       var _SlideContainer = new SlideContainer();
       var _ScaleRatio;
</PRE><PRE>       //$JssorSlider$ Constructor
       {
           _AutoPlay = _Options.$AutoPlay;
           _SelfSlider.$Options = options;
</PRE><PRE>           AdjustSlidesContainerSize();
</PRE><PRE>           elmt[&quot;jssor-slider&quot;] = true;
</PRE><PRE>           //_SlideshowPanel = CreatePanel();
           //$JssorUtils$.$CssZIndex(elmt, $JssorUtils$.$CssZIndex(elmt));
           //$JssorUtils$.$CssLeft(_SlideshowPanel, $JssorUtils$.$CssLeft(_SlidesContainer));
           //$JssorUtils$.$CssZIndex(_SlidesContainer, $JssorUtils$.$CssZIndex(_SlidesContainer));
           //$JssorUtils$.$CssTop(_SlideshowPanel, $JssorUtils$.$CssTop(_SlidesContainer));
           $JssorUtils$.$CssZIndex(_SlidesContainer, $JssorUtils$.$CssZIndex(_SlidesContainer) || 0);
           $JssorUtils$.$CssPosition(_SlidesContainer, &quot;absolute&quot;);
           _SlideshowPanel = $JssorUtils$.$CloneNode(_SlidesContainer);
           $JssorUtils$.$InsertBefore($JssorUtils$.$GetParentNode(_SlidesContainer), _SlideshowPanel, _SlidesContainer);
</PRE><PRE>           if (_SlideshowOptions) {
               _ShowLink = _SlideshowOptions.$ShowLink;
               _SlideshowRunnerClass = _SlideshowOptions.$Class;
</PRE><PRE>               $JssorDebug$.$Execute(function () {
                   if (!_SlideshowOptions.$Transitions || !_SlideshowOptions.$Transitions.length) {
                       $JssorDebug$.$Error(&quot;Invalid '$SlideshowOptions', no '$Transitions' specified.&quot;);
                   }
               });
</PRE><PRE>               _SlideshowEnabled = _DisplayPieces == 1 &amp;&amp; _SlideCount &gt; 1 &amp;&amp; _SlideshowRunnerClass &amp;&amp; (!$JssorUtils$.$IsBrowserIE() || $JssorUtils$.$GetBrowserVersion() &gt;= 8);
           }
</PRE><PRE>           _ParkingPosition = (_SlideshowEnabled || _DisplayPieces&gt;= _SlideCount || !(_Loop &amp; 1)) ? 0 : _Options.$ParkingPosition;
</PRE><PRE>           _DragEnabled = ((_DisplayPieces &gt; 1 || _ParkingPosition) ? _PlayOrientation : -1) &amp; _Options.$DragOrientation;
</PRE><PRE>           //SlideBoard
           var _SlideboardElmt = _SlidesContainer;
           var _SlideItems = [];
</PRE><PRE>           var _SlideshowRunner;
           var _LinkContainer;
</PRE><PRE>           var _DownEvent = &quot;mousedown&quot;;
           var _MoveEvent = &quot;mousemove&quot;;
           var _UpEvent = &quot;mouseup&quot;;
           var _CancelEvent;
</PRE><PRE>           var _LastTimeMoveByDrag;
           var _DragStartPosition;
           var _DragStart_CarouselPlaying;
           var _DragStartPlayToPosition;
           var _PositionToGoByDrag;
</PRE><PRE>           //SlideBoard Constructor
           {
</PRE><PRE>               if (window.navigator.msPointerEnabled) {
</PRE><PRE>                   _DownEvent = &quot;MSPointerDown&quot;;
                   _MoveEvent = &quot;MSPointerMove&quot;;
                   _UpEvent = &quot;MSPointerUp&quot;;
                   _CancelEvent = &quot;MSPointerCancel&quot;;
</PRE><PRE>                   if (_DragEnabled) {
                       var touchAction = &quot;none&quot;;
                       if (_DragEnabled == 1) {
                           touchAction = &quot;pan-y&quot;;
                       }
                       else if (_DragEnabled == 2) {
                           touchAction = &quot;pan-x&quot;;
                       }
</PRE><PRE>                       $JssorUtils$.$SetAttribute(_SlideboardElmt.style, &quot;-ms-touch-action&quot;, touchAction);
                   }
               }
               else if (&quot;ontouchstart&quot; in window || &quot;createTouch&quot; in document) {
                   _HandleTouchEventOnly = true;
</PRE><PRE>                   _DownEvent = &quot;touchstart&quot;;
                   _MoveEvent = &quot;touchmove&quot;;
                   _UpEvent = &quot;touchend&quot;;
                   _CancelEvent = &quot;touchcancel&quot;;
               }
</PRE><PRE>               _Slideshow = new Slideshow();
</PRE><PRE>               if (_SlideshowEnabled)
                   _SlideshowRunner = new _SlideshowRunnerClass(_SlideContainer, _SlideWidth, _SlideHeight, _SlideshowOptions, _HandleTouchEventOnly);
</PRE><PRE>               $JssorUtils$.$AppendChild(_SlideshowPanel, _Slideshow.$Wrapper);
               $JssorUtils$.$CssOverflow(_SlidesContainer, &quot;hidden&quot;);
</PRE><PRE>               //link container
               {
                   _LinkContainer = CreatePanel();
                   $JssorUtils$.$Css(_LinkContainer, &quot;backgroundColor&quot;, &quot;#000&quot;);
                   $JssorUtils$.$CssOpacity(_LinkContainer, 0);
                   $JssorUtils$.$InsertBefore(_SlideboardElmt, _LinkContainer, _SlideboardElmt.firstChild);
               }
</PRE><PRE>               for (var i = 0; i &lt; _SlideElmts.length; i++) {
                   var slideElmt = _SlideElmts[i];
                   var slideItem = new SlideItem(slideElmt, i);
                   _SlideItems.push(slideItem);
               }
</PRE><PRE>               $JssorUtils$.$HideElement(_LoadingContainer);
</PRE><PRE>               $JssorDebug$.$Execute(function () {
                   $JssorUtils$.$SetAttribute(_LoadingContainer, &quot;debug-id&quot;, &quot;loading-container&quot;);
               });
</PRE><PRE>               _Carousel = new Carousel()
               _CarouselPlayer = new CarouselPlayer(_Carousel, _Slideshow);
</PRE><PRE>               $JssorDebug$.$Execute(function () {
                   $JssorUtils$.$SetAttribute(_SlideboardElmt, &quot;debug-id&quot;, &quot;slide-board&quot;);
               });
</PRE><PRE>               if (_DragEnabled) {
                   $JssorUtils$.$AddEvent(_SlidesContainer, _DownEvent, OnMouseDown);
                   $JssorUtils$.$AddEvent(document, _UpEvent, OnDragEnd);
                   _CancelEvent &amp;&amp; $JssorUtils$.$AddEvent(document, _CancelEvent, OnDragEnd);
               }
           }
           //SlideBoard
</PRE><PRE>           _HoverToPause &amp;= _HandleTouchEventOnly ? 2 : 1;
</PRE><PRE>           //Bullet Navigator
           if (_NavigatorContainer &amp;&amp; _BulletNavigatorOptions) {
               _BulletNavigator = new _BulletNavigatorOptions.$Class(_NavigatorContainer, _BulletNavigatorOptions);
               _Navigators.push(_BulletNavigator);
           }
</PRE><PRE>           //Arrow Navigator
           if (_ArrowNavigatorOptions &amp;&amp; _ArrowLeft &amp;&amp; _ArrowRight) {
               _ArrowNavigator = new _ArrowNavigatorOptions.$Class(_ArrowLeft, _ArrowRight, _ArrowNavigatorOptions);
               _Navigators.push(_ArrowNavigator);
           }
</PRE><PRE>           //Thumbnail Navigator
           if (_ThumbnailNavigatorContainer &amp;&amp; _ThumbnailNavigatorOptions) {
               _ThumbnailNavigatorOptions.$StartIndex = _Options.$StartIndex;
               _ThumbnailNavigator = new _ThumbnailNavigatorOptions.$Class(_ThumbnailNavigatorContainer, _ThumbnailNavigatorOptions);
               _Navigators.push(_ThumbnailNavigator);
           }
</PRE><PRE>           $JssorUtils$.$Each(_Navigators, function (navigator) {
               navigator.$Reset(_SlideCount, _SlideItems, _LoadingContainer);
               navigator.$On($JssorNavigatorEvents$.$NAVIGATIONREQUEST, NavigationClickHandler);
           });
</PRE><PRE>           _SelfSlider.$SetScaleWidth(_SelfSlider.$GetOriginalWidth());
</PRE><PRE>           $JssorUtils$.$AddEvent(elmt, &quot;mouseout&quot;, MainContainerMouseOutEventHandler);
           $JssorUtils$.$AddEvent(elmt, &quot;mouseover&quot;, MainContainerMouseOverEventHandler);
</PRE><PRE>           ShowNavigators();
</PRE><PRE>           //Keyboard Navigation
           if (_Options.$ArrowKeyNavigation) {
               $JssorUtils$.$AddEvent(document, &quot;keydown&quot;, function (e) {
                   if (e.keyCode == $JssorKeyCode$.$LEFT) {
                       //Arrow Left
                       PlayToOffset(-1);
                   }
                   else if (e.keyCode == $JssorKeyCode$.$RIGHT) {
                       //Arrow Right
                       PlayToOffset(1);
                   }
               });
           }
</PRE><PRE>           var startPosition = _Options.$StartIndex;
           if (!(_Loop &amp; 1)) {
               startPosition = Math.max(0, Math.min(startPosition, _SlideCount - _DisplayPieces));
           }
           _CarouselPlayer.$PlayCarousel(startPosition, startPosition, 0);
       }
   }
   //Jssor Slider
</PRE><PRE>   //JssorSlider.$ASSEMBLY_BOTTOM_LEFT = ASSEMBLY_BOTTOM_LEFT;
   //JssorSlider.$ASSEMBLY_BOTTOM_RIGHT = ASSEMBLY_BOTTOM_RIGHT;
   //JssorSlider.$ASSEMBLY_TOP_LEFT = ASSEMBLY_TOP_LEFT;
   //JssorSlider.$ASSEMBLY_TOP_RIGHT = ASSEMBLY_TOP_RIGHT;
   //JssorSlider.$ASSEMBLY_LEFT_TOP = ASSEMBLY_LEFT_TOP;
   //JssorSlider.$ASSEMBLY_LEFT_BOTTOM = ASSEMBLY_LEFT_BOTTOM;
   //JssorSlider.$ASSEMBLY_RIGHT_TOP = ASSEMBLY_RIGHT_TOP;
   //JssorSlider.$ASSEMBLY_RIGHT_BOTTOM = ASSEMBLY_RIGHT_BOTTOM;
</PRE><PRE>   JssorSlider.$EVT_CLICK = 21;
   JssorSlider.$EVT_DRAG_START = 22;
   JssorSlider.$EVT_DRAG_END = 23;
   JssorSlider.$EVT_SWIPE_START = 24;
   JssorSlider.$EVT_SWIPE_END = 25;
</PRE><PRE>   JssorSlider.$EVT_LOAD_START = 26;
   JssorSlider.$EVT_LOAD_END = 27;
</PRE><PRE>   JssorSlider.$EVT_POSITION_CHANGE = 202;
   JssorSlider.$EVT_PARK = 203;
</PRE><PRE>   JssorSlider.$EVT_SLIDESHOW_START = 206;
   JssorSlider.$EVT_SLIDESHOW_END = 207;
</PRE><PRE>   JssorSlider.$EVT_PROGRESS_CHANGE = 208;
   JssorSlider.$EVT_STATE_CHANGE = 209;
   JssorSlider.$EVT_ROLLBACK_START = 210;
   JssorSlider.$EVT_ROLLBACK_END = 211;
</PRE><PRE>   window.$JssorSlider$ = $JssorSlider$ = JssorSlider;
</PRE><PRE>   //(function ($) {
   //    jQuery.fn.jssorSlider = function (options) {
   //        return this.each(function () {
   //            return $(this).data('jssorSlider') || $(this).data('jssorSlider', new JssorSlider(this, options));
   //        });
   //    };
   //})(jQuery);
</PRE><PRE>   //window.jQuery &amp;&amp; (jQuery.fn.jssorSlider = function (options) {
   //    return this.each(function () {
   //        return jQuery(this).data('jssorSlider') || jQuery(this).data('jssorSlider', new JssorSlider(this, options));
   //    });
   //});
</PRE><P>};
</P><P>//$JssorBulletNavigator$
var $JssorNavigatorEvents$ = {
</P><PRE>   $NAVIGATIONREQUEST: 1,
   $INDEXCHANGE: 2,
   $RESET: 3
</PRE><P>};
</P><P>var $JssorBulletNavigator$ = window.$JssorBulletNavigator$ = function (elmt, options) {
</P><PRE>   var self = this;
   $JssorEventManager$.call(self);
</PRE><PRE>   elmt = $JssorUtils$.$GetElement(elmt);
</PRE><PRE>   var _Count;
   var _Length;
   var _Width;
   var _Height;
   var _CurrentIndex;
   var _CurrentInnerIndex = 0;
   var _Options;
   var _Steps;
   var _Lanes;
   var _SpacingX;
   var _SpacingY;
   var _Orientation;
   var _ItemPrototype;
   var _PrototypeWidth;
   var _PrototypeHeight;
</PRE><PRE>   var _ButtonElements = [];
   var _Buttons = [];
</PRE><PRE>   function Highlight(index) {
       if (index != -1)
           _Buttons[index].$Activate(index == _CurrentInnerIndex);
   }
</PRE><PRE>   function OnNavigationRequest(index) {
       self.$TriggerEvent($JssorNavigatorEvents$.$NAVIGATIONREQUEST, index * _Steps);
   }
</PRE><PRE>   self.$Elmt = elmt;
   self.$GetCurrentIndex = function () {
       return _CurrentIndex;
   };
</PRE><PRE>   self.$SetCurrentIndex = function (index) {
       if (index != _CurrentIndex) {
           var lastInnerIndex = _CurrentInnerIndex;
           var innerIndex = Math.floor(index / _Steps);
           _CurrentInnerIndex = innerIndex;
           _CurrentIndex = index;
</PRE><PRE>           Highlight(lastInnerIndex);
           Highlight(innerIndex);
</PRE><PRE>           //self.$TriggerEvent($JssorNavigatorEvents$.$INDEXCHANGE, index);
       }
   };
</PRE><PRE>   self.$Show = function (show) {
       $JssorUtils$.$ShowElement(elmt, show);
   };
</PRE><PRE>   var _Located;
   self.$Relocate = function (force) {
       if (!_Located || _Options.$Scale == false) {
           if (_Options.$AutoCenter &amp; 1) {
               $JssorUtils$.$CssLeft(elmt, ($JssorUtils$.$CssWidth($JssorUtils$.$GetParentNode(elmt)) - _Width) / 2);
           }
           if (_Options.$AutoCenter &amp; 2) {
               $JssorUtils$.$CssTop(elmt, ($JssorUtils$.$CssHeight($JssorUtils$.$GetParentNode(elmt)) - _Height) / 2);
           }
           
           _Located = true;
       }
   };
</PRE><PRE>   var _Initialized;
   self.$Reset = function (length) {
       if (!_Initialized) {
           _Length = length;
           _Count = Math.ceil(length / _Steps);
           _CurrentInnerIndex = 0;
</PRE><PRE>           var itemOffsetX = _PrototypeWidth + _SpacingX;
           var itemOffsetY = _PrototypeHeight + _SpacingY;
</PRE><PRE>           var maxIndex = Math.ceil(_Count / _Lanes) - 1;
</PRE><PRE>           _Width = _PrototypeWidth + itemOffsetX * (!_Orientation ? maxIndex : _Lanes - 1);
           _Height = _PrototypeHeight + itemOffsetY * (_Orientation ? maxIndex : _Lanes - 1);
</PRE><PRE>           $JssorUtils$.$CssWidth(elmt, _Width);
           $JssorUtils$.$CssHeight(elmt, _Height);
</PRE><PRE>           //self.$Relocate(true);
</PRE><PRE>           for (var buttonIndex = 0; buttonIndex &lt; _Count; buttonIndex++) {
</PRE><PRE>               var numberDiv = $JssorUtils$.$CreateSpanElement();
               $JssorUtils$.$SetInnerText(numberDiv, buttonIndex + 1);
</PRE><PRE>               var div = $JssorUtils$.$BuildElement(_ItemPrototype, &quot;NumberTemplate&quot;, numberDiv, true);
               $JssorUtils$.$CssPosition(div, &quot;absolute&quot;);
</PRE><PRE>               var columnIndex = buttonIndex % (maxIndex + 1);
               $JssorUtils$.$CssLeft(div, !_Orientation ? itemOffsetX * columnIndex : buttonIndex % _Lanes * itemOffsetX);
               $JssorUtils$.$CssTop(div, _Orientation ? itemOffsetY * columnIndex : Math.floor(buttonIndex / (maxIndex + 1)) * itemOffsetY);
</PRE><PRE>               $JssorUtils$.$AppendChild(elmt, div);
               _ButtonElements[buttonIndex] = div;
</PRE><PRE>               if (_Options.$ActionMode &amp; 1)
                   $JssorUtils$.$AddEvent(div, &quot;click&quot;, $JssorUtils$.$CreateCallback(null, OnNavigationRequest, buttonIndex));
</PRE><PRE>               if (_Options.$ActionMode &amp; 2)
                   $JssorUtils$.$AddEvent(div, &quot;mouseover&quot;, $JssorUtils$.$CreateCallback(null, OnNavigationRequest, buttonIndex));
</PRE><PRE>               _Buttons[buttonIndex] = $JssorUtils$.$Buttonize(div);
           }
</PRE><PRE>           //self.$TriggerEvent($JssorNavigatorEvents$.$RESET);
           _Initialized = true;
       }
   };
</PRE><PRE>   //JssorBulletNavigator Constructor
   {
       self.$Options = _Options = $JssorUtils$.$Extend({
           $SpacingX: 0,
           $SpacingY: 0,
           $Orientation: 1,
           $ActionMode: 1
       }, options);
</PRE><PRE>       //Sodo statement for development time intellisence only
       $JssorDebug$.$Execute(function () {
           _Options = $JssorUtils$.$Extend({
               $Steps: undefined,
               $Lanes: undefined
           }, _Options);
       });
</PRE><PRE>       _ItemPrototype = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;prototype&quot;);
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (!_ItemPrototype)
               $JssorDebug$.$Fail(&quot;Navigator item prototype not defined.&quot;);
</PRE><PRE>           if (isNaN($JssorUtils$.$CssWidth(_ItemPrototype))) {
               $JssorDebug$.$Fail(&quot;Width of 'navigator item prototype' not specified.&quot;);
           }
</PRE><PRE>           if (isNaN($JssorUtils$.$CssHeight(_ItemPrototype))) {
               $JssorDebug$.$Fail(&quot;Height of 'navigator item prototype' not specified.&quot;);
           }
       });
</PRE><PRE>       _PrototypeWidth = $JssorUtils$.$CssWidth(_ItemPrototype);
       _PrototypeHeight = $JssorUtils$.$CssHeight(_ItemPrototype);
</PRE><PRE>       $JssorUtils$.$RemoveChild(elmt, _ItemPrototype);
</PRE><PRE>       _Steps = _Options.$Steps || 1;
       _Lanes = _Options.$Lanes || 1;
       _SpacingX = _Options.$SpacingX;
       _SpacingY = _Options.$SpacingY;
       _Orientation = _Options.$Orientation - 1;
   }
</PRE><P>};
</P><P>var $JssorArrowNavigator$ = window.$JssorArrowNavigator$ = function (arrowLeft, arrowRight, options) {
</P><PRE>   var self = this;
   $JssorEventManager$.call(self);
</PRE><PRE>   $JssorDebug$.$Execute(function () {
       //var arrowLeft = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;arrowleft&quot;, null, uiSearchMode);
       //var arrowRight = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;arrowright&quot;, null, uiSearchMode);
</PRE><PRE>       if (!arrowLeft)
           $JssorDebug$.$Fail(&quot;Option '$ArrowNavigatorOptions' spepcified, but UI 'arrowleft' not defined. Define 'arrowleft' to enable direct navigation, or remove option '$ArrowNavigatorOptions' to disable direct navigation.&quot;);
</PRE><PRE>       if (!arrowRight)
           $JssorDebug$.$Fail(&quot;Option '$ArrowNavigatorOptions' spepcified, but UI 'arrowright' not defined. Define 'arrowright' to enable direct navigation, or remove option '$ArrowNavigatorOptions' to disable direct navigation.&quot;);
</PRE><PRE>       if (isNaN($JssorUtils$.$CssWidth(arrowLeft))) {
           $JssorDebug$.$Fail(&quot;Width of 'arrow left' not specified.&quot;);
       }
</PRE><PRE>       if (isNaN($JssorUtils$.$CssWidth(arrowRight))) {
           $JssorDebug$.$Fail(&quot;Width of 'arrow right' not specified.&quot;);
       }
</PRE><PRE>       if (isNaN($JssorUtils$.$CssHeight(arrowLeft))) {
           $JssorDebug$.$Fail(&quot;Height of 'arrow left' not specified.&quot;);
       }
</PRE><PRE>       if (isNaN($JssorUtils$.$CssHeight(arrowRight))) {
           $JssorDebug$.$Fail(&quot;Height of 'arrow right' not specified.&quot;);
       }
   });
</PRE><PRE>   //var arrowLeft = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;arrowleft&quot;, null, uiSearchMode);
   //var arrowRight = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;arrowright&quot;, null, uiSearchMode);
   var _Length;
   var _CurrentIndex;
   var _Options;
   var _Steps;
   var _ParentNode = $JssorUtils$.$GetParentNode(arrowLeft);
   var _ArrowWidth = $JssorUtils$.$CssWidth(arrowLeft);
   var _ArrowHeight = $JssorUtils$.$CssHeight(arrowLeft);
</PRE><PRE>   function OnNavigationRequest(steps) {
       self.$TriggerEvent($JssorNavigatorEvents$.$NAVIGATIONREQUEST, steps, true);
   }
</PRE><PRE>   self.$GetCurrentIndex = function () {
       return _CurrentIndex;
   };
</PRE><PRE>   self.$SetCurrentIndex = function (index, virtualIndex, temp) {
       if (temp) {
           _CurrentIndex = virtualIndex;
       }
       else {
           _CurrentIndex = index;
       }
       //self.$TriggerEvent($JssorNavigatorEvents$.$INDEXCHANGE, index);
   };
</PRE><PRE>   self.$Show = function (show) {
       $JssorUtils$.$ShowElement(arrowLeft, show);
       $JssorUtils$.$ShowElement(arrowRight, show);
   };
</PRE><PRE>   var _Located;
   self.$Relocate = function (force) {
       if (!_Located || _Options.$Scale == false) {
</PRE><PRE>           var containerWidth = $JssorUtils$.$CssWidth(_ParentNode);
           var containerHeight = $JssorUtils$.$CssHeight(_ParentNode);
</PRE><PRE>           if (_Options.$AutoCenter &amp; 1) {
               $JssorUtils$.$CssLeft(arrowLeft, (containerWidth - _ArrowWidth) / 2);
               $JssorUtils$.$CssLeft(arrowRight, (containerWidth - _ArrowWidth) / 2);
           }
</PRE><PRE>           if (_Options.$AutoCenter &amp; 2) {
               $JssorUtils$.$CssTop(arrowLeft, (containerHeight - _ArrowHeight) / 2);
               $JssorUtils$.$CssTop(arrowRight, (containerHeight - _ArrowHeight) / 2);
           }
</PRE><PRE>           _Located = true;
       }
   };
</PRE><PRE>   var _Initialized;
   self.$Reset = function (length) {
       _Length = length;
       _CurrentIndex = 0;
</PRE><PRE>       if (!_Initialized) {
</PRE><PRE>           //self.$Relocate(true);
</PRE><PRE>           $JssorUtils$.$AddEvent(arrowLeft, &quot;click&quot;, $JssorUtils$.$CreateCallback(null, OnNavigationRequest, -_Steps));
           $JssorUtils$.$AddEvent(arrowRight, &quot;click&quot;, $JssorUtils$.$CreateCallback(null, OnNavigationRequest, _Steps));
</PRE><PRE>           $JssorUtils$.$Buttonize(arrowLeft);
           $JssorUtils$.$Buttonize(arrowRight);
</PRE><PRE>           _Initialized = true;
       }
</PRE><PRE>       //self.$TriggerEvent($JssorNavigatorEvents$.$RESET);
   };
</PRE><PRE>   //JssorArrowNavigator Constructor
   {
       self.$Options = _Options = $JssorUtils$.$Extend({
           $Steps: 1
       }, options);
</PRE><PRE>       _Steps = _Options.$Steps;
   }
</PRE><P>};
</P><P>//$JssorThumbnailNavigator$
var $JssorThumbnailNavigator$ = window.$JssorThumbnailNavigator$ = function (elmt, options) {
</P><PRE>   var _Self = this;
   var _Length;
   var _Count;
   var _CurrentIndex;
   var _Options;
   var _NavigationItems = [];
</PRE><PRE>   var _Width;
   var _Height;
   var _Lanes;
   var _SpacingX;
   var _SpacingY;
   var _PrototypeWidth;
   var _PrototypeHeight;
   var _DisplayPieces;
</PRE><PRE>   var _Slider;
   var _CurrentMouseOverIndex = -1;
</PRE><PRE>   var _SlidesContainer;
   var _ThumbnailPrototype;
</PRE><PRE>   $JssorEventManager$.call(_Self);
   elmt = $JssorUtils$.$GetElement(elmt);
</PRE><PRE>   function NavigationItem(item, index) {
       var self = this;
       var _Wrapper;
       var _Button;
       var _Thumbnail;
</PRE><PRE>       function Highlight(mouseStatus) {
           _Button.$Activate(_CurrentIndex == index);
       }
</PRE><PRE>       function OnNavigationRequest(event) {
           if (!_Slider.$LastDragSucceded()) {
               var tail = _Lanes - index % _Lanes;
               var slideVirtualIndex = _Slider.$GetVirtualIndex((index + tail) / _Lanes - 1);
               var itemVirtualIndex = slideVirtualIndex * _Lanes + _Lanes - tail;
               _Self.$TriggerEvent($JssorNavigatorEvents$.$NAVIGATIONREQUEST, itemVirtualIndex);
           }
       }
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           self.$Wrapper = undefined;
       });
</PRE><PRE>       self.$Index = index;
</PRE><PRE>       self.$Highlight = Highlight;
</PRE><PRE>       //NavigationItem Constructor
       {
           _Thumbnail = item.$Thumb || item.$Image || $JssorUtils$.$CreateDivElement();
           self.$Wrapper = _Wrapper = $JssorUtils$.$BuildElement(_ThumbnailPrototype, &quot;ThumbnailTemplate&quot;, _Thumbnail, true);
</PRE><PRE>           _Button = $JssorUtils$.$Buttonize(_Wrapper);
           if (_Options.$ActionMode &amp; 1)
               $JssorUtils$.$AddEvent(_Wrapper, &quot;click&quot;, OnNavigationRequest);
           if (_Options.$ActionMode &amp; 2)
               $JssorUtils$.$AddEvent(_Wrapper, &quot;mouseover&quot;, OnNavigationRequest);
       }
   }
</PRE><PRE>   _Self.$GetCurrentIndex = function () {
       return _CurrentIndex;
   };
</PRE><PRE>   _Self.$SetCurrentIndex = function (index, virtualIndex, temp) {
       var oldIndex = _CurrentIndex;
       _CurrentIndex = index;
       if (oldIndex != -1)
           _NavigationItems[oldIndex].$Highlight();
       _NavigationItems[index].$Highlight();
</PRE><PRE>       if (!temp) {
           _Slider.$PlayTo(_Slider.$GetVirtualIndex(Math.floor(virtualIndex / _Lanes)));
       }
   };
</PRE><PRE>   _Self.$Show = function (show) {
       $JssorUtils$.$ShowElement(elmt, show);
   };
</PRE><PRE>   _Self.$Relocate = $JssorUtils$.$EmptyFunction;
</PRE><PRE>   var _Initialized;
   _Self.$Reset = function (length, items, loadingContainer) {
       if (!_Initialized) {
           _Length = length;
           _Count = Math.ceil(_Length / _Lanes);
           _CurrentIndex = -1;
           _DisplayPieces = Math.min(_DisplayPieces, items.length);
</PRE><PRE>           var horizontal = _Options.$Orientation &amp; 1;
</PRE><PRE>           var slideWidth = _PrototypeWidth + (_PrototypeWidth + _SpacingX) * (_Lanes - 1) * (1 - horizontal);
           var slideHeight = _PrototypeHeight + (_PrototypeHeight + _SpacingY) * (_Lanes - 1) * horizontal;
</PRE><PRE>           var slidesContainerWidth = slideWidth + (slideWidth + _SpacingX) * (_DisplayPieces - 1) * horizontal;
           var slidesContainerHeight = slideHeight + (slideHeight + _SpacingY) * (_DisplayPieces - 1) * (1 - horizontal);
</PRE><PRE>           $JssorUtils$.$CssPosition(_SlidesContainer, &quot;absolute&quot;);
           $JssorUtils$.$CssOverflow(_SlidesContainer, &quot;hidden&quot;);
           if (_Options.$AutoCenter &amp; 1) {
               $JssorUtils$.$CssLeft(_SlidesContainer, (_Width - slidesContainerWidth) / 2);
           }
           if (_Options.$AutoCenter &amp; 2) {
               $JssorUtils$.$CssTop(_SlidesContainer, (_Height - slidesContainerHeight) / 2);
           }
           //$JssorDebug$.$Execute(function () {
           //    if (!_Options.$AutoCenter) {
           //        var slidesContainerTop = $JssorUtils$.$CssTop(_SlidesContainer);
           //        var slidesContainerLeft = $JssorUtils$.$CssLeft(_SlidesContainer);
</PRE><PRE>           //        if (isNaN(slidesContainerTop)) {
</PRE>
            //            $JssorDebug$.$Fail(&quot;Position 'top' wrong specification of thumbnail navigator slides container (<DIV>...<DIV>), \r\nwhen option $ThumbnailNavigatorOptions.$AutoCenter set to 0, it should be specified by inline style in pixels (like <DIV>)&quot;);
<PRE>           //        }
</PRE><PRE>           //        if (isNaN(slidesContainerLeft)) {
</PRE>
            //            $JssorDebug$.$Fail(&quot;Position 'left' wrong specification of thumbnail navigator slides container (<DIV>...<DIV>), \r\nwhen option $ThumbnailNavigatorOptions.$AutoCenter set to 0, it should be specified by inline style in pixels (like <DIV>)&quot;);
<PRE>           //        }
           //    }
           //});
           $JssorUtils$.$CssWidth(_SlidesContainer, slidesContainerWidth);
           $JssorUtils$.$CssHeight(_SlidesContainer, slidesContainerHeight);
</PRE><PRE>           var slideItemElmts = [];
           $JssorUtils$.$Each(items, function (item, index) {
               var navigationItem = new NavigationItem(item, index);
               var navigationItemWrapper = navigationItem.$Wrapper;
</PRE><PRE>               var columnIndex = Math.floor(index / _Lanes);
               var laneIndex = index % _Lanes;
</PRE><PRE>               $JssorUtils$.$CssLeft(navigationItemWrapper, (_PrototypeWidth + _SpacingX) * laneIndex * (1 - horizontal));
               $JssorUtils$.$CssTop(navigationItemWrapper, (_PrototypeHeight + _SpacingY) * laneIndex * horizontal);
</PRE><PRE>               if (!slideItemElmts[columnIndex]) {
                   slideItemElmts[columnIndex] = $JssorUtils$.$CreateDivElement();
                   $JssorUtils$.$AppendChild(_SlidesContainer, slideItemElmts[columnIndex]);
               }
</PRE><PRE>               $JssorUtils$.$AppendChild(slideItemElmts[columnIndex], navigationItemWrapper);
</PRE><PRE>               _NavigationItems.push(navigationItem);
           });
</PRE><PRE>           var thumbnailSliderOptions = $JssorUtils$.$Extend({
               $AutoPlay: false,
               $NaviQuitDrag: false,
               $SlideWidth: slideWidth,
               $SlideHeight: slideHeight,
               $SlideSpacing: _SpacingX * horizontal + _SpacingY * (1 - horizontal),
               $MinDragOffsetToSlide: 12,
               $SlideDuration: 200,
               $PauseOnHover: 1,
               $PlayOrientation: _Options.$Orientation,
               $DragOrientation: _Options.$DisableDrag ? 0 : _Options.$Orientation
           }, _Options);
</PRE><PRE>           _Slider = new $JssorSlider$(elmt, thumbnailSliderOptions);
</PRE><PRE>           _Initialized = true;
       }
</PRE><PRE>       //_Self.$TriggerEvent($JssorNavigatorEvents$.$RESET);
   };
</PRE><PRE>   //JssorThumbnailNavigator Constructor
   {
       _Self.$Options = _Options = $JssorUtils$.$Extend({
           $SpacingX: 3,
           $SpacingY: 3,
           $DisplayPieces: 1,
           $Orientation: 1,
           $AutoCenter: 3,
           $ActionMode: 1
       }, options);
</PRE><PRE>       //Sodo statement for development time intellisence only
       $JssorDebug$.$Execute(function () {
           _Options = $JssorUtils$.$Extend({
               $Lanes: undefined,
               $Width: undefined,
               $Height: undefined
           }, _Options);
       });
</PRE><PRE>       _Width = $JssorUtils$.$CssWidth(elmt);
       _Height = $JssorUtils$.$CssHeight(elmt);
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (!_Width)
               $JssorDebug$.$Fail(&quot;width of 'thumbnavigator' container not specified.&quot;);
           if (!_Height)
               $JssorDebug$.$Fail(&quot;height of 'thumbnavigator' container not specified.&quot;);
       });
</PRE><PRE>       _SlidesContainer = $JssorUtils$.$FindFirstChildByAttribute(elmt, &quot;slides&quot;);
       _ThumbnailPrototype = $JssorUtils$.$FindFirstChildByAttribute(_SlidesContainer, &quot;prototype&quot;);
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (!_ThumbnailPrototype)
               $JssorDebug$.$Fail(&quot;prototype of 'thumbnavigator' not defined.&quot;);
       });
</PRE><PRE>       _PrototypeWidth = $JssorUtils$.$CssWidth(_ThumbnailPrototype);
       _PrototypeHeight = $JssorUtils$.$CssHeight(_ThumbnailPrototype);
</PRE><PRE>       $JssorUtils$.$RemoveChild(_SlidesContainer, _ThumbnailPrototype);
</PRE><PRE>       _Lanes = _Options.$Lanes || 1;
       _SpacingX = _Options.$SpacingX;
       _SpacingY = _Options.$SpacingY;
       _DisplayPieces = _Options.$DisplayPieces;
   }
</PRE><P>};
</P><P>//$JssorCaptionSlider$
function $JssorCaptionSliderBase$() {
</P><PRE>   $JssorAnimator$.call(this, 0, 0);
   this.$Revert = $JssorUtils$.$EmptyFunction;
</PRE><P>}
</P><P>var $JssorCaptionSlider$ = window.$JssorCaptionSlider$ = function (container, captionSlideOptions, playIn) {
</P><PRE>   $JssorDebug$.$Execute(function () {
       if (!captionSlideOptions.$CaptionTransitions) {
           $JssorDebug$.$Error(&quot;'$CaptionSliderOptions' option error, '$CaptionSliderOptions.$CaptionTransitions' not specified.&quot;);
       }
       //else if (!$JssorUtils$.$IsArray(captionSlideOptions.$CaptionTransitions)) {
       //    $JssorDebug$.$Error(&quot;'$CaptionSliderOptions' option error, '$CaptionSliderOptions.$CaptionTransitions' is not an array.&quot;);
       //}
   });
</PRE><PRE>   var _Self = this;
   var _ImmediateOutCaptionHanger;
   var _PlayMode = playIn ? captionSlideOptions.$PlayInMode : captionSlideOptions.$PlayOutMode;
</PRE><PRE>   var _CaptionTransitions = captionSlideOptions.$CaptionTransitions;
   var _CaptionTuningFetcher = { $Transition: &quot;t&quot;, $Delay: &quot;d&quot;, $Duration: &quot;du&quot;, $ScaleHorizontal: &quot;x&quot;, $ScaleVertical: &quot;y&quot;, $Rotate: &quot;r&quot;, $Zoom: &quot;z&quot;, $Opacity: &quot;f&quot;, $BeginTime: &quot;b&quot; };
   var _CaptionTuningTransfer = {
       $Default: function (value, tuningValue) {
           if (!isNaN(tuningValue.$Value))
               value = tuningValue.$Value;
           else
               value *= tuningValue.$Percent;
</PRE><PRE>           return value;
       },
       $Opacity: function (value, tuningValue) {
           return this.$Default(value - 1, tuningValue);
       }
   };
   _CaptionTuningTransfer.$Zoom = _CaptionTuningTransfer.$Opacity;
</PRE><PRE>   $JssorAnimator$.call(_Self, 0, 0);
</PRE><PRE>   function GetCaptionItems(element, level) {
</PRE><PRE>       var itemsToPlay = [];
       var lastTransitionName;
       var namedTransitions = [];
       var namedTransitionOrders = [];
</PRE><PRE>       //$JssorDebug$.$Execute(function () {
</PRE><PRE>       //    var debugInfoElement = $JssorUtils$.$GetElement(&quot;debugInfo&quot;);
</PRE><PRE>       //    if (debugInfoElement &amp;&amp; playIn) {
</PRE><PRE>       //        var text = $JssorUtils$.$GetInnerHtml(debugInfoElement) + &quot;&quot;;
</PRE><PRE>       //        $JssorUtils$.$SetInnerHtml(debugInfoElement, text);
       //    }
       //});
</PRE><PRE>       function FetchRawTransition(captionElmt, index) {
           var rawTransition = {};
</PRE><PRE>           $JssorUtils$.$Each(_CaptionTuningFetcher, function (fetchAttribute, fetchProperty) {
               var attributeValue = $JssorUtils$.$GetAttributeEx(captionElmt, fetchAttribute + (index || &quot;&quot;));
               if (attributeValue) {
                   var propertyValue = {};
</PRE><PRE>                   if (fetchAttribute == &quot;t&quot;) {
                       //if (($JssorUtils$.$IsBrowserChrome() || $JssorUtils$.$IsBrowserSafari() || $JssorUtils$.$IsBrowserFireFox()) &amp;&amp; attributeValue == &quot;*&quot;) {
                       //    attributeValue = Math.floor(Math.random() * captionSlideOptions.$CaptionTransitions.length);
                       //    $JssorUtils$.$SetAttribute(captionElmt, fetchAttribute + (index || &quot;&quot;), attributeValue);
                       //}
</PRE><PRE>                       propertyValue.$Value = attributeValue;
                   }
                   else if (attributeValue.indexOf(&quot;%&quot;) + 1)
                       propertyValue.$Percent = $JssorUtils$.$ParseFloat(attributeValue) / 100;
                   else
                       propertyValue.$Value = $JssorUtils$.$ParseFloat(attributeValue);
</PRE><PRE>                   rawTransition[fetchProperty] = propertyValue;
               }
           });
</PRE><PRE>           return rawTransition;
       }
</PRE><PRE>       function GetRandomTransition() {
           //return _CaptionTransitions.length &amp;&amp; _CaptionTransitions[Math.floor(Math.random() * 42737 / (i + 1)) % _CaptionTransitions.length];
           return _CaptionTransitions[Math.floor(Math.random() * _CaptionTransitions.length)];
       }
</PRE><PRE>       function EvaluateCaptionTransition(transitionName) {
</PRE><PRE>           var transition;
</PRE><PRE>           if (transitionName == &quot;*&quot;) {
               transition = GetRandomTransition();
           }
           else if (transitionName) {
</PRE><PRE>               //indexed transition allowed, just the same as named transition
               var tempTransition = _CaptionTransitions[$JssorUtils$.$ParseInt(transitionName)] || _CaptionTransitions[transitionName];
</PRE><PRE>               if ($JssorUtils$.$IsArray(tempTransition)) {
                   if (transitionName != lastTransitionName) {
                       lastTransitionName = transitionName;
                       namedTransitionOrders[transitionName] = 0;
</PRE><PRE>                       namedTransitions[transitionName] = tempTransition[Math.floor(Math.random() * tempTransition.length)];
                   }
                   else {
                       namedTransitionOrders[transitionName]++;
                   }
</PRE><PRE>                   tempTransition = namedTransitions[transitionName];
</PRE><PRE>                   if ($JssorUtils$.$IsArray(tempTransition)) {
                       tempTransition = tempTransition.length &amp;&amp; tempTransition[namedTransitionOrders[transitionName] % tempTransition.length];
</PRE><PRE>                       if ($JssorUtils$.$IsArray(tempTransition)) {
                           //got transition from array level 3, random for all captions
                           tempTransition = tempTransition[Math.floor(Math.random() * tempTransition.length)];
                       }
                       //else {
                       //    //got transition from array level 2, in sequence for all adjacent captions with same name specified
                       //    transition = tempTransition;
                       //}
                   }
                   //else {
                   //    //got transition from array level 1, random but same for all adjacent captions with same name specified
                   //    transition = tempTransition;
                   //}
               }
               //else {
               //    //got transition directly from a simple transition object
               //    transition = tempTransition;
               //}
</PRE><PRE>               transition = tempTransition;
</PRE><PRE>               if ($JssorUtils$.$IsString(transition))
                   transition = EvaluateCaptionTransition(transition);
           }
</PRE><PRE>           return transition;
       }
</PRE><PRE>       var captionElmts = $JssorUtils$.$GetChildren(element);
       $JssorUtils$.$Each(captionElmts, function (captionElmt, i) {
</PRE><PRE>           var transitionsWithTuning = [];
           transitionsWithTuning.$Elmt = captionElmt;
           var isCaption = $JssorUtils$.$GetAttributeEx(captionElmt, &quot;u&quot;) == &quot;caption&quot;;
</PRE><PRE>           $JssorUtils$.$Each(playIn ? [0, 3] : [2], function (j, k) {
</PRE><PRE>               if (isCaption) {
                   var transition;
                   var rawTransition;
</PRE><PRE>                   if (j != 2 || !$JssorUtils$.$GetAttributeEx(captionElmt, &quot;t3&quot;)) {
                       rawTransition = FetchRawTransition(captionElmt, j);
</PRE><PRE>                       if (j == 2 &amp;&amp; !rawTransition.$Transition) {
                           rawTransition.$Delay = rawTransition.$Delay || { $Value: 0 };
                           rawTransition = $JssorUtils$.$Extend(FetchRawTransition(captionElmt, 0), rawTransition);
                       }
                   }
</PRE><PRE>                   if (rawTransition &amp;&amp; rawTransition.$Transition) {
</PRE><PRE>                       transition = EvaluateCaptionTransition(rawTransition.$Transition.$Value);
</PRE><PRE>                       if (transition) {
</PRE><PRE>                           var transitionWithTuning = $JssorUtils$.$Extend({ $Delay: 0, $ScaleHorizontal: 1, $ScaleVertical: 1 }, transition);
</PRE><PRE>                           $JssorUtils$.$Each(rawTransition, function (rawPropertyValue, propertyName) {
                               var tuningPropertyValue = (_CaptionTuningTransfer[propertyName] || _CaptionTuningTransfer.$Default).apply(_CaptionTuningTransfer, [transitionWithTuning[propertyName], rawTransition[propertyName]]);
                               if (!isNaN(tuningPropertyValue))
                                   transitionWithTuning[propertyName] = tuningPropertyValue;
                           });
</PRE><PRE>                           if (!k) {
                               if (rawTransition.$BeginTime)
                                   transitionWithTuning.$BeginTime = rawTransition.$BeginTime.$Value || 0;
                               else if ((_PlayMode) &amp; 2)
                                   transitionWithTuning.$BeginTime = 0;
                           }
                       }
                   }
</PRE><PRE>                   transitionsWithTuning.push(transitionWithTuning);
               }
</PRE><PRE>               if ((level % 2) &amp;&amp; !k) {
                   //transitionsWithTuning.$Children = GetCaptionItems(captionElmt, lastTransitionName, [].concat(namedTransitions), [].concat(namedTransitionOrders), level + 1);
                   transitionsWithTuning.$Children = GetCaptionItems(captionElmt, level + 1);
               }
           });
</PRE><PRE>           itemsToPlay.push(transitionsWithTuning);
       });
</PRE><PRE>       return itemsToPlay;
   }
</PRE><PRE>   function CreateAnimator(item, transition, immediateOut) {
</PRE><PRE>       var animatorOptions = {
           $Easing: transition.$Easing,
           $Round: transition.$Round,
           $During: transition.$During,
           $Reverse: playIn &amp;&amp; !immediateOut,
           $Optimize: true
       };
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           animatorOptions.$CaptionAnimator = true;
       });
</PRE><PRE>       var captionItem = item;
       var captionParent = $JssorUtils$.$GetParentNode(item);
</PRE><PRE>       var captionItemWidth = $JssorUtils$.$CssWidth(captionItem);
       var captionItemHeight = $JssorUtils$.$CssHeight(captionItem);
       var captionParentWidth = $JssorUtils$.$CssWidth(captionParent);
       var captionParentHeight = $JssorUtils$.$CssHeight(captionParent);
</PRE><PRE>       var toStyles = {};
       var fromStyles = {};
       var scaleClip = transition.$ScaleClip || 1;
</PRE><PRE>       //Opacity
       if (transition.$Opacity) {
           toStyles.$Opacity = 2 - transition.$Opacity;
       }
</PRE><PRE>       animatorOptions.$OriginalWidth = captionItemWidth;
       animatorOptions.$OriginalHeight = captionItemHeight;
</PRE><PRE>       //Transform
       if (transition.$Zoom || transition.$Rotate) {
           toStyles.$Zoom = transition.$Zoom ? transition.$Zoom - 1 : 1;
</PRE><PRE>     if ($JssorUtils$.$IsBrowserIe9Earlier() || $JssorUtils$.$IsBrowserOpera())
               toStyles.$Zoom = Math.min(toStyles.$Zoom, 2);
</PRE><PRE>           fromStyles.$Zoom = 1;
</PRE><PRE>           var rotate = transition.$Rotate || 0;
           if (rotate == true)
               rotate = 1;
</PRE><PRE>           toStyles.$Rotate = rotate * 360;
           fromStyles.$Rotate = 0;
       }
           //Clip
       else if (transition.$Clip) {
           var fromStyleClip = { $Top: 0, $Right: captionItemWidth, $Bottom: captionItemHeight, $Left: 0 };
           var toStyleClip = $JssorUtils$.$Extend({}, fromStyleClip);
</PRE><PRE>           var blockOffset = toStyleClip.$Offset = {};
</PRE><PRE>           var topBenchmark = transition.$Clip &amp; 4;
           var bottomBenchmark = transition.$Clip &amp; 8;
           var leftBenchmark = transition.$Clip &amp; 1;
           var rightBenchmark = transition.$Clip &amp; 2;
</PRE><PRE>           if (topBenchmark &amp;&amp; bottomBenchmark) {
               blockOffset.$Top = captionItemHeight / 2 * scaleClip;
               blockOffset.$Bottom = -blockOffset.$Top;
           }
           else if (topBenchmark)
               blockOffset.$Bottom = -captionItemHeight * scaleClip;
           else if (bottomBenchmark)
               blockOffset.$Top = captionItemHeight * scaleClip;
</PRE><PRE>           if (leftBenchmark &amp;&amp; rightBenchmark) {
               blockOffset.$Left = captionItemWidth / 2 * scaleClip;
               blockOffset.$Right = -blockOffset.$Left;
           }
           else if (leftBenchmark)
               blockOffset.$Right = -captionItemWidth * scaleClip;
           else if (rightBenchmark)
               blockOffset.$Left = captionItemWidth * scaleClip;
</PRE><PRE>           animatorOptions.$Move = transition.$Move;
           toStyles.$Clip = toStyleClip;
           fromStyles.$Clip = fromStyleClip;
       }
</PRE><PRE>       //Fly
       {
           var direction = transition.$FlyDirection;
</PRE><PRE>           var toLeft = 0;
           var toTop = 0;
</PRE><PRE>           var scaleHorizontal = transition.$ScaleHorizontal;
           var scaleVertical = transition.$ScaleVertical;
</PRE><PRE>           if ($JssorDirection$.$IsToLeft(direction)) {
               toLeft -= captionParentWidth * scaleHorizontal;
           }
           else if ($JssorDirection$.$IsToRight(direction)) {
               toLeft += captionParentWidth * scaleHorizontal;
           }
</PRE><PRE>           if ($JssorDirection$.$IsToTop(direction)) {
               toTop -= captionParentHeight * scaleVertical;
           }
           else if ($JssorDirection$.$IsToBottom(direction)) {
               toTop += captionParentHeight * scaleVertical;
           }
</PRE><PRE>           if (toLeft || toTop || animatorOptions.$Move) {
               toStyles.$Left = toLeft + $JssorUtils$.$CssLeft(captionItem);
               toStyles.$Top = toTop + $JssorUtils$.$CssTop(captionItem);
           }
       }
</PRE><PRE>       //duration
       var duration = transition.$Duration;
</PRE><PRE>       fromStyles = $JssorUtils$.$Extend(fromStyles, $JssorUtils$.$GetStyles(captionItem, toStyles));
</PRE><PRE>       animatorOptions.$Setter = $JssorUtils$.$GetStyleSetterEx();
</PRE><PRE>       return new $JssorAnimator$(transition.$Delay, duration, animatorOptions, captionItem, fromStyles, toStyles);
   }
</PRE><PRE>   function CreateAnimators(streamLineLength, captionItems) {
</PRE><PRE>       $JssorUtils$.$Each(captionItems, function (captionItem, i) {
</PRE><PRE>           $JssorDebug$.$Execute(function () {
               if (captionItem.length) {
                   var top = $JssorUtils$.$CssTop(captionItem.$Elmt);
                   var left = $JssorUtils$.$CssLeft(captionItem.$Elmt);
                   var width = $JssorUtils$.$CssWidth(captionItem.$Elmt);
                   var height = $JssorUtils$.$CssHeight(captionItem.$Elmt);
</PRE><PRE>                   var error = null;
</PRE><PRE>                   if (isNaN(top))
                       error = &quot;Style 'top' for caption not specified. Please always specify caption like 'position: absolute; top: ...px; left: ...px; width: ...px; height: ...px;'.&quot;;
                   else if (isNaN(left))
                       error = &quot;Style 'left' not specified. Please always specify caption like 'position: absolute; top: ...px; left: ...px; width: ...px; height: ...px;'.&quot;;
                   else if (isNaN(width))
                       error = &quot;Style 'width' not specified. Please always specify caption like 'position: absolute; top: ...px; left: ...px; width: ...px; height: ...px;'.&quot;;
                   else if (isNaN(height))
                       error = &quot;Style 'height' not specified. Please always specify caption like 'position: absolute; top: ...px; left: ...px; width: ...px; height: ...px;'.&quot;;
</PRE><PRE>                   if (error)
                       $JssorDebug$.$Error(&quot;Caption &quot; + (i + 1) + &quot; definition error, \r\n&quot; + error + &quot;\r\n&quot; + captionItem.$Elmt.outerHTML);
               }
           });
</PRE><PRE>           var animator;
           var captionElmt = captionItem.$Elmt;
           var transition = captionItem[0];
           var transition3 = captionItem[1];
</PRE><PRE>           if (transition) {
</PRE><PRE>               animator = CreateAnimator(captionElmt, transition);
               streamLineLength = animator.$Locate($JssorUtils$.$IsUndefined(transition.$BeginTime) ? streamLineLength : transition.$BeginTime, 1);
           }
</PRE><PRE>           streamLineLength = CreateAnimators(streamLineLength, captionItem.$Children);
</PRE><PRE>           if (transition3) {
               var animator3 = CreateAnimator(captionElmt, transition3, 1);
               animator3.$Locate(streamLineLength, 1);
               _Self.$Combine(animator3);
               _ImmediateOutCaptionHanger.$Combine(animator3);
           }
</PRE><PRE>           if (animator)
               _Self.$Combine(animator);
       });
</PRE><PRE>       return streamLineLength;
   }
</PRE><PRE>   _Self.$Revert = function () {
       _Self.$GoToPosition(_Self.$GetPosition_OuterEnd() * (playIn || 0));
       _ImmediateOutCaptionHanger.$GoToBegin();
   };
</PRE><PRE>   //Constructor
   {
       _ImmediateOutCaptionHanger = new $JssorAnimator$(0, 0);
</PRE><PRE>       //var streamLineLength = 0;
       //var captionItems = GetCaptionItems(container, null, [], [], 1);
</PRE><PRE>       CreateAnimators(0, _PlayMode ? GetCaptionItems(container, 1) : []);
   }
</PRE><P>};
</P><P>//Event Table
</P><P>//$EVT_CLICK = 21;			    function(slideIndex[, event])
//$EVT_DRAG_START = 22;		    function(position[, virtualPosition, event])
//$EVT_DRAG_END = 23;		    function(position, startPosition[, virtualPosition, virtualStartPosition, event])
//$EVT_SWIPE_START = 24;		function(position[, virtualPosition])
//$EVT_SWIPE_END = 25;		    function(position[, virtualPosition])
</P><P>//$EVT_LOAD_START = 26;			function(slideIndex)
//$EVT_LOAD_END = 27;			function(slideIndex)
</P><P>//$EVT_POSITION_CHANGE = 202;	function(position, fromPosition[, virtualPosition, virtualFromPosition])
//$EVT_PARK = 203;			    function(slideIndex, fromIndex)
</P><P>//$EVT_PROGRESS_CHANGE = 208;	function(slideIndex, progress[, progressBegin, idleBegin, idleEnd, progressEnd])
//$EVT_STATE_CHANGE = 209;	    function(slideIndex, progress[, progressBegin, idleBegin, idleEnd, progressEnd])
</P><P>//$EVT_ROLLBACK_START = 210;	function(slideIndex, progress[, progressBegin, idleBegin, idleEnd, progressEnd])
//$EVT_ROLLBACK_END = 211;	    function(slideIndex, progress[, progressBegin, idleBegin, idleEnd, progressEnd])
</P><P>//$EVT_SLIDESHOW_START = 206;   function(slideIndex[, progressBegin, slideshowBegin, slideshowEnd, progressEnd])
//$EVT_SLIDESHOW_END = 207;     function(slideIndex[, progressBegin, slideshowBegin, slideshowEnd, progressEnd])
</P>
//<A href="http://www.jssor.com/development/reference-api.html" class="external free" rel="nofollow">http://www.jssor.com/development/reference-api.html</A></DIV></DIV></DIV></DIV></DIV></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2014.igem.org/Team:Valencia_UPV/javascript_slider">http://2014.igem.org/Team:Valencia_UPV/javascript_slider</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Valencia_UPV/javascript_slider" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Valencia_UPV/javascript_slider" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Valencia_UPV/javascript_slider&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Valencia_UPV/javascript_slider&amp;oldid=86276" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2014.igem.org:Privacy_policy" title="2014.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2014.igem.org:General_disclaimer" title="2014.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>