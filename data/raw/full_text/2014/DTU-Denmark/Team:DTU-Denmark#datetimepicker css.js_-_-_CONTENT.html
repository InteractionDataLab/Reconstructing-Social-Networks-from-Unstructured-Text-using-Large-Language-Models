<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_DTU-Denmark_datetimepicker_css_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:DTU-Denmark/datetimepicker_css.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:DTU-Denmark/datetimepicker_css.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:DTU-Denmark/datetimepicker_css.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:DTU-Denmark/datetimepicker_css.js&amp;action=history">History               </A></LI><LI style="color:white;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:DTU-Denmark/datetimepicker_css.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:DTU-Denmark/datetimepicker css.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2014.igem.org</H3><P>//Javasript name: My Date Time Picker
//Date created: 16-Nov-2003 23:19
//Creator: TengYong Ng
//Website: <A href="http://www.rainforestnet.com" class="external free" rel="nofollow">http://www.rainforestnet.com</A>
//Copyright (c) 2003 TengYong Ng
//FileName: DateTimePicker_css.js
//Version: 2.2.4
// Note: Permission given to use and modify this script in ANY kind of applications if
//       header lines are left unchanged.
//Permission is granted to redistribute and modify this javascript under a FreeBSD License.
//New Css style version added by Yvan Lavoie (Québec, Canada) 29-Jan-2009
//Formatted for JSLint compatibility by Labsmedia.com (30-Dec-2010)
</P><P>
//Global variables
</P><P>var winCal;
var dtToday;
var Cal;
var MonthName;
var WeekDayName1;
var WeekDayName2;
var exDateTime;//Existing Date and Time
var selDate;//selected date. version 1.7
var calSpanID = &quot;calBorder&quot;; // span ID
var domStyle = null; // span DOM object with style
var cnLeft = &quot;0&quot;;//left coordinate of calendar span
var cnTop = &quot;0&quot;;//top coordinate of calendar span
var xpos = 0; // mouse x position
var ypos = 0; // mouse y position
var calHeight = 0; // calendar height
var CalWidth = 208;// calendar width
var CellWidth = 30;// width of day cell.
var TimeMode = 24;// TimeMode value. 12 or 24
var StartYear = 1940; //First Year in drop down year selection
var EndYear = 5; // The last year of pickable date. if current year is 2011, the last year that still picker will be 2016 (2011+5)
var CalPosOffsetX = -1; //X position offset relative to calendar icon, can be negative value
var CalPosOffsetY = 0; //Y position offset relative to calendar icon, can be negative value
</P><P>//Configurable parameters start
var SpanBorderColor = &quot;#000000&quot;;//span border color
var SpanBgColor = &quot;#FFFFFF&quot;; //span background color
var MonthYearColor = &quot;#cc0033&quot;; //Font Color of Month and Year in Calendar header.
var WeekHeadColor = &quot;#18861B&quot;; //var WeekHeadColor=&quot;#18861B&quot;;//Background Color in Week header.
var SundayColor = &quot;#C0F64F&quot;; //var SundayColor=&quot;#C0F64F&quot;;//Background color of Sunday.
var SaturdayColor = &quot;#C0F64F&quot;; //Background color of Saturday.
var WeekDayColor = &quot;#FFEDA6&quot;; //Background color of weekdays.
var FontColor = &quot;blue&quot;; //color of font in Calendar day cell.
var TodayColor = &quot;#ffbd35&quot;; //var TodayColor=&quot;#FFFF33&quot;;//Background color of today.
var SelDateColor = &quot;#8DD53C&quot;; //var SelDateColor = &quot;#8DD53C&quot;;//Backgrond color of selected date in textbox.
var YrSelColor = &quot;#cc0033&quot;; //color of font of Year selector.
var MthSelColor = &quot;#cc0033&quot;; //color of font of Month selector if &quot;MonthSelector&quot; is &quot;arrow&quot;.
var HoverColor = &quot;#E0FF38&quot;; //color when mouse move over.
var DisableColor = &quot;#999966&quot;; //color of disabled cell.
var CalBgColor = &quot;#ffffff&quot;; //Background color of Calendar window.
</P><P>var WeekChar = 2;//number of character for week day. if 2 then Mo,Tu,We. if 3 then Mon,Tue,Wed.
var DateSeparator = &quot;-&quot;;//Date Separator, you can change it to &quot;-&quot; if you want.
var ShowLongMonth = true;//Show long month name in Calendar header. example: &quot;January&quot;.
var ShowMonthYear = true;//Show Month and Year in Calendar header.
var ThemeBg = &quot;&quot;;//Background image of Calendar window.
var PrecedeZero = true;//Preceding zero [true|false]
var MondayFirstDay = true;//true:Use Monday as first day; false:Sunday as first day. [true|false]  //added in version 1.7
var UseImageFiles = true;//Use image files with &quot;arrows&quot; and &quot;close&quot; button
var imageFilesPath = &quot;images2/&quot;;
//Configurable parameters end
</P><P>//use the Month and Weekday in your preferred language.
var MonthName = [&quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;July&quot;, &quot;August&quot;, &quot;September&quot;, &quot;October&quot;, &quot;November&quot;, &quot;December&quot;];
var WeekDayName1 = [&quot;Sunday&quot;, &quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;];
var WeekDayName2 = [&quot;Monday&quot;, &quot;Tuesday&quot;, &quot;Wednesday&quot;, &quot;Thursday&quot;, &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;];
</P><P>
//end Configurable parameters
</P><P>//end Global variable
</P><P>
// Calendar prototype
function Calendar(pDate, pCtrl)
{
	//Properties
	this.Date = pDate.getDate();//selected date
	this.Month = pDate.getMonth();//selected month number
	this.Year = pDate.getFullYear();//selected year in 4 digits
	this.Hours = pDate.getHours();
</P><P>	if (pDate.getMinutes() &lt; 10)
	{
		this.Minutes = &quot;0&quot; + pDate.getMinutes();
	}
	else
	{
		this.Minutes = pDate.getMinutes();
	}
</P><P>	if (pDate.getSeconds() &lt; 10)
	{
		this.Seconds = &quot;0&quot; + pDate.getSeconds();
	}
	else
	{
		this.Seconds = pDate.getSeconds();
	}
	this.MyWindow = winCal;
	this.Ctrl = pCtrl;
	this.Format = &quot;ddMMyyyy&quot;;
	this.Separator = DateSeparator;
	this.ShowTime = false;
	this.Scroller = &quot;DROPDOWN&quot;;
	if (pDate.getHours() &lt; 12)
	{
		this.AMorPM = &quot;AM&quot;;
	}
	else
	{
		this.AMorPM = &quot;PM&quot;;
	}
	this.ShowSeconds = false;
	this.EnableDateMode = &quot;&quot;
}
</P><P>Calendar.prototype.GetMonthIndex = function (shortMonthName)
{
	for (var i = 0; i &lt; 12; i += 1)
	{
		if (MonthName[i].substring(0, 3).toUpperCase() === shortMonthName.toUpperCase())
		{
			return i;
		}
	}
};
</P><P>Calendar.prototype.IncYear = function () {
</P><PRE>   if (Cal.Year &lt;= dtToday.getFullYear()+EndYear)
</PRE><P>	    Cal.Year += 1;
};
</P><P>Calendar.prototype.DecYear = function () {
</P><PRE>   if (Cal.Year &gt; StartYear)
</PRE><P>	    Cal.Year -= 1;
};
</P><P>Calendar.prototype.IncMonth = function() {
</P><PRE>   if (Cal.Year &lt;= dtToday.getFullYear() + EndYear) {
       Cal.Month += 1;
       if (Cal.Month &gt;= 12) {
           Cal.Month = 0;
           Cal.IncYear();
       }
   }
</PRE><P>};
</P><P>Calendar.prototype.DecMonth = function() {
</P><PRE>   if (Cal.Year &gt;= StartYear) {
       Cal.Month -= 1;
       if (Cal.Month &lt; 0) {
           Cal.Month = 11;
           Cal.DecYear();
       }
   }
</PRE><P>};
</P><P>Calendar.prototype.SwitchMth = function (intMth)
{
	Cal.Month = parseInt(intMth, 10);
};
</P><P>Calendar.prototype.SwitchYear = function (intYear)
{
	Cal.Year = parseInt(intYear, 10);
};
</P><P>Calendar.prototype.SetHour = function(intHour) {
</P><PRE>   var MaxHour,
</PRE><P>	MinHour,
	HourExp = new RegExp(&quot;^\\d\\d&quot;),
	SingleDigit = new RegExp(&quot;^\\d{1}$&quot;);
</P><PRE>   if (TimeMode === 24) {
       MaxHour = 23;
       MinHour = 0;
   }
   else if (TimeMode === 12) {
       MaxHour = 12;
       MinHour = 1;
   }
   else {
       alert(&quot;TimeMode can only be 12 or 24&quot;);
   }
</PRE><PRE>   if ((HourExp.test(intHour) || SingleDigit.test(intHour)) &amp;&amp; (parseInt(intHour, 10) &gt; MaxHour)) {
       intHour = MinHour;
   }
</PRE><PRE>   else if ((HourExp.test(intHour) || SingleDigit.test(intHour)) &amp;&amp; (parseInt(intHour, 10) &lt; MinHour)) {
       intHour = MaxHour;
   }
</PRE><PRE>   intHour = parseInt(intHour, 10);
   if (SingleDigit.test(intHour)) {
       intHour = &quot;0&quot; + intHour;
   }
</PRE><PRE>   if (HourExp.test(intHour) &amp;&amp; (parseInt(intHour, 10) &lt;= MaxHour) &amp;&amp; (parseInt(intHour, 10) &gt;= MinHour)) {
       if ((TimeMode === 12) &amp;&amp; (Cal.AMorPM === &quot;PM&quot;)) {
           if (parseInt(intHour, 10) === 12) {
               Cal.Hours = 12;
           }
           else {
               Cal.Hours = parseInt(intHour, 10) + 12;
           }
       }
</PRE><PRE>       else if ((TimeMode === 12) &amp;&amp; (Cal.AMorPM === &quot;AM&quot;)) {
           if (intHour === 12) {
               intHour -= 12;
           }
</PRE><PRE>           Cal.Hours = parseInt(intHour, 10);
       }
</PRE><PRE>       else if (TimeMode === 24) {
           Cal.Hours = parseInt(intHour, 10);
       }
   }
</PRE><P>};
</P><P>Calendar.prototype.SetMinute = function (intMin)
{
	var MaxMin = 59,
	MinMin = 0,
</P><P>	SingleDigit = new RegExp(&quot;\\d&quot;),
	SingleDigit2 = new RegExp(&quot;^\\d{1}$&quot;),
	MinExp = new RegExp(&quot;^\\d{2}$&quot;),
</P><P>	strMin = 0;
</P><P>	if ((MinExp.test(intMin) || SingleDigit.test(intMin)) &amp;&amp; (parseInt(intMin, 10) &gt; MaxMin))
	{
		intMin = MinMin;
	}
</P><P>	else if ((MinExp.test(intMin) || SingleDigit.test(intMin)) &amp;&amp; (parseInt(intMin, 10) &lt; MinMin))
	{
		intMin = MaxMin;
	}
</P><P>	strMin = intMin + &quot;&quot;;
	if (SingleDigit2.test(intMin))
	{
		strMin = &quot;0&quot; + strMin;
	}
</P><P>	if ((MinExp.test(intMin) || SingleDigit.test(intMin)) &amp;&amp; (parseInt(intMin, 10) &lt;= 59) &amp;&amp; (parseInt(intMin, 10) &gt;= 0))
	{
		Cal.Minutes = strMin;
	}
};
</P><P>Calendar.prototype.SetSecond = function (intSec)
{
	var MaxSec = 59,
	MinSec = 0,
</P><P>	SingleDigit = new RegExp(&quot;\\d&quot;),
	SingleDigit2 = new RegExp(&quot;^\\d{1}$&quot;),
	SecExp = new RegExp(&quot;^\\d{2}$&quot;),
</P><P>	strSec = 0;
</P><P>	if ((SecExp.test(intSec) || SingleDigit.test(intSec)) &amp;&amp; (parseInt(intSec, 10) &gt; MaxSec))
	{
		intSec = MinSec;
	}
</P><P>	else if ((SecExp.test(intSec) || SingleDigit.test(intSec)) &amp;&amp; (parseInt(intSec, 10) &lt; MinSec))
	{
		intSec = MaxSec;
	}
</P><P>	strSec = intSec + &quot;&quot;;
	if (SingleDigit2.test(intSec))
	{
		strSec = &quot;0&quot; + strSec;
	}
</P><P>	if ((SecExp.test(intSec) || SingleDigit.test(intSec)) &amp;&amp; (parseInt(intSec, 10) &lt;= 59) &amp;&amp; (parseInt(intSec, 10) &gt;= 0))
	{
		Cal.Seconds = strSec;
	}
</P><P>};
</P><P>Calendar.prototype.SetAmPm = function (pvalue)
{
	this.AMorPM = pvalue;
	if (pvalue === &quot;PM&quot;)
	{
		this.Hours = parseInt(this.Hours, 10) + 12;
		if (this.Hours === 24)
		{
			this.Hours = 12;
		}
	}
</P><P>	else if (pvalue === &quot;AM&quot;)
	{
		this.Hours -= 12;
	}
};
</P><P>Calendar.prototype.getShowHour = function() {
</P><PRE>   var finalHour;
</PRE><PRE>   if (TimeMode === 12) {
       if (parseInt(this.Hours, 10) === 0) {
           this.AMorPM = &quot;AM&quot;;
           finalHour = parseInt(this.Hours, 10) + 12;
       }
</PRE><PRE>       else if (parseInt(this.Hours, 10) === 12) {
           this.AMorPM = &quot;PM&quot;;
           finalHour = 12;
       }
</PRE><PRE>       else if (this.Hours &gt; 12) {
           this.AMorPM = &quot;PM&quot;;
           if ((this.Hours - 12) &lt; 10) {
               finalHour = &quot;0&quot; + ((parseInt(this.Hours, 10)) - 12);
           }
           else {
               finalHour = parseInt(this.Hours, 10) - 12;
           }
       }
       else {
           this.AMorPM = &quot;AM&quot;;
           if (this.Hours &lt; 10) {
               finalHour = &quot;0&quot; + parseInt(this.Hours, 10);
           }
           else {
               finalHour = this.Hours;
           }
       }
   }
</PRE><PRE>   else if (TimeMode === 24) {
       if (this.Hours &lt; 10) {
           finalHour = &quot;0&quot; + parseInt(this.Hours, 10);
       }
       else {
           finalHour = this.Hours;
       }
   }
</PRE><PRE>   return finalHour;
</PRE><P>};
</P><P>Calendar.prototype.getShowAMorPM = function ()
{
	return this.AMorPM;
};
</P><P>Calendar.prototype.GetMonthName = function (IsLong)
{
	var Month = MonthName[this.Month];
	if (IsLong)
	{
		return Month;
	}
	else
	{
		return Month.substr(0, 3);
	}
};
</P><P>Calendar.prototype.GetMonDays = function() { //Get number of days in a month
</P><PRE>   var DaysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
   if (Cal.IsLeapYear()) {
       DaysInMonth[1] = 29;
   }
</PRE><PRE>   return DaysInMonth[this.Month];
</PRE><P>};
</P><P>Calendar.prototype.IsLeapYear = function ()
{
	if ((this.Year % 4) === 0)
	{
		if ((this.Year % 100 === 0) &amp;&amp; (this.Year % 400) !== 0)
		{
			return false;
		}
		else
		{
			return true;
		}
	}
	else
	{
		return false;
	}
};
</P><P>Calendar.prototype.FormatDate = function (pDate)
{
	var MonthDigit = this.Month + 1;
	if (PrecedeZero === true)
	{
		if ((pDate &lt; 10) &amp;&amp; String(pDate).length===1) //length checking added in version 2.2
		{		
			pDate = &quot;0&quot; + pDate;
		}
		if (MonthDigit &lt; 10)
		{
			MonthDigit = &quot;0&quot; + MonthDigit;
		}
	}
</P><P>	switch (this.Format.toUpperCase())
	{
		case &quot;DDMMYYYY&quot;:
		return (pDate + DateSeparator + MonthDigit + DateSeparator + this.Year);
		case &quot;DDMMMYYYY&quot;:
		return (pDate + DateSeparator + this.GetMonthName(false) + DateSeparator + this.Year);
		case &quot;MMDDYYYY&quot;:
		return (MonthDigit + DateSeparator + pDate + DateSeparator + this.Year);
		case &quot;MMMDDYYYY&quot;:
		return (this.GetMonthName(false) + DateSeparator + pDate + DateSeparator + this.Year);
		case &quot;YYYYMMDD&quot;:
		return (this.Year + DateSeparator + MonthDigit + DateSeparator + pDate);
		case &quot;YYMMDD&quot;:
		return (String(this.Year).substring(2, 4) + DateSeparator + MonthDigit + DateSeparator + pDate);
		case &quot;YYMMMDD&quot;:
		return (String(this.Year).substring(2, 4) + DateSeparator + this.GetMonthName(false) + DateSeparator + pDate);
		case &quot;YYYYMMMDD&quot;:
		return (this.Year + DateSeparator + this.GetMonthName(false) + DateSeparator + pDate);
		default:
		return (pDate + DateSeparator + (this.Month + 1) + DateSeparator + this.Year);
	}
};
</P><P>// end Calendar prototype
</P><P>function GenCell(pValue, pHighLight, pColor, pClickable)
{ //Generate table cell with value
	var PValue,
	PCellStr,
	PClickable,
	vTimeStr;
</P><P>	if (!pValue)
	{
		PValue = &quot;&quot;;
	}
	else
	{
		PValue = pValue;
	}
</P><P>	if (pColor === undefined)
	    pColor = CalBgColor;
</P><P>	if (pClickable !== undefined){
		PClickable = pClickable;
	}
	else{
		PClickable = true;
	}
</P><P>if (Cal.ShowTime)
	{
		vTimeStr = ' ' + Cal.Hours + ':' + Cal.Minutes;
		if (Cal.ShowSeconds)
		{
			vTimeStr += ':' + Cal.Seconds;
		}
		if (TimeMode === 12)
		{
			vTimeStr += ' ' + Cal.AMorPM;
		}
	}
</P><P>	else
	{
		vTimeStr = &quot;&quot;;
	}
</P><P>	if (PValue !== &quot;&quot;)
	{
		if (PClickable === true) {
		    if (Cal.ShowTime === true)
		    { PCellStr = &quot;&lt;td id='c&quot; + PValue + &quot;' class='calTD' style='text-align:center;cursor:pointer;background-color:&quot;+pColor+&quot;' onmousedown='selectDate(this,&quot; + PValue + &quot;);'&gt;&quot; + PValue + &quot;&lt;/td&gt;&quot;; }
		    else { PCellStr = &quot;&lt;td class='calTD' style='text-align:center;cursor:pointer;background-color:&quot; + pColor + &quot;' onmouseover='changeBorder(this, 0);' onmouseout=\&quot;changeBorder(this, 1, '&quot; + pColor + &quot;');\&quot; onClick=\&quot;javascript:callback('&quot; + Cal.Ctrl + &quot;','&quot; + Cal.FormatDate(PValue) + &quot;');\&quot;&gt;&quot; + PValue + &quot;&lt;/td&gt;&quot;; }
		}
		else
		{ PCellStr = &quot;&lt;td style='text-align:center;background-color:&quot;+pColor+&quot;' class='calTD'&gt;&quot;+PValue+&quot;&lt;/td&gt;&quot;; }
	}
	else
	{ PCellStr = &quot;&lt;td style='text-align:center;background-color:&quot;+pColor+&quot;' class='calTD'&gt; &lt;/td&gt;&quot;; }
</P><P>	return PCellStr;
}
</P><P>function RenderCssCal(bNewCal)
{
	if (typeof bNewCal === &quot;undefined&quot; || bNewCal !== true)
	{
		bNewCal = false;
	}
	var vCalHeader,
	vCalData,
	vCalTime = &quot;&quot;,
	vCalClosing = &quot;&quot;,
	winCalData = &quot;&quot;,
	CalDate,
</P><P>	i,
	j,
</P><P>	SelectStr,
	vDayCount = 0,
	vFirstDay,
</P><P>	WeekDayName = [],//Added version 1.7
	strCell,
</P><P>	showHour,
	ShowArrows = false,
	HourCellWidth = &quot;35px&quot;, //cell width with seconds.
</P><P>	SelectAm,
	SelectPm,
</P><P>	funcCalback,
</P><P>	headID,
	e,
	cssStr,
	style,
	cssText,
	span;
</P><P>	calHeight = 0; // reset the window height on refresh
</P><P>	// Set the default cursor for the calendar
</P><P>	winCalData = &quot;<SPAN style="cursor:auto;">&quot;;
</SPAN></P>
	vCalHeader = &quot;<TABLE style="background-color:&quot;+CalBgColor+&quot;;width:200px;padding:0;margin:5px auto 5px auto">&lt;tbody&gt;&quot;;

	//Table for Month &amp; Year Selector

	vCalHeader += &quot;<TBODY><TR>&quot;;
<P>	//******************Month and Year selector in dropdown list************************
</P><P>	if (Cal.Scroller === &quot;DROPDOWN&quot;)
	{
</P>
	    vCalHeader += &quot;<TD align="center">&lt;select name='MonthSelector' onChange='javascript:Cal.SwitchMth(this.selectedIndex);RenderCssCal();'&gt;&quot;;
<P>		for (i = 0; i &lt; 12; i += 1)
		{
			if (i === Cal.Month)
			{
				SelectStr = &quot;Selected&quot;;
			}
			else
			{
				SelectStr = &quot;&quot;;
			}
			vCalHeader += &quot;&lt;option &quot; + SelectStr + &quot; value=&quot; + i + &quot;&gt;&quot; + MonthName[i] + &quot;&lt;/option&gt;&quot;;
		}
</P>
		vCalHeader += &quot;&lt;/select&gt;</TD>&quot;;
		//Year selector

		vCalHeader += &quot;<TD align="center">&lt;select name='YearSelector' size='1' onChange='javascript:Cal.SwitchYear(this.value);RenderCssCal();'&gt;&quot;;
<P>		for (i = StartYear; i &lt;= (dtToday.getFullYear() + EndYear); i += 1)
		{
			if (i === Cal.Year)
			{
				SelectStr = 'selected=&quot;selected&quot;';
			}
			else
			{
				SelectStr = <I>;</I>
			}
			vCalHeader += &quot;&lt;option &quot; + SelectStr + &quot; value=&quot; + i + &quot;&gt;&quot; + i + &quot;&lt;/option&gt;\n&quot;;
		}
</P>
		vCalHeader += &quot;&lt;/select&gt;</TD>\n&quot;;
		calHeight += 30;
	}

	//******************End Month and Year selector in dropdown list*********************

	//******************Month and Year selector in arrow*********************************

	else if (Cal.Scroller === &quot;ARROW&quot;)
	{
		if (UseImageFiles)
		{
			vCalHeader += &quot;<TD>&lt;img onmousedown='javascript:Cal.DecYear();RenderCssCal();' src='&quot;+imageFilesPath+&quot;cal_fastreverse.gif' width='13px' height='9' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'&gt;</TD>\n&quot;;//Year scroller (decrease 1 year)
			vCalHeader += &quot;<TD>&lt;img onmousedown='javascript:Cal.DecMonth();RenderCssCal();' src='&quot; + imageFilesPath + &quot;cal_reverse.gif' width='13px' height='9' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'&gt;</TD>\n&quot;; //Month scroller (decrease 1 month)
			vCalHeader += &quot;<TD width="70%" class="calR" style="color:&quot;+YrSelColor+&quot;">&quot;+ Cal.GetMonthName(ShowLongMonth) + &quot; &quot; + Cal.Year + &quot;</TD>&quot;; //Month and Year
			vCalHeader += &quot;<TD>&lt;img onmousedown='javascript:Cal.IncMonth();RenderCssCal();' src='&quot; + imageFilesPath + &quot;cal_forward.gif' width='13px' height='9' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'&gt;</TD>\n&quot;; //Month scroller (increase 1 month)
			vCalHeader += &quot;<TD>&lt;img onmousedown='javascript:Cal.IncYear();RenderCssCal();' src='&quot; + imageFilesPath + &quot;cal_fastforward.gif' width='13px' height='9' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'&gt;</TD>\n&quot;; //Year scroller (increase 1 year)
<P>			calHeight += 22;
		}
		else
		{
</P>
			vCalHeader += &quot;<TD><SPAN id="dec_year" title="reverse year" style="border:1px solid white; color:&quot; + YrSelColor + &quot;">-</SPAN></TD>&quot;;//Year scroller (decrease 1 year)
			vCalHeader += &quot;<TD><SPAN id="dec_month" title="reverse month" style="border:1px solid white">&lt;</SPAN></TD>\n&quot;;//Month scroller (decrease 1 month)
			vCalHeader += &quot;<TD width="70%" class="calR" style="color:&quot; + YrSelColor + &quot;">&quot; + Cal.GetMonthName(ShowLongMonth) + &quot; &quot; + Cal.Year + &quot;</TD>\n&quot;; //Month and Year
			vCalHeader += &quot;<TD><SPAN id="inc_month" title="forward month" style="border:1px solid white">&gt;</SPAN></TD>\n&quot;;//Month scroller (increase 1 month)
			vCalHeader += &quot;<TD><SPAN id="inc_year" title="forward year" style="border:1px solid white; color:&quot; + YrSelColor + &quot;">+</SPAN></TD>\n&quot;;//Year scroller (increase 1 year)
<P>			calHeight += 22;
		}
	}
</P>
	vCalHeader += &quot;</TR></TBODY></TABLE>&quot;;
<P>	//******************End Month and Year selector in arrow******************************
</P><P>	//Calendar header shows Month and Year
	if (ShowMonthYear &amp;&amp; Cal.Scroller === &quot;DROPDOWN&quot;)
	{
</P>
	    vCalHeader += &quot;&quot; + Cal.GetMonthName(ShowLongMonth) + &quot; &quot; + Cal.Year + &quot;&quot;;
<P>		calHeight += 19;
	}
</P><P>	//Week day header
</P>
	vCalHeader += &quot;<TABLE style="border-spacing:1px;border-collapse:separate;"><TBODY><TR>&quot;;
<P>	if (MondayFirstDay === true)
	{
		WeekDayName = WeekDayName2;
	}
	else
	{
		WeekDayName = WeekDayName1;
	}
	for (i = 0; i &lt; 7; i += 1)
	{
</P>
	    vCalHeader += &quot;<TD style="background-color:&quot;+WeekHeadColor+&quot;;width:&quot;+CellWidth+&quot;px;color:#FFFFFF" class="calTD">&quot; + WeekDayName[i].substr(0, WeekChar) + &quot;</TD>&quot;;
<P>	}
</P><P>	calHeight += 19;
</P>
	vCalHeader += &quot;</TR>&quot;;
	//Calendar detail
	CalDate = new Date(Cal.Year, Cal.Month);
	CalDate.setDate(1);

	vFirstDay = CalDate.getDay();

	//Added version 1.7
	if (MondayFirstDay === true)
	{
		vFirstDay -= 1;
		if (vFirstDay === -1)
		{
			vFirstDay = 6;
		}
	}

	//Added version 1.7
	vCalData = &quot;<TR>&quot;;
	calHeight += 19;
	for (i = 0; i &lt; vFirstDay; i += 1)
	{
		vCalData = vCalData + GenCell();
		vDayCount = vDayCount + 1;
	}

	//Added version 1.7
	for (j = 1; j &lt;= Cal.GetMonDays(); j += 1)
	{
		if ((vDayCount % 7 === 0) &amp;&amp; (j &gt; 1))
		{
			vCalData = vCalData + &quot;</TR><TR>&quot;;
		}

		vDayCount = vDayCount + 1;
		//added version 2.1.2
		if (Cal.EnableDateMode === &quot;future&quot; &amp;&amp; ((j &lt; dtToday.getDate()) &amp;&amp; (Cal.Month === dtToday.getMonth()) &amp;&amp; (Cal.Year === dtToday.getFullYear()) || (Cal.Month &lt; dtToday.getMonth()) &amp;&amp; (Cal.Year === dtToday.getFullYear()) || (Cal.Year &lt; dtToday.getFullYear())))
		{
			strCell = GenCell(j, false, DisableColor, false); //Before today's date is not clickable
        }
        else if (Cal.EnableDateMode === &quot;past&quot; &amp;&amp; ((j &gt;= dtToday.getDate()) &amp;&amp; (Cal.Month === dtToday.getMonth()) &amp;&amp; (Cal.Year === dtToday.getFullYear()) || (Cal.Month &gt; dtToday.getMonth()) &amp;&amp; (Cal.Year === dtToday.getFullYear()) || (Cal.Year &gt; dtToday.getFullYear()))) {
            strCell = GenCell(j, false, DisableColor, false); //After today's date is not clickable
        }
		//if End Year + Current Year = Cal.Year. Disable.
		else if (Cal.Year &gt; (dtToday.getFullYear()+EndYear))
		{
		    strCell = GenCell(j, false, DisableColor, false); 
		}
		else if ((j === dtToday.getDate()) &amp;&amp; (Cal.Month === dtToday.getMonth()) &amp;&amp; (Cal.Year === dtToday.getFullYear()))
		{
			strCell = GenCell(j, true, TodayColor);//Highlight today's date
		}
		else
		{
			if ((j === selDate.getDate()) &amp;&amp; (Cal.Month === selDate.getMonth()) &amp;&amp; (Cal.Year === selDate.getFullYear())){
			     //modified version 1.7
				strCell = GenCell(j, true, SelDateColor);
            }
			else
			{
				if (MondayFirstDay === true)
				{
					if (vDayCount % 7 === 0)
					{
						strCell = GenCell(j, false, SundayColor);
					}
					else if ((vDayCount + 1) % 7 === 0)
					{
						strCell = GenCell(j, false, SaturdayColor);
					}
					else
					{
						strCell = GenCell(j, null, WeekDayColor);
					}
				}
				else
				{
					if (vDayCount % 7 === 0)
					{
						strCell = GenCell(j, false, SaturdayColor);
					}
					else if ((vDayCount + 6) % 7 === 0)
					{
						strCell = GenCell(j, false, SundayColor);
					}
					else
					{
						strCell = GenCell(j, null, WeekDayColor);
					}
				}
			}
		}

		vCalData = vCalData + strCell;

		if ((vDayCount % 7 === 0) &amp;&amp; (j &lt; Cal.GetMonDays()))
		{
			vCalData = vCalData + &quot;</TR>&quot;;
			calHeight += 19;
		}
	}

	// finish the table proper

	if (vDayCount % 7 !== 0)
	{
		while (vDayCount % 7 !== 0)
		{
			vCalData = vCalData + GenCell();
			vDayCount = vDayCount + 1;
		}
	}

	vCalData = vCalData + &quot;</TBODY></TABLE>&quot;;
<P>
	//Time picker
	if (Cal.ShowTime === true)
	{
		showHour = Cal.getShowHour();
</P><P>		if (Cal.ShowSeconds === false &amp;&amp; TimeMode === 24)
		{
			ShowArrows = true;
			HourCellWidth = &quot;10px&quot;;
		}
</P>
		vCalTime = &quot;<TABLE border="0" width="199px" cellpadding="0" cellspacing="0">&lt;tbody&gt;<TBODY><TR><TD height="5px" width="&quot; + HourCellWidth + &quot;"> </TD>&quot;;
<P>		if (ShowArrows &amp;&amp; UseImageFiles) //this is where the up and down arrow control the hour.
		{
</P>
		    vCalTime += &quot;</TR><TR><TD style="text-align:center;">&lt;img onclick='nextStep(\&quot;Hour\&quot;, \&quot;plus\&quot;);' onmousedown='startSpin(\&quot;Hour\&quot;, \&quot;plus\&quot;);' onmouseup='stopSpin();' src='&quot; + imageFilesPath + &quot;cal_plus.gif' width='13px' height='9px' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'&gt;</TD></TR><TR><TD style="text-align:center;">&lt;img onclick='nextStep(\&quot;Hour\&quot;, \&quot;minus\&quot;);' onmousedown='startSpin(\&quot;Hour\&quot;, \&quot;minus\&quot;);' onmouseup='stopSpin();' src='&quot; + imageFilesPath + &quot;cal_minus.gif' width='13px' height='9px' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'&gt;</TD></TR></TBODY></TABLE>\n&quot;;
<P>		}
</P>
		vCalTime += &quot;&lt;input type='text' name='hour' maxlength=2 size=1 style=\&quot;WIDTH:22px\&quot; value=&quot; + showHour + &quot; onkeyup=\&quot;javascript:Cal.SetHour(this.value)\&quot;&gt;&quot;;
		vCalTime += &quot;:&quot;;
<P>		vCalTime += &quot;&lt;input type='text' name='minute' maxlength=2 size=1 style=\&quot;WIDTH: 22px\&quot; value=&quot; + Cal.Minutes + &quot; onkeyup=\&quot;javascript:Cal.SetMinute(this.value)\&quot;&gt;&quot;;
</P><P>		if (Cal.ShowSeconds)
		{
</P>
		    vCalTime += &quot;:&quot;;
<P>			vCalTime += &quot;&lt;input type='text' name='second' maxlength=2 size=1 style=\&quot;WIDTH: 22px\&quot; value=&quot; + Cal.Seconds + &quot; onkeyup=\&quot;javascript:Cal.SetSecond(parseInt(this.value,10))\&quot;&gt;&quot;;
		}
</P><P>		if (TimeMode === 12)
		{
			SelectAm = (Cal.AMorPM === &quot;AM&quot;) ? &quot;Selected&quot; : &quot;&quot;;
			SelectPm = (Cal.AMorPM === &quot;PM&quot;) ? &quot;Selected&quot; : &quot;&quot;;
</P>
			vCalTime += &quot;&quot;;
<P>			vCalTime += &quot;&lt;select name=\&quot;ampm\&quot; onChange=\&quot;javascript:Cal.SetAmPm(this.options[this.selectedIndex].value);\&quot;&gt;\n&quot;;
			vCalTime += &quot;&lt;option &quot; + SelectAm + &quot; value=\&quot;AM\&quot;&gt;AM&lt;/option&gt;&quot;;
			vCalTime += &quot;&lt;option &quot; + SelectPm + &quot; value=\&quot;PM\&quot;&gt;PM&lt;option&gt;&quot;;
			vCalTime += &quot;&lt;/select&gt;&quot;;
		}
</P><P>		if (ShowArrows &amp;&amp; UseImageFiles) //this is where the up and down arrow to change the &quot;Minute&quot;.
		{
</P>
		    vCalTime += &quot;\n<TABLE cellspacing="0" cellpadding="0" style="line-height:0pt;width:100%"><TBODY><TR><TD style="text-align:center;">&lt;img onclick='nextStep(\&quot;Minute\&quot;, \&quot;plus\&quot;);' onmousedown='startSpin(\&quot;Minute\&quot;, \&quot;plus\&quot;);' onmouseup='stopSpin();' src='&quot; + imageFilesPath + &quot;cal_plus.gif' width='13px' height='9px' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'&gt;</TD></TR><TR><TD style="text-align:center;">&lt;img onmousedown='startSpin(\&quot;Minute\&quot;, \&quot;minus\&quot;);' onmouseup='stopSpin();' onclick='nextStep(\&quot;Minute\&quot;,\&quot;minus\&quot;);' src='&quot; + imageFilesPath + &quot;cal_minus.gif' width='13px' height='9px' onmouseover='changeBorder(this, 0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'&gt;</TD></TR></TBODY></TABLE>&quot;;
<P>		}
</P>
		vCalTime += &quot;\n&quot;;
		vCalTime += &quot;&lt;input style='width:60px;font-size:12px;' onClick='javascript:closewin(\&quot;&quot; + Cal.Ctrl + &quot;\&quot;);'  type=\&quot;button\&quot; value=\&quot;OK\&quot;&gt; &lt;input style='width:60px;font-size:12px;' onClick='javascript: winCal.style.visibility = \&quot;hidden\&quot;' type=\&quot;button\&quot; value=\&quot;Cancel\&quot;&gt;&quot;;
<P>	}
	else //if not to show time.
	{
</P>
	    vCalTime += &quot;\n\n&quot;;
<P>	    //close button
	    if (UseImageFiles) {
</P>
	        vCalClosing += &quot;&lt;img onmousedown='javascript:closewin(\&quot;&quot; + Cal.Ctrl + &quot;\&quot;); stopSpin();' src='&quot;+imageFilesPath+&quot;cal_close.gif' width='16px' height='14px' onmouseover='changeBorder(this,0)' onmouseout='changeBorder(this, 1)' style='border:1px solid white'&gt;&quot;;
	    }
	    else {
	        vCalClosing += &quot;<SPAN id="close_cal" style="border:1px solid white; font-family: Arial;font-size: 10pt;">x</SPAN>&lt;/td&gt;&quot;;
	    }
	    vCalClosing += &quot;&quot;;
	}
	vCalClosing += &quot;&lt;/tbody&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&quot;;
	calHeight += 31;
	vCalClosing += &quot;&lt;/tbody&gt;&lt;/table&gt;\n&lt;/span&gt;&quot;;

	//end time picker
	funcCalback = &quot;function callback(id, datum) {&quot;;
	funcCalback += &quot; var CalId = document.getElementById(id);if (datum=== 'undefined') { var d = new Date(); datum = d.getDate() + '/' +(d.getMonth()+1) + '/' + d.getFullYear(); } window.calDatum=datum;CalId.value=datum;&quot;;
	funcCalback += &quot; if(Cal.ShowTime){&quot;;
	funcCalback += &quot; CalId.value+=' '+Cal.getShowHour()+':'+Cal.Minutes;&quot;;
	funcCalback += &quot; if (Cal.ShowSeconds)  CalId.value+=':'+Cal.Seconds;&quot;;
	funcCalback += &quot; if (TimeMode === 12)  CalId.value+=<I>+Cal.getShowAMorPM();&quot;;</I>
	funcCalback += &quot;}if(CalId.onchange!=undefined) CalId.onchange();CalId.focus();winCal.style.visibility='hidden';}&quot;;


	// determines if there is enough space to open the cal above the position where it is called
	if (ypos &gt; calHeight)
	{
		ypos = ypos - calHeight;
	}

	if (!winCal)
	{
		headID = document.getElementsByTagName(&quot;head&quot;)[0];

		// add javascript function to the span cal
		e = document.createElement(&quot;script&quot;);
		e.type = &quot;text/javascript&quot;;
		e.language = &quot;javascript&quot;;
		e.text = funcCalback;
		headID.appendChild(e);
		// add stylesheet to the span cal

		cssStr = &quot;.calTD {font-family: verdana; font-size: 12px; text-align: center; border:0; }\n&quot;;
		cssStr += &quot;.calR {font-family: verdana; font-size: 12px; text-align: center; font-weight: bold;}&quot;;

		style = document.createElement(&quot;style&quot;);
		style.type = &quot;text/css&quot;;
		style.rel = &quot;stylesheet&quot;;
		if (style.styleSheet)
		{ // IE
			style.styleSheet.cssText = cssStr;
		}

		else
		{ // w3c
			cssText = document.createTextNode(cssStr);
			style.appendChild(cssText);
		}

		headID.appendChild(style);
		// create the outer frame that allows the cal. to be moved
		span = document.createElement(&quot;span&quot;);
		span.id = calSpanID;
		span.style.position = &quot;absolute&quot;;
		span.style.left = (xpos + CalPosOffsetX) + 'px';
		span.style.top = (ypos - CalPosOffsetY) + 'px';
		span.style.width = CalWidth + 'px';
		span.style.border = &quot;solid 1pt &quot; + SpanBorderColor;
		span.style.padding = &quot;0&quot;;
		span.style.cursor = &quot;move&quot;;
		span.style.backgroundColor = SpanBgColor;
		span.style.zIndex = 100;
		document.body.appendChild(span);
		winCal = document.getElementById(calSpanID);
	}

	else
	{
		winCal.style.visibility = &quot;visible&quot;;
		winCal.style.Height = calHeight;

		// set the position for a new calendar only
		if (bNewCal === true)
		{
			winCal.style.left = (xpos + CalPosOffsetX) + 'px';
			winCal.style.top = (ypos - CalPosOffsetY) + 'px';
		}
	}

	winCal.innerHTML = winCalData + vCalHeader + vCalData + vCalTime + vCalClosing;
	return true;
}


function NewCssCal(pCtrl, pFormat, pScroller, pShowTime, pTimeMode, pShowSeconds, pEnableDateMode)
{
	// get current date and time

	dtToday = new Date();
	Cal = new Calendar(dtToday);

	if (pShowTime !== undefined)
	{
	    if (pShowTime) {
	        Cal.ShowTime = true;
	    }
	    else {
	        Cal.ShowTime = false;
	    }

		if (pTimeMode)
		{
			pTimeMode = parseInt(pTimeMode, 10);
		}
		if (pTimeMode === 12 || pTimeMode === 24)
		{
			TimeMode = pTimeMode;
		}
		else
		{
			TimeMode = 24;
		}

		if (pShowSeconds !== undefined)
		{
			if (pShowSeconds)
			{
				Cal.ShowSeconds = true;
			}
			else
			{
				Cal.ShowSeconds = false;
			}
		}
		else
		{
			Cal.ShowSeconds = false;
		}

	}

	if (pCtrl !== undefined)
	{
		Cal.Ctrl = pCtrl;
	}

	if (pFormat!== undefined &amp;&amp; pFormat !==&quot;&quot;)
	{
		Cal.Format = pFormat.toUpperCase();
	}
	else
	{
		Cal.Format = &quot;MMDDYYYY&quot;;
	}

	if (pScroller!== undefined &amp;&amp; pScroller!==&quot;&quot;)
	{
		if (pScroller.toUpperCase() === &quot;ARROW&quot;)
		{
			Cal.Scroller = &quot;ARROW&quot;;
		}
		else
		{
			Cal.Scroller = &quot;DROPDOWN&quot;;
		}
    }

    if (pEnableDateMode !== undefined &amp;&amp; (pEnableDateMode === &quot;future&quot; || pEnableDateMode === &quot;past&quot;)) {
        Cal.EnableDateMode= pEnableDateMode;
    }

	exDateTime = document.getElementById(pCtrl).value; //Existing Date Time value in textbox.

	if (exDateTime)
	{ //Parse existing Date String
		var Sp1 = exDateTime.indexOf(DateSeparator, 0),//Index of Date Separator 1
		Sp2 = exDateTime.indexOf(DateSeparator, parseInt(Sp1, 10) + 1),//Index of Date Separator 2
		tSp1,//Index of Time Separator 1
		tSp2,//Index of Time Separator 2
		strMonth,
		strDate,
		strYear,
		intMonth,
		YearPattern,
		strHour,
		strMinute,
		strSecond,
		winHeight,
		offset = parseInt(Cal.Format.toUpperCase().lastIndexOf(&quot;M&quot;), 10) - parseInt(Cal.Format.toUpperCase().indexOf(&quot;M&quot;), 10) - 1,
		strAMPM = &quot;&quot;;
		//parse month

		if (Cal.Format.toUpperCase() === &quot;DDMMYYYY&quot; || Cal.Format.toUpperCase() === &quot;DDMMMYYYY&quot;)
		{
			if (DateSeparator === &quot;&quot;)
			{
				strMonth = exDateTime.substring(2, 4 + offset);
				strDate = exDateTime.substring(0, 2);
				strYear = exDateTime.substring(4 + offset, 8 + offset);
			}
			else
			{
				if (exDateTime.indexOf(&quot;D*&quot;) !== -1)
				{   //DTG
					strMonth = exDateTime.substring(8, 11);
					strDate  = exDateTime.substring(0, 2);
					strYear  = &quot;20&quot; + exDateTime.substring(11, 13);  //Hack, nur für Jahreszahlen ab 2000
				}
				else
				{
					strMonth = exDateTime.substring(Sp1 + 1, Sp2);
					strDate = exDateTime.substring(0, Sp1);
					strYear = exDateTime.substring(Sp2 + 1, Sp2 + 5);
				}
			}
		}

		else if (Cal.Format.toUpperCase() === &quot;MMDDYYYY&quot; || Cal.Format.toUpperCase() === &quot;MMMDDYYYY&quot;){
			if (DateSeparator === &quot;&quot;){
				strMonth = exDateTime.substring(0, 2 + offset);
				strDate = exDateTime.substring(2 + offset, 4 + offset);
				strYear = exDateTime.substring(4 + offset, 8 + offset);
			}
			else{
				strMonth = exDateTime.substring(0, Sp1);
				strDate = exDateTime.substring(Sp1 + 1, Sp2);
				strYear = exDateTime.substring(Sp2 + 1, Sp2 + 5);
			}
		}

		else if (Cal.Format.toUpperCase() === &quot;YYYYMMDD&quot; || Cal.Format.toUpperCase() === &quot;YYYYMMMDD&quot;)
		{
			if (DateSeparator === &quot;&quot;){
				strMonth = exDateTime.substring(4, 6 + offset);
				strDate = exDateTime.substring(6 + offset, 8 + offset);
				strYear = exDateTime.substring(0, 4);
			}
			else{
				strMonth = exDateTime.substring(Sp1 + 1, Sp2);
				strDate = exDateTime.substring(Sp2 + 1, Sp2 + 3);
				strYear = exDateTime.substring(0, Sp1);
			}
		}

		else if (Cal.Format.toUpperCase() === &quot;YYMMDD&quot; || Cal.Format.toUpperCase() === &quot;YYMMMDD&quot;)
		{
			if (DateSeparator === &quot;&quot;)
			{
				strMonth = exDateTime.substring(2, 4 + offset);
				strDate = exDateTime.substring(4 + offset, 6 + offset);
				strYear = exDateTime.substring(0, 2);
			}
			else
			{
				strMonth = exDateTime.substring(Sp1 + 1, Sp2);
				strDate = exDateTime.substring(Sp2 + 1, Sp2 + 3);
				strYear = exDateTime.substring(0, Sp1);
			}
		}

		if (isNaN(strMonth)){
			intMonth = Cal.GetMonthIndex(strMonth);
		}
		else{
			intMonth = parseInt(strMonth, 10) - 1;
		}
		if ((parseInt(intMonth, 10) &gt;= 0) &amp;&amp; (parseInt(intMonth, 10) &lt; 12))	{
			Cal.Month = intMonth;
		}
		//end parse month

		//parse year
		YearPattern = /^\d{4}$/;
		if (YearPattern.test(strYear)) {
		    if ((parseInt(strYear, 10)&gt;=StartYear) &amp;&amp; (parseInt(strYear, 10)&lt;= (dtToday.getFullYear()+EndYear)))
		        Cal.Year = parseInt(strYear, 10);
		}
		//end parse year
		
		//parse Date
		if ((parseInt(strDate, 10) &lt;= Cal.GetMonDays()) &amp;&amp; (parseInt(strDate, 10) &gt;= 1)) {
			Cal.Date = strDate;
		}
		//end parse Date

		//parse time

		if (Cal.ShowTime === true)
		{
			//parse AM or PM
			if (TimeMode === 12)
			{
				strAMPM = exDateTime.substring(exDateTime.length - 2, exDateTime.length);
				Cal.AMorPM = strAMPM;
			}

			tSp1 = exDateTime.indexOf(&quot;:&quot;, 0);
			tSp2 = exDateTime.indexOf(&quot;:&quot;, (parseInt(tSp1, 10) + 1));
			if (tSp1 &gt; 0)
			{
				strHour = exDateTime.substring(tSp1, tSp1 - 2);
				Cal.SetHour(strHour);

				strMinute = exDateTime.substring(tSp1 + 1, tSp1 + 3);
				Cal.SetMinute(strMinute);

				strSecond = exDateTime.substring(tSp2 + 1, tSp2 + 3);
				Cal.SetSecond(strSecond);

			}
			else if (exDateTime.indexOf(&quot;D*&quot;) !== -1)
			{   //DTG
				strHour = exDateTime.substring(2, 4);
				Cal.SetHour(strHour);
				strMinute = exDateTime.substring(4, 6);
				Cal.SetMinute(strMinute);

			}
		}

	}
	selDate = new Date(Cal.Year, Cal.Month, Cal.Date);//version 1.7
	RenderCssCal(true);
}

function closewin(id) {
    if (Cal.ShowTime === true) {
        var MaxYear = dtToday.getFullYear() + EndYear;
        var beforeToday =
                    (Cal.Date &lt; dtToday.getDate()) &amp;&amp;
                    (Cal.Month === dtToday.getMonth()) &amp;&amp;
                    (Cal.Year === dtToday.getFullYear())
                    ||
                    (Cal.Month &lt; dtToday.getMonth()) &amp;&amp;
                    (Cal.Year === dtToday.getFullYear())
                    ||
                    (Cal.Year &lt; dtToday.getFullYear());

        if ((Cal.Year &lt;= MaxYear) &amp;&amp; (Cal.Year &gt;= StartYear) &amp;&amp; (Cal.Month === selDate.getMonth()) &amp;&amp; (Cal.Year === selDate.getFullYear())) {
            if (Cal.EnableDateMode === &quot;future&quot;) {
                if (beforeToday === false) {
                    callback(id, Cal.FormatDate(Cal.Date));
                }
            }
            else
                callback(id, Cal.FormatDate(Cal.Date));
        }
    }
    
	var CalId = document.getElementById(id);
	CalId.focus();
	winCal.style.visibility = 'hidden';
}

function changeBorder(element, col, oldBgColor)
{
	if (col === 0)
	{
		element.style.background = HoverColor;
		element.style.borderColor = &quot;black&quot;;
		element.style.cursor = &quot;pointer&quot;;
	}

	else
	{
		if (oldBgColor)
		{
			element.style.background = oldBgColor;
		}
		else
		{
			element.style.background = &quot;white&quot;;
		}
		element.style.borderColor = &quot;white&quot;;
		element.style.cursor = &quot;auto&quot;;
	}
}

function selectDate(element, date) {
    Cal.Date = date;
    selDate = new Date(Cal.Year, Cal.Month, Cal.Date);
    element.style.background = SelDateColor;
    RenderCssCal();
}

function pickIt(evt)
{
	var objectID,
	dom,
	de,
	b;
	// accesses the element that generates the event and retrieves its ID
	if (document.addEventListener)
	{ // w3c
		objectID = evt.target.id;
		if (objectID.indexOf(calSpanID) !== -1)
		{
			dom = document.getElementById(objectID);
			cnLeft = evt.pageX;
			cnTop = evt.pageY;

			if (dom.offsetLeft)
			{
				cnLeft = (cnLeft - dom.offsetLeft);
				cnTop = (cnTop - dom.offsetTop);
			}
		}

		// get mouse position on click
		xpos = (evt.pageX);
		ypos = (evt.pageY);
	}

	else
	{ // IE
		objectID = event.srcElement.id;
		cnLeft = event.offsetX;
		cnTop = (event.offsetY);

		// get mouse position on click
		de = document.documentElement;
		b = document.body;

		xpos = event.clientX + (de.scrollLeft || b.scrollLeft) - (de.clientLeft || 0);
		ypos = event.clientY + (de.scrollTop || b.scrollTop) - (de.clientTop || 0);
	}

	// verify if this is a valid element to pick
	if (objectID.indexOf(calSpanID) !== -1)
	{
		domStyle = document.getElementById(objectID).style;
	}

	if (domStyle)
	{
		domStyle.zIndex = 100;
		return false;
	}

	else
	{
		domStyle = null;
		return;
	}
}



function dragIt(evt)
{
	if (domStyle)
	{
		if (document.addEventListener)
		{ //for IE
			domStyle.left = (event.clientX - cnLeft + document.body.scrollLeft) + 'px';
			domStyle.top = (event.clientY - cnTop + document.body.scrollTop) + 'px';
		}
		else
		{  //Firefox
			domStyle.left = (evt.clientX - cnLeft + document.body.scrollLeft) + 'px';
			domStyle.top = (evt.clientY - cnTop + document.body.scrollTop) + 'px';
		}
	}
}

// performs a single increment or decrement
function nextStep(whatSpinner, direction)
{
	if (whatSpinner === &quot;Hour&quot;)
	{
		if (direction === &quot;plus&quot;)
		{
			Cal.SetHour(Cal.Hours + 1);
			RenderCssCal();
		}
		else if (direction === &quot;minus&quot;)
		{
			Cal.SetHour(Cal.Hours - 1);
			RenderCssCal();
		}
	}
	else if (whatSpinner === &quot;Minute&quot;)
	{
		if (direction === &quot;plus&quot;)
		{
			Cal.SetMinute(parseInt(Cal.Minutes, 10) + 1);
			RenderCssCal();
		}
		else if (direction === &quot;minus&quot;)
		{
			Cal.SetMinute(parseInt(Cal.Minutes, 10) - 1);
			RenderCssCal();
		}
	}

}

// starts the time spinner
function startSpin(whatSpinner, direction)
{
	document.thisLoop = setInterval(function ()
	{
		nextStep(whatSpinner, direction);
	}, 125); //125 ms
}

//stops the time spinner
function stopSpin()
{
	clearInterval(document.thisLoop);
}

function dropIt()
{
	stopSpin();

	if (domStyle)
	{
		domStyle = null;
	}
}

// Default events configuration

document.onmousedown = pickIt;
document.onmousemove = dragIt;
document.onmouseup = dropIt;

<DIV class="printfooter">
Retrieved from &quot;<A href="http://2014.igem.org/Team:DTU-Denmark/datetimepicker_css.js">http://2014.igem.org/Team:DTU-Denmark/datetimepicker_css.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:DTU-Denmark/datetimepicker_css.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:DTU-Denmark/datetimepicker_css.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:DTU-Denmark/datetimepicker_css.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:DTU-Denmark/datetimepicker_css.js&amp;oldid=36304" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2014.igem.org:Privacy_policy" title="2014.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2014.igem.org:General_disclaimer" title="2014.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>