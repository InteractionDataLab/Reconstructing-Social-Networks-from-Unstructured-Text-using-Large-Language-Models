<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Nevada_timeline_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Nevada/timeline.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Nevada/timeline.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Nevada/timeline.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Nevada/timeline.js&amp;action=history">History               </A></LI><LI style="color:white;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Nevada/timeline.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform">Â </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Nevada/timeline.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2014.igem.org</H3><P>/*
</P><PRE>   TimelineJS - ver. 2014-10-10-19-54-13 - 2014-10-10
   Copyright (c) 2012-2013 Northwestern University
   a project of the Northwestern University Knight Lab, originally created by Zach Wise
   <A href="https://github.com/NUKnightLab/TimelineJS" class="external free" rel="nofollow">https://github.com/NUKnightLab/TimelineJS</A>
   This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
   If a copy of the MPL was not distributed with this file, You can obtain one at <A href="http://mozilla.org/MPL/2.0/" class="external free" rel="nofollow">http://mozilla.org/MPL/2.0/</A>.
</PRE><UL><LI>/
</LI></UL>
(function(){var initializing=false,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this;initializing=false;for(var name in prop){prototype[name]=typeof prop[name]==&quot;function&quot;&amp;&amp;typeof _super[name]==&quot;function&quot;&amp;&amp;fnTest.test(prop[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret}}(name,prop[name]):prop[name]}function Class(){if(!initializing&amp;&amp;this.init)this.init.apply(this,arguments)}Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=arguments.callee;return Class}})();var global=function(){return this||(1,eval)(&quot;this&quot;)}();if(typeof VMM==&quot;undefined&quot;){var VMM=Class.extend({});VMM.debug=true;VMM.master_config={init:function(){return this},sizes:{api:{width:0,height:0}},vp:&quot;Pellentesque nibh felis, eleifend id, commodo in, interdum vitae, leo&quot;,api_keys_master:{flickr:&quot;RAIvxHY4hE/Elm5cieh4X5ptMyDpj7MYIxziGxi0WGCcy1s+yr7rKQ==&quot;,google:&quot;uQKadH1VMlCsp560gN2aOiMz4evWkl1s34yryl3F/9FJOsn+/948CbBUvKLN46U=&quot;,twitter:&quot;&quot;},timers:{api:7e3},api:{pushques:[]},twitter:{active:false,array:[],api_loaded:false,que:[]},flickr:{active:false,array:[],api_loaded:false,que:[]},youtube:{active:false,array:[],api_loaded:false,que:[]},vimeo:{active:false,array:[],api_loaded:false,que:[]},vine:{active:false,array:[],api_loaded:false,que:[]},webthumb:{active:false,array:[],api_loaded:false,que:[]},googlemaps:{active:false,map_active:false,places_active:false,array:[],api_loaded:false,que:[]},googledocs:{active:false,array:[],api_loaded:false,que:[]},googleplus:{active:false,array:[],api_loaded:false,que:[]},wikipedia:{active:false,array:[],api_loaded:false,que:[],tries:0},soundcloud:{active:false,array:[],api_loaded:false,que:[]}}.init();VMM.createElement=function(tag,value,cName,attrs,styles){var ce=&quot;&quot;;if(tag!=null&amp;&amp;tag!=&quot;&quot;){ce+=&quot;&lt;&quot;+tag;if(cName!=null&amp;&amp;cName!=&quot;&quot;){ce+=&quot; class='&quot;+cName+&quot;'&quot;}if(attrs!=null&amp;&amp;attrs!=&quot;&quot;){ce+=&quot; &quot;+attrs}if(styles!=null&amp;&amp;styles!=&quot;&quot;){ce+=&quot; style='&quot;+styles+&quot;'&quot;}ce+=&quot;&gt;&quot;;if(value!=null&amp;&amp;value!=&quot;&quot;){ce+=value}ce=ce+&quot;&lt;/&quot;+tag+&quot;&gt;&quot;}return ce};VMM.createMediaElement=function(media,caption,credit){var ce=&quot;&quot;;var _valid=false;ce+=&quot;<DIV class="media">&quot;;if(media!=null&amp;&amp;media!=&quot;&quot;){valid=true;ce+=&quot;&lt;img src='&quot;+media+&quot;'&gt;&quot;;if(credit!=null&amp;&amp;credit!=&quot;&quot;){ce+=VMM.createElement(&quot;div&quot;,credit,&quot;credit&quot;)}if(caption!=null&amp;&amp;caption!=&quot;&quot;){ce+=VMM.createElement(&quot;div&quot;,caption,&quot;caption&quot;)}}ce+=&quot;</DIV>&quot;;return ce};VMM.hideUrlBar=function(){var win=window,doc=win.document;if(!location.hash||!win.addEventListener){window.scrollTo(0,1);var scrollTop=1,bodycheck=setInterval(function(){if(doc.body){clearInterval(bodycheck);scrollTop=&quot;scrollTop&quot;in doc.body?doc.body.scrollTop:1;win.scrollTo(0,scrollTop===1?0:1)}},15);win.addEventListener(&quot;load&quot;,function(){setTimeout(function(){win.scrollTo(0,scrollTop===1?0:1)},0)},false)}}}function trace(msg){if(VMM.debug){if(window.console){console.log(msg)}else if(typeof jsTrace!=&quot;undefined&quot;){jsTrace.send(msg)}else{}}}Date.prototype.getWeek=function(){var onejan=new Date(this.getFullYear(),0,1);return Math.ceil(((this-onejan)/864e5+onejan.getDay()+1)/7)};Date.prototype.getDayOfYear=function(){var onejan=new Date(this.getFullYear(),0,1);return Math.ceil((this-onejan)/864e5)};var is={Null:function(a){return a===null},Undefined:function(a){return a===undefined},nt:function(a){return a===null||a===undefined},Function:function(a){return typeof a===&quot;function&quot;?a.constructor.toString().match(/Function/)!==null:false},String:function(a){return typeof a===&quot;string&quot;?true:typeof a===&quot;object&quot;?a.constructor.toString().match(/string/i)!==null:false},Array:function(a){return typeof a===&quot;object&quot;?a.constructor.toString().match(/array/i)!==null||a.length!==undefined:false},Boolean:function(a){return typeof a===&quot;boolean&quot;?true:typeof a===&quot;object&quot;?a.constructor.toString().match(/boolean/i)!==null:false},Date:function(a){return typeof a===&quot;date&quot;?true:typeof a===&quot;object&quot;?a.constructor.toString().match(/date/i)!==null:false},HTML:function(a){return typeof a===&quot;object&quot;?a.constructor.toString().match(/html/i)!==null:false},Number:function(a){return typeof a===&quot;number&quot;?true:typeof a===&quot;object&quot;?a.constructor.toString().match(/Number/)!==null:false},Object:function(a){return typeof a===&quot;object&quot;?a.constructor.toString().match(/object/i)!==null:false},RegExp:function(a){return typeof a===&quot;function&quot;?a.constructor.toString().match(/regexp/i)!==null:false}};var type={of:function(a){for(var i in is){if(is[i](a)){return i.toLowerCase()}}}};if(typeof VMM!=&quot;undefined&quot;){VMM.smoothScrollTo=function(elem,duration,ease){if(typeof jQuery!=&quot;undefined&quot;){var _ease=&quot;easein&quot;,_duration=1e3;if(duration!=null){if(duration&lt;1){_duration=1}else{_duration=Math.round(duration)}}if(ease!=null&amp;&amp;ease!=&quot;&quot;){_ease=ease}if(jQuery(window).scrollTop()!=VMM.Lib.offset(elem).top){VMM.Lib.animate(&quot;html,body&quot;,_duration,_ease,{scrollTop:VMM.Lib.offset(elem).top})}}};VMM.attachElement=function(element,content){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).html(content)}};VMM.appendElement=function(element,content){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).append(content)}};VMM.getHTML=function(element){var e;if(typeof jQuery!=&quot;undefined&quot;){e=jQuery(element).html();return e}};VMM.getElement=function(element,p){var e;if(typeof jQuery!=&quot;undefined&quot;){if(p){e=jQuery(element).parent().get(0)}else{e=jQuery(element).get(0)}return e}};VMM.bindEvent=function(element,the_handler,the_event_type,event_data){var e;var _event_type=&quot;click&quot;;var _event_data={};if(the_event_type!=null&amp;&amp;the_event_type!=&quot;&quot;){_event_type=the_event_type}if(_event_data!=null&amp;&amp;_event_data!=&quot;&quot;){_event_data=event_data}if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).bind(_event_type,_event_data,the_handler)}};VMM.unbindEvent=function(element,the_handler,the_event_type){var e;var _event_type=&quot;click&quot;;var _event_data={};if(the_event_type!=null&amp;&amp;the_event_type!=&quot;&quot;){_event_type=the_event_type}if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).unbind(_event_type,the_handler)}};VMM.fireEvent=function(element,the_event_type,the_data){var e;var _event_type=&quot;click&quot;;var _data=[];if(the_event_type!=null&amp;&amp;the_event_type!=&quot;&quot;){_event_type=the_event_type}if(the_data!=null&amp;&amp;the_data!=&quot;&quot;){_data=the_data}if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).trigger(_event_type,_data)}};VMM.getJSON=function(url,data,callback){if(typeof jQuery!=&quot;undefined&quot;){jQuery.ajaxSetup({timeout:3e3});if(VMM.Browser.browser==&quot;Explorer&quot;&amp;&amp;parseInt(VMM.Browser.version,10)&gt;=7&amp;&amp;window.XDomainRequest){trace(&quot;IE JSON&quot;);var ie_url=url;if(ie_url.match(&quot;^http://&quot;)){return jQuery.getJSON(ie_url,data,callback)}else if(ie_url.match(&quot;^https://&quot;)){ie_url=ie_url.replace(&quot;https://&quot;,&quot;http://&quot;);return jQuery.getJSON(ie_url,data,callback)}else{return jQuery.getJSON(url,data,callback)}}else{return jQuery.getJSON(url,data,callback)}}};VMM.parseJSON=function(the_json){if(typeof jQuery!=&quot;undefined&quot;){return jQuery.parseJSON(the_json)}};VMM.appendAndGetElement=function(append_to_element,tag,cName,content){var e,_tag=&quot;<DIV>&quot;,_class=&quot;&quot;,_content=&quot;&quot;,_id=&quot;&quot;;if(tag!=null&amp;&amp;tag!=&quot;&quot;){_tag=tag}if(cName!=null&amp;&amp;cName!=&quot;&quot;){_class=cName}if(content!=null&amp;&amp;content!=&quot;&quot;){_content=content}if(typeof jQuery!=&quot;undefined&quot;){e=jQuery(tag);e.addClass(_class);e.html(_content);jQuery(append_to_element).append(e)}return e};VMM.Lib={init:function(){return this},hide:function(element,duration){if(duration!=null&amp;&amp;duration!=&quot;&quot;){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).hide(duration)}}else{if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).hide()}}},remove:function(element){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).remove()}},detach:function(element){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).detach()}},append:function(element,value){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).append(value)}},prepend:function(element,value){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).prepend(value)}},show:function(element,duration){if(duration!=null&amp;&amp;duration!=&quot;&quot;){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).show(duration)}}else{if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).show()}}},load:function(element,callback_function,event_data){var _event_data={elem:element};if(_event_data!=null&amp;&amp;_event_data!=&quot;&quot;){_event_data=event_data}if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).load(_event_data,callback_function)}},addClass:function(element,cName){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).addClass(cName)}},removeClass:function(element,cName){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).removeClass(cName)}},attr:function(element,aName,value){if(value!=null&amp;&amp;value!=&quot;&quot;){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).attr(aName,value)}}else{if(typeof jQuery!=&quot;undefined&quot;){return jQuery(element).attr(aName)}}},prop:function(element,aName,value){if(typeof jQuery==&quot;undefined&quot;||!/[1-9]\.[3-9].[1-9]/.test(jQuery.fn.jquery)){VMM.Lib.attribute(element,aName,value)}else{jQuery(element).prop(aName,value)}},attribute:function(element,aName,value){if(value!=null&amp;&amp;value!=&quot;&quot;){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).attr(aName,value)}}else{if(typeof jQuery!=&quot;undefined&quot;){return jQuery(element).attr(aName)}}},visible:function(element,show){if(show!=null){if(typeof jQuery!=&quot;undefined&quot;){if(show){jQuery(element).show(0)}else{jQuery(element).hide(0)}}}else{if(typeof jQuery!=&quot;undefined&quot;){if(jQuery(element).is(&quot;:visible&quot;)){return true}else{return false}}}},css:function(element,prop,value){if(value!=null&amp;&amp;value!=&quot;&quot;){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).css(prop,value)}}else{if(typeof jQuery!=&quot;undefined&quot;){return jQuery(element).css(prop)}}},cssmultiple:function(element,propval){if(typeof jQuery!=&quot;undefined&quot;){return jQuery(element).css(propval)}},offset:function(element){var p;if(typeof jQuery!=&quot;undefined&quot;){p=jQuery(element).offset()}return p},position:function(element){var p;if(typeof jQuery!=&quot;undefined&quot;){p=jQuery(element).position()}return p},width:function(element,s){if(s!=null&amp;&amp;s!=&quot;&quot;){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).width(s)}}else{if(typeof jQuery!=&quot;undefined&quot;){return jQuery(element).width()}}},height:function(element,s){if(s!=null&amp;&amp;s!=&quot;&quot;){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).height(s)}}else{if(typeof jQuery!=&quot;undefined&quot;){return jQuery(element).height()}}},toggleClass:function(element,cName){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).toggleClass(cName)}},each:function(element,return_function){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).each(return_function)}},html:function(element,str){var e;if(typeof jQuery!=&quot;undefined&quot;){e=jQuery(element).html();return e}if(str!=null&amp;&amp;str!=&quot;&quot;){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).html(str)}}else{var e;if(typeof jQuery!=&quot;undefined&quot;){e=jQuery(element).html();return e}}},find:function(element,selec){if(typeof jQuery!=&quot;undefined&quot;){return jQuery(element).find(selec)}},stop:function(element){if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).stop()}},delay_animate:function(delay,element,duration,ease,att,callback_function){if(VMM.Browser.device==&quot;mobile&quot;||VMM.Browser.device==&quot;tablet&quot;){var _tdd=Math.round(duration/1500*10)/10,__duration=_tdd+&quot;s&quot;;VMM.Lib.css(element,&quot;-webkit-transition&quot;,&quot;all &quot;+__duration+&quot; ease&quot;);VMM.Lib.css(element,&quot;-moz-transition&quot;,&quot;all &quot;+__duration+&quot; ease&quot;);VMM.Lib.css(element,&quot;-o-transition&quot;,&quot;all &quot;+__duration+&quot; ease&quot;);VMM.Lib.css(element,&quot;-ms-transition&quot;,&quot;all &quot;+__duration+&quot; ease&quot;);VMM.Lib.css(element,&quot;transition&quot;,&quot;all &quot;+__duration+&quot; ease&quot;);VMM.Lib.cssmultiple(element,_att)}else{if(typeof jQuery!=&quot;undefined&quot;){jQuery(element).delay(delay).animate(att,{duration:duration,easing:ease})}}},animate:function(element,duration,ease,att,que,callback_function){var _ease=&quot;easein&quot;,_que=false,_duration=1e3,_att={};if(duration!=null){if(duration&lt;1){_duration=1}else{_duration=Math.round(duration)}}if(ease!=null&amp;&amp;ease!=&quot;&quot;){_ease=ease}if(que!=null&amp;&amp;que!=&quot;&quot;){_que=que}if(att!=null){_att=att}else{_att={opacity:0}}if(VMM.Browser.device==&quot;mobile&quot;||VMM.Browser.device==&quot;tablet&quot;){var _tdd=Math.round(_duration/1500*10)/10,__duration=_tdd+&quot;s&quot;;_ease=&quot; cubic-bezier(0.33, 0.66, 0.66, 1)&quot;;for(x in _att){if(Object.prototype.hasOwnProperty.call(_att,x)){trace(x+&quot; to &quot;+_att[x]);VMM.Lib.css(element,&quot;-webkit-transition&quot;,x+&quot; &quot;+__duration+_ease);VMM.Lib.css(element,&quot;-moz-transition&quot;,x+&quot; &quot;+__duration+_ease);VMM.Lib.css(element,&quot;-o-transition&quot;,x+&quot; &quot;+__duration+_ease);VMM.Lib.css(element,&quot;-ms-transition&quot;,x+&quot; &quot;+__duration+_ease);VMM.Lib.css(element,&quot;transition&quot;,x+&quot; &quot;+__duration+_ease)}}VMM.Lib.cssmultiple(element,_att)}else{if(typeof jQuery!=&quot;undefined&quot;){if(callback_function!=null&amp;&amp;callback_function!=&quot;&quot;){jQuery(element).animate(_att,{queue:_que,duration:_duration,easing:_ease,complete:callback_function})}else{jQuery(element).animate(_att,{queue:_que,duration:_duration,easing:_ease})}}}}}}if(typeof jQuery!=&quot;undefined&quot;){(function(jQuery){if(window.XDomainRequest){jQuery.ajaxTransport(function(s){if(s.crossDomain&amp;&amp;s.async){if(s.timeout){s.xdrTimeout=s.timeout;delete s.timeout}var xdr;return{send:function(_,complete){function callback(status,statusText,responses,responseHeaders){xdr.onload=xdr.onerror=xdr.ontimeout=jQuery.noop;xdr=undefined;complete(status,statusText,responses,responseHeaders)}xdr=new XDomainRequest;xdr.open(s.type,s.url);xdr.onload=function(){callback(200,&quot;OK&quot;,{text:xdr.responseText},&quot;Content-Type: &quot;+xdr.contentType)};xdr.onerror=function(){callback(404,&quot;Not Found&quot;)};if(s.xdrTimeout){xdr.ontimeout=function(){callback(0,&quot;timeout&quot;)};xdr.timeout=s.xdrTimeout}xdr.send(s.hasContent&amp;&amp;s.data||null)},abort:function(){if(xdr){xdr.onerror=jQuery.noop();xdr.abort()}}}}})}})(jQuery);jQuery.easing[&quot;jswing&quot;]=jQuery.easing[&quot;swing&quot;];jQuery.extend(jQuery.easing,{def:&quot;easeOutQuad&quot;,swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInExpo:function(x,t,b,c,d){return t==0?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)&lt;1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)&lt;1)return c/2*t*t+b;return-c/2*(--t*(t-2)-1)+b}})}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.Browser==&quot;undefined&quot;){VMM.Browser={init:function(){this.browser=this.searchString(this.dataBrowser)||&quot;An unknown browser&quot;;this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||&quot;an unknown version&quot;;this.tridentVersion=this.searchTridentVersion(navigator.userAgent);this.OS=this.searchString(this.dataOS)||&quot;an unknown OS&quot;;this.device=this.searchDevice(navigator.userAgent);this.orientation=this.searchOrientation(window.orientation)},searchOrientation:function(orientation){var orient=&quot;&quot;;if(orientation==0||orientation==180){orient=&quot;portrait&quot;}else if(orientation==90||orientation==-90){orient=&quot;landscape&quot;}else{orient=&quot;normal&quot;}return orient},searchDevice:function(d){var device=&quot;&quot;;if(d.match(/Android/i)||d.match(/iPhone|iPod/i)){device=&quot;mobile&quot;}else if(d.match(/iPad/i)){device=&quot;tablet&quot;}else if(d.match(/BlackBerry/i)||d.match(/IEMobile/i)){device=&quot;other mobile&quot;}else{device=&quot;desktop&quot;}return device},searchString:function(data){for(var i=0;i&lt;data.length;i++){var dataString=data[i].string,dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1){return data[i].identity}}else if(dataProp){return data[i].identity}}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},searchTridentVersion:function(dataString){var index=dataString.indexOf(&quot;Trident/&quot;);if(index==-1)return 0;return parseFloat(dataString.substring(index+8))},dataBrowser:[{string:navigator.userAgent,subString:&quot;Chrome&quot;,identity:&quot;Chrome&quot;},{string:navigator.userAgent,subString:&quot;OmniWeb&quot;,versionSearch:&quot;OmniWeb/&quot;,identity:&quot;OmniWeb&quot;},{string:navigator.vendor,subString:&quot;Apple&quot;,identity:&quot;Safari&quot;,versionSearch:&quot;Version&quot;},{prop:window.opera,identity:&quot;Opera&quot;,versionSearch:&quot;Version&quot;},{string:navigator.vendor,subString:&quot;iCab&quot;,identity:&quot;iCab&quot;},{string:navigator.vendor,subString:&quot;KDE&quot;,identity:&quot;Konqueror&quot;},{string:navigator.userAgent,subString:&quot;Firefox&quot;,identity:&quot;Firefox&quot;},{string:navigator.vendor,subString:&quot;Camino&quot;,identity:&quot;Camino&quot;},{string:navigator.userAgent,subString:&quot;Netscape&quot;,identity:&quot;Netscape&quot;},{string:navigator.userAgent,subString:&quot;MSIE&quot;,identity:&quot;Explorer&quot;,versionSearch:&quot;MSIE&quot;},{string:navigator.userAgent,subString:&quot;Gecko&quot;,identity:&quot;Mozilla&quot;,versionSearch:&quot;rv&quot;},{string:navigator.userAgent,subString:&quot;Mozilla&quot;,identity:&quot;Netscape&quot;,versionSearch:&quot;Mozilla&quot;}],dataOS:[{string:navigator.platform,subString:&quot;Win&quot;,identity:&quot;Windows&quot;},{string:navigator.platform,subString:&quot;Mac&quot;,identity:&quot;Mac&quot;},{string:navigator.userAgent,subString:&quot;iPhone&quot;,identity:&quot;iPhone/iPod&quot;},{string:navigator.userAgent,subString:&quot;iPad&quot;,identity:&quot;iPad&quot;},{string:navigator.platform,subString:&quot;Linux&quot;,identity:&quot;Linux&quot;}]};VMM.Browser.init()}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.FileExtention==&quot;undefined&quot;){VMM.FileExtention={googleDocType:function(url){var fileName=url.replace(/\s\s*$/,&quot;&quot;),fileExtension=&quot;&quot;,validFileExtensions=[&quot;DOC&quot;,&quot;DOCX&quot;,&quot;XLS&quot;,&quot;XLSX&quot;,&quot;PPT&quot;,&quot;PPTX&quot;,&quot;PDF&quot;,&quot;PAGES&quot;,&quot;AI&quot;,&quot;PSD&quot;,&quot;TIFF&quot;,&quot;DXF&quot;,&quot;SVG&quot;,&quot;EPS&quot;,&quot;PS&quot;,&quot;TTF&quot;,&quot;XPS&quot;,&quot;ZIP&quot;,&quot;RAR&quot;],flag=false;fileExtension=fileName.substr(fileName.length-5,5);for(var i=0;i&lt;validFileExtensions.length;i++){if(fileExtension.toLowerCase().match(validFileExtensions[i].toString().toLowerCase())||fileName.match(&quot;docs.google.com&quot;)){flag=true}}return flag}}}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.Date==&quot;undefined&quot;){VMM.Date={init:function(){return this},dateformats:{year:&quot;yyyy&quot;,month_short:&quot;mmm&quot;,month:&quot;mmmm yyyy&quot;,full_short:&quot;mmm d&quot;,full:&quot;mmmm d',' yyyy&quot;,time_short:&quot;h:MM:ss TT&quot;,time_no_seconds_short:&quot;h:MM TT&quot;,time_no_seconds_small_date:&quot;h:MM TT'<SMALL>'mmmm d',' yyyy'</SMALL>'&quot;,full_long:&quot;mmm d',' yyyy 'at' hh:MM TT&quot;,full_long_small_date:&quot;hh:MM TT'<SMALL>mmm d',' yyyy'</SMALL>'&quot;},month:[&quot;January&quot;,&quot;February&quot;,&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;,&quot;August&quot;,&quot;September&quot;,&quot;October&quot;,&quot;November&quot;,&quot;December&quot;],month_abbr:[&quot;Jan.&quot;,&quot;Feb.&quot;,&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;,&quot;Aug.&quot;,&quot;Sept.&quot;,&quot;Oct.&quot;,&quot;Nov.&quot;,&quot;Dec.&quot;],day:[&quot;Sunday&quot;,&quot;Monday&quot;,&quot;Tuesday&quot;,&quot;Wednesday&quot;,&quot;Thursday&quot;,&quot;Friday&quot;,&quot;Saturday&quot;],day_abbr:[&quot;Sun.&quot;,&quot;Mon.&quot;,&quot;Tues.&quot;,&quot;Wed.&quot;,&quot;Thurs.&quot;,&quot;Fri.&quot;,&quot;Sat.&quot;],hour:[1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12],hour_suffix:[&quot;am&quot;],bc_format:{year:&quot;yyyy&quot;,month_short:&quot;mmm&quot;,month:&quot;mmmm yyyy&quot;,full_short:&quot;mmm d&quot;,full:&quot;mmmm d',' yyyy&quot;,time_no_seconds_short:&quot;h:MM TT&quot;,time_no_seconds_small_date:&quot;dddd', 'h:MM TT'<SMALL>'mmmm d',' yyyy'</SMALL>'&quot;,full_long:&quot;dddd',' mmm d',' yyyy 'at' hh:MM TT&quot;,full_long_small_date:&quot;hh:MM TT'<SMALL>'dddd',' mmm d',' yyyy'</SMALL>'&quot;},setLanguage:function(lang){trace(&quot;SET DATE LANGUAGE&quot;);VMM.Date.dateformats=lang.dateformats;VMM.Date.month=lang.date.month;VMM.Date.month_abbr=lang.date.month_abbr;VMM.Date.day=lang.date.day;VMM.Date.day_abbr=lang.date.day_abbr;dateFormat.i18n.dayNames=lang.date.day_abbr.concat(lang.date.day);dateFormat.i18n.monthNames=lang.date.month_abbr.concat(lang.date.month)},parse:function(d,precision){&quot;use strict&quot;;var date,date_array,time_array,time_parse,p={year:false,month:false,day:false,hour:false,minute:false,second:false,millisecond:false};if(type.of(d)==&quot;date&quot;){trace(&quot;DEBUG THIS, ITs A DATE&quot;);date=d}else{date=new Date(0,0,1,0,0,0,0);if(d.match(/,/gi)){date_array=d.split(&quot;,&quot;);for(var i=0;i&lt;date_array.length;i++){date_array[i]=parseInt(date_array[i],10)}if(date_array[0]){date.setFullYear(date_array[0]);p.year=true}if(date_array[1]){date.setMonth(date_array[1]-1);p.month=true}if(date_array[2]){date.setDate(date_array[2]);p.day=true}if(date_array[3]){date.setHours(date_array[3]);p.hour=true}if(date_array[4]){date.setMinutes(date_array[4]);p.minute=true}if(date_array[5]){date.setSeconds(date_array[5]);if(date_array[5]&gt;=1){p.second=true}}if(date_array[6]){date.setMilliseconds(date_array[6]);if(date_array[6]&gt;=1){p.millisecond=true}}}else if(d.match(&quot;/&quot;)){if(d.match(&quot; &quot;)){time_parse=d.split(&quot; &quot;);if(d.match(&quot;:&quot;)){time_array=time_parse[1].split(&quot;:&quot;);if(time_array[0]&gt;=0){date.setHours(time_array[0]);p.hour=true}if(time_array[1]&gt;=0){date.setMinutes(time_array[1]);p.minute=true}if(time_array[2]&gt;=0){date.setSeconds(time_array[2]);p.second=true}if(time_array[3]&gt;=0){date.setMilliseconds(time_array[3]);p.millisecond=true}}date_array=time_parse[0].split(&quot;/&quot;)}else{date_array=d.split(&quot;/&quot;)}if(date_array[2]){date.setFullYear(date_array[2]);p.year=true}if(date_array[0]&gt;=0){date.setMonth(date_array[0]-1);p.month=true}if(date_array[1]&gt;=0){if(date_array[1].length&gt;2){date.setFullYear(date_array[1]);p.year=true}else{date.setDate(date_array[1]);p.day=true}}}else if(d.match(&quot;now&quot;)){var now=new Date;date.setFullYear(now.getFullYear());p.year=true;date.setMonth(now.getMonth());p.month=true;date.setDate(now.getDate());p.day=true;if(d.match(&quot;hours&quot;)){date.setHours(now.getHours());p.hour=true}if(d.match(&quot;minutes&quot;)){date.setHours(now.getHours());date.setMinutes(now.getMinutes());p.hour=true;p.minute=true}if(d.match(&quot;seconds&quot;)){date.setHours(now.getHours());date.setMinutes(now.getMinutes());date.setSeconds(now.getSeconds());p.hour=true;p.minute=true;p.second=true}if(d.match(&quot;milliseconds&quot;)){date.setHours(now.getHours());date.setMinutes(now.getMinutes());date.setSeconds(now.getSeconds());date.setMilliseconds(now.getMilliseconds());p.hour=true;p.minute=true;p.second=true;p.millisecond=true}}else if(d.length&lt;=8){p.year=true;date.setFullYear(parseInt(d,10));date.setMonth(0);date.setDate(1);date.setHours(0);date.setMinutes(0);date.setSeconds(0);date.setMilliseconds(0)}else if(d.match(&quot;T&quot;)){if(navigator.userAgent.match(/MSIE\s(?!9.0)/)){time_parse=d.split(&quot;T&quot;);if(d.match(&quot;:&quot;)){time_array=time_parse[1].split(&quot;:&quot;);if(time_array[0]&gt;=1){date.setHours(time_array[0]);p.hour=true}if(time_array[1]&gt;=1){date.setMinutes(time_array[1]);p.minute=true}if(time_array[2]&gt;=1){date.setSeconds(time_array[2]);if(time_array[2]&gt;=1){p.second=true}}if(time_array[3]&gt;=1){date.setMilliseconds(time_array[3]);if(time_array[3]&gt;=1){p.millisecond=true}}}date_array=time_parse[0].split(&quot;-&quot;);if(date_array[0]){date.setFullYear(date_array[0]);p.year=true}if(date_array[1]&gt;=0){date.setMonth(date_array[1]-1);p.month=true}if(date_array[2]&gt;=0){date.setDate(date_array[2]);p.day=true}}else{date=new Date(Date.parse(d));p.year=true;p.month=true;p.day=true;p.hour=true;p.minute=true;if(date.getSeconds()&gt;=1){p.second=true}if(date.getMilliseconds()&gt;=1){p.millisecond=true}}}else{date=new Date(parseInt(d.slice(0,4),10),parseInt(d.slice(4,6),10)-1,parseInt(d.slice(6,8),10),parseInt(d.slice(8,10),10),parseInt(d.slice(10,12),10));p.year=true;p.month=true;p.day=true;p.hour=true;p.minute=true;if(date.getSeconds()&gt;=1){p.second=true}if(date.getMilliseconds()&gt;=1){p.millisecond=true}}}if(precision!=null&amp;&amp;precision!=&quot;&quot;){return{date:date,precision:p}}else{return date}},prettyDate:function(d,is_abbr,p,d2){var _date,_date2,format,bc_check,is_pair=false,bc_original,bc_number,bc_string;if(d2!=null&amp;&amp;d2!=&quot;&quot;&amp;&amp;typeof d2!=&quot;undefined&quot;){is_pair=true;trace(&quot;D2 &quot;+d2)}if(type.of(d)==&quot;date&quot;){if(type.of(p)==&quot;object&quot;){if(p.millisecond||p.second&amp;&amp;d.getSeconds()&gt;=1){if(is_abbr){format=VMM.Date.dateformats.time_short}else{format=VMM.Date.dateformats.time_short}}else if(p.minute){if(is_abbr){format=VMM.Date.dateformats.time_no_seconds_short}else{format=VMM.Date.dateformats.time_no_seconds_small_date}}else if(p.hour){if(is_abbr){format=VMM.Date.dateformats.time_no_seconds_short}else{format=VMM.Date.dateformats.time_no_seconds_small_date}}else if(p.day){if(is_abbr){format=VMM.Date.dateformats.full_short}else{format=VMM.Date.dateformats.full}}else if(p.month){if(is_abbr){format=VMM.Date.dateformats.month_short}else{format=VMM.Date.dateformats.month}}else if(p.year){format=VMM.Date.dateformats.year}else{format=VMM.Date.dateformats.year}}else{if(d.getMonth()===0&amp;&amp;d.getDate()==1&amp;&amp;d.getHours()===0&amp;&amp;d.getMinutes()===0){format=VMM.Date.dateformats.year}else if(d.getDate()&lt;=1&amp;&amp;d.getHours()===0&amp;&amp;d.getMinutes()===0){if(is_abbr){format=VMM.Date.dateformats.month_short}else{format=VMM.Date.dateformats.month}}else if(d.getHours()===0&amp;&amp;d.getMinutes()===0){if(is_abbr){format=VMM.Date.dateformats.full_short}else{format=VMM.Date.dateformats.full}}else if(d.getMinutes()===0){if(is_abbr){format=VMM.Date.dateformats.time_no_seconds_short}else{format=VMM.Date.dateformats.time_no_seconds_small_date}}else{if(is_abbr){format=VMM.Date.dateformats.time_no_seconds_short}else{format=VMM.Date.dateformats.full_long}}}_date=dateFormat(d,format,false);bc_check=_date.split(&quot; &quot;);for(var i=0;i&lt;bc_check.length;i++){if(parseInt(bc_check[i],10)&lt;0){trace(&quot;YEAR IS BC&quot;);bc_original=bc_check[i];bc_number=Math.abs(parseInt(bc_check[i],10));bc_string=bc_number.toString()+&quot; B.C.&quot;;_date=_date.replace(bc_original,bc_string)}}if(is_pair){_date2=dateFormat(d2,format,false);bc_check=_date2.split(&quot; &quot;);for(var j=0;j&lt;bc_check.length;j++){if(parseInt(bc_check[j],10)&lt;0){trace(&quot;YEAR IS BC&quot;);bc_original=bc_check[j];bc_number=Math.abs(parseInt(bc_check[j],10));bc_string=bc_number.toString()+&quot; B.C.&quot;;_date2=_date2.replace(bc_original,bc_string)}}}}else{trace(&quot;NOT A VALID DATE?&quot;);trace(d)}if(is_pair){return _date+&quot; â &quot;+_date2}else{return _date}}}.init();var dateFormat=function(){var token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[WLloSZ]|&quot;[^&quot;]*&quot;|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,pad=function(val,len){val=String(val);len=len||2;while(val.length&lt;len)val=&quot;0&quot;+val;return val};return function(date,mask,utc){var dF=dateFormat;if(arguments.length==1&amp;&amp;Object.prototype.toString.call(date)==&quot;[object String]&quot;&amp;&amp;!/\d/.test(date)){mask=date;date=undefined}if(isNaN(date)){trace(&quot;invalid date &quot;+date)}mask=String(dF.masks[mask]||mask||dF.masks[&quot;default&quot;]);if(mask.slice(0,4)==&quot;UTC:&quot;){mask=mask.slice(4);utc=true}var _=utc?&quot;getUTC&quot;:&quot;get&quot;,d=date[_+&quot;Date&quot;](),D=date[_+&quot;Day&quot;](),m=date[_+&quot;Month&quot;](),y=date[_+&quot;FullYear&quot;](),H=date[_+&quot;Hours&quot;](),M=date[_+&quot;Minutes&quot;](),s=date[_+&quot;Seconds&quot;](),L=date[_+&quot;Milliseconds&quot;](),W=date.getWeek(),o=utc?0:date.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:dF.i18n.dayNames[D],dddd:dF.i18n.dayNames[D+7],m:m+1,mm:pad(m+1),mmm:dF.i18n.monthNames[m],mmmm:dF.i18n.monthNames[m+12],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),l:pad(L,3),L:pad(L&gt;99?Math.round(L/10):L),t:H&lt;12?&quot;a&quot;:&quot;p&quot;,tt:H&lt;12?&quot;am&quot;:&quot;pm&quot;,T:H&lt;12?&quot;A&quot;:&quot;P&quot;,TT:H&lt;12?&quot;AM&quot;:&quot;PM&quot;,Z:utc?&quot;UTC&quot;:(String(date).match(timezone)||[&quot;&quot;]).pop().replace(timezoneClip,&quot;&quot;),o:(o&gt;0?&quot;-&quot;:&quot;+&quot;)+pad(Math.floor(Math.abs(o)/60)*100+Math.abs(o)%60,4),S:[&quot;th&quot;,&quot;st&quot;,&quot;nd&quot;,&quot;rd&quot;][d%10&gt;3?0:(d%100-d%10!=10)*d%10],W:W};return mask.replace(token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length-1)})}}();dateFormat.masks={&quot;default&quot;:&quot;ddd mmm dd yyyy HH:MM:ss&quot;,shortDate:&quot;m/d/yy&quot;,mediumDate:&quot;mmm d, yyyy&quot;,longDate:&quot;mmmm d, yyyy&quot;,fullDate:&quot;dddd, mmmm d, yyyy&quot;,shortTime:&quot;h:MM TT&quot;,mediumTime:&quot;h:MM:ss TT&quot;,longTime:&quot;h:MM:ss TT Z&quot;,isoDate:&quot;yyyy-mm-dd&quot;,isoTime:&quot;HH:MM:ss&quot;,isoDateTime:&quot;yyyy-mm-dd'T'HH:MM:ss&quot;,isoUtcDateTime:&quot;UTC:yyyy-mm-dd'T'HH:MM:ss'Z'&quot;};dateFormat.i18n={dayNames:[&quot;Sun&quot;,&quot;Mon&quot;,&quot;Tue&quot;,&quot;Wed&quot;,&quot;Thu&quot;,&quot;Fri&quot;,&quot;Sat&quot;,&quot;Sunday&quot;,&quot;Monday&quot;,&quot;Tuesday&quot;,&quot;Wednesday&quot;,&quot;Thursday&quot;,&quot;Friday&quot;,&quot;Saturday&quot;],monthNames:[&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sep&quot;,&quot;Oct&quot;,&quot;Nov&quot;,&quot;Dec&quot;,&quot;January&quot;,&quot;February&quot;,&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;,&quot;August&quot;,&quot;September&quot;,&quot;October&quot;,&quot;November&quot;,&quot;December&quot;]};Date.prototype.format=function(mask,utc){return dateFormat(this,mask,utc)}}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.Util==&quot;undefined&quot;){VMM.Util={init:function(){return this},removeRange:function(array,from,to){var rest=array.slice((to||from)+1||array.length);array.length=from&lt;0?array.length+from:from;return array.push.apply(array,rest)},correctProtocol:function(url){var loc=window.parent.location.protocol.toString(),prefix=&quot;&quot;,the_url=url.split(&quot;://&quot;,2);if(loc.match(&quot;http&quot;)){prefix=loc}else{prefix=&quot;https&quot;}return prefix+&quot;://&quot;+the_url[1]},mergeConfig:function(config_main,config_to_merge){var x;for(x in config_to_merge){if(Object.prototype.hasOwnProperty.call(config_to_merge,x)){config_main[x]=config_to_merge[x]}}return config_main},getObjectAttributeByIndex:function(obj,index){if(typeof obj!=&quot;undefined&quot;){var i=0;for(var attr in obj){if(index===i){return obj[attr]}i++}return&quot;&quot;}else{return&quot;&quot;}},ordinal:function(n){return[&quot;th&quot;,&quot;st&quot;,&quot;nd&quot;,&quot;rd&quot;][!(n%10&gt;3||Math.floor(n%100/10)==1)*(n%10)]},randomBetween:function(min,max){return Math.floor(Math.random()*(max-min+1)+min)},average:function(a){var r={mean:0,variance:0,deviation:0},t=a.length;for(var m,s=0,l=t;l--;s+=a[l]);for(m=r.mean=s/t,l=t,s=0;l--;s+=Math.pow(a[l]-m,2));return r.deviation=Math.sqrt(r.variance=s/t),r},customSort:function(a,b){var a1=a,b1=b;if(a1==b1)return 0;return a1&gt;b1?1:-1},deDupeArray:function(arr){var i,len=arr.length,out=[],obj={};for(i=0;i&lt;len;i++){obj[arr[i]]=0}for(i in obj){out.push(i)}return out},wordCount:function(s){var fullStr=s+&quot; &quot;;var initial_whitespace_rExp=/^[^A-Za-z0-9\'\-]+/gi;var left_trimmedStr=fullStr.replace(initial_whitespace_rExp,&quot;&quot;);var non_alphanumerics_rExp=/[^A-Za-z0-9\'\-]+/gi;var cleanedStr=left_trimmedStr.replace(non_alphanumerics_rExp,&quot; &quot;);var splitString=cleanedStr.split(&quot; &quot;);var word_count=splitString.length-1;if(fullStr.length&lt;2){word_count=0}return word_count},ratio:{fit:function(w,h,ratio_w,ratio_h){var _fit={width:0,height:0};_fit.width=w;_fit.height=Math.round(w/ratio_w*ratio_h);if(_fit.height&gt;h){_fit.height=h;_fit.width=Math.round(h/ratio_h*ratio_w);if(_fit.width&gt;w){trace(&quot;FIT: DIDN'T FIT!!! &quot;)}}return _fit},r16_9:function(w,h){if(w!==null&amp;&amp;w!==&quot;&quot;){return Math.round(h/16*9)}else if(h!==null&amp;&amp;h!==&quot;&quot;){return Math.round(w/9*16)}},r4_3:function(w,h){if(w!==null&amp;&amp;w!==&quot;&quot;){return Math.round(h/4*3)}else if(h!==null&amp;&amp;h!==&quot;&quot;){return Math.round(w/3*4)}}},doubledigit:function(n){return(n&lt;10?&quot;0&quot;:&quot;&quot;)+n},truncateWords:function(s,min,max){if(!min)min=30;if(!max)max=min;var initial_whitespace_rExp=/^[^A-Za-z0-9\'\-]+/gi;var left_trimmedStr=s.replace(initial_whitespace_rExp,&quot;&quot;);var words=left_trimmedStr.split(&quot; &quot;);var result=[];min=Math.min(words.length,min);max=Math.min(words.length,max);for(var i=0;i&lt;min;i++){result.push(words[i])}for(var j=min;i&lt;max;i++){var word=words[i];result.push(word);if(word.charAt(word.length-1)==&quot;.&quot;){break}}return result.join(&quot; &quot;)},linkify:function(text,targets,is_touch){var urlPattern=/\b(?:https?|ftp):\/\/[a-z0-9-+&amp;@#\/%?=~_|!:,.;]*[a-z0-9-+&amp;@#\/%=~_|]/gim;var pseudoUrlPattern=/(^|[^\/])(www\.[\S]+(\b|$))/gim;var emailAddressPattern=/(([a-zA-Z0-9_\-\.]+)@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6}))+/gim;return text.replace(urlPattern,&quot;&lt;a target='_blank' href='$&amp;' onclick='void(0)'&gt;$&amp;&lt;/a&gt;&quot;).replace(pseudoUrlPattern,&quot;$1&lt;a target='_blank' onclick='void(0)' href='<A href="http://$2'" class="external free" rel="nofollow">http://$2'</A>&gt;$2&lt;/a&gt;&quot;).replace(emailAddressPattern,&quot;&lt;a target='_blank' onclick='void(0)' href='<A href="mailto:$1'" class="external free" rel="nofollow">mailto:$1'</A>&gt;$1&lt;/a&gt;&quot;)},linkify_with_twitter:function(text,targets,is_touch){var urlPattern=/\b(?:https?|ftp):\/\/[a-z0-9-+&amp;@#\/%?=~_|!:,.;]*[a-z0-9-+&amp;@#\/%=~_|]/gim;var url_pattern=/(\()((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&amp;'()*+,;=:\/?#[\]@%]+)(\))|(\[)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&amp;'()*+,;=:\/?#[\]@%]+)(\])|(\{)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&amp;'()*+,;=:\/?#[\]@%]+)(\})|(&lt;|&amp;(?:lt|#60|#x3c);)((?:ht|f)tps?:\/\/[a-z0-9\-._~!$&amp;'()*+,;=:\/?#[\]@%]+)(&gt;|&amp;(?:gt|#62|#x3e);)|((?:^|[^=\s'&quot;\]])\s*['&quot;]?|[^=\s]\s+)(\b(?:ht|f)tps?:\/\/[a-z0-9\-._~!$'()*+,;=:\/?#[\]@%]+(?:(?!&amp;(?:gt|#0*62|#x0*3e);|&amp;(?:amp|apos|quot|#0*3[49]|#x0*2[27]);[.!&amp;',:?;]?(?:[^a-z0-9\-._~!$&amp;'()*+,;=:\/?#[\]@%]|$))&amp;[a-z0-9\-._~!$'()*+,;=:\/?#[\]@%]*)*[a-z0-9\-_~$()*+=\/#[\]@%])/gim;var url_replace='$1$4$7$10$13&lt;a href=&quot;$2$5$8$11$14&quot; target=&quot;_blank&quot; class=&quot;hyphenate&quot;&gt;$2$5$8$11$14&lt;/a&gt;$3$6$9$12';var pseudoUrlPattern=/(^|[^\/])(www\.[\S]+(\b|$))/gim;
function replaceURLWithHTMLLinks(text){var exp=/(\b(https?|ftp|file):\/\/([-A-Z0-9+&amp;@#%?=~_|!:,.;]*)([-A-Z0-9+&amp;@#%?\/=~_|!:,.;]*)[-A-Z0-9+&amp;@#\/%=~_|])/gi;return text.replace(exp,&quot;&lt;a href='$1' target='_blank'&gt;$3&lt;/a&gt;&quot;)}var emailAddressPattern=/(([a-zA-Z0-9_\-\.]+)@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6}))+/gim;var twitterHandlePattern=/\B@([\w-]+)/gm;var twitterSearchPattern=/(#([\w]+))/g;return text.replace(url_pattern,url_replace).replace(pseudoUrlPattern,&quot;$1&lt;a target='_blank' class='hyphenate' onclick='void(0)' href='<A href="http://$2'" class="external free" rel="nofollow">http://$2'</A>&gt;$2&lt;/a&gt;&quot;).replace(emailAddressPattern,&quot;&lt;a target='_blank' onclick='void(0)' href='<A href="mailto:$1'" class="external free" rel="nofollow">mailto:$1'</A>&gt;$1&lt;/a&gt;&quot;).replace(twitterHandlePattern,&quot;&lt;a href='<A href="http://twitter.com/$1'" class="external free" rel="nofollow">http://twitter.com/$1'</A> target='_blank' onclick='void(0)'&gt;@$1&lt;/a&gt;&quot;)},linkify_wikipedia:function(text){var urlPattern=/<I>]*&gt;(.*?)&lt;\/i&gt;/gim;return text.replace(urlPattern,&quot;&lt;a target='_blank' href='<A href="http://en.wikipedia.org/wiki/$&amp;'" class="external free" rel="nofollow">http://en.wikipedia.org/wiki/$&amp;'</A> onclick='void(0)'&gt;$&amp;&lt;/a&gt;&quot;).replace(/&lt;i\b[^&gt;]*&gt;/gim,&quot;&quot;).replace(/&lt;\/i&gt;/gim,&quot;&quot;).replace(/<B>]*&gt;/gim,&quot;&quot;).replace(/&lt;\/b&gt;/gim,&quot;&quot;)},unlinkify:function(text){if(!text)return text;text=text.replace(/&lt;a\b[^&gt;]*&gt;/i,&quot;&quot;);text=text.replace(/&lt;\/a&gt;/i,&quot;&quot;);return text},untagify:function(text){if(!text){return text}text=text.replace(/&lt;\/?\s*\w.*?&gt;/g,&quot;&quot;);return text},nl2br:function(text){return text.replace(/(\r\n|[\r\n]|\\n|\\r)/g,&quot;&quot;)},unique_ID:function(size){var getRandomNumber=function(range){return Math.floor(Math.random()*range)};var getRandomChar=function(){var chars=&quot;abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ&quot;;return chars.substr(getRandomNumber(62),1)};var randomID=function(size){var str=&quot;&quot;;for(var i=0;i&lt;size;i++){str+=getRandomChar()}return str};return randomID(size)},isEven:function(n){return n%2===0?true:false},getUrlVars:function(string){var str=string.toString();if(str.match(&quot;&amp;&quot;)){str=str.replace(&quot;&amp;&quot;,&quot;&amp;&quot;)}else if(str.match(&quot;&amp;&quot;)){str=str.replace(&quot;&amp;&quot;,&quot;&amp;&quot;)}else if(str.match(&quot;&amp;&quot;)){str=str.replace(&quot;&amp;&quot;,&quot;&amp;&quot;)}var vars=[],hash;var hashes=str.slice(str.indexOf(&quot;?&quot;)+1).split(&quot;&amp;&quot;);for(var i=0;i&lt;hashes.length;i++){hash=hashes[i].split(&quot;=&quot;);vars.push(hash[0]);vars[hash[0]]=hash[1]}return vars},toHTML:function(text){text=this.nl2br(text);text=this.linkify(text);return text.replace(/\s\s/g,&quot;Â Â &quot;)},toCamelCase:function(s,forceLowerCase){if(forceLowerCase!==false)forceLowerCase=true;var sps=(forceLowerCase?s.toLowerCase():s).split(&quot; &quot;);for(var i=0;i&lt;sps.length;i++){sps[i]=sps[i].substr(0,1).toUpperCase()+sps[i].substr(1)}return sps.join(&quot; &quot;)},properQuotes:function(str){return str.replace(/\&quot;([^\&quot;]*)\&quot;/gi,&quot;â$1â&quot;)},niceNumber:function(nStr){nStr+=&quot;&quot;;x=nStr.split(&quot;.&quot;);x1=x[0];x2=x.length&gt;1?&quot;.&quot;+x[1]:&quot;&quot;;var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,&quot;$1&quot;+&quot;,&quot;+&quot;$2&quot;)}return x1+x2},toTitleCase:function(t){if(VMM.Browser.browser==&quot;Explorer&quot;&amp;&amp;parseInt(VMM.Browser.version,10)&gt;=7){return t.replace(&quot;_&quot;,&quot;%20&quot;)}else{var __TitleCase={__smallWords:[&quot;a&quot;,&quot;an&quot;,&quot;and&quot;,&quot;as&quot;,&quot;at&quot;,&quot;but&quot;,&quot;by&quot;,&quot;en&quot;,&quot;for&quot;,&quot;if&quot;,&quot;in&quot;,&quot;of&quot;,&quot;on&quot;,&quot;or&quot;,&quot;the&quot;,&quot;to&quot;,&quot;v[.]?&quot;,&quot;via&quot;,&quot;vs[.]?&quot;],init:function(){this.__smallRE=this.__smallWords.join(&quot;|&quot;);this.__lowerCaseWordsRE=new RegExp(&quot;\\b(&quot;+this.__smallRE+&quot;)\\b&quot;,&quot;gi&quot;);this.__firstWordRE=new RegExp(&quot;^([^a-zA-Z0-9 \\r\\n\\t]*)(&quot;+this.__smallRE+&quot;)\\b&quot;,&quot;gi&quot;);this.__lastWordRE=new RegExp(&quot;\\b(&quot;+this.__smallRE+&quot;)([^a-zA-Z0-9 \\r\\n\\t]*)$&quot;,&quot;gi&quot;)},toTitleCase:function(string){var line=&quot;&quot;;var split=string.split(/([:.;?!][ ]|(?:[ ]|^)[&quot;â])/);for(var i=0;i&lt;split.length;++i){var s=split[i];s=s.replace(/\b([a-zA-Z][a-z.'â]*)\b/g,this.__titleCaseDottedWordReplacer);s=s.replace(this.__lowerCaseWordsRE,this.__lowerReplacer);s=s.replace(this.__firstWordRE,this.__firstToUpperCase);s=s.replace(this.__lastWordRE,this.__firstToUpperCase);line+=s}line=line.replace(/ V(s?)\. /g,&quot; v$1. &quot;);line=line.replace(/(['â])S\b/g,&quot;$1s&quot;);line=line.replace(/\b(AT&amp;T|Q&amp;A)\b/gi,this.__upperReplacer);return line},__titleCaseDottedWordReplacer:function(w){return w.match(/[a-zA-Z][.][a-zA-Z]/)?w:__TitleCase.__firstToUpperCase(w)},__lowerReplacer:function(w){return w.toLowerCase()},__upperReplacer:function(w){return w.toUpperCase()},__firstToUpperCase:function(w){var split=w.split(/(^[^a-zA-Z0-9]*[a-zA-Z0-9])(.*)$/);if(split[1]){split[1]=split[1].toUpperCase()}return split.join(&quot;&quot;)}};__TitleCase.init();t=t.replace(/_/g,&quot; &quot;);t=__TitleCase.toTitleCase(t);return t}}}.init()}LazyLoad=function(doc){var env,head,pending={},pollCount=0,queue={css:[],js:[]},styleSheets=doc.styleSheets;function createNode(name,attrs){var node=doc.createElement(name),attr;for(attr in attrs){if(attrs.hasOwnProperty(attr)){node.setAttribute(attr,attrs[attr])}}return node}function finish(type){var p=pending[type],callback,urls;if(p){callback=p.callback;urls=p.urls;urls.shift();pollCount=0;if(!urls.length){callback&amp;&amp;callback.call(p.context,p.obj);pending[type]=null;queue[type].length&amp;&amp;load(type)}}}function getEnv(){var ua=navigator.userAgent;env={async:doc.createElement(&quot;script&quot;).async===true};(env.webkit=/AppleWebKit\//.test(ua))||(env.ie=/MSIE/.test(ua))||(env.opera=/Opera/.test(ua))||(env.gecko=/Gecko\//.test(ua))||(env.unknown=true)}function load(type,urls,callback,obj,context){var _finish=function(){finish(type)},isCSS=type===&quot;css&quot;,nodes=[],i,len,node,p,pendingUrls,url;env||getEnv();if(urls){urls=typeof urls===&quot;string&quot;?[urls]:urls.concat();if(isCSS||env.async||env.gecko||env.opera){queue[type].push({urls:urls,callback:callback,obj:obj,context:context})}else{for(i=0,len=urls.length;i&lt;len;++i){queue[type].push({urls:[urls[i]],callback:i===len-1?callback:null,obj:obj,context:context})}}}if(pending[type]||!(p=pending[type]=queue[type].shift())){return}head||(head=doc.head||doc.getElementsByTagName(&quot;head&quot;)[0]);pendingUrls=p.urls;for(i=0,len=pendingUrls.length;i&lt;len;++i){url=pendingUrls[i];if(isCSS){node=env.gecko?createNode(&quot;style&quot;):createNode(&quot;link&quot;,{href:url,rel:&quot;stylesheet&quot;})}else{node=createNode(&quot;script&quot;,{src:url});node.async=false}node.className=&quot;lazyload&quot;;node.setAttribute(&quot;charset&quot;,&quot;utf-8&quot;);if(env.ie&amp;&amp;!isCSS){node.onreadystatechange=function(){if(/loaded|complete/.test(node.readyState)){node.onreadystatechange=null;_finish()}}}else if(isCSS&amp;&amp;(env.gecko||env.webkit)){if(env.webkit){p.urls[i]=node.href;pollWebKit()}else{node.innerHTML='@import &quot;'+url+'&quot;;';pollGecko(node)}}else{node.onload=node.onerror=_finish}nodes.push(node)}for(i=0,len=nodes.length;i&lt;len;++i){head.appendChild(nodes[i])}}function pollGecko(node){var hasRules;try{hasRules=!!node.sheet.cssRules}catch(ex){pollCount+=1;if(pollCount&lt;200){setTimeout(function(){pollGecko(node)},50)}else{hasRules&amp;&amp;finish(&quot;css&quot;)}return}finish(&quot;css&quot;)}function pollWebKit(){var css=pending.css,i;if(css){i=styleSheets.length;while(--i&gt;=0){if(styleSheets[i].href===css.urls[0]){finish(&quot;css&quot;);break}}pollCount+=1;if(css){if(pollCount&lt;200){setTimeout(pollWebKit,50)}else{finish(&quot;css&quot;)}}}}return{css:function(urls,callback,obj,context){load(&quot;css&quot;,urls,callback,obj,context)},js:function(urls,callback,obj,context){load(&quot;js&quot;,urls,callback,obj,context)}}}(this.document);LoadLib=function(doc){var loaded=[];function isLoaded(url){var i=0,has_loaded=false;for(i=0;i&lt;loaded.length;i++){if(loaded[i]==url){has_loaded=true}}if(has_loaded){return true}else{loaded.push(url);return false}}return{css:function(urls,callback,obj,context){if(!isLoaded(urls)){LazyLoad.css(urls,callback,obj,context)}},js:function(urls,callback,obj,context){if(!isLoaded(urls)){LazyLoad.js(urls,callback,obj,context)}}}}(this.document);if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.Language==&quot;undefined&quot;){VMM.Language={lang:&quot;en&quot;,api:{wikipedia:&quot;en&quot;},date:{month:[&quot;January&quot;,&quot;February&quot;,&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;,&quot;August&quot;,&quot;September&quot;,&quot;October&quot;,&quot;November&quot;,&quot;December&quot;],month_abbr:[&quot;Jan.&quot;,&quot;Feb.&quot;,&quot;March&quot;,&quot;April&quot;,&quot;May&quot;,&quot;June&quot;,&quot;July&quot;,&quot;Aug.&quot;,&quot;Sept.&quot;,&quot;Oct.&quot;,&quot;Nov.&quot;,&quot;Dec.&quot;],day:[&quot;Sunday&quot;,&quot;Monday&quot;,&quot;Tuesday&quot;,&quot;Wednesday&quot;,&quot;Thursday&quot;,&quot;Friday&quot;,&quot;Saturday&quot;],day_abbr:[&quot;Sun.&quot;,&quot;Mon.&quot;,&quot;Tues.&quot;,&quot;Wed.&quot;,&quot;Thurs.&quot;,&quot;Fri.&quot;,&quot;Sat.&quot;]},dateformats:{year:&quot;yyyy&quot;,month_short:&quot;mmm&quot;,month:&quot;mmmm yyyy&quot;,full_short:&quot;mmm d&quot;,full:&quot;mmmm d',' yyyy&quot;,time_short:&quot;h:MM:ss TT&quot;,time_no_seconds_short:&quot;h:MM TT&quot;,time_no_seconds_small_date:&quot;h:MM TT'<SMALL>'mmmm d',' yyyy'</SMALL>'&quot;,full_long:&quot;mmm d',' yyyy 'at' h:MM TT&quot;,full_long_small_date:&quot;h:MM TT'<SMALL>mmm d',' yyyy'</SMALL>'&quot;},messages:{loading_timeline:&quot;Loading Timeline... &quot;,return_to_title:&quot;Return to Title&quot;,expand_timeline:&quot;Expand Timeline&quot;,contract_timeline:&quot;Contract Timeline&quot;,wikipedia:&quot;From Wikipedia, the free encyclopedia&quot;,loading_content:&quot;Loading Content&quot;,loading:&quot;Loading&quot;}}}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.ExternalAPI==&quot;undefined&quot;){VMM.ExternalAPI={keys:{google:&quot;&quot;,flickr:&quot;&quot;,twitter:&quot;&quot;},keys_master:{vp:&quot;Pellentesque nibh felis, eleifend id, commodo in, interdum vitae, leo&quot;,flickr:&quot;RAIvxHY4hE/Elm5cieh4X5ptMyDpj7MYIxziGxi0WGCcy1s+yr7rKQ==&quot;,google:&quot;jwNGnYw4hE9lmAez4ll0QD+jo6SKBJFknkopLS4FrSAuGfIwyj57AusuR0s8dAo=&quot;,twitter:&quot;&quot;},init:function(){return this},setKeys:function(d){VMM.ExternalAPI.keys=d},pushQues:function(){if(VMM.master_config.googlemaps.active){VMM.ExternalAPI.googlemaps.pushQue()}if(VMM.master_config.youtube.active){VMM.ExternalAPI.youtube.pushQue()}if(VMM.master_config.soundcloud.active){VMM.ExternalAPI.soundcloud.pushQue()}if(VMM.master_config.googledocs.active){VMM.ExternalAPI.googledocs.pushQue()}if(VMM.master_config.googleplus.active){VMM.ExternalAPI.googleplus.pushQue()}if(VMM.master_config.wikipedia.active){VMM.ExternalAPI.wikipedia.pushQue()}if(VMM.master_config.vimeo.active){VMM.ExternalAPI.vimeo.pushQue()}if(VMM.master_config.vine.active){VMM.ExternalAPI.vine.pushQue()}if(VMM.master_config.twitter.active){VMM.ExternalAPI.twitter.pushQue()}if(VMM.master_config.flickr.active){VMM.ExternalAPI.flickr.pushQue()}if(VMM.master_config.webthumb.active){VMM.ExternalAPI.webthumb.pushQue()}},twitter:{tweetArray:[],get:function(m){var tweet={mid:m.id,id:m.uid};VMM.master_config.twitter.que.push(tweet);VMM.master_config.twitter.active=true},create:function(tweet,callback){var id=tweet.mid.toString(),error_obj={twitterid:tweet.mid},the_url=&quot;//api.twitter.com/1/statuses/show.json?id=&quot;+tweet.mid+&quot;&amp;include_entities=true&amp;callback=?&quot;;VMM.ExternalAPI.twitter.getOEmbed(tweet,callback)},errorTimeOut:function(tweet){trace(&quot;TWITTER JSON ERROR TIMEOUT &quot;+tweet.mid);VMM.attachElement(&quot;#&quot;+tweet.id.toString(),VMM.MediaElement.loadingmessage(&quot;Still waiting on Twitter: &quot;+tweet.mid));VMM.getJSON(&quot;//api.twitter.com/1/account/rate_limit_status.json&quot;,function(d){trace(&quot;REMAINING TWITTER API CALLS &quot;+d.remaining_hits);trace(&quot;TWITTER RATE LIMIT WILL RESET AT &quot;+d.reset_time);var mes=&quot;&quot;;if(d.remaining_hits==0){mes=&quot;<P>You've reached the maximum number of tweets you can load in an hour.</P>&quot;;mes+=&quot;<P>You can view tweets again starting at: &quot;+d.reset_time+&quot;</P>&quot;}else{mes=&quot;<P>Still waiting on Twitter. &quot;+tweet.mid+&quot;</P>&quot;}VMM.attachElement(&quot;#&quot;+tweet.id.toString(),VMM.MediaElement.loadingmessage(mes))})},errorTimeOutOembed:function(tweet){trace(&quot;TWITTER JSON ERROR TIMEOUT &quot;+tweet.mid);VMM.attachElement(&quot;#&quot;+tweet.id.toString(),VMM.MediaElement.loadingmessage(&quot;Still waiting on Twitter: &quot;+tweet.mid))},pushQue:function(){if(VMM.master_config.twitter.que.length&gt;0){VMM.ExternalAPI.twitter.create(VMM.master_config.twitter.que[0],VMM.ExternalAPI.twitter.pushQue);VMM.Util.removeRange(VMM.master_config.twitter.que,0)}},getOEmbed:function(tweet,callback){var the_url=&quot;//api.twitter.com/1/statuses/oembed.json?id=&quot;+tweet.mid+&quot;&amp;omit_script=true&amp;include_entities=true&amp;callback=?&quot;,twitter_timeout=setTimeout(VMM.ExternalAPI.twitter.errorTimeOutOembed,VMM.master_config.timers.api,tweet);VMM.getJSON(the_url,function(d){var twit=&quot;&quot;,tuser=&quot;&quot;;twit+=d.html.split(&quot;&lt;/p&gt;â&quot;)[0]+&quot;&lt;/p&gt;&lt;/blockquote&gt;&quot;;tuser=d.author_url.split(&quot;twitter.com/&quot;)[1];twit+=&quot;<DIV class="vcard author">&quot;;twit+=&quot;&lt;a class='screen-name url' href='&quot;+d.author_url+&quot;' target='_blank'&gt;&quot;;twit+=&quot;&quot;;twit+=&quot;<SPAN class="fn">&quot;+d.author_name+&quot;</SPAN>&quot;;twit+=&quot;<SPAN class="nickname">@&quot;+tuser+&quot;</SPAN>&quot;;twit+=&quot;&lt;/a&gt;&quot;;twit+=&quot;</DIV>&quot;;VMM.attachElement(&quot;#&quot;+tweet.id.toString(),twit);VMM.attachElement(&quot;#text_thumb_&quot;+tweet.id.toString(),d.html);VMM.attachElement(&quot;#marker_content_&quot;+tweet.id.toString(),d.html)}).error(function(jqXHR,textStatus,errorThrown){trace(&quot;TWITTER error&quot;);trace(&quot;TWITTER ERROR: &quot;+textStatus+&quot; &quot;+jqXHR.responseText);clearTimeout(twitter_timeout);VMM.attachElement(&quot;#&quot;+tweet.id,VMM.MediaElement.loadingmessage(&quot;ERROR LOADING TWEET &quot;+tweet.mid))}).success(function(d){clearTimeout(twitter_timeout);callback()})},getHTML:function(id){var the_url=&quot;//api.twitter.com/1/statuses/oembed.json?id=&quot;+id+&quot;&amp;omit_script=true&amp;include_entities=true&amp;callback=?&quot;;VMM.getJSON(the_url,VMM.ExternalAPI.twitter.onJSONLoaded)},onJSONLoaded:function(d){trace(&quot;TWITTER JSON LOADED&quot;);var id=d.id;VMM.attachElement(&quot;#&quot;+id,VMM.Util.linkify_with_twitter(d.html))},parseTwitterDate:function(d){var date=new Date(Date.parse(d));return date},prettyParseTwitterDate:function(d){var date=new Date(Date.parse(d));return VMM.Date.prettyDate(date,true)},getTweets:function(tweets){var tweetArray=[];var number_of_tweets=tweets.length;for(var i=0;i&lt;tweets.length;i++){var twitter_id=&quot;&quot;;if(tweets[i].tweet.match(&quot;status/&quot;)){twitter_id=tweets[i].tweet.split(&quot;status/&quot;)[1]}else if(tweets[i].tweet.match(&quot;statuses/&quot;)){twitter_id=tweets[i].tweet.split(&quot;statuses/&quot;)[1]}else{twitter_id=&quot;&quot;}var the_url=&quot;//api.twitter.com/1/statuses/show.json?id=&quot;+twitter_id+&quot;&amp;include_entities=true&amp;callback=?&quot;;VMM.getJSON(the_url,function(d){var tweet={};var twit=&quot;<DIV class="twitter"><BLOCKQUOTE><P>&quot;;var td=VMM.Util.linkify_with_twitter(d.text,&quot;_blank&quot;);twit+=td;twit+=&quot;</P>&quot;;twit+=&quot;â &quot;+d.user.name+&quot; (&lt;a href='<A href="https://twitter.com/" class="external free" rel="nofollow">https://twitter.com/</A>&quot;+d.user.screen_name+&quot;'&gt;@&quot;+d.user.screen_name+&quot;&lt;/a&gt;) &lt;a href='<A href="https://twitter.com/" class="external free" rel="nofollow">https://twitter.com/</A>&quot;+d.user.screen_name+&quot;/status/&quot;+d.id+&quot;'&gt;&quot;+VMM.ExternalAPI.twitter.prettyParseTwitterDate(d.created_at)+&quot; &lt;/a&gt;</BLOCKQUOTE></DIV>&quot;;tweet.content=twit;tweet.raw=d;tweetArray.push(tweet);if(tweetArray.length==number_of_tweets){var the_tweets={tweetdata:tweetArray};VMM.fireEvent(global,&quot;TWEETSLOADED&quot;,the_tweets)}}).success(function(){trace(&quot;second success&quot;)}).error(function(){trace(&quot;error&quot;)}).complete(function(){trace(&quot;complete&quot;)})}},getTweetSearch:function(tweets,number_of_tweets){var _number_of_tweets=40;if(number_of_tweets!=null&amp;&amp;number_of_tweets!=&quot;&quot;){_number_of_tweets=number_of_tweets}var the_url=&quot;//search.twitter.com/search.json?q=&quot;+tweets+&quot;&amp;rpp=&quot;+_number_of_tweets+&quot;&amp;include_entities=true&amp;result_type=mixed&quot;;var tweetArray=[];VMM.getJSON(the_url,function(d){for(var i=0;i&lt;d.results.length;i++){var tweet={};var twit=&quot;<DIV class="twitter"><BLOCKQUOTE><P>&quot;;var td=VMM.Util.linkify_with_twitter(d.results[i].text,&quot;_blank&quot;);twit+=td;twit+=&quot;</P>&quot;;twit+=&quot;â &quot;+d.results[i].from_user_name+&quot; (&lt;a href='<A href="https://twitter.com/" class="external free" rel="nofollow">https://twitter.com/</A>&quot;+d.results[i].from_user+&quot;'&gt;@&quot;+d.results[i].from_user+&quot;&lt;/a&gt;) &lt;a href='<A href="https://twitter.com/" class="external free" rel="nofollow">https://twitter.com/</A>&quot;+d.results[i].from_user+&quot;/status/&quot;+d.id+&quot;'&gt;&quot;+VMM.ExternalAPI.twitter.prettyParseTwitterDate(d.results[i].created_at)+&quot; &lt;/a&gt;</BLOCKQUOTE></DIV>&quot;;tweet.content=twit;tweet.raw=d.results[i];tweetArray.push(tweet)}var the_tweets={tweetdata:tweetArray};VMM.fireEvent(global,&quot;TWEETSLOADED&quot;,the_tweets)})},prettyHTML:function(id,secondary){var id=id.toString();var error_obj={twitterid:id};var the_url=&quot;//api.twitter.com/1/statuses/show.json?id=&quot;+id+&quot;&amp;include_entities=true&amp;callback=?&quot;;var twitter_timeout=setTimeout(VMM.ExternalAPI.twitter.errorTimeOut,VMM.master_config.timers.api,id);VMM.getJSON(the_url,VMM.ExternalAPI.twitter.formatJSON).error(function(jqXHR,textStatus,errorThrown){trace(&quot;TWITTER error&quot;);trace(&quot;TWITTER ERROR: &quot;+textStatus+&quot; &quot;+jqXHR.responseText);VMM.attachElement(&quot;#twitter_&quot;+id,&quot;<P>ERROR LOADING TWEET &quot;+id+&quot;</P>&quot;)}).success(function(d){clearTimeout(twitter_timeout);if(secondary){VMM.ExternalAPI.twitter.secondaryMedia(d)}})},formatJSON:function(d){var id=d.id_str;var twit=&quot;<BLOCKQUOTE><P>&quot;;var td=VMM.Util.linkify_with_twitter(d.text,&quot;_blank&quot;);twit+=td;twit+=&quot;</P></BLOCKQUOTE>&quot;;twit+=&quot;<DIV class="vcard author">&quot;;twit+=&quot;&lt;a class='screen-name url' href='<A href="https://twitter.com/" class="external free" rel="nofollow">https://twitter.com/</A>&quot;+d.user.screen_name+&quot;' data-screen-name='&quot;+d.user.screen_name+&quot;' target='_blank'&gt;&quot;;twit+=&quot;<SPAN class="avatar">&lt;img src=' &quot;+d.user.profile_image_url+&quot;'  alt=<I>&gt;</I></SPAN>&quot;;twit+=&quot;<SPAN class="fn">&quot;+d.user.name+&quot;</SPAN>&quot;;twit+=&quot;<SPAN class="nickname">@&quot;+d.user.screen_name+&quot;</SPAN>&quot;;twit+=&quot;&lt;/a&gt;&quot;;twit+=&quot;</DIV>&quot;;if(typeof d.entities.media!=&quot;undefined&quot;){if(d.entities.media[0].type==&quot;photo&quot;){twit+=&quot;&lt;img src=' &quot;+d.entities.media[0].media_url+&quot;'  alt=</B></I><B>&gt;&quot;}}VMM.attachElement(&quot;#twitter_&quot;+id.toString(),twit);VMM.attachElement(&quot;#text_thumb_&quot;+id.toString(),d.text)}},googlemaps:{maptype:&quot;TERRAIN&quot;,setMapType:function(d){if(d!=&quot;&quot;){VMM.ExternalAPI.googlemaps.maptype=d}},get:function(m){var timer,api_key,map_url;m.vars=VMM.Util.getUrlVars(m.id);if(VMM.ExternalAPI.keys.google!=&quot;&quot;){api_key=VMM.ExternalAPI.keys.google}else{api_key=Aes.Ctr.decrypt(VMM.ExternalAPI.keys_master.google,VMM.ExternalAPI.keys_master.vp,256)}map_url=&quot;//maps.googleapis.com/maps/api/js?key=&quot;+api_key+&quot;&amp;v=3.9&amp;libraries=places&amp;sensor=false&amp;callback=VMM.ExternalAPI.googlemaps.onMapAPIReady&quot;;if(VMM.master_config.googlemaps.active){VMM.master_config.googlemaps.que.push(m)}else{VMM.master_config.googlemaps.que.push(m);if(VMM.master_config.googlemaps.api_loaded){}else{LoadLib.js(map_url,function(){trace(&quot;Google Maps API Library Loaded&quot;)})}}},create:function(m){VMM.ExternalAPI.googlemaps.createAPIMap(m)},createiFrameMap:function(m){var embed_url=m.id+&quot;&amp;output=embed&quot;,mc=&quot;&quot;,unique_map_id=m.uid.toString()+&quot;_gmap&quot;;mc+=&quot;<DIV class="google-map" id=".22.2Bunique_map_id.2B.22" style="width=100%;height=100%;">&quot;;mc+=&quot;&lt;iframe width='100%' height='100%' frameborder='0' scrolling='no' marginheight='0' marginwidth='0' src='&quot;+embed_url+&quot;'&gt;&lt;/iframe&gt;&quot;;mc+=&quot;</DIV>&quot;;VMM.attachElement(&quot;#&quot;+m.uid,mc)},createAPIMap:function(m){var map_attribution=&quot;&quot;,layer,map,map_options,unique_map_id=m.uid.toString()+&quot;_gmap&quot;,map_attribution_html=&quot;&quot;,location=new google.maps.LatLng(41.875696,-87.624207),latlong,zoom=11,has_location=false,has_zoom=false,api_limit=false,map_bounds;function mapProvider(name){if(name in VMM.ExternalAPI.googlemaps.map_providers){map_attribution=VMM.ExternalAPI.googlemaps.map_attribution[VMM.ExternalAPI.googlemaps.map_providers[name].attribution];return VMM.ExternalAPI.googlemaps.map_providers[name]}else{if(VMM.ExternalAPI.googlemaps.defaultType(name)){trace(&quot;GOOGLE MAP DEFAULT TYPE&quot;);return google.maps.MapTypeId[name.toUpperCase()]}else{trace(&quot;Not a maptype: &quot;+name)}}}google.maps.VeriteMapType=function(name){if(VMM.ExternalAPI.googlemaps.defaultType(name)){return google.maps.MapTypeId[name.toUpperCase()]}else{var provider=mapProvider(name);return google.maps.ImageMapType.call(this,{getTileUrl:function(coord,zoom){var index=(zoom+coord.x+coord.y)%VMM.ExternalAPI.googlemaps.map_subdomains.length;var retURL=provider.url.replace(&quot;{S}&quot;,VMM.ExternalAPI.googlemaps.map_subdomains[index]).replace(&quot;{Z}&quot;,zoom).replace(&quot;{X}&quot;,coord.x).replace(&quot;{Y}&quot;,coord.y).replace(&quot;{z}&quot;,zoom).replace(&quot;{x}&quot;,coord.x).replace(&quot;{y}&quot;,coord.y);return retURL},tileSize:new google.maps.Size(256,256),name:name,minZoom:provider.minZoom,maxZoom:provider.maxZoom})}};google.maps.VeriteMapType.prototype=new google.maps.ImageMapType(&quot;_&quot;);if(VMM.ExternalAPI.googlemaps.maptype!=&quot;&quot;){if(VMM.ExternalAPI.googlemaps.defaultType(VMM.ExternalAPI.googlemaps.maptype)){layer=google.maps.MapTypeId[VMM.ExternalAPI.googlemaps.maptype.toUpperCase()]}else{layer=VMM.ExternalAPI.googlemaps.maptype}}else{layer=google.maps.MapTypeId[&quot;TERRAIN&quot;]}var new_google_url_regex=new RegExp(/@([0-9\.\-]+),([0-9\.\-]+),(\d+)z/);if(m.id.match(new_google_url_regex)){var match=m.id.match(new_google_url_regex);lat=parseFloat(match[1]);lng=parseFloat(match[2]);location=new google.maps.LatLng(lat,lng);zoom=parseFloat(match[3]);has_location=has_zoom=true}else{if(type.of(VMM.Util.getUrlVars(m.id)[&quot;ll&quot;])==&quot;string&quot;){has_location=true;latlong=VMM.Util.getUrlVars(m.id)[&quot;ll&quot;].split(&quot;,&quot;);location=new google.maps.LatLng(parseFloat(latlong[0]),parseFloat(latlong[1]))}else if(type.of(VMM.Util.getUrlVars(m.id)[&quot;sll&quot;])==&quot;string&quot;){latlong=VMM.Util.getUrlVars(m.id)[&quot;sll&quot;].split(&quot;,&quot;);location=new google.maps.LatLng(parseFloat(latlong[0]),parseFloat(latlong[1]))}if(type.of(VMM.Util.getUrlVars(m.id)[&quot;z&quot;])==&quot;string&quot;){has_zoom=true;zoom=parseFloat(VMM.Util.getUrlVars(m.id)[&quot;z&quot;])}}map_options={zoom:zoom,draggable:false,disableDefaultUI:true,mapTypeControl:false,zoomControl:true,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.TOP_RIGHT},center:location,mapTypeId:layer,mapTypeControlOptions:{mapTypeIds:[layer]}};VMM.attachElement(&quot;#&quot;+m.uid,&quot;&quot;);map=new google.maps.Map(document.getElementById(unique_map_id),map_options);if(VMM.ExternalAPI.googlemaps.defaultType(VMM.ExternalAPI.googlemaps.maptype)){}else{map.mapTypes.set(layer,new google.maps.VeriteMapType(layer));map_attribution_html=&quot;<DIV class="map-attribution"><DIV class="attribution-text">&quot;+map_attribution+&quot;</DIV></DIV>&quot;;VMM.appendElement(&quot;#&quot;+unique_map_id,map_attribution_html)}if(type.of(VMM.Util.getUrlVars(m.id)[&quot;msid&quot;])==&quot;string&quot;){loadKML()}else{if(type.of(VMM.Util.getUrlVars(m.id)[&quot;q&quot;])==&quot;string&quot;){geocodePlace()}}function geocodePlace(){var geocoder=new google.maps.Geocoder,address=VMM.Util.getUrlVars(m.id)[&quot;q&quot;],marker;if(address.match(&quot;loc:&quot;)){var address_latlon=address.split(&quot;:&quot;)[1].split(&quot;+&quot;);location=new google.maps.LatLng(parseFloat(address_latlon[0]),parseFloat(address_latlon[1]));has_location=true}geocoder.geocode({address:address},function(results,status){if(status==google.maps.GeocoderStatus.OK){marker=new google.maps.Marker({map:map,position:results[0].geometry.location});if(typeof results[0].geometry.viewport!=&quot;undefined&quot;){map.fitBounds(results[0].geometry.viewport)}else if(typeof results[0].geometry.bounds!=&quot;undefined&quot;){map.fitBounds(results[0].geometry.bounds)}else{map.setCenter(results[0].geometry.location)}if(has_location){map.panTo(location)}if(has_zoom){map.setZoom(zoom)}}else{trace(&quot;Geocode for &quot;+address+&quot; was not successful for the following reason: &quot;+status);trace(&quot;TRYING PLACES SEARCH&quot;);if(has_location){map.panTo(location)}if(has_zoom){map.setZoom(zoom)}loadPlaces()}})}function loadPlaces(){var place,search_request,infowindow,search_bounds,bounds_sw,bounds_ne;place_search=new google.maps.places.PlacesService(map);infowindow=new google.maps.InfoWindow;search_request={query:&quot;&quot;,types:[&quot;country&quot;,&quot;neighborhood&quot;,&quot;political&quot;,&quot;locality&quot;,&quot;geocode&quot;]};if(type.of(VMM.Util.getUrlVars(m.id)[&quot;q&quot;])==&quot;string&quot;){search_request.query=VMM.Util.getUrlVars(m.id)[&quot;q&quot;]}if(has_location){search_request.location=location;search_request.radius=&quot;15000&quot;}else{bounds_sw=new google.maps.LatLng(-89.999999,-179.999999);bounds_ne=new google.maps.LatLng(89.999999,179.999999);search_bounds=new google.maps.LatLngBounds(bounds_sw,bounds_ne)}place_search.textSearch(search_request,placeResults);function placeResults(results,status){if(status==google.maps.places.PlacesServiceStatus.OK){for(var i=0;i&lt;results.length;i++){}if(has_location){map.panTo(location)}else{if(results.length&gt;=1){map.panTo(results[0].geometry.location);if(has_zoom){map.setZoom(zoom)}}}}else{trace(&quot;Place search for &quot;+search_request.query+&quot; was not successful for the following reason: &quot;+status);trace(&quot;YOU MAY NEED A GOOGLE MAPS API KEY IN ORDER TO USE THIS FEATURE OF TIMELINEJS&quot;);trace(&quot;FIND OUT HOW TO GET YOUR KEY HERE: <A href="https://developers.google.com/places/documentation/#Authentication" class="external free" rel="nofollow">https://developers.google.com/places/documentation/#Authentication</A>&quot;);if(has_location){map.panTo(location);if(has_zoom){map.setZoom(zoom)}}else{trace(&quot;USING SIMPLE IFRAME MAP EMBED&quot;);if(m.id[0].match(&quot;https&quot;)){m.id=m.url[0].replace(&quot;https&quot;,&quot;http&quot;)}VMM.ExternalAPI.googlemaps.createiFrameMap(m)}}}function createMarker(place){var marker,placeLoc;placeLoc=place.geometry.location;marker=new google.maps.Marker({map:map,position:place.geometry.location});google.maps.event.addListener(marker,&quot;click&quot;,function(){infowindow.setContent(place.name);infowindow.open(map,this)})}}function loadPlacesAlt(){var api_key,places_url,has_key=false;trace(&quot;LOADING PLACES API FOR GOOGLE MAPS&quot;);if(VMM.ExternalAPI.keys.google!=&quot;&quot;){api_key=VMM.ExternalAPI.keys.google;has_key=true}else{trace(&quot;YOU NEED A GOOGLE MAPS API KEY IN ORDER TO USE THIS FEATURE OF TIMELINEJS&quot;);trace(&quot;FIND OUT HOW TO GET YOUR KEY HERE: <A href="https://developers.google.com/places/documentation/#Authentication" class="external free" rel="nofollow">https://developers.google.com/places/documentation/#Authentication</A>&quot;)}places_url=&quot;<A href="https://maps.googleapis.com/maps/api/place/textsearch/json?key=" class="external free" rel="nofollow">https://maps.googleapis.com/maps/api/place/textsearch/json?key=</A>&quot;+api_key+&quot;&amp;sensor=false&amp;language=&quot;+m.lang+&quot;&amp;&quot;;if(type.of(VMM.Util.getUrlVars(m.id)[&quot;q&quot;])==&quot;string&quot;){places_url+=&quot;query=&quot;+VMM.Util.getUrlVars(m.id)[&quot;q&quot;]}if(has_location){places_url+=&quot;&amp;location=&quot;+location}if(has_key){VMM.getJSON(places_url,function(d){trace(&quot;PLACES JSON&quot;);var places_location=&quot;&quot;,places_bounds=&quot;&quot;,places_bounds_ne=&quot;&quot;,places_bounds_sw=&quot;&quot;;trace(d);if(d.status==&quot;OVER_QUERY_LIMIT&quot;){trace(&quot;OVER_QUERY_LIMIT&quot;);if(has_location){map.panTo(location);if(has_zoom){map.setZoom(zoom)}}else{trace(&quot;DOING TRADITIONAL MAP IFRAME EMBED UNTIL QUERY LIMIT RESTORED&quot;);api_limit=true;VMM.ExternalAPI.googlemaps.createiFrameMap(m)}}else{if(d.results.length&gt;=1){places_bounds_ne=new google.maps.LatLng(parseFloat(d.results[0].geometry.viewport.northeast.lat),parseFloat(d.results[0].geometry.viewport.northeast.lng));places_bounds_sw=new google.maps.LatLng(parseFloat(d.results[0].geometry.viewport.southwest.lat),parseFloat(d.results[0].geometry.viewport.southwest.lng));places_bounds=new google.maps.LatLngBounds(places_bounds_sw,places_bounds_ne);map.fitBounds(places_bounds)}else{trace(&quot;NO RESULTS&quot;)}if(has_location){map.panTo(location)}if(has_zoom){map.setZoom(zoom)}}}).error(function(jqXHR,textStatus,errorThrown){trace(&quot;PLACES JSON ERROR&quot;);trace(&quot;PLACES JSON ERROR: &quot;+textStatus+&quot; &quot;+jqXHR.responseText)}).success(function(d){trace(&quot;PLACES JSON SUCCESS&quot;)})}else{if(has_location){map.panTo(location);if(has_zoom){map.setZoom(zoom)}}else{trace(&quot;DOING TRADITIONAL MAP IFRAME EMBED BECAUSE NO GOOGLE MAP API KEY WAS PROVIDED&quot;);VMM.ExternalAPI.googlemaps.createiFrameMap(m)}}}function loadKML(){var kml_url,kml_layer,infowindow,text;kml_url=m.id+&quot;&amp;output=kml&quot;;kml_url=kml_url.replace(&quot;&amp;output=embed&quot;,&quot;&quot;);kml_layer=new google.maps.KmlLayer(kml_url,{preserveViewport:true});infowindow=new google.maps.InfoWindow;kml_layer.setMap(map);google.maps.event.addListenerOnce(kml_layer,&quot;defaultviewport_changed&quot;,function(){if(has_location){map.panTo(location)}else{map.fitBounds(kml_layer.getDefaultViewport())}if(has_zoom){map.setZoom(zoom)}});google.maps.event.addListener(kml_layer,&quot;click&quot;,function(kmlEvent){text=kmlEvent.featureData.description;showInfoWindow(text);function showInfoWindow(c){infowindow.setContent(c);infowindow.open(map)}})}},pushQue:function(){for(var i=0;i&lt;VMM.master_config.googlemaps.que.length;i++){VMM.ExternalAPI.googlemaps.create(VMM.master_config.googlemaps.que[i])}VMM.master_config.googlemaps.que=[]},onMapAPIReady:function(){VMM.master_config.googlemaps.map_active=true;VMM.master_config.googlemaps.places_active=true;VMM.ExternalAPI.googlemaps.onAPIReady()},onPlacesAPIReady:function(){VMM.master_config.googlemaps.places_active=true;VMM.ExternalAPI.googlemaps.onAPIReady()},onAPIReady:function(){if(!VMM.master_config.googlemaps.active){if(VMM.master_config.googlemaps.map_active&amp;&amp;VMM.master_config.googlemaps.places_active){VMM.master_config.googlemaps.active=true;VMM.ExternalAPI.googlemaps.pushQue()}}},defaultType:function(name){if(name.toLowerCase()==&quot;satellite&quot;||name.toLowerCase()==&quot;hybrid&quot;||name.toLowerCase()==&quot;terrain&quot;||name.toLowerCase()==&quot;roadmap&quot;){return true}else{return false}},map_subdomains:[&quot;&quot;,&quot;a.&quot;,&quot;b.&quot;,&quot;c.&quot;,&quot;d.&quot;],map_attribution:{stamen:&quot;Map tiles by &lt;a href='<A href="http://stamen.com'" class="external free" rel="nofollow">http://stamen.com'</A>&gt;Stamen Design&lt;/a&gt;, under &lt;a href='<A href="http://creativecommons.org/licenses/by/3.0'" class="external free" rel="nofollow">http://creativecommons.org/licenses/by/3.0'</A>&gt;CC BY 3.0&lt;/a&gt;. Data by &lt;a href='<A href="http://openstreetmap.org'" class="external free" rel="nofollow">http://openstreetmap.org'</A>&gt;OpenStreetMap&lt;/a&gt;, under &lt;a href='<A href="http://creativecommons.org/licenses/by-sa/3.0'" class="external free" rel="nofollow">http://creativecommons.org/licenses/by-sa/3.0'</A>&gt;CC BY SA&lt;/a&gt;.&quot;,apple:&quot;Map data Â© 2012  Apple, Imagery Â© 2012 Apple&quot;,osm:&quot;Â©&lt;a href='<A href="http://www.openstreetmap.org/copyright'" class="external free" rel="nofollow">http://www.openstreetmap.org/copyright'</A>&gt;OpenStreetMap&lt;/a&gt; contributors&quot;},map_providers:{toner:{url:&quot;//{S}tile.stamen.com/toner/{Z}/{X}/{Y}.png&quot;,minZoom:0,maxZoom:20,attribution:&quot;stamen&quot;},&quot;toner-lines&quot;:{url:&quot;//{S}tile.stamen.com/toner-lines/{Z}/{X}/{Y}.png&quot;,minZoom:0,maxZoom:20,attribution:&quot;stamen&quot;},&quot;toner-labels&quot;:{url:&quot;//{S}tile.stamen.com/toner-labels/{Z}/{X}/{Y}.png&quot;,minZoom:0,maxZoom:20,attribution:&quot;stamen&quot;},sterrain:{url:&quot;//{S}tile.stamen.com/terrain/{Z}/{X}/{Y}.jpg&quot;,minZoom:4,maxZoom:20,attribution:&quot;stamen&quot;},apple:{url:&quot;//gsp2.apple.com/tile?api=1&amp;style=slideshow&amp;layers=default&amp;lang=en_US&amp;z={z}&amp;x={x}&amp;y={y}&amp;v=9&quot;,minZoom:4,maxZoom:14,attribution:&quot;apple&quot;},watercolor:{url:&quot;//{S}tile.stamen.com/watercolor/{Z}/{X}/{Y}.jpg&quot;,minZoom:3,maxZoom:16,attribution:&quot;stamen&quot;},osm:{url:&quot;//tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,minZoom:3,maxZoom:18,attribution:&quot;osm&quot;}}},googleplus:{get:function(m){var api_key;var gplus={user:m.user,activity:m.id,id:m.uid};VMM.master_config.googleplus.que.push(gplus);VMM.master_config.googleplus.active=true},create:function(gplus,callback){var mediaElem=&quot;&quot;,api_key=&quot;&quot;,g_activity=&quot;&quot;,g_content=&quot;&quot;,g_attachments=&quot;&quot;,gperson_api_url,gactivity_api_url;googleplus_timeout=setTimeout(VMM.ExternalAPI.googleplus.errorTimeOut,VMM.master_config.timers.api,gplus),callback_timeout=setTimeout(callback,VMM.master_config.timers.api,gplus);if(VMM.master_config.Timeline.api_keys.google!=&quot;&quot;){api_key=VMM.master_config.Timeline.api_keys.google}else{api_key=Aes.Ctr.decrypt(VMM.master_config.api_keys_master.google,VMM.master_config.vp,256)}gperson_api_url=&quot;<A href="https://www.googleapis.com/plus/v1/people/" class="external free" rel="nofollow">https://www.googleapis.com/plus/v1/people/</A>&quot;+gplus.user+&quot;/activities/public?alt=json&amp;maxResults=100&amp;fields=items(id,url)&amp;key=&quot;+api_key;mediaElem=&quot;GOOGLE PLUS API CALL&quot;;VMM.getJSON(gperson_api_url,function(p_data){for(var i=0;i&lt;p_data.items.length;i++){trace(&quot;loop&quot;);if(p_data.items[i].url.split(&quot;posts/&quot;)[1]==gplus.activity){trace(&quot;FOUND IT!!&quot;);g_activity=p_data.items[i].id;gactivity_api_url=&quot;<A href="https://www.googleapis.com/plus/v1/activities/" class="external free" rel="nofollow">https://www.googleapis.com/plus/v1/activities/</A>&quot;+g_activity+&quot;?alt=json&amp;key=&quot;+api_key;VMM.getJSON(gactivity_api_url,function(a_data){trace(a_data);if(typeof a_data.annotation!=&quot;undefined&quot;){g_content+=&quot;<DIV class="googleplus-annotation">'&quot;+a_data.annotation+&quot;</DIV>&quot;;g_content+=a_data.object.content}else{g_content+=a_data.object.content}if(typeof a_data.object.attachments!=&quot;undefined&quot;){for(var k=0;k&lt;a_data.object.attachments.length;k++){if(a_data.object.attachments[k].objectType==&quot;photo&quot;){g_attachments=&quot;&lt;a href='&quot;+a_data.object.url+&quot;' target='_blank'&gt;&quot;+&quot;&lt;img src='&quot;+a_data.object.attachments[k].image.url+&quot;' class='article-thumb'&gt;&lt;/a&gt;&quot;+g_attachments}else if(a_data.object.attachments[k].objectType==&quot;video&quot;){g_attachments=&quot;&lt;img src='&quot;+a_data.object.attachments[k].image.url+&quot;' class='article-thumb'&gt;&quot;+g_attachments;g_attachments+=&quot;<DIV>&quot;;g_attachments+=&quot;&lt;a href='&quot;+a_data.object.attachments[k].url+&quot;' target='_blank'&gt;&quot;;g_attachments+=&quot;<TABLE id="toc" class="toc"><TBODY><TR><TD><DIV id="toctitle"><H2>Contents</H2></DIV><UL><LI class="toclevel-1"><A href="#.22.2Ba_data.object.attachments.5Bk.5D.displayName.2B.22"><SPAN class="tocnumber">1</SPAN><SPAN class="toctext">&quot;+a_data.object.attachments[k].displayName+&quot;</SPAN></A></LI><LI class="toclevel-1"><A href="#.22.2Ba_data.object.attachments.5Bk.5D.displayName.2B.22_2"><SPAN class="tocnumber">2</SPAN><SPAN class="toctext">&quot;+a_data.object.attachments[k].displayName+&quot;</SPAN></A></LI><LI class="toclevel-1"><A href="#.3Ca_href.3D.27http:.2F.2F.22.2BVMM.master_config.language.api.wikipedia.2B.22.wikipedia.org.2Fwiki.2F.22.2Bm.id.2B.22.27_target.3D.27_blank.27.3E.22.2Bm.url.2B.22.3C.2Fa.3E"><SPAN class="tocnumber">3</SPAN><SPAN class="toctext">&lt;a href='http://&quot;+VMM.master_config.language.api.wikipedia+&quot;.wikipedia.org/wiki/&quot;+m.id+&quot;' target='_blank'&gt;&quot;+m.url+&quot;&lt;/a&gt;</SPAN></A></LI><LI class="toclevel-1"><A href="#.3Ca_href.3D.27http:.2F.2F.22.2BVMM.master_config.language.api.wikipedia.2B.22.wikipedia.org.2Fwiki.2F.22.2Bwiki_title.2B.22.27_target.3D.27_blank.27.3E.22.2Bwiki_title.2B.22.3C.2Fa.3E"><SPAN class="tocnumber">4</SPAN><SPAN class="toctext">&lt;a href='http://&quot;+VMM.master_config.language.api.wikipedia+&quot;.wikipedia.org/wiki/&quot;+wiki_title+&quot;' target='_blank'&gt;&quot;+wiki_title+&quot;&lt;/a&gt;</SPAN></A></LI><LI class="toclevel-1"><A href="#.22.2B_marker_title.2B.22"><SPAN class="tocnumber">5</SPAN><SPAN class="toctext">&quot;+_marker_title+&quot;</SPAN></A></LI><LI class="toclevel-1"><A href="#.22.2B_marker_title.2B.22_2"><SPAN class="tocnumber">6</SPAN><SPAN class="toctext">&quot;+_marker_title+&quot;</SPAN></A></LI><LI class="toclevel-1"><A href="#.22.2B_marker_title.2B.22_3"><SPAN class="tocnumber">7</SPAN><SPAN class="toctext">&quot;+_marker_title+&quot;</SPAN></A></LI><LI class="toclevel-1"><A href="#.22.2Btags.5Bk.5D.2B.22"><SPAN class="tocnumber">8</SPAN><SPAN class="toctext">&quot;+tags[k]+&quot;</SPAN></A></LI></UL></TD></TR></TBODY></TABLE><H5><SPAN class="mw-headline" id=".22.2Ba_data.object.attachments.5Bk.5D.displayName.2B.22">&quot;+a_data.object.attachments[k].displayName+&quot;</SPAN></H5>&quot;;g_attachments+=&quot;&lt;/a&gt;&quot;;g_attachments+=&quot;</DIV>&quot;}else if(a_data.object.attachments[k].objectType==&quot;article&quot;){g_attachments+=&quot;<DIV>&quot;;g_attachments+=&quot;&lt;a href='&quot;+a_data.object.attachments[k].url+&quot;' target='_blank'&gt;&quot;;g_attachments+=&quot;<H5><SPAN class="mw-headline" id=".22.2Ba_data.object.attachments.5Bk.5D.displayName.2B.22_2">&quot;+a_data.object.attachments[k].displayName+&quot;</SPAN></H5>&quot;;g_attachments+=&quot;<P>&quot;+a_data.object.attachments[k].content+&quot;</P>&quot;;g_attachments+=&quot;&lt;/a&gt;&quot;;g_attachments+=&quot;</DIV>&quot;}trace(a_data.object.attachments[k])}g_attachments=&quot;<DIV class="googleplus-attachments">&quot;+g_attachments+&quot;</DIV>&quot;}mediaElem=&quot;<DIV class="googleplus-content">&quot;+g_content+g_attachments+&quot;</DIV>&quot;;mediaElem+=&quot;<DIV class="vcard author">&lt;a class='screen-name url' href='&quot;+a_data.url+&quot;' target='_blank'&gt;&quot;;mediaElem+=&quot;<SPAN class="avatar">&lt;img src='&quot;+a_data.actor.image.url+&quot;' style='max-width: 32px; max-height: 32px;'&gt;</SPAN>&quot;;mediaElem+=&quot;<SPAN class="fn">&quot;+a_data.actor.displayName+&quot;</SPAN>&quot;;mediaElem+=&quot;&quot;;mediaElem+=&quot;&lt;/a&gt;</DIV>&quot;;
VMM.attachElement(&quot;#googleplus_&quot;+gplus.activity,mediaElem)});break}}}).error(function(jqXHR,textStatus,errorThrown){var error_obj=VMM.parseJSON(jqXHR.responseText);trace(error_obj.error.message);VMM.attachElement(&quot;#googleplus_&quot;+gplus.activity,VMM.MediaElement.loadingmessage(&quot;<P>ERROR LOADING GOOGLE+ </P><P>&quot;+error_obj.error.message+&quot;</P>&quot;))}).success(function(d){clearTimeout(googleplus_timeout);clearTimeout(callback_timeout);callback()})},pushQue:function(){if(VMM.master_config.googleplus.que.length&gt;0){VMM.ExternalAPI.googleplus.create(VMM.master_config.googleplus.que[0],VMM.ExternalAPI.googleplus.pushQue);VMM.Util.removeRange(VMM.master_config.googleplus.que,0)}},errorTimeOut:function(gplus){trace(&quot;GOOGLE+ JSON ERROR TIMEOUT &quot;+gplus.activity);VMM.attachElement(&quot;#googleplus_&quot;+gplus.activity,VMM.MediaElement.loadingmessage(&quot;<P>Still waiting on GOOGLE+ </P><P>&quot;+gplus.activity+&quot;</P>&quot;))}},googledocs:{get:function(m){VMM.master_config.googledocs.que.push(m);VMM.master_config.googledocs.active=true},create:function(m){var mediaElem=&quot;&quot;;if(m.id.match(/docs.google.com/i)){mediaElem=&quot;&lt;iframe class='doc' frameborder='0' width='100%' height='100%' src='&quot;+m.id+&quot;&amp;embedded=true'&gt;&lt;/iframe&gt;&quot;}else{mediaElem=&quot;&lt;iframe class='doc' frameborder='0' width='100%' height='100%' src='&quot;+&quot;//docs.google.com/viewer?url=&quot;+m.id+&quot;&amp;embedded=true'&gt;&lt;/iframe&gt;&quot;}VMM.attachElement(&quot;#&quot;+m.uid,mediaElem)},pushQue:function(){for(var i=0;i&lt;VMM.master_config.googledocs.que.length;i++){VMM.ExternalAPI.googledocs.create(VMM.master_config.googledocs.que[i])}VMM.master_config.googledocs.que=[]}},flickr:{get:function(m){VMM.master_config.flickr.que.push(m);VMM.master_config.flickr.active=true},create:function(m,callback){var api_key,callback_timeout=setTimeout(callback,VMM.master_config.timers.api,m);if(typeof VMM.master_config.Timeline!=&quot;undefined&quot;&amp;&amp;VMM.master_config.Timeline.api_keys.flickr!=&quot;&quot;){api_key=VMM.master_config.Timeline.api_keys.flickr}else{api_key=Aes.Ctr.decrypt(VMM.master_config.api_keys_master.flickr,VMM.master_config.vp,256)}var the_url=&quot;<A href="https://api.flickr.com/services/rest/?method=flickr.photos.getSizes&amp;api_key=" class="external free" rel="nofollow">https://api.flickr.com/services/rest/?method=flickr.photos.getSizes&amp;api_key=</A>&quot;+api_key+&quot;&amp;photo_id=&quot;+m.id+&quot;&amp;format=json&amp;jsoncallback=?&quot;;VMM.getJSON(the_url,function(d){var flickr_id=VMM.ExternalAPI.flickr.getFlickrIdFromUrl(d.sizes.size[0].url);var flickr_large_id=&quot;#&quot;+m.uid,flickr_thumb_id=&quot;#&quot;+m.uid+&quot;_thumb&quot;;var flickr_img_size,flickr_img_thumb,flickr_size_found=false,flickr_best_size=&quot;Large&quot;;flickr_best_size=VMM.ExternalAPI.flickr.sizes(VMM.master_config.sizes.api.height);for(var i=0;i&lt;d.sizes.size.length;i++){if(d.sizes.size[i].label==flickr_best_size){flickr_size_found=true;flickr_img_size=d.sizes.size[i].source}}if(!flickr_size_found){flickr_img_size=d.sizes.size[d.sizes.size.length-2].source}flickr_img_thumb=d.sizes.size[0].source;VMM.Lib.attr(flickr_large_id,&quot;src&quot;,flickr_img_size);VMM.attachElement(flickr_thumb_id,&quot;&lt;img src='&quot;+flickr_img_thumb+&quot;'&gt;&quot;)}).error(function(jqXHR,textStatus,errorThrown){trace(&quot;FLICKR error&quot;);trace(&quot;FLICKR ERROR: &quot;+textStatus+&quot; &quot;+jqXHR.responseText)}).success(function(d){clearTimeout(callback_timeout);callback()})},pushQue:function(){if(VMM.master_config.flickr.que.length&gt;0){VMM.ExternalAPI.flickr.create(VMM.master_config.flickr.que[0],VMM.ExternalAPI.flickr.pushQue);VMM.Util.removeRange(VMM.master_config.flickr.que,0)}},sizes:function(s){var _size=&quot;&quot;;if(s&lt;=75){_size=&quot;Thumbnail&quot;}else if(s&lt;=180){_size=&quot;Small&quot;}else if(s&lt;=240){_size=&quot;Small 320&quot;}else if(s&lt;=375){_size=&quot;Medium&quot;}else if(s&lt;=480){_size=&quot;Medium 640&quot;}else if(s&lt;=600){_size=&quot;Large&quot;}else{_size=&quot;Large&quot;}return _size},getFlickrIdFromUrl:function(url){var idx=url.indexOf(&quot;flickr.com/photos/&quot;);if(idx==-1)return null;var pos=idx+&quot;flickr.com/photos/&quot;.length;var photo_info=url.substr(pos);if(photo_info.indexOf(&quot;/&quot;)==-1)return null;if(photo_info.indexOf(&quot;/&quot;)==0)photo_info=photo_info.substr(1);return photo_info.split(&quot;/&quot;)[1]}},instagram:{get:function(m,thumb){if(thumb){return&quot;//instagr.am/p/&quot;+m.id+&quot;/media/?size=t&quot;}else{return&quot;//instagr.am/p/&quot;+m.id+&quot;/media/?size=&quot;+VMM.ExternalAPI.instagram.sizes(VMM.master_config.sizes.api.height)}},sizes:function(s){var _size=&quot;&quot;;if(s&lt;=150){_size=&quot;t&quot;}else if(s&lt;=306){_size=&quot;m&quot;}else{_size=&quot;l&quot;}return _size},isInstagramUrl:function(url){return url.match(&quot;instagr.am/p/&quot;)||url.match(&quot;instagram.com/p/&quot;)},getInstagramIdFromUrl:function(url){try{return url.split(&quot;/p/&quot;)[1].split(&quot;/&quot;)[0]}catch(e){trace(&quot;Invalid Instagram url: &quot;+url);return null}}},soundcloud:{get:function(m){VMM.master_config.soundcloud.que.push(m);VMM.master_config.soundcloud.active=true},create:function(m,callback){var the_url=&quot;//soundcloud.com/oembed?url=&quot;+m.id+&quot;&amp;maxheight=168&amp;format=js&amp;callback=?&quot;;VMM.getJSON(the_url,function(d){VMM.attachElement(&quot;#&quot;+m.uid,d.html);callback()})},pushQue:function(){if(VMM.master_config.soundcloud.que.length&gt;0){VMM.ExternalAPI.soundcloud.create(VMM.master_config.soundcloud.que[0],VMM.ExternalAPI.soundcloud.pushQue);VMM.Util.removeRange(VMM.master_config.soundcloud.que,0)}}},wikipedia:{get:function(m){VMM.master_config.wikipedia.que.push(m);VMM.master_config.wikipedia.active=true},create:function(m,callback){var the_url=&quot;//&quot;+m.lang+&quot;.wikipedia.org/w/api.php?action=query&amp;prop=extracts&amp;redirects=&amp;titles=&quot;+m.id+&quot;&amp;exintro=1&amp;format=json&amp;callback=?&quot;;callback_timeout=setTimeout(callback,VMM.master_config.timers.api,m);if(VMM.Browser.browser==&quot;Explorer&quot;&amp;&amp;parseInt(VMM.Browser.version,10)&gt;=7&amp;&amp;window.XDomainRequest){var temp_text=&quot;<H4><SPAN class="mw-headline" id=".3Ca_href.3D.27http:.2F.2F.22.2BVMM.master_config.language.api.wikipedia.2B.22.wikipedia.org.2Fwiki.2F.22.2Bm.id.2B.22.27_target.3D.27_blank.27.3E.22.2Bm.url.2B.22.3C.2Fa.3E">&lt;a href='http://&quot;+VMM.master_config.language.api.wikipedia+&quot;.wikipedia.org/wiki/&quot;+m.id+&quot;' target='_blank'&gt;&quot;+m.url+&quot;&lt;/a&gt;</SPAN></H4>&quot;;temp_text+=&quot;<SPAN class="wiki-source">&quot;+VMM.master_config.language.messages.wikipedia+&quot;</SPAN>&quot;;temp_text+=&quot;<P>Wikipedia entry unable to load using Internet Explorer 8 or below.</P>&quot;;VMM.attachElement(&quot;#&quot;+m.uid,temp_text)}VMM.getJSON(the_url,function(d){if(d.query){var wiki_extract,wiki_title,_wiki=&quot;&quot;,wiki_text=&quot;&quot;,wiki_number_of_paragraphs=1,wiki_text_array=[];wiki_extract=VMM.Util.getObjectAttributeByIndex(d.query.pages,0).extract;wiki_title=VMM.Util.getObjectAttributeByIndex(d.query.pages,0).title;if(wiki_extract.match(&quot;<P>&quot;)){wiki_text_array=wiki_extract.split(&quot;&lt;p&gt;&quot;)}else{wiki_text_array.push(wiki_extract)}for(var i=0;i&lt;wiki_text_array.length;i++){if(i+1&lt;=wiki_number_of_paragraphs&amp;&amp;i+1&lt;wiki_text_array.length){wiki_text+=&quot;&lt;p&gt;&quot;+wiki_text_array[i+1]}}_wiki=&quot;</P><H4><SPAN class="mw-headline" id=".3Ca_href.3D.27http:.2F.2F.22.2BVMM.master_config.language.api.wikipedia.2B.22.wikipedia.org.2Fwiki.2F.22.2Bwiki_title.2B.22.27_target.3D.27_blank.27.3E.22.2Bwiki_title.2B.22.3C.2Fa.3E">&lt;a href='http://&quot;+VMM.master_config.language.api.wikipedia+&quot;.wikipedia.org/wiki/&quot;+wiki_title+&quot;' target='_blank'&gt;&quot;+wiki_title+&quot;&lt;/a&gt;</SPAN></H4>&quot;;_wiki+=&quot;<SPAN class="wiki-source">&quot;+VMM.master_config.language.messages.wikipedia+&quot;</SPAN>&quot;;_wiki+=VMM.Util.linkify_wikipedia(wiki_text);if(wiki_extract.match(&quot;REDIRECT&quot;)){}else{VMM.attachElement(&quot;#&quot;+m.uid,_wiki)}}}).error(function(jqXHR,textStatus,errorThrown){trace(&quot;WIKIPEDIA error&quot;);trace(&quot;WIKIPEDIA ERROR: &quot;+textStatus+&quot; &quot;+jqXHR.responseText);trace(errorThrown);VMM.attachElement(&quot;#&quot;+m.uid,VMM.MediaElement.loadingmessage(&quot;&lt;p&gt;Wikipedia is not responding&quot;));clearTimeout(callback_timeout);if(VMM.master_config.wikipedia.tries&lt;4){trace(&quot;WIKIPEDIA ATTEMPT &quot;+VMM.master_config.wikipedia.tries);trace(m);VMM.master_config.wikipedia.tries++;VMM.ExternalAPI.wikipedia.create(m,callback)}else{callback()}}).success(function(d){VMM.master_config.wikipedia.tries=0;clearTimeout(callback_timeout);callback()})},pushQue:function(){if(VMM.master_config.wikipedia.que.length&gt;0){trace(&quot;WIKIPEDIA PUSH QUE &quot;+VMM.master_config.wikipedia.que.length);VMM.ExternalAPI.wikipedia.create(VMM.master_config.wikipedia.que[0],VMM.ExternalAPI.wikipedia.pushQue);VMM.Util.removeRange(VMM.master_config.wikipedia.que,0)}}},youtube:{get:function(m){var the_url=&quot;//gdata.youtube.com/feeds/api/videos/&quot;+m.id+&quot;?v=2&amp;alt=jsonc&amp;callback=?&quot;;VMM.master_config.youtube.que.push(m);if(!VMM.master_config.youtube.active){if(!VMM.master_config.youtube.api_loaded){LoadLib.js(&quot;//www.youtube.com/player_api&quot;,function(){trace(&quot;YouTube API Library Loaded&quot;)})}}VMM.getJSON(the_url,function(d){VMM.ExternalAPI.youtube.createThumb(d,m)})},create:function(m){if(typeof m.start!=&quot;undefined&quot;){var vidstart=m.start.toString(),vid_start_minutes=0,vid_start_seconds=0;if(vidstart.match(&quot;m&quot;)){vid_start_minutes=parseInt(vidstart.split(&quot;m&quot;)[0],10);vid_start_seconds=parseInt(vidstart.split(&quot;m&quot;)[1].split(&quot;s&quot;)[0],10);m.start=vid_start_minutes*60+vid_start_seconds}else{m.start=0}}else{m.start=0}var p={active:false,player:{},name:m.uid,playing:false,hd:false};if(typeof m.hd!=&quot;undefined&quot;){p.hd=true}p.player[m.id]=new YT.Player(m.uid,{height:&quot;390&quot;,width:&quot;640&quot;,playerVars:{enablejsapi:1,color:&quot;white&quot;,showinfo:0,theme:&quot;light&quot;,start:m.start,rel:0},videoId:m.id,events:{onReady:VMM.ExternalAPI.youtube.onPlayerReady,onStateChange:VMM.ExternalAPI.youtube.onStateChange}});VMM.master_config.youtube.array.push(p)},createThumb:function(d,m){trace(&quot;CREATE THUMB&quot;);trace(d);trace(m);if(typeof d.data!=&quot;undefined&quot;){var thumb_id=&quot;#&quot;+m.uid+&quot;_thumb&quot;;VMM.attachElement(thumb_id,&quot;&lt;img src='&quot;+d.data.thumbnail.sqDefault+&quot;'&gt;&quot;)}},pushQue:function(){for(var i=0;i&lt;VMM.master_config.youtube.que.length;i++){VMM.ExternalAPI.youtube.create(VMM.master_config.youtube.que[i])}VMM.master_config.youtube.que=[]},onAPIReady:function(){VMM.master_config.youtube.active=true;VMM.ExternalAPI.youtube.pushQue()},stopPlayers:function(){for(var i=0;i&lt;VMM.master_config.youtube.array.length;i++){if(VMM.master_config.youtube.array[i].playing){if(typeof VMM.master_config.youtube.array[i].player.the_name!==&quot;undefined&quot;){VMM.master_config.youtube.array[i].player.the_name.stopVideo()}}}},onStateChange:function(e){for(var i=0;i&lt;VMM.master_config.youtube.array.length;i++){for(var z in VMM.master_config.youtube.array[i].player){if(VMM.master_config.youtube.array[i].player[z]==e.target){VMM.master_config.youtube.array[i].player.the_name=VMM.master_config.youtube.array[i].player[z]}}if(VMM.master_config.youtube.array[i].player.the_name==e.target){if(e.data==YT.PlayerState.PLAYING){VMM.master_config.youtube.array[i].playing=true;if(VMM.master_config.youtube.array[i].hd===false){VMM.master_config.youtube.array[i].hd=true;VMM.master_config.youtube.array[i].player.the_name.setPlaybackQuality(&quot;hd720&quot;)}}}}},onPlayerReady:function(e){}},vimeo:{get:function(m){VMM.master_config.vimeo.que.push(m);VMM.master_config.vimeo.active=true},create:function(m,callback){trace(&quot;VIMEO CREATE&quot;);var thumb_url=&quot;//vimeo.com/api/v2/video/&quot;+m.id+&quot;.json&quot;,video_url=&quot;//player.vimeo.com/video/&quot;+m.id+&quot;?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff&quot;;VMM.getJSON(thumb_url,function(d){VMM.ExternalAPI.vimeo.createThumb(d,m);callback()});VMM.attachElement(&quot;#&quot;+m.uid,&quot;&lt;iframe autostart='false' frameborder='0' width='100%' height='100%' src='&quot;+video_url+&quot;'&gt;&lt;/iframe&gt;&quot;)},createThumb:function(d,m){trace(&quot;VIMEO CREATE THUMB&quot;);var thumb_id=&quot;#&quot;+m.uid+&quot;_thumb&quot;;VMM.attachElement(thumb_id,&quot;&lt;img src='&quot;+d[0].thumbnail_small+&quot;'&gt;&quot;)},pushQue:function(){if(VMM.master_config.vimeo.que.length&gt;0){VMM.ExternalAPI.vimeo.create(VMM.master_config.vimeo.que[0],VMM.ExternalAPI.vimeo.pushQue);VMM.Util.removeRange(VMM.master_config.vimeo.que,0)}}},vine:{get:function(m){VMM.master_config.vine.que.push(m);VMM.master_config.vine.active=true},create:function(m,callback){trace(&quot;VINE CREATE&quot;);var video_url=&quot;<A href="https://vine.co/v/" class="external free" rel="nofollow">https://vine.co/v/</A>&quot;+m.id+&quot;/embed/simple&quot;;VMM.attachElement(&quot;#&quot;+m.uid,&quot;&lt;iframe frameborder='0' width='100%' height='100%' src='&quot;+video_url+&quot;'&gt;&lt;/iframe&gt;&lt;script async src='<A href="http://platform.vine.co/static/scripts/embed.js'" class="external free" rel="nofollow">http://platform.vine.co/static/scripts/embed.js'</A> charset='utf-8'&gt;&lt;/script&gt;&quot;)},pushQue:function(){if(VMM.master_config.vine.que.length&gt;0){VMM.ExternalAPI.vine.create(VMM.master_config.vine.que[0],VMM.ExternalAPI.vine.pushQue);VMM.Util.removeRange(VMM.master_config.vine.que,0)}}},webthumb:{get:function(m,thumb){VMM.master_config.webthumb.que.push(m);VMM.master_config.webthumb.active=true},sizes:function(s){var _size=&quot;&quot;;if(s&lt;=150){_size=&quot;t&quot;}else if(s&lt;=306){_size=&quot;m&quot;}else{_size=&quot;l&quot;}return _size},create:function(m){trace(&quot;WEB THUMB CREATE&quot;);var thumb_url=&quot;//api.pagepeeker.com/v2/thumbs.php?&quot;;url=m.id.replace(&quot;http://&quot;,&quot;&quot;);VMM.attachElement(&quot;#&quot;+m.uid,&quot;&lt;a href='&quot;+m.id+&quot;' target='_blank'&gt;&lt;img src='&quot;+thumb_url+&quot;size=x&amp;url=&quot;+url+&quot;'&gt;&lt;/a&gt;&quot;);VMM.attachElement(&quot;#&quot;+m.uid+&quot;_thumb&quot;,&quot;&lt;img src='&quot;+thumb_url+&quot;size=t&amp;url=&quot;+url+&quot;'&gt;&quot;)},pushQue:function(){for(var i=0;i&lt;VMM.master_config.webthumb.que.length;i++){VMM.ExternalAPI.webthumb.create(VMM.master_config.webthumb.que[i])}VMM.master_config.webthumb.que=[]}}}.init()}function onYouTubePlayerAPIReady(){trace(&quot;GLOBAL YOUTUBE API CALLED&quot;);VMM.ExternalAPI.youtube.onAPIReady()}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.MediaElement==&quot;undefined&quot;){VMM.MediaElement={init:function(){return this},loadingmessage:function(m){return&quot;<DIV class="vco-loading"><DIV class="vco-loading-container">&quot;+&quot;<DIV class="vco-message"><P>&quot;+m+&quot;</P></DIV></DIV></DIV>&quot;},thumbnail:function(data,w,h,uid){var _w=16,_h=24,_uid=&quot;&quot;;if(w!=null&amp;&amp;w!=&quot;&quot;){_w=w}if(h!=null&amp;&amp;h!=&quot;&quot;){_h=h}if(uid!=null&amp;&amp;uid!=&quot;&quot;){_uid=uid}if(data.thumbnail!=null&amp;&amp;data.thumbnail!=&quot;&quot;){trace(&quot;CUSTOM THUMB&quot;);mediaElem=&quot;<DIV class="thumbnail thumb-custom" id=".22.2Buid.2B.22_custom_thumb">&lt;img src='&quot;+data.thumbnail+&quot;'&gt;</DIV>&quot;;return mediaElem}else if(data.media!=null&amp;&amp;data.media!=&quot;&quot;){var _valid=true,mediaElem=&quot;&quot;,m=VMM.MediaType(data.media);if(m.type==&quot;image&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;flickr&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;instagram&quot;){mediaElem=&quot;<DIV class="thumbnail thumb-instagram" id=".22.2Buid.2B.22_thumb">&lt;img src='&quot;+VMM.ExternalAPI.instagram.get(m,true)+&quot;'&gt;</DIV>&quot;;return mediaElem}else if(m.type==&quot;youtube&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;googledoc&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;vimeo&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;vine&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;dailymotion&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;twitter&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;twitter-ready&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;soundcloud&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;google-map&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;googleplus&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;wikipedia&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;storify&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;quote&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;iframe&quot;){mediaElem=&quot;&quot;;return mediaElem}else if(m.type==&quot;unknown&quot;){if(m.id.match(&quot;blockquote&quot;)){mediaElem=&quot;&quot;}else{mediaElem=&quot;&quot;}return mediaElem}else if(m.type==&quot;website&quot;){mediaElem=&quot;&quot;;return mediaElem}else{mediaElem=&quot;&quot;;return mediaElem}}},create:function(data,uid){var _valid=false,loading_messege=VMM.MediaElement.loadingmessage(VMM.master_config.language.messages.loading+&quot;...&quot;);if(data.media!=null&amp;&amp;data.media!=&quot;&quot;){var mediaElem=&quot;&quot;,captionElem=&quot;&quot;,creditElem=&quot;&quot;,_id=&quot;&quot;,isTextMedia=false,m;m=VMM.MediaType(data.media);m.uid=uid;_valid=true;if(data.credit!=null&amp;&amp;data.credit!=&quot;&quot;){creditElem=&quot;<DIV class="credit">&quot;+VMM.Util.linkify_with_twitter(data.credit,&quot;_blank&quot;)+&quot;</DIV>&quot;}if(data.caption!=null&amp;&amp;data.caption!=&quot;&quot;){captionElem=&quot;<DIV class="caption">&quot;+VMM.Util.linkify_with_twitter(data.caption,&quot;_blank&quot;)+&quot;</DIV>&quot;}if(m.type==&quot;image&quot;){mediaElem=&quot;<DIV class="media-image media-shadow">&lt;img src='&quot;+m.id+&quot;' class='media-image'&gt;</DIV>&quot;}else if(m.type==&quot;flickr&quot;){mediaElem=&quot;<DIV class="media-image media-shadow">&lt;a href='&quot;+m.link+&quot;' target='_blank'&gt;&lt;img id='&quot;+uid+&quot;'&gt;&lt;/a&gt;</DIV>&quot;;VMM.ExternalAPI.flickr.get(m)}else if(m.type==&quot;instagram&quot;){mediaElem=&quot;<DIV class="media-image media-shadow">&lt;a href='&quot;+m.link+&quot;' target='_blank'&gt;&lt;img src='&quot;+VMM.ExternalAPI.instagram.get(m)+&quot;'&gt;&lt;/a&gt;</DIV>&quot;}else if(m.type==&quot;googledoc&quot;){mediaElem=&quot;<DIV class="media-frame media-shadow doc" id=".22.2Bm.uid.2B.22">&quot;+loading_messege+&quot;</DIV>&quot;;VMM.ExternalAPI.googledocs.get(m)}else if(m.type==&quot;youtube&quot;){mediaElem=&quot;<DIV class="media-shadow"><DIV class="media-frame video youtube" id=".22.2Bm.uid.2B.22">&quot;+loading_messege+&quot;</DIV></DIV>&quot;;VMM.ExternalAPI.youtube.get(m)}else if(m.type==&quot;vimeo&quot;){mediaElem=&quot;<DIV class="media-shadow media-frame video vimeo" id=".22.2Bm.uid.2B.22">&quot;+loading_messege+&quot;</DIV>&quot;;VMM.ExternalAPI.vimeo.get(m)}else if(m.type==&quot;dailymotion&quot;){mediaElem=&quot;<DIV class="media-shadow">&lt;iframe class='media-frame video dailymotion' autostart='false' frameborder='0' width='100%' height='100%' src='<A href="http://www.dailymotion.com/embed/video/" class="external free" rel="nofollow">http://www.dailymotion.com/embed/video/</A>&quot;+m.id+&quot;'&gt;&lt;/iframe&gt;</DIV>&quot;}else if(m.type==&quot;vine&quot;){mediaElem=&quot;<DIV class="media-shadow media-frame video vine" id=".22.2Bm.uid.2B.22">&quot;+loading_messege+&quot;</DIV>&quot;;VMM.ExternalAPI.vine.get(m)}else if(m.type==&quot;twitter&quot;){mediaElem=&quot;<DIV class="twitter" id=".22.2Bm.uid.2B.22">&quot;+loading_messege+&quot;</DIV>&quot;;isTextMedia=true;VMM.ExternalAPI.twitter.get(m)}else if(m.type==&quot;twitter-ready&quot;){isTextMedia=true;mediaElem=m.id}else if(m.type==&quot;soundcloud&quot;){mediaElem=&quot;<DIV class="media-frame media-shadow soundcloud" id=".22.2Bm.uid.2B.22">&quot;+loading_messege+&quot;</DIV>&quot;;VMM.ExternalAPI.soundcloud.get(m)}else if(m.type==&quot;google-map&quot;){mediaElem=&quot;<DIV class="media-frame media-shadow map" id=".22.2Bm.uid.2B.22">&quot;+loading_messege+&quot;</DIV>&quot;;VMM.ExternalAPI.googlemaps.get(m)}else if(m.type==&quot;googleplus&quot;){_id=&quot;googleplus_&quot;+m.id;mediaElem=&quot;<DIV class="googleplus" id=".22.2B_id.2B.22">&quot;+loading_messege+&quot;</DIV>&quot;;isTextMedia=true;VMM.ExternalAPI.googleplus.get(m)}else if(m.type==&quot;wikipedia&quot;){mediaElem=&quot;<DIV class="wikipedia" id=".22.2Bm.uid.2B.22">&quot;+loading_messege+&quot;</DIV>&quot;;isTextMedia=true;VMM.ExternalAPI.wikipedia.get(m)}else if(m.type==&quot;storify&quot;){isTextMedia=true;mediaElem=&quot;<DIV class="plain-text-quote">&quot;+m.id+&quot;</DIV>&quot;}else if(m.type==&quot;iframe&quot;){isTextMedia=true;mediaElem=&quot;<DIV class="media-shadow">&lt;iframe class='media-frame video' autostart='false' frameborder='0' width='100%' height='100%' src='&quot;+m.id+&quot;'&gt;&lt;/iframe&gt;</DIV>&quot;}else if(m.type==&quot;quote&quot;){isTextMedia=true;mediaElem=&quot;<DIV class="plain-text-quote">&quot;+m.id+&quot;</DIV>&quot;}else if(m.type==&quot;unknown&quot;){trace(&quot;NO KNOWN MEDIA TYPE FOUND TRYING TO JUST PLACE THE HTML&quot;);isTextMedia=true;mediaElem=&quot;<DIV class="plain-text"><DIV class="container">&quot;+VMM.Util.properQuotes(m.id)+&quot;</DIV></DIV>&quot;}else if(m.type==&quot;website&quot;){mediaElem=&quot;<DIV class="media-shadow website" id=".22.2Bm.uid.2B.22">&quot;+loading_messege+&quot;</DIV>&quot;;VMM.ExternalAPI.webthumb.get(m)}else{trace(&quot;NO KNOWN MEDIA TYPE FOUND&quot;);trace(m.type)}mediaElem=&quot;<DIV class="media-container">&quot;+mediaElem+creditElem+captionElem+&quot;</DIV>&quot;;if(isTextMedia){return&quot;<DIV class="text-media"><DIV class="media-wrapper">&quot;+mediaElem+&quot;</DIV></DIV>&quot;}else{return&quot;<DIV class="media-wrapper">&quot;+mediaElem+&quot;</DIV>&quot;}}}}.init()}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.MediaType==&quot;undefined&quot;){VMM.MediaType=function(_d){var d=_d.replace(/^\s\s*/,&quot;&quot;).replace(/\s\s*$/,&quot;&quot;),success=false,media={type:&quot;unknown&quot;,id:&quot;&quot;,start:0,hd:false,link:&quot;&quot;,lang:VMM.Language.lang,uniqueid:VMM.Util.unique_ID(6)};if(d.match(&quot;div class='twitter'&quot;)){media.type=&quot;twitter-ready&quot;;media.id=d;success=true}else if(d.match(&quot;&lt;blockquote&quot;)){media.type=&quot;quote&quot;;media.id=d;success=true}else if(d.match(&quot;&lt;iframe&quot;)){media.type=&quot;iframe&quot;;trace(&quot;IFRAME&quot;);regex=/src=['&quot;](\S+?)['&quot;]/;group=d.match(regex);if(group){media.id=group[1]}trace(&quot;iframe url: &quot;+media.id);success=Boolean(media.id)}else if(d.match(&quot;(www.)?youtube|youtu.be&quot;)){if(d.match(&quot;v=&quot;)){media.id=VMM.Util.getUrlVars(d)[&quot;v&quot;]}else if(d.match(&quot;/embed/&quot;)){media.id=d.split(&quot;embed/&quot;)[1].split(/[?&amp;]/)[0]}else if(d.match(/v\/|v=|youtu\.be\//)){media.id=d.split(/v\/|v=|youtu\.be\//)[1].split(/[?&amp;]/)[0]}else{trace(&quot;YOUTUBE IN URL BUT NOT A VALID VIDEO&quot;)}media.start=VMM.Util.getUrlVars(d)[&quot;t&quot;];media.hd=VMM.Util.getUrlVars(d)[&quot;hd&quot;];media.type=&quot;youtube&quot;;success=true}else if(d.match(&quot;(player.)?vimeo.com&quot;)){media.type=&quot;vimeo&quot;;media.id=d.split(/video\/|\/\/vimeo\.com\//)[1].split(/[?&amp;]/)[0];success=true}else if(d.match(&quot;(www.)?dailymotion.com&quot;)){media.id=d.split(/video\/|\/\/dailymotion\.com\//)[1];media.type=&quot;dailymotion&quot;;success=true}else if(d.match(&quot;(www.)?vine.co&quot;)){trace(&quot;VINE&quot;);if(d.match(&quot;vine.co/v/&quot;)){media.id=d.split(&quot;vine.co/v/&quot;)[1];trace(media.id)}trace(d);media.type=&quot;vine&quot;;success=true}else if(d.match(&quot;(player.)?soundcloud.com&quot;)){media.type=&quot;soundcloud&quot;;media.id=d;success=true}else if(d.match(&quot;(www.)?twitter.com&quot;)&amp;&amp;d.match(&quot;status&quot;)){if(d.match(&quot;status/&quot;)){media.id=d.split(&quot;status/&quot;)[1]}else if(d.match(&quot;statuses/&quot;)){media.id=d.split(&quot;statuses/&quot;)[1]}else{media.id=&quot;&quot;}media.type=&quot;twitter&quot;;success=true}else if(d.match(&quot;maps.google&quot;)&amp;&amp;!d.match(&quot;staticmap&quot;)&amp;&amp;!d.match(&quot;streetview&quot;)){media.type=&quot;google-map&quot;;media.id=d;success=true}else if(d.match(/www.google.\w+\/maps/)){media.type=&quot;google-map&quot;;media.id=d;success=true}else if(d.match(&quot;plus.google&quot;)){media.type=&quot;googleplus&quot;;media.id=d.split(&quot;/posts/&quot;)[1];if(d.split(&quot;/posts/&quot;)[0].match(&quot;u/0/&quot;)){media.user=d.split(&quot;u/0/&quot;)[1].split(&quot;/posts&quot;)[0]}else{media.user=d.split(&quot;google.com/&quot;)[1].split(&quot;/posts/&quot;)[0]}success=true}else if(d.match(&quot;flickr.com/photos/&quot;)){media.type=&quot;flickr&quot;;media.id=VMM.ExternalAPI.flickr.getFlickrIdFromUrl(d);media.link=d;success=Boolean(media.id)}else if(VMM.ExternalAPI.instagram.isInstagramUrl(d)){media.type=&quot;instagram&quot;;media.link=d;media.id=VMM.ExternalAPI.instagram.getInstagramIdFromUrl(d);success=Boolean(media.id)}else if(d.match(/jpg|jpeg|png|gif|svg|bmp/i)||d.match(&quot;staticmap&quot;)||d.match(&quot;yfrog.com&quot;)||d.match(&quot;twitpic.com&quot;)||d.match(&quot;maps.googleapis.com/maps/api/streetview&quot;)){media.type=&quot;image&quot;;media.id=d;success=true}else if(VMM.FileExtention.googleDocType(d)){media.type=&quot;googledoc&quot;;media.id=d;success=true}else if(d.match(&quot;(www.)?wikipedia.org&quot;)){media.type=&quot;wikipedia&quot;;var wiki_id=d.split(&quot;wiki/&quot;)[1].split(&quot;#&quot;)[0].replace(&quot;_&quot;,&quot; &quot;);media.id=wiki_id.replace(&quot; &quot;,&quot;%20&quot;);media.lang=d.split(&quot;//&quot;)[1].split(&quot;.wikipedia&quot;)[0];success=true}else if(d.indexOf(&quot;http://&quot;)==0){media.type=&quot;website&quot;;media.id=d;success=true}else if(d.match(&quot;storify&quot;)){media.type=&quot;storify&quot;;media.id=d;success=true}else{trace(&quot;unknown media&quot;);media.type=&quot;unknown&quot;;media.id=d;success=true}if(success){return media}else{trace(&quot;No valid media id detected&quot;);trace(d)}return false}}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.TextElement==&quot;undefined&quot;){VMM.TextElement={init:function(){return this},create:function(data){return data}}.init()}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.DragSlider==&quot;undefined&quot;){VMM.DragSlider=function(){var drag={element:&quot;&quot;,element_move:&quot;&quot;,constraint:&quot;&quot;,sliding:false,pagex:{start:0,end:0},pagey:{start:0,end:0},left:{start:0,end:0},time:{start:0,end:0},touch:false,ease:&quot;easeOutExpo&quot;},dragevent={down:&quot;mousedown&quot;,up:&quot;mouseup&quot;,leave:&quot;mouseleave&quot;,move:&quot;mousemove&quot;},mousedrag={down:&quot;mousedown&quot;,up:&quot;mouseup&quot;,leave:&quot;mouseleave&quot;,move:&quot;mousemove&quot;},touchdrag={down:&quot;touchstart&quot;,up:&quot;touchend&quot;,leave:&quot;mouseleave&quot;,move:&quot;touchmove&quot;},dragslider=this,is_sticky=false;this.createPanel=function(drag_object,move_object,constraint,touch,sticky){drag.element=drag_object;drag.element_move=move_object;if(sticky!=null&amp;&amp;sticky!=&quot;&quot;){is_sticky=sticky}if(constraint!=null&amp;&amp;constraint!=&quot;&quot;){drag.constraint=constraint}else{drag.constraint=false}if(touch){drag.touch=touch}else{drag.touch=false}trace(&quot;TOUCH&quot;+drag.touch);if(drag.touch){dragevent=touchdrag}else{dragevent=mousedrag}makeDraggable(drag.element,drag.element_move)};this.updateConstraint=function(constraint){trace(&quot;updateConstraint&quot;);drag.constraint=constraint};this.cancelSlide=function(e){VMM.unbindEvent(drag.element,onDragMove,dragevent.move);return true};function makeDraggable(drag_object,move_object){VMM.bindEvent(drag_object,onDragStart,dragevent.down,{element:move_object,delement:drag_object});VMM.bindEvent(drag_object,onDragEnd,dragevent.up,{element:move_object,delement:drag_object});VMM.bindEvent(drag_object,onDragLeave,dragevent.leave,{element:move_object,delement:drag_object})}function onDragLeave(e){VMM.unbindEvent(e.data.delement,onDragMove,dragevent.move);if(!drag.touch){e.preventDefault()}e.stopPropagation();if(drag.sliding){drag.sliding=false;dragEnd(e.data.element,e.data.delement,e);return false}else{return true}}function onDragStart(e){dragStart(e.data.element,e.data.delement,e);if(!drag.touch){e.preventDefault()}return true}function onDragEnd(e){if(!drag.touch){e.preventDefault()}if(drag.sliding){drag.sliding=false;dragEnd(e.data.element,e.data.delement,e);return false}else{return true}}function onDragMove(e){dragMove(e.data.element,e)}function dragStart(elem,delem,e){if(drag.touch){trace(&quot;IS TOUCH&quot;);VMM.Lib.css(elem,&quot;-webkit-transition-duration&quot;,&quot;0&quot;);drag.pagex.start=e.originalEvent.touches[0].screenX;drag.pagey.start=e.originalEvent.touches[0].screenY}else{drag.pagex.start=e.pageX;drag.pagey.start=e.pageY}drag.left.start=getLeft(elem);drag.time.start=(new Date).getTime();VMM.Lib.stop(elem);VMM.bindEvent(delem,onDragMove,dragevent.move,{element:elem})}function dragEnd(elem,delem,e){VMM.unbindEvent(delem,onDragMove,dragevent.move);dragMomentum(elem,e)}function dragMove(elem,e){var drag_to,drag_to_y;drag.sliding=true;if(drag.touch){drag.pagex.end=e.originalEvent.touches[0].screenX;drag.pagey.end=e.originalEvent.touches[0].screenY}else{drag.pagex.end=e.pageX;drag.pagey.end=e.pageY}drag.left.end=getLeft(elem);drag_to=-(drag.pagex.start-drag.pagex.end-drag.left.start);if(Math.abs(drag.pagey.start)-Math.abs(drag.pagey.end)&gt;10){trace(&quot;SCROLLING Y&quot;);trace(Math.abs(drag.pagey.start)-Math.abs(drag.pagey.end))}if(Math.abs(drag_to-drag.left.start)&gt;10){VMM.Lib.css(elem,&quot;left&quot;,drag_to);e.preventDefault();e.stopPropagation()}}function dragMomentum(elem,e){var drag_info={left:drag.left.end,left_adjust:0,change:{x:0},time:((new Date).getTime()-drag.time.start)*10,time_adjust:((new Date).getTime()-drag.time.start)*10},multiplier=3e3;if(drag.touch){multiplier=6e3}drag_info.change.x=multiplier*(Math.abs(drag.pagex.end)-Math.abs(drag.pagex.start));drag_info.left_adjust=Math.round(drag_info.change.x/drag_info.time);drag_info.left=Math.min(drag_info.left+drag_info.left_adjust);if(drag.constraint){if(drag_info.left&gt;drag.constraint.left){drag_info.left=drag.constraint.left;if(drag_info.time&gt;5e3){drag_info.time=5e3}}else if(drag_info.left&lt;drag.constraint.right){drag_info.left=drag.constraint.right;if(drag_info.time&gt;5e3){drag_info.time=5e3}}}VMM.fireEvent(dragslider,&quot;DRAGUPDATE&quot;,[drag_info]);if(!is_sticky){if(drag_info.time&gt;0){if(drag.touch){VMM.Lib.animate(elem,drag_info.time,&quot;easeOutCirc&quot;,{left:drag_info.left})}else{VMM.Lib.animate(elem,drag_info.time,drag.ease,{left:drag_info.left})}}}}function getLeft(elem){return parseInt(VMM.Lib.css(elem,&quot;left&quot;).substring(0,VMM.Lib.css(elem,&quot;left&quot;).length-2),10)}}}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.Slider==&quot;undefined&quot;){VMM.Slider=function(parent,parent_config){var config,timer,$slider,$slider_mask,$slider_container,$slides_items,$dragslide,$explainer,events={},data=[],slides=[],slide_positions=[],slides_content=&quot;&quot;,current_slide=0,current_width=960,touch={move:false,x:10,y:0,off:0,dampen:48},content=&quot;&quot;,_active=false,layout=parent,navigation={nextBtn:&quot;&quot;,prevBtn:&quot;&quot;,nextDate:&quot;&quot;,prevDate:&quot;&quot;,nextTitle:&quot;&quot;,prevTitle:&quot;&quot;};if(typeof parent_config!=&quot;undefined&quot;){config=parent_config}else{config={preload:4,current_slide:0,interval:10,something:0,width:720,height:400,ease:&quot;easeInOutExpo&quot;,duration:1e3,timeline:false,spacing:15,slider:{width:720,height:400,content:{width:720,height:400,padding:120,padding_default:120},nav:{width:100,height:200}}}}this.ver=&quot;0.6&quot;;config.slider.width=config.width;config.slider.height=config.height;this.init=function(d){slides=[];slide_positions=[];if(typeof d!=&quot;undefined&quot;){this.setData(d)}else{trace(&quot;WAITING ON DATA&quot;)}};this.width=function(w){if(w!=null&amp;&amp;w!=&quot;&quot;){config.slider.width=w;reSize()}else{return config.slider.width}};this.height=function(h){if(h!=null&amp;&amp;h!=&quot;&quot;){config.slider.height=h;reSize()}else{return config.slider.height}};this.setData=function(d){if(typeof d!=&quot;undefined&quot;){data=d;build()}else{trace(&quot;NO DATA&quot;)}};this.getData=function(){return data};this.setConfig=function(d){if(typeof d!=&quot;undefined&quot;){config=d}else{trace(&quot;NO CONFIG DATA&quot;)}};this.getConfig=function(){return config};this.setSize=function(w,h){if(w!=null){config.slider.width=w}if(h!=null){config.slider.height=h}if(_active){reSize()}};this.active=function(){return _active};this.getCurrentNumber=function(){return current_slide};this.setSlide=function(n){goToSlide(n)};function onConfigSet(){trace(&quot;onConfigSet&quot;)}function reSize(go_to_slide,from_start){var _go_to_slide=true,_from_start=false;if(go_to_slide!=null){_go_to_slide=go_to_slide}if(from_start!=null){_from_start=from_start}current_width=config.slider.width;config.slider.nav.height=VMM.Lib.height(navigation.prevBtnContainer);if(VMM.Browser.device==&quot;mobile&quot;||current_width&lt;=640){config.slider.content.padding=10}else{config.slider.content.padding=config.slider.content.padding_default}config.slider.content.width=current_width-config.slider.content.padding*2;VMM.Lib.width($slides_items,slides.length*config.slider.content.width);if(_from_start){VMM.Lib.css($slider_container,&quot;left&quot;,slides[current_slide].leftpos())}sizeSlides();positionSlides();VMM.Lib.css(navigation.nextBtn,&quot;left&quot;,current_width-config.slider.nav.width);VMM.Lib.height(navigation.prevBtn,config.slider.height);VMM.Lib.height(navigation.nextBtn,config.slider.height);VMM.Lib.css(navigation.nextBtnContainer,&quot;top&quot;,config.slider.height/2-config.slider.nav.height/2+10);VMM.Lib.css(navigation.prevBtnContainer,&quot;top&quot;,config.slider.height/2-config.slider.nav.height/2+10);VMM.Lib.height($slider_mask,config.slider.height);VMM.Lib.width($slider_mask,current_width);if(_go_to_slide){goToSlide(current_slide,&quot;linear&quot;,1)}if(current_slide==0){VMM.Lib.visible(navigation.prevBtn,false)}}function onDragFinish(e,d){trace(&quot;DRAG FINISH&quot;);trace(d.left_adjust);trace(config.slider.width/2);if(d.left_adjust&lt;0){if(Math.abs(d.left_adjust)&gt;config.slider.width/2){if(current_slide==slides.length-1){backToCurrentSlide()}else{goToSlide(current_slide+1,&quot;easeOutExpo&quot;);upDate()}}else{backToCurrentSlide()}}else if(Math.abs(d.left_adjust)&gt;config.slider.width/2){if(current_slide==0){backToCurrentSlide()}else{goToSlide(current_slide-1,&quot;easeOutExpo&quot;);upDate()}}else{backToCurrentSlide()}}function onNextClick(e){if(current_slide==slides.length-1){backToCurrentSlide()}else{goToSlide(current_slide+1);upDate()}}function onPrevClick(e){if(current_slide==0){backToCurrentSlide()}else{goToSlide(current_slide-1);upDate()}}function onKeypressNav(e){switch(e.keyCode){case 39:onNextClick(e);break;case 37:onPrevClick(e);break}}function onTouchUpdate(e,b){if(slide_positions.length==0){for(var i=0;i&lt;slides.length;i++){slide_positions.push(slides[i].leftpos())}}if(typeof b.left==&quot;number&quot;){var _pos=b.left;var _slide_pos=-slides[current_slide].leftpos();if(_pos&lt;_slide_pos-config.slider_width/3){onNextClick()}else if(_pos&gt;_slide_pos+config.slider_width/3){onPrevClick()}else{VMM.Lib.animate($slider_container,config.duration,config.ease,{left:_slide_pos})}}else{VMM.Lib.animate($slider_container,config.duration,config.ease,{left:_slide_pos})}if(typeof b.top==&quot;number&quot;){VMM.Lib.animate($slider_container,config.duration,config.ease,{top:-b.top})}else{}}function onExplainerClick(e){detachMessege()}function upDate(){config.current_slide=current_slide;VMM.fireEvent(layout,&quot;UPDATE&quot;)}function getData(d){data=d}function buildSlides(d){var i=0;VMM.attachElement($slides_items,&quot;&quot;);slides=[];for(i=0;i&lt;d.length;i++){var _slide=new VMM.Slider.Slide(d[i],$slides_items);slides.push(_slide)}}function preloadSlides(skip){var i=0;
if(skip){preloadTimeOutSlides()}else{for(i=0;i&lt;slides.length;i++){slides[i].clearTimers()}timer=setTimeout(preloadTimeOutSlides,config.duration)}}function preloadTimeOutSlides(){var i=0;for(i=0;i&lt;slides.length;i++){slides[i].enqueue=true}for(i=0;i&lt;config.preload;i++){if(!(current_slide+i&gt;slides.length-1)){slides[current_slide+i].show();slides[current_slide+i].enqueue=false}if(!(current_slide-i&lt;0)){slides[current_slide-i].show();slides[current_slide-i].enqueue=false}}if(slides.length&gt;50){for(i=0;i&lt;slides.length;i++){if(slides[i].enqueue){slides[i].hide()}}}sizeSlides()}function sizeSlide(slide_id){}function sizeSlides(){var i=0,layout_text_media=&quot;.slider-item .layout-text-media .media .media-container &quot;,layout_media=&quot;.slider-item .layout-media .media .media-container &quot;,layout_both=&quot;.slider-item .media .media-container&quot;,layout_caption=&quot;.slider-item .media .media-container .media-shadow .caption&quot;,is_skinny=false,mediasize={text_media:{width:config.slider.content.width/100*60,height:config.slider.height-60,video:{width:0,height:0},text:{width:config.slider.content.width/100*40-30,height:config.slider.height}},media:{width:config.slider.content.width,height:config.slider.height-110,video:{width:0,height:0}}};if(VMM.Browser.device==&quot;mobile&quot;||current_width&lt;641){is_skinny=true}VMM.master_config.sizes.api.width=mediasize.media.width;VMM.master_config.sizes.api.height=mediasize.media.height;mediasize.text_media.video=VMM.Util.ratio.fit(mediasize.text_media.width,mediasize.text_media.height,16,9);mediasize.media.video=VMM.Util.ratio.fit(mediasize.media.width,mediasize.media.height,16,9);VMM.Lib.css(&quot;.slider-item&quot;,&quot;width&quot;,config.slider.content.width);VMM.Lib.height(&quot;.slider-item&quot;,config.slider.height);if(is_skinny){mediasize.text_media.width=config.slider.content.width-config.slider.content.padding*2;mediasize.media.width=config.slider.content.width-config.slider.content.padding*2;mediasize.text_media.height=config.slider.height/100*50-50;mediasize.media.height=config.slider.height/100*70-40;mediasize.text_media.video=VMM.Util.ratio.fit(mediasize.text_media.width,mediasize.text_media.height,16,9);mediasize.media.video=VMM.Util.ratio.fit(mediasize.media.width,mediasize.media.height,16,9);VMM.Lib.css(&quot;.slider-item .layout-text-media .text&quot;,&quot;width&quot;,&quot;100%&quot;);VMM.Lib.css(&quot;.slider-item .layout-text-media .text&quot;,&quot;display&quot;,&quot;block&quot;);VMM.Lib.css(&quot;.slider-item .layout-text-media .text .container&quot;,&quot;display&quot;,&quot;block&quot;);VMM.Lib.css(&quot;.slider-item .layout-text-media .text .container&quot;,&quot;width&quot;,mediasize.media.width);VMM.Lib.css(&quot;.slider-item .layout-text-media .text .container .start&quot;,&quot;width&quot;,&quot;auto&quot;);VMM.Lib.css(&quot;.slider-item .layout-text-media .media&quot;,&quot;float&quot;,&quot;none&quot;);VMM.Lib.addClass(&quot;.slider-item .content-container&quot;,&quot;pad-top&quot;);VMM.Lib.css(&quot;.slider-item .media blockquote p&quot;,&quot;line-height&quot;,&quot;18px&quot;);VMM.Lib.css(&quot;.slider-item .media blockquote p&quot;,&quot;font-size&quot;,&quot;16px&quot;);VMM.Lib.css(&quot;.slider-item&quot;,&quot;overflow-y&quot;,&quot;auto&quot;)}else{VMM.Lib.css(&quot;.slider-item .layout-text-media .text&quot;,&quot;width&quot;,&quot;40%&quot;);VMM.Lib.css(&quot;.slider-item .layout-text-media .text&quot;,&quot;display&quot;,&quot;table-cell&quot;);VMM.Lib.css(&quot;.slider-item .layout-text-media .text .container&quot;,&quot;display&quot;,&quot;table-cell&quot;);VMM.Lib.css(&quot;.slider-item .layout-text-media .text .container&quot;,&quot;width&quot;,&quot;auto&quot;);VMM.Lib.css(&quot;.slider-item .layout-text-media .text .container .start&quot;,&quot;width&quot;,mediasize.text_media.text.width);VMM.Lib.removeClass(&quot;.slider-item .content-container&quot;,&quot;pad-top&quot;);VMM.Lib.css(&quot;.slider-item .layout-text-media .media&quot;,&quot;float&quot;,&quot;left&quot;);VMM.Lib.css(&quot;.slider-item .layout-text-media&quot;,&quot;display&quot;,&quot;table&quot;);VMM.Lib.css(&quot;.slider-item .media blockquote p&quot;,&quot;line-height&quot;,&quot;36px&quot;);VMM.Lib.css(&quot;.slider-item .media blockquote p&quot;,&quot;font-size&quot;,&quot;28px&quot;);VMM.Lib.css(&quot;.slider-item&quot;,&quot;display&quot;,&quot;table&quot;);VMM.Lib.css(&quot;.slider-item&quot;,&quot;overflow-y&quot;,&quot;auto&quot;)}VMM.Lib.css(layout_text_media+&quot;.media-frame&quot;,&quot;max-width&quot;,mediasize.text_media.width);VMM.Lib.height(layout_text_media+&quot;.media-frame&quot;,mediasize.text_media.height);VMM.Lib.width(layout_text_media+&quot;.media-frame&quot;,mediasize.text_media.width);VMM.Lib.css(layout_text_media+&quot;img&quot;,&quot;max-height&quot;,mediasize.text_media.height);VMM.Lib.css(layout_media+&quot;img&quot;,&quot;max-height&quot;,mediasize.media.height);VMM.Lib.css(layout_text_media+&quot;img&quot;,&quot;max-width&quot;,mediasize.text_media.width);VMM.Lib.css(layout_text_media+&quot;.avatar img&quot;,&quot;max-width&quot;,32);VMM.Lib.css(layout_text_media+&quot;.avatar img&quot;,&quot;max-height&quot;,32);VMM.Lib.css(layout_media+&quot;.avatar img&quot;,&quot;max-width&quot;,32);VMM.Lib.css(layout_media+&quot;.avatar img&quot;,&quot;max-height&quot;,32);VMM.Lib.css(layout_text_media+&quot;.article-thumb&quot;,&quot;max-width&quot;,&quot;50%&quot;);VMM.Lib.css(layout_media+&quot;.article-thumb&quot;,&quot;max-width&quot;,200);VMM.Lib.width(layout_text_media+&quot;.media-frame&quot;,mediasize.text_media.video.width);VMM.Lib.height(layout_text_media+&quot;.media-frame&quot;,mediasize.text_media.video.height);VMM.Lib.width(layout_media+&quot;.media-frame&quot;,mediasize.media.video.width);VMM.Lib.height(layout_media+&quot;.media-frame&quot;,mediasize.media.video.height);VMM.Lib.css(layout_media+&quot;.media-frame&quot;,&quot;max-height&quot;,mediasize.media.video.height);VMM.Lib.css(layout_media+&quot;.media-frame&quot;,&quot;max-width&quot;,mediasize.media.video.width);VMM.Lib.height(layout_media+&quot;.soundcloud&quot;,168);VMM.Lib.height(layout_text_media+&quot;.soundcloud&quot;,168);VMM.Lib.width(layout_media+&quot;.soundcloud&quot;,mediasize.media.width);VMM.Lib.width(layout_text_media+&quot;.soundcloud&quot;,mediasize.text_media.width);VMM.Lib.css(layout_both+&quot;.soundcloud&quot;,&quot;max-height&quot;,168);VMM.Lib.height(layout_text_media+&quot;.map&quot;,mediasize.text_media.height);VMM.Lib.width(layout_text_media+&quot;.map&quot;,mediasize.text_media.width);VMM.Lib.css(layout_media+&quot;.map&quot;,&quot;max-height&quot;,mediasize.media.height);VMM.Lib.width(layout_media+&quot;.map&quot;,mediasize.media.width);VMM.Lib.height(layout_text_media+&quot;.doc&quot;,mediasize.text_media.height);VMM.Lib.width(layout_text_media+&quot;.doc&quot;,mediasize.text_media.width);VMM.Lib.height(layout_media+&quot;.doc&quot;,mediasize.media.height);VMM.Lib.width(layout_media+&quot;.doc&quot;,mediasize.media.width);VMM.Lib.width(layout_media+&quot;.wikipedia&quot;,mediasize.media.width);VMM.Lib.width(layout_media+&quot;.twitter&quot;,mediasize.media.width);VMM.Lib.width(layout_media+&quot;.plain-text-quote&quot;,mediasize.media.width);VMM.Lib.width(layout_media+&quot;.plain-text&quot;,mediasize.media.width);VMM.Lib.css(layout_both,&quot;max-width&quot;,mediasize.media.width);VMM.Lib.css(layout_text_media+&quot;.caption&quot;,&quot;max-width&quot;,mediasize.text_media.video.width);VMM.Lib.css(layout_media+&quot;.caption&quot;,&quot;max-width&quot;,mediasize.media.video.width);for(i=0;i&lt;slides.length;i++){slides[i].layout(is_skinny);if(slides[i].content_height()&gt;config.slider.height+20){slides[i].css(&quot;display&quot;,&quot;block&quot;)}else{slides[i].css(&quot;display&quot;,&quot;table&quot;)}}}function positionSlides(){var pos=0,i=0;for(i=0;i&lt;slides.length;i++){pos=i*(config.slider.width+config.spacing);slides[i].leftpos(pos)}}function opacitySlides(n){var _ease=&quot;linear&quot;,i=0;for(i=0;i&lt;slides.length;i++){if(i==current_slide){slides[i].animate(config.duration,_ease,{opacity:1})}else if(i==current_slide-1||i==current_slide+1){slides[i].animate(config.duration,_ease,{opacity:.1})}else{slides[i].opacity(n)}}}function goToSlide(n,ease,duration,fast,firstrun){var _ease=config.ease,_duration=config.duration,is_last=false,is_first=false,_title=&quot;&quot;,_pos;VMM.ExternalAPI.youtube.stopPlayers();current_slide=n;_pos=slides[current_slide].leftpos();if(current_slide==0){is_first=true}if(current_slide+1&gt;=slides.length){is_last=true}if(ease!=null&amp;&amp;ease!=&quot;&quot;){_ease=ease}if(duration!=null&amp;&amp;duration!=&quot;&quot;){_duration=duration}if(VMM.Browser.device==&quot;mobile&quot;){VMM.Lib.visible(navigation.prevBtn,false);VMM.Lib.visible(navigation.nextBtn,false)}else{if(is_first){VMM.Lib.visible(navigation.prevBtn,false)}else{VMM.Lib.visible(navigation.prevBtn,true);_title=VMM.Util.unlinkify(data[current_slide-1].title);if(config.type==&quot;timeline&quot;){if(typeof data[current_slide-1].date===&quot;undefined&quot;){VMM.attachElement(navigation.prevDate,_title);VMM.attachElement(navigation.prevTitle,&quot;&quot;)}else{VMM.attachElement(navigation.prevDate,VMM.Date.prettyDate(data[current_slide-1].startdate,false,data[current_slide-1].precisiondate));VMM.attachElement(navigation.prevTitle,_title)}}else{VMM.attachElement(navigation.prevTitle,_title)}}if(is_last){VMM.Lib.visible(navigation.nextBtn,false)}else{VMM.Lib.visible(navigation.nextBtn,true);_title=VMM.Util.unlinkify(data[current_slide+1].title);if(config.type==&quot;timeline&quot;){if(typeof data[current_slide+1].date===&quot;undefined&quot;){VMM.attachElement(navigation.nextDate,_title);VMM.attachElement(navigation.nextTitle,&quot;&quot;)}else{VMM.attachElement(navigation.nextDate,VMM.Date.prettyDate(data[current_slide+1].startdate,false,data[current_slide+1].precisiondate));VMM.attachElement(navigation.nextTitle,_title)}}else{VMM.attachElement(navigation.nextTitle,_title)}}}if(fast){VMM.Lib.css($slider_container,&quot;left&quot;,-(_pos-config.slider.content.padding))}else{VMM.Lib.stop($slider_container);VMM.Lib.animate($slider_container,_duration,_ease,{left:-(_pos-config.slider.content.padding)})}if(firstrun){VMM.fireEvent(layout,&quot;LOADED&quot;)}if(slides[current_slide].height()&gt;config.slider_height){VMM.Lib.css(&quot;.slider&quot;,&quot;overflow-y&quot;,&quot;scroll&quot;)}else{VMM.Lib.css(layout,&quot;overflow-y&quot;,&quot;hidden&quot;);var scroll_height=0;try{scroll_height=VMM.Lib.prop(layout,&quot;scrollHeight&quot;);VMM.Lib.animate(layout,_duration,_ease,{scrollTop:scroll_height-VMM.Lib.height(layout)})}catch(err){scroll_height=VMM.Lib.height(layout)}}preloadSlides();VMM.fireEvent($slider,&quot;MESSAGE&quot;,&quot;TEST&quot;)}function backToCurrentSlide(){VMM.Lib.stop($slider_container);VMM.Lib.animate($slider_container,config.duration,&quot;easeOutExpo&quot;,{left:-slides[current_slide].leftpos()+config.slider.content.padding})}function showMessege(e,msg,other){trace(&quot;showMessege &quot;+msg);VMM.attachElement($explainer,&quot;<DIV class="vco-explainer"><DIV class="vco-explainer-container"><DIV class="vco-bezel">&quot;+&quot;<DIV class="vco-message"><P>&quot;+msg+&quot;</P></DIV></DIV></DIV></DIV>&quot;)}function hideMessege(){VMM.Lib.animate($explainer,config.duration,config.ease,{opacity:0},detachMessege)}function detachMessege(){VMM.Lib.detach($explainer)}function buildNavigation(){var temp_icon=&quot;<DIV class="icon">Â </DIV>&quot;;navigation.nextBtn=VMM.appendAndGetElement($slider,&quot;<DIV>&quot;,&quot;nav-next&quot;);navigation.prevBtn=VMM.appendAndGetElement($slider,&quot;<DIV>&quot;,&quot;nav-previous&quot;);navigation.nextBtnContainer=VMM.appendAndGetElement(navigation.nextBtn,&quot;<DIV>&quot;,&quot;nav-container&quot;,temp_icon);navigation.prevBtnContainer=VMM.appendAndGetElement(navigation.prevBtn,&quot;<DIV>&quot;,&quot;nav-container&quot;,temp_icon);if(config.type==&quot;timeline&quot;){navigation.nextDate=VMM.appendAndGetElement(navigation.nextBtnContainer,&quot;<DIV>&quot;,&quot;date&quot;,&quot;&quot;);navigation.prevDate=VMM.appendAndGetElement(navigation.prevBtnContainer,&quot;<DIV>&quot;,&quot;date&quot;,&quot;&quot;)}navigation.nextTitle=VMM.appendAndGetElement(navigation.nextBtnContainer,&quot;<DIV>&quot;,&quot;title&quot;,&quot;&quot;);navigation.prevTitle=VMM.appendAndGetElement(navigation.prevBtnContainer,&quot;<DIV>&quot;,&quot;title&quot;,&quot;&quot;);VMM.bindEvent(&quot;.nav-next&quot;,onNextClick);VMM.bindEvent(&quot;.nav-previous&quot;,onPrevClick);VMM.bindEvent(window,onKeypressNav,&quot;keydown&quot;)}function build(){var __duration=3e3;VMM.attachElement(layout,&quot;&quot;);$slider=VMM.getElement(layout);$slider_mask=VMM.appendAndGetElement($slider,&quot;<DIV>&quot;,&quot;slider-container-mask&quot;);$slider_container=VMM.appendAndGetElement($slider_mask,&quot;<DIV>&quot;,&quot;slider-container&quot;);$slides_items=VMM.appendAndGetElement($slider_container,&quot;<DIV>&quot;,&quot;slider-item-container&quot;);buildNavigation();buildSlides(data);if(VMM.Browser.device==&quot;tablet&quot;||VMM.Browser.device==&quot;mobile&quot;){config.duration=500;__duration=1e3;$dragslide=new VMM.DragSlider;$dragslide.createPanel($slider,$slider_container,&quot;&quot;,config.touch,true);VMM.bindEvent($dragslide,onDragFinish,&quot;DRAGUPDATE&quot;);$explainer=VMM.appendAndGetElement($slider_mask,&quot;<DIV>&quot;,&quot;vco-feedback&quot;,&quot;&quot;);showMessege(null,&quot;Swipe to Navigate&quot;);VMM.Lib.height($explainer,config.slider.height);VMM.bindEvent($explainer,onExplainerClick);VMM.bindEvent($explainer,onExplainerClick,&quot;touchend&quot;)}reSize(false,true);VMM.Lib.visible(navigation.prevBtn,false);goToSlide(config.current_slide,&quot;easeOutExpo&quot;,__duration,true,true);_active=true}}}if(typeof VMM.Slider!=&quot;undefined&quot;){VMM.Slider.Slide=function(d,_parent){var $media,$text,$slide,$wrap,element,c,data=d,slide={},element=&quot;&quot;,media=&quot;&quot;,loaded=false,preloaded=false,is_skinny=false,_enqueue=true,_removeque=false,_id=&quot;slide_&quot;,_class=0,timer={pushque:&quot;&quot;,render:&quot;&quot;,relayout:&quot;&quot;,remove:&quot;&quot;,skinny:false},times={pushque:500,render:100,relayout:100,remove:3e4};_id=_id+data.uniqueid;this.enqueue=_enqueue;this.id=_id;element=VMM.appendAndGetElement(_parent,&quot;<DIV>&quot;,&quot;slider-item&quot;);if(typeof data.classname!=&quot;undefined&quot;){trace(&quot;HAS CLASSNAME&quot;);VMM.Lib.addClass(element,data.classname)}else{trace(&quot;NO CLASSNAME&quot;);trace(data)}c={slide:&quot;&quot;,text:&quot;&quot;,media:&quot;&quot;,media_element:&quot;&quot;,layout:&quot;content-container layout&quot;,has:{headline:false,text:false,media:false}};this.show=function(skinny){_enqueue=false;timer.skinny=skinny;_removeque=false;clearTimeout(timer.remove);if(!loaded){if(preloaded){clearTimeout(timer.relayout);timer.relayout=setTimeout(reloadLayout,times.relayout)}else{render(skinny)}}};this.hide=function(){if(loaded&amp;&amp;!_removeque){_removeque=true;clearTimeout(timer.remove);timer.remove=setTimeout(removeSlide,times.remove)}};this.clearTimers=function(){clearTimeout(timer.relayout);clearTimeout(timer.pushque);clearTimeout(timer.render)};this.layout=function(skinny){if(loaded&amp;&amp;preloaded){reLayout(skinny)}};this.elem=function(){return element};this.position=function(){return VMM.Lib.position(element)};this.leftpos=function(p){if(typeof p!=&quot;undefined&quot;){VMM.Lib.css(element,&quot;left&quot;,p)}else{return VMM.Lib.position(element).left}};this.animate=function(d,e,p){VMM.Lib.animate(element,d,e,p)};this.css=function(p,v){VMM.Lib.css(element,p,v)};this.opacity=function(p){VMM.Lib.css(element,&quot;opacity&quot;,p)};this.width=function(){return VMM.Lib.width(element)};this.height=function(){return VMM.Lib.height(element)};this.content_height=function(){var ch=VMM.Lib.find(element,&quot;.content&quot;)[0];if(ch!=&quot;undefined&quot;&amp;&amp;ch!=null){return VMM.Lib.height(ch)}else{return 0}};var render=function(skinny){trace(&quot;RENDER &quot;+_id);loaded=true;preloaded=true;timer.skinny=skinny;buildSlide();clearTimeout(timer.pushque);clearTimeout(timer.render);timer.pushque=setTimeout(VMM.ExternalAPI.pushQues,times.pushque)};var removeSlide=function(){trace(&quot;REMOVE SLIDE TIMER FINISHED&quot;);loaded=false;VMM.Lib.detach($text);VMM.Lib.detach($media)};var reloadLayout=function(){loaded=true;reLayout(timer.skinny,true)};var reLayout=function(skinny,reload){if(c.has.text){if(skinny){if(!is_skinny||reload){VMM.Lib.removeClass($slide,&quot;pad-left&quot;);VMM.Lib.detach($text);VMM.Lib.detach($media);VMM.Lib.append($slide,$text);VMM.Lib.append($slide,$media);is_skinny=true}}else{if(is_skinny||reload){VMM.Lib.addClass($slide,&quot;pad-left&quot;);VMM.Lib.detach($text);VMM.Lib.detach($media);VMM.Lib.append($slide,$media);VMM.Lib.append($slide,$text);is_skinny=false}}}else if(reload){if(c.has.headline){VMM.Lib.detach($text);VMM.Lib.append($slide,$text)}VMM.Lib.detach($media);VMM.Lib.append($slide,$media)}};var buildSlide=function(){trace(&quot;BUILDSLIDE&quot;);$wrap=VMM.appendAndGetElement(element,&quot;<DIV>&quot;,&quot;content&quot;);$slide=VMM.appendAndGetElement($wrap,&quot;<DIV>&quot;);if(data.startdate!=null&amp;&amp;data.startdate!=&quot;&quot;){if(type.of(data.startdate)==&quot;date&quot;){if(data.type!=&quot;start&quot;){var st=VMM.Date.prettyDate(data.startdate,false,data.precisiondate);var en=VMM.Date.prettyDate(data.enddate,false,data.precisiondate);var tag=&quot;&quot;;if(data.tag!=null&amp;&amp;data.tag!=&quot;&quot;){tag=VMM.createElement(&quot;span&quot;,data.tag,&quot;slide-tag&quot;)}if(st!=en){c.text+=VMM.createElement(&quot;h2&quot;,st+&quot; â &quot;+en+tag,&quot;date&quot;)}else{c.text+=VMM.createElement(&quot;h2&quot;,st+tag,&quot;date&quot;)}}}}if(data.headline!=null&amp;&amp;data.headline!=&quot;&quot;){c.has.headline=true;if(data.type==&quot;start&quot;){c.text+=VMM.createElement(&quot;h2&quot;,VMM.Util.linkify_with_twitter(data.headline,&quot;_blank&quot;),&quot;start&quot;)}else{c.text+=VMM.createElement(&quot;h3&quot;,VMM.Util.linkify_with_twitter(data.headline,&quot;_blank&quot;))}}if(data.text!=null&amp;&amp;data.text!=&quot;&quot;){c.has.text=true;c.text+=VMM.createElement(&quot;p&quot;,VMM.Util.linkify_with_twitter(data.text,&quot;_blank&quot;))}if(c.has.text||c.has.headline){c.text=VMM.createElement(&quot;div&quot;,c.text,&quot;container&quot;);$text=VMM.appendAndGetElement($slide,&quot;<DIV>&quot;,&quot;text&quot;,VMM.TextElement.create(c.text))}if(data.needs_slug){}if(data.asset!=null&amp;&amp;data.asset!=&quot;&quot;){if(data.asset.media!=null&amp;&amp;data.asset.media!=&quot;&quot;){c.has.media=true;$media=VMM.appendAndGetElement($slide,&quot;<DIV>&quot;,&quot;media&quot;,VMM.MediaElement.create(data.asset,data.uniqueid))}}if(c.has.text){c.layout+=&quot;-text&quot;}if(c.has.media){c.layout+=&quot;-media&quot;}if(c.has.text){if(timer.skinny){VMM.Lib.addClass($slide,c.layout);is_skinny=true}else{VMM.Lib.addClass($slide,c.layout);VMM.Lib.addClass($slide,&quot;pad-left&quot;);VMM.Lib.detach($text);VMM.Lib.append($slide,$text)}}else{VMM.Lib.addClass($slide,c.layout)}}}}var Aes={};Aes.cipher=function(input,w){var Nb=4;var Nr=w.length/Nb-1;var state=[[],[],[],[]];for(var i=0;i&lt;4*Nb;i++)state[i%4][Math.floor(i/4)]=input[i];state=Aes.addRoundKey(state,w,0,Nb);for(var round=1;round&lt;Nr;round++){state=Aes.subBytes(state,Nb);state=Aes.shiftRows(state,Nb);state=Aes.mixColumns(state,Nb);state=Aes.addRoundKey(state,w,round,Nb)}state=Aes.subBytes(state,Nb);state=Aes.shiftRows(state,Nb);state=Aes.addRoundKey(state,w,Nr,Nb);var output=new Array(4*Nb);for(var i=0;i&lt;4*Nb;i++)output[i]=state[i%4][Math.floor(i/4)];return output};Aes.keyExpansion=function(key){var Nb=4;var Nk=key.length/4;var Nr=Nk+6;var w=new Array(Nb*(Nr+1));var temp=new Array(4);for(var i=0;i&lt;Nk;i++){var r=[key[4*i],key[4*i+1],key[4*i+2],key[4*i+3]];w[i]=r}for(var i=Nk;i&lt;Nb*(Nr+1);i++){w[i]=new Array(4);for(var t=0;t&lt;4;t++)temp[t]=w[i-1][t];if(i%Nk==0){temp=Aes.subWord(Aes.rotWord(temp));for(var t=0;t&lt;4;t++)temp[t]^=Aes.rCon[i/Nk][t]}else if(Nk&gt;6&amp;&amp;i%Nk==4){temp=Aes.subWord(temp)}for(var t=0;t&lt;4;t++)w[i][t]=w[i-Nk][t]^temp[t]}return w};Aes.subBytes=function(s,Nb){for(var r=0;r&lt;4;r++){for(var c=0;c&lt;Nb;c++)s[r][c]=Aes.sBox[s[r][c]]}return s};Aes.shiftRows=function(s,Nb){var t=new Array(4);for(var r=1;r&lt;4;r++){for(var c=0;c&lt;4;c++)t[c]=s[r][(c+r)%Nb];for(var c=0;c&lt;4;c++)s[r][c]=t[c]}return s};Aes.mixColumns=function(s,Nb){for(var c=0;c&lt;4;c++){var a=new Array(4);var b=new Array(4);for(var i=0;i&lt;4;i++){a[i]=s[i][c];b[i]=s[i][c]&amp;128?s[i][c]&lt;&lt;1^283:s[i][c]&lt;&lt;1}s[0][c]=b[0]^a[1]^b[1]^a[2]^a[3];s[1][c]=a[0]^b[1]^a[2]^b[2]^a[3];s[2][c]=a[0]^a[1]^b[2]^a[3]^b[3];s[3][c]=a[0]^b[0]^a[1]^a[2]^b[3]}return s};Aes.addRoundKey=function(state,w,rnd,Nb){for(var r=0;r&lt;4;r++){for(var c=0;c&lt;Nb;c++)state[r][c]^=w[rnd*4+c][r]}return state};Aes.subWord=function(w){for(var i=0;i&lt;4;i++)w[i]=Aes.sBox[w[i]];return w};Aes.rotWord=function(w){var tmp=w[0];for(var i=0;i&lt;3;i++)w[i]=w[i+1];w[3]=tmp;return w};Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];Aes.Ctr={};Aes.Ctr.encrypt=function(plaintext,password,nBits){var blockSize=16;if(!(nBits==128||nBits==192||nBits==256))return&quot;&quot;;plaintext=Utf8.encode(plaintext);password=Utf8.encode(password);var nBytes=nBits/8;var pwBytes=new Array(nBytes);for(var i=0;i&lt;nBytes;i++){pwBytes[i]=isNaN(password.charCodeAt(i))?0:password.charCodeAt(i)}var key=Aes.cipher(pwBytes,Aes.keyExpansion(pwBytes));key=key.concat(key.slice(0,nBytes-16));var counterBlock=new Array(blockSize);var nonce=(new Date).getTime();var nonceMs=nonce%1e3;var nonceSec=Math.floor(nonce/1e3);var nonceRnd=Math.floor(Math.random()*65535);for(var i=0;i&lt;2;i++)counterBlock[i]=nonceMs&gt;&gt;&gt;i*8&amp;255;for(var i=0;i&lt;2;i++)counterBlock[i+2]=nonceRnd&gt;&gt;&gt;i*8&amp;255;for(var i=0;i&lt;4;i++)counterBlock[i+4]=nonceSec&gt;&gt;&gt;i*8&amp;255;var ctrTxt=&quot;&quot;;for(var i=0;i&lt;8;i++)ctrTxt+=String.fromCharCode(counterBlock[i]);var keySchedule=Aes.keyExpansion(key);var blockCount=Math.ceil(plaintext.length/blockSize);var ciphertxt=new Array(blockCount);for(var b=0;b&lt;blockCount;b++){for(var c=0;c&lt;4;c++)counterBlock[15-c]=b&gt;&gt;&gt;c*8&amp;255;for(var c=0;c&lt;4;c++)counterBlock[15-c-4]=b/4294967296&gt;&gt;&gt;c*8;var cipherCntr=Aes.cipher(counterBlock,keySchedule);var blockLength=b&lt;blockCount-1?blockSize:(plaintext.length-1)%blockSize+1;var cipherChar=new Array(blockLength);for(var i=0;i&lt;blockLength;i++){cipherChar[i]=cipherCntr[i]^plaintext.charCodeAt(b*blockSize+i);cipherChar[i]=String.fromCharCode(cipherChar[i])}ciphertxt[b]=cipherChar.join(&quot;&quot;)}var ciphertext=ctrTxt+ciphertxt.join(&quot;&quot;);ciphertext=Base64.encode(ciphertext);return ciphertext};Aes.Ctr.decrypt=function(ciphertext,password,nBits){var blockSize=16;if(!(nBits==128||nBits==192||nBits==256))return&quot;&quot;;ciphertext=Base64.decode(ciphertext);password=Utf8.encode(password);var nBytes=nBits/8;var pwBytes=new Array(nBytes);for(var i=0;i&lt;nBytes;i++){pwBytes[i]=isNaN(password.charCodeAt(i))?0:password.charCodeAt(i)}var key=Aes.cipher(pwBytes,Aes.keyExpansion(pwBytes));key=key.concat(key.slice(0,nBytes-16));var counterBlock=new Array(8);ctrTxt=ciphertext.slice(0,8);for(var i=0;i&lt;8;i++)counterBlock[i]=ctrTxt.charCodeAt(i);var keySchedule=Aes.keyExpansion(key);var nBlocks=Math.ceil((ciphertext.length-8)/blockSize);var ct=new Array(nBlocks);for(var b=0;b&lt;nBlocks;b++)ct[b]=ciphertext.slice(8+b*blockSize,8+b*blockSize+blockSize);ciphertext=ct;var plaintxt=new Array(ciphertext.length);for(var b=0;b&lt;nBlocks;b++){for(var c=0;c&lt;4;c++)counterBlock[15-c]=b&gt;&gt;&gt;c*8&amp;255;for(var c=0;c&lt;4;c++)counterBlock[15-c-4]=(b+1)/4294967296-1&gt;&gt;&gt;c*8&amp;255;var cipherCntr=Aes.cipher(counterBlock,keySchedule);var plaintxtByte=new Array(ciphertext[b].length);for(var i=0;i&lt;ciphertext[b].length;i++){plaintxtByte[i]=cipherCntr[i]^ciphertext[b].charCodeAt(i);plaintxtByte[i]=String.fromCharCode(plaintxtByte[i])}plaintxt[b]=plaintxtByte.join(&quot;&quot;)}var plaintext=plaintxt.join(&quot;&quot;);plaintext=Utf8.decode(plaintext);return plaintext};var Base64={};Base64.code=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;;Base64.encode=function(str,utf8encode){utf8encode=typeof utf8encode==&quot;undefined&quot;?false:utf8encode;var o1,o2,o3,bits,h1,h2,h3,h4,e=[],pad=&quot;&quot;,c,plain,coded;var b64=Base64.code;plain=utf8encode?str.encodeUTF8():str;c=plain.length%3;if(c&gt;0){while(c++&lt;3){pad+=&quot;=&quot;;plain+=&quot;\x00&quot;}}for(c=0;c&lt;plain.length;c+=3){o1=plain.charCodeAt(c);o2=plain.charCodeAt(c+1);o3=plain.charCodeAt(c+2);bits=o1&lt;&lt;16|o2&lt;&lt;8|o3;h1=bits&gt;&gt;18&amp;63;h2=bits&gt;&gt;12&amp;63;h3=bits&gt;&gt;6&amp;63;h4=bits&amp;63;e[c/3]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4)}coded=e.join(&quot;&quot;);coded=coded.slice(0,coded.length-pad.length)+pad;return coded};Base64.decode=function(str,utf8decode){utf8decode=typeof utf8decode==&quot;undefined&quot;?false:utf8decode;var o1,o2,o3,h1,h2,h3,h4,bits,d=[],plain,coded;var b64=Base64.code;coded=utf8decode?str.decodeUTF8():str;for(var c=0;c&lt;coded.length;c+=4){h1=b64.indexOf(coded.charAt(c));h2=b64.indexOf(coded.charAt(c+1));h3=b64.indexOf(coded.charAt(c+2));h4=b64.indexOf(coded.charAt(c+3));bits=h1&lt;&lt;18|h2&lt;&lt;12|h3&lt;&lt;6|h4;o1=bits&gt;&gt;&gt;16&amp;255;o2=bits&gt;&gt;&gt;8&amp;255;o3=bits&amp;255;d[c/4]=String.fromCharCode(o1,o2,o3);if(h4==64)d[c/4]=String.fromCharCode(o1,o2);if(h3==64)d[c/4]=String.fromCharCode(o1)}plain=d.join(&quot;&quot;);return utf8decode?plain.decodeUTF8():plain};var Utf8={};Utf8.encode=function(strUni){var strUtf=strUni.replace(/[\u0080-\u07ff]/g,function(c){var cc=c.charCodeAt(0);return String.fromCharCode(192|cc&gt;&gt;6,128|cc&amp;63)});strUtf=strUtf.replace(/[\u0800-\uffff]/g,function(c){var cc=c.charCodeAt(0);return String.fromCharCode(224|cc&gt;&gt;12,128|cc&gt;&gt;6&amp;63,128|cc&amp;63)});return strUtf};Utf8.decode=function(strUtf){var strUni=strUtf.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(c){var cc=(c.charCodeAt(0)&amp;15)&lt;&lt;12|(c.charCodeAt(1)&amp;63)&lt;&lt;6|c.charCodeAt(2)&amp;63;return String.fromCharCode(cc)});strUni=strUni.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(c){var cc=(c.charCodeAt(0)&amp;31)&lt;&lt;6|c.charCodeAt(1)&amp;63;return String.fromCharCode(cc)});return strUni};!function($){&quot;use strict&quot;;var Tooltip=function(element,options){this.init(&quot;tooltip&quot;,element,options)};Tooltip.prototype={constructor:Tooltip,init:function(type,element,options){var eventIn,eventOut;this.type=type;this.$element=$(element);this.options=this.getOptions(options);this.enabled=true;if(this.options.trigger!=&quot;manual&quot;){eventIn=this.options.trigger==&quot;hover&quot;?&quot;mouseenter&quot;:&quot;focus&quot;;eventOut=this.options.trigger==&quot;hover&quot;?&quot;mouseleave&quot;:&quot;blur&quot;;this.$element.on(eventIn,this.options.selector,$.proxy(this.enter,this));this.$element.on(eventOut,this.options.selector,$.proxy(this.leave,this))}this.options.selector?this._options=$.extend({},this.options,{trigger:&quot;manual&quot;,selector:&quot;&quot;}):this.fixTitle()},getOptions:function(options){options=$.extend({},$.fn[this.type].defaults,options,this.$element.data());if(options.delay&amp;&amp;typeof options.delay==&quot;number&quot;){options.delay={show:options.delay,hide:options.delay}}return options},enter:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type);if(!self.options.delay||!self.options.delay.show){self.show()}else{self.hoverState=&quot;in&quot;;setTimeout(function(){if(self.hoverState==&quot;in&quot;){self.show()}},self.options.delay.show)}},leave:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type);if(!self.options.delay||!self.options.delay.hide){self.hide()}else{self.hoverState=&quot;out&quot;;setTimeout(function(){if(self.hoverState==&quot;out&quot;){self.hide()}},self.options.delay.hide)}},show:function(){var $tip,inside,pos,actualWidth,actualHeight,placement,tp;if(this.hasContent()&amp;&amp;this.enabled){$tip=this.tip();this.setContent();if(this.options.animation){$tip.addClass(&quot;fade&quot;)}placement=typeof this.options.placement==&quot;function&quot;?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement;inside=/in/.test(placement);$tip.remove().css({top:0,left:0,display:&quot;block&quot;}).appendTo(inside?this.$element:document.body);pos=this.getPosition(inside);actualWidth=$tip[0].offsetWidth;actualHeight=$tip[0].offsetHeight;switch(inside?placement.split(&quot; &quot;)[1]:placement){case&quot;bottom&quot;:tp={top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2};break;case&quot;top&quot;:tp={top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2};break;case&quot;left&quot;:tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth};break;case&quot;right&quot;:tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width};break}$tip.css(tp).addClass(placement).addClass(&quot;in&quot;)}},setContent:function(){var $tip=this.tip();$tip.find(&quot;.timeline-tooltip-inner&quot;).html(this.getTitle());$tip.removeClass(&quot;fade in top bottom left right&quot;)},hide:function(){var that=this,$tip=this.tip();$tip.removeClass(&quot;in&quot;);function removeWithAnimation(){var timeout=setTimeout(function(){$tip.off($.support.transition.end).remove()},500);$tip.one($.support.transition.end,function(){clearTimeout(timeout);$tip.remove()})}$.support.transition&amp;&amp;this.$tip.hasClass(&quot;fade&quot;)?removeWithAnimation():$tip.remove()},fixTitle:function(){var $e=this.$element;if($e.attr(&quot;title&quot;)||typeof $e.attr(&quot;data-original-title&quot;)!=&quot;string&quot;){$e.attr(&quot;data-original-title&quot;,$e.attr(&quot;title&quot;)||&quot;&quot;).removeAttr(&quot;title&quot;)}},hasContent:function(){return this.getTitle()},getPosition:function(inside){return $.extend({},inside?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var title,$e=this.$element,o=this.options;title=$e.attr(&quot;data-original-title&quot;)||(typeof o.title==&quot;function&quot;?o.title.call($e[0]):o.title);title=title.toString().replace(/(^\s*|\s*$)/,&quot;&quot;);return title},tip:function(){return this.$tip=this.$tip||$(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass(&quot;in&quot;)?&quot;hide&quot;:&quot;show&quot;]()}};$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data(&quot;tooltip&quot;),options=typeof option==&quot;object&quot;&amp;&amp;option;if(!data)$this.data(&quot;tooltip&quot;,data=new Tooltip(this,options));if(typeof option==&quot;string&quot;)data[option]()})};$.fn.tooltip.Constructor=Tooltip;$.fn.tooltip.defaults={animation:true,delay:0,selector:false,placement:&quot;top&quot;,trigger:&quot;hover&quot;,title:&quot;&quot;,template:''}}(window.jQuery);if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.StoryJS==&quot;undefined&quot;){VMM.StoryJS=function(){this.init=function(d){}}}if(typeof VMM!=&quot;undefined&quot;&amp;&amp;typeof VMM.Timeline==&quot;undefined&quot;){VMM.Timeline=function(_timeline_id,w,h){var $timeline,$container,$feature,$feedback,$slider,$navigation,slider,timenav,version=&quot;2.x&quot;,timeline_id=&quot;#timelinejs&quot;,events={},data={},_dates=[],config={},has_width=false,has_height=false,ie7=false,is_moving=false;if(type.of(_timeline_id)==&quot;string&quot;){if(_timeline_id.match(&quot;#&quot;)){timeline_id=_timeline_id}else{timeline_id=&quot;#&quot;+_timeline_id}}else{timeline_id=&quot;#timelinejs&quot;}config={embed:false,events:{data_ready:&quot;DATAREADY&quot;,messege:&quot;MESSEGE&quot;,headline:&quot;HEADLINE&quot;,slide_change:&quot;SLIDE_CHANGE&quot;,resize:&quot;resize&quot;},id:timeline_id,source:&quot;nothing&quot;,type:&quot;timeline&quot;,touch:false,orientation:&quot;normal&quot;,maptype:&quot;&quot;,version:&quot;2.x&quot;,preload:4,current_slide:0,hash_bookmark:false,start_at_end:false,start_at_slide:0,start_zoom_adjust:0,start_page:false,api_keys:{google:&quot;&quot;,flickr:&quot;&quot;,twitter:&quot;&quot;},interval:10,something:0,width:960,height:540,spacing:15,loaded:{slider:false,timenav:false,percentloaded:0},nav:{start_page:false,interval_width:200,density:4,minor_width:0,minor_left:0,constraint:{left:0,right:0,right_min:0,right_max:0},zoom:{adjust:0},multiplier:{current:6,min:.1,max:50},rows:[1,1,1],width:960,height:200,marker:{width:150,height:50}},feature:{width:960,height:540},slider:{width:720,height:400,content:{width:720,height:400,padding:130,padding_default:130},nav:{width:100,height:200}},ease:&quot;easeInOutExpo&quot;,duration:1e3,gmap_key:&quot;&quot;,language:VMM.Language};if(w!=null&amp;&amp;w!=&quot;&quot;){config.width=w;has_width=true}if(h!=null&amp;&amp;h!=&quot;&quot;){config.height=h;has_height=true}if(window.location.hash){var hash=window.location.hash.substring(1);if(!isNaN(hash)){config.current_slide=parseInt(hash)}}window.onhashchange=function(){var hash=window.location.hash.substring(1);if(config.hash_bookmark){if(is_moving){goToEvent(parseInt(hash))}else{is_moving=false}}else{goToEvent(parseInt(hash))}};function createConfig(conf){if(typeof embed_config==&quot;object&quot;){timeline_config=embed_config}if(typeof timeline_config==&quot;object&quot;){trace(&quot;HAS TIMELINE CONFIG&quot;);config=VMM.Util.mergeConfig(config,timeline_config)}else if(typeof conf==&quot;object&quot;){config=VMM.Util.mergeConfig(config,conf)}if(VMM.Browser.device==&quot;mobile&quot;||VMM.Browser.device==&quot;tablet&quot;){config.touch=true}config.nav.width=config.width;config.nav.height=200;config.feature.width=config.width;config.feature.height=config.height-config.nav.height;config.nav.zoom.adjust=parseInt(config.start_zoom_adjust,10);VMM.Timeline.Config=config;VMM.master_config.Timeline=VMM.Timeline.Config;this.events=config.events;if(config.gmap_key!=&quot;&quot;){config.api_keys.google=config.gmap_key}trace(&quot;VERSION &quot;+config.version);version=config.version}function createStructure(){$timeline=VMM.getElement(timeline_id);VMM.Lib.addClass($timeline,&quot;vco-timeline&quot;);VMM.Lib.addClass($timeline,&quot;vco-storyjs&quot;);$container=VMM.appendAndGetElement($timeline,&quot;<DIV>&quot;,&quot;vco-container vco-main&quot;);$feature=VMM.appendAndGetElement($container,&quot;<DIV>&quot;,&quot;vco-feature&quot;);$slider=VMM.appendAndGetElement($feature,&quot;<DIV>&quot;,&quot;vco-slider&quot;);
$navigation=VMM.appendAndGetElement($container,&quot;<DIV>&quot;,&quot;vco-navigation&quot;);$feedback=VMM.appendAndGetElement($timeline,&quot;<DIV>&quot;,&quot;vco-feedback&quot;,&quot;&quot;);if(typeof config.language.right_to_left!=&quot;undefined&quot;){VMM.Lib.addClass($timeline,&quot;vco-right-to-left&quot;)}slider=new VMM.Slider($slider,config);timenav=new VMM.Timeline.TimeNav($navigation);if(!has_width){config.width=VMM.Lib.width($timeline)}else{VMM.Lib.width($timeline,config.width)}if(!has_height){config.height=VMM.Lib.height($timeline)}else{VMM.Lib.height($timeline,config.height)}if(config.touch){VMM.Lib.addClass($timeline,&quot;vco-touch&quot;)}else{VMM.Lib.addClass($timeline,&quot;vco-notouch&quot;)}}function onDataReady(e,d){trace(&quot;onDataReady&quot;);data=d.timeline;if(type.of(data.era)!=&quot;array&quot;){data.era=[]}buildDates()}function onDatesProcessed(){build()}function reSize(){updateSize();slider.setSize(config.feature.width,config.feature.height);timenav.setSize(config.width,config.height);if(orientationChange()){setViewport()}}function onSliderLoaded(e){config.loaded.slider=true;onComponentLoaded()}function onComponentLoaded(e){config.loaded.percentloaded=config.loaded.percentloaded+25;if(config.loaded.slider&amp;&amp;config.loaded.timenav){hideMessege()}}function onTimeNavLoaded(e){config.loaded.timenav=true;onComponentLoaded()}function onSlideUpdate(e){is_moving=true;config.current_slide=slider.getCurrentNumber();setHash(config.current_slide);timenav.setMarker(config.current_slide,config.ease,config.duration)}function onMarkerUpdate(e){is_moving=true;config.current_slide=timenav.getCurrentNumber();setHash(config.current_slide);slider.setSlide(config.current_slide)}function goToEvent(n){if(n&lt;=_dates.length-1&amp;&amp;n&gt;=0){config.current_slide=n;slider.setSlide(config.current_slide);timenav.setMarker(config.current_slide,config.ease,config.duration)}}function setHash(n){if(config.hash_bookmark){window.location.hash=&quot;#&quot;+n.toString()}}function getViewport(){}function setViewport(){var viewport_content=&quot;&quot;,viewport_orientation=searchOrientation(window.orientation);if(VMM.Browser.device==&quot;mobile&quot;){if(viewport_orientation==&quot;portrait&quot;){viewport_content=&quot;width=device-width; initial-scale=0.5, maximum-scale=0.5&quot;}else if(viewport_orientation==&quot;landscape&quot;){viewport_content=&quot;width=device-width; initial-scale=0.5, maximum-scale=0.5&quot;}else{viewport_content=&quot;width=device-width, initial-scale=1, maximum-scale=1.0&quot;}}else if(VMM.Browser.device==&quot;tablet&quot;){}if(document.getElementById(&quot;viewport&quot;)){}else{}}function searchOrientation(orientation){var orient=&quot;&quot;;if(orientation==0||orientation==180){orient=&quot;portrait&quot;}else if(orientation==90||orientation==-90){orient=&quot;landscape&quot;}else{orient=&quot;normal&quot;}return orient}function orientationChange(){var orientation=searchOrientation(window.orientation);if(orientation==config.orientation){return false}else{config.orientation=orientation;return true}}this.init=function(c,_data){trace(&quot;INIT&quot;);setViewport();createConfig(c);createStructure();if(type.of(_data)==&quot;string&quot;){config.source=_data}VMM.Date.setLanguage(config.language);VMM.master_config.language=config.language;VMM.ExternalAPI.setKeys(config.api_keys);VMM.ExternalAPI.googlemaps.setMapType(config.maptype);VMM.bindEvent(global,onDataReady,config.events.data_ready);VMM.bindEvent(global,showMessege,config.events.messege);VMM.fireEvent(global,config.events.messege,config.language.messages.loading_timeline);if(VMM.Browser.browser==&quot;Explorer&quot;||VMM.Browser.browser==&quot;MSIE&quot;){if(parseInt(VMM.Browser.version,10)&lt;=7&amp;&amp;(VMM.Browser.tridentVersion==null||VMM.Browser.tridentVersion&lt;4)){ie7=true}}if(type.of(config.source)==&quot;string&quot;||type.of(config.source)==&quot;object&quot;){VMM.Timeline.DataObj.getData(config.source)}else{VMM.fireEvent(global,config.events.messege,&quot;No data source provided&quot;)}};this.iframeLoaded=function(){trace(&quot;iframeLoaded&quot;)};this.reload=function(_d){trace(&quot;Load new timeline data&quot;+_d);VMM.fireEvent(global,config.events.messege,config.language.messages.loading_timeline);data={};VMM.Timeline.DataObj.getData(_d);config.current_slide=0;slider.setSlide(0);timenav.setMarker(0,config.ease,config.duration)};function getData(url){VMM.getJSON(url,function(d){data=VMM.Timeline.DataObj.getData(d);VMM.fireEvent(global,config.events.data_ready)})}function showMessege(e,msg,other){trace(&quot;showMessege &quot;+msg);if(other){VMM.attachElement($feedback,msg)}else{VMM.attachElement($feedback,VMM.MediaElement.loadingmessage(msg))}}function hideMessege(){VMM.Lib.animate($feedback,config.duration,config.ease*4,{opacity:0},detachMessege)}function detachMessege(){VMM.Lib.detach($feedback)}function build(){if(parseInt(config.start_at_slide)&gt;0&amp;&amp;config.current_slide==0){config.current_slide=parseInt(config.start_at_slide)}if(config.start_at_end&amp;&amp;config.current_slide==0){config.current_slide=_dates.length-1}if(ie7){ie7=true;VMM.fireEvent(global,config.events.messege,&quot;Internet Explorer &quot;+VMM.Browser.version+&quot; is not supported by TimelineJS. Please update your browser to version 8 or higher. If you are using a recent version of Internet Explorer you may need to disable compatibility mode in your browser.&quot;)}else{detachMessege();reSize();VMM.bindEvent($slider,onSliderLoaded,&quot;LOADED&quot;);VMM.bindEvent($navigation,onTimeNavLoaded,&quot;LOADED&quot;);VMM.bindEvent($slider,onSlideUpdate,&quot;UPDATE&quot;);VMM.bindEvent($navigation,onMarkerUpdate,&quot;UPDATE&quot;);slider.init(_dates);timenav.init(_dates,data.era);VMM.bindEvent(global,reSize,config.events.resize)}}function updateSize(){trace(&quot;UPDATE SIZE&quot;);config.width=VMM.Lib.width($timeline);config.height=VMM.Lib.height($timeline);config.nav.width=config.width;config.feature.width=config.width;config.feature.height=config.height-config.nav.height-3;if(VMM.Browser.device==&quot;mobile&quot;){}if(config.width&lt;641){VMM.Lib.addClass($timeline,&quot;vco-skinny&quot;)}else{VMM.Lib.removeClass($timeline,&quot;vco-skinny&quot;)}}function buildDates(){_dates=[];VMM.fireEvent(global,config.events.messege,&quot;Building Dates&quot;);updateSize();for(var i=0;i&lt;data.date.length;i++){if(data.date[i].startDate!=null&amp;&amp;data.date[i].startDate!=&quot;&quot;){var _date={},do_start=VMM.Date.parse(data.date[i].startDate,true),do_end;_date.startdate=do_start.date;_date.precisiondate=do_start.precision;if(!isNaN(_date.startdate)){if(data.date[i].endDate!=null&amp;&amp;data.date[i].endDate!=&quot;&quot;){_date.enddate=VMM.Date.parse(data.date[i].endDate)}else{_date.enddate=_date.startdate}_date.needs_slug=false;if(data.date[i].headline==&quot;&quot;){if(data.date[i].slug!=null&amp;&amp;data.date[i].slug!=&quot;&quot;){_date.needs_slug=true}}_date.title=data.date[i].headline;_date.headline=data.date[i].headline;_date.type=data.date[i].type;_date.date=VMM.Date.prettyDate(_date.startdate,false,_date.precisiondate);_date.asset=data.date[i].asset;_date.fulldate=_date.startdate.getTime();_date.text=data.date[i].text;_date.content=&quot;&quot;;_date.tag=data.date[i].tag;_date.slug=data.date[i].slug;_date.uniqueid=VMM.Util.unique_ID(7);_date.classname=data.date[i].classname;_dates.push(_date)}}}if(data.type!=&quot;storify&quot;){_dates.sort(function(a,b){return a.fulldate-b.fulldate})}if(data.headline!=null&amp;&amp;data.headline!=&quot;&quot;&amp;&amp;data.text!=null&amp;&amp;data.text!=&quot;&quot;){var startpage_date,do_start,_date={},td_num=0,td;if(typeof data.startDate!=&quot;undefined&quot;){do_start=VMM.Date.parse(data.startDate,true);startpage_date=do_start.date}else{startpage_date=false}trace(&quot;HAS STARTPAGE&quot;);trace(startpage_date);if(startpage_date&amp;&amp;startpage_date&lt;_dates[0].startdate){_date.startdate=new Date(startpage_date)}else{td=_dates[0].startdate;_date.startdate=new Date(_dates[0].startdate);if(td.getMonth()===0&amp;&amp;td.getDate()==1&amp;&amp;td.getHours()===0&amp;&amp;td.getMinutes()===0){_date.startdate.setFullYear(td.getFullYear()-1)}else if(td.getDate()&lt;=1&amp;&amp;td.getHours()===0&amp;&amp;td.getMinutes()===0){_date.startdate.setMonth(td.getMonth()-1)}else if(td.getHours()===0&amp;&amp;td.getMinutes()===0){_date.startdate.setDate(td.getDate()-1)}else if(td.getMinutes()===0){_date.startdate.setHours(td.getHours()-1)}else{_date.startdate.setMinutes(td.getMinutes()-1)}}_date.uniqueid=VMM.Util.unique_ID(7);_date.enddate=_date.startdate;_date.precisiondate=do_start.precision;_date.title=data.headline;_date.headline=data.headline;_date.text=data.text;_date.type=&quot;start&quot;;_date.date=VMM.Date.prettyDate(data.startDate,false,_date.precisiondate);_date.asset=data.asset;_date.slug=false;_date.needs_slug=false;_date.fulldate=_date.startdate.getTime();if(config.embed){VMM.fireEvent(global,config.events.headline,_date.headline)}_dates.unshift(_date)}if(data.type!=&quot;storify&quot;){_dates.sort(function(a,b){return a.fulldate-b.fulldate})}onDatesProcessed()}};VMM.Timeline.Config={}}if(typeof VMM.Timeline!=&quot;undefined&quot;&amp;&amp;typeof VMM.Timeline.TimeNav==&quot;undefined&quot;){VMM.Timeline.TimeNav=function(parent,content_width,content_height){trace(&quot;VMM.Timeline.TimeNav&quot;);var $timenav,$content,$time,$timeintervalminor,$timeinterval,$timeintervalmajor,$timebackground,$timeintervalbackground,$timenavline,$timenavindicator,$timeintervalminor_minor,$toolbar,$zoomin,$zoomout,$dragslide,config=VMM.Timeline.Config,row_height,events={},timespan={},layout=parent,data=[],era_markers=[],markers=[],interval_array=[],interval_major_array=[],tags=[],current_marker=0,_active=false,eras,content,timeouts={interval_position:&quot;&quot;},timenav_pos={left:&quot;&quot;,visible:{left:&quot;&quot;,right:&quot;&quot;}},timelookup={day:24,month:12,year:10,hour:60,minute:60,second:1e3,decade:10,century:100,millenium:1e3,age:1e6,epoch:1e7,era:1e8,eon:5e8,week:4.34812141,days_in_month:30.4368499,days_in_week:7,weeks_in_month:4.34812141,weeks_in_year:52.177457,days_in_year:365.242199,hours_in_day:24},dateFractionBrowser={day:864e5,week:7,month:30.4166666667,year:12,hour:24,minute:1440,second:86400,decade:10,century:100,millenium:1e3,age:1e6,epoch:1e7,era:1e8,eon:5e8},interval={type:&quot;year&quot;,number:10,first:1970,last:2011,multiplier:100,classname:&quot;_idd&quot;,interval_type:&quot;interval&quot;},interval_major={type:&quot;year&quot;,number:10,first:1970,last:2011,multiplier:100,classname:&quot;major&quot;,interval_type:&quot;interval major&quot;},interval_macro={type:&quot;year&quot;,number:10,first:1970,last:2011,multiplier:100,classname:&quot;_dd_minor&quot;,interval_type:&quot;interval minor&quot;},interval_calc={day:{},month:{},year:{},hour:{},minute:{},second:{},decade:{},century:{},millenium:{},week:{},age:{},epoch:{},era:{},eon:{}};row_height=config.nav.marker.height/2;config.nav.rows={full:[1,row_height*2,row_height*4],half:[1,row_height,row_height*2,row_height*3,row_height*4,row_height*5],current:[]};if(content_width!=null&amp;&amp;content_width!=&quot;&quot;){config.nav.width=content_width}if(content_height!=null&amp;&amp;content_height!=&quot;&quot;){config.nav.height=content_height}this.init=function(d,e){trace(&quot;VMM.Timeline.TimeNav init&quot;);if(typeof d!=&quot;undefined&quot;){this.setData(d,e)}else{trace(&quot;WAITING ON DATA&quot;)}};this.setData=function(d,e){if(typeof d!=&quot;undefined&quot;){data={};data=d;eras=e;build()}else{trace(&quot;NO DATA&quot;)}};this.setSize=function(w,h){if(w!=null){config.width=w}if(h!=null){config.height=h}if(_active){reSize()}};this.setMarker=function(n,ease,duration,fast){goToMarker(n,ease,duration)};this.getCurrentNumber=function(){return current_marker};function onConfigSet(){trace(&quot;onConfigSet&quot;)}function reSize(firstrun){config.nav.constraint.left=config.width/2;config.nav.constraint.right=config.nav.constraint.right_min-config.width/2;$dragslide.updateConstraint(config.nav.constraint);VMM.Lib.css($timenavline,&quot;left&quot;,Math.round(config.width/2)+2);VMM.Lib.css($timenavindicator,&quot;left&quot;,Math.round(config.width/2)-8);goToMarker(config.current_slide,config.ease,config.duration,true,firstrun)}function upDate(){VMM.fireEvent(layout,&quot;UPDATE&quot;)}function onZoomIn(){$dragslide.cancelSlide();if(config.nav.multiplier.current&gt;config.nav.multiplier.min){if(config.nav.multiplier.current&lt;=1){config.nav.multiplier.current=config.nav.multiplier.current-.25}else{if(config.nav.multiplier.current&gt;5){if(config.nav.multiplier.current&gt;16){config.nav.multiplier.current=Math.round(config.nav.multiplier.current-10)}else{config.nav.multiplier.current=Math.round(config.nav.multiplier.current-4)}}else{config.nav.multiplier.current=Math.round(config.nav.multiplier.current-1)}}if(config.nav.multiplier.current&lt;=0){config.nav.multiplier.current=config.nav.multiplier.min}refreshTimeline()}}function onZoomOut(){$dragslide.cancelSlide();if(config.nav.multiplier.current&lt;config.nav.multiplier.max){if(config.nav.multiplier.current&gt;4){if(config.nav.multiplier.current&gt;16){config.nav.multiplier.current=Math.round(config.nav.multiplier.current+10)}else{config.nav.multiplier.current=Math.round(config.nav.multiplier.current+4)}}else{config.nav.multiplier.current=Math.round(config.nav.multiplier.current+1)}if(config.nav.multiplier.current&gt;=config.nav.multiplier.max){config.nav.multiplier.current=config.nav.multiplier.max}refreshTimeline()}}function onBackHome(e){$dragslide.cancelSlide();goToMarker(0);upDate()}function onMouseScroll(e){var delta=0,scroll_to=0;if(!e){e=window.event}if(e.originalEvent){e=e.originalEvent}if(typeof e.wheelDeltaX!=&quot;undefined&quot;){delta=e.wheelDeltaY/6;if(Math.abs(e.wheelDeltaX)&gt;Math.abs(e.wheelDeltaY)){delta=e.wheelDeltaX/6}else{delta=0}}if(delta){if(e.preventDefault){e.preventDefault()}e.returnValue=false}scroll_to=VMM.Lib.position($timenav).left+delta;if(scroll_to&gt;config.nav.constraint.left){scroll_to=config.width/2}else if(scroll_to&lt;config.nav.constraint.right){scroll_to=config.nav.constraint.right}VMM.Lib.css($timenav,&quot;left&quot;,scroll_to)}function refreshTimeline(){trace(&quot;config.nav.multiplier &quot;+config.nav.multiplier.current);positionMarkers(true);positionEras(true);positionInterval($timeinterval,interval_array,true,true);positionInterval($timeintervalmajor,interval_major_array,true);config.nav.constraint.left=config.width/2;config.nav.constraint.right=config.nav.constraint.right_min-config.width/2;$dragslide.updateConstraint(config.nav.constraint)}function onMarkerClick(e){$dragslide.cancelSlide();goToMarker(e.data.number);upDate()}function onMarkerHover(e){VMM.Lib.toggleClass(e.data.elem,&quot;zFront&quot;)}function goToMarker(n,ease,duration,fast,firstrun){trace(&quot;GO TO MARKER&quot;);var _ease=config.ease,_duration=config.duration,is_last=false,is_first=false;current_marker=n;timenav_pos.left=config.width/2-markers[current_marker].pos_left;timenav_pos.visible.left=Math.abs(timenav_pos.left)-100;timenav_pos.visible.right=Math.abs(timenav_pos.left)+config.width+100;if(current_marker==0){is_first=true}if(current_marker+1==markers.length){is_last=true}if(ease!=null&amp;&amp;ease!=&quot;&quot;){_ease=ease}if(duration!=null&amp;&amp;duration!=&quot;&quot;){_duration=duration}for(var i=0;i&lt;markers.length;i++){VMM.Lib.removeClass(markers[i].marker,&quot;active&quot;)}if(config.start_page&amp;&amp;markers[0].type==&quot;start&quot;){VMM.Lib.visible(markers[0].marker,false);VMM.Lib.addClass(markers[0].marker,&quot;start&quot;)}VMM.Lib.addClass(markers[current_marker].marker,&quot;active&quot;);VMM.Lib.stop($timenav);VMM.Lib.animate($timenav,_duration,_ease,{left:timenav_pos.left})}function onTouchUpdate(e,b){VMM.Lib.animate($timenav,b.time/2,config.ease,{left:b.left})}function averageMarkerPositionDistance(){var last_pos=0,pos=0,pos_dif=0,mp_diff=[],i=0;for(i=0;i&lt;markers.length;i++){if(data[i].type==&quot;start&quot;){}else{var _pos=positionOnTimeline(interval,markers[i].relative_pos),last_pos=pos;pos=_pos.begin;pos_dif=pos-last_pos;mp_diff.push(pos_dif)}}return VMM.Util.average(mp_diff).mean}function averageDateDistance(){var last_dd=0,dd=0,_dd=&quot;&quot;,date_dif=0,date_diffs=[],is_first_date=true,i=0;for(i=0;i&lt;data.length;i++){if(data[i].type==&quot;start&quot;){trace(&quot;DATA DATE IS START&quot;)}else{_dd=data[i].startdate;last_dd=dd;dd=_dd;date_dif=dd-last_dd;date_diffs.push(date_dif)}}return VMM.Util.average(date_diffs)}function calculateMultiplier(){var temp_multiplier=config.nav.multiplier.current,i=0;for(i=0;i&lt;temp_multiplier;i++){if(averageMarkerPositionDistance()&lt;75){if(config.nav.multiplier.current&gt;1){config.nav.multiplier.current=config.nav.multiplier.current-1}}}}function calculateInterval(){var _first=getDateFractions(data[0].startdate),_last=getDateFractions(data[data.length-1].enddate);interval_calc.eon.type=&quot;eon&quot;;interval_calc.eon.first=_first.eons;interval_calc.eon.base=Math.floor(_first.eons);interval_calc.eon.last=_last.eons;interval_calc.eon.number=timespan.eons;interval_calc.eon.multiplier=timelookup.eons;interval_calc.eon.minor=timelookup.eons;interval_calc.era.type=&quot;era&quot;;interval_calc.era.first=_first.eras;interval_calc.era.base=Math.floor(_first.eras);interval_calc.era.last=_last.eras;interval_calc.era.number=timespan.eras;interval_calc.era.multiplier=timelookup.eras;interval_calc.era.minor=timelookup.eras;interval_calc.epoch.type=&quot;epoch&quot;;interval_calc.epoch.first=_first.epochs;interval_calc.epoch.base=Math.floor(_first.epochs);interval_calc.epoch.last=_last.epochs;interval_calc.epoch.number=timespan.epochs;interval_calc.epoch.multiplier=timelookup.epochs;interval_calc.epoch.minor=timelookup.epochs;interval_calc.age.type=&quot;age&quot;;interval_calc.age.first=_first.ages;interval_calc.age.base=Math.floor(_first.ages);interval_calc.age.last=_last.ages;interval_calc.age.number=timespan.ages;interval_calc.age.multiplier=timelookup.ages;interval_calc.age.minor=timelookup.ages;interval_calc.millenium.type=&quot;millenium&quot;;interval_calc.millenium.first=_first.milleniums;interval_calc.millenium.base=Math.floor(_first.milleniums);interval_calc.millenium.last=_last.milleniums;interval_calc.millenium.number=timespan.milleniums;interval_calc.millenium.multiplier=timelookup.millenium;interval_calc.millenium.minor=timelookup.millenium;interval_calc.century.type=&quot;century&quot;;interval_calc.century.first=_first.centuries;interval_calc.century.base=Math.floor(_first.centuries);interval_calc.century.last=_last.centuries;interval_calc.century.number=timespan.centuries;interval_calc.century.multiplier=timelookup.century;interval_calc.century.minor=timelookup.century;interval_calc.decade.type=&quot;decade&quot;;interval_calc.decade.first=_first.decades;interval_calc.decade.base=Math.floor(_first.decades);interval_calc.decade.last=_last.decades;interval_calc.decade.number=timespan.decades;interval_calc.decade.multiplier=timelookup.decade;interval_calc.decade.minor=timelookup.decade;interval_calc.year.type=&quot;year&quot;;interval_calc.year.first=_first.years;interval_calc.year.base=Math.floor(_first.years);interval_calc.year.last=_last.years;interval_calc.year.number=timespan.years;interval_calc.year.multiplier=1;interval_calc.year.minor=timelookup.month;interval_calc.month.type=&quot;month&quot;;interval_calc.month.first=_first.months;interval_calc.month.base=Math.floor(_first.months);interval_calc.month.last=_last.months;interval_calc.month.number=timespan.months;interval_calc.month.multiplier=1;interval_calc.month.minor=Math.round(timelookup.week);interval_calc.week.type=&quot;week&quot;;interval_calc.week.first=_first.weeks;interval_calc.week.base=Math.floor(_first.weeks);interval_calc.week.last=_last.weeks;interval_calc.week.number=timespan.weeks;interval_calc.week.multiplier=1;interval_calc.week.minor=7;interval_calc.day.type=&quot;day&quot;;interval_calc.day.first=_first.days;interval_calc.day.base=Math.floor(_first.days);interval_calc.day.last=_last.days;interval_calc.day.number=timespan.days;interval_calc.day.multiplier=1;interval_calc.day.minor=24;interval_calc.hour.type=&quot;hour&quot;;interval_calc.hour.first=_first.hours;interval_calc.hour.base=Math.floor(_first.hours);interval_calc.hour.last=_last.hours;interval_calc.hour.number=timespan.hours;interval_calc.hour.multiplier=1;interval_calc.hour.minor=60;interval_calc.minute.type=&quot;minute&quot;;interval_calc.minute.first=_first.minutes;interval_calc.minute.base=Math.floor(_first.minutes);interval_calc.minute.last=_last.minutes;interval_calc.minute.number=timespan.minutes;interval_calc.minute.multiplier=1;interval_calc.minute.minor=60;interval_calc.second.type=&quot;decade&quot;;interval_calc.second.first=_first.seconds;interval_calc.second.base=Math.floor(_first.seconds);interval_calc.second.last=_last.seconds;interval_calc.second.number=timespan.seconds;interval_calc.second.multiplier=1;interval_calc.second.minor=10}function getDateFractions(the_date,is_utc){var _time={};_time.days=the_date/dateFractionBrowser.day;_time.weeks=_time.days/dateFractionBrowser.week;_time.months=_time.days/dateFractionBrowser.month;_time.years=_time.months/dateFractionBrowser.year;_time.hours=_time.days*dateFractionBrowser.hour;_time.minutes=_time.days*dateFractionBrowser.minute;_time.seconds=_time.days*dateFractionBrowser.second;_time.decades=_time.years/dateFractionBrowser.decade;_time.centuries=_time.years/dateFractionBrowser.century;_time.milleniums=_time.years/dateFractionBrowser.millenium;_time.ages=_time.years/dateFractionBrowser.age;_time.epochs=_time.years/dateFractionBrowser.epoch;_time.eras=_time.years/dateFractionBrowser.era;_time.eons=_time.years/dateFractionBrowser.eon;return _time}function positionRelative(_interval,first,last){var _first,_last,_type=_interval.type,timerelative={start:&quot;&quot;,end:&quot;&quot;,type:_type};_first=getDateFractions(first);timerelative.start=first.months;if(_type==&quot;eon&quot;){timerelative.start=_first.eons}else if(_type==&quot;era&quot;){timerelative.start=_first.eras}else if(_type==&quot;epoch&quot;){timerelative.start=_first.epochs}else if(_type==&quot;age&quot;){timerelative.start=_first.ages}else if(_type==&quot;millenium&quot;){timerelative.start=first.milleniums}else if(_type==&quot;century&quot;){timerelative.start=_first.centuries}else if(_type==&quot;decade&quot;){timerelative.start=_first.decades}else if(_type==&quot;year&quot;){timerelative.start=_first.years}else if(_type==&quot;month&quot;){timerelative.start=_first.months}else if(_type==&quot;week&quot;){timerelative.start=_first.weeks}else if(_type==&quot;day&quot;){timerelative.start=_first.days}else if(_type==&quot;hour&quot;){timerelative.start=_first.hours}else if(_type==&quot;minute&quot;){timerelative.start=_first.minutes}if(type.of(last)==&quot;date&quot;){_last=getDateFractions(last);timerelative.end=last.months;if(_type==&quot;eon&quot;){timerelative.end=_last.eons}else if(_type==&quot;era&quot;){timerelative.end=_last.eras}else if(_type==&quot;epoch&quot;){timerelative.end=_last.epochs}else if(_type==&quot;age&quot;){timerelative.end=_last.ages}else if(_type==&quot;millenium&quot;){timerelative.end=last.milleniums}else if(_type==&quot;century&quot;){timerelative.end=_last.centuries}else if(_type==&quot;decade&quot;){timerelative.end=_last.decades}else if(_type==&quot;year&quot;){timerelative.end=_last.years}else if(_type==&quot;month&quot;){timerelative.end=_last.months}else if(_type==&quot;week&quot;){timerelative.end=_last.weeks}else if(_type==&quot;day&quot;){timerelative.end=_last.days}else if(_type==&quot;hour&quot;){timerelative.end=_last.hours}else if(_type==&quot;minute&quot;){timerelative.end=_last.minutes}}else{timerelative.end=timerelative.start}return timerelative}function positionOnTimeline(the_interval,timerelative){return{begin:(timerelative.start-interval.base)*(config.nav.interval_width/config.nav.multiplier.current),end:(timerelative.end-interval.base)*(config.nav.interval_width/config.nav.multiplier.current)}}function positionMarkers(is_animated){var row=2,previous_pos=0,pos_offset=-2,row_depth=0,row_depth_sub=0,line_last_height_pos=150,line_height=6,cur_mark=0,in_view_margin=config.width,pos_cache_array=[],pos_cache_max=6,in_view={left:timenav_pos.visible.left-in_view_margin,right:timenav_pos.visible.right+in_view_margin},i=0,k=0;config.nav.minor_width=config.width;VMM.Lib.removeClass(&quot;.flag&quot;,&quot;row1&quot;);VMM.Lib.removeClass(&quot;.flag&quot;,&quot;row2&quot;);VMM.Lib.removeClass(&quot;.flag&quot;,&quot;row3&quot;);for(i=0;i&lt;markers.length;i++){var line,marker=markers[i],pos=positionOnTimeline(interval,markers[i].relative_pos),row_pos=0,is_in_view=false,pos_cache_obj={id:i,pos:0,row:0},pos_cache_close=0;pos.begin=Math.round(pos.begin+pos_offset);pos.end=Math.round(pos.end+pos_offset);line=Math.round(pos.end-pos.begin);marker.pos_left=pos.begin;if(current_marker==i){timenav_pos.left=config.width/2-pos;timenav_pos.visible.left=Math.abs(timenav_pos.left);timenav_pos.visible.right=Math.abs(timenav_pos.left)+config.width;in_view.left=timenav_pos.visible.left-in_view_margin;in_view.right=timenav_pos.visible.right+in_view_margin}if(Math.abs(pos.begin)&gt;=in_view.left&amp;&amp;Math.abs(pos.begin)&lt;=in_view.right){is_in_view=true}if(is_animated){VMM.Lib.stop(marker.marker);VMM.Lib.animate(marker.marker,config.duration/2,config.ease,{left:pos.begin})}else{VMM.Lib.stop(marker.marker);VMM.Lib.css(marker.marker,&quot;left&quot;,pos.begin)}if(i==current_marker){cur_mark=pos.begin}if(line&gt;5){VMM.Lib.css(marker.lineevent,&quot;height&quot;,line_height);VMM.Lib.css(marker.lineevent,&quot;top&quot;,line_last_height_pos);if(is_animated){VMM.Lib.animate(marker.lineevent,config.duration/2,config.ease,{width:line})}else{VMM.Lib.css(marker.lineevent,&quot;width&quot;,line)}}if(tags.length&gt;0){for(k=0;k&lt;tags.length;k++){if(k&lt;config.nav.rows.current.length){if(marker.tag==tags[k]){row=k;if(k==config.nav.rows.current.length-1){trace(&quot;ON LAST ROW&quot;);VMM.Lib.addClass(marker.flag,&quot;flag-small-last&quot;)}}}}row_pos=config.nav.rows.current[row]}else{if(pos.begin-previous_pos.begin&lt;config.nav.marker.width+config.spacing){if(row&lt;config.nav.rows.current.length-1){row++}else{row=0;row_depth++}}else{row_depth=1;row=1}row_pos=config.nav.rows.current[row]}previous_pos=pos;pos_cache_obj.pos=pos;pos_cache_obj.row=row;pos_cache_array.push(pos_cache_obj);if(pos_cache_array.length&gt;pos_cache_max){VMM.Util.removeRange(pos_cache_array,0)}if(is_animated){VMM.Lib.stop(marker.flag);VMM.Lib.animate(marker.flag,config.duration,config.ease,{top:row_pos})}else{VMM.Lib.stop(marker.flag);VMM.Lib.css(marker.flag,&quot;top&quot;,row_pos)}if(config.start_page&amp;&amp;markers[i].type==&quot;start&quot;){VMM.Lib.visible(marker.marker,false)}if(pos&gt;config.nav.minor_width){config.nav.minor_width=pos}if(pos&lt;config.nav.minor_left){config.nav.minor_left=pos}}if(is_animated){VMM.Lib.stop($timenav);VMM.Lib.animate($timenav,config.duration/2,config.ease,{left:config.width/2-cur_mark})}else{}}function positionEras(is_animated){var i=0,p=0;for(i=0;i&lt;era_markers.length;i++){var era=era_markers[i],pos=positionOnTimeline(interval,era.relative_pos),row_pos=0,row=0,era_height=config.nav.marker.height*config.nav.rows.full.length,era_length=pos.end-pos.begin;if(era.tag!=&quot;&quot;){era_height=config.nav.marker.height*config.nav.rows.full.length/config.nav.rows.current.length;for(p=0;p&lt;tags.length;p++){if(p&lt;config.nav.rows.current.length){if(era.tag==tags[p]){row=p}}}row_pos=config.nav.rows.current[row]}else{row_pos=-1}if(is_animated){VMM.Lib.stop(era.content);VMM.Lib.stop(era.text_content);VMM.Lib.animate(era.content,config.duration/2,config.ease,{top:row_pos,left:pos.begin,width:era_length,height:era_height});VMM.Lib.animate(era.text_content,config.duration/2,config.ease,{left:pos.begin})}else{VMM.Lib.stop(era.content);VMM.Lib.stop(era.text_content);VMM.Lib.css(era.content,&quot;left&quot;,pos.begin);VMM.Lib.css(era.content,&quot;width&quot;,era_length);VMM.Lib.css(era.content,&quot;height&quot;,era_height);VMM.Lib.css(era.content,&quot;top&quot;,row_pos);VMM.Lib.css(era.text_content,&quot;left&quot;,pos.begin)}}}function positionInterval(the_main_element,the_intervals,is_animated,is_minor){var last_position=0,last_position_major=0,in_view_margin=config.width,in_view={left:timenav_pos.visible.left-in_view_margin,right:timenav_pos.visible.right+in_view_margin};not_too_many=true,i=0;config.nav.minor_left=0;if(the_intervals.length&gt;100){not_too_many=false;trace(&quot;TOO MANY &quot;+the_intervals.length)}for(i=0;i&lt;the_intervals.length;i++){var _interval=the_intervals[i].element,_interval_date=the_intervals[i].date,_interval_visible=the_intervals[i].visible,_pos=positionOnTimeline(interval,the_intervals[i].relative_pos),pos=_pos.begin,_animation=the_intervals[i].animation,is_visible=true,is_in_view=false,pos_offset=50;_animation.pos=pos;_animation.animate=false;if(Math.abs(pos)&gt;=in_view.left&amp;&amp;Math.abs(pos)&lt;=in_view.right){is_in_view=true}if(true){if(config.nav.multiplier.current&gt;16&amp;&amp;is_minor){is_visible=false}else{if(pos-last_position&lt;65){if(pos-last_position&lt;35){if(i%4==0){if(pos==0){is_visible=false}}else{is_visible=false}}else{if(!VMM.Util.isEven(i)){is_visible=false}}}}if(is_visible){if(the_intervals[i].is_detached){VMM.Lib.append(the_main_element,_interval);the_intervals[i].is_detached=false}}else{the_intervals[i].is_detached=true;VMM.Lib.detach(_interval)}if(_interval_visible){if(!is_visible){_animation.opacity=&quot;0&quot;;if(is_animated&amp;&amp;not_too_many){_animation.animate=true}the_intervals[i].interval_visible=false}else{_animation.opacity=&quot;100&quot;;if(is_animated&amp;&amp;is_in_view){_animation.animate=true}}}else{_animation.opacity=&quot;100&quot;;if(is_visible){if(is_animated&amp;&amp;not_too_many){_animation.animate=true}else{if(is_animated&amp;&amp;is_in_view){_animation.animate=true}}the_intervals[i].interval_visible=true}else{if(is_animated&amp;&amp;not_too_many){_animation.animate=true}}}last_position=pos;if(pos&gt;config.nav.minor_width){config.nav.minor_width=pos}if(pos&lt;config.nav.minor_left){config.nav.minor_left=pos}}if(_animation.animate){VMM.Lib.animate(_interval,config.duration/2,config.ease,{opacity:_animation.opacity,left:_animation.pos})}else{VMM.Lib.css(_interval,&quot;opacity&quot;,_animation.opacity);VMM.Lib.css(_interval,&quot;left&quot;,pos)}}config.nav.constraint.right_min=-config.nav.minor_width+config.width;config.nav.constraint.right=config.nav.constraint.right_min+config.width/2;VMM.Lib.css($timeintervalminor_minor,&quot;left&quot;,config.nav.minor_left-config.width/2);VMM.Lib.width($timeintervalminor_minor,config.nav.minor_width+config.width+Math.abs(config.nav.minor_left))}function createIntervalElements(_interval,_array,_element_parent){var inc_time=0,_first_run=true,_last_pos=0,_largest_pos=0,_timezone_offset,_first_date,_last_date,int_number=Math.ceil(_interval.number)+2,firefox={flag:false,offset:0},i=0;VMM.attachElement(_element_parent,&quot;&quot;);_interval.date=new Date(data[0].startdate.getFullYear(),0,1,0,0,0);_timezone_offset=_interval.date.getTimezoneOffset();for(i=0;i&lt;int_number;i++){trace(_interval.type);var _is_year=false,int_obj={element:VMM.appendAndGetElement(_element_parent,&quot;<DIV>&quot;,_interval.classname),date:new Date(data[0].startdate.getFullYear(),0,1,0,0,0),visible:false,date_string:&quot;&quot;,type:_interval.interval_type,relative_pos:0,is_detached:false,animation:{animate:false,pos:&quot;&quot;,opacity:&quot;100&quot;}};if(_interval.type==&quot;eon&quot;){if(_first_run){_first_date=Math.floor(data[0].startdate.getFullYear()/5e8)*5e8}int_obj.date.setFullYear(_first_date+inc_time*5e8);_is_year=true}else if(_interval.type==&quot;era&quot;){if(_first_run){_first_date=Math.floor(data[0].startdate.getFullYear()/1e8)*1e8}int_obj.date.setFullYear(_first_date+inc_time*1e8);_is_year=true}else if(_interval.type==&quot;epoch&quot;){if(_first_run){_first_date=Math.floor(data[0].startdate.getFullYear()/1e7)*1e7}int_obj.date.setFullYear(_first_date+inc_time*1e7);_is_year=true}else if(_interval.type==&quot;age&quot;){if(_first_run){_first_date=Math.floor(data[0].startdate.getFullYear()/1e6)*1e6}int_obj.date.setFullYear(_first_date+inc_time*1e6);_is_year=true}else if(_interval.type==&quot;millenium&quot;){if(_first_run){_first_date=Math.floor(data[0].startdate.getFullYear()/1e3)*1e3}int_obj.date.setFullYear(_first_date+inc_time*1e3);_is_year=true}else if(_interval.type==&quot;century&quot;){if(_first_run){_first_date=Math.floor(data[0].startdate.getFullYear()/100)*100}int_obj.date.setFullYear(_first_date+inc_time*100);_is_year=true}else if(_interval.type==&quot;decade&quot;){if(_first_run){_first_date=Math.floor(data[0].startdate.getFullYear()/10)*10}int_obj.date.setFullYear(_first_date+inc_time*10);_is_year=true}else if(_interval.type==&quot;year&quot;){if(_first_run){_first_date=data[0].startdate.getFullYear()}int_obj.date.setFullYear(_first_date+inc_time);_is_year=true}else if(_interval.type==&quot;month&quot;){if(_first_run){_first_date=data[0].startdate.getMonth()}int_obj.date.setMonth(_first_date+inc_time)}else if(_interval.type==&quot;week&quot;){if(_first_run){_first_date=data[0].startdate.getMonth()}int_obj.date.setMonth(data[0].startdate.getMonth());int_obj.date.setDate(_first_date+inc_time*7)}else if(_interval.type==&quot;day&quot;){if(_first_run){_first_date=data[0].startdate.getDate()}int_obj.date.setMonth(data[0].startdate.getMonth());int_obj.date.setDate(_first_date+inc_time)}else if(_interval.type==&quot;hour&quot;){if(_first_run){_first_date=data[0].startdate.getHours()}int_obj.date.setMonth(data[0].startdate.getMonth());int_obj.date.setDate(data[0].startdate.getDate());int_obj.date.setHours(_first_date+inc_time)}else if(_interval.type==&quot;minute&quot;){if(_first_run){_first_date=data[0].startdate.getMinutes()}int_obj.date.setMonth(data[0].startdate.getMonth());int_obj.date.setDate(data[0].startdate.getDate());int_obj.date.setHours(data[0].startdate.getHours());int_obj.date.setMinutes(_first_date+inc_time)
}else if(_interval.type==&quot;second&quot;){if(_first_run){_first_date=data[0].startdate.getSeconds()}int_obj.date.setMonth(data[0].startdate.getMonth());int_obj.date.setDate(data[0].startdate.getDate());int_obj.date.setHours(data[0].startdate.getHours());int_obj.date.setMinutes(data[0].startdate.getMinutes());int_obj.date.setSeconds(_first_date+inc_time)}else if(_interval.type==&quot;millisecond&quot;){if(_first_run){_first_date=data[0].startdate.getMilliseconds()}int_obj.date.setMonth(data[0].startdate.getMonth());int_obj.date.setDate(data[0].startdate.getDate());int_obj.date.setHours(data[0].startdate.getHours());int_obj.date.setMinutes(data[0].startdate.getMinutes());int_obj.date.setSeconds(data[0].startdate.getSeconds());int_obj.date.setMilliseconds(_first_date+inc_time)}if(VMM.Browser.browser==&quot;Firefox&quot;){if(int_obj.date.getFullYear()==&quot;1970&quot;&amp;&amp;int_obj.date.getTimezoneOffset()!=_timezone_offset){trace(&quot;FIREFOX 1970 TIMEZONE OFFSET &quot;+int_obj.date.getTimezoneOffset()+&quot; SHOULD BE &quot;+_timezone_offset);trace(_interval.type+&quot; &quot;+_interval.date);firefox.offset=int_obj.date.getTimezoneOffset()/60;firefox.flag=true;int_obj.date.setHours(int_obj.date.getHours()+firefox.offset)}else if(firefox.flag){firefox.flag=false;int_obj.date.setHours(int_obj.date.getHours()+firefox.offset);if(_is_year){firefox.flag=true}}}if(_is_year){if(int_obj.date.getFullYear()&lt;0){int_obj.date_string=Math.abs(int_obj.date.getFullYear()).toString()+&quot; B.C.&quot;}else{int_obj.date_string=int_obj.date.getFullYear()}}else{int_obj.date_string=VMM.Date.prettyDate(int_obj.date,true)}inc_time=inc_time+1;_first_run=false;int_obj.relative_pos=positionRelative(interval,int_obj.date);_last_pos=int_obj.relative_pos.begin;if(int_obj.relative_pos.begin&gt;_largest_pos){_largest_pos=int_obj.relative_pos.begin}VMM.appendElement(int_obj.element,int_obj.date_string);VMM.Lib.css(int_obj.element,&quot;text-indent&quot;,-(VMM.Lib.width(int_obj.element)/2));VMM.Lib.css(int_obj.element,&quot;opacity&quot;,&quot;0&quot;);_array.push(int_obj)}VMM.Lib.width($timeintervalminor_minor,_largest_pos);positionInterval(_element_parent,_array)}function build(){var i=0,j=0;VMM.attachElement(layout,&quot;&quot;);$timenav=VMM.appendAndGetElement(layout,&quot;<DIV>&quot;,&quot;timenav&quot;);$content=VMM.appendAndGetElement($timenav,&quot;<DIV>&quot;,&quot;content&quot;);$time=VMM.appendAndGetElement($timenav,&quot;<DIV>&quot;,&quot;time&quot;);$timeintervalminor=VMM.appendAndGetElement($time,&quot;<DIV>&quot;,&quot;time-interval-minor&quot;);$timeintervalminor_minor=VMM.appendAndGetElement($timeintervalminor,&quot;<DIV>&quot;,&quot;minor&quot;);$timeintervalmajor=VMM.appendAndGetElement($time,&quot;<DIV>&quot;,&quot;time-interval-major&quot;);$timeinterval=VMM.appendAndGetElement($time,&quot;<DIV>&quot;,&quot;time-interval&quot;);$timebackground=VMM.appendAndGetElement(layout,&quot;<DIV>&quot;,&quot;timenav-background&quot;);$timenavline=VMM.appendAndGetElement($timebackground,&quot;<DIV>&quot;,&quot;timenav-line&quot;);$timenavindicator=VMM.appendAndGetElement($timebackground,&quot;<DIV>&quot;,&quot;timenav-indicator&quot;);$timeintervalbackground=VMM.appendAndGetElement($timebackground,&quot;<DIV>&quot;,&quot;timenav-interval-background&quot;,&quot;&quot;);$toolbar=VMM.appendAndGetElement(layout,&quot;<DIV>&quot;,&quot;vco-toolbar&quot;);buildInterval();buildMarkers();buildEras();calculateMultiplier();positionMarkers(false);positionEras();positionInterval($timeinterval,interval_array,false,true);positionInterval($timeintervalmajor,interval_major_array);if(config.start_page){$backhome=VMM.appendAndGetElement($toolbar,&quot;<DIV>&quot;,&quot;back-home&quot;,&quot;&quot;);VMM.bindEvent(&quot;.back-home&quot;,onBackHome,&quot;click&quot;);VMM.Lib.attribute($backhome,&quot;title&quot;,VMM.master_config.language.messages.return_to_title);VMM.Lib.attribute($backhome,&quot;rel&quot;,&quot;timeline-tooltip&quot;)}$dragslide=new VMM.DragSlider;$dragslide.createPanel(layout,$timenav,config.nav.constraint,config.touch);if(config.touch&amp;&amp;config.start_page){VMM.Lib.addClass($toolbar,&quot;touch&quot;);VMM.Lib.css($toolbar,&quot;top&quot;,55);VMM.Lib.css($toolbar,&quot;left&quot;,10)}else{if(config.start_page){VMM.Lib.css($toolbar,&quot;top&quot;,27)}$zoomin=VMM.appendAndGetElement($toolbar,&quot;<DIV>&quot;,&quot;zoom-in&quot;,&quot;&quot;);$zoomout=VMM.appendAndGetElement($toolbar,&quot;<DIV>&quot;,&quot;zoom-out&quot;,&quot;&quot;);VMM.bindEvent($zoomin,onZoomIn,&quot;click&quot;);VMM.bindEvent($zoomout,onZoomOut,&quot;click&quot;);VMM.Lib.attribute($zoomin,&quot;title&quot;,VMM.master_config.language.messages.expand_timeline);VMM.Lib.attribute($zoomin,&quot;rel&quot;,&quot;timeline-tooltip&quot;);VMM.Lib.attribute($zoomout,&quot;title&quot;,VMM.master_config.language.messages.contract_timeline);VMM.Lib.attribute($zoomout,&quot;rel&quot;,&quot;timeline-tooltip&quot;);$toolbar.tooltip({selector:&quot;div[rel=timeline-tooltip]&quot;,placement:&quot;right&quot;});VMM.bindEvent(layout,onMouseScroll,&quot;DOMMouseScroll&quot;);VMM.bindEvent(layout,onMouseScroll,&quot;mousewheel&quot;)}if(config.nav.zoom.adjust!=0){if(config.nav.zoom.adjust&lt;0){for(i=0;i&lt;Math.abs(config.nav.zoom.adjust);i++){onZoomOut()}}else{for(j=0;j&lt;config.nav.zoom.adjust;j++){onZoomIn()}}}_active=true;reSize(true);VMM.fireEvent(layout,&quot;LOADED&quot;)}function buildInterval(){var i=0,j=0;timespan=getDateFractions(data[data.length-1].enddate-data[0].startdate,true);trace(timespan);calculateInterval();if(timespan.centuries&gt;data.length/config.nav.density){interval=interval_calc.century;interval_major=interval_calc.millenium;interval_macro=interval_calc.decade}else if(timespan.decades&gt;data.length/config.nav.density){interval=interval_calc.decade;interval_major=interval_calc.century;interval_macro=interval_calc.year}else if(timespan.years&gt;data.length/config.nav.density){interval=interval_calc.year;interval_major=interval_calc.decade;interval_macro=interval_calc.month}else if(timespan.months&gt;data.length/config.nav.density){interval=interval_calc.month;interval_major=interval_calc.year;interval_macro=interval_calc.day}else if(timespan.days&gt;data.length/config.nav.density){interval=interval_calc.day;interval_major=interval_calc.month;interval_macro=interval_calc.hour}else if(timespan.hours&gt;data.length/config.nav.density){interval=interval_calc.hour;interval_major=interval_calc.day;interval_macro=interval_calc.minute}else if(timespan.minutes&gt;data.length/config.nav.density){interval=interval_calc.minute;interval_major=interval_calc.hour;interval_macro=interval_calc.second}else if(timespan.seconds&gt;data.length/config.nav.density){interval=interval_calc.second;interval_major=interval_calc.minute;interval_macro=interval_calc.second}else{trace(&quot;NO IDEA WHAT THE TYPE SHOULD BE&quot;);interval=interval_calc.day;interval_major=interval_calc.month;interval_macro=interval_calc.hour}trace(&quot;INTERVAL TYPE: &quot;+interval.type);trace(&quot;INTERVAL MAJOR TYPE: &quot;+interval_major.type);createIntervalElements(interval,interval_array,$timeinterval);createIntervalElements(interval_major,interval_major_array,$timeintervalmajor);for(i=0;i&lt;interval_array.length;i++){for(j=0;j&lt;interval_major_array.length;j++){if(interval_array[i].date_string==interval_major_array[j].date_string){VMM.attachElement(interval_array[i].element,&quot;&quot;)}}}}function buildMarkers(){var row=2,lpos=0,row_depth=0,i=0,k=0,l=0;markers=[];era_markers=[];for(i=0;i&lt;data.length;i++){var _marker,_marker_flag,_marker_content,_marker_dot,_marker_line,_marker_line_event,_marker_obj,_marker_title=&quot;&quot;,has_title=false;_marker=VMM.appendAndGetElement($content,&quot;<DIV>&quot;,&quot;marker&quot;);_marker_flag=VMM.appendAndGetElement(_marker,&quot;<DIV>&quot;,&quot;flag&quot;);_marker_content=VMM.appendAndGetElement(_marker_flag,&quot;<DIV>&quot;,&quot;flag-content&quot;);_marker_dot=VMM.appendAndGetElement(_marker,&quot;<DIV>&quot;,&quot;dot&quot;);_marker_line=VMM.appendAndGetElement(_marker,&quot;<DIV>&quot;,&quot;line&quot;);_marker_line_event=VMM.appendAndGetElement(_marker_line,&quot;<DIV>&quot;,&quot;event-line&quot;);_marker_relative_pos=positionRelative(interval,data[i].startdate,data[i].enddate);_marker_thumb=&quot;&quot;;if(data[i].asset!=null&amp;&amp;data[i].asset!=&quot;&quot;){VMM.appendElement(_marker_content,VMM.MediaElement.thumbnail(data[i].asset,24,24,data[i].uniqueid))}else{VMM.appendElement(_marker_content,&quot;&quot;)}if(data[i].title==&quot;&quot;||data[i].title==&quot; &quot;){trace(&quot;TITLE NOTHING&quot;);if(typeof data[i].slug!=&quot;undefined&quot;&amp;&amp;data[i].slug!=&quot;&quot;){trace(&quot;SLUG&quot;);_marker_title=VMM.Util.untagify(data[i].slug);has_title=true}else{var m=VMM.MediaType(data[i].asset.media);if(m.type==&quot;quote&quot;||m.type==&quot;unknown&quot;){_marker_title=VMM.Util.untagify(m.id);has_title=true}else{has_title=false}}}else if(data[i].title!=&quot;&quot;||data[i].title!=&quot; &quot;){trace(data[i].title);_marker_title=VMM.Util.untagify(data[i].title);has_title=true}else{trace(&quot;TITLE SLUG NOT FOUND &quot;+data[i].slug)}if(has_title){VMM.appendElement(_marker_content,&quot;<H3><SPAN class="mw-headline" id=".22.2B_marker_title.2B.22">&quot;+_marker_title+&quot;</SPAN></H3>&quot;)}else{VMM.appendElement(_marker_content,&quot;<H3><SPAN class="mw-headline" id=".22.2B_marker_title.2B.22_2">&quot;+_marker_title+&quot;</SPAN></H3>&quot;);VMM.appendElement(_marker_content,&quot;<H3 id="marker_content_.22.2Bdata.5Bi.5D.uniqueid.2B.22"><SPAN class="mw-headline" id=".22.2B_marker_title.2B.22_3">&quot;+_marker_title+&quot;</SPAN></H3>&quot;)}VMM.Lib.attr(_marker,&quot;id&quot;,(&quot;marker_&quot;+data[i].uniqueid).toString());VMM.bindEvent(_marker_flag,onMarkerClick,&quot;&quot;,{number:i});VMM.bindEvent(_marker_flag,onMarkerHover,&quot;mouseenter mouseleave&quot;,{number:i,elem:_marker_flag});_marker_obj={marker:_marker,flag:_marker_flag,lineevent:_marker_line_event,type:&quot;marker&quot;,full:true,relative_pos:_marker_relative_pos,tag:data[i].tag,pos_left:0};if(data[i].type==&quot;start&quot;){trace(&quot;BUILD MARKER HAS START PAGE&quot;);config.start_page=true;_marker_obj.type=&quot;start&quot;}if(data[i].type==&quot;storify&quot;){_marker_obj.type=&quot;storify&quot;}if(data[i].tag){tags.push(data[i].tag)}markers.push(_marker_obj)}tags=VMM.Util.deDupeArray(tags);if(tags.length&gt;3){config.nav.rows.current=config.nav.rows.half}else{config.nav.rows.current=config.nav.rows.full}for(k=0;k&lt;tags.length;k++){if(k&lt;config.nav.rows.current.length){var tag_element=VMM.appendAndGetElement($timebackground,&quot;<DIV>&quot;,&quot;timenav-tag&quot;);VMM.Lib.addClass(tag_element,&quot;timenav-tag-row-&quot;+(k+1));if(tags.length&gt;3){VMM.Lib.addClass(tag_element,&quot;timenav-tag-size-half&quot;)}else{VMM.Lib.addClass(tag_element,&quot;timenav-tag-size-full&quot;)}VMM.appendElement(tag_element,&quot;<DIV><H3><SPAN class="mw-headline" id=".22.2Btags.5Bk.5D.2B.22">&quot;+tags[k]+&quot;</SPAN></H3></DIV>&quot;)}}if(tags.length&gt;3){for(l=0;l&lt;markers.length;l++){VMM.Lib.addClass(markers[l].flag,&quot;flag-small&quot;);markers[l].full=false}}}function buildEras(){var number_of_colors=6,current_color=0,j=0;for(j=0;j&lt;eras.length;j++){var era={content:VMM.appendAndGetElement($content,&quot;<DIV>&quot;,&quot;era&quot;),text_content:VMM.appendAndGetElement($timeinterval,&quot;<DIV>&quot;,&quot;era&quot;),startdate:VMM.Date.parse(eras[j].startDate),enddate:VMM.Date.parse(eras[j].endDate),title:eras[j].headline,uniqueid:VMM.Util.unique_ID(6),tag:&quot;&quot;,relative_pos:&quot;&quot;},st=VMM.Date.prettyDate(era.startdate),en=VMM.Date.prettyDate(era.enddate),era_text=&quot;<DIV>Â </DIV>&quot;;if(typeof eras[j].tag!=&quot;undefined&quot;){era.tag=eras[j].tag}era.relative_pos=positionRelative(interval,era.startdate,era.enddate);VMM.Lib.attr(era.content,&quot;id&quot;,era.uniqueid);VMM.Lib.attr(era.text_content,&quot;id&quot;,era.uniqueid+&quot;_text&quot;);VMM.Lib.addClass(era.content,&quot;era&quot;+(current_color+1));VMM.Lib.addClass(era.text_content,&quot;era&quot;+(current_color+1));if(current_color&lt;number_of_colors){current_color++}else{current_color=0}VMM.appendElement(era.content,era_text);VMM.appendElement(era.text_content,VMM.Util.unlinkify(era.title));era_markers.push(era)}}}}if(typeof VMM.Timeline!==&quot;undefined&quot;&amp;&amp;typeof VMM.Timeline.DataObj==&quot;undefined&quot;){VMM.Timeline.DataObj={data_obj:{},model_array:[],getData:function(raw_data){VMM.Timeline.DataObj.data_obj={};VMM.fireEvent(global,VMM.Timeline.Config.events.messege,VMM.Timeline.Config.language.messages.loading_timeline);if(type.of(raw_data)==&quot;object&quot;){trace(&quot;DATA SOURCE: JSON OBJECT&quot;);VMM.Timeline.DataObj.parseJSON(raw_data)}else if(type.of(raw_data)==&quot;string&quot;){if(raw_data.match(&quot;%23&quot;)){trace(&quot;DATA SOURCE: TWITTER SEARCH&quot;);VMM.Timeline.DataObj.model.tweets.getData(&quot;%23medill&quot;)}else if(raw_data.match(&quot;spreadsheet&quot;)){trace(&quot;DATA SOURCE: GOOGLE SPREADSHEET&quot;);VMM.Timeline.DataObj.model.googlespreadsheet.getData(raw_data)}else if(raw_data.match(&quot;storify.com&quot;)){trace(&quot;DATA SOURCE: STORIFY&quot;);VMM.Timeline.DataObj.model.storify.getData(raw_data)}else if(raw_data.match(&quot;.jsonp&quot;)){trace(&quot;DATA SOURCE: JSONP&quot;);LoadLib.js(raw_data,VMM.Timeline.DataObj.onJSONPLoaded)}else{trace(&quot;DATA SOURCE: JSON&quot;);var req=&quot;&quot;;if(raw_data.indexOf(&quot;?&quot;)&gt;-1){req=raw_data+&quot;&amp;callback=onJSONP_Data&quot;}else{req=raw_data+&quot;?callback=onJSONP_Data&quot;}VMM.getJSON(req,VMM.Timeline.DataObj.parseJSON)}}else if(type.of(raw_data)==&quot;html&quot;){trace(&quot;DATA SOURCE: HTML&quot;);VMM.Timeline.DataObj.parseHTML(raw_data)}else{trace(&quot;DATA SOURCE: UNKNOWN&quot;)}},onJSONPLoaded:function(){trace(&quot;JSONP IS LOADED&quot;);VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,storyjs_jsonp_data)},parseHTML:function(d){trace(&quot;parseHTML&quot;);trace(&quot;WARNING: THIS IS STILL ALPHA AND WILL NOT WORK WITH ID's other than #timeline&quot;);var _data_obj=VMM.Timeline.DataObj.data_template_obj;if(VMM.Lib.find(&quot;#timeline section&quot;,&quot;time&quot;)[0]){_data_obj.timeline.startDate=VMM.Lib.html(VMM.Lib.find(&quot;#timeline section&quot;,&quot;time&quot;)[0]);_data_obj.timeline.headline=VMM.Lib.html(VMM.Lib.find(&quot;#timeline section&quot;,&quot;h2&quot;));_data_obj.timeline.text=VMM.Lib.html(VMM.Lib.find(&quot;#timeline section&quot;,&quot;article&quot;));var found_main_media=false;if(VMM.Lib.find(&quot;#timeline section&quot;,&quot;figure img&quot;).length!=0){found_main_media=true;_data_obj.timeline.asset.media=VMM.Lib.attr(VMM.Lib.find(&quot;#timeline section&quot;,&quot;figure img&quot;),&quot;src&quot;)}else if(VMM.Lib.find(&quot;#timeline section&quot;,&quot;figure a&quot;).length!=0){found_main_media=true;_data_obj.timeline.asset.media=VMM.Lib.attr(VMM.Lib.find(&quot;#timeline section&quot;,&quot;figure a&quot;),&quot;href&quot;)}else{}if(found_main_media){if(VMM.Lib.find(&quot;#timeline section&quot;,&quot;cite&quot;).length!=0){_data_obj.timeline.asset.credit=VMM.Lib.html(VMM.Lib.find(&quot;#timeline section&quot;,&quot;cite&quot;))}if(VMM.Lib.find(this,&quot;figcaption&quot;).length!=0){_data_obj.timeline.asset.caption=VMM.Lib.html(VMM.Lib.find(&quot;#timeline section&quot;,&quot;figcaption&quot;))}}}VMM.Lib.each(&quot;#timeline li&quot;,function(i,elem){var valid_date=false;var _date={type:&quot;default&quot;,startDate:&quot;&quot;,headline:&quot;&quot;,text:&quot;&quot;,asset:{media:&quot;&quot;,credit:&quot;&quot;,caption:&quot;&quot;},tags:&quot;Optional&quot;};if(VMM.Lib.find(this,&quot;time&quot;)!=0){valid_date=true;_date.startDate=VMM.Lib.html(VMM.Lib.find(this,&quot;time&quot;)[0]);if(VMM.Lib.find(this,&quot;time&quot;)[1]){_date.endDate=VMM.Lib.html(VMM.Lib.find(this,&quot;time&quot;)[1])}_date.headline=VMM.Lib.html(VMM.Lib.find(this,&quot;h3&quot;));_date.text=VMM.Lib.html(VMM.Lib.find(this,&quot;article&quot;));var found_media=false;if(VMM.Lib.find(this,&quot;figure img&quot;).length!=0){found_media=true;_date.asset.media=VMM.Lib.attr(VMM.Lib.find(this,&quot;figure img&quot;),&quot;src&quot;)}else if(VMM.Lib.find(this,&quot;figure a&quot;).length!=0){found_media=true;_date.asset.media=VMM.Lib.attr(VMM.Lib.find(this,&quot;figure a&quot;),&quot;href&quot;)}else{}if(found_media){if(VMM.Lib.find(this,&quot;cite&quot;).length!=0){_date.asset.credit=VMM.Lib.html(VMM.Lib.find(this,&quot;cite&quot;))}if(VMM.Lib.find(this,&quot;figcaption&quot;).length!=0){_date.asset.caption=VMM.Lib.html(VMM.Lib.find(this,&quot;figcaption&quot;))}}trace(_date);_data_obj.timeline.date.push(_date)}});VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,_data_obj)},parseJSON:function(d){trace(&quot;parseJSON&quot;);if(d.timeline.type==&quot;default&quot;){trace(&quot;DATA SOURCE: JSON STANDARD TIMELINE&quot;);VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,d)}else if(d.timeline.type==&quot;twitter&quot;){trace(&quot;DATA SOURCE: JSON TWEETS&quot;);VMM.Timeline.DataObj.model_Tweets.buildData(d)}else{trace(&quot;DATA SOURCE: UNKNOWN JSON&quot;);trace(type.of(d.timeline))}},model:{googlespreadsheet:{extractSpreadsheetKey:function(url){var key=VMM.Util.getUrlVars(url)[&quot;key&quot;];if(!key){if(url.match(&quot;docs.google.com/spreadsheets/d/&quot;)){var pos=url.indexOf(&quot;docs.google.com/spreadsheets/d/&quot;)+&quot;docs.google.com/spreadsheets/d/&quot;.length;var tail=url.substr(pos);key=tail.split(&quot;/&quot;)[0]}}if(!key){key=url}return key},getData:function(raw){var getjsondata,key,worksheet,url,timeout,tries=0;key=VMM.Timeline.DataObj.model.googlespreadsheet.extractSpreadsheetKey(raw);worksheet=VMM.Util.getUrlVars(raw)[&quot;worksheet&quot;];if(typeof worksheet==&quot;undefined&quot;)worksheet=&quot;od6&quot;;url=&quot;<A href="https://spreadsheets.google.com/feeds/list/" class="external free" rel="nofollow">https://spreadsheets.google.com/feeds/list/</A>&quot;+key+&quot;/&quot;+worksheet+&quot;/public/values?alt=json&quot;;timeout=setTimeout(function(){trace(&quot;Google Docs timeout &quot;+url);trace(url);if(tries&lt;3){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Still waiting on Google Docs, trying again &quot;+tries);tries++;getjsondata.abort();requestJsonData()}else{VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Google Docs is not responding&quot;)}},16e3);function requestJsonData(){getjsondata=VMM.getJSON(url,function(d){clearTimeout(timeout);VMM.Timeline.DataObj.model.googlespreadsheet.buildData(d)}).error(function(jqXHR,textStatus,errorThrown){if(jqXHR.status==400){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Error reading Google spreadsheet. Check the URL and make sure it's published to the web.&quot;);clearTimeout(timeout);return}trace(&quot;Google Docs ERROR&quot;);trace(&quot;Google Docs ERROR: &quot;+textStatus+&quot; &quot;+jqXHR.responseText)}).success(function(d){clearTimeout(timeout)})}requestJsonData()},buildData:function(d){var data_obj=VMM.Timeline.DataObj.data_template_obj,is_valid=false;VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Parsing Google Doc Data&quot;);function getGVar(v){if(typeof v!=&quot;undefined&quot;){return v.$t}else{return&quot;&quot;}}if(typeof d.feed.entry==&quot;undefined&quot;){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Error parsing spreadsheet. Make sure you have no blank rows and that the headers have not been changed.&quot;)}else{is_valid=true;for(var i=0;i&lt;d.feed.entry.length;i++){var dd=d.feed.entry[i],dd_type=&quot;&quot;;if(typeof dd.gsx$startdate==&quot;undefined&quot;){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Missing start date. Make sure the headers of your Google Spreadsheet have not been changed.&quot;);return}if(typeof dd.gsx$type!=&quot;undefined&quot;){dd_type=dd.gsx$type.$t}else if(typeof dd.gsx$titleslide!=&quot;undefined&quot;){dd_type=dd.gsx$titleslide.$t}if(dd_type.match(&quot;start&quot;)||dd_type.match(&quot;title&quot;)){data_obj.timeline.startDate=getGVar(dd.gsx$startdate);data_obj.timeline.headline=getGVar(dd.gsx$headline);data_obj.timeline.asset.media=getGVar(dd.gsx$media);data_obj.timeline.asset.caption=getGVar(dd.gsx$mediacaption);data_obj.timeline.asset.credit=getGVar(dd.gsx$mediacredit);data_obj.timeline.text=getGVar(dd.gsx$text);data_obj.timeline.type=&quot;google spreadsheet&quot;}else if(dd_type.match(&quot;era&quot;)){var era={startDate:getGVar(dd.gsx$startdate),endDate:getGVar(dd.gsx$enddate),headline:getGVar(dd.gsx$headline),text:getGVar(dd.gsx$text),tag:getGVar(dd.gsx$tag)};data_obj.timeline.era.push(era)}else{var date={type:&quot;google spreadsheet&quot;,startDate:getGVar(dd.gsx$startdate),endDate:getGVar(dd.gsx$enddate),headline:getGVar(dd.gsx$headline),text:getGVar(dd.gsx$text),tag:getGVar(dd.gsx$tag),asset:{media:getGVar(dd.gsx$media),credit:getGVar(dd.gsx$mediacredit),caption:getGVar(dd.gsx$mediacaption),thumbnail:getGVar(dd.gsx$mediathumbnail)}};data_obj.timeline.date.push(date)}}}if(is_valid){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Finished Parsing Data&quot;);VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,data_obj)}else{VMM.fireEvent(global,VMM.Timeline.Config.events.messege,VMM.Language.messages.loading+&quot; Google Doc Data (cells)&quot;);trace(&quot;There may be too many entries. Still trying to load data. Now trying to load cells to avoid Googles limitation on cells&quot;);VMM.Timeline.DataObj.model.googlespreadsheet.getDataCells(d.feed.link[0].href)}},getDataCells:function(raw){var getjsondata,key,url,timeout,tries=0;key=VMM.Timeline.DataObj.model.googlespreadsheet.extractSpreadsheetKey(raw);url=&quot;<A href="https://spreadsheets.google.com/feeds/cells/" class="external free" rel="nofollow">https://spreadsheets.google.com/feeds/cells/</A>&quot;+key+&quot;/od6/public/values?alt=json&quot;;timeout=setTimeout(function(){trace(&quot;Google Docs timeout &quot;+url);trace(url);if(tries&lt;3){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Still waiting on Google Docs, trying again &quot;+tries);tries++;getjsondata.abort();requestJsonData()}else{VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Google Docs is not responding&quot;)}},16e3);function requestJsonData(){getjsondata=VMM.getJSON(url,function(d){clearTimeout(timeout);VMM.Timeline.DataObj.model.googlespreadsheet.buildDataCells(d)}).error(function(jqXHR,textStatus,errorThrown){trace(&quot;Google Docs ERROR&quot;);trace(&quot;Google Docs ERROR: &quot;+textStatus+&quot; &quot;+jqXHR.responseText)}).success(function(d){clearTimeout(timeout)})}requestJsonData()},buildDataCells:function(d){var data_obj=VMM.Timeline.DataObj.data_template_obj,is_valid=false,cellnames=[&quot;timeline&quot;],list=[],max_row=0,i=0,k=0;VMM.fireEvent(global,VMM.Timeline.Config.events.messege,VMM.Language.messages.loading_timeline+&quot; Parsing Google Doc Data (cells)&quot;);function getGVar(v){if(typeof v!=&quot;undefined&quot;){return v.$t}else{return&quot;&quot;}}if(typeof d.feed.entry!=&quot;undefined&quot;){is_valid=true;for(i=0;i&lt;d.feed.entry.length;i++){var dd=d.feed.entry[i];if(parseInt(dd.gs$cell.row)&gt;max_row){max_row=parseInt(dd.gs$cell.row)}}for(var i=0;i&lt;max_row+1;i++){var date={type:&quot;&quot;,startDate:&quot;&quot;,endDate:&quot;&quot;,headline:&quot;&quot;,text:&quot;&quot;,tag:&quot;&quot;,asset:{media:&quot;&quot;,credit:&quot;&quot;,caption:&quot;&quot;,thumbnail:&quot;&quot;}};list.push(date)}for(i=0;i&lt;d.feed.entry.length;i++){var dd=d.feed.entry[i],dd_type=&quot;&quot;,column_name=&quot;&quot;,cell={content:getGVar(dd.gs$cell),col:dd.gs$cell.col,row:dd.gs$cell.row,name:&quot;&quot;};if(cell.row==1){if(cell.content==&quot;Start Date&quot;){column_name=&quot;startDate&quot;}else if(cell.content==&quot;End Date&quot;){column_name=&quot;endDate&quot;}else if(cell.content==&quot;Headline&quot;){column_name=&quot;headline&quot;}else if(cell.content==&quot;Text&quot;){column_name=&quot;text&quot;}else if(cell.content==&quot;Media&quot;){column_name=&quot;media&quot;}else if(cell.content==&quot;Media Credit&quot;){column_name=&quot;credit&quot;}else if(cell.content==&quot;Media Caption&quot;){column_name=&quot;caption&quot;}else if(cell.content==&quot;Media Thumbnail&quot;){column_name=&quot;thumbnail&quot;}else if(cell.content==&quot;Type&quot;){column_name=&quot;type&quot;}else if(cell.content==&quot;Tag&quot;){column_name=&quot;tag&quot;}cellnames.push(column_name)}else{cell.name=cellnames[cell.col];list[cell.row][cell.name]=cell.content}}for(i=0;i&lt;list.length;i++){var date=list[i];if(date.type.match(&quot;start&quot;)||date.type.match(&quot;title&quot;)){data_obj.timeline.startDate=date.startDate;data_obj.timeline.headline=date.headline;data_obj.timeline.asset.media=date.media;data_obj.timeline.asset.caption=date.caption;data_obj.timeline.asset.credit=date.credit;data_obj.timeline.text=date.text;data_obj.timeline.type=&quot;google spreadsheet&quot;}else if(date.type.match(&quot;era&quot;)){var era={startDate:date.startDate,endDate:date.endDate,headline:date.headline,text:date.text,tag:date.tag};data_obj.timeline.era.push(era)}else{if(date.startDate){var date={type:&quot;google spreadsheet&quot;,startDate:date.startDate,endDate:date.endDate,headline:date.headline,text:date.text,tag:date.tag,asset:{media:date.media,credit:date.credit,caption:date.caption,thumbnail:date.thumbnail}};data_obj.timeline.date.push(date)}else{trace(&quot;Skipping item &quot;+i+&quot; in list: no start date.&quot;)}}}}is_valid=data_obj.timeline.date.length&gt;0;if(is_valid){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Finished Parsing Data&quot;);VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,data_obj)}else{VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Unable to load Google Doc data source. Make sure you have no blank rows and that the headers have not been changed.&quot;)}}},storify:{getData:function(raw){var key,url,storify_timeout;VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Loading Storify...&quot;);key=raw.split(&quot;storify.com/&quot;)[1];url=&quot;//api.storify.com/v1/stories/&quot;+key+&quot;?per_page=300&amp;callback=?&quot;;storify_timeout=setTimeout(function(){trace(&quot;STORIFY timeout&quot;);VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Storify is not responding&quot;)},6e3);VMM.getJSON(url,VMM.Timeline.DataObj.model.storify.buildData).error(function(jqXHR,textStatus,errorThrown){trace(&quot;STORIFY error&quot;);trace(&quot;STORIFY ERROR: &quot;+textStatus+&quot; &quot;+jqXHR.responseText)}).success(function(d){clearTimeout(storify_timeout)})},buildData:function(d){VMM.fireEvent(global,VMM.Timeline.Config.events.messege,&quot;Parsing Data&quot;);var _data_obj=VMM.Timeline.DataObj.data_template_obj;_data_obj.timeline.startDate=new Date(d.content.date.created);_data_obj.timeline.headline=d.content.title;trace(d);var tt=&quot;&quot;;var t_name=d.content.author.username;var t_nickname=&quot;&quot;;if(typeof d.content.author.name!=&quot;undefined&quot;){t_name=d.content.author.name;t_nickname=d.content.author.username+&quot;Â &quot;}if(typeof d.content.description!=&quot;undefined&quot;&amp;&amp;d.content.description!=null){tt+=d.content.description}tt+=&quot;<DIV class="storify">&quot;;tt+=&quot;<DIV class="vcard author">&lt;a class='screen-name url' href='&quot;+d.content.author.permalink+&quot;' target='_blank'&gt;&quot;;tt+=&quot;<SPAN class="avatar">&lt;img src='&quot;+d.content.author.avatar+&quot;' style='max-width: 32px; max-height: 32px;'&gt;</SPAN>&quot;;tt+=&quot;<SPAN class="fn">&quot;+t_name+&quot;</SPAN>&quot;;tt+=&quot;<SPAN class="nickname">&quot;+t_nickname+&quot;</SPAN>&quot;;tt+=&quot;&lt;/a&gt;&quot;;tt+=&quot;</DIV>&quot;;tt+=&quot;</DIV>&quot;;_data_obj.timeline.text=tt;_data_obj.timeline.asset.media=d.content.thumbnail;_data_obj.timeline.type=&quot;storify&quot;;for(var i=0;i&lt;d.content.elements.length;i++){var dd=d.content.elements[i];var is_text=false;var d_date=new Date(dd.posted_at);trace(dd.type);var _date={type:&quot;storify&quot;,startDate:dd.posted_at,endDate:dd.posted_at,headline:&quot; &quot;,slug:&quot;&quot;,text:&quot;&quot;,asset:{media:&quot;&quot;,credit:&quot;&quot;,caption:&quot;&quot;}};if(dd.type==&quot;image&quot;){if(typeof dd.source.name!=&quot;undefined&quot;){if(dd.source.name==&quot;flickr&quot;){_date.asset.media=&quot;//flickr.com/photos/&quot;+dd.meta.pathalias+&quot;/&quot;+dd.meta.id+&quot;/&quot;;_date.asset.credit=&quot;&lt;a href='&quot;+_date.asset.media+&quot;'&gt;&quot;+dd.attribution.name+&quot;&lt;/a&gt;&quot;;_date.asset.credit+=&quot; on &lt;a href='&quot;+dd.source.href+&quot;'&gt;&quot;+dd.source.name+&quot;&lt;/a&gt;&quot;}else if(dd.source.name==&quot;instagram&quot;){_date.asset.media=dd.permalink;_date.asset.credit=&quot;&lt;a href='&quot;+dd.permalink+&quot;'&gt;&quot;+dd.attribution.name+&quot;&lt;/a&gt;&quot;;_date.asset.credit+=&quot; on &lt;a href='&quot;+dd.source.href+&quot;'&gt;&quot;+dd.source.name+&quot;&lt;/a&gt;&quot;}else{_date.asset.credit=&quot;&lt;a href='&quot;+dd.permalink+&quot;'&gt;&quot;+dd.attribution.name+&quot;&lt;/a&gt;&quot;;if(typeof dd.source.href!=&quot;undefined&quot;){_date.asset.credit+=&quot; on &lt;a href='&quot;+dd.source.href+&quot;'&gt;&quot;+dd.source.name+&quot;&lt;/a&gt;&quot;}_date.asset.media=dd.data.image.src}}else{_date.asset.credit=&quot;&lt;a href='&quot;+dd.permalink+&quot;'&gt;&quot;+dd.attribution.name+&quot;&lt;/a&gt;&quot;;_date.asset.media=dd.data.image.src}_date.slug=dd.attribution.name;if(typeof dd.data.image.caption!=&quot;undefined&quot;){if(dd.data.image.caption!=&quot;undefined&quot;){_date.asset.caption=dd.data.image.caption;_date.slug=dd.data.image.caption}}}else if(dd.type==&quot;quote&quot;){if(dd.permalink.match(&quot;twitter&quot;)){_date.asset.media=dd.permalink;_date.slug=VMM.Util.untagify(dd.data.quote.text)}else if(dd.permalink.match(&quot;storify&quot;)){is_text=true;_date.asset.media=&quot;<BLOCKQUOTE>&quot;+dd.data.quote.text.replace(/&lt;\s*\/?\s*b\s*.*?&gt;/g,&quot;&quot;)+&quot;</BLOCKQUOTE>&quot;}}else if(dd.type==&quot;link&quot;){_date.headline=dd.data.link.title;_date.text=dd.data.link.description;if(dd.data.link.thumbnail!=&quot;undefined&quot;&amp;&amp;dd.data.link.thumbnail!=&quot;&quot;){_date.asset.media=dd.data.link.thumbnail}else{_date.asset.media=dd.permalink}_date.asset.caption=&quot;&lt;a href='&quot;+dd.permalink+&quot;' target='_blank'&gt;&quot;+dd.data.link.title+&quot;&lt;/a&gt;&quot;;_date.slug=dd.data.link.title}else if(dd.type==&quot;text&quot;){if(dd.permalink.match(&quot;storify&quot;)){is_text=true;var d_name=d.content.author.username;var d_nickname=&quot;&quot;;if(typeof dd.attribution.name!=&quot;undefined&quot;){t_name=dd.attribution.name;t_nickname=dd.attribution.username+&quot;Â &quot;}var asset_text=&quot;<DIV class="storify">&quot;;asset_text+=&quot;<BLOCKQUOTE><P>&quot;+dd.data.text.replace(/&lt;\s*\/?\s*b\s*.*?&gt;/g,&quot;&quot;)+&quot;</P></BLOCKQUOTE>&quot;;asset_text+=&quot;<DIV class="vcard author">&lt;a class='screen-name url' href='&quot;+dd.attribution.href+&quot;' target='_blank'&gt;&quot;;asset_text+=&quot;<SPAN class="avatar">&lt;img src='&quot;+dd.attribution.thumbnail+&quot;' style='max-width: 32px; max-height: 32px;'&gt;</SPAN>&quot;;asset_text+=&quot;<SPAN class="fn">&quot;+t_name+&quot;</SPAN>&quot;;asset_text+=&quot;<SPAN class="nickname">&quot;+t_nickname+&quot;</SPAN>&quot;;asset_text+=&quot;&lt;/a&gt;</DIV></DIV>&quot;;_date.text=asset_text;if(i+1&gt;=d.content.elements.length){_date.startDate=d.content.elements[i-1].posted_at}else{if(d.content.elements[i+1].type==&quot;text&quot;&amp;&amp;d.content.elements[i+1].permalink.match(&quot;storify&quot;)){if(i+2&gt;=d.content.elements.length){_date.startDate=d.content.elements[i-1].posted_at}else{if(d.content.elements[i+2].type==&quot;text&quot;&amp;&amp;d.content.elements[i+2].permalink.match(&quot;storify&quot;)){if(i+3&gt;=d.content.elements.length){_date.startDate=d.content.elements[i-1].posted_at}else{if(d.content.elements[i+3].type==&quot;text&quot;&amp;&amp;d.content.elements[i+3].permalink.match(&quot;storify&quot;)){_date.startDate=d.content.elements[i-1].posted_at}else{trace(&quot;LEVEL 3&quot;);_date.startDate=d.content.elements[i+3].posted_at}}}else{trace(&quot;LEVEL 2&quot;);_date.startDate=d.content.elements[i+2].posted_at}}}else{trace(&quot;LEVEL 1&quot;);_date.startDate=d.content.elements[i+1].posted_at}}_date.endDate=_date.startDate}}else if(dd.type==&quot;video&quot;){_date.headline=dd.data.video.title;_date.asset.caption=dd.data.video.description;_date.asset.caption=dd.source.username;_date.asset.media=dd.data.video.src}else{trace(&quot;NO MATCH &quot;);trace(dd)}if(is_text){_date.slug=VMM.Util.untagify(dd.data.text)}_data_obj.timeline.date.push(_date)}VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,_data_obj)}},tweets:{type:&quot;twitter&quot;,buildData:function(raw_data){VMM.bindEvent(global,VMM.Timeline.DataObj.model.tweets.onTwitterDataReady,&quot;TWEETSLOADED&quot;);VMM.ExternalAPI.twitter.getTweets(raw_data.timeline.tweets)},getData:function(raw_data){VMM.bindEvent(global,VMM.Timeline.DataObj.model.tweets.onTwitterDataReady,&quot;TWEETSLOADED&quot;);VMM.ExternalAPI.twitter.getTweetSearch(raw_data)},onTwitterDataReady:function(e,d){var _data_obj=VMM.Timeline.DataObj.data_template_obj;for(var i=0;i&lt;d.tweetdata.length;i++){var _date={type:&quot;tweets&quot;,startDate:&quot;&quot;,headline:&quot;&quot;,text:&quot;&quot;,asset:{media:&quot;&quot;,credit:&quot;&quot;,caption:&quot;&quot;},tags:&quot;Optional&quot;};_date.startDate=d.tweetdata[i].raw.created_at;if(type.of(d.tweetdata[i].raw.from_user_name)){_date.headline=d.tweetdata[i].raw.from_user_name+&quot; (&lt;a href='<A href="https://twitter.com/" class="external free" rel="nofollow">https://twitter.com/</A>&quot;+d.tweetdata[i].raw.from_user+&quot;'&gt;&quot;+&quot;@&quot;+d.tweetdata[i].raw.from_user+&quot;&lt;/a&gt;)&quot;}else{_date.headline=d.tweetdata[i].raw.user.name+&quot; (&lt;a href='<A href="https://twitter.com/" class="external free" rel="nofollow">https://twitter.com/</A>&quot;+d.tweetdata[i].raw.user.screen_name+&quot;'&gt;&quot;+&quot;@&quot;+d.tweetdata[i].raw.user.screen_name+&quot;&lt;/a&gt;)&quot;}_date.asset.media=d.tweetdata[i].content;_data_obj.timeline.date.push(_date)}VMM.fireEvent(global,VMM.Timeline.Config.events.data_ready,_data_obj)}}},data_template_obj:{timeline:{headline:&quot;&quot;,description:&quot;&quot;,asset:{media:&quot;&quot;,credit:&quot;&quot;,caption:&quot;&quot;},date:[],era:[]}},date_obj:{startDate:&quot;2012,2,2,11,30&quot;,headline:&quot;&quot;,text:&quot;&quot;,asset:{media:&quot;<A href="http://youtu.be/vjVfu8-Wp6s" class="external free" rel="nofollow">http://youtu.be/vjVfu8-Wp6s</A>&quot;,credit:&quot;&quot;,caption:&quot;&quot;},tags:&quot;Optional&quot;}}}VMM.debug=false;</DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></B></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2014.igem.org/Team:Nevada/timeline.js">http://2014.igem.org/Team:Nevada/timeline.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Nevada/timeline.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Nevada/timeline.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Nevada/timeline.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Nevada/timeline.js&amp;oldid=251011" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2014.igem.org:Privacy_policy" title="2014.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2014.igem.org:General_disclaimer" title="2014.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>