<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Aachen_Scripts_jssor_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Aachen/Scripts/jssor.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Aachen/Scripts/jssor.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Aachen/Scripts/jssor.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Aachen/Scripts/jssor.js&amp;action=history">History               </A></LI><LI style="color:white;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Aachen/Scripts/jssor.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Aachen/Scripts/jssor.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2014.igem.org</H3><P>﻿/*
</P><UL><LI> Jssor 18.0
</LI><LI><A href="http://www.jssor.com/" class="external free" rel="nofollow">http://www.jssor.com/</A></LI><LI> TERMS OF USE - Jssor
</LI><LI> Copyright 2014 Jssor
</LI><LI> Permission is hereby granted, free of charge, to any person obtaining
</LI><LI> a copy of this software and associated documentation files (the
</LI><LI> &quot;Software&quot;), to deal in the Software without restriction, including
</LI><LI> without limitation the rights to use, copy, modify, merge, publish,
</LI><LI> distribute, sublicense, and/or sell copies of the Software, and to
</LI><LI> permit persons to whom the Software is furnished to do so, subject to
</LI><LI> the following conditions:
</LI><LI> The above copyright notice and this permission notice shall be
</LI><LI> included in all copies or substantial portions of the Software.
</LI><LI> THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
</LI><LI> EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
</LI><LI> MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
</LI><LI> NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
</LI><LI> LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
</LI><LI> OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
</LI><LI> WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
</LI><LI>/
</LI></UL><P>/*! Jssor */
</P><P>//$JssorDebug$
var $JssorDebug$ = new function () {
</P><PRE>   this.$DebugMode = true;
</PRE><PRE>   // Methods
</PRE><PRE>   this.$Log = function (msg, important) {
       var console = window.console || {};
       var debug = this.$DebugMode;
</PRE><PRE>       if (debug &amp;&amp; console.log) {
           console.log(msg);
       } else if (debug &amp;&amp; important) {
           alert(msg);
       }
   };
</PRE><PRE>   this.$Error = function (msg, e) {
       var console = window.console || {};
       var debug = this.$DebugMode;
</PRE><PRE>       if (debug &amp;&amp; console.error) {
           console.error(msg);
       } else if (debug) {
           alert(msg);
       }
</PRE><PRE>       if (debug) {
           // since we're debugging, fail fast by crashing
           throw e || new Error(msg);
       }
   };
</PRE><PRE>   this.$Fail = function (msg) {
       throw new Error(msg);
   };
</PRE><PRE>   this.$Assert = function (value, msg) {
       var debug = this.$DebugMode;
       if (debug) {
           if (!value)
               throw new Error(&quot;Assert failed &quot; + msg || &quot;&quot;);
       }
   };
</PRE><PRE>   this.$Trace = function (msg) {
       var console = window.console || {};
       var debug = this.$DebugMode;
</PRE><PRE>       if (debug &amp;&amp; console.log) {
           console.log(msg);
       }
   };
</PRE><PRE>   this.$Execute = function (func) {
       var debug = this.$DebugMode;
       if (debug)
           func();
   };
</PRE><PRE>   this.$LiveStamp = function (obj, id) {
       var debug = this.$DebugMode;
       if (debug) {
           var stamp = document.createElement(&quot;DIV&quot;);
           stamp.setAttribute(&quot;id&quot;, id);
</PRE><PRE>           obj.$Live = stamp;
       }
   };
</PRE><PRE>   this.$C_AbstractMethod = function () {
       ///	&lt;summary&gt;
       ///		Tells compiler the method is abstract, it should be implemented by subclass.
       ///	&lt;/summary&gt;</PRE><PRE>       throw new Error(&quot;The method is abstract, it should be implemented by subclass.&quot;);
   };
</PRE><PRE>   function C_AbstractClass (instance) {
       ///	&lt;summary&gt;
       ///		Tells compiler the class is abstract, it should be implemented by subclass.
       ///	&lt;/summary&gt;</PRE><PRE>       if(instance.constructor === C_AbstractClass.caller)
           throw new Error(&quot;Cannot create instance of an abstract class.&quot;);
   }
</PRE><PRE>   this.$C_AbstractClass = C_AbstractClass;
</PRE><P>};
</P><P>//$JssorPoint$
var $JssorPoint$ = function (x, y) {
</P><PRE>   var _ThisPoint = this;
</PRE><PRE>   // Properties
   _ThisPoint.x = x;
   _ThisPoint.y = y;
</PRE><PRE>   _ThisPoint.$Plus = function (point) {
       return new $JssorPoint$(x + point.x, y + point.y);
   };
</PRE><PRE>   _ThisPoint.$Minus = function (point) {
       return new $JssorPoint$(x - point.x, y - point.y);
   };
</PRE><PRE>   _ThisPoint.$Times = function (factor) {
       return new $JssorPoint$(x * factor, y * factor);
   };
</PRE><PRE>   _ThisPoint.$Divide = function (factor) {
       return new $JssorPoint$(x / factor, y / factor);
   };
</PRE><PRE>   _ThisPoint.$Negate = function () {
       return new $JssorPoint$(-x, -y);
   };
</PRE><PRE>   _ThisPoint.$DistanceTo = function (point) {
       return Math.sqrt(Math.pow(x - point.x, 2) + Math.pow(y - point.y, 2));
   };
</PRE><PRE>   _ThisPoint.$Apply = function (func) {
       return new $JssorPoint$(func(x), func(y));
   };
</PRE><PRE>   _ThisPoint.$Equals = function (point) {
       return (point instanceof $JssorPoint$) &amp;&amp; (x === point.x) &amp;&amp; (y === point.y);
   };
</PRE><PRE>   _ThisPoint.$ToString = function () {
       return &quot;(&quot; + x + &quot;,&quot; + y + &quot;)&quot;;
   };
</PRE><P>};
</P><P>//$JssorEasing$
var $JssorEasing$ = window.$JssorEasing$ = {
</P><PRE>   $EaseLinear: function (t) {
       return t;
   },
   $EaseGoBack: function (t) {
       return 1 - Math.abs((t *= 2) - 1);
   },
   $EaseSwing: function (t) {
       return -Math.cos(t * Math.PI) / 2 + .5;
   },
   $EaseInQuad: function (t) {
       return t * t;
   },
   $EaseOutQuad: function (t) {
       return -t * (t - 2);
   },
   $EaseInOutQuad: function (t) {
       return (t *= 2) &lt; 1 ? 1 / 2 * t * t : -1 / 2 * (--t * (t - 2) - 1);
   },
   $EaseInCubic: function (t) {
       return t * t * t;
   },
   $EaseOutCubic: function (t) {
       return (t -= 1) * t * t + 1;
   },
   $EaseInOutCubic: function (t) {
       return (t *= 2) &lt; 1 ? 1 / 2 * t * t * t : 1 / 2 * ((t -= 2) * t * t + 2);
   },
   $EaseInQuart: function (t) {
       return t * t * t * t;
   },
   $EaseOutQuart: function (t) {
       return -((t -= 1) * t * t * t - 1);
   },
   $EaseInOutQuart: function (t) {
       return (t *= 2) &lt; 1 ? 1 / 2 * t * t * t * t : -1 / 2 * ((t -= 2) * t * t * t - 2);
   },
   $EaseInQuint: function (t) {
       return t * t * t * t * t;
   },
   $EaseOutQuint: function (t) {
       return (t -= 1) * t * t * t * t + 1;
   },
   $EaseInOutQuint: function (t) {
       return (t *= 2) &lt; 1 ? 1 / 2 * t * t * t * t * t : 1 / 2 * ((t -= 2) * t * t * t * t + 2);
   },
   $EaseInSine: function (t) {
       return 1 - Math.cos(t * Math.PI / 2);
   },
   $EaseOutSine: function (t) {
       return Math.sin(t * Math.PI / 2);
   },
   $EaseInOutSine: function (t) {
       return -1 / 2 * (Math.cos(Math.PI * t) - 1);
   },
   $EaseInExpo: function (t) {
       return t == 0 ? 0 : Math.pow(2, 10 * (t - 1));
   },
   $EaseOutExpo: function (t) {
       return t == 1 ? 1 : -Math.pow(2, -10 * t) + 1;
   },
   $EaseInOutExpo: function (t) {
       return t == 0 || t == 1 ? t : (t *= 2) &lt; 1 ? 1 / 2 * Math.pow(2, 10 * (t - 1)) : 1 / 2 * (-Math.pow(2, -10 * --t) + 2);
   },
   $EaseInCirc: function (t) {
       return -(Math.sqrt(1 - t * t) - 1);
   },
   $EaseOutCirc: function (t) {
       return Math.sqrt(1 - (t -= 1) * t);
   },
   $EaseInOutCirc: function (t) {
       return (t *= 2) &lt; 1 ? -1 / 2 * (Math.sqrt(1 - t * t) - 1) : 1 / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1);
   },
   $EaseInElastic: function (t) {
       if (!t || t == 1)
           return t;
       var p = .3, s = .075;
       return -(Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * 2 * Math.PI / p));
   },
   $EaseOutElastic: function (t) {
       if (!t || t == 1)
           return t;
       var p = .3, s = .075;
       return Math.pow(2, -10 * t) * Math.sin((t - s) * 2 * Math.PI / p) + 1;
   },
   $EaseInOutElastic: function (t) {
       if (!t || t == 1)
           return t;
       var p = .45, s = .1125;
       return (t *= 2) &lt; 1 ? -.5 * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * 2 * Math.PI / p) : Math.pow(2, -10 * (t -= 1)) * Math.sin((t - s) * 2 * Math.PI / p) * .5 + 1;
   },
   $EaseInBack: function (t) {
       var s = 1.70158;
       return t * t * ((s + 1) * t - s);
   },
   $EaseOutBack: function (t) {
       var s = 1.70158;
       return (t -= 1) * t * ((s + 1) * t + s) + 1;
   },
   $EaseInOutBack: function (t) {
       var s = 1.70158;
       return (t *= 2) &lt; 1 ? 1 / 2 * t * t * (((s *= 1.525) + 1) * t - s) : 1 / 2 * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2);
   },
   $EaseInBounce: function (t) {
       return 1 - $JssorEasing$.$EaseOutBounce(1 - t)
   },
   $EaseOutBounce: function (t) {
       return t &lt; 1 / 2.75 ? 7.5625 * t * t : t &lt; 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t &lt; 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375;
   },
   $EaseInOutBounce: function (t) {
       return t &lt; 1 / 2 ? $JssorEasing$.$EaseInBounce(t * 2) * .5 : $JssorEasing$.$EaseOutBounce(t * 2 - 1) * .5 + .5;
   },
   $EaseInWave: function (t) {
       return 1 - Math.cos(t * Math.PI * 2)
   },
   $EaseOutWave: function (t) {
       return Math.sin(t * Math.PI * 2);
   },
   $EaseOutJump: function (t) {
       return 1 - (((t *= 2) &lt; 1) ? (t = 1 - t) * t * t : (t -= 1) * t * t);
   },
   $EaseInJump: function (t) {
       return ((t *= 2) &lt; 1) ? t * t * t : (t = 2 - t) * t * t;
   }
</PRE><P>};
</P><P>var $JssorDirection$ = window.$JssorDirection$ = {
</P><PRE>   $TO_LEFT: 0x0001,
   $TO_RIGHT: 0x0002,
   $TO_TOP: 0x0004,
   $TO_BOTTOM: 0x0008,
   $HORIZONTAL: 0x0003,
   $VERTICAL: 0x000C,
   $LEFTRIGHT: 0x0003,
   $TOPBOTOM: 0x000C,
   $TOPLEFT: 0x0005,
   $TOPRIGHT: 0x0006,
   $BOTTOMLEFT: 0x0009,
   $BOTTOMRIGHT: 0x000A,
   $AROUND: 0x000F,
</PRE><PRE>   $GetDirectionHorizontal: function (direction) {
       return direction &amp; 0x0003;
   },
   $GetDirectionVertical: function (direction) {
       return direction &amp; 0x000C;
   },
   $ChessHorizontal: function (direction) {
       return (~direction &amp; 0x0003) + (direction &amp; 0x000C);
   },
   $ChessVertical: function (direction) {
       return (~direction &amp; 0x000C) + (direction &amp; 0x0003);
   },
   $IsToLeft: function (direction) {
       return (direction &amp; 0x0003) == 0x0001;
   },
   $IsToRight: function (direction) {
       return (direction &amp; 0x0003) == 0x0002;
   },
   $IsToTop: function (direction) {
       return (direction &amp; 0x000C) == 0x0004;
   },
   $IsToBottom: function (direction) {
       return (direction &amp; 0x000C) == 0x0008;
   },
   $IsHorizontal: function (direction) {
       return (direction &amp; 0x0003) &gt; 0;
   },
   $IsVertical: function (direction) {
       return (direction &amp; 0x000C) &gt; 0;
   }
</PRE><P>};
</P><P>var $JssorKeyCode$ = {
</P><PRE>   $BACKSPACE: 8,
   $COMMA: 188,
   $DELETE: 46,
   $DOWN: 40,
   $END: 35,
   $ENTER: 13,
   $ESCAPE: 27,
   $HOME: 36,
   $LEFT: 37,
   $NUMPAD_ADD: 107,
   $NUMPAD_DECIMAL: 110,
   $NUMPAD_DIVIDE: 111,
   $NUMPAD_ENTER: 108,
   $NUMPAD_MULTIPLY: 106,
   $NUMPAD_SUBTRACT: 109,
   $PAGE_DOWN: 34,
   $PAGE_UP: 33,
   $PERIOD: 190,
   $RIGHT: 39,
   $SPACE: 32,
   $TAB: 9,
   $UP: 38
</PRE><P>};
</P><P>var $JssorAlignment$ = {
</P><PRE>   $TopLeft: 0x11,
   $TopCenter: 0x12,
   $TopRight: 0x14,
   $MiddleLeft: 0x21,
   $MiddleCenter: 0x22,
   $MiddleRight: 0x24,
   $BottomLeft: 0x41,
   $BottomCenter: 0x42,
   $BottomRight: 0x44,
</PRE><PRE>   $IsTop: function (aligment) {
       return aligment &amp; 0x10 &gt; 0;
   },
   $IsMiddle: function (alignment) {
       return alignment &amp; 0x20 &gt; 0;
   },
   $IsBottom: function (alignment) {
       return alignment &amp; 0x40 &gt; 0;
   },
   $IsLeft: function (alignment) {
       return alignment &amp; 0x01 &gt; 0;
   },
   $IsCenter: function (alignment) {
       return alignment &amp; 0x02 &gt; 0;
   },
   $IsRight: function (alignment) {
       return alignment &amp; 0x04 &gt; 0;
   }
</PRE><P>};
</P><P>var $JssorMatrix$;
</P><P>var $JssorAnimator$;
</P><P>// $Jssor$ is a static class, so make it singleton instance
var $Jssor$ = window.$Jssor$ = new function () {
</P><PRE>   // Fields
   var _This = this;
</PRE><PRE>   var REGEX_WHITESPACE_GLOBAL = /\S+/g;
</PRE><PRE>   var ROWSER_UNKNOWN = 0;
   var BROWSER_IE = 1;
   var BROWSER_FIREFOX = 2;
   var BROWSER_FIREFOX = 3;
   var BROWSER_CHROME = 4;
   var BROWSER_OPERA = 5;
</PRE><PRE>   //var arrActiveX = [&quot;Msxml2.XMLHTTP&quot;, &quot;Msxml3.XMLHTTP&quot;, &quot;Microsoft.XMLHTTP&quot;];
</PRE><PRE>   var browser = 0;
   var browserRuntimeVersion = 0;
   var browserEngineVersion = 0;
   var browserJavascriptVersion = 0;
   var webkitVersion = 0;
</PRE><PRE>   var app = navigator.appName;
   var ver = navigator.appVersion;
   var ua = navigator.userAgent;
</PRE><PRE>   var _DocElmt = document.documentElement;
   var _TransformProperty;
</PRE><PRE>   function DetectBrowser() {
       if (!browser) {
           if (app == &quot;Microsoft Internet Explorer&quot; &amp;&amp; !!window.attachEvent &amp;&amp; !!window.ActiveXObject) {
</PRE><PRE>               var ieOffset = ua.indexOf(&quot;MSIE&quot;);
               browser = BROWSER_IE;
               browserEngineVersion = ParseFloat(ua.substring(ieOffset + 5, ua.indexOf(&quot;;&quot;, ieOffset)));
</PRE><PRE>               //check IE javascript version
               /*@cc_on
               browserJavascriptVersion = @_jscript_version;
               @*/
</PRE><PRE>               // update: for intranet sites and compat view list sites, IE sends
               // an IE7 User-Agent to the server to be interoperable, and even if
               // the page requests a later IE version, IE will still report the
               // IE7 UA to JS. we should be robust to self
               //var docMode = document.documentMode;
               //if (typeof docMode !== &quot;undefined&quot;) {
               //    browserRuntimeVersion = docMode;
               //}
</PRE><PRE>               browserRuntimeVersion = document.documentMode || browserEngineVersion;
</PRE><PRE>           }
           else if (app == &quot;Netscape&quot; &amp;&amp; !!window.addEventListener) {
</PRE><PRE>               var ffOffset = ua.indexOf(&quot;Firefox&quot;);
               var saOffset = ua.indexOf(&quot;Safari&quot;);
               var chOffset = ua.indexOf(&quot;Chrome&quot;);
               var webkitOffset = ua.indexOf(&quot;AppleWebKit&quot;);
</PRE><PRE>               if (ffOffset &gt;= 0) {
                   browser = BROWSER_FIREFOX;
                   browserRuntimeVersion = ParseFloat(ua.substring(ffOffset + 8));
               }
               else if (saOffset &gt;= 0) {
                   var slash = ua.substring(0, saOffset).lastIndexOf(&quot;/&quot;);
                   browser = (chOffset &gt;= 0) ? BROWSER_CHROME : BROWSER_FIREFOX;
                   browserRuntimeVersion = ParseFloat(ua.substring(slash + 1, saOffset));
               }
</PRE><PRE>               if (webkitOffset &gt;= 0)
                   webkitVersion = ParseFloat(ua.substring(webkitOffset + 12));
           }
           else {
               var match = /(opera)(?:.*version|)[ \/]([\w.]+)/i.exec(ua);
               if (match) {
                   browser = BROWSER_OPERA;
                   browserRuntimeVersion = ParseFloat(match[2]);
               }
           }
       }
   }
</PRE><PRE>   function IsBrowserIE() {
       DetectBrowser();
       return browser == BROWSER_IE;
   }
</PRE><PRE>   function IsBrowserIeQuirks() {
       return IsBrowserIE() &amp;&amp; (browserRuntimeVersion &lt; 6 || document.compatMode == &quot;BackCompat&quot;);   //Composite to &quot;CSS1Compat&quot;
   }
</PRE><PRE>   function IsBrowserFireFox() {
       DetectBrowser();
       return browser == BROWSER_FIREFOX;
   }
</PRE><PRE>   function IsBrowserSafari() {
       DetectBrowser();
       return browser == BROWSER_FIREFOX;
   }
</PRE><PRE>   function IsBrowserChrome() {
       DetectBrowser();
       return browser == BROWSER_CHROME;
   }
</PRE><PRE>   function IsBrowserOpera() {
       DetectBrowser();
       return browser == BROWSER_OPERA;
   }
</PRE><PRE>   function IsBrowserBadTransform() {
       return IsBrowserSafari() &amp;&amp; (webkitVersion &gt; 534) &amp;&amp; (webkitVersion &lt; 535);
   }
</PRE><PRE>   function IsBrowserSafeHWA() {
       return IsBrowserSafari() &amp;&amp; (webkitVersion &lt; 535);
   }
</PRE><PRE>   function IsBrowserIe9Earlier() {
       return IsBrowserIE() &amp;&amp; browserRuntimeVersion &lt; 9; 
   }
</PRE><PRE>   function GetTransformProperty(elmt) {
</PRE><PRE>       if (!_TransformProperty) {
           // Note that in some versions of IE9 it is critical that
           // msTransform appear in this list before MozTransform
</PRE><PRE>           each(['transform', 'WebkitTransform', 'msTransform', 'MozTransform', 'OTransform'], function (property) {
               if (elmt.style[property] != undefined) {
                   _TransformProperty = property;
                   return true;
               }
           });
</PRE><PRE>           _TransformProperty = _TransformProperty || &quot;transform&quot;;
       }
</PRE><PRE>       return _TransformProperty;
   }
</PRE><PRE>   // Helpers
   function getOffsetParent(elmt, isFixed) {
       // IE and Opera &quot;fixed&quot; position elements don't have offset parents.
       // regardless, if it's fixed, its offset parent is the body.
       if (isFixed &amp;&amp; elmt != document.body) {
           return document.body;
       } else {
           return elmt.offsetParent;
       }
   }
</PRE><PRE>   function toString(obj) {
       return Object.prototype.toString.call(obj);
   }
</PRE><PRE>   // <A href="/wiki/index.php?title=Class&amp;action=edit&amp;redlink=1" class="new" title="Class (page does not exist)">Class</A> -&gt; type pairs
   var class2type;
</PRE><PRE>   function each(object, callback) {
       if (toString(object) == &quot;[object Array]&quot;) {
           for (var i = 0; i &lt; object.length; i++) {
               if (callback(object[i], i, object)) {
                   return true;
               }
           }
       }
       else {
           for (var name in object) {
               if (callback(object[name], name, object)) {
                   return true;
               }
           }
       }
   }
</PRE><PRE>   function GetClass2Type() {
       if (!class2type) {
           class2type = {};
           each([&quot;Boolean&quot;, &quot;Number&quot;, &quot;String&quot;, &quot;Function&quot;, &quot;Array&quot;, &quot;Date&quot;, &quot;RegExp&quot;, &quot;Object&quot;], function (name) {
               class2type[&quot;[object &quot; + name + &quot;]&quot;] = name.toLowerCase();
           });
       }
</PRE><PRE>       return class2type;
   }
</PRE><PRE>   function type(obj) {
       return obj == null ? String(obj) : GetClass2Type()[toString(obj)] || &quot;object&quot;;
   }
</PRE><PRE>   function isPlainObject(obj) {
       // Must be an Object.
       // Because of IE, we also have to check the presence of the constructor property.
       // Make sure that DOM nodes and window objects don't pass through, as well
       if (!obj || type(obj) !== &quot;object&quot; || obj.nodeType || _This.$IsWindow(obj)) {
           return false;
       }
</PRE><PRE>       var hasOwn = Object.prototype.hasOwnProperty;
</PRE><PRE>       try {
           // Not own constructor property must be Object
           if (obj.constructor &amp;&amp;</PRE><P>				!hasOwn.call(obj, &quot;constructor&quot;) &amp;&amp;
				!hasOwn.call(obj.constructor.prototype, &quot;isPrototypeOf&quot;)) {
</P><PRE>               return false;
           }
       } catch (e) {
           // IE8,9 Will throw exceptions on certain host objects #9897
           return false;
       }
</PRE><PRE>       // Own properties are enumerated firstly, so to speed up,
       // if last one is own, then all properties are own.
</PRE><PRE>       var key;
       for (key in obj) { }
</PRE><PRE>       return key === undefined || hasOwn.call(obj, key);
   }
</PRE><PRE>   function Delay(code, delay) {
       setTimeout(code, delay || 0);
   }
</PRE><PRE>   function RemoveByReg(str, reg) {
       var m = reg.exec(str);
</PRE><PRE>       if (m) {
           var header = str.substr(0, m.index);
           var tailer = str.substr(m.lastIndex + 1, str.length - (m.lastIndex + 1));
           str = header + tailer;
       }
</PRE><PRE>       return str;
   }
</PRE><PRE>   function BuildNewCss(oldCss, removeRegs, replaceValue) {
       var css = (!oldCss || oldCss == &quot;inherit&quot;) ? &quot;&quot; : oldCss;
</PRE><PRE>       each(removeRegs, function (removeReg) {
           var m = removeReg.exec(css);
</PRE><PRE>           if (m) {
               var header = css.substr(0, m.index);
               var tailer = css.substr(m.lastIndex + 1, css.length - (m.lastIndex + 1));
               css = header + tailer;
           }
       });
</PRE><PRE>       css = replaceValue + (css.indexOf(&quot; &quot;) != 0 ? &quot; &quot; : &quot;&quot;) + css;
</PRE><PRE>       return css;
   }
</PRE><PRE>   function SetStyleFilterIE(elmt, value) {
       if (browserRuntimeVersion &lt; 9) {
           elmt.style.filter = value;
       }
   }
</PRE><PRE>   function SetStyleMatrixIE(elmt, matrix, offset) {
       //matrix is not for ie9+ running in ie8- mode
       if (browserJavascriptVersion &lt; 9) {
           var oldFilterValue = elmt.style.filter;
           var matrixReg = new RegExp(/[\s]*progid:DXImageTransform\.Microsoft\.Matrix\([^\)]*\)/g);
           var matrixValue = matrix ? &quot;progid:DXImageTransform.Microsoft.Matrix(&quot; + &quot;M11=&quot; + matrix[0][0] + &quot;, M12=&quot; + matrix[0][1] + &quot;, M21=&quot; + matrix[1][0] + &quot;, M22=&quot; + matrix[1][1] + &quot;, SizingMethod='auto expand')&quot; : &quot;&quot;;
</PRE><PRE>           var newFilterValue = BuildNewCss(oldFilterValue, [matrixReg], matrixValue);
</PRE><PRE>           SetStyleFilterIE(elmt, newFilterValue);
</PRE><PRE>           _This.$CssMarginTop(elmt, offset.y);
           _This.$CssMarginLeft(elmt, offset.x);
       }
   }
</PRE><PRE>   // Methods
</PRE><PRE>   _This.$IsBrowserIE = IsBrowserIE;
</PRE><PRE>   _This.$IsBrowserIeQuirks = IsBrowserIeQuirks;
</PRE><PRE>   _This.$IsBrowserFireFox = IsBrowserFireFox;
</PRE><PRE>   _This.$IsBrowserSafari = IsBrowserSafari;
</PRE><PRE>   _This.$IsBrowserChrome = IsBrowserChrome;
</PRE><PRE>   _This.$IsBrowserOpera = IsBrowserOpera;
</PRE><PRE>   _This.$IsBrowserBadTransform = IsBrowserBadTransform;
</PRE><PRE>   _This.$IsBrowserSafeHWA = IsBrowserSafeHWA;
</PRE><PRE>   _This.$IsBrowserIe9Earlier = IsBrowserIe9Earlier;
</PRE><PRE>   _This.$BrowserVersion = function () {
       return browserRuntimeVersion;
   };
</PRE><PRE>   _This.$BrowserEngineVersion = function () {
       return browserEngineVersion || browserRuntimeVersion;
   };
</PRE><PRE>   _This.$WebKitVersion = function () {
       return webkitVersion;
   };
</PRE><PRE>   _This.$Delay = Delay;
</PRE><PRE>   _This.$Inherit = function (instance, baseClass) {
       baseClass.apply(instance, [].slice.call(arguments, 2));
       return Extend({}, instance);
   };
</PRE><PRE>   function Construct(instance, constructor) {
       instance.constructor === Construct.caller &amp;&amp; instance.$Construct &amp;&amp; instance.$Construct();
   }
</PRE><PRE>   _This.$Construct = Construct;
</PRE><PRE>   _This.$GetElement = function (elmt) {
       if (_This.$IsString(elmt)) {
           elmt = document.getElementById(elmt);
       }
</PRE><PRE>       return elmt;
   };
</PRE><PRE>   function GetEvent(event) {
       return event || window.event;
   }
</PRE><PRE>   GetEvent = GetEvent;
</PRE><PRE>   _This.$EventSrc = function (event) {
       event = GetEvent(event);
       return event.target || event.srcElement || document;
   };
</PRE><PRE>   _This.$EventDst = function (event) {
       event = GetEvent(event);
       return event.relatedTarget || event.toElement;
   };
</PRE><PRE>   _This.$MousePosition = function (event) {
       event = GetEvent(event);
       var body = document.body;
</PRE><PRE>       return {
           x: event.pageX || event.clientX + (_DocElmt.scrollLeft || body.scrollLeft || 0) - (_DocElmt.clientLeft || body.clientLeft || 0) || 0,
           y: event.pageY || event.clientY + (_DocElmt.scrollTop || body.scrollTop || 0) - (_DocElmt.clientTop || body.clientTop || 0) || 0
       };
   };
</PRE><PRE>   _This.$PageScroll = function () {
       var body = document.body;
</PRE><PRE>       return {
           x: (window.pageXOffset || _DocElmt.scrollLeft || body.scrollLeft || 0) - (_DocElmt.clientLeft || body.clientLeft || 0),
           y: (window.pageYOffset || _DocElmt.scrollTop || body.scrollTop || 0) - (_DocElmt.clientTop || body.clientTop || 0)
       };
   };
</PRE><PRE>   _This.$WindowSize = function () {
       var body = document.body;
</PRE><PRE>       return {
           x: body.clientWidth || _DocElmt.clientWidth,
           y: body.clientHeight || _DocElmt.clientHeight
       };
   };
</PRE><PRE>   //_This.$GetElementPosition = function (elmt) {
   //    elmt = _This.$GetElement(elmt);
   //    var result = new $JssorPoint$();
</PRE><PRE>   //    // technique from:
   //    // <A href="http://www.quirksmode.org/js/findpos.html" class="external free" rel="nofollow">http://www.quirksmode.org/js/findpos.html</A>
   //    // with special check for &quot;fixed&quot; elements.
</PRE><PRE>   //    while (elmt) {
   //        result.x += elmt.offsetLeft;
   //        result.y += elmt.offsetTop;
</PRE><PRE>   //        var isFixed = _This.$GetElementStyle(elmt).position == &quot;fixed&quot;;
</PRE><PRE>   //        if (isFixed) {
   //            result = result.$Plus(_This.$PageScroll(window));
   //        }
</PRE><PRE>   //        elmt = getOffsetParent(elmt, isFixed);
   //    }
</PRE><PRE>   //    return result;
   //};
</PRE><PRE>   //_This.$GetMouseScroll = function (event) {
   //    event = GetEvent(event);
   //    var delta = 0; // default value
</PRE><PRE>   //    // technique from:
   //    // <A href="http://blog.paranoidferret.com/index.php/2007/10/31/javascript-tutorial-the-scroll-wheel/" class="external free" rel="nofollow">http://blog.paranoidferret.com/index.php/2007/10/31/javascript-tutorial-the-scroll-wheel/</A></PRE><PRE>   //    if (typeof (event.wheelDelta) == &quot;number&quot;) {
   //        delta = event.wheelDelta;
   //    } else if (typeof (event.detail) == &quot;number&quot;) {
   //        delta = event.detail * -1;
   //    } else {
   //        $JssorDebug$.$Fail(&quot;Unknown event mouse scroll, no known technique.&quot;);
   //    }
</PRE><PRE>   //    // normalize value to [-1, 1]
   //    return delta ? delta / Math.abs(delta) : 0;
   //};
</PRE><PRE>   //_This.$MakeAjaxRequest = function (url, callback) {
   //    var async = typeof (callback) == &quot;function&quot;;
   //    var req = null;
</PRE><PRE>   //    if (async) {
   //        var actual = callback;
   //        var callback = function () {
   //            Delay($Jssor$.$CreateCallback(null, actual, req), 1);
   //        };
   //    }
</PRE><PRE>   //    if (window.ActiveXObject) {
   //        for (var i = 0; i &lt; arrActiveX.length; i++) {
   //            try {
   //                req = new ActiveXObject(arrActiveX[i]);
   //                break;
   //            } catch (e) {
   //                continue;
   //            }
   //        }
   //    } else if (window.XMLHttpRequest) {
   //        req = new XMLHttpRequest();
   //    }
</PRE><PRE>   //    if (!req) {
   //        $JssorDebug$.$Fail(&quot;Browser doesn't support XMLHttpRequest.&quot;);
   //    }
</PRE><PRE>   //    if (async) {
   //        req.onreadystatechange = function () {
   //            if (req.readyState == 4) {
   //                // prevent memory leaks by breaking circular reference now
   //                req.onreadystatechange = new Function();
   //                callback();
   //            }
   //        };
   //    }
</PRE><PRE>   //    try {
   //        req.open(&quot;GET&quot;, url, async);
   //        req.send(null);
   //    } catch (e) {
   //        $JssorDebug$.$Log(e.name + &quot; while making AJAX request: &quot; + e.message);
</PRE><PRE>   //        req.onreadystatechange = null;
   //        req = null;
</PRE><PRE>   //        if (async) {
   //            callback();
   //        }
   //    }
</PRE><PRE>   //    return async ? null : req;
   //};
</PRE><PRE>   //_This.$ParseXml = function (string) {
   //    var xmlDoc = null;
</PRE><PRE>   //    if (window.ActiveXObject) {
   //        try {
   //            xmlDoc = new ActiveXObject(&quot;Microsoft.XMLDOM&quot;);
   //            xmlDoc.async = false;
   //            xmlDoc.loadXML(string);
   //        } catch (e) {
   //            $JssorDebug$.$Log(e.name + &quot; while parsing XML (ActiveX): &quot; + e.message);
   //        }
   //    } else if (window.DOMParser) {
   //        try {
   //            var parser = new DOMParser();
   //            xmlDoc = parser.parseFromString(string, &quot;text/xml&quot;);
   //        } catch (e) {
   //            $JssorDebug$.$Log(e.name + &quot; while parsing XML (DOMParser): &quot; + e.message);
   //        }
   //    } else {
   //        $JssorDebug$.$Fail(&quot;Browser doesn't support XML DOM.&quot;);
   //    }
</PRE><PRE>   //    return xmlDoc;
   //};
</PRE><PRE>   function Css(elmt, name, value) {
       ///	&lt;summary&gt;
       ///		access css
       ///     $Jssor$.$Css(elmt, name);         //get css value
       ///     $Jssor$.$Css(elmt, name, value);  //set css value
       ///	&lt;/summary&gt;
       ///	&lt;param name=&quot;elmt&quot; type=&quot;HTMLElement&quot;&gt;
       ///		the element to access css
       ///	&lt;/param&gt;
       ///	&lt;param name=&quot;name&quot; type=&quot;String&quot;&gt;
       ///		the name of css property
       ///	&lt;/param&gt;
       ///	&lt;param name=&quot;value&quot; optional=&quot;true&quot;&gt;
       ///		the value to set
       ///	&lt;/param&gt;
       if (value != undefined) {
           elmt.style[name] = value;
       }
       else {
           var style = elmt.currentStyle || elmt.style;
           value = style[name];
</PRE><PRE>           if (value == &quot;&quot; &amp;&amp; window.getComputedStyle) {
               style = elmt.ownerDocument.defaultView.getComputedStyle(elmt, null);
</PRE><PRE>               style &amp;&amp; (value = style.getPropertyValue(name) || style[name]);
           }
</PRE><PRE>           return value;
       }
   }
</PRE><PRE>   function CssN(elmt, name, value, isDimensional) {
       ///	&lt;summary&gt;
       ///		access css as numeric
       ///     $Jssor$.$CssN(elmt, name);         //get css value
       ///     $Jssor$.$CssN(elmt, name, value);  //set css value
       ///	&lt;/summary&gt;
       ///	&lt;param name=&quot;elmt&quot; type=&quot;HTMLElement&quot;&gt;
       ///		the element to access css
       ///	&lt;/param&gt;
       ///	&lt;param name=&quot;name&quot; type=&quot;String&quot;&gt;
       ///		the name of css property
       ///	&lt;/param&gt;
       ///	&lt;param name=&quot;value&quot; type=&quot;Number&quot; optional=&quot;true&quot;&gt;
       ///		the value to set
       ///	&lt;/param&gt;
       if (value != undefined) {
           isDimensional &amp;&amp; (value += &quot;px&quot;);
           Css(elmt, name, value);
       }
       else {
           return ParseFloat(Css(elmt, name));
       }
   }
</PRE><PRE>   function CssP(elmt, name, value) {
       ///	&lt;summary&gt;
       ///		access css in pixel as numeric, like 'top', 'left', 'width', 'height'
       ///     $Jssor$.$CssP(elmt, name);         //get css value
       ///     $Jssor$.$CssP(elmt, name, value);  //set css value
       ///	&lt;/summary&gt;
       ///	&lt;param name=&quot;elmt&quot; type=&quot;HTMLElement&quot;&gt;
       ///		the element to access css
       ///	&lt;/param&gt;
       ///	&lt;param name=&quot;name&quot; type=&quot;String&quot;&gt;
       ///		the name of css property
       ///	&lt;/param&gt;
       ///	&lt;param name=&quot;value&quot; type=&quot;Number&quot; optional=&quot;true&quot;&gt;
       ///		the value to set
       ///	&lt;/param&gt;
       return CssN(elmt, name, value, true);
   }
</PRE><PRE>   function CssProxy(name, numericOrDimension) {
       ///	&lt;summary&gt;
       ///		create proxy to access css, CssProxy(name[, numericOrDimension]);
       ///	&lt;/summary&gt;
       ///	&lt;param name=&quot;elmt&quot; type=&quot;HTMLElement&quot;&gt;
       ///		the element to access css
       ///	&lt;/param&gt;
       ///	&lt;param name=&quot;numericOrDimension&quot; type=&quot;Number&quot; optional=&quot;true&quot;&gt;
       ///		not set: access original css, 1: access css as numeric, 2: access css in pixel as numeric
       ///	&lt;/param&gt;
       var isDimensional = numericOrDimension &amp; 2;
       var cssAccessor = numericOrDimension ? CssN : Css;
       return function (elmt, value) {
           return cssAccessor(elmt, name, value, isDimensional);
       };
   }
</PRE><PRE>   function GetStyleOpacity(elmt) {
       if (IsBrowserIE() &amp;&amp; browserEngineVersion &lt; 9) {
           var match = /opacity=([^)]*)/.exec(elmt.style.filter || &quot;&quot;);
           return match ? (ParseFloat(match[1]) / 100) : 1;
       }
       else
           return ParseFloat(elmt.style.opacity || &quot;1&quot;);
   }
</PRE><PRE>   function SetStyleOpacity(elmt, opacity, ie9EarlierForce) {
</PRE><PRE>       if (IsBrowserIE() &amp;&amp; browserEngineVersion &lt; 9) {
           //var filterName = &quot;filter&quot;; // browserEngineVersion &lt; 8 ? &quot;filter&quot; : &quot;-ms-filter&quot;;
           var finalFilter = elmt.style.filter || &quot;&quot;;
</PRE><PRE>           // for CSS filter browsers (IE), remove alpha filter if it's unnecessary.
           // update: doing _This always since IE9 beta seems to have broken the
           // behavior if we rely on the programmatic filters collection.
           var alphaReg = new RegExp(/[\s]*alpha\([^\)]*\)/g);
</PRE><PRE>           // important: note the lazy star! _This protects against
           // multiple filters; we don't want to delete the other ones.
           // update: also trimming extra whitespace around filter.
</PRE><PRE>           var ieOpacity = Math.round(100 * opacity);
           var alphaFilter = &quot;&quot;;
           if (ieOpacity &lt; 100 || ie9EarlierForce) {
               alphaFilter = &quot;alpha(opacity=&quot; + ieOpacity + &quot;) &quot;;
               //elmt.style[&quot;-ms-filter&quot;] = &quot;progid:DXImageTransform.Microsoft.Alpha(opacity=&quot; + ieOpacity + &quot;) &quot;;
           }
</PRE><PRE>           var newFilterValue = BuildNewCss(finalFilter, [alphaReg], alphaFilter);
</PRE><PRE>           SetStyleFilterIE(elmt, newFilterValue);
       }
</PRE><PRE>           //if (!IsBrowserIE() || browserEngineVersion &gt;= 9) 
       else {
           elmt.style.opacity = opacity == 1 ? &quot;&quot; : Math.round(opacity * 100) / 100;
       }
   }
</PRE><PRE>   function SetStyleTransformInternal(elmt, transform) {
       var rotate = transform.$Rotate || 0;
       var scale = transform.$Scale == undefined ? 1 : transform.$Scale;
</PRE><PRE>       if (IsBrowserIe9Earlier()) {
           var matrix = _This.$CreateMatrix(rotate / 180 * Math.PI, scale, scale);
           SetStyleMatrixIE(elmt, (!rotate &amp;&amp; scale == 1) ? null : matrix, _This.$GetMatrixOffset(matrix, transform.$OriginalWidth, transform.$OriginalHeight));
       }
       else {
           //rotate(15deg) scale(.5) translateZ(0)
           var transformProperty = GetTransformProperty(elmt);
           if (transformProperty) {
               var transformValue = &quot;rotate(&quot; + rotate % 360 + &quot;deg) scale(&quot; + scale + &quot;)&quot;;
               if (IsBrowserChrome() &amp;&amp; webkitVersion &gt; 535)
                   transformValue += &quot; perspective(2000px)&quot;;
</PRE><PRE>               elmt.style[transformProperty] = transformValue;
           }
       }
   }
</PRE><PRE>   _This.$SetStyleTransform = function (elmt, transform) {
       if (IsBrowserBadTransform()) {
           Delay(_This.$CreateCallback(null, SetStyleTransformInternal, elmt, transform));
       }
       else {
           SetStyleTransformInternal(elmt, transform);
       }
   };
</PRE><PRE>   _This.$SetStyleTransformOrigin = function (elmt, transformOrigin) {
       var transformProperty = GetTransformProperty(elmt);
</PRE><PRE>       if (transformProperty)
           elmt.style[transformProperty + &quot;Origin&quot;] = transformOrigin;
   };
</PRE><PRE>   _This.$CssScale = function (elmt, scale) {
</PRE><PRE>       if (IsBrowserIE() &amp;&amp; browserEngineVersion &lt; 9 || (browserEngineVersion &lt; 10 &amp;&amp; IsBrowserIeQuirks())) {
           elmt.style.zoom = (scale == 1) ? &quot;&quot; : scale;
       }
       else {
           var transformProperty = GetTransformProperty(elmt);
</PRE><PRE>           if (transformProperty) {
               //rotate(15deg) scale(.5)
               var transformValue = &quot;scale(&quot; + scale + &quot;)&quot;;
</PRE><PRE>               var oldTransformValue = elmt.style[transformProperty];
               var scaleReg = new RegExp(/[\s]*scale\(.*?\)/g);
</PRE><PRE>               var newTransformValue = BuildNewCss(oldTransformValue, [scaleReg], transformValue);
</PRE><PRE>               elmt.style[transformProperty] = newTransformValue;
           }
       }
   };
</PRE><PRE>   _This.$EnableHWA = function (elmt) {
       if (!elmt.style[GetTransformProperty(elmt)] || elmt.style[GetTransformProperty(elmt)] == &quot;none&quot;)
           elmt.style[GetTransformProperty(elmt)] = &quot;perspective(2000px)&quot;;
   };
</PRE><PRE>   _This.$DisableHWA = function (elmt) {
       //if (force || elmt.style[GetTransformProperty(elmt)] == &quot;perspective(2000px)&quot;)
       elmt.style[GetTransformProperty(elmt)] = &quot;none&quot;;
   };
</PRE><PRE>   var ie8OffsetWidth = 0;
   var ie8OffsetHeight = 0;
   //var ie8WindowResizeCallbackHandlers;
   //var ie8LastVerticalScrollbar;
   //var toggleInfo = &quot;&quot;;
</PRE><PRE>   //function Ie8WindowResizeFilter(window, handler) {
</PRE><PRE>   //    var trigger = true;
</PRE><PRE>   //    var checkElement = (IsBrowserIeQuirks() ? window.document.body : window.document.documentElement);
   //    if (checkElement) {
   //        //check vertical bar
   //        //var hasVerticalBar = checkElement.scrollHeight &gt; checkElement.clientHeight;
   //        //var verticalBarToggle = hasVerticalBar != ie8LastVerticalScrollbar;
   //        //ie8LastVerticalScrollbar = hasVerticalBar;
</PRE><PRE>   //        var widthChange = checkElement.offsetWidth - ie8OffsetWidth;
   //        var heightChange = checkElement.offsetHeight - ie8OffsetHeight;
   //        if (widthChange || heightChange) {
</PRE><PRE>   //            ie8OffsetWidth += widthChange;
   //            ie8OffsetHeight += heightChange;
   //        }
   //        else
   //            trigger = false;
   //    }
</PRE><PRE>   //    trigger &amp;&amp; handler();
   //}
</PRE><PRE>   //_This.$OnWindowResize = function (window, handler) {
</PRE><PRE>   //    if (IsBrowserIE() &amp;&amp; browserEngineVersion &lt; 9) {
   //        if (!ie8WindowResizeCallbackHandlers) {
   //            ie8WindowResizeCallbackHandlers = [handler];
   //            handler = _This.$CreateCallback(null, Ie8WindowResizeFilter, window);
   //        }
   //        else {
   //            ie8WindowResizeCallbackHandlers.push(handler);
   //            return;
   //        }
   //    }
</PRE><PRE>   //    _This.$AddEvent(window, &quot;resize&quot;, handler);
   //};
</PRE><PRE>   _This.$WindowResizeFilter = function (window, handler) {
       return IsBrowserIe9Earlier() ? function () {
</PRE><PRE>           var trigger = true;
</PRE><PRE>           var checkElement = (IsBrowserIeQuirks() ? window.document.body : window.document.documentElement);
           if (checkElement) {
               //check vertical bar
               //var hasVerticalBar = checkElement.scrollHeight &gt; checkElement.clientHeight;
               //var verticalBarToggle = hasVerticalBar != ie8LastVerticalScrollbar;
               //ie8LastVerticalScrollbar = hasVerticalBar;
</PRE><PRE>               var widthChange = checkElement.offsetWidth - ie8OffsetWidth;
               var heightChange = checkElement.offsetHeight - ie8OffsetHeight;
               if (widthChange || heightChange) {
                   ie8OffsetWidth += widthChange;
                   ie8OffsetHeight += heightChange;
               }
               else
                   trigger = false;
           }
</PRE><PRE>           trigger &amp;&amp; handler();
</PRE><PRE>       } : handler;
   };
</PRE><PRE>   _This.$MouseOverOutFilter = function (handler, target) {
       ///	&lt;param name=&quot;target&quot; type=&quot;HTMLDomElement&quot;&gt;
       ///		The target element to detect mouse over/out events. (for ie &lt; 9 compatibility)
       ///	&lt;/param&gt;</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (!target) {
               throw new Error(&quot;Null reference, parameter \&quot;target\&quot;.&quot;);
           }
       });
</PRE><PRE>       return function (event) {
           event = GetEvent(event);
</PRE><PRE>           var eventName = event.type;
           var related = event.relatedTarget || (eventName == &quot;mouseout&quot; ? event.toElement : event.fromElement);
</PRE><PRE>           if (!related || (related !== target &amp;&amp; !_This.$IsChild(target, related))) {
               handler(event);
           }
       };
   };
</PRE><PRE>   _This.$AddEvent = function (elmt, eventName, handler, useCapture) {
       elmt = _This.$GetElement(elmt);
</PRE><PRE>       // technique from:
       // <A href="http://blog.paranoidferret.com/index.php/2007/08/10/javascript-working-with-events/" class="external free" rel="nofollow">http://blog.paranoidferret.com/index.php/2007/08/10/javascript-working-with-events/</A></PRE><PRE>       if (elmt.addEventListener) {
           if (eventName == &quot;mousewheel&quot;) {
               elmt.addEventListener(&quot;DOMMouseScroll&quot;, handler, useCapture);
           }
           // we are still going to add the mousewheel -- not a mistake!
           // _This is for opera, since it uses onmousewheel but needs addEventListener.
           elmt.addEventListener(eventName, handler, useCapture);
       }
       else if (elmt.attachEvent) {
           elmt.attachEvent(&quot;on&quot; + eventName, handler);
           if (useCapture &amp;&amp; elmt.setCapture) {
               elmt.setCapture();
           }
       }
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (!elmt.addEventListener &amp;&amp; !elmt.attachEvent) {
               $JssorDebug$.$Fail(&quot;Unable to attach event handler, no known technique.&quot;);
           }
       });
</PRE><PRE>   };
</PRE><PRE>   _This.$RemoveEvent = function (elmt, eventName, handler, useCapture) {
       elmt = _This.$GetElement(elmt);
</PRE><PRE>       // technique from:
       // <A href="http://blog.paranoidferret.com/index.php/2007/08/10/javascript-working-with-events/" class="external free" rel="nofollow">http://blog.paranoidferret.com/index.php/2007/08/10/javascript-working-with-events/</A></PRE><PRE>       if (elmt.removeEventListener) {
           if (eventName == &quot;mousewheel&quot;) {
               elmt.removeEventListener(&quot;DOMMouseScroll&quot;, handler, useCapture);
           }
           // we are still going to remove the mousewheel -- not a mistake!
           // _This is for opera, since it uses onmousewheel but needs removeEventListener.
           elmt.removeEventListener(eventName, handler, useCapture);
       }
       else if (elmt.detachEvent) {
           elmt.detachEvent(&quot;on&quot; + eventName, handler);
           if (useCapture &amp;&amp; elmt.releaseCapture) {
               elmt.releaseCapture();
           }
       }
   };
</PRE><PRE>   _This.$FireEvent = function (elmt, eventName) {
       //var document = elmt.document;
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (!document.createEvent &amp;&amp; !document.createEventObject) {
               $JssorDebug$.$Fail(&quot;Unable to fire event, no known technique.&quot;);
           }
</PRE><PRE>           if (!elmt.dispatchEvent &amp;&amp; !elmt.fireEvent) {
               $JssorDebug$.$Fail(&quot;Unable to fire event, no known technique.&quot;);
           }
       });
</PRE><PRE>       var evento;
</PRE><PRE>       if (document.createEvent) {
           evento = document.createEvent(&quot;HTMLEvents&quot;);
           evento.initEvent(eventName, false, false);
           elmt.dispatchEvent(evento);
       }
       else {
           var ieEventName = &quot;on&quot; + eventName;
           evento = document.createEventObject();
           //event.eventType = ieEventName;
           //event.eventName = ieEventName;
</PRE><PRE>           elmt.fireEvent(ieEventName, evento);
       }
   };
</PRE><PRE>   _This.$AddEventBrowserMouseUp = function (handler, userCapture) {
       _This.$AddEvent((IsBrowserIe9Earlier()) ? document : window, &quot;mouseup&quot;, handler, userCapture);
   };
</PRE><PRE>   _This.$RemoveEventBrowserMouseUp = function (handler, userCapture) {
       _This.$RemoveEvent((IsBrowserIe9Earlier()) ? document : window, &quot;mouseup&quot;, handler, userCapture);
   };
</PRE><PRE>   //_This.$AddEventBrowserMouseDown = function (handler, userCapture) {
   //    _This.$AddEvent((IsBrowserIe9Earlier()) ? document : window, &quot;mousedown&quot;, handler, userCapture);
   //};
</PRE><PRE>   //_This.$RemoveEventBrowserMouseDown = function (handler, userCapture) {
   //    _This.$RemoveEvent((IsBrowserIe9Earlier()) ? document : window, &quot;mousedown&quot;, handler, userCapture);
   //};
</PRE><PRE>   _This.$CancelEvent = function (event) {
       event = GetEvent(event);
</PRE><PRE>       // technique from:
       // <A href="http://blog.paranoidferret.com/index.php/2007/08/10/javascript-working-with-events/" class="external free" rel="nofollow">http://blog.paranoidferret.com/index.php/2007/08/10/javascript-working-with-events/</A></PRE><PRE>       if (event.preventDefault) {
           event.preventDefault();     // W3C for preventing default
       }
</PRE><PRE>       event.cancel = true;            // legacy for preventing default
       event.returnValue = false;      // IE for preventing default
   };
</PRE><PRE>   _This.$StopEvent = function (event) {
       event = GetEvent(event);
</PRE><PRE>       // technique from:
       // <A href="http://blog.paranoidferret.com/index.php/2007/08/10/javascript-working-with-events/" class="external free" rel="nofollow">http://blog.paranoidferret.com/index.php/2007/08/10/javascript-working-with-events/</A></PRE><PRE>       if (event.stopPropagation) {
           event.stopPropagation();    // W3C for stopping propagation
       }
</PRE><PRE>       event.cancelBubble = true;      // IE for stopping propagation
   };
</PRE><PRE>   _This.$CreateCallback = function (object, method) {
       // create callback args
       var initialArgs = [].slice.call(arguments, 2);
</PRE><PRE>       // create closure to apply method
       var callback = function () {
           // concatenate new args, but make a copy of initialArgs first
           var args = initialArgs.concat([].slice.call(arguments, 0));
</PRE><PRE>           return method.apply(object, args);
       };
</PRE><PRE>       //$JssorDebug$.$LiveStamp(callback, &quot;callback_&quot; + ($Jssor$.$GetNow() &amp; 0xFFFFFF));
</PRE><PRE>       return callback;
   };
</PRE><PRE>   var _Freeer;
   _This.$FreeElement = function (elmt) {
       if (!_Freeer)
           _Freeer = _This.$CreateDiv();
</PRE><PRE>       if (elmt) {
           $Jssor$.$AppendChild(_Freeer, elmt);
           $Jssor$.$ClearInnerHtml(_Freeer);
       }
   };
</PRE><PRE>   _This.$InnerText = function (elmt, text) {
       if (text == undefined)
           return elmt.textContent || elmt.innerText;
</PRE><PRE>       var textNode = document.createTextNode(text);
       _This.$ClearInnerHtml(elmt);
       elmt.appendChild(textNode);
   };
   
   _This.$InnerHtml = function (elmt, html) {
       if (html == undefined)
           return elmt.innerHTML;
</PRE><PRE>       elmt.innerHTML = html;
   };
</PRE><PRE>   _This.$GetClientRect = function (elmt) {
       var rect = elmt.getBoundingClientRect();
</PRE><PRE>       return { x: rect.left, y: rect.top, w: rect.right - rect.left, h: rect.bottom - rect.top };
   };
</PRE><PRE>   _This.$ClearInnerHtml = function (elmt) {
       elmt.innerHTML = &quot;&quot;;
   };
</PRE><PRE>   _This.$EncodeHtml = function (text) {
       var div = _This.$CreateDiv();
       _This.$InnerText(div, text);
       return _This.$InnerHtml(div);
   };
</PRE><PRE>   _This.$DecodeHtml = function (html) {
       var div = _This.$CreateDiv();
       _This.$InnerHtml(div, html);
       return _This.$InnerText(div);
   };
</PRE><PRE>   _This.$SelectElement = function (elmt) {
       var userSelection;
       if (window.getSelection) {
           //W3C default
           userSelection = window.getSelection();
       }
       var theRange = null;
       if (document.createRange) {
           theRange = document.createRange();
           theRange.selectNode(elmt);
       }
       else {
           theRange = document.body.createTextRange();
           theRange.moveToElementText(elmt);
           theRange.select();
       }
       //set user selection
       if (userSelection)
           userSelection.addRange(theRange);
   };
</PRE><PRE>   _This.$DeselectElements = function () {
       if (document.selection) {
           document.selection.empty();
       } else if (window.getSelection) {
           window.getSelection().removeAllRanges();
       }
   };
</PRE><PRE>   _This.$Children = function (elmt) {
       var children = [];
</PRE><PRE>       for (var tmpEl = elmt.firstChild; tmpEl; tmpEl = tmpEl.nextSibling) {
           if (tmpEl.nodeType == 1) {
               children.push(tmpEl);
           }
       }
</PRE><PRE>       return children;
   };
</PRE><PRE>   function FindFirstChild(elmt, attrValue, attrName, deep) {
       if (!attrName)
           attrName = &quot;u&quot;;
</PRE><PRE>       for (elmt = elmt ? elmt.firstChild : null; elmt; elmt = elmt.nextSibling) {
           if (elmt.nodeType == 1) {
               if (AttributeEx(elmt, attrName) == attrValue)
                   return elmt;
</PRE><PRE>               if (deep) {
                   var childRet = FindFirstChild(elmt, attrValue, attrName, deep);
                   if (childRet)
                       return childRet;
               }
           }
       }
   }
</PRE><PRE>   _This.$FindFirstChild = FindFirstChild;
</PRE><PRE>   function FindChildren(elmt, attrValue, attrName, deep) {
       if (!attrName)
           attrName = &quot;u&quot;;
</PRE><PRE>       var ret = [];
</PRE><PRE>       for (elmt = elmt ? elmt.firstChild : null; elmt; elmt = elmt.nextSibling) {
           if (elmt.nodeType == 1) {
               if (AttributeEx(elmt, attrName) == attrValue)
                   ret.push(elmt);
</PRE><PRE>               if (deep) {
                   var childRet = FindChildren(elmt, attrValue, attrName, deep);
                   if (childRet.length)
                       ret = ret.concat(childRet);
               }
           }
       }
</PRE><PRE>       return ret;
   }
</PRE><PRE>   _This.$FindChildren = FindChildren;
</PRE><PRE>   function FindFirstChildByTag(elmt, tagName, deep) {
</PRE><PRE>       for (elmt = elmt ? elmt.firstChild : null; elmt; elmt = elmt.nextSibling) {
           if (elmt.nodeType == 1) {
               if (elmt.tagName == tagName)
                   return elmt;
</PRE><PRE>               if (deep) {
                   var childRet = FindFirstChildByTag(elmt, tagName, deep);
                   if (childRet)
                       return childRet;
               }
           }
       }
   }
</PRE><PRE>   _This.$FindFirstChildByTag = FindFirstChildByTag;
</PRE><PRE>   function FindChildrenByTag(elmt, tagName, deep) {
       var ret = [];
</PRE><PRE>       for (elmt = elmt ? elmt.firstChild : null; elmt; elmt = elmt.nextSibling) {
           if (elmt.nodeType == 1) {
               if (!tagName || elmt.tagName == tagName)
                   ret.push(elmt);
</PRE><PRE>               if (deep) {
                   var childRet = FindChildrenByTag(elmt, tagName, true);
                   if (childRet.length)
                       ret = ret.concat(childRet);
               }
           }
       }
</PRE><PRE>       return ret;
   }
</PRE><PRE>   _This.$FindChildrenByTag = FindChildrenByTag;
</PRE><PRE>   _This.$GetElementsByTag = function (elmt, tagName) {
       return elmt.getElementsByTagName(tagName);
   };
</PRE><PRE>   function Extend(target) {
       for (var i = 1; i &lt; arguments.length; i++) {
</PRE><PRE>           var options = arguments[i];
</PRE><PRE>           // Only deal with non-null/undefined values
           if (options) {
               // Extend the base object
               for (var name in options) {
                   target[name] = options[name];
               }
           }
       }
</PRE><PRE>       // Return the modified object
       return target;
   }
</PRE><PRE>   _This.$Extend = Extend;
</PRE><PRE>   function Unextend(target, options) {
       $JssorDebug$.$Assert(options);
</PRE><PRE>       var unextended = {};
</PRE><PRE>       // Extend the base object
       for (var name in target) {
           if (target[name] != options[name]) {
               unextended[name] = target[name];
           }
       }
</PRE><PRE>       // Return the modified object
       return unextended;
   }
</PRE><PRE>   _This.$Unextend = Unextend;
</PRE><PRE>   _This.$IsUndefined = function (obj) {
       return type(obj) == &quot;undefined&quot;;
   };
</PRE><PRE>   _This.$IsFunction = function (obj) {
       return type(obj) == &quot;function&quot;;
   };
</PRE><PRE>   _This.$IsArray = function (obj) {
       return type(obj) == &quot;array&quot;;
   };
</PRE><PRE>   _This.$IsString = function (obj) {
       return type(obj) == &quot;string&quot;;
   };
</PRE><PRE>   _This.$IsNumeric = function (obj) {
       return !isNaN(ParseFloat(obj)) &amp;&amp; isFinite(obj);
   };
</PRE><PRE>   _This.$IsWindow = function (obj) {
       return obj &amp;&amp; obj == obj.window;
   };
</PRE><PRE>   _This.$Type = type;
</PRE><PRE>   // args is for internal usage only
   _This.$Each = each;
</PRE><PRE>   _This.$IsPlainObject = isPlainObject;
</PRE><PRE>   function CreateElement(tagName) {
       return document.createElement(tagName);
   }
</PRE><PRE>   _This.$CreateElement = CreateElement;
</PRE><PRE>   _This.$CreateDiv = function () {
       return CreateElement(&quot;DIV&quot;, document);
   };
</PRE><PRE>   _This.$CreateSpan = function () {
       return CreateElement(&quot;SPAN&quot;, document);
   };
</PRE><PRE>   _This.$EmptyFunction = function () { };
</PRE><PRE>   function Attribute(elmt, name, value) {
       if (value == undefined)
           return elmt.getAttribute(name);
</PRE><PRE>       elmt.setAttribute(name, value);
   }
</PRE><PRE>   function AttributeEx(elmt, name) {
       return Attribute(elmt, name) || Attribute(elmt, &quot;data-&quot; + name);
   }
</PRE><PRE>   _This.$Attribute = Attribute;
   _This.$AttributeEx = AttributeEx;
</PRE><PRE>   function ClassName(elmt, className) {
       if (className == undefined)
           return elmt.className;
</PRE><PRE>       elmt.className = className;
   }
</PRE><PRE>   _This.$ClassName = ClassName;
</PRE><PRE>   function ToHash(array) {
       var hash = {};
</PRE><PRE>       each(array, function (item) {
           hash[item] = item;
       });
</PRE><PRE>       return hash;
   }
</PRE><PRE>   _This.$ToHash = ToHash;
</PRE><PRE>   function Join(separator, strings) {
       ///	&lt;param name=&quot;separator&quot; type=&quot;String&quot;&gt;
       ///		The element to show the dialog around
       ///	&lt;/param&gt;
       ///	&lt;param name=&quot;strings&quot; type=&quot;Array&quot; value=&quot;['1']&quot;&gt;
       ///		The element to show the dialog around
       ///	&lt;/param&gt;</PRE><PRE>       var joined = &quot;&quot;;
</PRE><PRE>       each(strings, function (str) {
           joined &amp;&amp; (joined += separator);
           joined += str;
       });
</PRE><PRE>       return joined;
   }
</PRE><PRE>   _This.$Join = Join;
</PRE><PRE>   _This.$AddClass = function (elmt, className) {
       var newClassName = ClassName(elmt) + &quot; &quot; + className;
       ClassName(elmt, Join(&quot; &quot;, ToHash(newClassName.match(REGEX_WHITESPACE_GLOBAL))));
   };
</PRE><PRE>   _This.$RemoveClass = function (elmt, className) {
       ClassName(elmt, Join(&quot; &quot;, _This.$Unextend(ToHash(ClassName(elmt).match(REGEX_WHITESPACE_GLOBAL)), ToHash(className.match(REGEX_WHITESPACE_GLOBAL)))));
   };
</PRE><PRE>   _This.$ParentNode = function (elmt) {
       return elmt.parentNode;
   };
</PRE><PRE>   _This.$HideElement = function (elmt) {
       _This.$CssDisplay(elmt, &quot;none&quot;);
   };
</PRE><PRE>   _This.$HideElements = function (elmts) {
       for (var i = 0; i &lt; elmts.length; i++) {
           _This.$HideElement(elmts[i]);
       }
   };
</PRE><PRE>   _This.$ShowElement = function (elmt, show) {
       _This.$CssDisplay(elmt, show == false ? &quot;none&quot; : &quot;&quot;);
   };
</PRE><PRE>   _This.$ShowElements = function (elmts) {
       for (var i = 0; i &lt; elmts.length; i++) {
           _This.$ShowElement(elmts[i]);
       }
   };
</PRE><PRE>   _This.$RemoveAttribute = function (elmt, attrbuteName) {
       elmt.removeAttribute(attrbuteName);
   };
</PRE><PRE>   _This.$CanClearClip = function () {
       return IsBrowserIE() &amp;&amp; browserRuntimeVersion &lt; 10;
   };
</PRE><PRE>   _This.$SetStyleClip = function (elmt, clip) {
       if (clip) {
           elmt.style.clip = &quot;rect(&quot; + Math.round(clip.$Top) + &quot;px &quot; + Math.round(clip.$Right) + &quot;px &quot; + Math.round(clip.$Bottom) + &quot;px &quot; + Math.round(clip.$Left) + &quot;px)&quot;;
       }
       else {
           var cssText = elmt.style.cssText;
           var clipRegs = [
               new RegExp(/[\s]*clip: rect\(.*?\)[;]?/i),
               new RegExp(/[\s]*cliptop: .*?[;]?/i),
               new RegExp(/[\s]*clipright: .*?[;]?/i),
               new RegExp(/[\s]*clipbottom: .*?[;]?/i),
               new RegExp(/[\s]*clipleft: .*?[;]?/i)
           ];
</PRE><PRE>           var newCssText = BuildNewCss(cssText, clipRegs, &quot;&quot;);
</PRE><PRE>           $Jssor$.$CssCssText(elmt, newCssText);
       }
   };
</PRE><PRE>   _This.$GetNow = function () {
       return new Date().getTime();
   };
</PRE><PRE>   _This.$AppendChild = function (elmt, child) {
       elmt.appendChild(child);
   };
</PRE><PRE>   _This.$AppendChildren = function (elmt, children) {
       each(children, function (child) {
           _This.$AppendChild(elmt, child);
       });
   };
</PRE><PRE>   _This.$InsertBefore = function (elmt, child, refObject) {
       elmt.insertBefore(child, refObject);
   };
</PRE><PRE>   _This.$InsertAdjacentHtml = function (elmt, where, text) {
       elmt.insertAdjacentHTML(where, text);
   };
</PRE><PRE>   _This.$RemoveChild = function (elmt, child) {
       elmt.removeChild(child);
   };
</PRE><PRE>   _This.$RemoveChildren = function (elmt, children) {
       each(children, function (child) {
           _This.$RemoveChild(elmt, child);
       });
   };
</PRE><PRE>   _This.$ClearChildren = function (elmt) {
       _This.$RemoveChildren(elmt, _This.$Children(elmt));
   };
</PRE><PRE>   _This.$ParseInt = function (str, radix) {
       return parseInt(str, radix || 10);
   };
</PRE><PRE>   function ParseFloat(str) {
       return parseFloat(str);
   }
</PRE><PRE>   _This.$ParseFloat = ParseFloat;
</PRE><PRE>   _This.$IsChild = function (elmtA, elmtB) {
       var body = document.body;
       while (elmtB &amp;&amp; elmtA != elmtB &amp;&amp; body != elmtB) {
           try {
               elmtB = elmtB.parentNode;
           } catch (e) {
               // Firefox sometimes fires events for XUL elements, which throws
               // a &quot;permission denied&quot; error. so this is not a child.
               return false;
           }
       }
       return elmtA == elmtB;
   };
</PRE><PRE>   function CloneNode(elmt, deep) {
       return elmt.cloneNode(deep);
   }
</PRE><PRE>   _This.$CloneNode = CloneNode;
</PRE><PRE>   function TranslateTransition(transition) {
       if (transition) {
           var flyDirection = transition.$FlyDirection;
</PRE><PRE>  if (flyDirection &amp; 1) {
               transition.x = transition.$ScaleHorizontal || 1;
           }
           if (flyDirection &amp; 2) {
               transition.x = -transition.$ScaleHorizontal || -1;
           }
           if (flyDirection &amp; 4) {
               transition.y = transition.$ScaleVertical || 1;
           }
           if (flyDirection &amp; 8) {
               transition.y = -transition.$ScaleVertical || -1;
           }
</PRE><PRE>           TranslateTransition(transition.$Brother);
       }
   }
</PRE><PRE>   _This.$TranslateTransitions = function (transitions) {
       ///	&lt;summary&gt;
       ///		For backward compatibility only.
       ///	&lt;/summary&gt;
       if (transitions) {
           for (var i = 0; i &lt; transitions.length; i++) {
               TranslateTransition(transitions[i]);
           }
           for (var name in transitions) {
               TranslateTransition(transitions[name]);
           }
       }
   };
</PRE><PRE>   function LoadImageCallback(callback, image, abort) {
       image.onload = null;
       image.abort = null;
</PRE><PRE>       if (callback)
           callback(image, abort);
   }
</PRE><PRE>   _This.$LoadImage = function (src, callback) {
       if (IsBrowserOpera() &amp;&amp; browserRuntimeVersion &lt; 11.6 || !src) {
           LoadImageCallback(callback, null);
       }
       else {
           var image = new Image();
           image.onload = _This.$CreateCallback(null, LoadImageCallback, callback, image);
           image.onabort = _This.$CreateCallback(null, LoadImageCallback, callback, image, true);
           image.src = src;
       }
   };
</PRE><PRE>   _This.$LoadImages = function (imageElmts, mainImageElmt, callback) {
</PRE><PRE>       var _ImageLoading = imageElmts.length + 1;
</PRE><PRE>       function LoadImageCompleteEventHandler(image, abort) {
           _ImageLoading--;
           if (mainImageElmt &amp;&amp; image &amp;&amp; image.src == mainImageElmt.src)
               mainImageElmt = image;
           !_ImageLoading &amp;&amp; callback &amp;&amp; callback(mainImageElmt);
       }
</PRE><PRE>       each(imageElmts, function (imageElmt) {
           $Jssor$.$LoadImage(imageElmt.src, LoadImageCompleteEventHandler);
       });
</PRE><PRE>       LoadImageCompleteEventHandler();
   };
</PRE><PRE>   _This.$BuildElement = function (template, tagName, replacer, createCopy) {
       if (createCopy)
           template = CloneNode(template, true);
</PRE><PRE>       var templateHolders = $Jssor$.$GetElementsByTag(template, tagName);
       for (var j = templateHolders.length - 1; j &gt; -1; j--) {
           var templateHolder = templateHolders[j];
           var replaceItem = CloneNode(replacer, true);
           ClassName(replaceItem, ClassName(templateHolder));
           $Jssor$.$CssCssText(replaceItem, templateHolder.style.cssText);
</PRE><PRE>           var thumbnailPlaceHolderParent = $Jssor$.$ParentNode(templateHolder);
           $Jssor$.$InsertBefore(thumbnailPlaceHolderParent, replaceItem, templateHolder);
           $Jssor$.$RemoveChild(thumbnailPlaceHolderParent, templateHolder);
       }
</PRE><PRE>       return template;
   };
</PRE><PRE>   var _MouseDownButtons;
   function JssorButtonEx(elmt) {
       var _Self = this;
</PRE><PRE>       var _OriginClassName;
</PRE><PRE>       var _IsMouseDown;   //class name 'dn'
       var _IsActive;      //class name 'av'
       var _IsDisabled;    //class name 'ds'
</PRE><PRE>       function Highlight() {
           var className = _OriginClassName;
</PRE><PRE>           if (_IsDisabled) {
               className += 'ds';
           }
           else if (_IsMouseDown) {
               className += 'dn';
           }
           else if (_IsActive) {
               className += &quot;av&quot;;
           }
</PRE><PRE>           ClassName(elmt, className);
       }
</PRE><PRE>       function OnMouseDown(event) {
           if (_IsDisabled) {
               _This.$CancelEvent(event);
           }
           else {
               _MouseDownButtons.push(_Self);
</PRE><PRE>               _IsMouseDown = true;
</PRE><PRE>               Highlight();
           }
       }
</PRE><PRE>       _Self.$MouseUp = function () {
           ///	&lt;summary&gt;
           ///		Internal member function, do not use it.
           ///	&lt;/summary&gt;
           ///	&lt;private /&gt;</PRE><PRE>           _IsMouseDown = false;
</PRE><PRE>           Highlight();
       };
</PRE><PRE>       _Self.$Activate = function (activate) {
           if (activate != undefined) {
               _IsActive = activate;
</PRE><PRE>               Highlight();
           }
           else {
               return _IsActive;
           }
       };
</PRE><PRE>       _Self.$Enable = function (enable) {
           if (enable != undefined) {
               _IsDisabled = !enable;
</PRE><PRE>               Highlight();
           }
           else {
               return !_IsDisabled;
           }
       };
</PRE><PRE>       //JssorButtonEx Constructor
       {
           elmt = _This.$GetElement(elmt);
</PRE><PRE>           if (!_MouseDownButtons) {
               _This.$AddEventBrowserMouseUp(function () {
                   var oldMouseDownButtons = _MouseDownButtons;
                   _MouseDownButtons = [];
</PRE><PRE>                   each(oldMouseDownButtons, function (button) {
                       button.$MouseUp();
                   });
               });
</PRE><PRE>               _MouseDownButtons = [];
           }
</PRE><PRE>           _OriginClassName = ClassName(elmt);
</PRE><PRE>           $Jssor$.$AddEvent(elmt, &quot;mousedown&quot;, OnMouseDown);
       }
   }
</PRE><PRE>   _This.$Buttonize = function (elmt) {
       return new JssorButtonEx(elmt);
   };
</PRE><PRE>   _This.$Css = Css;
   _This.$CssN = CssN;
   _This.$CssP = CssP;
</PRE><PRE>   _This.$CssOverflow = CssProxy(&quot;overflow&quot;);
</PRE><PRE>   _This.$CssTop = CssProxy(&quot;top&quot;, 2);
   _This.$CssLeft = CssProxy(&quot;left&quot;, 2);
   _This.$CssWidth = CssProxy(&quot;width&quot;, 2);
   _This.$CssHeight = CssProxy(&quot;height&quot;, 2);
   _This.$CssMarginLeft = CssProxy(&quot;marginLeft&quot;, 2);
   _This.$CssMarginTop = CssProxy(&quot;marginTop&quot;, 2);
   _This.$CssPosition = CssProxy(&quot;position&quot;);
   _This.$CssDisplay = CssProxy(&quot;display&quot;);
   _This.$CssZIndex = CssProxy(&quot;zIndex&quot;, 1);
   _This.$CssFloat = function (elmt, float) {
       return Css(elmt, IsBrowserIE() ? &quot;styleFloat&quot; : &quot;cssFloat&quot;, float);
   };
   _This.$CssOpacity = function (elmt, opacity, ie9EarlierForce) {
       if (opacity != undefined) {
           SetStyleOpacity(elmt, opacity, ie9EarlierForce);
       }
       else {
           return GetStyleOpacity(elmt);
       }
   };
   _This.$CssCssText = function (elmt, text) {
       if (text != undefined) {
           elmt.style.cssText = text;
       }
       else {
           return elmt.style.cssText;
       }
   };
</PRE><PRE>   var _StyleGetter = {
       $Opacity: _This.$CssOpacity,
       $Top: _This.$CssTop,
       $Left: _This.$CssLeft,
       $Width: _This.$CssWidth,
       $Height: _This.$CssHeight,
       $Position: _This.$CssPosition,
       $Display: _This.$CssDisplay,
       $ZIndex: _This.$CssZIndex
   };
</PRE><PRE>   //var _StyleGetter = {
   //    $Opacity: _This.$GetStyleOpacity,
   //    $Top: _This.$GetStyleTop,
   //    $Left: _This.$GetStyleLeft,
   //    $Width: _This.$GetStyleWidth,
   //    $Height: _This.$GetStyleHeight,
   //    $Position: _This.$GetStylePosition,
   //    $Display: _This.$GetStyleDisplay,
   //    $ZIndex: _This.$GetStyleZIndex
   //};
</PRE><PRE>   var _StyleSetterReserved;
</PRE><PRE>   //var _StyleSetterReserved = {
   //    $Opacity: _This.$SetStyleOpacity,
   //    $Top: _This.$SetStyleTop,
   //    $Left: _This.$SetStyleLeft,
   //    $Width: _This.$SetStyleWidth,
   //    $Height: _This.$SetStyleHeight,
   //    $Display: _This.$SetStyleDisplay,
   //    $Clip: _This.$SetStyleClip,
   //    $MarginLeft: _This.$SetStyleMarginLeft,
   //    $MarginTop: _This.$SetStyleMarginTop,
   //    $Transform: _This.$SetStyleTransform,
   //    $Position: _This.$SetStylePosition,
   //    $ZIndex: _This.$SetStyleZIndex
   //};
</PRE><PRE>   function StyleSetter() {
       if (!_StyleSetterReserved) {
           _StyleSetterReserved = Extend({
               $MarginTop: _This.$CssMarginTop,
               $MarginLeft: _This.$CssMarginLeft,
               $Clip: _This.$SetStyleClip,
               $Transform: _This.$SetStyleTransform
           }, _StyleGetter);
       }
       return _StyleSetterReserved;
   }
</PRE><PRE>   function StyleSetterEx() {
       StyleSetter();
</PRE><PRE>       //For Compression Only
       _StyleSetterReserved.$Transform = _StyleSetterReserved.$Transform;
</PRE><PRE>       return _StyleSetterReserved;
   }
</PRE><PRE>   _This.$StyleSetter = StyleSetter;
</PRE><PRE>   _This.$StyleSetterEx = StyleSetterEx;
</PRE><PRE>   _This.$GetStyles = function (elmt, originStyles) {
       StyleSetter();
</PRE><PRE>       var styles = {};
</PRE><PRE>       each(originStyles, function (value, key) {
           if (_StyleGetter[key]) {
               styles[key] = _StyleGetter[key](elmt);
           }
       });
</PRE><PRE>       return styles;
   };
</PRE><PRE>   _This.$SetStyles = function (elmt, styles) {
       var styleSetter = StyleSetter();
</PRE><PRE>       each(styles, function (value, key) {
           styleSetter[key] &amp;&amp; styleSetter[key](elmt, value);
       });
   };
</PRE><PRE>   _This.$SetStylesEx = function (elmt, styles) {
       StyleSetterEx();
</PRE><PRE>       _This.$SetStyles(elmt, styles);
   };
</PRE><PRE>   $JssorMatrix$ = new function () {
       var _ThisMatrix = this;
</PRE><PRE>       function Multiply(ma, mb) {
           var acs = ma[0].length;
           var rows = ma.length;
           var cols = mb[0].length;
</PRE><PRE>           var matrix = [];
</PRE><PRE>           for (var r = 0; r &lt; rows; r++) {
               var row = matrix[r] = [];
               for (var c = 0; c &lt; cols; c++) {
                   var unitValue = 0;
</PRE><PRE>                   for (var ac = 0; ac &lt; acs; ac++) {
                       unitValue += ma[r][ac] * mb[ac][c];
                   }
</PRE><PRE>                   row[c] = unitValue;
               }
           }
</PRE><PRE>           return matrix;
       }
</PRE><PRE>       _ThisMatrix.$ScaleX = function (matrix, sx) {
           return _ThisMatrix.$ScaleXY(matrix, sx, 0);
       };
</PRE><PRE>       _ThisMatrix.$ScaleY = function (matrix, sy) {
           return _ThisMatrix.$ScaleXY(matrix, 0, sy);
       };
</PRE><PRE>       _ThisMatrix.$ScaleXY = function (matrix, sx, sy) {
           return Multiply(matrix, [[sx, 0], [0, sy]]);
       };
</PRE><PRE>       _ThisMatrix.$TransformPoint = function (matrix, p) {
           var pMatrix = Multiply(matrix, [[p.x], [p.y]]);
</PRE><PRE>           return new $JssorPoint$(pMatrix[0][0], pMatrix[1][0]);
       };
   };
</PRE><PRE>   _This.$CreateMatrix = function (alpha, scaleX, scaleY) {
       var cos = Math.cos(alpha);
       var sin = Math.sin(alpha);
       //var r11 = cos;
       //var r21 = sin;
       //var r12 = -sin;
       //var r22 = cos;
</PRE><PRE>       //var m11 = cos * scaleX;
       //var m12 = -sin * scaleY;
       //var m21 = sin * scaleX;
       //var m22 = cos * scaleY;
</PRE><PRE>       return [[cos * scaleX, -sin * scaleY], [sin * scaleX, cos * scaleY]];
   };
</PRE><PRE>   _This.$GetMatrixOffset = function (matrix, width, height) {
       var p1 = $JssorMatrix$.$TransformPoint(matrix, new $JssorPoint$(-width / 2, -height / 2));
       var p2 = $JssorMatrix$.$TransformPoint(matrix, new $JssorPoint$(width / 2, -height / 2));
       var p3 = $JssorMatrix$.$TransformPoint(matrix, new $JssorPoint$(width / 2, height / 2));
       var p4 = $JssorMatrix$.$TransformPoint(matrix, new $JssorPoint$(-width / 2, height / 2));
</PRE><PRE>       return new $JssorPoint$(Math.min(p1.x, p2.x, p3.x, p4.x) + width / 2, Math.min(p1.y, p2.y, p3.y, p4.y) + height / 2);
   };
</PRE><PRE>   _This.$Transform = function (fromStyles, toStyles, interPosition, easings, durings, rounds, options) {
</PRE><PRE>       var currentStyles = toStyles;
</PRE><PRE>       if (fromStyles) {
           currentStyles = {};
</PRE><PRE>           for (var key in toStyles) {
               var round = rounds[key] || 1;
               var during = durings[key] || [0, 1];
               var propertyInterPosition = (interPosition - during[0]) / during[1];
               propertyInterPosition = Math.min(Math.max(propertyInterPosition, 0), 1);
               propertyInterPosition = propertyInterPosition * round;
               var floorPosition = Math.floor(propertyInterPosition);
               if (propertyInterPosition != floorPosition)
                   propertyInterPosition -= floorPosition;
</PRE><PRE>               var easing = easings[key] || easings.$Default;
               var easingValue = easing(propertyInterPosition);
               var currentPropertyValue;
               var value = fromStyles[key];
               var toValue = toStyles[key];
</PRE><PRE>               if ($Jssor$.$IsNumeric(toValue)) {
                   currentPropertyValue = value + (toValue - value) * easingValue;
               }
               else {
                   currentPropertyValue = $Jssor$.$Extend({ $Offset: {} }, fromStyles[key]);
</PRE><PRE>                   $Jssor$.$Each(toValue.$Offset, function (rectX, n) {
                       var offsetValue = rectX * easingValue;
                       currentPropertyValue.$Offset[n] = offsetValue;
                       currentPropertyValue[n] += offsetValue;
                   });
               }
               currentStyles[key] = currentPropertyValue;
           }
</PRE><PRE>           if (fromStyles.$Zoom) {
               currentStyles.$Transform = { $Rotate: currentStyles.$Rotate || 0, $Scale: currentStyles.$Zoom, $OriginalWidth: options.$OriginalWidth, $OriginalHeight: options.$OriginalHeight };
           }
       }
</PRE><PRE>       if (toStyles.$Clip &amp;&amp; options.$Move) {
           var styleFrameNClipOffset = currentStyles.$Clip.$Offset;
</PRE><PRE>           var offsetY = (styleFrameNClipOffset.$Top || 0) + (styleFrameNClipOffset.$Bottom || 0);
           var offsetX = (styleFrameNClipOffset.$Left || 0) + (styleFrameNClipOffset.$Right || 0);
</PRE><PRE>           currentStyles.$Left = (currentStyles.$Left || 0) + offsetX;
           currentStyles.$Top = (currentStyles.$Top || 0) + offsetY;
           currentStyles.$Clip.$Left -= offsetX;
           currentStyles.$Clip.$Right -= offsetX;
           currentStyles.$Clip.$Top -= offsetY;
           currentStyles.$Clip.$Bottom -= offsetY;
       }
</PRE><PRE>       if (currentStyles.$Clip &amp;&amp; $Jssor$.$CanClearClip() &amp;&amp; !currentStyles.$Clip.$Top &amp;&amp; !currentStyles.$Clip.$Left &amp;&amp; (currentStyles.$Clip.$Right == options.$OriginalWidth) &amp;&amp; (currentStyles.$Clip.$Bottom == options.$OriginalHeight))
           currentStyles.$Clip = null;
</PRE><PRE>       return currentStyles;
   };
</PRE><P>};
</P><P>//$JssorObject$
var $JssorObject$ = window.$JssorObject$ = function () {
</P><PRE>   var _ThisObject = this;
   // Fields
</PRE><PRE>   var _Listeners = []; // dictionary of eventName --&gt; array of handlers
   var _Listenees = [];
</PRE><PRE>   // Private Methods
   function AddListener(eventName, handler) {
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (eventName == undefined || eventName == null)
               throw new Error(&quot;param 'eventName' is null or empty.&quot;);
</PRE><PRE>           if (typeof (handler) != &quot;function&quot;) {
               throw &quot;param 'handler' must be a function.&quot;;
           }
</PRE><PRE>           $Jssor$.$Each(_Listeners, function (listener) {
               if (listener.$EventName == eventName &amp;&amp; listener.$Handler === handler) {
                   throw new Error(&quot;The handler listened to the event already, cannot listen to the same event of the same object with the same handler twice.&quot;);
               }
           });
       });
</PRE><PRE>       _Listeners.push({ $EventName: eventName, $Handler: handler });
   }
</PRE><PRE>   function RemoveListener(eventName, handler) {
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (eventName == undefined || eventName == null)
               throw new Error(&quot;param 'eventName' is null or empty.&quot;);
</PRE><PRE>           if (typeof (handler) != &quot;function&quot;) {
               throw &quot;param 'handler' must be a function.&quot;;
           }
       });
</PRE><PRE>       $Jssor$.$Each(_Listeners, function (listener, index) {
           if (listener.$EventName == eventName &amp;&amp; listener.$Handler === handler) {
               _Listeners.splice(index, 1);
           }
       });
   }
</PRE><PRE>   function ClearListeners() {
       _Listeners = [];
   }
</PRE><PRE>   function ClearListenees() {
</PRE><PRE>       $Jssor$.$Each(_Listenees, function (listenee) {
           $Jssor$.$RemoveEvent(listenee.$Obj, listenee.$EventName, listenee.$Handler);
       });
</PRE><PRE>       _Listenees = [];
   }
</PRE><PRE>   //Protected Methods
   _ThisObject.$Listen = function (obj, eventName, handler, useCapture) {
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (!obj)
               throw new Error(&quot;param 'obj' is null or empty.&quot;);
</PRE><PRE>           if (eventName == undefined || eventName == null)
               throw new Error(&quot;param 'eventName' is null or empty.&quot;);
</PRE><PRE>           if (typeof (handler) != &quot;function&quot;) {
               throw &quot;param 'handler' must be a function.&quot;;
           }
</PRE><PRE>           $Jssor$.$Each(_Listenees, function (listenee) {
               if (listenee.$Obj === obj &amp;&amp; listenee.$EventName == eventName &amp;&amp; listenee.$Handler === handler) {
                   throw new Error(&quot;The handler listened to the event already, cannot listen to the same event of the same object with the same handler twice.&quot;);
               }
           });
       });
</PRE><PRE>       $Jssor$.$AddEvent(obj, eventName, handler, useCapture);
       _Listenees.push({ $Obj: obj, $EventName: eventName, $Handler: handler });
   };
</PRE><PRE>   _ThisObject.$Unlisten = function (obj, eventName, handler) {
</PRE><PRE>       $JssorDebug$.$Execute(function () {
           if (!obj)
               throw new Error(&quot;param 'obj' is null or empty.&quot;);
</PRE><PRE>           if (eventName == undefined || eventName == null)
               throw new Error(&quot;param 'eventName' is null or empty.&quot;);
</PRE><PRE>           if (typeof (handler) != &quot;function&quot;) {
               throw &quot;param 'handler' must be a function.&quot;;
           }
       });
</PRE><PRE>       $Jssor$.$Each(_Listenees, function (listenee, index) {
           if (listenee.$Obj === obj &amp;&amp; listenee.$EventName == eventName &amp;&amp; listenee.$Handler === handler) {
               $Jssor$.$RemoveEvent(obj, eventName, handler);
               _Listenees.splice(index, 1);
           }
       });
   };
</PRE><PRE>   _ThisObject.$UnlistenAll = ClearListenees;
</PRE><PRE>   // Public Methods
   _ThisObject.$On = _ThisObject.addEventListener = AddListener;
</PRE><PRE>   _ThisObject.$Off = _ThisObject.removeEventListener = RemoveListener;
</PRE><PRE>   _ThisObject.$TriggerEvent = function (eventName) {
</PRE><PRE>       var args = [].slice.call(arguments, 1);
</PRE><PRE>       $Jssor$.$Each(_Listeners, function (listener) {
           try {
               listener.$EventName == eventName &amp;&amp; listener.$Handler.apply(window, args);
           } catch (e) {
               // handler threw an error, ignore, go on to next one
               $JssorDebug$.$Error(e.name + &quot; while executing &quot; + eventName +
                       &quot; handler: &quot; + e.message, e);
           }
       });
   };
</PRE><PRE>   _ThisObject.$Destroy = function () {
       ClearListenees();
       ClearListeners();
</PRE><PRE>       for (var name in _ThisObject)
           delete _ThisObject[name];
   };
</PRE><PRE>   $JssorDebug$.$C_AbstractClass(_ThisObject);
</PRE><P>};
</P><P>$JssorAnimator$ = function (delay, duration, options, elmt, fromStyles, toStyles) {
</P><PRE>   delay = delay || 0;
</PRE><PRE>   var _ThisAnimator = this;
   var _AutoPlay;
   var _Hiden;
   var _CombineMode;
   var _PlayToPosition;
   var _PlayDirection;
   var _NoStop;
   var _TimeStampLastFrame = 0;
</PRE><PRE>   var _SubEasings;
   var _SubRounds;
   var _SubDurings;
   var _Callback;
</PRE><PRE>   var _Position_Current = 0;
   var _Position_Display = 0;
   var _Hooked;
</PRE><PRE>   var _Position_InnerBegin = delay;
   var _Position_InnerEnd = delay + duration;
   var _Position_OuterBegin;
   var _Position_OuterEnd;
   var _LoopLength;
</PRE><PRE>   var _NestedAnimators = [];
   var _StyleSetter;
</PRE><PRE>   function GetPositionRange(position, begin, end) {
       var range = 0;
</PRE><PRE>       if (position &lt; begin)
           range = -1;
</PRE><PRE>       else if (position &gt; end)
           range = 1;
</PRE><PRE>       return range;
   }
</PRE><PRE>   function GetInnerPositionRange(position) {
       return GetPositionRange(position, _Position_InnerBegin, _Position_InnerEnd);
   }
</PRE><PRE>   function GetOuterPositionRange(position) {
       return GetPositionRange(position, _Position_OuterBegin, _Position_OuterEnd);
   }
</PRE><PRE>   function Shift(offset) {
       _Position_OuterBegin += offset;
       _Position_OuterEnd += offset;
       _Position_InnerBegin += offset;
       _Position_InnerEnd += offset;
</PRE><PRE>       _Position_Current += offset;
       _Position_Display += offset;
</PRE><PRE>       $Jssor$.$Each(_NestedAnimators, function (animator) {
           animator, animator.$Shift(offset);
       });
   }
</PRE><PRE>   function Locate(position, relative) {
       var offset = position - _Position_OuterBegin + delay * relative;
</PRE><PRE>       Shift(offset);
</PRE><PRE>       //$JssorDebug$.$Execute(function () {
       //    _ThisAnimator.$Position_InnerBegin = _Position_InnerBegin;
       //    _ThisAnimator.$Position_InnerEnd = _Position_InnerEnd;
       //    _ThisAnimator.$Position_OuterBegin = _Position_OuterBegin;
       //    _ThisAnimator.$Position_OuterEnd = _Position_OuterEnd;
       //});
</PRE><PRE>       return _Position_OuterEnd;
   }
</PRE><PRE>   function GoToPosition(positionOuter, force) {
       var trimedPositionOuter = positionOuter;
</PRE><PRE>       if (_LoopLength &amp;&amp; (trimedPositionOuter &gt;= _Position_OuterEnd || trimedPositionOuter &lt;= _Position_OuterBegin)) {
           trimedPositionOuter = ((trimedPositionOuter - _Position_OuterBegin) % _LoopLength + _LoopLength) % _LoopLength + _Position_OuterBegin;
       }
</PRE><PRE>       if (!_Hooked || _NoStop || force || _Position_Current != trimedPositionOuter) {
</PRE><PRE>           var positionToDisplay = Math.min(trimedPositionOuter, _Position_OuterEnd);
           positionToDisplay = Math.max(positionToDisplay, _Position_OuterBegin);
</PRE><PRE>           if (!_Hooked || _NoStop || force || positionToDisplay != _Position_Display) {
               if (toStyles) {
</PRE><PRE>                   var interPosition = (positionToDisplay - _Position_InnerBegin) / (duration || 1);
</PRE><PRE>                   if (options.$Optimize &amp;&amp; $Jssor$.$IsBrowserChrome() &amp;&amp; duration) {
                       interPosition = Math.round(interPosition / 16 * duration) * 16 / duration;
                   }
</PRE><PRE>                   if (options.$Reverse)
                       interPosition = 1 - interPosition;
</PRE><PRE>                   var currentStyles = $Jssor$.$Transform(fromStyles, toStyles, interPosition, _SubEasings, _SubDurings, _SubRounds, options);
</PRE><PRE>                   $Jssor$.$Each(currentStyles, function (value, key) {
                       _StyleSetter[key] &amp;&amp; _StyleSetter[key](elmt, value);
                   });
               }
</PRE><PRE>               _ThisAnimator.$OnInnerOffsetChange(_Position_Display - _Position_InnerBegin, positionToDisplay - _Position_InnerBegin);
           }
</PRE><PRE>           _Position_Display = positionToDisplay;
</PRE><PRE>           $Jssor$.$Each(_NestedAnimators, function (animator, i) {
               var nestedAnimator = positionOuter &lt; _Position_Current ? _NestedAnimators[_NestedAnimators.length - i - 1] : animator;
               nestedAnimator.$GoToPosition(positionOuter, force);
           });
</PRE><PRE>           var positionOld = _Position_Current;
           var positionNew = positionOuter;
</PRE><PRE>           _Position_Current = trimedPositionOuter;
           _Hooked = true;
</PRE><PRE>           _ThisAnimator.$OnPositionChange(positionOld, positionNew);
       }
   }
</PRE><PRE>   function Join(animator, combineMode) {
       ///	&lt;summary&gt;
       ///		Combine another animator as nested animator
       ///	&lt;/summary&gt;
       ///	&lt;param name=&quot;animator&quot; type=&quot;$JssorAnimator$&quot;&gt;
       ///		An instance of $JssorAnimator$
       ///	&lt;/param&gt;
       ///	&lt;param name=&quot;combineMode&quot; type=&quot;int&quot;&gt;
       ///		0: parallel - place the animator parallel to this animator.
       ///		1: chain - chain the animator at the _Position_InnerEnd of this animator.
       ///	&lt;/param&gt;
       $JssorDebug$.$Execute(function () {
           if (combineMode !== 0 &amp;&amp; combineMode !== 1)
               $JssorDebug$.$Fail(&quot;Argument out of range, the value of 'combineMode' should be either 0 or 1.&quot;);
       });
</PRE><PRE>       if (combineMode)
           animator.$Locate(_Position_OuterEnd, 1);
</PRE><PRE>       _Position_OuterEnd = Math.max(_Position_OuterEnd, animator.$GetPosition_OuterEnd());
       _NestedAnimators.push(animator);
   }
</PRE><PRE>   function PlayFrame() {
       if (_AutoPlay) {
           var now = $Jssor$.$GetNow();
           //var timeOffset = Math.min(now - _TimeStampLastFrame, $Jssor$.$IsBrowserOpera() ? 80 : 20);
           var timeOffset = Math.min(now - _TimeStampLastFrame, 80);
           var timePosition = _Position_Current + timeOffset * _PlayDirection;
           _TimeStampLastFrame = now;
</PRE><PRE>           if (timePosition * _PlayDirection &gt;= _PlayToPosition * _PlayDirection)
               timePosition = _PlayToPosition;
</PRE><PRE>           GoToPosition(timePosition);
</PRE><PRE>           if (!_NoStop &amp;&amp; timePosition * _PlayDirection &gt;= _PlayToPosition * _PlayDirection) {
               Stop(_Callback);
           }
           else {
               $Jssor$.$Delay(PlayFrame, options.$Interval);
           }
       }
   }
</PRE><PRE>   function PlayToPosition(toPosition, callback, noStop) {
       if (!_AutoPlay) {
           _AutoPlay = true;
           _NoStop = noStop
           _Callback = callback;
           toPosition = Math.max(toPosition, _Position_OuterBegin);
           toPosition = Math.min(toPosition, _Position_OuterEnd);
           _PlayToPosition = toPosition;
           _PlayDirection = _PlayToPosition &lt; _Position_Current ? -1 : 1;
           _ThisAnimator.$OnStart();
           _TimeStampLastFrame = $Jssor$.$GetNow();
           PlayFrame();
       }
   }
</PRE><PRE>   function Stop(callback) {
       if (_AutoPlay) {
           _NoStop = _AutoPlay = _Callback = false;
           _ThisAnimator.$OnStop();
</PRE><PRE>           if (callback)
               callback();
       }
   }
</PRE><PRE>   _ThisAnimator.$Play = function (positionLength, callback, noStop) {
       PlayToPosition(positionLength ? _Position_Current + positionLength : _Position_OuterEnd, callback, noStop);
   };
</PRE><PRE>   _ThisAnimator.$PlayToPosition = PlayToPosition;
</PRE><PRE>   _ThisAnimator.$PlayToBegin = function (callback, noStop) {
       PlayToPosition(_Position_OuterBegin, callback, noStop);
   };
</PRE><PRE>   _ThisAnimator.$PlayToEnd = function (callback, noStop) {
       PlayToPosition(_Position_OuterEnd, callback, noStop);
   };
</PRE><PRE>   _ThisAnimator.$Stop = Stop;
</PRE><PRE>   _ThisAnimator.$Continue = function (toPosition) {
       PlayToPosition(toPosition);
   };
</PRE><PRE>   _ThisAnimator.$GetPosition = function () {
       return _Position_Current;
   };
</PRE><PRE>   _ThisAnimator.$GetPlayToPosition = function () {
       return _PlayToPosition;
   };
</PRE><PRE>   _ThisAnimator.$GetPosition_Display = function () {
       return _Position_Display;
   };
</PRE><PRE>   _ThisAnimator.$GoToPosition = GoToPosition;
</PRE><PRE>   _ThisAnimator.$GoToBegin = function () {
       GoToPosition(_Position_OuterBegin, true);
   };
</PRE><PRE>   _ThisAnimator.$GoToEnd = function () {
       GoToPosition(_Position_OuterEnd, true);
   };
</PRE><PRE>   _ThisAnimator.$Move = function (offset) {
       GoToPosition(_Position_Current + offset);
   };
</PRE><PRE>   _ThisAnimator.$CombineMode = function () {
       return _CombineMode;
   };
</PRE><PRE>   _ThisAnimator.$GetDuration = function () {
       return duration;
   };
</PRE><PRE>   _ThisAnimator.$IsPlaying = function () {
       return _AutoPlay;
   };
</PRE><PRE>   _ThisAnimator.$IsOnTheWay = function () {
       return _Position_Current &gt; _Position_InnerBegin &amp;&amp; _Position_Current &lt;= _Position_InnerEnd;
   };
</PRE><PRE>   _ThisAnimator.$SetLoopLength = function (length) {
       _LoopLength = length;
   };
</PRE><PRE>   _ThisAnimator.$Locate = Locate;
</PRE><PRE>   _ThisAnimator.$Shift = Shift;
</PRE><PRE>   _ThisAnimator.$Join = Join;
</PRE><PRE>   _ThisAnimator.$Combine = function (animator) {
       ///	&lt;summary&gt;
       ///		Combine another animator parallel to this animator
       ///	&lt;/summary&gt;
       ///	&lt;param name=&quot;animator&quot; type=&quot;$JssorAnimator$&quot;&gt;
       ///		An instance of $JssorAnimator$
       ///	&lt;/param&gt;
       Join(animator, 0);
   };
</PRE><PRE>   _ThisAnimator.$Chain = function (animator) {
       ///	&lt;summary&gt;
       ///		Chain another animator at the _Position_InnerEnd of this animator
       ///	&lt;/summary&gt;
       ///	&lt;param name=&quot;animator&quot; type=&quot;$JssorAnimator$&quot;&gt;
       ///		An instance of $JssorAnimator$
       ///	&lt;/param&gt;
       Join(animator, 1);
   };
</PRE><PRE>   _ThisAnimator.$GetPosition_InnerBegin = function () {
       ///	&lt;summary&gt;
       ///		Internal member function, do not use it.
       ///	&lt;/summary&gt;
       ///	&lt;private /&gt;
       ///	&lt;returns type=&quot;int&quot; /&gt;
       return _Position_InnerBegin;
   };
</PRE><PRE>   _ThisAnimator.$GetPosition_InnerEnd = function () {
       ///	&lt;summary&gt;
       ///		Internal member function, do not use it.
       ///	&lt;/summary&gt;
       ///	&lt;private /&gt;
       ///	&lt;returns type=&quot;int&quot; /&gt;
       return _Position_InnerEnd;
   };
</PRE><PRE>   _ThisAnimator.$GetPosition_OuterBegin = function () {
       ///	&lt;summary&gt;
       ///		Internal member function, do not use it.
       ///	&lt;/summary&gt;
       ///	&lt;private /&gt;
       ///	&lt;returns type=&quot;int&quot; /&gt;
       return _Position_OuterBegin;
   };
</PRE><PRE>   _ThisAnimator.$GetPosition_OuterEnd = function () {
       ///	&lt;summary&gt;
       ///		Internal member function, do not use it.
       ///	&lt;/summary&gt;
       ///	&lt;private /&gt;
       ///	&lt;returns type=&quot;int&quot; /&gt;
       return _Position_OuterEnd;
   };
</PRE><PRE>   _ThisAnimator.$OnPositionChange = _ThisAnimator.$OnStart = _ThisAnimator.$OnStop = _ThisAnimator.$OnInnerOffsetChange = $Jssor$.$EmptyFunction;
   _ThisAnimator.$Version = $Jssor$.$GetNow();
</PRE><PRE>   //Constructor  1
   {
       options = $Jssor$.$Extend({
           $Interval: 15
       }, options);
</PRE><PRE>       //Sodo statement, for development time intellisence only
       $JssorDebug$.$Execute(function () {
           options = $Jssor$.$Extend({
               $LoopLength: undefined,
               $Setter: undefined,
               $Easing: undefined
           }, options);
       });
</PRE><PRE>       _LoopLength = options.$LoopLength;
</PRE><PRE>       _StyleSetter = $Jssor$.$Extend({}, $Jssor$.$StyleSetter(), options.$Setter);
</PRE><PRE>       _Position_OuterBegin = _Position_InnerBegin = delay;
       _Position_OuterEnd = _Position_InnerEnd = delay + duration;
</PRE><PRE>       var _SubRounds = options.$Round || {};
       var _SubDurings = options.$During || {};
       _SubEasings = $Jssor$.$Extend({ $Default: $Jssor$.$IsFunction(options.$Easing) &amp;&amp; options.$Easing || $JssorEasing$.$EaseSwing }, options.$Easing);
   }
</PRE><P>};
</P><P>function $JssorPlayerClass$() {
</P><PRE>   var _ThisPlayer = this;
   var _PlayerControllers = [];
</PRE><PRE>   function PlayerController(playerElement) {
       var _SelfPlayerController = this;
       var _PlayerInstance;
       var _PlayerInstantces = [];
</PRE><PRE>       function OnPlayerInstanceDataAvailable(event) {
           var srcElement = $Jssor$.$EventSrc(event);
           _PlayerInstance = srcElement.pInstance;
</PRE><PRE>           $Jssor$.$RemoveEvent(srcElement, &quot;dataavailable&quot;, OnPlayerInstanceDataAvailable);
           $Jssor$.$Each(_PlayerInstantces, function (playerInstance) {
               if (playerInstance != _PlayerInstance) {
                   playerInstance.$Remove();
               }
           });
</PRE><PRE>           playerElement.pTagName = _PlayerInstance.tagName;
           _PlayerInstantces = null;
       }
</PRE><PRE>       function HandlePlayerInstance(playerInstanceElement) {
           var playerHandler;
</PRE><PRE>           if (!playerInstanceElement.pInstance) {
               var playerHandlerAttribute = $Jssor$.$AttributeEx(playerInstanceElement, &quot;pHandler&quot;);
</PRE><PRE>               if ($JssorPlayer$[playerHandlerAttribute]) {
                   $Jssor$.$AddEvent(playerInstanceElement, &quot;dataavailable&quot;, OnPlayerInstanceDataAvailable);
                   playerHandler = new $JssorPlayer$[playerHandlerAttribute](playerElement, playerInstanceElement);
                   _PlayerInstantces.push(playerHandler);
</PRE><PRE>                   $JssorDebug$.$Execute(function () {
                       if ($Jssor$.$Type(playerHandler.$Remove) != &quot;function&quot;) {
                           $JssorDebug$.$Fail(&quot;'pRemove' interface not implemented for player handler '&quot; + playerHandlerAttribute + &quot;'.&quot;);
                       }
                   });
               }
           }
</PRE><PRE>           return playerHandler;
       }
</PRE><PRE>       _SelfPlayerController.$InitPlayerController = function () {
           if (!playerElement.pInstance &amp;&amp; !HandlePlayerInstance(playerElement)) {
</PRE><PRE>               var playerInstanceElements = $Jssor$.$Children(playerElement);
</PRE><PRE>               $Jssor$.$Each(playerInstanceElements, function (playerInstanceElement) {
                   HandlePlayerInstance(playerInstanceElement);
               });
           }
       };
   }
</PRE><PRE>   _ThisPlayer.$EVT_SWITCH = 21;
</PRE><PRE>   _ThisPlayer.$FetchPlayers = function (elmt) {
       elmt = elmt || document.body;
</PRE><PRE>       var playerElements = $Jssor$.$FindChildren(elmt, &quot;player&quot;, null, true);
</PRE><PRE>       $Jssor$.$Each(playerElements, function (playerElement) {
           if (!_PlayerControllers[playerElement.pId]) {
               playerElement.pId = _PlayerControllers.length;
               _PlayerControllers.push(new PlayerController(playerElement));
           }
           var playerController = _PlayerControllers[playerElement.pId];
           playerController.$InitPlayerController();
       });
   };
</PRE><P>}
</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2014.igem.org/Team:Aachen/Scripts/jssor.js">http://2014.igem.org/Team:Aachen/Scripts/jssor.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Aachen/Scripts/jssor.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Aachen/Scripts/jssor.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Aachen/Scripts/jssor.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Aachen/Scripts/jssor.js&amp;oldid=195037" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2014.igem.org:Privacy_policy" title="2014.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2014.igem.org:General_disclaimer" title="2014.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>