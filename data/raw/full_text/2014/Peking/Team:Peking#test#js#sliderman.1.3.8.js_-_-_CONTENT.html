<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Peking_test_js_sliderman_1_3_8_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Peking/test/js/sliderman.1.3.8.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Peking/test/js/sliderman.1.3.8.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Peking/test/js/sliderman.1.3.8.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Peking/test/js/sliderman.1.3.8.js&amp;action=history">History               </A></LI><LI style="color:white;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Peking/test/js/sliderman.1.3.8.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Peking/test/js/sliderman.1.3.8.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2014.igem.org</H3><P>/**
</P><UL><LI> Sliderman.js
</LI><LI> Version: 1.3.8
</LI><LI> Author: Taras Ozarko (tozarko@gmail.com)
</LI><LI> (c) 2010-2011 Devtrix. All rights reserved. <A href="http://www.devtrix.net/sliderman/" class="external free" rel="nofollow">http://www.devtrix.net/sliderman/</A></LI><LI>/
</LI></UL><P>var Sliderman = new function(){
	var Sliderman = this;
</P><P>	function foreach(o, f){for(var k in o) if(o.hasOwnProperty(k) &amp;&amp; f(k,o[k],o)) return;}
	function is_array(a){return a &amp;&amp; a.constructor == Array;}
	function is_string(a){return typeof(a) == 'string';}
	function is_function(a){return typeof(a) == 'function';}
	function now(){return (new Date()).getTime();}
	function this_blur(){this.blur();}
</P><P>	function random(l){
		if(l == 0) return;
		else if(l == 1) return 0;
		r = Math.round(Math.random()*(l+1));
		if(r &gt; 0 &amp;&amp; r &lt; l+1) r--;
		else r = random(l);
		return r;
	}//random
</P><P>	function addElementEvent(o,e,f){
		var of = o[e];
		var f2 = function(){of();f();}
		o[e] = !is_function(of) ? f : f2;
	}//addElementEvent
</P><P>	var _loadImage = [];
	function loadImage(s,f,always_show_loading){
		var i_onload = function(){_loadImage[s]=true;if(f)f(s);}
		var l = function(){if(_loadImage[s]){if(f)f(s);}else{var i=newElement('IMG');i.onload=i_onload;new function(){i.src=s;};}}
		if(always_show_loading) setTimeout(l, typeof(always_show_loading) == 'number' ? always_show_loading : 1000);
		else l();
	}//loadImage
</P><P>	function array_copy(a){
		if(is_array(a)) var r = [];
		else var r = {};
		foreach(a, function(i){r[i] = typeof(a[i]) != 'object' ? a[i] : array_copy(a[i]);});
		return r;
	}//array_copy
</P><P>	function eq(a, b){
		return String(a).replace(/^\s+/, <I>).replace(/\s+$/, </I>).toLowerCase() == String(b).replace(/^\s+/, <I>).replace(/\s+$/, </I>).toLowerCase();
	}//eq
</P><P>	function array_search(arr, a, b){
		var result = false;
		if(!b){
			foreach(arr, function(i){
				if(eq(arr[i], b)){
					result = i;
					return true;
				}
			});
		}
		else{
			foreach(arr, function(i){
				if(eq(arr[i][a], b)){
					result = i;
					return true;
				}
			});
		}
		return result;
	}//array_search
</P><P>	function validateOption(a, b){
		b = b.split(',');
		var result;
		foreach(b, function(i){
			result = b[i];
			if(eq(a, b[i])) return true;
		});
		return result;
	}//validateOption
</P><P>	var setOpacity;
	function setOpacityInit(){
		if(setOpacity) return;
		var p, b = document.body, s = b.style;
		if(is_string(s.opacity)) p = 'opacity';
	  else if(is_string(s.MozOpacity)) p = 'MozOpacity';
	  else if(is_string(s.KhtmlOpacity)) p = 'KhtmlOpacity';
	  else if(b.filters &amp;&amp; navigator.appVersion.match(/MSIE ([\d.]+);/)[1]&gt;=5.5) p = 'filter';
	  if(p == 'filter'){
			setOpacity = function(style, v){
				if(v &gt; 1) v = 1;
				else if(v &lt; 0) v = 0;
			  style[p] = &quot;alpha(opacity=&quot; + Math.round(v*100) + &quot;)&quot;;
			}
		}else if(p){
			setOpacity = function(style, v){
				if(v &gt; 1) v = 1;
				else if(v &lt; 0) v = 0;
			  style[p] = v.toFixed(2);
			}
		}else setOpacity = ef
	}//setOpacityInit
</P><P>	function setStyle(style, property, value){
		if(is_string(value)) style[property] = value;
		else if(property == 'clip') style[property] = 'rect('+Math.round(value[0])+'px, '+Math.round(value[1])+'px, '+Math.round(value[2])+'px, '+Math.round(value[3])+'px)';
		else if(property == 'opacity') setOpacity(style, value);
		else style[property] = Math.round(value)+'px';
	}//setStyle
	function setStyles(style, properties){
		foreach(properties, function(property){
			setStyle(style, property, properties[property]);
		});
	}
	function hide(style){style.display = 'none';}
	function show(style){style.display = <I>;}</I></P><P>	function newElement(tagName, styles){
		var e = document.createElement(tagName);
		if(styles) setStyles(e.style, styles);
		return e;
	}//newElement
</P><P>	var definedObjects = [];
	function defineObject(t, o){
		if(!is_array(definedObjects[t])) definedObjects[t] = [];
		if(o){
			var n = -1, i;
			if(o.name){
				if(i = array_search(definedObjects[t], 'name', o.name)) n = i;
			}else o.name = 'Sliderman-nameless-object-'+definedObjects[t].length;
			if(n &gt;= 0) definedObjects[t][n] = o;
			else definedObjects[t].push(o);
		}
	}//defineObjects
	Sliderman.easing = function(e){defineObject('easing', e);}
	Sliderman.order = function(e){defineObject('order', e);}
	Sliderman.effect = function(e){defineObject('effect', EffectObject(e));}
</P><P>	function getDefinedObjects(t){
		return definedObjects[t];
	}//getDefinedObjects
</P><P>	function getDefinedObject(t, n){
		var a = getDefinedObjects(t), i;
		return is_array(a) &amp;&amp; (i = array_search(a, 'name', n)) ? a[i] : false;
	}//getDefinedObject
</P><P>	var _EffectObject = 0;
	function EffectObject(a){
		if(typeof(a) != 'object') a = {};
		if(!a.name) a.name = 'Sliderman-nameless-effect-'+_EffectObject++;
		a.interval = parseInt(a.interval) || 40; a.duration = parseInt(a.duration) || 200; a.delay = parseInt(a.delay) || 0;
		a.cols = parseInt(a.cols) || 1; a.rows = parseInt(a.rows) || 1; a.count = a.cols*a.rows;
		a.top = a.top ? true : false; a.right = a.right ? true : false; a.bottom = a.bottom ? true : false; a.left = a.left ? true : false;
		a.fade = a.fade ? true : false; a.zoom = a.zoom ? true : false; a.move = a.move ? true : false, a.chess = a.chess ? true : false;
		a.easing = getDefinedObject('easing', a.easing) ? a.easing : 'swing';
		a.order = getDefinedObject('order', a.order) ? a.order : 'random'; a.order_cache_id = [a.order, a.cols, a.rows, a.road, a.reverse].join(',');
		a.cache_id = [a.interval, a.duration, a.delay, a.top, a.right, a.bottom, a.left, a.fade, a.zoom, a.move, a.chess, a.order_cache_id].join(',');
		a.cacheId = function(){return a.cache_id + (a.order == 'random' ? now() : <I>);}</I>
		a.frames_count = Math.round(a.duration/a.interval); a.easingArr = getEasing(a);
		a.P = []; a.pieces = function(w,h){w /= a.cols; h /= a.rows; var wh = w+'x'+h; if(!a.P[wh]){a.P[wh] = {width: w, height: h};
			for(var c = 0; c &lt; a.cols; c++) for(var r = 0; r &lt; a.rows; r++) a.P[wh][r+','+c] = [r*h, c*w+w, r*h+h, c*w];
			}return a.P[wh];}
		return a;
	}//EffectObject
</P><P>	function slideContainer(slidesContainer, display){
		var container = newElement('div', {width: display.width, height: display.height, position: 'absolute', top: 0, left: 0, overflow: 'hidden'});
		slidesContainer.appendChild(container);
		return container;
	}//slideContainer
</P><P>	var EffectsArr = [];
	function Effects(parameters){
		var effect = parameters.effect,	display = parameters.display;
		if(parameters.contentmode) effect.zoom = false;
		var cr, piece, r, image, startStylesArr = [], AnimateArr = [], needAnimate = [], AnimateItemsArr = [], styleStart, styleEnd, styleDif;
</P><P>		var container = slideContainer(parameters.container, display);
</P><P>		var pieces = effect.pieces(display.width, display.height);
		var e_top, e_bottom, e_left, e_right;
		var effectsOptStr = effect.cacheId();
		var frameN;
		var orderArr = getOrder(effect);
</P><P>		if(EffectsArr[effectsOptStr]){
			startStylesArr = EffectsArr[effectsOptStr].startStylesArr;
			AnimateArr = EffectsArr[effectsOptStr].AnimateArr;
			needAnimate = EffectsArr[effectsOptStr].needAnimate;
		}else{
			for(r = 0; r &lt; effect.rows; r++) for(c = 0; c &lt; effect.cols; c++){cr = r+','+c;
				if(effect.chess &amp;&amp; orderArr[cr] % 2 == 1){
					e_top = effect.bottom; e_bottom = effect.top;
					e_left = effect.right; e_right = effect.left;
				}else{
					e_top = effect.top; e_bottom = effect.bottom;
					e_left = effect.left; e_right = effect.right;
				}
</P><P>				styleStart = {top: 0, left: 0, opacity: 1, width: display.width, height: display.height, overflow: 'hidden'};
				styleEnd = array_copy(styleStart); piece = array_copy(pieces[cr]);
</P><P>				if(effect.fade) styleStart.opacity = 0;
</P><P>				if(e_top &amp;&amp; e_bottom) piece[0] = piece[2] = (piece[0] + piece[2]) / 2;
				else if(e_top) piece[2] -= pieces.height;
				else if(e_bottom) piece[0] += pieces.height;
				if(e_left &amp;&amp; e_right) piece[1] = piece[3] = (piece[1] + piece[3]) / 2;
				else if(e_left) piece[1] -= pieces.width;
				else if(e_right) piece[3] += pieces.width;
</P><P>				if(effect.zoom){
					styleStart.left = pieces[cr][3];
					styleStart.top = pieces[cr][0];
					if(e_left &amp;&amp; e_right) styleStart.left += pieces.width / 2;
					else if(e_right) styleStart.left += pieces.width;
					else if(!e_left) styleStart.left = 0;
					if(e_top &amp;&amp; e_bottom) styleStart.top += pieces.height / 2;
					else if(e_bottom) styleStart.top += pieces.height;
					else if(!e_top) styleStart.top = 0;
					if(e_left || e_right) piece[1] = piece[3] = 0;
					if(e_top || e_bottom) piece[0] = piece[2] = 0;
					styleStart.width = e_left || e_right ? 0 : display.width;
					styleStart.height = e_top || e_bottom ? 0 : display.height;
				}
</P><P>				if(effect.move){
					if(e_top){
						styleStart.top = parseInt(styleStart.top)-pieces.height;
						piece[0] += pieces.height; piece[2] += pieces.height;
					}
					if(e_bottom){
						styleStart.top = parseInt(styleStart.top)+pieces.height;
						piece[0] -= pieces.height; piece[2] -= pieces.height;
					}
					if(e_left){
						styleStart.left = parseInt(styleStart.left)-pieces.width;
						piece[1] += pieces.width; piece[3] += pieces.width;
					}
					if(e_right){
						styleStart.left = parseInt(styleStart.left)+pieces.width;
						piece[1] -= pieces.width; piece[3] -= pieces.width;
					}
				}
</P><P>				styleStart.clip = piece;
				styleEnd.clip = pieces[cr];
</P><P>				styleDif = [];
				foreach(styleEnd, function(property){
					if(styleStart[property].toString() != styleEnd[property].toString()){
						styleDif[property] = [];
						if(property == 'clip'){
							foreach(styleStart[property], function(n){
								styleDif[property][n] = styleEnd[property][n] - styleStart[property][n];
							});
						}else styleDif[property] = styleEnd[property] - styleStart[property];
						needAnimate[cr] = true;
					}
				});
</P><P>				startStylesArr[cr] = styleStart; AnimateArr[cr] = [];
				if(effect.delay) for(var n = 0; n &lt; Math.round(orderArr[cr]*effect.delay/effect.interval); n++) AnimateArr[cr].push(null);
</P><P>				if(!needAnimate[cr]) AnimateArr[cr].push({display: <I>});</I>
				else for(frameN = 1; frameN &lt;= effect.frames_count; frameN++){
					var style_c = [];
					if(frameN == effect.frames_count) style_c = styleEnd;
					else{
						foreach(styleDif, function(property){
							value = [];
							if(property == 'clip'){
								foreach(styleDif[property], function(n){
									value[n] = styleStart[property][n]+styleDif[property][n]*effect.easingArr[frameN]
								});
							}else value = styleStart[property]+styleDif[property]*effect.easingArr[frameN]
							style_c[property] = value;
						});
					}
					AnimateArr[cr].push(style_c);
				}
</P><P>			}//for
			EffectsArr[effectsOptStr] = {startStylesArr: startStylesArr, AnimateArr: AnimateArr, needAnimate: needAnimate};
		}
</P><P>		for(r = 0; r &lt; effect.rows; r++) for(c = 0; c &lt; effect.cols; c++){cr = r+','+c;
			if(parameters.contentmode){
				image = newElement('DIV', startStylesArr[cr]);
				image.appendChild(parameters.src.cloneNode(true));
			}else{
				image = newElement('IMG', startStylesArr[cr]);
				image.src = parameters.src;
			}
			var style = image.style;
			style.position = 'absolute';
			container.appendChild(image);
			AnimateItemsArr[cr] = style;
			if(!needAnimate[cr]) hide(AnimateItemsArr[cr]);
		}
</P><P>		//ANIMATE
		var time_s = now();
		var framesCountAll = 1;
		foreach(AnimateArr, function(index){framesCountAll = Math.max(AnimateArr[index].length, framesCountAll);});
		var AnimateItem, AnimateItemsComplete = [], timerFunc = function(){
			var frameC = Math.ceil((now() - time_s) / effect.interval);
			frameC = frameC &gt;= framesCountAll ? framesCountAll-1 : frameC-1;
			foreach(AnimateArr, function(index){
				AnimateItem = frameC &gt; AnimateArr[index].length-1 ? AnimateArr[index].length-1 : frameC;
				if(AnimateArr[index][AnimateItem] &amp;&amp; !AnimateItemsComplete[index+','+AnimateItem]){
					setStyles(AnimateItemsArr[index], AnimateArr[index][AnimateItem]);
					AnimateItemsComplete[index+','+AnimateItem] = true;
				}
			});
</P><P>			if(frameC == framesCountAll-1){
				clearInterval(animateInterval);
				if(effect.count &gt; 1){
					var childs = [];
					for(var i = 0, l = container.childNodes.length; i &lt; l; i++){
						if(container.childNodes[i].nodeType == 1) childs.push(container.childNodes[i]);
					}
					function clear(){
						for(var i = 0, l = childs.length; i &lt; l; i++) container.removeChild(childs[i]);
						parameters.callback(container);
					}
					if(parameters.contentmode){
						container.appendChild(parameters.src);
						clear();
					}else{
						var newImg = newElement('IMG', {width: display.width, height: display.height});
						container.appendChild(newImg);
						newImg.onload = clear;
						newImg.src = parameters.src;
					}
				}else parameters.callback(container);
			}
		};
</P><P>		var animateInterval = setInterval(timerFunc, effect.interval);
</P><P>	}//Effects
	function getOrder(effect){
		var a = [], o, m = 0;
		if(effect.count &gt; 1){
			o = getDefinedObject('order', effect.order);
			if(!is_array(o.cache)) o.cache = [];
			if(o.nocache || !o.cache[effect.order_cache_id]){
				a = o.method(effect);
				if(effect.reverse){
					foreach(a, function(i, v){m = Math.max(m, v);});
					foreach(a, function(i){a[i] = m - a[i];});
				}
				o.cache[effect.order_cache_id] = a;
			}
			a = o.cache[effect.order_cache_id];
		}else a['0,0'] = 0;
		return a;
	}//getOrder
</P><P>	function getEasing(effect){
		var o = getDefinedObject('easing', effect.easing), i, c = effect.frames_count;
		if(!is_array(o.cache)) o.cache = [];
		if(!o.cache[c]){
			o.cache[c] = [];
			for(i = 1; i &lt;= c; i++) o.cache[c][i] = o.method(i/c);
		}
		return o.cache[c];
	}//getEasing
</P><P>	Sliderman.slider = function(parameters){
		setOpacityInit();
</P><P>		var Slider = {}, current = null, previous = null, EffectN = 0, nextIndex = null, prevImg, status = 'free', isHover = false, images = [], descriptions = [], links = [], ef = function(){};
</P><P>		//EVENTS
		var events = parameters.events, eventCall = events ? function(e){if(events[e] &amp;&amp; is_function(events[e])) events[e](Slider);} : ef;
		var contentmode = parameters.contentmode;
</P><P>		//SLIDER EFECTS
		var effects = [];
		var effectsNames = [];
		var addEffect = function(e){
			if(is_string(e)){
				e = e.split(',');
				if(e.length == 1){
					var globalEffect = getDefinedObject('effect', e[0]);
					if(globalEffect) addEffect(globalEffect);
				}else for(var i = 0; i &lt; e.length; i++) addEffect(e[i]);
			}else if(e){
				e = EffectObject(e);
				var effectsId = array_search(effects, 'name', e.name);
				if(!effectsId) effectsId = effects.length;
				effectsNames.push(e.name);
				effects[effectsId] = array_copy(e);
			}
		}//addEffect
		var getEffect = function(){
			var n = 0;
			if(effects.length &gt; 1){
				switch(display.effects_order){
					case 'slides': n = current % effectsNames.length; break;
					case 'effects': n = EffectN % effectsNames.length; break;
					default:/*random*/
						n = random(effectsNames.length);
				}
			}
			EffectN++;
			return effects[array_search(effects, 'name', effectsNames[n])];
		}//getEffect
		if(parameters.effects){
			if(!is_array(parameters.effects)) parameters.effects = [parameters.effects];
			for(var i = 0; i &lt; parameters.effects.length; i++) addEffect(parameters.effects[i]);
		}else parameters.effects = [];
		if(!effects.length){
			effects = array_copy(getDefinedObjects('effect'));
			for(var i = 0; i &lt; effects.length; i++) effectsNames.push(effects[i].name);
		}
</P><P>		//OPTIONS
		var display = parameters.display || {};
		display.width = parameters.width;
		display.height = parameters.height;
		var loading = display.loading || {};
		var description = display.description || null;
		var navigation = display.navigation || null;
		var buttons = display.buttons || null;
</P><P>		Slider.random = function(){
			var r = random(images.length);
			return images.length &gt; 1 &amp;&amp; r == current ? Slider.random() : Slider.go(r);
		}
		Slider.next = function(){
			var r = Slider.go(current === null ? 0 : current + 1);
			if(display.loop &amp;&amp; r){
				autoplayCount++;
				if(autoplayCount+1 &gt;= images.length*display.loop) autoplay = ef;
			}
			return r;
		}
		Slider.prev = function(){
			var r = Slider.go(current === null ? -1 : current - 1);
			if(display.loop &amp;&amp; r) autoplayCount--;
			return r;
		}
		Slider.go = function(index){
			index = (images.length + index) % images.length;
			autoplay(false);
			if(status != 'free') nextIndex = index;
			if(status != 'free' || current == index) return autoplay(true) &amp;&amp; false;
			previous = current;
			current = index;
			eventCall('loading');
			showLoading(true);
			if(contentmode) doEffect(images[current]);
			else loadImage(images[current], doEffect, display.always_show_loading);
			return true;
		}//go
		Slider.get = function(a){
			switch(a){
				case 'length': return images.length; break;
				case 'current': return current; break;
				case 'previous': return previous; break;
				case 'images': return images; break;
				case 'links': return links; break;
				case 'descriptions': return descriptions; break;
			}
		}//get
		var autoplayStatus = 'stop';//play,pause,stop
		Slider.play = function(){if(!display.autoplay) return;
			if(autoplayStatus != 'play'){
				var s = autoplayStatus == 'stop';
				autoplayStatus = 'play';
				if(s) (display.random ? Slider.random : Slider.go)(0);
				else autoplay(true);
			}
		}//play
		Slider.pause = function(){if(!display.autoplay) return;
			if(autoplayStatus == 'pause') Slider.play();
			else if(autoplayStatus == 'play'){
				autoplayStatus = 'pause';
				autoplay(false);
			}
		}//pause
		Slider.stop = function(){if(!display.autoplay) return;
			autoplayStatus = 'stop';
			current = null;
			previous = null;
			nextIndex = null;
			EffectN = 0;
			autoplay(false);
			removePrevImg();
			if(display.first_slide) displayFirstSlide();
			update();
		}//stop
		Slider.start = function(){if(!display.autoplay) return;
			Slider.stop();
			Slider.play();
		}//start
</P><P>		var removePrevImg = function(){
			if(prevImg &amp;&amp; status == 'free'){
				prevImg.parentNode.removeChild(prevImg);
				prevImg = null;
			}
		}//removePrevImg
</P><P>		function displayFirstSlide(){
			var c = slideContainer(imagesCont, display);
			if(parameters.contentmode) c.appendChild(images[0]);
			else c.innerHTML = '&lt;img src=&quot;'+images[0]+'&quot; width=&quot;'+display.width+'&quot; height=&quot;'+display.height+'&quot; /&gt;';
			EffectN = 1;
			previous = null;
			current = 0;
		}//displayFirstSlide
</P><P>		function update(){
			descriptionShow(); linkUpd(); navigationUpd();
		}//update
</P><P>		var styleDef = {width: display.width, height: display.height, position: 'absolute', top: 0, left: 0, display: 'block'};
</P><P>		var mainCont = document.getElementById(parameters.container);
		function addElementEventOnmouseover(){isHover = true;
			if(buttons &amp;&amp; buttons.hide) show(buttonsCont.style);
			if(description &amp;&amp; description.hide &amp;&amp; !contentmode) show(descriptionCont.style);
			if(display.pause) autoplay(false);
		}
		addElementEvent(mainCont, 'onmouseover', addElementEventOnmouseover);
		function addElementEventOnmouseout(){isHover = false;
			if(buttons &amp;&amp; buttons.hide) hide(buttonsCont.style);
			if(description &amp;&amp; description.hide &amp;&amp; !contentmode) hide(descriptionCont.style);
			if(display.pause) autoplay(true);
		}
		addElementEvent(mainCont, 'onmouseout', addElementEventOnmouseout);
</P><P>		//GET CONTENT
		var maps = document.getElementsByTagName('MAP');
		for(var i = 0; i &lt; mainCont.childNodes.length; i++) if(mainCont.childNodes[i].nodeType == 1){
			if(contentmode) images.push(mainCont.childNodes[i].cloneNode(true));
			else{
				switch(mainCont.childNodes[i].tagName){
					case 'A':
						var img = mainCont.childNodes[i].getElementsByTagName('IMG');
						if(img.length){
							images.push(img[0].src);
							links[images.length-1] = mainCont.childNodes[i];
						}else descriptions[images.length-1] = mainCont.childNodes[i];
					break;
					case 'IMG':
						images.push(mainCont.childNodes[i].src);
						if(mainCont.childNodes[i].useMap &amp;&amp; maps.length) for(var m = 0; m &lt; maps.length; m++){
							if(maps[m].name &amp;&amp; mainCont.childNodes[i].useMap.replace(/^[^#]*#/, <I>) == maps[m].name) links[images.length-1] = maps[m];</I>
						}
					break;
					case 'MAP': continue; break;
					default: descriptions[images.length-1] = mainCont.childNodes[i];
				}
			}
			hide(mainCont.childNodes[i].style);
		}
		if(!contentmode) for(var i = 0; i &lt; images.length; i++) loadImage(images[i]);
</P><P>		//CONTAINERS
		var sliderCont = newElement('DIV', {width: display.width, height: display.height, position: 'relative'}); mainCont.appendChild(sliderCont);
		var imagesCont = newElement('DIV', styleDef); sliderCont.appendChild(imagesCont);
		partsCont = sliderCont;
</P><P>		//LINKS
		if(contentmode) var linkUpd = ef;
		else{
			var lnk = newElement('DIV', styleDef); partsCont.appendChild(lnk);
			var linkUpd = function(){
				lnk.innerHTML = <I>; value = links[current];</I>
				if(value){
					if(value.tagName == 'MAP'){
						var a = newElement('IMG', styleDef);
						a.src = images[current]; a.useMap = '#'+value.name;
					}else{
						var a = newElement('A', styleDef);
						a.href = value.href; a.target = value.target;
					}
					setStyles(a.style, {opacity: 0, background: '#000000'});
					a.onfocus = this_blur;
					lnk.appendChild(a);
				}
			}
		}
</P><P>		//LOADING
		if(contentmode) var showLoading = ef;
		else{
			var loadingCont = newElement('DIV'); partsCont.appendChild(loadingCont);
			hide(loadingCont.style);
			if(loading.background){
				var loadingBgStyle = array_copy(styleDef);
				loadingBgStyle.background = loading.background;
				if(loading.opacity) loadingBgStyle.opacity = loading.opacity;
				loadingCont.appendChild(newElement('DIV', loadingBgStyle));
			}
			if(loading.image){
				var loadingImgStyle = array_copy(styleDef);
				loadingImgStyle.background = 'url('+(loading.image)+') no-repeat center center';
				loadingCont.appendChild(newElement('DIV', loadingImgStyle));
			}
			var showLoading = function(a){
				if(a) show(loadingCont.style);
				else hide(loadingCont.style);
				status = a ? 'loading' : 'free';
			}
		}
</P><P>		//DESCRIPTION
		var descriptionShow;
		if(description &amp;&amp; !contentmode){
			var descriptionCont = newElement('DIV'); partsCont.appendChild(descriptionCont);
			if(description.hide) hide(descriptionCont.style);
</P><P>			var descriptionStl = {position: 'absolute', overflow: 'hidden', textAlign: 'left'};
			if(!description) description = [];
			description.position = validateOption(description.position, 'top,left,right,bottom')
			//descriptionStl.background = description.background || 'white';
			//descriptionStl.opacity = description.opacity || 0.5;
			descriptionStl.width = description.position == 'top' || description.position == 'bottom' ? display.width : description.width || display.width*0.2;
			descriptionStl.height = description.position == 'left' || description.position == 'right' ? display.height : description.height || display.height*0.2;
			descriptionStl[description.position == 'bottom'?'bottom':'top'] = 0;
			descriptionStl[description.position == 'right'?'right':'left'] = 0;
</P><P>			var descBg = newElement('DIV', descriptionStl); descriptionCont.appendChild(descBg);
			descriptionStl.opacity = 1; descriptionStl.background = <I>;</I>
			var desc = newElement('DIV', descriptionStl); descriptionCont.appendChild(desc);
</P><P>			function descriptionShow(){
				desc.innerHTML = <I>;</I>
				setStyle(descriptionCont.style, 'visibility', 'hidden');
				var value = descriptions[current];
				if(value){
					setStyle(descriptionCont.style, 'visibility', 'visible');
					value = value.cloneNode(true);
					show(value.style);
					desc.appendChild(value);
					if(isHover) show(descriptionCont.style);
				}
			}
		}else descriptionShow = ef
</P><P>		//BUTTONS
		if(buttons){
			var buttonsCont = newElement('DIV'); partsCont.appendChild(buttonsCont);
			if(buttons.hide) hide(buttonsCont.style);
			var btnPrev = newElement('A'); buttonsCont.appendChild(btnPrev);
			btnPrev.href = 'javascript:void(0);';
			var btnNext = btnPrev.cloneNode(true); buttonsCont.appendChild(btnNext);
			btnPrev.onfocus = this_blur;
			btnNext.onfocus = this_blur;
			btnPrev.onclick = Slider.prev;
			btnNext.onclick = Slider.next;
			if(buttons.prev.label) btnPrev.innerHTML = is_string(buttons.prev.label) ? buttons.prev.label : 'prev';
			if(buttons.prev.label) btnNext.innerHTML = is_string(buttons.next.label) ? buttons.next.label : 'next';
			if(buttons.prev.className) btnPrev.className = buttons.prev.className;
			if(buttons.next.className) btnNext.className = buttons.next.className;
			if(buttons.opacity || buttons.prev.opacity) setOpacity(btnPrev.style, buttons.opacity || buttons.prev.opacity);
			if(buttons.opacity || buttons.next.opacity) setOpacity(btnNext.style, buttons.opacity || buttons.next.opacity);
		}
</P><P>		//NAVIGATION
		var navigationUpd;
		if(navigation){
			var navigationCont = document.getElementById(navigation.container);
			var a;
</P><P>			if(navigation.prev){
				a = newElement('A');
				if(navigation.prev.label) a.innerHTML = is_string(navigation.prev.label) ? navigation.prev.label : 'Prev';
				if(navigation.prev.className) a.className = navigation.prev.className;
				a.href = 'javascript:void(0);';
				a.onfocus = this_blur;
				a.onclick = Slider.prev;
				navigationCont.appendChild(a);
			}
</P><P>			var navigationLinks = [];
			function a_onclick(){Slider.go(this.id.replace(parameters.container+'_SliderNavigation', <I>));};</I>
			for(var i = 0; i &lt; images.length; i++){
				a = newElement('A');
				if(navigation.label) a.innerHTML = is_string(navigation.label) ? navigation.label : i+1;
				if(navigation.className) a.className = navigation.className;
				a.href = 'javascript:void(0);';
				a.id = parameters.container+'_SliderNavigation'+i;
				a.onfocus = this_blur;
				a.onclick = a_onclick;
				navigationLinks.push(a);
				navigationCont.appendChild(a);
			}
</P><P>			if(navigation.next){
				a = newElement('A');
				if(navigation.next.label) a.innerHTML = is_string(navigation.next.label) ? navigation.next.label : 'Next';
				if(navigation.next.className) a.className = navigation.next.className;
				a.href = 'javascript:void(0);';
				a.onfocus = this_blur;
				a.onclick = Slider.next;
				navigationCont.appendChild(a);
			}
</P><P>			function navigationUpd(){
				for(var i = 0; i &lt; navigationLinks.length; i++) navigationLinks[i].className = navigationLinks[i].className.replace(/\bactive\b/g, <I>);</I>
				if(navigationLinks[current]) navigationLinks[current].className += ' active';
			}
		}else navigationUpd = ef
</P><P>		//AUTOPLAY
		var autoplayCount = 0;
		if(display.autoplay){
			var autoplayTimeout;
			var autoplay = function(a){
				if(autoplayTimeout){
					clearTimeout(autoplayTimeout);
					autoplayTimeout = null;
				}
				if(a &amp;&amp; !(isHover &amp;&amp; display.pause) &amp;&amp; autoplayStatus == 'play') autoplayTimeout = setTimeout(display.random ? Slider.random : Slider.next, display.autoplay);
			}//autoplay
		}else var autoplay = ef
</P><P>		var doEffect = function(src){
			if(autoplayStatus == 'stop') autoplayStatus = 'pause';
			eventCall('before');
			showLoading(false); status = 'busy'; update();
			Effects({effect: getEffect(), display: display, container: imagesCont, src: src, callback: function(img){
				status = 'free'; autoplay(true);
				removePrevImg();
				prevImg = img;
				eventCall('after');
				if(autoplayStatus == 'stop') removePrevImg();
				else if(nextIndex !== null){
					Slider.go(nextIndex);
					nextIndex = null;
				}
			}, contentmode: contentmode});
		};
</P><P>		if(display.mousewheel){
			onmousewheel = function(d){
				if(d &gt; 0) Slider.prev();
				else if(d &lt; 0) Slider.next();
				return true;
			};
			function wheel(event){
				var d = 0;
				if(!event) event = window.event;
				if(event.wheelDelta){
					d = event.wheelDelta/120;
					if(window.opera) d = -d;
				}else if(event.detail) d = -event.detail/3;
				if(d &amp;&amp; onmousewheel(d)){
					if(event.preventDefault) event.preventDefault();
					event.returnValue = false;
				}
			}//wheel
			if(mainCont.addEventListener){
				mainCont.addEventListener(&quot;DOMMouseScroll&quot;,wheel,false);
				mainCont.addEventListener(&quot;mousewheel&quot;,wheel,false);
			}else addElementEvent(mainCont, 'onmousewheel', wheel);
		}
</P><P>		if(display.first_slide) displayFirstSlide();
		update();
		if(typeof(display.autostart) == 'undefined' || display.autostart) Slider.play();
		return Slider;
	}//Sliderman.slider
</P><P>
}//Sliderman
</P><P>/* predefined easing functions */
Sliderman.easing({name: 'none', method: function(x){return x;}});
Sliderman.easing({name: 'swing', method: function(x){return -Math.cos(x*Math.PI)/2 + 0.5;}});
Sliderman.easing({name: 'wave', method: function(t){return ((Math.cos((1-t)*3*Math.PI+2*Math.PI))*0.5+0.5+t)/2;}});
Sliderman.easing({name: 'bounce', method: function(t){return 1 - Math.abs(Math.cos((1-t)*(2.5+t*t*3)*Math.PI+0.5*Math.PI)*(1-t));}});
/* predefined order functions */
Sliderman.order({name: 'straight', method: function(e){
	var cols = e.cols, rows = e.rows, road = e.road, count = e.count;
	var a = [], i = 0, c = 0, r = 0, cl = cols - 1, rl = rows - 1, il = count - 1, cr;
	for(r = 0; r &lt; rows; r++) for(c = 0; c &lt; cols; c++){cr = r+','+c;
		switch(road){
			case 'BL': a[cr] = il-(c*rows+(rl-r)); break;
			case 'RT': a[cr] = il-(r*cols+(cl-c)); break;
			case 'TL': a[cr] = il-(c*rows+r);
			case 'LT': a[cr] = il-(r*cols+c); break;
			case 'BR': a[cr] = c*rows+r; break;
			case 'LB': a[cr] = r*cols+(cl-c); break;
			case 'TR': a[cr] = c*rows+(rl-r); break;
			default: a[cr] = r*cols+c; break;//'RB'
		}
	}
	return a;
}});
Sliderman.order({name: 'swirl', method: function(e){
	var cols = e.cols, rows = e.rows, road = e.road, count = e.count;
	var a = [], i = 0, c = 0, r = 0, cl = cols - 1, rl = rows - 1, il = count - 1, cr;
	var courses, course = 0;
	switch(road){
		case 'BL': c = cl; r = 0; courses = ['r+', 'c-', 'r-', 'c+']; break;
		case 'RT': c = 0; r = rl; courses = ['c+', 'r-', 'c-', 'r+']; break;
		case 'TL': c = cl; r = rl; courses = ['r-', 'c-', 'r+', 'c+']; break;
		case 'LT': c = cl; r = rl; courses = ['c-', 'r-', 'c+', 'r+']; break;
		case 'BR': c = 0; r = 0; courses = ['r+', 'c+', 'r-', 'c-']; break;
		case 'LB': c = cl; r = 0; courses = ['c-', 'r+', 'c+', 'r-']; break;
		case 'TR': c = 0; r = rl; courses = ['r-', 'c+', 'r+', 'c-']; break;
		default: c = 0; r = 0; courses = ['c+', 'r+', 'c-', 'r-']; break;//'RB'
	}
	i = 0;
	while(i &lt; count){
		cr = r+','+c;
		if(c &gt;= 0 &amp;&amp; c &lt; cols &amp;&amp; r &gt;= 0 &amp;&amp; r &lt; rows &amp;&amp; typeof(a[cr]) == 'undefined') a[cr] = i++;
		else switch(courses[course++%courses.length]){case 'c+': c--; break; case 'r+': r--; break; case 'c-': c++; break; case 'r-': r++; break;}
		switch(courses[course%courses.length]){case 'c+': c++; break; case 'r+': r++; break; case 'c-': c--; break; case 'r-': r--; break;}
	}
	return a;
}});
Sliderman.order({name: 'snake', method: function(e){
	var cols = e.cols, rows = e.rows, road = e.road, count = e.count;
	var a = [], i = 0, c = 0, r = 0, cl = cols - 1, rl = rows - 1, il = count - 1, cr;
	var courses, course = 0;
	switch(road){
		case 'BL': c = cl; r = 0; courses = ['r+', 'c-', 'r-', 'c-']; break;
		case 'RT': c = 0; r = rl; courses = ['c+', 'r-', 'c-', 'r-']; break;
		case 'TL': c = cl; r = rl; courses = ['r-', 'c-', 'r+', 'c-']; break;
		case 'LT': c = cl; r = rl; courses = ['c-', 'r-', 'c+', 'r-']; break;
		case 'BR': c = 0; r = 0; courses = ['r+', 'c+', 'r-', 'c+']; break;
		case 'LB': c = cl; r = 0; courses = ['c-', 'r+', 'c+', 'r+']; break;
		case 'TR': c = 0; r = rl; courses = ['r-', 'c+', 'r+', 'c+']; break;
		default: c = 0; r = 0; courses = ['c+', 'r+', 'c-', 'r+']; break;//'RB'
	}
	i = 0;
	while(i &lt; count){cr = r+','+c;
		if(c &gt;= 0 &amp;&amp; c &lt; cols &amp;&amp; r &gt;= 0 &amp;&amp; r &lt; rows &amp;&amp; typeof(a[cr]) == 'undefined'){a[cr] = i++;
			switch(courses[course%courses.length]){case 'c+': c++; break; case 'r+': r++; break; case 'c-': c--; break; case 'r-': r--; break;}
		}
		else{
			switch(courses[course++%courses.length]){case 'c+': c--; break; case 'r+': r--; break; case 'c-': c++; break; case 'r-': r++; break;}
			switch(courses[course++%courses.length]){case 'c+': c++; break; case 'r+': r++; break; case 'c-': c--; break; case 'r-': r--; break;}
		}
	}
	return a;
}});
Sliderman.order({name: 'straight_stairs', method: function(e){
	var cols = e.cols, rows = e.rows, road = e.road, count = e.count;
	var a = [], i = 0, c = 0, r = 0, cl = cols - 1, rl = rows - 1, il = count - 1, cr;
	switch(road){
		case 'BL': case 'TR': case 'TL': case 'BR': var C = 0, R = 0; break;
		case 'LB': case 'RT': case 'LT': case 'RB': default: road = 'RB'; var C = cl, R = 0; break;
	}
	c = C; r = R;
	while(i &lt; count){cr = r+','+c;
		if(road.indexOf('T') == 1 || road.indexOf('R') == 1) a[cr] = il - i++;
		else a[cr] = i++;
		switch(road){
			case 'BL': case 'TR': c--; r++; break;
			case 'TL': case 'BR': c++; r--; break;
			case 'LB': case 'RT': c--; r--; break;
			case 'RB': case 'LT': default: c++; r++; break;
		}
		if(c &lt; 0 || r &lt; 0 || c &gt; cl || r &gt; rl){
			switch(road){
				case 'BL': case 'TR': C++; break;
				case 'LB': case 'RT': case 'TL': case 'BR': R++; break;
				case 'RB': case 'LT': default: C--; break;
			}
			if(C &lt; 0 || R &lt; 0 || C &gt; cl || R &gt; rl){
				switch(road){
					case 'BL': case 'TR': C = cl; R++; break;
					case 'TL': case 'BR': R = rl; C++; break;
					case 'LB': case 'RT': R = rl; C--; break;
					case 'RB': case 'LT': default: C = 0; R++; break;
				}
				if(R &gt; rl) R = rl; else if(R &lt; 0) R = 0; else if(C &gt; cl) C = cl; else if(C &lt; 0) C = 0;
			}
			r = R; c = C;
		}
	}
	return a;
}});
Sliderman.order({name: 'square', method: function(effect){
	var cols = effect.cols || 1, rows = effect.rows || 1, arr = [], i = 0, c, r, dc, dr, cr;
	dc = cols &lt; rows ? (rows-cols)/2 : 0; dr = cols &gt; rows ? (cols-rows)/2 : 0; cr = Math.round(Math.max(cols/2, rows/2)) + 1;
	for(c = 0; c &lt; cols; c++) for(r = 0; r &lt; rows; r++) arr[r+','+c] = cr - Math.min(c+1+dc, r+1+dr, cols-c+dc, rows-r+dr);
	return arr;
}});
Sliderman.order({name: 'rectangle', method: function(effect){
	var cols = effect.cols || 1, rows = effect.rows || 1, arr = [], i = 0, c, r, cr;
	cr = Math.round(Math.min(cols/2, rows/2)) + 1;
	for(c = 0; c &lt; cols; c++) for(r = 0; r &lt; rows; r++) arr[r+','+c] = cr - Math.min(c+1, r+1, cols-c, rows-r);
	return arr;
}});
Sliderman.order({name: 'random', method: function(effect){
	var a = [], tmp = [], r, c, i;
	for(r = 0; r &lt; effect.rows; r++) for(c = 0; c &lt; effect.cols; c++) tmp.push(r+','+c);
	tmp.sort(function(a,b){return Math.random() &gt; 0.5;});
	for(i = 0; i &lt; effect.count; i++) a[tmp[i]] = i;
	return a;
}});
Sliderman.order({
	name: 'circle', method: function(effect){
</P><PRE> 	var cols = effect.cols || 1, rows = effect.rows || 1, arr = [], i = 0, c, r;
 	var hc = cols/2-0.5, hr = rows/2-0.5;
</PRE><P>		for(c = 0; c &lt; cols; c++) for(r = 0; r &lt; rows; r++) arr[r+','+c] = Math.round(Math.sqrt(Math.pow(c-hc, 2)+Math.pow(r-hr, 2)));
		return arr;
	}
});
Sliderman.order({
	name: 'cross', method: function(effect){
</P><PRE> 	var cols = effect.cols || 1, rows = effect.rows || 1, arr = [], i = 0, c, r;
 	var hc = cols/2-0.5, hr = rows/2-0.5;
</PRE><P>		for(c = 0; c &lt; cols; c++) for(r = 0; r &lt; rows; r++) arr[r+','+c] = Math.round(Math.min(Math.abs(c-hc), Math.abs(r-hr)));
		return arr;
	}
});
Sliderman.order({
	name: 'rectangle_cross', method: function(effect){
</P><PRE> 	var cols = effect.cols || 1, rows = effect.rows || 1, arr = [], i = 0, c, r;
 	var hc = cols/2-0.5, hr = rows/2-0.5, cr = Math.max(hc, hr)+1;
</PRE><P>		for(c = 0; c &lt; cols; c++) for(r = 0; r &lt; rows; r++) arr[r+','+c] = Math.round(cr-Math.max(hc-Math.abs(c-hc), hr-Math.abs(r-hr)))-1;
		return arr;
	}
});
/* predefined effects */
Sliderman.effect({name: 'fade', fade: true, duration: 400});
Sliderman.effect({name: 'move', left: true, move: true, duration: 400});
Sliderman.effect({name: 'stairs', cols: 7, rows: 5, delay: 30, order: 'straight_stairs', road: 'BL', fade: true});
Sliderman.effect({name: 'blinds', cols: 10, delay: 100, duration: 400, order: 'straight', right: true, zoom: true, fade: true});
Sliderman.effect({name: 'rain', cols: 10, delay: 100, duration: 400, order: 'straight', top: true, fade: true});
</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2014.igem.org/Team:Peking/test/js/sliderman.1.3.8.js">http://2014.igem.org/Team:Peking/test/js/sliderman.1.3.8.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Peking/test/js/sliderman.1.3.8.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Peking/test/js/sliderman.1.3.8.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Peking/test/js/sliderman.1.3.8.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Peking/test/js/sliderman.1.3.8.js&amp;oldid=139974" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2014.igem.org:Privacy_policy" title="2014.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2014.igem.org:General_disclaimer" title="2014.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>