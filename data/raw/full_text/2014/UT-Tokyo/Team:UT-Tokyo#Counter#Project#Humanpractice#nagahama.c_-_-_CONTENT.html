<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_UT-Tokyo_Counter_Project_Humanpractice_nagahama_c"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c&amp;action=history">History               </A></LI><LI style="color:white;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2014.igem.org</H3><OL><LI>include&lt;stdio.h&gt;</LI><LI>include&lt;math.h&gt;</LI><LI>include &lt;stdlib.h&gt;</LI><LI>include &quot;MT.h&quot;
</LI></OL><P>
int main(int argc,char **argv){
</P><PRE>   int seed;
   seed = atoi(argv[1]);
   init_genrand(seed);
   int n;
   int x;
   int space = 1000;
   double Asp[space+1];
   double Cd[space+1];
   double CdCd = 10.0;
   double range = 50.0;
   for(x=0;x&lt;space+1;x++){
       Asp[x] = 0.0;
   }
   for(x=0;x&lt;space+1;x++){
       Cd[x] = CdCd/(1.0+((x-1.0*space/2.0)/range)*((x-1.0*space/2.0)/range));
   }
   int producer = 100;
   int P_basyo[producer];
   int P_muki[producer];
   double P_Asp_past[producer];
   double P_Asp_now[producer];
   double P_Cd_past[producer];
   double P_Cd_now[producer];
   for(n=0;n&lt;producer;n++){
       P_basyo[n] = (genrand_real3()-0.5)*space/3 + space/2;
       if(genrand_real3()&lt;0.5){
           P_muki[n] = 1;
       }else{
           P_muki[n] = -1;
       }
       P_Asp_past[n] = 0.0;
       P_Asp_now[n] = 0.0;
       P_Cd_past[n] = P_basyo[n];
       P_Cd_now[n] = P_basyo[n];
   }
   int detecter = 100;
   int D_basyo[detecter];
   int D_muki[detecter];
   double D_Asp_past[detecter];
   double D_Asp_now[detecter];
   double D_Cd_past[detecter];
   double D_Cd_now[detecter];
   for(n=0;n&lt;producer;n++){
       D_basyo[n] = (genrand_real3()-0.5)*space/3 + space/2;
       if(genrand_real3()&lt;0.5){
           D_muki[n] = 1;
       }else{
           D_muki[n] = -1;
       }
       D_Asp_past[n] = 0.0;
       D_Asp_now[n] = 0.0;
       D_Cd_past[n] = Cd[D_basyo[n]];
       D_Cd_now[n] = Cd[D_basyo[n]];
   }
       double a = 0.2;
   double b = 0.004;
   double c = 0.005;
   double bias = 1.0;
   int timescale = 100000;
   FILE *fp;
   fp=fopen(&quot;result.txt&quot;,&quot;w&quot;);
   int t;
   for(t=0;t&lt;timescale;t++){
       double new[space+1];
       //cyclic boundary condition
       Asp[0] = Asp[space-1];
       Asp[space] = Asp[1];
       for(n=0;n&lt;producer;n++){
           Asp[P_basyo[n]] += b * Cd[P_basyo[n]];
       }
       for(x=1;x&lt;space;x++){
           new[x] = a*Asp[x-1] + (1.0 - 2.0*a)*Asp[x] + a*Asp[x+1];
       }
       for(x=1;x&lt;space;x++){
           Asp[x] = new[x];
       }
       for(x=1;x&lt;space;x++){
           Asp[x] -= Asp[x]*c;
       }
       for(n=0;n&lt;producer;n++){
           double kakuritu;
           //Chemotaxis for Cd and Asp
           kakuritu = bias*exp(P_Asp_now[n]-P_Asp_past[n])/(bias*exp(P_Asp_now[n]-P_Asp_past[n])+exp(P_Cd_now[n]-P_Cd_past[n]));
           //Randomly move
           //kakuritu = 0.5;
           //Chemotaxis for Asp (in  this case, we regard Cd as Asp)
           //kakuritu = exp(P_Cd_now[n]-P_Cd_past[n])/(1.0+exp(P_Cd_now[n]-P_Cd_past[n]));
           if(genrand_real3()&lt;kakuritu){
               P_basyo[n] += P_muki[n];
               if(P_basyo[n] == 0){
                   P_basyo[n] = space-1;
               }else if(P_basyo[n] == space){
                   P_basyo[n] = 1;
               }
           }else{
               P_muki[n] = -P_muki[n];
           }
       }
       for(n=0;n&lt;detecter;n++){
           double kakuritu;
           kakuritu = bias*exp(D_Asp_now[n]-D_Asp_past[n])/(bias*exp(D_Asp_now[n]-D_Asp_past[n])+exp(D_Cd_now[n]-D_Cd_past[n]));
           //kakuritu = 0.5;
           //kakuritu = exp(D_Cd_now[n]-D_Cd_past[n])/(1.0+exp(D_Cd_now[n]-D_Cd_past[n]));
           if(genrand_real3()&lt;kakuritu){
               D_basyo[n] += D_muki[n];
               if(D_basyo[n] == 0){
                   D_basyo[n] = space-1;
               }else if(D_basyo[n] == space){
                   D_basyo[n] = 1;
               }
           }else{
               D_muki[n] = -D_muki[n];
           }
       }
       for(n=0;n&lt;producer;n++){
           P_Asp_past[n] = P_Asp_now[n];
           P_Asp_now[n] = Asp[P_basyo[n]];
           P_Cd_past[n] = P_Cd_now[n];
           P_Cd_now[n] = Cd[P_basyo[n]];
       }
       for(n=0;n&lt;detecter;n++){
           D_Asp_past[n] = D_Asp_now[n];
           D_Asp_now[n] = Asp[D_basyo[n]];
           D_Cd_past[n] = D_Cd_now[n];
           D_Cd_now[n] = Cd[D_basyo[n]];
       }
   }
   int number[space+1];
   for(x=0;x&lt;space;x++){
       number[x] = 0;
   }
   for(n=0;n&lt;producer;n++){
       number[P_basyo[n]] += 1;
   }
   for(n=0;n&lt;detecter;n++){
       number[D_basyo[n]] += 1;
   }
   int tmp = 0;
   double tmp_Cd = 0.0;
   double tmp_asp = 0.0;
   int length = 10;
   /*
   for(x=0;x&lt;space;x++){
       tmp_Cd += Cd[x];
       tmp_asp += Asp[x];
       tmp += number[x];
       if(x%length == length-1){
           fprintf(fp,&quot;%d %d %f %f\n&quot;,x/length,tmp,tmp_Cd,tmp_asp);
           tmp = 0;
           tmp_Cd = 0.0;
           tmp_asp = 0.0;
       }
   }
   */
   for(x=0;x&lt;space;x++){
       fprintf(fp,&quot;%d %d %f %f\n&quot;,x,number[x],Cd[x],Asp[x]);
   }
   fclose(fp);
   FILE *gp;
   gp = popen(&quot;gnuplot&quot; , &quot;w&quot; );
   fprintf(gp, &quot;set terminal png\n&quot; );
    fprintf(gp, &quot;set output \&quot;/dev/null\&quot;\n&quot; );
    fprintf(gp,&quot;plot \&quot;result.txt\&quot; using 1:2 with points title 'Ecoli'\n&quot; );
    fprintf(gp,&quot;replot \&quot;result.txt\&quot; using 1:3 with points title 'Cd_concentration'\n&quot; );
    fprintf(gp, &quot;set output \&quot;result.png\&quot;\n&quot; );
    fprintf(gp,&quot;replot \&quot;result.txt\&quot; using 1:4 with points title 'Asp_concentration'\n&quot; );
   /*
   fprintf(gp, &quot;set output \&quot;/dev/null\&quot;\n&quot; );
   fprintf(gp,&quot;plot \&quot;result.txt\&quot; using 1:2 with points title 'Ecoli'\n&quot; );
   fprintf(gp, &quot;set output \&quot;result.png\&quot;\n&quot; );
   fprintf(gp,&quot;replot \&quot;result.txt\&quot; using 1:3 with points title 'Asp_concentration'\n&quot; );//In this case, we regard Cd as Asp.
   */
   /*
    fprintf(gp, &quot;set output \&quot;result.png\&quot;\n&quot; );
    fprintf(gp,&quot;plot \&quot;result.txt\&quot; using 1:2 with points title 'Ecoli'\n&quot; );
    */
   /*
    fprintf(gp, &quot;set output \&quot;result.png\&quot;\n&quot; );
    fprintf(gp,&quot;plot \&quot;result.txt\&quot; with lines title 'kazu'\n&quot; );
    */
   fflush(gp);
   fprintf(gp, &quot;exit\n&quot; );
   pclose(gp);
   return 0;
</PRE><P>}
</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2014.igem.org/Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c">http://2014.igem.org/Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:UT-Tokyo/Counter/Project/Humanpractice/nagahama.c&amp;oldid=327717" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2014.igem.org:Privacy_policy" title="2014.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2014.igem.org:General_disclaimer" title="2014.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>