<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Waterloo_Model skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Waterloo/Model</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P><NAV class="navbar navbar-toggleable-md navbar-inverse bg-primary fixed-top"><A class="navbar-brand" href="https://2018.igem.org/Team:Waterloo">Waterloo</A></NAV></P><DIV class="collapse navbar-collapse" id="navbarCollapse"><UL class="navbar-nav mr-auto"><LI class="nav-item"><A class="nav-link" href="https://2018.igem.org/Team:Waterloo"><SPAN>Home</SPAN></A></LI><LI class="dropdown nav-item"><A href="#" class="nav-link dropdown-toggle nav-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Team</A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Team"><SPAN>Team</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Meet_the_Microbes"><SPAN>Meet The Microbes</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Collaborations"><SPAN>Collaborations</SPAN></A></LI></UL><LI class="dropdown nav-item"><A href="#" class="nav-link dropdown-toggle nav-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Project</A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Description"><SPAN>Description</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Design"><SPAN>Design</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Experiments"><SPAN>Experiments</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Interlab"><SPAN>Interlab</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Demonstrate"><SPAN>Demonstrate</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Results"><SPAN>Results</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Notebook"><SPAN>Notebook</SPAN></A></LI><LI class="nav-item"><A class="nav-link" href="https://2018.igem.org/Team:Waterloo/Parts"><SPAN>Parts</SPAN></A></LI><LI class="nav-item"><A class="nav-link" href="https://2018.igem.org/Team:Waterloo/Safety"><SPAN>Safety</SPAN></A></LI><LI class="nav-item"><A class="nav-link" href="https://2018.igem.org/Team:Waterloo/Attributions"><SPAN>Attributions</SPAN></A></LI><LI class="dropdown nav-item"><A href="#" class="nav-link dropdown-toggle nav-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Human Practices</A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Human_Practices"><SPAN>Human Practices</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Engagement"><SPAN>Engagement</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/IAT"><SPAN>Iat</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Societal_Considerations"><SPAN>Societal Considerations</SPAN></A></LI><LI class="active dropdown nav-item"><A href="#" class="nav-link dropdown-toggle nav-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dry Lab</A></LI><LI class="active"><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Model"><SPAN>Model</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Software"><SPAN>Software</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Automation"><SPAN>Automation</SPAN></A></LI><LI class=""><A class="dropdown-item" href="https://2018.igem.org/Team:Waterloo/Turbidostat"><SPAN>Turbidostat</SPAN></A></LI></DIV><DIV class="content"><DIV class="titleBox row"><DIV class="layer"><DIV class="titleCaption col-xs-4"><H1>
	 		Model
        </H1></DIV></DIV></DIV><DIV class="model"><DIV class="row"><DIV class="col"><DIV class="content-main"><H2 id="model-formulation">Model Formulation</H2><P>Our system utlizes the CcaS/CcaR System as an optogenetic switch. When exposed to green light, the CcaS photoreceptor transfers its phosphate group to its binding partner, the CcaR molecule. The CcaR molecule then induces the expression of the gene of interest. Since the expression of MetE is crucial to the production of methionine, it is the optimal choice for our gene of interest. The production of methionine allows the cell to function and profilerate. In order to accurately measure the rate of proliferation, we have artifically inserted GFP, whose levels can be determined by a camera.</P><H5 id="formally-our-network-is-equivalent-to-">Formally, our network is equivalent to:</H5><P>\[ \frac{\textrm{CcaS}_{a}(t)}{dt} =  k_1 \ell(t) + k_9\textrm{Prolif}(t)\]</P><CENTER>The subscript 'a' indicates that we are tracking the rate of activation of the mentioned molecule.</CENTER><P>\[ \frac{\textrm{CcaR}_{a}(t)}{dt} =  k_2 \textrm{CcaS}_{a} (H(t-\tau_1)\cdot |t|) + k_8\textrm{Prolif}(t)\]</P><CENTER>Note that a Heaviside function is introduced to account for delay in the network.</CENTER><P>\[\frac{d\textrm{Prom}_{a}(t)}{dt} = \alpha_0 + \alpha \frac{\textrm{CcaR}_{a} (t)}{k_7 + \textrm{CcaR}(t)}\]</P><P>\[ \frac{d\textrm{MetE}(t)}{dt} = k_6\textrm{Prom}_{a}(t) \]</P><P>\[\textrm{Logistic}(t) =  \left( A+\frac{K-A}{(1+Qe^{-\beta t})^{1/\nu}} \right)\]</P><CENTER>All parameters excluding \(t\) (being time) are parameters which are arbitrary up to experiment. Q can be determined <EM>a priori</EM> based on the goals of our experiment, as it is specifically is related to our boundary conditions. </CENTER><P>\[ \frac{d\textrm{MetE}(t)}{dt} = \textrm{Logistic}_{1} (t) \cdot \textrm{CcaR}_{a}(H(t - \tau_2)\cdot |t|) \]</P><P>\[ \frac{d\textrm{Met}(t)}{dt} =  \textrm{Logistic}_{2} (t) \cdot \textrm{MetE}(H(t- \tau_3)\cdot |t|) + E_1 (t)\cdot k_3 \]</P><P>\[ \frac{d\textrm{GFP}(t)}{dt} =  \textrm{Logistic}_{3} (t) \cdot \textrm{Met}(H(t- \tau_4)\cdot |t|)+ E_2 (t)\cdot k_4 \]</P><P>\[ \frac{d\textrm{Prolif}(t)}{dt} =  \textrm{Logistic}_{4} (t) \cdot \textrm{Met}(H(t- \tau_5)\cdot |t|)+ E_3 (t)\cdot k_5 \]</P><P>\[\frac{dE_i (t)}{dt} = k_{i}\cdot \textrm{Prolif}(t)\]</P><P>\[\frac{dp_i (t)}{dt}=(k-d)\textrm{FP}_i (t) + \textrm{D}(t)\]</P><CENTER>\(\textrm{FP}_i (t)\) is the fluorescent protein corresponding to either culture 1 or culture 2.</CENTER><P>\[\frac{dR (t)}{dt} = \frac{d}{dt} \frac{p_1 (t)}{p_2 (t)} \]</P><CENTER>\(\frac{dR (t)}{dt}\) is the ratio which we are trying to control.</CENTER><P>We determined that this is the most accurate reaction network that could be derived in theory, specifically excluding stochastic noise. Stochastic control theory is still a rapidly developing field and software is not readily available.</P><H2 id="moving-horizon-estimate-mhe-">Moving Horizon Estimate (MHE)</H2><P>MHE is a state estimation method that utilizes multiple measurements over time.  These measurements contain noise and other random variations.  However, MHE will allow for the production of estimates of unknown variables and parameters in the measurements despite noise.  MHE necessitates an iterative approach relying on either linear programming or nonlinear programming solvers to find solutions.  This method is particularly useful for nonlinear or constrained dynamic systems for which few general models with established properties and parameters are available. We selected MHE due to its performance in environments where parameters are not precisely known.</P><P>MHE works by adjusting initial conditions and parameters within a model to align measured and predicted values.  To do this it uses an internal dynamic model, an optimization cost function over the estimation horizon, and requires a history of past measurements.</P><H2 id="error-dynamics-of-a-linearization-of-our-model">Error Dynamics of a Linearization of Our Model</H2><P>For a control system such as ours, the error dynamics are critical to derive. In order to make the dynamics feasible to compute, we only consider the error dynamics of controlling a single population under this linear model:</P><P>\[x_{k+1} = x_k + 0.025u_k + 0.05w_k,\]</P><P>\[y_k = Cx_k + 0.05v_k\]</P><P>where \(x\) is the doubling time, \(y\) is the population, \(u\) is the light intensity and \(w,v\)  are the process disturbance and measurement noise respectively. C is the proportionality constant in \(\frac{dp_i (t)}{dt}=C\cdot\textrm{FP}_i (t) + \textrm{D}(t)\)</P><P>Error dynamics are constructed by first applying the Karush-Kahn-Tucker (KKT) Conditions to the optimal problem solved by the MHE at a time \(T\), deriving the error dynamics at \(T-N\) and then use the equations derived to obtain the error dynamics at time \(T\). Following this standard technique <SUP>3</SUP> and assuming that both the process disturbance and measurement noise follow Gaussians centered at 0 with variances of 0.003 and 0.0013 respectively, we derive that</P><P>\[e_{T+1} = \begin{bmatrix} 0.4876 &amp; 0.5112 \\ 0.5215 &amp; 0.4587 \end{bmatrix} e_T + \begin{bmatrix} 0.0301 &amp; 0.0452 \\ 0.0231 &amp; 0.0621\end{bmatrix} \begin{bmatrix} W \\ V \end{bmatrix}.\]</P><P>There is significant evidence that MHE is significantly better than Kalman filtering and other more traditional techniques, not only practically but also through these derived error dynamics. There is a critical plane of process disturbance and measurement noise distributions that acts as a boundary between stable and unstable systems, that is, ones that we can prove asymptotic stability of and ones that can be prove to be asymptotically unstable. We did not determine this boundary because it requires extensive computation and is going to be inaccurate regardless given the linear model of our system. This boundary would provide the theoretical limits of how fine our control will be on cultures with our system. It is important to note that the derivation of error dynamics for MHE for complex systems such as our original network remains an active area of research.</P><H1 id="background-research">Background Research</H1><H2 id="characterizing-gene-expression-with-green-and-red-light-for-ccas-ccar">Characterizing Gene Expression with Green and Red Light for CcaS-CcaR</H2><P>The CcaS-CcaR system is activated by green light, and deactivated by red light.
To determine whether or not we should keep green or red light constant and modulate the other, and at what intensity this colour of light should be kept constant, literature data was used to fit parameters for Hill functions.  The Hill functions for the effect of red and green light on gene expression were then plot against each other three-dimensionally.  From this plot, an optimal range of gene expression can be picked and the value of intensity of either constant green or constant red light can be determined.  Therefore, from this analysis we know whether to modulate green or red light while keeping the other at constant value, as well as what constant value should be maintained, to provide an optimal gene expression range.</P><H4 id="green-light">Green Light</H4><P>Steady state protein expression from the CcaS-CcaR system was plotted with an increasing intensity of green input light.  The data was obtained from literature experiments and during these experiments, red light was held constant at an intensity of 1.05 W/m<SUP>2</SUP>.<SUP>2</SUP>
To capture the trend of the data and assign a single function across the entire range, curve fitting was performed.  A negative exponential curve fits the data well with the following attributes and values:
Exponential function: \(y = a+b^{\textrm{exp}({c^{2})}}\)</P><UL><LI>R<SUP>2</SUP>=0.96</LI><LI>Mean Squared Error=3.8</LI><LI>a=76.6</LI><LI>b=-71.2</LI><LI>c=-0.005</LI></UL><H4 id="red-light">Red Light</H4><P>The same analysis was done with red-light intensity.  Currently data is not available for CcaS-CcaR, therefore expression values for the Cph8-OmpR optogenetic system were used in its place.<SUP>2</SUP>
Exponential function: \(y = a+b^{\textrm{exp}({c^{2})}}\)</P><UL><LI>R<SUP>2</SUP>=0.96</LI><LI>Mean Squared Error=5.2</LI><LI>a=23.98</LI><LI>b=94.1</LI><LI>c=-0.007</LI></UL><H4 id="3-d-plot">3-D Plot</H4><H2 id="setting-the-frequency-and-duty-cycle-for-light-modulation">Setting the Frequency and Duty Cycle for Light Modulation</H2><P>To alter gene expression of the optogenetic system, the modulation of light can be used to provide different degrees of gene expression. In turn, the modulation of light can be affected by changing the either the frequency or period of modulation, or the duty cycle. However, changing the frequency or period, or changing the duty cycle will have effects on observed gene expression.<SUP>1</SUP> For the purposes of our system, it was decided to alter the duty cycle and keep the frequency constant.
Previous studies using the same optogenetic system expressing GFP and controlled using pulse-width modulation (PWM) demonstrated that frequency largely plays are role in modifying the amplitude of gene expression (difference between the maximal and minimal fluorescence values). Where a longer period indicated a larger amplitude.<SUP>1</SUP> This means that changing the period of light modulation affected variability of gene expression observed between light pulses. Since the goal of the project is a fine-tuned controller for growth rate, it would be more beneficial to use a shorter and fixed period to minimize variability of expression of the optogenetic system.
To determine what fixed period to use, certain boundaries must be kept in mind. First, the implementation of a PWM control strategy require that switching between 'on' and 'off' light signals occurs more rapidly than the system can respond.<SUP>1</SUP> This allows the system to average the input and return an even output, despite light modulation. Secondly, at low input period, the system cannot respond fast enough to track input signals for induction and repression, which is required for PWM control.<SUP>1</SUP> To remain within these boundaries, previous research indicates using a period in the range of 1-10 minutes.<SUP>1</SUP>
Thus, to vary the amount of light being delivered to the system to provide a continuous rate of gene expression, the duty cycle must be varied. The duty cycle, in our case, is defined as the percentage ratio of time the light is on to time the light is off.<SUP>1</SUP> For example, if the period is 100 seconds and the light is on for 75 seconds. The duty cycle would be 75%. Intuitively, a longer period indicates a greater amount of observed gene expression and vice versa.<SUP>1</SUP> Thus, by adjusting the duty cycle, different levels of gene expression can be observed.</P><H4 id="summary-">Summary:</H4><UL><LI>Decided to use a fixed period in the range of 1-10 minutes to minimize variability of expression of the optogenetic system controlled with pulse-width modulation.</LI><LI>Will adjust the duty cycle of PWM to affect levels of gene expression of the optogenetic system.</LI></UL><H4 id="references-">References:</H4><P><STRONG>1.</STRONG> Davidson, E. A., Basu, A. S., \&amp; Bayer, T. S. (2013). Programming Microbes Using Pulse Width Modulation of Optical Signals. <EM>Journal of Molecular Biology</EM>, 425(22), 4161–4166. doi:10.1016/j.jmb.2013.07.036</P><P><STRONG>2.</STRONG> Olson, E. J., Hartsough, L. A., Landry, B. P., Shroff, R., \&amp; Tabor, J. J. (2014). Characterizing bacterial gene circuit dynamics with optically programmed gene expression signals. Nature Methods, 11(4), 449-455. doi:10.1038/nmeth.2884</P><P><STRONG>3.</STRONG> Voelker, Anna, Konstantinos Kouramas, and Efstratios N. Pistikopoulos. &quot;Moving Horizon Estimation: Error Dynamics and Bounding Error Sets for Robust Control.&quot; Automatica 49, no. 4 (2013): 943-48. Accessed October 16, 2018. doi:10.1016/j.automatica.2013.01.008.</P></DIV></DIV></DIV></DIV></DIV><A href="#" class="go-top">Go Top</A><DIV class="footer"><H2>Waterloo iGEM 2018</H2><P>© 2018 Waterloo iGEM</P></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>