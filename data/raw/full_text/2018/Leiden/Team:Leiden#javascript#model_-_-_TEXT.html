Team:Leiden/javascript/model
// 1d model 1 disk Plotly.d3.csv(' https://static.igem.org/mediawiki/2018/4/4e/T--Leiden--1dsingle--t024.csv' , function(err, data) {
// https://static.igem.org/mediawiki/2018/4/4e/T--Leiden--1dsingle--t024.csv var traces = {}; //create container for all traces, sorted by Time
// Sort data by Time point (first column)  for (var i = 0; i < data.length; i++) {    var datum = data[i];    var Time = datum.Time;    var byTime;    if (!(byTime = traces[Time])) {      traces[Time] = {        x: [],        y: []      };    }    traces[Time].x.push(datum.Xvalues);    traces[Time].y.push(datum.Concentration);  }  var TimePoints = ['0', '0.5', '1', '3', '6', '12', '24', '48']  // Create the main trace:  var MainTrace = [];  var FirstData = traces[TimePoints[0]];  MainTrace.push({    x: FirstData.x.slice(),    y: FirstData.y.slice(),    type: 'scatter',    line: {      color: '#456990'    }  });
// Create a frame for each point of Time:  var frames = [];  for (i = 0; i < TimePoints.length; i++) {    frames.push({      name: TimePoints[i],      data: [traces[TimePoints[i]]]    })  }  // Now create slider steps, one for each frame. The slider  // executes a plotly.js API command (here, Plotly.animate).  var sliderSteps = [];  for (i = 0; i < TimePoints.length; i++) {    sliderSteps.push({      method: 'animate',      label: TimePoints[i] + ' hours',      args: [        [TimePoints[i]], {          mode: 'immediate',          transition: {            duration: 300          },          frame: {            duration: 300,            redraw: false          },        }      ]    });  }
var layout = {    autosize: false,    height: 500,    margin: {      l: 65,      r: 50,      b: 65    },    scene: {      xaxis: {        autorange: false,        range: [0, 92],        showspikes: false,        titlefont: {          family: 'Body'        },      },      yaxis: {        autorange: false,        showspikes: false      }    },    font: {      family: 'Body, verdana, sans-serif'    },    titlefont: {      family: 'Kopje'    }, plot_bgcolor: '#fdfdfd',    paper_bgcolor: '#fdfdfd',    xaxis: {      titlefont: {        family: 'Body'      },      title: 'Position (mm)'    },    yaxis: {      range: [-0.5, 10.5],      titlefont: {        family: 'Body'      },      title: 'Concentration (mg/mL)',    },    hovermode: false,    updatemenus: [{      x: 0.1,      y: 0,      yanchor: 'top',      xanchor: 'right',      showactive: false,      direction: 'left',      type: 'buttons',      pad: {        t: 107,        r: 20      },      buttons: [{        method: 'animate',        args: [null, {          mode: 'immediate',          fromcurrent: true,          transition: {            duration: 600          },          frame: {            duration: 1000,            redraw: false          }        }],        label: 'Play'      }]    }],    // Finally, add the slider and use `pad` to position it    // nicely next to the buttons.    sliders: [{      pad: {        t: 80      },      x: 0.1,      len: 0.9,      currentvalue: {        xanchor: 'right',        prefix: 'Time: ',        font: {          color: '#888',          size: 20        }      },      transition: {        duration: 500      },      steps: sliderSteps    }]  };
var options = {    showLink: false,    displayModeBar: false  };
// Create the plot:  Plotly.plot('plot1d', {    data: MainTrace,    layout: layout,    frames: frames,    config: options  });
});
// ************************************************************************************************************************* // 1D model - 2 disks Plotly.d3.csv(' https://static.igem.org/mediawiki/2018/2/28/T--Leiden--Model1dmodel2diskst048.csv' , function(err, data) {
// https://static.igem.org/mediawiki/2018/2/28/T--Leiden--Model1dmodel2diskst048.csv var traces = {}; //create container for all traces, sorted by Time
// Sort data by Time point (first column)  for (var i = 0; i < data.length; i++) {    var datum = data[i];    var Time = datum.Time;    var byTime;    if (!(byTime = traces[Time])) {      traces[Time] = {        x: [],        y: []      };    }    traces[Time].x.push(datum.Xvalues);    traces[Time].y.push(datum.Concentration);  }  var TimePoints = ['0', '0.5', '1', '3', '6', '12', '24', '48']  // Create the main trace:  var MainTrace = [];  var FirstData = traces[TimePoints[0]];  MainTrace.push({    x: FirstData.x.slice(),    y: FirstData.y.slice(),    type: 'scatter',    line: {      color: '#456990'    }  });
// Create a frame for each point of Time:  var frames = [];  for (i = 0; i < TimePoints.length; i++) {    frames.push({      name: TimePoints[i],      data: [traces[TimePoints[i]]]    })  }  // Now create slider steps, one for each frame. The slider  // executes a plotly.js API command (here, Plotly.animate).  var sliderSteps = [];  for (i = 0; i < TimePoints.length; i++) {    sliderSteps.push({      method: 'animate',      label: TimePoints[i] + ' hours',      args: [        [TimePoints[i]], {          mode: 'immediate',          transition: {            duration: 300          },          frame: {            duration: 300,            redraw: false          },        }      ]    });  }
var layout = {    autosize: false,    height: 500,    margin: {      l: 65,      r: 50,      b: 65    },    scene: {      xaxis: {        autorange: false,        range: [0, 92],        showspikes: false,        titlefont: {          family: 'Body'        },      },      yaxis: {        autorange: false,        showspikes: false      }    },    font: {      family: 'Body, verdana, sans-serif'    },    titlefont: {      family: 'Kopje'    },    plot_bgcolor: '#fdfdfd',    paper_bgcolor: '#fdfdfd',    xaxis: {      titlefont: {        family: 'Body'      },      title: 'Position (mm)'    },    yaxis: {      range: [-0.5, 10.5],      titlefont: {        family: 'Body'      },      title: 'Concentration (mg/mL)',    },    hovermode: false,    updatemenus: [{      x: 0.1,      y: 0,      yanchor: 'top',      xanchor: 'right',      showactive: false,      direction: 'left',      type: 'buttons',      pad: {        t: 107,        r: 20      },      buttons: [{        method: 'animate',        args: [null, {          mode: 'immediate',          fromcurrent: true,          transition: {            duration: 600          },          frame: {            duration: 1000,            redraw: false          }        }],        label: 'Play'      }]    }],    // Finally, add the slider and use `pad` to position it    // nicely next to the buttons.    sliders: [{      pad: {        t: 80      },      x: 0.1,      len: 0.9,      currentvalue: {        xanchor: 'right',        prefix: 'Time: ',        font: {          color: '#888',          size: 20        }      },      transition: {        duration: 500      },      steps: sliderSteps    }]  };
var options = {    showLink: false,    displayModeBar: false  };
// Create the plot:  Plotly.plot('plot1dmulti', {    data: MainTrace,    layout: layout,    frames: frames,    config: options  });
});
// ************************************* 2d model, multiple disks ************************************* //
var z_data = {},
xy_data = [];
Plotly.d3.csv(' https://static.igem.org/mediawiki/2018/b/b9/T--Leiden--2dmulti--t0.csv' , function(err, rows) {
z_data.t0 = rows.map(function(obj) {    return Object.keys(obj).sort(function(a, b) {      return a - b;    }).map(function(key) {      return obj[key];    });  });
});
Plotly.d3.csv(' https://static.igem.org/mediawiki/2018/5/58/T--Leiden--2dmulti--t05.csv' , function(err, rows) {
z_data.t05 = rows.map(function(obj) {    return Object.keys(obj).sort(function(a, b) {      return a - b;    }).map(function(key) {      return obj[key];    });  });
});
Plotly.d3.csv(' https://static.igem.org/mediawiki/2018/f/f2/T--Leiden--2dmulti--t1.csv' , function(err, rows) {
z_data.t1 = rows.map(function(obj) {    return Object.keys(obj).sort(function(a, b) {      return a - b;    }).map(function(key) {      return obj[key];    });  });
});
Plotly.d3.csv(' https://static.igem.org/mediawiki/2018/d/d1/T--Leiden--2dmulti--t3.csv' , function(err, rows) {
z_data.t3 = rows.map(function(obj) {    return Object.keys(obj).sort(function(a, b) {      return a - b;    }).map(function(key) {      return obj[key];    });  });
});
Plotly.d3.csv(' https://static.igem.org/mediawiki/2018/9/95/T--Leiden--2dmulti--t6.csv' , function(err, rows) {
z_data.t6 = rows.map(function(obj) {    return Object.keys(obj).sort(function(a, b) {      return a - b;    }).map(function(key) {      return obj[key];    });  });
}); Plotly.d3.csv(' https://static.igem.org/mediawiki/2018/5/54/T--Leiden--2dmulti--t12.csv' , function(err, rows) {
z_data.t12 = rows.map(function(obj) {    return Object.keys(obj).sort(function(a, b) {      return a - b;    }).map(function(key) {      return obj[key];    });  });
}); Plotly.d3.csv(' https://static.igem.org/mediawiki/2018/f/fe/T--Leiden--2dmulti--t24.csv' , function(err, rows) {
z_data.t24 = rows.map(function(obj) {    return Object.keys(obj).sort(function(a, b) {      return a - b;    }).map(function(key) {      return obj[key];    });  });
}); Plotly.d3.csv(' https://static.igem.org/mediawiki/2018/d/d3/T--Leiden--2dmulti--t48.csv' , function(err, rows) {
z_data.t48 = rows.map(function(obj) {    return Object.keys(obj).sort(function(a, b) {      return a - b;    }).map(function(key) {      return obj[key];    });  });
xy_data = Object.keys(rows[0]).sort(function(a, b) {    return a - b;  });
var data = [{    z: z_data.t0,    x: xy_data,    y: xy_data,    type: 'surface',    cauto: false,    cmin: 0,    cmax: 1,    autocolorscale: false,    colorscale: [      [0, 'rgb(69,105,144)'],      // [0.3, 'rgb(73,190,170)'],      // [0.5, 'rgb(73,220,177)'],      [0.05, 'rgb(255,179,117)'],      [0.39, 'rgb(244,31,31)'],      [0.41, 'rgb(17,17,17)'],      [1, 'rgb(17,17,17)']    ],    hoverinfo: 'none',    contours: {      x: {        highlight: false      },      y: {        highlight: false      },      z: {        highlight: true      }    },    colorbar: {      title: 'Antibiotic
concentration
.',      titlefont: {        family: 'Body',        size: 14      },      ticksuffix: ' mg/mL'    }  }];
// set display options  var options = {    showLink: false,    displayModeBar: false  };  // var TimePoints = Object.keys(z_data)  var TimePoints = ['t0', 't05', 't1', 't3', 't6', 't12', 't24', 't48']  var frames = [];  for (i = 0; i < TimePoints.length; i++) {    frames.push({      name: TimePoints[i],      data: [{        z: z_data[TimePoints[i]]      }]    })  };
var TimeLabels = ['0 hours', '0.5 hours', '1 hour', '3 hours', '6 hours', '12 hours', '24 hours', '48 hours']  var sliderSteps = [];  for (i = 0; i < TimePoints.length; i++) {    sliderSteps.push({      method: 'animate',      label: TimeLabels[i],      args: [        [TimePoints[i]], {          mode: 'immediate',          transition: {            duration: 500          },          frame: {            duration: 500,            redraw: false          },        }      ]    });  }
var layout = {    // title: 'Disk diffusion model',    autosize: false,    height: 650,    margin: {      l: 65,      r: 50,      b: 65,      t: 120,    },    scene: {      zaxis: {        autorange: false,        range: [0, 11],        showspikes: false,        titlefont: {          family: 'Body'        },        title: 'Concentration (mg/mL)'      },      xaxis: {        autorange: false,        range: [0, 92],        showspikes: false,        titlefont: {          family: 'Body'        },        title: 'x (mm)'      },      yaxis: {        autorange: false,        range: [0, 92],        showspikes: false,        titlefont: {          family: 'Body'        },        title: 'y (mm)'      }    },    font: {      family: 'Body, verdana, sans-serif'    },    titlefont: {      family: 'Kopje'    },    plot_bgcolor: '#fdfdfd',    paper_bgcolor: '#fdfdfd',    xaxis: {      titlefont: {        family: 'Body'      }    },    sliders: [{      pad: {        t: 30      },      x: 0.15,      len: 0.7,      currentvalue: {        xanchor: 'right',        prefix: 'Time: ',        font: {          color: '#888',          size: 20        }      },      transition: {        duration: 500      },      // By default, animate commands are bound to the most recently animated frame:      steps: sliderSteps    }],    updatemenus: [{      type: 'buttons',      showactive: false,      x: 0.15,      y: 0,      xanchor: 'right',      yanchor: 'top',      pad: {        t: 60,        r: 20      }, buttons: [{        label: 'Play',        method: 'animate',        args: [null, {          fromcurrent: true,          frame: {            redraw: false,            duration: 1500          },          transition: {            duration: 500          }        }]      }]    }]  };
// //  static plot thingies:  //  // data.lightposition = {  //   z: 50,  //   x: 46,  //   y: 46  // };  // layout.scene.xaxis.visible = false;  // layout.scene.yaxis.visible = false;  // layout.scene.zaxis.visible = false;  // layout.scene.camera = {  //   eye: {  //     x: 0,  //     y: 0,  //     z: 1  //   }  // };
Plotly.plot('plot2d3disks', {    data: data,    layout: layout,    frames: frames,    config: options  });
});
