<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_CPU_CHINA_js_magazine_js skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:CPU CHINA/js/magazine.js</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P>/*
</P><PRE>* Magazine sample
</PRE><UL><LI>/</LI></UL><P>function setArrows() {	
	/*var width = $(window).width();
</P><P>	//alert(&quot;chushihua&quot;+width);		
	var height = $(window).height();
	var bookWidth = $(&quot;.magazine&quot;).width();
	var bookHeight = $(&quot;.magazine&quot;).height();
	//alert(&quot;chushihua&quot;+bookWidth);		
	var arrowSize = $(&quot;.next-button&quot;).width();
	//alert(arrowSize);
</P><PRE>  alert($(&quot;.magazine&quot;).offset().left+&quot;\n&quot;+$('.next-button').offset().left);
</PRE><P>	var LeftArrowLeft = - ( width - bookWidth ) / 4 + 'px' ;
	//alert(LeftArrowLeft);
	var RightArrowLeft = - ( width - bookWidth+ arrowSize*2) / 4 + 'px' ;
	//alert(RightArrowLeft); 
	//alert(RightArrowLeft);
		//alert(&quot;zhihou&quot;+bookWidth);	
</P><P>	$('.next-button').css( &quot;right&quot;,RightArrowLeft );
	$('.previous-button').css( &quot;left&quot;, LeftArrowLeft );*/
	setTimeout(function(){
	var width = $(window).width();
	var bookWidth = $(&quot;.magazine&quot;).width();
	var arrowSize = $(&quot;.next-button&quot;).width();
	var magaLeft=$(&quot;.magazine&quot;).offset().left;
	var nextLeft= (width-bookWidth-magaLeft-60)/2;
	//alert(&quot;width &quot;+width +&quot;\nbookWidth :&quot;+bookWidth +&quot;\nmagaLeft:&quot;+magaLeft+&quot;\nnextLeft:&quot;+nextLeft);
	$('.next-button').animate({ &quot;right&quot;:nextLeft},300);
</P><P>	$('.previous-button').animate({ &quot;left&quot;:nextLeft},300);
	},100);
</P><P>}
</P><P>
function addPage(page, book) {
</P><PRE>   var id, pages = book.turn('pages');
</PRE><PRE>   // Create a new element for this page
   var element = $('&lt;div /&gt;', {});
</PRE><PRE>   // Add the page to the flipbook
   if (book.turn('addPage', element, page)) {
</PRE><PRE>       // Add the initial HTML
       // It will contain a loader indicator and a gradient
</PRE>
        element.html('');
<PRE>       // Load the page
       loadPage(page, element);
   }
</PRE><P>}
</P><P>function loadPage(page, pageElement) {
</P><PRE>   // Create an image element
   var img = $('&lt;img /&gt;');
</PRE><PRE>   img.mousedown(function(e) {
       e.preventDefault();
   });
</PRE><PRE>   img.load(function() {
</PRE><PRE>       // Set the size
       $(this).css({
           width: '100%',
           height: '100%'
       });
</PRE><PRE>       // Add the image to the page after loaded
       $(this).appendTo(pageElement);
</PRE><PRE>       // Remove the loader indicator
       pageElement.find('.loader').remove();
   });
</PRE><PRE>   // Load the page
   if(page==1){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/2/2a/T--CPU_CHINA--hp-page1.png'">https://static.igem.org/mediawiki/2018/2/2a/T--CPU_CHINA--hp-page1.png'</A>);
   }else if(page==2){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/a/a0/T--CPU_CHINA--hp-page2.png'">https://static.igem.org/mediawiki/2018/a/a0/T--CPU_CHINA--hp-page2.png'</A>);
   }else if(page==3){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/c/cf/T--CPU_CHINA--hp-page3.png'">https://static.igem.org/mediawiki/2018/c/cf/T--CPU_CHINA--hp-page3.png'</A>);
   }else if(page==4){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/3/34/T--CPU_CHINA--hp-page4.png'">https://static.igem.org/mediawiki/2018/3/34/T--CPU_CHINA--hp-page4.png'</A>);
   }else if(page==5){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/7/7d/T--CPU_CHINA--hp-page5.png'">https://static.igem.org/mediawiki/2018/7/7d/T--CPU_CHINA--hp-page5.png'</A>);
   }else if(page==6){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/c/c9/T--CPU_CHINA--hp-page6.png'">https://static.igem.org/mediawiki/2018/c/c9/T--CPU_CHINA--hp-page6.png'</A>);
   }else if(page==7){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/8/8c/T--CPU_CHINA--hp-page7.png'">https://static.igem.org/mediawiki/2018/8/8c/T--CPU_CHINA--hp-page7.png'</A>);
   }
</PRE><PRE>   loadRegions(page, pageElement);
</PRE><P>}
</P><P>// Zoom in / Zoom out
function zoomTo(event) {
</P><PRE>   setTimeout(function() {
       if ($('.magazine-viewport').data().regionClicked) {
           $('.magazine-viewport').data().regionClicked = false;
       } else {
           if ($('.magazine-viewport').zoom('value') == 1) {
               $('.magazine-viewport').zoom('zoomIn', event);
           } else {
               $('.magazine-viewport').zoom('zoomOut');
           }
       }
   },
   1);
</PRE><P>}
</P><P>// Load regions
function loadRegions(page, element) {
</P><PRE>   $.getJSON('pages/' + page + '-regions.json').done(function(data) {
</PRE><PRE>       $.each(data,
       function(key, region) {
           addRegion(region, element);
       });
   });
</PRE><P>}
</P><P>// Add region
function addRegion(region, pageElement) {
</P><PRE>   var reg = $('&lt;div /&gt;', {
       'class': 'region  ' + region['class']
   }),
   options = $('.magazine').turn('options'),
   pageWidth = options.width / 2,
   pageHeight = options.height;
</PRE><PRE>   reg.css({
       top: Math.round(region.y / pageHeight * 100) + '%',
       left: Math.round(region.x / pageWidth * 100) + '%',
       width: Math.round(region.width / pageWidth * 100) + '%',
       height: Math.round(region.height / pageHeight * 100) + '%'
   }).attr('region-data', $.param(region.data || <I>));</I></PRE><PRE>   reg.appendTo(pageElement);
</PRE><P>}
</P><P>// Process click on a region
function regionClick(event) {
</P><PRE>   var region = $(event.target);
</PRE><PRE>   if (region.hasClass('region')) {
</PRE><PRE>       $('.magazine-viewport').data().regionClicked = true;
</PRE><PRE>       setTimeout(function() {
           $('.magazine-viewport').data().regionClicked = false;
       },
       100);
</PRE><PRE>       var regionType = $.trim(region.attr('class').replace('region', <I>));</I></PRE><PRE>       return processRegion(region, regionType);
</PRE><PRE>   }
</PRE><P>}
</P><P>// Process the data of every region
function processRegion(region, regionType) {
</P><PRE>   data = decodeParams(region.attr('region-data'));
</PRE><PRE>   switch (regionType) {
   case 'link':
</PRE><PRE>       window.open(data.url);
</PRE><PRE>       break;
   case 'zoom':
</PRE><PRE>       var regionOffset = region.offset(),
       viewportOffset = $('.magazine-viewport').offset(),
       pos = {
           x: regionOffset.left - viewportOffset.left,
           y: regionOffset.top - viewportOffset.top
       };
</PRE><PRE>       $('.magazine-viewport').zoom('zoomIn', pos);
</PRE><PRE>       break;
   case 'to-page':
       $('.magazine').turn('page', data.page);
       break;
   }
</PRE><P>}
</P><P>// Load large page
function loadLargePage(page, pageElement) {
</P><PRE>   var img = $('&lt;img /&gt;');
</PRE><PRE>   img.load(function() {
</PRE><PRE>       var prevImg = pageElement.find('img');
       $(this).css({
           width: '100%',
           height: '100%'
       });
       $(this).appendTo(pageElement);
       prevImg.remove();
</PRE><PRE>   });
</PRE><PRE>   // Loadnew page
   if(page==1){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/2/2a/T--CPU_CHINA--hp-page1.png'">https://static.igem.org/mediawiki/2018/2/2a/T--CPU_CHINA--hp-page1.png'</A>);
   }else if(page==2){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/a/a0/T--CPU_CHINA--hp-page2.png'">https://static.igem.org/mediawiki/2018/a/a0/T--CPU_CHINA--hp-page2.png'</A>);
   }else if(page==3){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/c/cf/T--CPU_CHINA--hp-page3.png'">https://static.igem.org/mediawiki/2018/c/cf/T--CPU_CHINA--hp-page3.png'</A>);
   }else if(page==4){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/3/34/T--CPU_CHINA--hp-page4.png'">https://static.igem.org/mediawiki/2018/3/34/T--CPU_CHINA--hp-page4.png'</A>);
   }else if(page==5){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/7/7d/T--CPU_CHINA--hp-page5.png'">https://static.igem.org/mediawiki/2018/7/7d/T--CPU_CHINA--hp-page5.png'</A>);
   }else if(page==6){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/c/c9/T--CPU_CHINA--hp-page6.png'">https://static.igem.org/mediawiki/2018/c/c9/T--CPU_CHINA--hp-page6.png'</A>);
   }else if(page==7){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/8/8c/T--CPU_CHINA--hp-page7.png'">https://static.igem.org/mediawiki/2018/8/8c/T--CPU_CHINA--hp-page7.png'</A>);
   }
</PRE><P>}
</P><P>// Load small page
function loadSmallPage(page, pageElement) {
</P><PRE>   var img = pageElement.find('img');
</PRE><PRE>   img.css({
       width: '100%',
       height: '100%'
   });
</PRE><PRE>   img.unbind('load');
   // Loadnew page
   if(page==1){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/2/2a/T--CPU_CHINA--hp-page1.png'">https://static.igem.org/mediawiki/2018/2/2a/T--CPU_CHINA--hp-page1.png'</A>);
   }else if(page==2){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/a/a0/T--CPU_CHINA--hp-page2.png'">https://static.igem.org/mediawiki/2018/a/a0/T--CPU_CHINA--hp-page2.png'</A>);
   }else if(page==3){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/c/cf/T--CPU_CHINA--hp-page3.png'">https://static.igem.org/mediawiki/2018/c/cf/T--CPU_CHINA--hp-page3.png'</A>);
   }else if(page==4){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/3/34/T--CPU_CHINA--hp-page4.png'">https://static.igem.org/mediawiki/2018/3/34/T--CPU_CHINA--hp-page4.png'</A>);
   }else if(page==5){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/7/7d/T--CPU_CHINA--hp-page5.png'">https://static.igem.org/mediawiki/2018/7/7d/T--CPU_CHINA--hp-page5.png'</A>);
   }else if(page==6){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/c/c9/T--CPU_CHINA--hp-page6.png'">https://static.igem.org/mediawiki/2018/c/c9/T--CPU_CHINA--hp-page6.png'</A>);
   }else if(page==7){
       img.attr('src', '<A rel="nofollow" class="external free" href="https://static.igem.org/mediawiki/2018/8/8c/T--CPU_CHINA--hp-page7.png'">https://static.igem.org/mediawiki/2018/8/8c/T--CPU_CHINA--hp-page7.png'</A>);
   }
</PRE><P>}
</P><P>// <A rel="nofollow" class="external free" href="http://code.google.com/p/chromium/issues/detail?id=128488">http://code.google.com/p/chromium/issues/detail?id=128488</A>
function isChrome() {
</P><PRE>   return navigator.userAgent.indexOf('Chrome') != -1;
</PRE><P>}
</P><P>function disableControls(page) {
</P><PRE>   if (page == 1) $('.previous-button').hide();
   else $('.previous-button').show();
</PRE><PRE>   if (page == $('.magazine').turn('pages')) $('.next-button').hide();
   else $('.next-button').show();
</PRE><P>}
</P><P>// Set the width and height for the viewport
function resizeViewport() {
</P><PRE>   var width = $(window).width(),
   height = $(window).height(),
   options = $('.magazine').turn('options');
</PRE><PRE>   $('.magazine').removeClass('animated');
</PRE><PRE>   $('.magazine-viewport').css({
       width: width,
       height: height
   }).zoom('resize');
   setArrows() ;
</PRE><PRE>   if ($('.magazine').turn('zoom') == 1) {
       var bound = calculateBound({
           width: options.width,
           height: options.height,
           boundWidth: Math.min(options.width, width),
           boundHeight: Math.min(options.height, height)
       });
</PRE><PRE>       if (bound.width % 2 !== 0) bound.width -= 1;
</PRE><PRE>       if (bound.width != $('.magazine').width() || bound.height != $('.magazine').height()) {
</PRE><PRE>           $('.magazine').turn('size', bound.width, bound.height);
</PRE><PRE>           if ($('.magazine').turn('page') == 1) $('.magazine').turn('peel', 'br'); 
     </PRE><PRE>       }
</PRE><PRE>       $('.magazine').css({
           top: -bound.height / 2,
           left: -bound.width / 2
       });
   }
</PRE><PRE>   var magazineOffset = $('.magazine').offset(),
   boundH = height - magazineOffset.top - $('.magazine').height(),
   marginTop = (boundH - $('.thumbnails &gt; div').height()) / 2;
</PRE><PRE>   if (marginTop &lt; 0) {
       $('.thumbnails').css({
           height: 1
       });
   } else {
       $('.thumbnails').css({
           height: boundH
       });
       $('.thumbnails &gt; div').css({
           marginTop: marginTop
       });
   }
</PRE><PRE>   if (magazineOffset.top &lt; $('.made').height()) $('.made').hide();
   else $('.made').show();
</PRE><PRE>   $('.magazine').addClass('animated');
</PRE><P>}
</P><P>// Number of views in a flipbook
function numberOfViews(book) {
</P><PRE>   return book.turn('pages') / 2 + 1;
</PRE><P>}
</P><P>// Current view in a flipbook
function getViewNumber(book, page) {
</P><PRE>   return parseInt((page || book.turn('page')) / 2 + 1, 10);
</PRE><P>}
</P><P>// Width of the flipbook when zoomed in
function largeMagazineWidth() {
</P><PRE>   return 2214;
</PRE><P>}
</P><P>// decode URL Parameters
function decodeParams(data) {
</P><PRE>   var parts = data.split('&amp;'),
   d,
   obj = {};
   for (var i = 0; i &lt; parts.length; i++) {
       d = parts[i].split('=');
       obj[decodeURIComponent(d[0])] = decodeURIComponent(d[1]);
   }
   return obj;
</PRE><P>}
</P><P>// Calculate the width and height of a square within another square
function calculateBound(d) {
</P><PRE>   var bound = {
       width: d.width,
       height: d.height
   };
   if (bound.width &gt; d.boundWidth || bound.height &gt; d.boundHeight) {
       var rel = bound.width / bound.height;
       if (d.boundWidth / rel &gt; d.boundHeight &amp;&amp; d.boundHeight * rel &lt;= d.boundWidth) {
           bound.width = Math.round(d.boundHeight * rel);
           bound.height = d.boundHeight;
       } else {
           bound.width = d.boundWidth;
           bound.height = Math.round(d.boundWidth / rel);
       }
   }
   return bound;
</PRE><P>}
</P></DIV></DIV></DIV></DIV></DIV></BODY></HTML>