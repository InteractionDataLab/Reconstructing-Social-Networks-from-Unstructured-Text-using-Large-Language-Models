<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_CPU_CHINA_js_hash_js skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:CPU CHINA/js/hash js</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P>/**
</P><PRE>* hash.js
*
* Copyright (C) 2012 Emmanuel Garcia
* MIT Licensed
*
* ****************************************
*
* Hash.pushState(true);
*
* Hash.on('/page/([0-9]+)$',
*	{yep: function(path, parts) { }, nop: function() { }},
*	'Page $1');
*
* Hash.go('/page/1');
**/
</PRE><P>(function() {
</P><PRE>   'use strict';
</PRE><PRE>   var hashes = {},
   regexp = {},
   history = [],
   freq = 100,
   num = 0,
   pushState = false,
   timer = null,
   currentUrl = null,
</PRE><PRE>   freeze = function(obj) {
       if (Object.freeze) return Object.freeze(obj);
       return obj;
   },
</PRE><PRE>   getHashParts = function() {
       return window.location.href.split('#');
   },
</PRE><PRE>   startTimer = function() {
</PRE><PRE>       if (!timer) timer = setInterval(function() {
           if (num &gt; 0 &amp;&amp; currentUrl != window.location.href) {
               currentUrl = window.location.href;
               window.Hash.check();
           }
       },
       freq);
</PRE><PRE>   },
</PRE><PRE>   stopTimer = function() {
</PRE><PRE>       if (timer) {
           clearInterval(timer);
           timer = null;
       }
</PRE><PRE>   };
</PRE><PRE>   window.Hash = freeze({
</PRE><PRE>       pushState: function(yes) {
           if (window.history &amp;&amp; window.history.pushState) pushState = yes;
           return this;
       },
</PRE><PRE>       fragment: function() {
           var hash = getHashParts();
           return (pushState) ? window.location.pathname + ((hash[1]) ? '#' + hash[1] : <I>) : hash[1] || </I>;
       },
</PRE><PRE>       get: function(path, params) {
           var p, fragment = <I>,</I>
           parameters = [];
           for (p in params) {
               if (!Object.prototype.hasOwnProperty(p)) continue;
               parameters.push(encodeURIComponent(p) + '=' + encodeURIComponent(params[p]));
           }
           if (parameters.length &gt; 0) parameters = '?' + parameters.join('&amp;');
           return (pushState) ? path + parameters: getHashParts()[0] + '#' + path + parameters;
       },
</PRE><PRE>       go: function(hash, params) {
           if (this.fragment() != hash) {
               var to = this.get(hash, params);
               if (pushState) window.history.pushState(null, document.title, to);
               else window.location.href = to;
           }
           return this;
       },
</PRE><PRE>       update: function() {
           currentUrl = window.location.href;
           return this;
       },
</PRE><PRE>       on: function(hash, callback, title) {
           if (!hashes[hash]) hashes[hash] = {
               title: title,
               listeners: []
           };
</PRE><PRE>           hashes[hash].listeners.push(callback);
           num++;
           startTimer();
           return this;
       },
</PRE><PRE>       check: function() {
           var i, hash, parts, fragment = this.fragment();
           for (hash in hashes) {
               if (!Object.prototype.hasOwnProperty.call(hashes, hash)) continue;
               hashes[hash].regexp = hashes[hash].regexp || new RegExp(hash);
               if ((parts = hashes[hash].regexp.exec(fragment))) {
                   if (hashes[hash].title) document.title = hashes[hash].title;
                   for (i = 0; i &lt; hashes[hash].listeners.length; i++) if (hashes[hash].listeners[i].yep) hashes[hash].listeners[i].yep(fragment, parts);
               } else {
                   for (i = 0; i &lt; hashes[hash].listeners.length; i++) if (hashes[hash].listeners[i].nop) hashes[hash].listeners[i].nop(fragment);
               }
           }
           return this;
       }
   });
</PRE><P>})();
</P></DIV></DIV></DIV></DIV></DIV></BODY></HTML>