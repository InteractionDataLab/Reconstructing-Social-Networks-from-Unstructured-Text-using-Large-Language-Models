<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_CPU_CHINA_hp_page_js skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:CPU CHINA/hp page js</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P>function loadApp() {
</P><PRE>	$('#canvas').fadeIn(1000);
</PRE><PRE>	var flipbook = $('.magazine');
</PRE><PRE>	// Check if the CSS was already loaded	
</PRE><P>	if (flipbook.width()==0 || flipbook.height()==0) {
</P><P>		setTimeout(loadApp, 10);
</P><P>		return;
</P><P>	}	
</P><P>	// 创建flipbook
</P><P>	flipbook.turn({			
</P><P>			width: 1200,
</P><PRE> 			height: 781,
</PRE><P>			duration: 1000,   //翻页速度，值越小越快
</P><P>			// Hardware acceleration
</P><P>			acceleration: !isChrome(),
</P><P>			// Enables gradients
</P><P>			gradients: true,			
</P><P>			// Auto center this flipbook
</P><P>			autoCenter: true,
</P><P>			// Elevation from the edge of the flipbook when turning a page
</P><P>			elevation: 50,
</P><P>			// The number of pages
</P><P>			pages: 7,
</P><P>			// Events
</P><P>			when: {
</P><P>				turning: function(event, page, view) {					
</P><P>					var book = $(this),
</P><P>					currentPage = book.turn('page'),
</P><P>					pages = book.turn('pages');			
</P><P>					// Update the current URI
</P><P>					Hash.go('page/' + page).update();
</P><P>					// Show and hide navigation buttons
</P><P>					disableControls(page); 				
</P><P>				},
</P><P>				turned: function(event, page, view) {
</P><P>					disableControls(page);
</P><P>					$(this).turn('center');
</P><P>					if (page==1) { 
</P><P>						$(this).turn('peel', 'br');
</P><P>					}
</P><P>				},
</P><P>				missing: function (event, pages) {
</P><P>					// Add pages that aren't in the magazine
</P><P>					for (var i = 0; i &lt; pages.length; i++)
</P><P>						addPage(pages[i], $(this));
</P><P>				}
</P><P>			}
</P><P>	});
</P><P>	// Zoom.js
</P><P>	$('.magazine-viewport').zoom({
</P><P>		flipbook: $('.magazine'),
</P><P>		max: function() { 			
</P><P>			return largeMagazineWidth()/$('.magazine').width();
</P><P>		}, 
</P><P>		when: {
</P><P>			swipeLeft: function() {
</P><P>				$(this).zoom('flipbook').turn('next');
</P><P>			},
</P><P>			swipeRight: function() {				
</P><P>				$(this).zoom('flipbook').turn('previous');
</P><P>			},
</P><P>			resize: function(event, scale, page, pageElement) {
</P><P>				if (scale==1)
</P><P>					loadSmallPage(page, pageElement);
</P><P>				else
</P><P>					loadLargePage(page, pageElement);
</P><P>			},
</P><P>			zoomIn: function () {
</P><P>				$('.made').hide();
</P><P>				$('.magazine').removeClass('animated').addClass('zoom-in');
</P><P>				$('.zoom-icon').removeClass('zoom-icon-in').addClass('zoom-icon-out');				
</P><P>				if (!window.escTip&amp;&amp;!$.isTouch) {
</P><P>					escTip = true;
</P><P>					$('&lt;div /&gt;', {'class': 'exit-message'}).
</P>
						html('<DIV>Press ESC to exit</DIV>').
<P>							appendTo($('body')).
</P><P>							delay(2000).
</P><P>							animate({opacity:0}, 500, function() {
</P><P>								$(this).remove();
</P><P>							});
</P><P>				}
</P><P>			},
</P><P>			zoomOut: function () {
</P><P>				$('.exit-message').hide();
</P><P>				$('.thumbnails').fadeIn();
</P><P>				$('.made').fadeIn();
</P><P>				$('.zoom-icon').removeClass('zoom-icon-out').addClass('zoom-icon-in');
</P><P>				setTimeout(function(){
</P><P>					$('.magazine').addClass('animated').removeClass('zoom-in');
</P><P>					resizeViewport();
</P><P>				}, 0);
</P><P>			}
</P><P>		}
</P><P>	});
</P><P>	// Zoom event
</P><P>	if ($.isTouch)
</P><P>		$('.magazine-viewport').bind('zoom.doubleTap', zoomTo);
</P><P>	else
</P><P>		$('.magazine-viewport').bind('zoom.tap', zoomTo);
</P><P>	// Using arrow keys to turn the page
</P><P>	$(document).keydown(function(e){
</P><P>		var previous = 37, next = 39, esc = 27;
</P><P>		switch (e.keyCode) {
</P><P>			case previous:
</P><P>				// left arrow
</P><P>				$('.magazine').turn('previous');
</P><P>				e.preventDefault();
</P><P>			break;
</P><P>			case next:
</P><P>				//right arrow
</P><P>				$('.magazine').turn('next');
</P><P>				e.preventDefault();
</P><P>			break;
</P><P>			case esc:				
</P><P>				$('.magazine-viewport').zoom('zoomOut');	
</P><P>				e.preventDefault();
</P><P>			break;
</P><P>		}
</P><P>	});
</P><P>	// URIs - Format #/page/1 
</P><P>	Hash.on('^page\/([0-9]*)$', {
</P><P>		yep: function(path, parts) {
</P><P>			var page = parts[1];
</P><P>			if (page!==undefined) {
</P><P>				if ($('.magazine').turn('is'))
</P><P>					$('.magazine').turn('page', page);
</P><P>			}
</P><P>		},
</P><P>		nop: function(path) {
</P><P>	if ($('.magazine').turn('is'))
</P><P>				$('.magazine').turn('page', 1);
</P><P>		}
</P><P>	});
</P><P>	$(window).resize(function() {
</P><P>		resizeViewport();
</P><P>	}).bind('orientationchange', function() {
</P><P>		resizeViewport();
</P><P>	});
</P><P>	// Events for thumbnails
</P><P>	$('.thumbnails').click(function(event) {		
</P><P>		var page;
</P><P>		if (event.target &amp;&amp; (page=/page-([0-9]+)/.exec($(event.target).attr('class'))) ) {		
</P><P>			$('.magazine').turn('page', page[1]);
</P><P>		}
</P><P>	});
</P><P>	$('.thumbnails li').
</P><P>		bind($.mouseEvents.over, function() {			
</P><P>			$(this).addClass('thumb-hover');
</P><P>		}).bind($.mouseEvents.out, function() {
</P><P>			$(this).removeClass('thumb-hover');
</P><P>		});
</P><P>	if ($.isTouch) {	
</P><P>		$('.thumbnails').
</P><P>			addClass('thumbanils-touch').
</P><P>			bind($.mouseEvents.move, function(event) {
</P><P>				event.preventDefault();
</P><P>			});
</P><P>	} else {
</P><P>		$('.thumbnails ul').mouseover(function() {
</P><P>			$('.thumbnails').addClass('thumbnails-hover');
</P><P>		}).mousedown(function() {
</P><P>			return false;
</P><P>		}).mouseout(function() {
</P><P>			$('.thumbnails').removeClass('thumbnails-hover');
</P><P>		});
</P><P>	}
</P><P>	// Regions
</P><P>	if ($.isTouch) {
</P><P>		$('.magazine').bind('touchstart', regionClick);
</P><P>	} else {
</P><P>		$('.magazine').click(regionClick);
</P><P>	}
</P><P>	// Events for the next button
</P><P>	$('.next-button').bind($.mouseEvents.over, function() {		
</P><P>		$(this).addClass('next-button-hover');
</P><P>	}).bind($.mouseEvents.out, function() {		
</P><P>		$(this).removeClass('next-button-hover');
</P><P>	}).bind($.mouseEvents.down, function() {		
</P><P>		$(this).addClass('next-button-down');
</P><P>	}).bind($.mouseEvents.up, function() {		
</P><P>		$(this).removeClass('next-button-down');
</P><P>	}).click(function() {
</P><P>		$('.magazine').turn('next');
</P><P>		setTimeout(function(){
</P><P>		setArrows() ;
</P><P>		},300);
</P><P>	});
</P><P>	// Events for the next button	
</P><P>	$('.previous-button').bind($.mouseEvents.over, function() {		
</P><P>		$(this).addClass('previous-button-hover');
</P><P>	}).bind($.mouseEvents.out, function() {		
</P><P>		$(this).removeClass('previous-button-hover');
</P><P>	}).bind($.mouseEvents.down, function() {		
</P><P>		$(this).addClass('previous-button-down');
</P><P>	}).bind($.mouseEvents.up, function() {		
</P><P>		$(this).removeClass('previous-button-down');
</P><P>	}).click(function() {		
</P><P>		$('.magazine').turn('previous');
</P><P>		setTimeout(function(){
</P><P>		setArrows() ;
</P><P>		},300);
</P><P>	});
</P><P>	resizeViewport();
</P><P>	$('.magazine').addClass('animated');
</P><P>}
</P><P>// Zoom icon
</P><PRE>$('.zoom-icon').bind('mouseover', function() {  	
</PRE><PRE>	if ($(this).hasClass('zoom-icon-in'))
</PRE><PRE>		$(this).addClass('zoom-icon-in-hover');
</PRE><PRE>	if ($(this).hasClass('zoom-icon-out'))
</PRE><PRE>		$(this).addClass('zoom-icon-out-hover'); 
</PRE><PRE>}).bind('mouseout', function() {  	
</PRE><PRE>	 if ($(this).hasClass('zoom-icon-in'))
</PRE><PRE>		$(this).removeClass('zoom-icon-in-hover'); 	
</PRE><PRE>	if ($(this).hasClass('zoom-icon-out'))
</PRE><PRE>		$(this).removeClass('zoom-icon-out-hover');
</PRE><PRE>}).bind('click', function() {
</PRE><PRE>	if ($(this).hasClass('zoom-icon-in'))
</PRE><PRE>		$('.magazine-viewport').zoom('zoomIn');
</PRE><PRE>	else if ($(this).hasClass('zoom-icon-out'))	
</PRE><P>		$('.magazine-viewport').zoom('zoomOut');
</P><PRE>});
</PRE><PRE>$('#canvas').hide();
</PRE><P>// Load the HTML4 version if there's not CSS transform
</P><P>yepnope({
</P><P>	test : Modernizr.csstransforms,
</P><P>	yep: ['js/turn.js'],
</P><P>	nope: ['js/turn.html4.min.js'],
</P><P>	both: ['js/zoom.min.js', 'js/magazine.js', 'css/magazine.css'],
</P><P>	complete: loadApp
</P><P>});
</P></DIV></DIV></DIV></DIV></DIV></BODY></HTML>