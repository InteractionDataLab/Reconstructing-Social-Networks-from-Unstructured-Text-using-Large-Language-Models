<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_ETH_Zurich_Motility_Readout skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:ETH Zurich/Motility Readout</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><DIV class="container-nav-menu"><DIV class="nav-menu"><DIV class="nav-menu-left "><DIV class="nav-item" id="nav-item1"><SPAN>Project</SPAN><UL class="submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Description">Description</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Applied_Design">Applied Design</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Team">Team Members</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Attributions">Attributions</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Sponsoring">Sponsoring</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Notebook">Notebook</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Safety">Safety</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Download">Downloads</A></LI></UL></DIV><DIV class="nav-item" id="nav-item2"><SPAN>Wet Lab</SPAN><UL class="submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Tar">Tar Receptor Evolution</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/ApproachA">Approach A</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/ApproachB">Approach B</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Experiments">Experiments</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/InterLab">InterLab</A></LI></UL></DIV><DIV class="nav-item" id="nav-item3"><SPAN>Hardware</SPAN><UL class="submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Hardware">Hardware Overview</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Microscope">Microscope</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Mechanics">Mechanics</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/SyringePump">Syringe Pump</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/MicrofluidicChip">Microfluidic Chip</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/bubbling">Bubbling</A></LI></UL></DIV><DIV class="nav-item" id="nav-item4"><SPAN>Software</SPAN><UL class="submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Software">Software Overview</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Motility_Readout">Motility Readout</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/ImageAnalysis">Luminescence Algorithm</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/RobotControls">Robot Controls</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Path_Planning">Path Planning</A></LI></UL></DIV></DIV><DIV class="nav-menu-middle "><DIV class="nav-item" id="home"><A href="https://2018.igem.org/Team:ETH_Zurich"><TITLE id="title6">Logo Website</TITLE></A></DIV></DIV><DIV class="nav-menu-right "><DIV class="nav-item" id="nav-item5"><SPAN>Model</SPAN><UL class="submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Model">Model Overview</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/integratedModel">Integrated Models</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/motilityModel">Motility Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/splitModel">Split Luciferase Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/diffusionModel">Diffusion Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/bubbelingModel">Bubbling Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/HolographicModel">Holographic Imaging Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Screening">Screening Assay Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Parameter">Model Parameters</A></LI></UL></DIV><DIV class="nav-item" id="nav-item6"><SPAN>Human Practices</SPAN><UL class="submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Human_Practices">Human Practices</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Public_Engagement">Education &amp; Engagement</A></LI></UL></DIV><DIV class="nav-item" id="nav-item7"><SPAN>Achievements</SPAN><UL class="submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Results">Results</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Parts">Parts Overview</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Demonstrate">Demonstrate</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Collaborations">Collaborations</A></LI></UL></DIV></DIV></DIV><DIV class="container-content"><DIV id="tongue1" class="content-tongue"><DIV class="tongue-div" id="tongue-div1">Content</DIV></DIV><DIV class="content-text"><SPAN href="section-Introduction" class="content-item">Introduction</SPAN><SPAN href="container_table" class="content-item">Table</SPAN></DIV></DIV></DIV><DIV class="main-menu"><A href="https://2018.igem.org/Team:ETH_Zurich"><DIV class="home">
        Home
      </DIV></A><DIV class="main-titel"><A href="https://2018.igem.org/Team:ETH_Zurich">
        A<SPAN>.</SPAN>R<SPAN>.</SPAN>O<SPAN>.</SPAN>M<SPAN>.</SPAN>A<SPAN class="main-letterSpacing">.</SPAN></A></DIV><A href="https://2018.igem.org/Team:ETH_Zurich"><DIV class="menu-logo"><TITLE id="title6">Logo Website</TITLE></DIV></A></DIV><DIV class="main-submenu"><DIV class="alt-main-submenu-item" id="alt-nav-item1" href="#project"><SPAN>Project</SPAN><UL class="alt-submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Description">Description</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Applied_Design">Applied Design</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Team">Team Members</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Attributions">Attributions</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Sponsoring">Sponsoring</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Notebook">Notebook</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Safety">Safety</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Download">Downloads</A></LI></UL></DIV><DIV class="alt-main-submenu-item" id="alt-nav-item2" href="#parts"><SPAN>Wet Lab</SPAN><UL class="alt-submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Tar">Tar Receptor Evolution</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/ApproachA">Approach A</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/ApproachB">Approach B</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Experiments">Experiments</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/InterLab">InterLab</A></LI></UL></DIV><DIV class="alt-main-submenu-item" id="alt-nav-item3" href="#modelling"><SPAN>Hardware</SPAN><UL class="alt-submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Hardware">Hardware Overview</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Microscope">Microscope</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Mechanics">Mechanics</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/SyringePump">Syringe Pump</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/MicrofluidicChip">Microfluidic Chip</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/bubbling">Bubbling</A></LI></UL></DIV><DIV class="alt-main-submenu-item" id="alt-nav-item4"><SPAN>Software</SPAN><UL class="alt-submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Software">Software Overview</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Motility_Readout">Motility Readout</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/ImageAnalysis">Luminescence Algorithm</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/RobotControls">Robot Controls</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Path_Planning">Path Planning</A></LI></UL></DIV><DIV class="alt-main-submenu-item" id="alt-nav-item5"><SPAN>Model</SPAN><UL class="alt-submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Model">Model Overview</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/integratedModel">Integrated Models</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/motilityModel">Motility Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/splitModel">Split Luciferase Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/diffusionModel">Diffusion Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/bubbelingModel">Bubbling Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Screening">Screening Assay Model</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/HolographicModel">Holographic Imaging Model</A></LI></UL></DIV><DIV class="alt-main-submenu-item" id="alt-nav-item6"><SPAN>Human Practices</SPAN><UL class="alt-submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Human_Practices">Human Practices</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Public_Engagement">Education &amp; Engagement</A></LI></UL></DIV><DIV class="alt-main-submenu-item" id="alt-nav-item7"><SPAN>Achievements</SPAN><UL class="alt-submenu"><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Results">Results</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Parts">Parts Overview</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Demonstrate">Demonstrate</A></LI><LI><A href="https://2018.igem.org/Team:ETH_Zurich/Collaborations">Collaborations</A></LI></UL></DIV></DIV><DIV class="mobileMenuBg" style="visibility: hidden"><DIV class="container-titel"><DIV class="titel" id="titel">
        Motility
        Readout<SPAN>.</SPAN></DIV><DIV class="scroll">Scroll</DIV></DIV><DIV class="text">
      For our Motility approach we developed an advanced image analysis software. We detect the spinning bacteria and read out their rotation. From this data we can reconstruct the concentration of the molecule in our solution. Read more about the approach here.<A href="https://2018.igem.org/Team:ETH_Zurich/ApproachA" target="_blank">  Approach A </A> This section focuses on the software responsible for image analysis.
    </DIV><DIV class="sectionh1 contentTable contentImplementation" contenttable="Software Implementation" contentref=".contentImplementation">Software Implementation</DIV><DIV class="sectionh2">1. Preprocessing</DIV><DIV class="text">
      The first step when it comes to our image processing pipeline is to apply preprocessing. In our case this consists of applying a strong contrast and then using the gaussian filter to reduce the noise. To implement this in a fast and efficient way we used the opencv library.
    </DIV><DIV class="container_figure"><DIV class="figures_container"><DIV class="figure"><DIV class="subfigure_caption">The raw data from the camera</DIV></DIV><DIV class="figure"><DIV class="subfigure_caption">After applying the preprocessing</DIV></DIV></DIV><DIV class="figure_caption caption_center">Before and After preprocessing comparison</DIV></DIV><DIV class="sectionh2">2. Blob detection</DIV><DIV class="text">
      Our initial Blob detection detects all the bacteria visible in the frame. In opencv there is a built-in function we made use of. One can tweak the different parameters to fit our setup. These parameters include the blob size, circularity and intensity. Thanks to the previous preprocessing the algorithm reliably detected all bacteria while ignoring most pieces of dirt.
    </DIV><DIV class="sectionh2">3. Blob refinement</DIV><DIV class="text">
      When only looking at a single frame and applying a blob detection the algorithm finds all E. coli cells, regardless of whether they are moving through the frame, stuck to the surface or rotating as desired. Only the blobs rotating are of interest to us, as they are the only one providing a signal. Therefore we need to filter them out. Additionally, what is crucial in order to determine the turning behavior of the cells is to find the center of rotation. All of our Rotation analysis approaches use the center of rotation and could otherwise become significantly less accurate. The solution we came up with is to average the position of the E. coli over the next few frames.
    </DIV><DIV class="container_figure"><DIV class="figure"><DIV class="subfigure_caption">Red: First basic blob detection, White: Refined points</DIV></DIV></DIV><DIV class="text">
      We implement that by cropping into a small window for each blob. Ideally only the blob detected with our initial blob detection should still be visible. We then run the same blob detection on that small window over next few frames. If the blob
      leaves the window, we remove the point, and should it stay roughly inside the frame we take the mean of its position over all the frames. This enables us to receive a precise center position to do our rotation analysis on.
    </DIV><DIV class="sectionh2">4. Rotation analysis</DIV><DIV class="text clearfix"><DIV class="textpicture-right textpicture20"><DIV class="figure_caption caption_left">Rotation of a single E Coli in a cropped view</DIV></DIV>
      The goal of the rotation analysis part is to identify the angular velocity of the E. Coli. In other words we would like to find out how fast and in which direction the E. Coli are turning. There are several ways how this can be approached and
      we will show the 3 most promising ways. For all of the approaches one first crops the image down to a size where one can only see one blob. The image we are then working with is shown below.
    </DIV><DIV class="text"><OL><LI>
          First we can continue applying a blob detection. The algorithm returns the center of the blob in each frame and we compare this with the center of rotation. Out of those two positions we can evaluate a vector. When transforming this into a radial coordinate system we obtain an angle and a radius. By comparing the subsequent frames we receive a angular velocity as desired. The benefit of using this method is to gain an additional feature: the radius. One can use this information to determine, whether our difference in angle only comes from noise and the E. Coli is not actually moving or if we actually have a spinning bacteria. Unfortunately even the spinning bacteria donâ€™t turn with a significant radius, which makes this method quite inaccurate.
        </LI><LI>
          Inspired by a matlab script we received by [TODO: !!!] we determined the center of mass. The center of mass is calculated like an expectation value we multiply the coordinate value with the weight of the pixel. This results in one point. From here on we do the same steps as already described in approach one. On the microscopy data this method turned out to work very well. Because of that we used this method to analyse our imaging data of the microscope.
        </LI><LI>
          The most robust solution, which yielded the best results for our own imaging setup was the third approach. Here we divide the small frame around the blob into four corners (see picture below). For each section we evaluate average pixel intensity.  Out of these four intensities (see second picture) we would like to determine the angular position of the blob. An easy arppoach would be to simply take the corner with the lowest average value, but this would not only be inaccurate but also very artefact and noise sensitive. The idea we came up with is to compare the opposing corners of our divided frame. This way we know the bias of the blob in the axis connecting the opposing corners. So we subtract the opposing corners from each other. These bias can be illustrated as the two black vectors in the third graphic. We essentially created to vectors in a coordinate system shifted by 45 degrees. When adding these vectors we obtain a final vector. It can now be transformed into the polar coordinate system and we can determine the angular velocity, the speed of the bacteria. The benefit of using this approach is the fact that it is very robust to picture artefacts and yields an accurate angle.
        </LI></OL></DIV><DIV class="container_figure"><DIV class="figure"><DIV class="subfigure_caption">Processed</DIV></DIV><DIV class="figure_caption caption_center">Four Corners Rotation analysis approach</DIV></DIV><DIV class="sectionh2">5. Data processing</DIV><DIV class="text">
      The final step of our algorithm is to interpret this data. We calculate the angle difference from each step by always taking the smaller angle between the next and current frame. This results in an angle speed which we can threshold to conclude whether the bacterium is not moving at all (very low), slowly moving or tumbling (medium) or turning very fast after receiving aspartate.
    </DIV><DIV class="sectionh1 contentTable contentConclusion" contenttable="Conclusion" contentref=".contentConclusion">Conclusion</DIV><DIV class="text">
      We believe this is a very solid foundation one can base their rotation tracking analysis on. We implementing the algorithm into ROS and made it run in real time. This yealded great results enabling us to detect the rotational movement of E. Coli. The video below shows a Live software analysis of the picture recorded on Aroma. To see the full demonstration of AROMA driving around and applying the live image analysis please see the following Link:

    <DIV class="download-button"><A href="https://2018.igem.org/Team:ETH_Zurich/Demonstration" target="_blank"><SPAN>See the Demonstration of AROMA</SPAN></A></DIV></DIV></DIV><DIV class="mobileMenuBg"><FOOTER><DIV class="sponsor-title">Sponsors</DIV><DIV class="multimedia-title">Contact Us</DIV></FOOTER></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>