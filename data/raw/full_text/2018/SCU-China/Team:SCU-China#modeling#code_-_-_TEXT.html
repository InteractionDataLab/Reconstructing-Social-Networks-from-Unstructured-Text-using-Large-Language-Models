Team:SCU-China/modeling/code
Team:SCU-China - 2018
program prescreen   implicit none    integer, parameter :: ls=20, numseq=500 ! numseq = number of sequences to output after the prescreen     integer, parameter :: tlenPZ=250, tlenP=26041, lg=4558953     integer, parameter :: threshPZ=90, threshP=63, threshG=43        real::rantmp     integer ::finalsequence(1:400),pre,after,N,last,p,laji       integer :: j2c, j2c1, i5, j, j2totP, j2totG    integer :: j2P, j2G, jf           integer(8) :: j2PZ, j2totPZ           integer :: ADj2totPZ, ADj2totP, ADj2totG           integer :: ADj2P, ADj2PZ, ADj2G    integer :: tc, Lx1, Lx2    integer :: i, i1, i2, j2, i3, i4, j4, k4, l4    integer :: j44, j444              integer :: sfPZ(1:tlenPZ), sfrcPZ(1:tlenPZ)    integer :: sf(1:tlenP), sfrc(1:tlenP)    integer :: sfG(1:lg), sfrcG(1:lg)            INTEGER :: s2_0(1:ls+3),s2_1(1:69)    integer :: s1(1:ls+3)     integer :: m(1:ls+3), mrc(1:ls+3)           integer :: m11(1:tlenPZ-22),m11rc(1:tlenPZ-22)           integer :: m1(1:tlenP-22),m1rc(1:tlenP-22)           integer :: m111(1:lg-22),m111rc(1:lg-22)    integer :: m22(1:tlenPZ-22*2), m22rc(1:tlenPZ-22*2)    integer :: m2(1:tlenP-22*14), m2rc(1:tlenP-22*14)    integer :: m222(1:lg-22*1), m222rc(1:lg-22*1)    integer :: m33(1:2), m3(1:2),m333(1:2),m44,m4,m444                 integer :: w(1:ls+3), ir            real    :: start, finish       COMMON s2_0,sf,sfrc,j2c,m1,m1rc,m2,m2rc       open(unit=91,file='scores_psPZ.txt', status='unknown')  open(unit=92,file='scores_psP.txt', status='unknown')  open(unit=93,file='scores_psG.txt', status='unknown')  open(unit=95,file='counts_psPZPG.txt', status='unknown')  open(unit=98,file='seed_psPZPG.txt', status='unknown')  open(unit=99,file='sequences_psPZPG.txt', status='unknown')     open(unit=88,file='sequences_2combined.txt', status='unknown')     open(unit=87,file='link.txt', status='unknown')           call f_maker2(sf,sfrc)    call g_maker(sfG,sfrcG)      call ortho_maker(finalsequence)              do i=1,10      ir=i       w(i)=ir    enddo    do i=11,ls      w(i)=10    enddo    w(ls+1)=0    w(ls+2:ls+3)=20                          j2PZ=0           j2P=0         j2G=0           j2totPZ=0         j2totP=0         j2totG=0         jf=0      do while (jf < numseq)                        call cpu_time(start)                ADj2PZ=0           ADj2P=0         ADj2G=0           ADj2totPZ=0         ADj2totP=0         ADj2totG=0   100      continue      call random_seed()              call combine_seqGC(finalsequence,pre,after,N)                         call random_number(rantmp)              last =  CEILING(rantmp*19)*20      !     call random_seqGC()               do j4=1,tlenP-22                    do i4=1,ls+3          if (s2_0(i4).eq.sf(i4+j4-1))then       m(i4)=0     else       m(i4)=1     endif             if (s2_0(i4).eq.sfrc(i4+j4-1))then       mrc(i4)=0     else       mrc(i4)=1     endif                            enddo                                                                                     m1(j4)=DOT_PRODUCT(m,w)          m1rc(j4)=DOT_PRODUCT(mrc,w)                                     enddo                                        call f_chopper(m1, m1rc, m2, m2rc)                m3(1)=MINVAL(m2)       m3(2)=MINVAL(m2rc)        m4=MINVAL(m3)                              j2totP=j2totP+1       ADj2totP = ADj2totP + 1        if(m4.lt.threshP)then        j2P=j2P+1        ADj2P=ADj2P+1                       print '("第一阶段失败 threshold 64  m4： ", i5)',m4                                  do p=1,1000                laji = p                enddo                   go to 100              endif          print '("第一阶段比对成功 ")'             do j4=1,lg-22                      do i4=1,ls+3              if (s2_0(i4).eq.sfG(i4+j4-1))then       m(i4)=0     else       m(i4)=1     endif             if (s2_0(i4).eq.sfrcG(i4+j4-1))then       mrc(i4)=0     else       mrc(i4)=1     endif                           enddo            m111(j4)=DOT_PRODUCT(m,w)          m111rc(j4)=DOT_PRODUCT(mrc,w)              if ((m111(j4).lt.threshG).or.(m111rc(j4).lt.threshG)) then                   !*****AD: finish timing the genome search loop since                   !         we are quitting the loop in a next few lines                   ! call cpu_time(finish)                   ! print '("Time loop = ",f6.3," seconds.")',finish-start                         j2totG=j2totG+1                        j2G=j2G+1                         ADj2totG = ADj2totG+1                         ADj2G = ADj2G+1                                      print '("threshold 50  m111(j4)： ", i5)',m111(j4)             print '("threshold 50  m111rc(j4)： ", i5)',m111rc(j4)             print '("第二阶段比对失败 ")'              print '("ADJ2G： ", i5)',ADj2G             !before we quit the loop print some statistics             if (mod(ADj2G,200)==0) then               call cpu_time(finish)          print '("Number of sequences found # ", i5)', jf          print '("Prescreen progress:")'          print '("Promoter: ",i8,", plasmids: ",i8)',ADj2totPZ,ADj2totP          print '("Genome/total: ",i8," @ ",f9.3," sec")',ADj2totG,finish-start            endif                         go to 100            endif           enddo          m333(1)=MINVAL(m111)       m333(2)=MINVAL(m111rc)       m444=MINVAL(m333)         print '("threshold 50  m111(j4)： ", i5)',m444                           j2totG=j2totG+1       ADj2totG=ADj2totG+1                  call cpu_time(finish)                print '("Time loop = ",f9.3," seconds.")',finish-start       print '("Failed vs prom.  = ",i12," of ",i12)',ADj2PZ,ADj2totPZ       print '("Failed vs plasm. = ",i12," of ",i12)',ADj2P,ADj2totP       print '("Failed vs genome = ",i12," of ",i12)',ADj2G,ADj2totG       print '("Total fail vs prom.  = ",i12," of ",i12)',j2PZ,j2totPZ       print '("Total fail vs plasm. = ",i12," of ",i12)',j2P,j2totP       print '("Total fail vs genome = ",i12," of ",i12)',j2G,j2totG       print '("Score: pr.= ",i2,", pl.= ",i2,", g.=",i2)',m44,m4,m444       print '("Found sequence(",i12,") = ",20i1)',jf,s2_0(1:20)       print '("")'                     do i=1,20           s2_1(i) = finalsequence(pre+i)       enddo        s2_1(21)=N s2_1(22)=1          s2_1(23)=1       do i=24,43           s2_1(i) = finalsequence(after+i-23)       enddo             call random_number(rantmp)        s2_1(44)=CEILING(rantmp*4)         s2_1(45)=1          s2_1(46)=1                    do i=47,66           s2_1(i) = finalsequence(last+i-46)          enddo                    call random_number(rantmp)        s2_1(67)=CEILING(rantmp*4)         s2_1(68)=1          s2_1(69)=1 201  FORMAT(I\)  200 FORMAT(A\)                    write(91,*)  m44                write(92,*)  m4                write(93,*)  m444                write(99,*)  s2_0(1:23)                                               write(88,*)  s2_1(1:69)              write(87,201)  pre/20+1               write(87,200)  "   "               write(87,201)  after/20+1                write(87,200)  "   "               write(87,*)  last/20+1              !  call flush          jf=jf+1                       enddo            write(95,*) j2PZ, j2totPZ, j2P, j2totP, j2G, j2totG    end           SUBROUTINE init_random_seed()           INTEGER :: i, n, clock           INTEGER, DIMENSION(:), ALLOCATABLE :: seed                        CALL RANDOM_SEED(size = n)             ALLOCATE(seed(n))                CALL SYSTEM_CLOCK(COUNT=clock)                  seed = clock + 37 * (/ (i - 1, i = 1, n) /)                         CALL RANDOM_SEED(PUT = seed)                    DEALLOCATE(seed)           END SUBROUTINE            SUBROUTINE random_seqGC()    INTEGER, PARAMETER ::  ls=20           INTEGER :: i2,j2c    INTEGER :: s2_0(1:ls+3)    COMMON s2_0, j2c         do i2=1,ls          call random_number(r1)          s2_0(i2)=CEILING(r1*4.0)               enddo        j2c=j2c+1         s2_0(ls+1)=4        s2_0(ls+2:ls+3)=1     END SUBROUTINE           SUBROUTINE combine_seqGC(finalsequence,pre,after,N)              INTEGER, PARAMETER ::  ls=20           INTEGER :: i2,j2c,j2,counter1,counter2,tmp,counter3    INTEGER :: s2_0(1:ls+3)        integer ::finalsequence(1:400),pre,after,marker,N,l,laji    COMMON s2_0, j2c 102   continue call RANDOM_SEED()         call random_number(r1)         marker=0                 tmp=IFIX(r1*20)         if(tmp.lt.1) tmp=1          tmp = tmp*20         print '("tmp ", i5)',tmp         do i1=1,20         if(finalsequence(tmp+i1).eq.1.0.and.finalsequence(tmp+i1+1).eq.1.0.and.(i1-2).gt.0) then               print '("i1 ", i5)',i1              counter = tmp              do i2=1,i1-2                           s2_0(ls-i1+2+i2) = finalsequence(tmp+i2)              enddo                             call random_number(r2)               counter2=CEILING(r2*19)*20               counter1=tmp               print '("counter1 ", i5)',counter1                print '("counter2 ", i5)',counter2               do i2=i1-1+3,ls                   s2_0(i2-i1-1) = finalsequence(counter2+i2)               enddo               s2_0(i2-i1-1) = CEILING(r2*4)               N = s2_0(i2-i1-1)               s2_0(i2-i1-1+1) = 1               s2_0(i2-i1-1+2) = 1                               s2_0(ls+1)=4            s2_0(ls+2:ls+3)=1                      print '("counter1 ", i5)',counter1/20               print '("counter2 ", i5)',counter2/20               marker = 1               exit         endif                  enddo                           do l=1,1000             laji=l             enddo                  if(marker.eq.0)  go to 102                     !      do i=1,23   !         print '("conbined sequence ", i5)',s2_0(i)            !      enddo                           pre = counter2         after=counter1                                                j2c=j2c+1         s2_0(ls+1)=4        s2_0(ls+2:ls+3)=1           END SUBROUTINE      SUBROUTINE f_maker(sfPZ,sfrcPZ)     integer, parameter ::  lp=250    integer ::  i,i1    integer :: sfPZ(1:lp), sfrPZ(1:lp), sfrcPZ(1:lp)    character(lp) :: F2   open(unit=32,file='promozone_100150.txt', status='old')  READ(32,*) F2          do i1=1,lp       if(F2(i1:i1).eq.'G'.or.F2(i1:i1).eq.'g') then        sfPZ(i1)=1.0      elseif(F2(i1:i1).eq.'C'.or.F2(i1:i1).eq.'c') then sfPZ(i1)=2.0      elseif(F2(i1:i1).eq.'A'.or.F2(i1:i1).eq.'a') then        sfPZ(i1)=3.0      elseif(F2(i1:i1).eq.'T'.or.F2(i1:i1).eq.'t') then        sfPZ(i1)=4.0      endif    enddo            do i=1,lp          sfrPZ(i)=sfPZ(lp-(i-1))        enddo           do i=1,lp   if(sfrPZ(i)==1.0)then        sfrcPZ(i)=2.0   elseif (sfrPZ(i)==2.0)then     sfrcPZ(i)=1.0   elseif (sfrPZ(i)==3.0)then     sfrcPZ(i)=4.0   elseif (sfrPZ(i)==4.0)then     sfrcPZ(i)=3.0   endif        enddo   END SUBROUTINE     SUBROUTINE f_maker2(sf,sfrc)           integer, parameter  :: tlenP=26041          integer :: sf(1:tlenP),sfr(1:tlenP), sfrc(1:tlenP)          INTEGER :: i,j, slen(1:14), tshift                  integer :: seq1(1:6882),seq2(1:6808),seq3(1:3151)          integer :: seq4(1:717),seq5(1:1377)          integer :: seq6(1:4104),seq7(1:795)          integer :: seq8(1:1191),seq9(1:56),seq10(1:55)          integer :: seq11(1:55),seq12(1:49),seq13(1:132),seq14(1:669), thsift                                                 character(len = 6882) :: sseq1    character(len = 6808) :: sseq2    character(len =3151) :: sseq3    character(len =717) :: sseq4          character(len =1377) :: sseq5       character(len =4104) :: sseq6          character(len =795) :: sseq7          character(len =1191) :: sseq8          character(len =56) :: sseq9          character(len =55) :: sseq10          character(len =55) :: sseq11          character(len =49) :: sseq12          character(len =132) :: sseq13          character(len =669) :: sseq14           slen= (/ 6882,6808,3151,717,1377,4104,795,1191,56,55,55,49,132,669/)   101 FORMAT(A)   open(unit=41,file='1.txt', status='old')  open(unit=42,file='2.txt', status='old')  open(unit=43,file='3.txt', status='old')  open(unit=44,file='4.txt', status='old')  open(unit=45,file='5.txt', status='old')  open(unit=46,file='6.txt', status='old')     open(unit=47,file='7.txt', status='old')     open(unit=48,file='8.txt', status='old')     open(unit=49,file='9.txt', status='old')     open(unit=50,file='10.txt', status='old')     open(unit=51,file='11.txt', status='old')     open(unit=52,file='12.txt', status='old')     open(unit=53,file='13.txt', status='old')     open(unit=54,file='14.txt', status='old')      READ(41,101) sseq1     READ(42,101) sseq2     READ(43,101) sseq3     READ(44,101) sseq4     READ(45,101) sseq5     READ(46,101) sseq6        READ(47,101) sseq7        READ(48,101) sseq8        READ(49,101) sseq9        READ(50,101) sseq10        READ(51,101) sseq11        READ(52,101) sseq12        READ(53,101) sseq13        READ(54,101) sseq14                                  do i1=1,6882       if(sseq1(i1:i1).eq.'G'.or.sseq1(i1:i1).eq.'g') then        seq1(i1)=1.0      elseif(sseq1(i1:i1).eq.'C'.or.sseq1(i1:i1).eq.'c') then        seq1(i1)=2.0      elseif(sseq1(i1:i1).eq.'A'.or.sseq1(i1:i1).eq.'a') then        seq1(i1)=3.0      elseif(sseq1(i1:i1).eq.'T'.or.sseq1(i1:i1).eq.'t') then        seq1(i1)=4.0      endif    enddo         do i1=1,6808       if(sseq2(i1:i1).eq.'G'.or.sseq2(i1:i1).eq.'g') then        seq2(i1)=1.0      elseif(sseq2(i1:i1).eq.'C'.or.sseq2(i1:i1).eq.'c') then        seq2(i1)=2.0      elseif(sseq2(i1:i1).eq.'A'.or.sseq2(i1:i1).eq.'a') then        seq2(i1)=3.0      elseif(sseq2(i1:i1).eq.'T'.or.sseq2(i1:i1).eq.'t') then        seq2(i1)=4.0      endif    enddo        do i1=1,3151       if(sseq3(i1:i1).eq.'G'.or.sseq3(i1:i1).eq.'g') then        seq3(i1)=1.0      elseif(sseq3(i1:i1).eq.'C'.or.sseq3(i1:i1).eq.'c') then        seq3(i1)=2.0      elseif(sseq3(i1:i1).eq.'A'.or.sseq3(i1:i1).eq.'a') then        seq3(i1)=3.0      elseif(sseq3(i1:i1).eq.'T'.or.sseq3(i1:i1).eq.'t') then        seq3(i1)=4.0      endif    enddo         do i1=1,717       if(sseq4(i1:i1).eq.'G'.or.sseq4(i1:i1).eq.'g') then        seq4(i1)=1.0      elseif(sseq4(i1:i1).eq.'C'.or.sseq4(i1:i1).eq.'c') then        seq4(i1)=2.0      elseif(sseq4(i1:i1).eq.'A'.or.sseq4(i1:i1).eq.'a') then        seq4(i1)=3.0      elseif(sseq4(i1:i1).eq.'T'.or.sseq4(i1:i1).eq.'t') then        seq4(i1)=4.0      endif    enddo        do i1=1,1377       if(sseq5(i1:i1).eq.'G'.or.sseq5(i1:i1).eq.'g') then        seq5(i1)=1.0      elseif(sseq5(i1:i1).eq.'C'.or.sseq5(i1:i1).eq.'c') then        seq5(i1)=2.0      elseif(sseq5(i1:i1).eq.'A'.or.sseq5(i1:i1).eq.'a') then        seq5(i1)=3.0      elseif(sseq5(i1:i1).eq.'T'.or.sseq5(i1:i1).eq.'t') then        seq5(i1)=4.0      endif    enddo         do i1=1,4104       if(sseq6(i1:i1).eq.'G'.or.sseq6(i1:i1).eq.'g') then        seq6(i1)=1.0      elseif(sseq6(i1:i1).eq.'C'.or.sseq6(i1:i1).eq.'c') then        seq6(i1)=2.0      elseif(sseq6(i1:i1).eq.'A'.or.sseq6(i1:i1).eq.'a') then        seq6(i1)=3.0      elseif(sseq6(i1:i1).eq.'T'.or.sseq6(i1:i1).eq.'t') then        seq6(i1)=4.0      endif        enddo                 do i1=1,795       if(sseq7(i1:i1).eq.'G'.or.sseq7(i1:i1).eq.'g') then        seq7(i1)=1.0      elseif(sseq7(i1:i1).eq.'C'.or.sseq7(i1:i1).eq.'c') then        seq7(i1)=2.0      elseif(sseq7(i1:i1).eq.'A'.or.sseq7(i1:i1).eq.'a') then        seq7(i1)=3.0      elseif(sseq7(i1:i1).eq.'T'.or.sseq7(i1:i1).eq.'t') then        seq7(i1)=4.0      endif         enddo                   do i1=1,1191       if(sseq8(i1:i1).eq.'G'.or.sseq8(i1:i1).eq.'g') then        seq8(i1)=1.0      elseif(sseq8(i1:i1).eq.'C'.or.sseq8(i1:i1).eq.'c') then        seq8(i1)=2.0      elseif(sseq8(i1:i1).eq.'A'.or.sseq8(i1:i1).eq.'a') then        seq8(i1)=3.0      elseif(sseq8(i1:i1).eq.'T'.or.sseq8(i1:i1).eq.'t') then        seq8(i1)=4.0      endif          enddo                    do i1=1,56       if(sseq9(i1:i1).eq.'G'.or.sseq9(i1:i1).eq.'g') then        seq9(i1)=1.0      elseif(sseq9(i1:i1).eq.'C'.or.sseq9(i1:i1).eq.'c') then        seq9(i1)=2.0      elseif(sseq9(i1:i1).eq.'A'.or.sseq9(i1:i1).eq.'a') then        seq9(i1)=3.0      elseif(sseq9(i1:i1).eq.'T'.or.sseq9(i1:i1).eq.'t') then        seq9(i1)=4.0      endif          enddo                      do i1=1,55       if(sseq10(i1:i1).eq.'G'.or.sseq10(i1:i1).eq.'g') then        seq10(i1)=1.0      elseif(sseq10(i1:i1).eq.'C'.or.sseq10(i1:i1).eq.'c') then        seq10(i1)=2.0      elseif(sseq10(i1:i1).eq.'A'.or.sseq10(i1:i1).eq.'a') then        seq10(i1)=3.0      elseif(sseq10(i1:i1).eq.'T'.or.sseq10(i1:i1).eq.'t') then        seq10(i1)=4.0      endif            enddo                         do i1=1,55       if(sseq11(i1:i1).eq.'G'.or.sseq11(i1:i1).eq.'g') then        seq11(i1)=1.0      elseif(sseq11(i1:i1).eq.'C'.or.sseq11(i1:i1).eq.'c') then        seq11(i1)=2.0      elseif(sseq11(i1:i1).eq.'A'.or.sseq11(i1:i1).eq.'a') then        seq11(i1)=3.0      elseif(sseq11(i1:i1).eq.'T'.or.sseq11(i1:i1).eq.'t') then        seq11(i1)=4.0      endif             enddo                            do i1=1,49       if(sseq12(i1:i1).eq.'G'.or.sseq12(i1:i1).eq.'g') then        seq12(i1)=1.0      elseif(sseq12(i1:i1).eq.'C'.or.sseq12(i1:i1).eq.'c') then        seq12(i1)=2.0      elseif(sseq12(i1:i1).eq.'A'.or.sseq12(i1:i1).eq.'a') then        seq12(i1)=3.0      elseif(sseq12(i1:i1).eq.'T'.or.sseq12(i1:i1).eq.'t') then        seq12(i1)=4.0      endif               enddo                                 do i1=1,132       if(sseq13(i1:i1).eq.'G'.or.sseq13(i1:i1).eq.'g') then        seq13(i1)=1.0      elseif(sseq13(i1:i1).eq.'C'.or.sseq13(i1:i1).eq.'c') then        seq13(i1)=2.0      elseif(sseq13(i1:i1).eq.'A'.or.sseq13(i1:i1).eq.'a') then        seq13(i1)=3.0      elseif(sseq13(i1:i1).eq.'T'.or.sseq13(i1:i1).eq.'t') then        seq13(i1)=4.0      endif                  enddo                                      do i1=1,669       if(sseq14(i1:i1).eq.'G'.or.sseq14(i1:i1).eq.'g') then        seq14(i1)=1.0      elseif(sseq14(i1:i1).eq.'C'.or.sseq14(i1:i1).eq.'c') then        seq14(i1)=2.0      elseif(sseq14(i1:i1).eq.'A'.or.sseq14(i1:i1).eq.'a') then        seq14(i1)=3.0      elseif(sseq14(i1:i1).eq.'T'.or.sseq14(i1:i1).eq.'t') then        seq14(i1)=4.0      endif    enddo              tshift=0             sf(1:slen(1))=seq1(1:slen(1))                 tshift=tshift+slen(1)          sf((tshift+1):tshift+slen(2))=seq2(1:slen(2))                 tshift=tshift+slen(2)             sf((tshift+1):tshift+slen(3))=seq3(1:slen(3)) tshift=tshift+slen(3)             sf((tshift+1):tshift+slen(4))=seq4(1:slen(4))              tshift=tshift+slen(4)             sf((tshift+1):tshift+slen(5))=seq5(1:slen(5))                 tshift=tshift+slen(5)             sf((tshift+1):tshift+slen(6))=seq6(1:slen(6))                          tshift=tshift+slen(6)             sf((tshift+1):tshift+slen(7))=seq7(1:slen(7))                          tshift=tshift+slen(7)             sf((tshift+1):tshift+slen(8))=seq8(1:slen(8))                          tshift=tshift+slen(8)             sf((tshift+1):tshift+slen(9))=seq9(1:slen(9))                          tshift=tshift+slen(9)             sf((tshift+1):tshift+slen(10))=seq10(1:slen(10))                          tshift=tshift+slen(10)             sf((tshift+1):tshift+slen(11))=seq11(1:slen(11))                          tshift=tshift+slen(11)             sf((tshift+1):tshift+slen(12))=seq12(1:slen(12))                          tshift=tshift+slen(12)             sf((tshift+1):tshift+slen(13))=seq13(1:slen(13))                          tshift=tshift+slen(13)             sf((tshift+1):tshift+slen(14))=seq14(1:slen(14))                          do i=1,tlenP          sfr(i)=sf(tlenP-(i-1))        enddo            do i=1,tlenP   if(sfr(i)==1.0)then        sfrc(i)=2.0   elseif (sfr(i)==2.0)then     sfrc(i)=1.0   elseif (sfr(i)==3.0)then     sfrc(i)=4.0   elseif (sfr(i)==4.0)then     sfrc(i)=3.0   endif        enddo     END SUBROUTINE       SUBROUTINE f_chopper(m1, m1rc, m2, m2rc)           integer, parameter  :: tlenP= 26041          integer :: m1(1:tlenP-22),m1rc(1:tlenP-22)          integer :: m2(1:tlenP-22*14),m2rc(1:tlenP-22*14)          INTEGER :: i,j,tc          integer :: slen(1:14),slc(1:14), slcR(1:14)           slen= (/ 6882,6808,3151,717,1377,4104,795,1191,56,55,55,49,132,669/)       slc(1)=slen(1)         slc(2)=slc(1)+slen(2)         slc(3)=slc(2)+slen(3)         slc(4)=slc(3)+slen(4)         slc(5)=slc(4)+slen(5)         slc(6)=slc(5)+slen(6)         slc(7)=slc(6)+slen(7)         slc(8)=slc(7)+slen(8) slc(9)=slc(8)+slen(9)         slc(10)=slc(9)+slen(10)         slc(11)=slc(10)+slen(11)         slc(12)=slc(11)+slen(12)         slc(13)=slc(12)+slen(13)         slc(14)=slc(13)+slen(14)                      tc=23-1  m2(1:slc(1)-tc)=m1(1:slc(1)-tc)  m2(slc(1)-tc+1:slc(2)-tc*2)=m1(slc(1)+1:slc(2)-tc)  m2(slc(2)-tc*2+1:slc(3)-tc*3)=m1(slc(2)+1:slc(3)-tc)  m2(slc(3)-tc*3+1:slc(4)-tc*4)=m1(slc(3)+1:slc(4)-tc)  m2(slc(4)-tc*4+1:slc(5)-tc*5)=m1(slc(4)+1:slc(5)-tc)  m2(slc(5)-tc*5+1:slc(6)-tc*6)=m1(slc(5)+1:slc(6)-tc)       m2(slc(6)-tc*6+1:slc(7)-tc*7)=m1(slc(6)+1:slc(7)-tc)     m2(slc(7)-tc*7+1:slc(8)-tc*8)=m1(slc(7)+1:slc(8)-tc)     m2(slc(8)-tc*8+1:slc(9)-tc*9)=m1(slc(8)+1:slc(9)-tc)     m2(slc(9)-tc*9+1:slc(10)-tc*10)=m1(slc(9)+1:slc(10)-tc)     m2(slc(10)-tc*10+1:slc(11)-tc*11)=m1(slc(10)+1:slc(11)-tc)       m2(slc(11)-tc*11+1:slc(12)-tc*12)=m1(slc(11)+1:slc(12)-tc)         m2(slc(12)-tc*12+1:slc(13)-tc*13)=m1(slc(12)+1:slc(13)-tc)        m2(slc(13)-tc*13+1:slc(14)-tc*14)=m1(slc(13)+1:slc(14)-tc)                  slcR(1)=slc(14)-slc(13)         slcR(2)=slc(14)-slc(12)         slcR(3)=slc(14)-slc(11)         slcR(4)=slc(14)-slc(10)         slcR(5)=slc(14)-slc(9)                  slcR(6)=slc(14)-slc(8)         slcR(7)=slc(14)-slc(7)         slcR(8)=slc(14)-slc(6)         slcR(9)=slc(14)-slc(5)         slcR(10)=slc(14)-slc(4)         slcR(11)=slc(14)-slc(3)         slcR(12)=slc(14)-slc(2)         slcR(13)=slc(14)-slc(1)         slcR(14)=slc(14)   !m2rc(1:slcR(1)-tc)=m1rc(1:slcR(1)-tc)  !m2rc(slcR(1)-tc+1:slcR(2)-tc*2)=m1rc(slcR(1)+1:slcR(2)-tc)  !m2rc(slcR(2)-tc*2+1:slcR(3)-tc*3)=m1rc(slcR(2)+1:slcR(3)-tc)  !m2rc(slcR(3)-tc*3+1:slcR(4)-tc*4)=m1rc(slcR(3)+1:slcR(4)-tc)  !m2rc(slcR(4)-tc*4+1:slcR(5)-tc*5)=m1rc(slcR(4)+1:slcR(5)-tc)  !m2rc(slcR(5)-tc*5+1:slcR(6)-tc*6)=m1rc(slcR(5)+1:slcR(6)-tc)          m2rc(1:slcR(1)-tc)=m1rc(1:slcR(1)-tc)  m2rc(slcR(1)-tc+1:slcR(2)-tc*2)=m1rc(slcR(1)+1:slcR(2)-tc)  m2rc(slcR(2)-tc*2+1:slcR(3)-tc*3)=m1rc(slcR(2)+1:slcR(3)-tc)  m2rc(slcR(3)-tc*3+1:slcR(4)-tc*4)=m1rc(slcR(3)+1:slcR(4)-tc)  m2rc(slcR(4)-tc*4+1:slcR(5)-tc*5)=m1rc(slcR(4)+1:slcR(5)-tc)  m2rc(slcR(5)-tc*5+1:slcR(6)-tc*6)=m1rc(slcR(5)+1:slcR(6)-tc)       m2rc(slcR(6)-tc*6+1:slcR(7)-tc*7)=m1rc(slcR(6)+1:slcR(7)-tc)     m2rc(slcR(7)-tc*7+1:slcR(8)-tc*8)=m1rc(slcR(7)+1:slcR(8)-tc)     m2rc(slcR(8)-tc*8+1:slcR(9)-tc*9)=m1rc(slcR(8)+1:slcR(9)-tc)     m2rc(slcR(9)-tc*9+1:slcR(10)-tc*10)=m1rc(slcR(9)+1:slcR(10)-tc)     m2rc(slcR(10)-tc*10+1:slcR(11)-tc*11)=m1rc(slcR(10)+1:slcR(11)-tc)       m2rc(slcR(11)-tc*11+1:slcR(12)-tc*12)=m1rc(slcR(11)+1:slcR(12)-tc)         m2rc(slcR(12)-tc*12+1:slcR(13)-tc*13)=m1rc(slcR(12)+1:slcR(13)-tc)        m2rc(slcR(13)-tc*13+1:slcR(14)-tc*14)=m1rc(slcR(13)+1:slcR(14)-tc)     END SUBROUTINE      SUBROUTINE g_maker(sfG,sfrcG)     integer, parameter ::  lg=4558953, ls=20    character(lg) :: F1  102 FORMAT(A)            integer :: i, i1    integer :: sfG(1:lg), sfrG(1:lg), sfrcG(1:lg)   open(unit=61,file='genome.txt', status='old')   READ(61,102) F1        do i1=1,lg       if(F1(i1:i1).eq.'G'.or.F1(i1:i1).eq.'g') then        sfG(i1)=1.0      elseif(F1(i1:i1).eq.'C'.or.F1(i1:i1).eq.'c') then        sfG(i1)=2.0      elseif(F1(i1:i1).eq.'A'.or.F1(i1:i1).eq.'a') then        sfG(i1)=3.0      elseif(F1(i1:i1).eq.'T'.or.F1(i1:i1).eq.'t') then        sfG(i1)=4.0      endif    enddo       do i=1,lg      sfrG(i)=sfG(lg-(i-1))    enddo       do i=1,lg      if(sfrG(i)==1.0)then           sfrcG(i)=2.0      elseif (sfrG(i)==2.0)then        sfrcG(i)=1.0      elseif (sfrG(i)==3.0)then        sfrcG(i)=4.0      elseif (sfrG(i)==4.0)then        sfrcG(i)=3.0      endif    enddo       END SUBROUTINE               SUBROUTINE ortho_maker(finalsequence)   !  integer, parameter ::  ls=20         integer ::finalsequence(1:400)    !  103 FORMAT(A)              open(unit=64,file='orthogonal_set_sequence.txt', status='old')   READ(64,*) finalsequence  END SUBROUTINE
