Team:ShanghaiTech/Model NFBL
ShanghaiTech iGEM
PROJECT
Overview Negetive Feedback Loop Orthogonal Ribosome Combination InterLab Measurement
PARTS
Basic Parts Composite Parts Part Collection Improved Part
MODELING
Overview Negative Feedback Loop Orthogonal Ribosome Computer Experiments Interaction between Data and Model Software
HUMAN PRACTICE
Overview Education & Public Engagement Biosafety Integrated Human Practice Collaborations
NOTEBOOK
Protocol Calendar
TEAM
Meet Our Team Attribution
Nomination
(Listed by the order of article)
Variable
Mean
$LuxR$
The quantity (copy number) of LuxR gene
$LuxProtein$
The quantity (concentration) of LuxR   protein
$AHL$
The quantity (concentration) of AHL
$LuxAHL$
The quantity (concentration) of the combination   of LuxR protein and AHL
$pLux$
The quantity (copy number) of the pLux   gene
$ActivepLux$
The quantity (copy number) of pLux   promoter activated by the inducer LuxAHL
$rate(pLux)$
The expression rate of pLux
$k_{pLux}$
The rate coefficient of the expression   equation of pLux
$K_{pLux}$
A constant in the Hill function of pLux   combined with LuxAHL
$n_LuxAHL$
The Hill coefficient of the Hill function   of pLux combined with LuxAHL
$[LuxAHL]$
The instantaneous concentration of LuxAHL
$[AHL]$
The instantaneous concentration of AHL
$k$
A constant in the equation of producing   LuxAHL from AHL
$TotalpLux$
The total quantity (copy number) of pLux
$n_{AHL}$
The Hill coefficient of the Hill function   of the expression rate of pLux determined by AHL
$rate(downstream)$
The expression rate of downstream gene
$k_{downstream}$
A constant in the equation of activating   the downstream expression by the upstream product
$ConnectionRatio$
The connection ratio of the promoter with   the relative inducer
$T$
Total quantity (copy number) of the   promoter
$upstream$
The quantity (concentration) of upstream   product
$n_{upstream}$
The Hill coefficient of the Hill function   of the upstream product activating the downstream expression
$K_{downstream}$
A constant in the Hill function of the   upstream product activating the downstream expression
$T’$
A combined constant in the Hill function   of the upstream product activating the downstream expression
Basic Assumptions
Our designed system is independent from other known and unknown factors. This means we can only focus on the properties of the target system to evaluate the features without the disturbance of other factors.
Only the reactions of DNA transcripts to mRNA and mRNA translated to protein need time, the other reactions are regarded as fast reactions and will finish within no time. Among the reactions we care In E. coli, only the reactions of transcription and translation are chain reaction. Thus, all the other reactions finished in one step or few steps can be regarded as fast reactions and take no time to finish.
Transcription Layer
Equations for transcription layer
Our project started at dealing with the unexpected reaction of A bio-system. we knew that control theory could be a solution to this problem by intensive studies. As long as we inspired by this powerful theory in the field of mathematics and signal manipulation, we built the initial simple model to describe the system in E. coli.
We studied the gene transcription in the loop, and found that Hill function was a best tool to describe the dynamic reactions in the system. For example, in part Lux, LuxR protein combines with AHL and reacts to LuxAHL. LuxAHL then connects to the promoter pLux as an inducer. After the inducer and the promoter have connected, the downstream expression starts. The expression rate of downstream gene is determined by the connection ratio of pLux and LuxAHL.
LuxR mechanism
$$ LuxR \rightarrow LuxProtein\ \ \ (1)$$
$$ LuxProtein + AHL \rightarrow LuxAHL\ \ \ (2)$$
$$ LuxAHL + pLux \rightarrow ActivepLux\ \ \ (3)$$
$$ \frac{ActivepLux}{pLux+ActivepLux} = BondingRate$$
$$ rate(pLux)=k_{pLux}\cdot ActivepLux $$
$$ BongdingRate = \frac{LuxAHL^{n_{LuxAHL}}}{K_{pLux}+LuxAHL^{n_{LuxAHL}}} $$    (Hill function)
The above equations describe the principle of the activation of pLux by LuxR and AHL. The first three equations ((1) and (2)) can be written in one total equation which is $LuxR + AHL \rightarrow LuxAHL$. Considering the quantity of LuxR in a mature E. coli is fixed, the quantity of active pLux only determined by the quantity of AHL when the total reaction is a fast reaction. Actually, compared to the rate of gene transcription, this reaction could be approximated as a fast reaction. Hence, we reach the equation $[LuxAHL]=k\cdot [AHL]$. Then, rewriting $pLux + ActivepLux = TotalpLux$, the Hill function describing part Lux can be derived (The coefficients has been integrated into the simplest form).
$$rate(pLux)=TotalpLux\cdot \frac{AHL^{n_{AHL}}}{K_{pLux}+AHL^{n_{AHL}}}$$
Now, it has been proved that for part Lux, the expression rate of downstream can be described by the Hill function of upstream product. In fact, because of the rate of downstream expression always determined by the connection ratio of inducer and promoter, the rate can mostly be described by the Hill function in the above form as long as the reaction of upstream expression is relatively a fast reaction.
In our model, we assumed all the reaction of upstream expression are fast reactions, then all the expression rate in the transcription layer can be described as Hill function. It is necessary to notice that, if the downstream expression is repressed by the upstream, the rate of downstream expression equation is
$$ rate(downstream)=k_{downstream}\cdot (1-ConnectionRatio) $$
And we rewrite the downstream expression rate
$$ rate(downstream)=T\cdot(1-\frac{upstream^{n_{upstream}}}{K_{downstream}+upstream^{n_{upstream}}}) $$
$$ rate(downstream)=T'\cdot\frac{1}{K_{downstream}+upstream^{n_{upstream}}}$$
$$ T' = T\cdot K_{downstream} $$
Hence, the Hill function is a really great tool for transcription layer.
Choose a pattern
The result of the first model helped us to confirm our idea that control theory can be used to make the output what we want. Then we want to find out whether the first loop is the best one to have high fidelity. We use model to calculate the feature of three systems. The first system is a two-node feedback loop that the output is directly relative to the input signal and has a direct negative feedback to the start node.
system 2-1
The second system is a three-node feedback loop that the output is directly relative to the input signal and has an indirect negative feedback to the start node.
system 3-1
The third system is a three-node system that the output is indirectly relative to the input signal and has a direct negative feedback to the start node.
system 3-2
Except for these three systems, there are other four three-node systems and one two-node system. However, they do not satisfy our requirement. We would like a system that input promotes the expression of output, and output represses the expression of input to keep the whole system stable. The remain two-node system and two of the remain three-node systems just have the opposite function. In these three systems, the output signal is repressed by the input signal. Because the output signal will only be produced under the active of input signal, and the input signal will negatively influence the producing output signal, the output will never raise up.
system 2-2
system 3-3
system 3-4
The other two three-node systems are the systems that the regulator node is directly repressed by the upstream node. In these two patterns, the quantity of the regulator is also nearly zero for the same reason as the above three bad systems. Thus, these two systems will work like the two-node systems.
system 3-5
system 3-6
Now we can see that among the total 8 systems of two- or three- node, only three of them are valuable for our project.
In order to evaluate the effectiveness of the valuable three systems, we used error function.
$$ Err = \sum_{i=1}^N([SystemOutputSequence]_i-[ExpectOutputSequnce]_i)^2 $$
The System Output Sequence is the normalized output sequence of the given system, and the Expect Output Sequence is the normalized expected output. This equation calculates the difference sequence between these two sequences and get the quadratic sum of the difference sequence. The system will work better when the Err becomes smaller.
Then, we used ordinary differential equations (ODE) to get the output sequence of these systems.
For System 2
$$ \frac{dO}{dt} = C_{Input}\cdot \frac{I^{n_I}}{k_{Input}+I^{n_I}}-d_O\cdot O $$
$$ \frac{dI}{dt}=C_{Inducer\cdot O}\cdot\frac{Inducer^{n_{Inducer}}}{k_{Inducer}+I^{n_{Inducer}}}\cdot \frac{1}{k_O+O^{n_O}} $$
For System 3-1
$$ \frac{dI}{dt}=C_{Inducer \cdot R}\cdot \frac{Inducer^{n_{Inducer}}}{k_{Inducer}+Inducer^{n_{Inducer}}} \cdot \frac{1}{k_{R}+R^{n_R}}-d_I \cdot I$$
$$ \frac{dO}{dt}=C_{I} \cdot \frac{I^{n_I}}{k_I+I^{n_I}}-d_O \cdot O$$
$$ \frac{dR}{dt}=C_O \cdot \frac{O^{n_O}}{k_O+O^{n_O}}-d_R \cdot R$$
 
For System 3-2
$$ \frac{dI}{dt}=C_{Inducer \cdot R}\cdot \frac{Inducer^{n_{Inducer}}}{k_{Inducer}+Inducer^{n_{Inducer}}} \cdot \frac{1}{k_{R}+R^{n_R}}-d_I \cdot I$$
$$ \frac{dR}{dt}=C_{I} \cdot \frac{I^{n_I}}{k_I+I^{n_I}}-d_R \cdot R$$
$$ \frac{dO}{dt}=C_R \cdot \frac{R^{n_R}}{k_R+R^{n_R}}-d_O \cdot O$$
system 2-1
system 2-1 result
system 3-1
system 3-1 result
system 3-2
system 3-2 result
These three figures indicate that three-node negative feedback loops (NFBL) are obviously better than the two-node feedback loop. For the two NFBL systems, we can see the $ Err$ of system 3-2 is much bigger than system 3-1. Thus, we chose system 3-1 as our target system. We use LuxR as the input node, STAR as the output node, and pT181 as the regular node. The system will be started by AHL activating LuxR. The output signal is adhesive to the STAR part.
ShanghaiTech iGEM @ 2018
