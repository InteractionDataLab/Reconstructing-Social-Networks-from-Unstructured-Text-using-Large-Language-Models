<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Tec-Monterrey_Javascript_calheatmapmin skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><DIV id="top_title"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Tec-Monterrey/Javascript/calheatmapmin</SPAN></H1></DIV><DIV id="HQ_page"><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P>/*! cal-heatmap v3.6.2 (Mon Oct 10 2016 01:36:42)
</P><PRE>*  ---------------------------------------------
*  Cal-Heatmap is a javascript module to create calendar heatmap to visualize time series data
*  <A rel="nofollow" class="external free" href="https://github.com/wa0x6e/cal-heatmap">https://github.com/wa0x6e/cal-heatmap</A>
*  Licensed under the MIT license
*  Copyright 2014 Wan Qi Chen
*/
</PRE><P>function mergeRecursive(a,b){&quot;use strict&quot;;for(var c in b)try{b[c].constructor===Object?a[c]=mergeRecursive(a[c],b[c]):a[c]=b[c]}catch(d){a[c]=b[c]}return a}function arrayEquals(a,b){&quot;use strict&quot;;if(!b||!a)return!1;if(a.length!==b.length)return!1;for(var c=0;c&lt;a.length;c++)if(a[c]instanceof Array&amp;&amp;b[c]instanceof Array){if(!arrayEquals(a[c],b[c]))return!1}else if(a[c]!==b[c])return!1;return!0}var d3=&quot;function&quot;==typeof require?require(&quot;d3&quot;):window.d3,CalHeatMap=function(){&quot;use strict&quot;;function a(){d.verticalDomainLabel=&quot;top&quot;===d.options.label.position||&quot;bottom&quot;===d.options.label.position,d.domainVerticalLabelHeight=null===d.options.label.height?Math.max(25,2*d.options.cellSize):d.options.label.height,d.domainHorizontalLabelWidth=0,&quot;&quot;===d.options.domainLabelFormat&amp;&amp;null===d.options.label.height&amp;&amp;(d.domainVerticalLabelHeight=0),d.verticalDomainLabel||(d.domainVerticalLabelHeight=0,d.domainHorizontalLabelWidth=d.options.label.width),d.paint(),d.options.nextSelector!==!1&amp;&amp;d3.select(d.options.nextSelector).on(&quot;click.&quot;+d.options.itemNamespace,function(){return d3.event.preventDefault(),d.loadNextDomain(1)}),d.options.previousSelector!==!1&amp;&amp;d3.select(d.options.previousSelector).on(&quot;click.&quot;+d.options.itemNamespace,function(){return d3.event.preventDefault(),d.loadPreviousDomain(1)}),d.Legend.redraw(d.graphDim.width-d.options.domainGutter-d.options.cellPadding),d.afterLoad();var a=d.getDomainKeys();d.options.loadOnInit?d.getDatas(d.options.data,new Date(a[0]),d.getSubDomain(a[a.length-1]).pop(),function(){d.fill(),d.onComplete()}):d.onComplete(),d.checkIfMinDomainIsReached(a[0]),d.checkIfMaxDomainIsReached(d.getNextDomain().getTime())}function b(a,b){var c=d.options.cellSize*d._domainType[d.options.subDomain].column(a)+d.options.cellPadding*d._domainType[d.options.subDomain].column(a);return 2===arguments.length&amp;&amp;b===!0?c+=d.domainHorizontalLabelWidth+d.options.domainGutter+d.options.domainMargin[1]+d.options.domainMargin[3]:c}function c(a,b){var c=d.options.cellSize*d._domainType[d.options.subDomain].row(a)+d.options.cellPadding*d._domainType[d.options.subDomain].row(a);return 2===arguments.length&amp;&amp;b===!0&amp;&amp;(c+=d.options.domainGutter+d.domainVerticalLabelHeight+d.options.domainMargin[0]+d.options.domainMargin[2]),c}var d=this;this.allowedDataType=[&quot;json&quot;,&quot;csv&quot;,&quot;tsv&quot;,&quot;txt&quot;],this.options={itemSelector:&quot;#cal-heatmap&quot;,paintOnLoad:!0,range:12,cellSize:10,cellPadding:2,cellRadius:0,domainGutter:2,domainMargin:[0,0,0,0],domain:&quot;hour&quot;,subDomain:&quot;min&quot;,colLimit:null,rowLimit:null,weekStartOnMonday:!0,start:new Date,minDate:null,maxDate:null,data:&quot;&quot;,dataType:this.allowedDataType[0],dataPostPayload:null,considerMissingDataAsZero:!1,loadOnInit:!0,verticalOrientation:!1,domainDynamicDimension:!0,label:{position:&quot;bottom&quot;,align:&quot;center&quot;,offset:{x:0,y:0},rotate:null,width:100,height:null},legend:[10,20,30,40],displayLegend:!0,legendCellSize:10,legendCellPadding:2,legendMargin:[0,0,0,0],legendVerticalPosition:&quot;bottom&quot;,legendHorizontalPosition:&quot;left&quot;,legendOrientation:&quot;horizontal&quot;,legendColors:null,highlight:[],itemName:[&quot;item&quot;,&quot;items&quot;],domainLabelFormat:null,subDomainTitleFormat:{empty:&quot;{date}&quot;,filled:&quot;{count} {name} {connector} {date}&quot;},subDomainDateFormat:null,subDomainTextFormat:null,legendTitleFormat:{lower:&quot;less than {min} {name}&quot;,inner:&quot;between {down} and {up} {name}&quot;,upper:&quot;more than {max} {name}&quot;},animationDuration:500,nextSelector:!1,previousSelector:!1,itemNamespace:&quot;cal-heatmap&quot;,tooltip:!1,onClick:null,afterLoad:null,afterLoadNextDomain:null,afterLoadPreviousDomain:null,onComplete:null,afterLoadData:function(a){return a},onMaxDomainReached:null,onMinDomainReached:null},this._domainType={min:{name:&quot;minute&quot;,level:10,maxItemNumber:60,defaultRowNumber:10,defaultColumnNumber:6,row:function(a){return d.getSubDomainRowNumber(a)},column:function(a){return d.getSubDomainColumnNumber(a)},position:{x:function(a){return Math.floor(a.getMinutes()/d._domainType.min.row(a))},y:function(a){return a.getMinutes()%d._domainType.min.row(a)}},format:{date:&quot;%H:%M, %A %B %-e, %Y&quot;,legend:&quot;&quot;,connector:&quot;at&quot;},extractUnit:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()).getTime()}},hour:{name:&quot;hour&quot;,level:20,maxItemNumber:function(a){switch(d.options.domain){case&quot;day&quot;:return 24;case&quot;week&quot;:return 168;case&quot;month&quot;:return 24*(d.options.domainDynamicDimension?d.getDayCountInMonth(a):31)}},defaultRowNumber:6,defaultColumnNumber:function(a){switch(d.options.domain){case&quot;day&quot;:return 4;case&quot;week&quot;:return 28;case&quot;month&quot;:return d.options.domainDynamicDimension?d.getDayCountInMonth(a):31}},row:function(a){return d.getSubDomainRowNumber(a)},column:function(a){return d.getSubDomainColumnNumber(a)},position:{x:function(a){return&quot;month&quot;===d.options.domain?d.options.colLimit&gt;0||d.options.rowLimit&gt;0?Math.floor((a.getHours()+24*(a.getDate()-1))/d._domainType.hour.row(a)):Math.floor(a.getHours()/d._domainType.hour.row(a))+4*(a.getDate()-1):&quot;week&quot;===d.options.domain?d.options.colLimit&gt;0||d.options.rowLimit&gt;0?Math.floor((a.getHours()+24*d.getWeekDay(a))/d._domainType.hour.row(a)):Math.floor(a.getHours()/d._domainType.hour.row(a))+4*d.getWeekDay(a):Math.floor(a.getHours()/d._domainType.hour.row(a))},y:function(a){var b=a.getHours();if(d.options.colLimit&gt;0||d.options.rowLimit&gt;0)switch(d.options.domain){case&quot;month&quot;:b+=24*(a.getDate()-1);break;case&quot;week&quot;:b+=24*d.getWeekDay(a)}return Math.floor(b%d._domainType.hour.row(a))}},format:{date:&quot;%Hh, %A %B %-e, %Y&quot;,legend:&quot;%H:00&quot;,connector:&quot;at&quot;},extractUnit:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours()).getTime()}},day:{name:&quot;day&quot;,level:30,maxItemNumber:function(a){switch(d.options.domain){case&quot;week&quot;:return 7;case&quot;month&quot;:return d.options.domainDynamicDimension?d.getDayCountInMonth(a):31;case&quot;year&quot;:return d.options.domainDynamicDimension?d.getDayCountInYear(a):366}},defaultColumnNumber:function(a){switch(a=new Date(a),d.options.domain){case&quot;week&quot;:return 1;case&quot;month&quot;:return d.options.domainDynamicDimension&amp;&amp;!d.options.verticalOrientation?d.getWeekNumber(new Date(a.getFullYear(),a.getMonth()+1,0))-d.getWeekNumber(a)+1:6;case&quot;year&quot;:return d.options.domainDynamicDimension?d.getWeekNumber(new Date(a.getFullYear(),11,31))-d.getWeekNumber(new Date(a.getFullYear(),0))+1:54}},defaultRowNumber:7,row:function(a){return d.getSubDomainRowNumber(a)},column:function(a){return d.getSubDomainColumnNumber(a)},position:{x:function(a){switch(d.options.domain){case&quot;week&quot;:return Math.floor(d.getWeekDay(a)/d._domainType.day.row(a));case&quot;month&quot;:return d.options.colLimit&gt;0||d.options.rowLimit&gt;0?Math.floor((a.getDate()-1)/d._domainType.day.row(a)):d.getWeekNumber(a)-d.getWeekNumber(new Date(a.getFullYear(),a.getMonth()));case&quot;year&quot;:return d.options.colLimit&gt;0||d.options.rowLimit&gt;0?Math.floor((d.getDayOfYear(a)-1)/d._domainType.day.row(a)):d.getWeekNumber(a)}},y:function(a){var b=d.getWeekDay(a);if(d.options.colLimit&gt;0||d.options.rowLimit&gt;0)switch(d.options.domain){case&quot;year&quot;:b=d.getDayOfYear(a)-1;break;case&quot;week&quot;:b=d.getWeekDay(a);break;case&quot;month&quot;:b=a.getDate()-1}return Math.floor(b%d._domainType.day.row(a))}},format:{date:&quot;%A %B %-e, %Y&quot;,legend:&quot;%e %b&quot;,connector:&quot;on&quot;},extractUnit:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()}},week:{name:&quot;week&quot;,level:40,maxItemNumber:54,defaultColumnNumber:function(a){switch(a=new Date(a),d.options.domain){case&quot;year&quot;:return d._domainType.week.maxItemNumber;case&quot;month&quot;:return d.options.domainDynamicDimension?d.getWeekNumber(new Date(a.getFullYear(),a.getMonth()+1,0))-d.getWeekNumber(a):5}},defaultRowNumber:1,row:function(a){return d.getSubDomainRowNumber(a)},column:function(a){return d.getSubDomainColumnNumber(a)},position:{x:function(a){switch(d.options.domain){case&quot;year&quot;:return Math.floor(d.getWeekNumber(a)/d._domainType.week.row(a));case&quot;month&quot;:return Math.floor(d.getMonthWeekNumber(a)/d._domainType.week.row(a))}},y:function(a){return d.getWeekNumber(a)%d._domainType.week.row(a)}},format:{date:&quot;%B Week #%W&quot;,legend:&quot;%B Week #%W&quot;,connector:&quot;in&quot;},extractUnit:function(a){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate()),c=b.getDay()-(d.options.weekStartOnMonday?1:0);return c&lt;0&amp;&amp;(c=6),b.setDate(b.getDate()-c),b.getTime()}},month:{name:&quot;month&quot;,level:50,maxItemNumber:12,defaultColumnNumber:12,defaultRowNumber:1,row:function(){return d.getSubDomainRowNumber()},column:function(){return d.getSubDomainColumnNumber()},position:{x:function(a){return Math.floor(a.getMonth()/d._domainType.month.row(a))},y:function(a){return a.getMonth()%d._domainType.month.row(a)}},format:{date:&quot;%B %Y&quot;,legend:&quot;%B&quot;,connector:&quot;in&quot;},extractUnit:function(a){return new Date(a.getFullYear(),a.getMonth()).getTime()}},year:{name:&quot;year&quot;,level:60,row:function(){return d.options.rowLimit||1},column:function(){return d.options.colLimit||1},position:{x:function(){return 1},y:function(){return 1}},format:{date:&quot;%Y&quot;,legend:&quot;%Y&quot;,connector:&quot;in&quot;},extractUnit:function(a){return new Date(a.getFullYear()).getTime()}}};for(var e in this._domainType)if(this._domainType.hasOwnProperty(e)){var f=this._domainType[e];this._domainType[&quot;x_&quot;+e]={name:&quot;x_&quot;+e,level:f.type,maxItemNumber:f.maxItemNumber,defaultRowNumber:f.defaultRowNumber,defaultColumnNumber:f.defaultColumnNumber,row:f.column,column:f.row,position:{x:f.position.y,y:f.position.x},format:f.format,extractUnit:f.extractUnit}}this.lastInsertedSvg=null,this._completed=!1,this._domains=d3.map(),this.graphDim={width:0,height:0},this.legendDim={width:0,height:0},this.NAVIGATE_LEFT=1,this.NAVIGATE_RIGHT=2,this.RESET_ALL_ON_UPDATE=0,this.RESET_SINGLE_ON_UPDATE=1,this.APPEND_ON_UPDATE=2,this.DEFAULT_LEGEND_MARGIN=10,this.root=null,this.tooltip=null,this._maxDomainReached=!1,this._minDomainReached=!1,this.domainPosition=new DomainPosition,this.Legend=null,this.legendScale=null,this.DSTDomain=[],this._init=function(){return d.getDomain(d.options.start).map(function(a){return a.getTime()}).map(function(a){d._domains.set(a,d.getSubDomain(a).map(function(a){return{t:d._domainType[d.options.subDomain].extractUnit(a),v:null}}))}),d.root=d3.select(d.options.itemSelector).append(&quot;svg&quot;).attr(&quot;class&quot;,&quot;cal-heatmap-container&quot;),d.tooltip=d3.select(d.options.itemSelector).attr(&quot;style&quot;,function(){var a=d3.select(d.options.itemSelector).attr(&quot;style&quot;);return(null!==a?a:&quot;&quot;)+&quot;position:relative;&quot;}).append(&quot;div&quot;).attr(&quot;class&quot;,&quot;ch-tooltip&quot;),d.root.attr(&quot;x&quot;,0).attr(&quot;y&quot;,0).append(&quot;svg&quot;).attr(&quot;class&quot;,&quot;graph&quot;),d.Legend=new Legend(d),d.options.paintOnLoad&amp;&amp;a(),!0},this.paint=function(a){function e(b,c,e,f){var g=0;switch(a){case!1:return g=c[e],c[e]+=f,d.domainPosition.setPosition(b,g),g;case d.NAVIGATE_RIGHT:return d.domainPosition.setPosition(b,c[e]),i=f,j=d.domainPosition.getPositionFromIndex(1),d.domainPosition.shiftRightBy(j),c[e];case d.NAVIGATE_LEFT:return g=-f,i=-g,j=c[e]-d.domainPosition.getLast(),d.domainPosition.setPosition(b,g),d.domainPosition.shiftLeftBy(i),g}}function f(a){switch(g.label.rotate){case&quot;right&quot;:a.attr(&quot;transform&quot;,function(a){var c=&quot;rotate(90), &quot;;switch(g.label.position){case&quot;right&quot;:c+=&quot;translate(-&quot;+b(a)+&quot; , -&quot;+b(a)+&quot;)&quot;;break;case&quot;left&quot;:c+=&quot;translate(0, -&quot;+d.domainHorizontalLabelWidth+&quot;)&quot;}return c});break;case&quot;left&quot;:a.attr(&quot;transform&quot;,function(a){var c=&quot;rotate(270), &quot;;switch(g.label.position){case&quot;right&quot;:c+=&quot;translate(-&quot;+(b(a)+d.domainHorizontalLabelWidth)+&quot; , &quot;+b(a)+&quot;)&quot;;break;case&quot;left&quot;:c+=&quot;translate(-&quot;+d.domainHorizontalLabelWidth+&quot; , &quot;+d.domainHorizontalLabelWidth+&quot;)&quot;}return c})}}var g=d.options;0===arguments.length&amp;&amp;(a=!1);var h=d.root.select(&quot;.graph&quot;).selectAll(&quot;.graph-domain&quot;).data(function(){var b=d.getDomainKeys();return a===d.NAVIGATE_LEFT?b.reverse():b},function(a){return a}),i=0,j=0,k=h.enter().append(&quot;svg&quot;).attr(&quot;width&quot;,function(a){return b(a,!0)}).attr(&quot;height&quot;,function(a){return c(a,!0)}).attr(&quot;x&quot;,function(a){return g.verticalOrientation?(d.graphDim.width=Math.max(d.graphDim.width,b(a,!0)),0):e(a,d.graphDim,&quot;width&quot;,b(a,!0))}).attr(&quot;y&quot;,function(a){return g.verticalOrientation?e(a,d.graphDim,&quot;height&quot;,c(a,!0)):(d.graphDim.height=Math.max(d.graphDim.height,c(a,!0)),0)}).attr(&quot;class&quot;,function(a){var b=&quot;graph-domain&quot;,c=new Date(a);switch(g.domain){case&quot;hour&quot;:b+=&quot; h_&quot;+c.getHours();case&quot;day&quot;:b+=&quot; d_&quot;+c.getDate()+&quot; dy_&quot;+c.getDay();case&quot;week&quot;:b+=&quot; w_&quot;+d.getWeekNumber(c);case&quot;month&quot;:b+=&quot; m_&quot;+(c.getMonth()+1);case&quot;year&quot;:b+=&quot; y_&quot;+c.getFullYear()}return b});d.lastInsertedSvg=k,k.append(&quot;rect&quot;).attr(&quot;width&quot;,function(a){return b(a,!0)-g.domainGutter-g.cellPadding}).attr(&quot;height&quot;,function(a){return c(a,!0)-g.domainGutter-g.cellPadding}).attr(&quot;class&quot;,&quot;domain-background&quot;);var l=k.append(&quot;svg&quot;).attr(&quot;x&quot;,function(){return&quot;left&quot;===g.label.position?d.domainHorizontalLabelWidth+g.domainMargin[3]:g.domainMargin[3]}).attr(&quot;y&quot;,function(){return&quot;top&quot;===g.label.position?d.domainVerticalLabelHeight+g.domainMargin[0]:g.domainMargin[0]}).attr(&quot;class&quot;,&quot;graph-subdomain-group&quot;),m=l.selectAll(&quot;g&quot;).data(function(a){return d._domains.get(a)}).enter().append(&quot;g&quot;);m.append(&quot;rect&quot;).attr(&quot;class&quot;,function(a){return&quot;graph-rect&quot;+d.getHighlightClassName(a.t)+(null!==g.onClick?&quot; hover_cursor&quot;:&quot;&quot;)}).attr(&quot;width&quot;,g.cellSize).attr(&quot;height&quot;,g.cellSize).attr(&quot;x&quot;,function(a){return d.positionSubDomainX(a.t)}).attr(&quot;y&quot;,function(a){return d.positionSubDomainY(a.t)}).on(&quot;click&quot;,function(a){if(null!==g.onClick)return d.onClick(new Date(a.t),a.v)}).call(function(a){g.cellRadius&gt;0&amp;&amp;a.attr(&quot;rx&quot;,g.cellRadius).attr(&quot;ry&quot;,g.cellRadius),null!==d.legendScale&amp;&amp;null!==g.legendColors&amp;&amp;g.legendColors.hasOwnProperty(&quot;base&quot;)&amp;&amp;a.attr(&quot;fill&quot;,g.legendColors.base),g.tooltip&amp;&amp;(a.on(&quot;mouseover&quot;,function(a){var b=this.parentNode.parentNode;d.tooltip.html(d.getSubDomainTitle(a)).attr(&quot;style&quot;,&quot;display: block;&quot;);var c=d.positionSubDomainX(a.t)-d.tooltip[0][0].offsetWidth/2+g.cellSize/2,e=d.positionSubDomainY(a.t)-d.tooltip[0][0].offsetHeight-g.cellSize/2;c+=parseInt(b.getAttribute(&quot;x&quot;),10),e+=parseInt(b.getAttribute(&quot;y&quot;),10),c+=parseInt(d.root.select(&quot;.graph&quot;).attr(&quot;x&quot;),10),e+=parseInt(d.root.select(&quot;.graph&quot;).attr(&quot;y&quot;),10),c+=parseInt(b.parentNode.getAttribute(&quot;x&quot;),10),e+=parseInt(b.parentNode.getAttribute(&quot;y&quot;),10),d.tooltip.attr(&quot;style&quot;,&quot;display: block; left: &quot;+c+&quot;px; top: &quot;+e+&quot;px;&quot;)}),a.on(&quot;mouseout&quot;,function(){d.tooltip.attr(&quot;style&quot;,&quot;display:none&quot;).html(&quot;&quot;)}))}),g.tooltip||m.append(&quot;title&quot;).text(function(a){return d.formatDate(new Date(a.t),g.subDomainDateFormat)}),&quot;&quot;!==g.domainLabelFormat&amp;&amp;k.append(&quot;text&quot;).attr(&quot;class&quot;,&quot;graph-label&quot;).attr(&quot;y&quot;,function(a){var b=g.domainMargin[0];switch(g.label.position){case&quot;top&quot;:b+=d.domainVerticalLabelHeight/2;break;case&quot;bottom&quot;:b+=c(a)+d.domainVerticalLabelHeight/2}return b+g.label.offset.y*(&quot;right&quot;===g.label.rotate&amp;&amp;&quot;right&quot;===g.label.position||&quot;left&quot;===g.label.rotate&amp;&amp;&quot;left&quot;===g.label.position?-1:1)}).attr(&quot;x&quot;,function(a){var c=g.domainMargin[3];switch(g.label.position){case&quot;right&quot;:c+=b(a);break;case&quot;bottom&quot;:case&quot;top&quot;:c+=b(a)/2}return&quot;right&quot;===g.label.align?c+d.domainHorizontalLabelWidth-g.label.offset.x*(&quot;right&quot;===g.label.rotate?-1:1):c+g.label.offset.x}).attr(&quot;text-anchor&quot;,function(){switch(g.label.align){case&quot;start&quot;:case&quot;left&quot;:return&quot;start&quot;;case&quot;end&quot;:case&quot;right&quot;:return&quot;end&quot;;default:return&quot;middle&quot;}}).attr(&quot;dominant-baseline&quot;,function(){return d.verticalDomainLabel?&quot;middle&quot;:&quot;top&quot;}).text(function(a){return d.formatDate(new Date(a),g.domainLabelFormat)}).call(f),null!==g.subDomainTextFormat&amp;&amp;m.append(&quot;text&quot;).attr(&quot;class&quot;,function(a){return&quot;subdomain-text&quot;+d.getHighlightClassName(a.t)}).attr(&quot;x&quot;,function(a){return d.positionSubDomainX(a.t)+g.cellSize/2}).attr(&quot;y&quot;,function(a){return d.positionSubDomainY(a.t)+g.cellSize/2}).attr(&quot;text-anchor&quot;,&quot;middle&quot;).attr(&quot;dominant-baseline&quot;,&quot;central&quot;).text(function(a){return d.formatDate(new Date(a.t),g.subDomainTextFormat)}),a!==!1&amp;&amp;h.transition().duration(g.animationDuration).attr(&quot;x&quot;,function(a){return g.verticalOrientation?0:d.domainPosition.getPosition(a)}).attr(&quot;y&quot;,function(a){return g.verticalOrientation?d.domainPosition.getPosition(a):0});var n=d.graphDim.width,o=d.graphDim.height;g.verticalOrientation?d.graphDim.height+=i-j:d.graphDim.width+=i-j,h.exit().transition().duration(g.animationDuration).attr(&quot;x&quot;,function(c){if(g.verticalOrientation)return 0;switch(a){case d.NAVIGATE_LEFT:return Math.min(d.graphDim.width,n);case d.NAVIGATE_RIGHT:return-b(c,!0)}}).attr(&quot;y&quot;,function(b){if(!g.verticalOrientation)return 0;switch(a){case d.NAVIGATE_LEFT:return Math.min(d.graphDim.height,o);case d.NAVIGATE_RIGHT:return-c(b,!0)}}).remove(),d.resize()}};CalHeatMap.prototype={init:function(a){&quot;use strict&quot;;function b(a,b,c){if((b&amp;&amp;a===!1||a instanceof Element||&quot;string&quot;==typeof a)&amp;&amp;&quot;&quot;!==a)return!0;throw new Error(&quot;The &quot;+c+&quot; is not valid&quot;)}function c(a){switch(a){case&quot;year&quot;:return&quot;month&quot;;case&quot;month&quot;:return&quot;day&quot;;case&quot;week&quot;:return&quot;day&quot;;case&quot;day&quot;:return&quot;hour&quot;;default:return&quot;min&quot;}}function d(){if(!k._domainType.hasOwnProperty(l.domain)||&quot;min&quot;===l.domain||&quot;x_&quot;===l.domain.substring(0,2))throw new Error(&quot;The domain '&quot;+l.domain+&quot;' is not valid&quot;);if(!k._domainType.hasOwnProperty(l.subDomain)||&quot;year&quot;===l.subDomain)throw new Error(&quot;The subDomain '&quot;+l.subDomain+&quot;' is not valid&quot;);if(k._domainType[l.domain].level&lt;=k._domainType[l.subDomain].level)throw new Error(&quot;'&quot;+l.subDomain+&quot;' is not a valid subDomain to '&quot;+l.domain+&quot;'&quot;);return!0}function e(){if(!a.hasOwnProperty(&quot;label&quot;)||a.hasOwnProperty(&quot;label&quot;)&amp;&amp;!a.label.hasOwnProperty(&quot;align&quot;)){switch(l.label.position){case&quot;left&quot;:l.label.align=&quot;right&quot;;break;case&quot;right&quot;:l.label.align=&quot;left&quot;;break;default:l.label.align=&quot;center&quot;}&quot;left&quot;===l.label.rotate?l.label.align=&quot;right&quot;:&quot;right&quot;===l.label.rotate&amp;&amp;(l.label.align=&quot;left&quot;)}(!a.hasOwnProperty(&quot;label&quot;)||a.hasOwnProperty(&quot;label&quot;)&amp;&amp;!a.label.hasOwnProperty(&quot;offset&quot;))&amp;&amp;(&quot;left&quot;!==l.label.position&amp;&amp;&quot;right&quot;!==l.label.position||(l.label.offset={x:10,y:15}))}function f(){switch(l.legendVerticalPosition){case&quot;top&quot;:l.legendMargin[2]=k.DEFAULT_LEGEND_MARGIN;break;case&quot;bottom&quot;:l.legendMargin[0]=k.DEFAULT_LEGEND_MARGIN;break;case&quot;middle&quot;:case&quot;center&quot;:l.legendMargin[&quot;right&quot;===l.legendHorizontalPosition?3:1]=k.DEFAULT_LEGEND_MARGIN}}function g(a){switch(&quot;number&quot;==typeof a&amp;&amp;(a=[a]),Array.isArray(a)||(console.log(&quot;Margin only takes an integer or an array of integers&quot;),a=[0]),a.length){case 1:return[a[0],a[0],a[0],a[0]];case 2:return[a[0],a[1],a[0],a[1]];case 3:return[a[0],a[1],a[2],a[1]];case 4:return a;default:return a.slice(0,4)}}function h(a){return&quot;string&quot;==typeof a?[a,a+(&quot;&quot;!==a?&quot;s&quot;:&quot;&quot;)]:Array.isArray(a)?1===a.length?[a[0],a[0]+&quot;s&quot;]:a.length&gt;2?a.slice(0,2):a:[&quot;item&quot;,&quot;items&quot;]}function i(a){return a&gt;0?a:null}function j(a){return a&gt;0&amp;&amp;l.colLimit&gt;0?(console.log(&quot;colLimit and rowLimit are mutually exclusive, rowLimit will be ignored&quot;),null):a&gt;0?a:null}var k=this,l=k.options=mergeRecursive(k.options,a);if(d(),b(l.itemSelector,!1,&quot;itemSelector&quot;),k.allowedDataType.indexOf(l.dataType)===-1)throw new Error(&quot;The data type '&quot;+l.dataType+&quot;' is not valid data type&quot;);if(null===d3.select(l.itemSelector)[0][0])throw new Error(&quot;The node '&quot;+l.itemSelector+&quot;' specified in itemSelector does not exists&quot;);try{b(l.nextSelector,!0,&quot;nextSelector&quot;),b(l.previousSelector,!0,&quot;previousSelector&quot;)}catch(a){return console.log(a.message),!1}a.hasOwnProperty(&quot;subDomain&quot;)||(this.options.subDomain=c(a.domain)),&quot;string&quot;==typeof l.itemNamespace&amp;&amp;&quot;&quot;!==l.itemNamespace||(console.log(&quot;itemNamespace can not be empty, falling back to cal-heatmap&quot;),l.itemNamespace=&quot;cal-heatmap&quot;);var m=[&quot;data&quot;,&quot;onComplete&quot;,&quot;onClick&quot;,&quot;afterLoad&quot;,&quot;afterLoadData&quot;,&quot;afterLoadPreviousDomain&quot;,&quot;afterLoadNextDomain&quot;];for(var n in m)a.hasOwnProperty(m[n])&amp;&amp;(l[m[n]]=a[m[n]]);return l.subDomainDateFormat=&quot;string&quot;==typeof l.subDomainDateFormat||&quot;function&quot;==typeof l.subDomainDateFormat?l.subDomainDateFormat:this._domainType[l.subDomain].format.date,l.domainLabelFormat=&quot;string&quot;==typeof l.domainLabelFormat||&quot;function&quot;==typeof l.domainLabelFormat?l.domainLabelFormat:this._domainType[l.domain].format.legend,l.subDomainTextFormat=&quot;string&quot;==typeof l.subDomainTextFormat&amp;&amp;&quot;&quot;!==l.subDomainTextFormat||&quot;function&quot;==typeof l.subDomainTextFormat?l.subDomainTextFormat:null,l.domainMargin=g(l.domainMargin),l.legendMargin=g(l.legendMargin),l.highlight=k.expandDateSetting(l.highlight),l.itemName=h(l.itemName),l.colLimit=i(l.colLimit),l.rowLimit=j(l.rowLimit),a.hasOwnProperty(&quot;legendMargin&quot;)||f(),e(),this._init()},expandDateSetting:function(a){&quot;use strict&quot;;return Array.isArray(a)||(a=[a]),a.map(function(a){return&quot;now&quot;===a?new Date:a instanceof Date&amp;&amp;a}).filter(function(a){return a!==!1})},fill:function(a){&quot;use strict&quot;;function b(a){return null!==d.legendScale&amp;&amp;void a.attr(&quot;fill&quot;,function(a){return null===a.v&amp;&amp;e.hasOwnProperty(&quot;considerMissingDataAsZero&quot;)&amp;&amp;!e.considerMissingDataAsZero&amp;&amp;e.legendColors.hasOwnProperty(&quot;base&quot;)?e.legendColors.base:null!==e.legendColors&amp;&amp;e.legendColors.hasOwnProperty(&quot;empty&quot;)&amp;&amp;(0===a.v||null===a.v&amp;&amp;e.hasOwnProperty(&quot;considerMissingDataAsZero&quot;)&amp;&amp;e.considerMissingDataAsZero)?e.legendColors.empty:a.v&lt;0&amp;&amp;e.legend[0]&gt;0&amp;&amp;null!==e.legendColors&amp;&amp;e.legendColors.hasOwnProperty(&quot;overflow&quot;)?e.legendColors.overflow:d.legendScale(Math.min(a.v,e.legend[e.legend.length-1]))})}function c(a){&quot;function&quot;==typeof e.subDomainTextFormat&amp;&amp;a.text(function(a){return e.subDomainTextFormat(a.t,a.v)})}var d=this,e=d.options;0===arguments.length&amp;&amp;(a=d.root.selectAll(&quot;.graph-domain&quot;));var f=a.selectAll(&quot;svg&quot;).selectAll(&quot;g&quot;).data(function(a){return d._domains.get(a)});f.transition().duration(e.animationDuration).select(&quot;rect&quot;).attr(&quot;class&quot;,function(a){var b=d.getHighlightClassName(a.t).trim().split(&quot; &quot;),c=d.dateIsLessThan(a.t,new Date),f=d.dateIsEqual(a.t,new Date);return(null===d.legendScale||null===a.v&amp;&amp;e.hasOwnProperty(&quot;considerMissingDataAsZero&quot;)&amp;&amp;!e.considerMissingDataAsZero&amp;&amp;!e.legendColors.hasOwnProperty(&quot;base&quot;))&amp;&amp;b.push(&quot;graph-rect&quot;),f?b.push(&quot;now&quot;):c||b.push(&quot;future&quot;),null!==a.v?b.push(d.Legend.getClass(a.v,null===d.legendScale)):e.considerMissingDataAsZero&amp;&amp;c&amp;&amp;b.push(d.Legend.getClass(0,null===d.legendScale)),null!==e.onClick&amp;&amp;b.push(&quot;hover_cursor&quot;),b.join(&quot; &quot;)}).call(b),f.transition().duration(e.animationDuration).select(&quot;title&quot;).text(function(a){return d.getSubDomainTitle(a)}),f.transition().duration(e.animationDuration).select(&quot;text&quot;).attr(&quot;class&quot;,function(a){return&quot;subdomain-text&quot;+d.getHighlightClassName(a.t)}).call(c)},triggerEvent:function(a,b,c){&quot;use strict&quot;;return!!(3===arguments.length&amp;&amp;c||null===this.options[a])||(&quot;function&quot;==typeof this.options[a]?(&quot;function&quot;==typeof b&amp;&amp;(b=b()),this.options[a].apply(this,b)):(console.log(&quot;Provided callback for &quot;+a+&quot; is not a function.&quot;),!1))},onClick:function(a,b){&quot;use strict&quot;;return this.triggerEvent(&quot;onClick&quot;,[a,b])},afterLoad:function(){&quot;use strict&quot;;return this.triggerEvent(&quot;afterLoad&quot;)},onComplete:function(){&quot;use strict&quot;;var a=this.triggerEvent(&quot;onComplete&quot;,[],this._completed);return this._completed=!0,a},afterLoadPreviousDomain:function(a){&quot;use strict&quot;;var b=this;return this.triggerEvent(&quot;afterLoadPreviousDomain&quot;,function(){var c=b.getSubDomain(a);return[c.shift(),c.pop()]})},afterLoadNextDomain:function(a){&quot;use strict&quot;;var b=this;return this.triggerEvent(&quot;afterLoadNextDomain&quot;,function(){var c=b.getSubDomain(a);return[c.shift(),c.pop()]})},onMinDomainReached:function(a){&quot;use strict&quot;;return this._minDomainReached=a,this.triggerEvent(&quot;onMinDomainReached&quot;,[a])},onMaxDomainReached:function(a){&quot;use strict&quot;;return this._maxDomainReached=a,this.triggerEvent(&quot;onMaxDomainReached&quot;,[a])},checkIfMinDomainIsReached:function(a,b){&quot;use strict&quot;;this.minDomainIsReached(a)&amp;&amp;this.onMinDomainReached(!0),2===arguments.length&amp;&amp;this._maxDomainReached&amp;&amp;!this.maxDomainIsReached(b)&amp;&amp;this.onMaxDomainReached(!1)},checkIfMaxDomainIsReached:function(a,b){&quot;use strict&quot;;this.maxDomainIsReached(a)&amp;&amp;this.onMaxDomainReached(!0),2===arguments.length&amp;&amp;this._minDomainReached&amp;&amp;!this.minDomainIsReached(b)&amp;&amp;this.onMinDomainReached(!1)},formatNumber:d3.format(&quot;,g&quot;),formatDate:function(a,b){&quot;use strict&quot;;if(arguments.length&lt;2&amp;&amp;(b=&quot;title&quot;),&quot;function&quot;==typeof b)return b(a);var c=d3.time.format(b);return c(a)},getSubDomainTitle:function(a){&quot;use strict&quot;;if(null!==a.v||this.options.considerMissingDataAsZero){var b=a.v;return null===b&amp;&amp;this.options.considerMissingDataAsZero&amp;&amp;(b=0),this.options.subDomainTitleFormat.filled.format({count:this.formatNumber(b),name:this.options.itemName[1!==b?1:0],connector:this._domainType[this.options.subDomain].format.connector,date:this.formatDate(new Date(a.t),this.options.subDomainDateFormat)})}return this.options.subDomainTitleFormat.empty.format({date:this.formatDate(new Date(a.t),this.options.subDomainDateFormat)})},loadNextDomain:function(a){&quot;use strict&quot;;if(this._maxDomainReached||0===a)return!1;var b=this.loadNewDomains(this.NAVIGATE_RIGHT,this.getDomain(this.getNextDomain(),a));return this.afterLoadNextDomain(b.end),this.checkIfMaxDomainIsReached(this.getNextDomain().getTime(),b.start),!0},loadPreviousDomain:function(a){&quot;use strict&quot;;if(this._minDomainReached||0===a)return!1;var b=this.loadNewDomains(this.NAVIGATE_LEFT,this.getDomain(this.getDomainKeys()[0],-a).reverse());return this.afterLoadPreviousDomain(b.start),this.checkIfMinDomainIsReached(b.start,b.end),!0},loadNewDomains:function(a,b){&quot;use strict&quot;;function c(a){return{t:d._domainType[d.options.subDomain].extractUnit(a),v:null}}for(var d=this,e=a===this.NAVIGATE_LEFT,f=-1,g=b.length,h=this.getDomainKeys();++f&lt;g;){if(e&amp;&amp;this.minDomainIsReached(b[f])){b=b.slice(0,f+1);break}if(!e&amp;&amp;this.maxDomainIsReached(b[f])){b=b.slice(0,f);break}}for(b=b.slice(-this.options.range),f=0,g=b.length;f&lt;g;f++)this._domains.set(b[f].getTime(),this.getSubDomain(b[f]).map(c)),this._domains.remove(e?h.pop():h.shift());return h=this.getDomainKeys(),e&amp;&amp;(b=b.reverse()),this.paint(a),this.getDatas(this.options.data,b[0],this.getSubDomain(b[b.length-1]).pop(),function(){d.fill(d.lastInsertedSvg)}),{start:b[e?0:1],end:h[h.length-1]}},maxDomainIsReached:function(a){&quot;use strict&quot;;return null!==this.options.maxDate&amp;&amp;this.options.maxDate.getTime()&lt;a},minDomainIsReached:function(a){&quot;use strict&quot;;return null!==this.options.minDate&amp;&amp;this.options.minDate.getTime()&gt;=a},getDomainKeys:function(){&quot;use strict&quot;;return this._domains.keys().map(function(a){return parseInt(a,10)}).sort(function(a,b){return a-b})},positionSubDomainX:function(a){&quot;use strict&quot;;var b=this._domainType[this.options.subDomain].position.x(new Date(a));return b*this.options.cellSize+b*this.options.cellPadding},positionSubDomainY:function(a){&quot;use strict&quot;;var b=this._domainType[this.options.subDomain].position.y(new Date(a));return b*this.options.cellSize+b*this.options.cellPadding},getSubDomainColumnNumber:function(a){&quot;use strict&quot;;if(this.options.rowLimit&gt;0){var b=this._domainType[this.options.subDomain].maxItemNumber;return&quot;function&quot;==typeof b&amp;&amp;(b=b(a)),Math.ceil(b/this.options.rowLimit)}var c=this._domainType[this.options.subDomain].defaultColumnNumber;return&quot;function&quot;==typeof c&amp;&amp;(c=c(a)),this.options.colLimit||c},getSubDomainRowNumber:function(a){&quot;use strict&quot;;if(this.options.colLimit&gt;0){var b=this._domainType[this.options.subDomain].maxItemNumber;return&quot;function&quot;==typeof b&amp;&amp;(b=b(a)),Math.ceil(b/this.options.colLimit)}var c=this._domainType[this.options.subDomain].defaultRowNumber;return&quot;function&quot;==typeof c&amp;&amp;(c=c(a)),this.options.rowLimit||c},getHighlightClassName:function(a){&quot;use strict&quot;;if(a=new Date(a),this.options.highlight.length&gt;0)for(var b in this.options.highlight)if(this.dateIsEqual(this.options.highlight[b],a))return this.isNow(this.options.highlight[b])?&quot; highlight-now&quot;:&quot; highlight&quot;;return&quot;&quot;},isNow:function(a){&quot;use strict&quot;;return this.dateIsEqual(a,new Date)},dateIsEqual:function(a,b){&quot;use strict&quot;;switch(a instanceof Date||(a=new Date(a)),b instanceof Date||(b=new Date(b)),this.options.subDomain){case&quot;x_min&quot;:case&quot;min&quot;:return a.getFullYear()===b.getFullYear()&amp;&amp;a.getMonth()===b.getMonth()&amp;&amp;a.getDate()===b.getDate()&amp;&amp;a.getHours()===b.getHours()&amp;&amp;a.getMinutes()===b.getMinutes();case&quot;x_hour&quot;:case&quot;hour&quot;:return a.getFullYear()===b.getFullYear()&amp;&amp;a.getMonth()===b.getMonth()&amp;&amp;a.getDate()===b.getDate()&amp;&amp;a.getHours()===b.getHours();case&quot;x_day&quot;:case&quot;day&quot;:return a.getFullYear()===b.getFullYear()&amp;&amp;a.getMonth()===b.getMonth()&amp;&amp;a.getDate()===b.getDate();case&quot;x_week&quot;:case&quot;week&quot;:return a.getFullYear()===b.getFullYear()&amp;&amp;this.getWeekNumber(a)===this.getWeekNumber(b);case&quot;x_month&quot;:case&quot;month&quot;:return a.getFullYear()===b.getFullYear()&amp;&amp;a.getMonth()===b.getMonth();default:return!1}},dateIsLessThan:function(a,b){&quot;use strict&quot;;function c(a,b){switch(b){case&quot;x_min&quot;:case&quot;min&quot;:return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()).getTime();case&quot;x_hour&quot;:case&quot;hour&quot;:return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours()).getTime();case&quot;x_day&quot;:case&quot;day&quot;:return new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime();case&quot;x_week&quot;:case&quot;week&quot;:case&quot;x_month&quot;:case&quot;month&quot;:return new Date(a.getFullYear(),a.getMonth()).getTime();default:return a.getTime()}}return a instanceof Date||(a=new Date(a)),b instanceof Date||(b=new Date(b)),c(a,this.options.subDomain)&lt;c(b,this.options.subDomain)},getDayOfYear:d3.time.format(&quot;%j&quot;),getWeekNumber:function(a){&quot;use strict&quot;;var b=this.options.weekStartOnMonday===!0?d3.time.format(&quot;%W&quot;):d3.time.format(&quot;%U&quot;);return b(a)},getMonthWeekNumber:function(a){&quot;use strict&quot;;&quot;number&quot;==typeof a&amp;&amp;(a=new Date(a));var b=this.getWeekNumber(new Date(a.getFullYear(),a.getMonth()));return this.getWeekNumber(a)-b-1},getWeekNumberInYear:function(a){&quot;use strict&quot;;&quot;number&quot;==typeof a&amp;&amp;(a=new Date(a))},getDayCountInMonth:function(a){&quot;use strict&quot;;return this.getEndOfMonth(a).getDate()},getDayCountInYear:function(a){&quot;use strict&quot;;return&quot;number&quot;==typeof a&amp;&amp;(a=new Date(a)),1===new Date(a.getFullYear(),1,29).getMonth()?366:365},getWeekDay:function(a){&quot;use strict&quot;;return this.options.weekStartOnMonday===!1?a.getDay():0===a.getDay()?6:a.getDay()-1},getEndOfMonth:function(a){&quot;use strict&quot;;return&quot;number&quot;==typeof a&amp;&amp;(a=new Date(a)),new Date(a.getFullYear(),a.getMonth()+1,0)},jumpDate:function(a,b,c){&quot;use strict&quot;;var d=new Date(a);switch(c){case&quot;hour&quot;:d.setHours(d.getHours()+b);break;case&quot;day&quot;:d.setHours(d.getHours()+24*b);break;case&quot;week&quot;:d.setHours(d.getHours()+24*b*7);break;case&quot;month&quot;:d.setMonth(d.getMonth()+b);break;case&quot;year&quot;:d.setFullYear(d.getFullYear()+b)}return new Date(d)},getMinuteDomain:function(a,b){&quot;use strict&quot;;var c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours()),d=null;return d=b instanceof Date?new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours()):new Date(+c+1e3*b*60),d3.time.minutes(Math.min(c,d),Math.max(c,d))},getHourDomain:function(a,b){&quot;use strict&quot;;var c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours()),d=null;b instanceof Date?d=new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours()):(d=new Date(c),d.setHours(d.getHours()+b));var e=d3.time.hours(Math.min(c,d),Math.max(c,d)),f=0,g=e.length;for(f=0;f&lt;g;f++)if(f&gt;0&amp;&amp;e[f].getHours()===e[f-1].getHours()){this.DSTDomain.push(e[f].getTime()),e.splice(f,1);break}return&quot;number&quot;==typeof b&amp;&amp;e.length&gt;Math.abs(b)&amp;&amp;e.splice(e.length-1,1),e},getDayDomain:function(a,b){&quot;use strict&quot;;var c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),d=null;return b instanceof Date?d=new Date(b.getFullYear(),b.getMonth(),b.getDate()):(d=new Date(c),d=new Date(d.setDate(d.getDate()+parseInt(b,10)))),d3.time.days(Math.min(c,d),Math.max(c,d))},getWeekDomain:function(a,b){&quot;use strict&quot;;var c;this.options.weekStartOnMonday===!1?c=new Date(a.getFullYear(),a.getMonth(),a.getDate()-a.getDay()):1===a.getDay()?c=new Date(a.getFullYear(),a.getMonth(),a.getDate()):0===a.getDay()?(c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),c.setDate(c.getDate()-6)):c=new Date(a.getFullYear(),a.getMonth(),a.getDate()-a.getDay()+1);var d=new Date(c),e=b;return&quot;object&quot;!=typeof b&amp;&amp;(e=new Date(d.setDate(d.getDate()+7*b))),this.options.weekStartOnMonday===!0?d3.time.mondays(Math.min(c,e),Math.max(c,e)):d3.time.sundays(Math.min(c,e),Math.max(c,e))},getMonthDomain:function(a,b){&quot;use strict&quot;;var c=new Date(a.getFullYear(),a.getMonth()),d=null;return b instanceof Date?d=new Date(b.getFullYear(),b.getMonth()):(d=new Date(c),d=d.setMonth(d.getMonth()+b)),d3.time.months(Math.min(c,d),Math.max(c,d))},getYearDomain:function(a,b){
&quot;use strict&quot;;var c=new Date(a.getFullYear(),0),d=null;return d=b instanceof Date?new Date(b.getFullYear(),0):new Date(a.getFullYear()+b,0),d3.time.years(Math.min(c,d),Math.max(c,d))},getDomain:function(a,b){&quot;use strict&quot;;switch(&quot;number&quot;==typeof a&amp;&amp;(a=new Date(a)),arguments.length&lt;2&amp;&amp;(b=this.options.range),this.options.domain){case&quot;hour&quot;:var c=this.getHourDomain(a,b);return&quot;number&quot;==typeof b&amp;&amp;c.length&lt;b&amp;&amp;(b&gt;0?c.push(this.getHourDomain(c[c.length-1],2)[1]):c.shift(this.getHourDomain(c[0],-2)[0])),c;case&quot;day&quot;:return this.getDayDomain(a,b);case&quot;week&quot;:return this.getWeekDomain(a,b);case&quot;month&quot;:return this.getMonthDomain(a,b);case&quot;year&quot;:return this.getYearDomain(a,b)}},getSubDomain:function(a){&quot;use strict&quot;;&quot;number&quot;==typeof a&amp;&amp;(a=new Date(a));var b=this,c=function(a,c){switch(c){case&quot;year&quot;:return b.getDayCountInYear(a);case&quot;month&quot;:return b.getDayCountInMonth(a);case&quot;week&quot;:return 7}},d=function(a,b){switch(b){case&quot;hour&quot;:return 60;case&quot;day&quot;:return 1440;case&quot;week&quot;:return 10080}},e=function(a,c){switch(c){case&quot;day&quot;:return 24;case&quot;week&quot;:return 168;case&quot;month&quot;:return 24*b.getDayCountInMonth(a)}},f=function(a,c){if(&quot;month&quot;===c){var d=new Date(a.getFullYear(),a.getMonth()+1,0),e=b.getWeekNumber(d),f=b.getWeekNumber(new Date(a.getFullYear(),a.getMonth()));return f&gt;e&amp;&amp;(f=0,e++),e-f+1}if(&quot;year&quot;===c)return b.getWeekNumber(new Date(a.getFullYear(),11,31))};switch(this.options.subDomain){case&quot;x_min&quot;:case&quot;min&quot;:return this.getMinuteDomain(a,d(a,this.options.domain));case&quot;x_hour&quot;:case&quot;hour&quot;:return this.getHourDomain(a,e(a,this.options.domain));case&quot;x_day&quot;:case&quot;day&quot;:return this.getDayDomain(a,c(a,this.options.domain));case&quot;x_week&quot;:case&quot;week&quot;:return this.getWeekDomain(a,f(a,this.options.domain));case&quot;x_month&quot;:case&quot;month&quot;:return this.getMonthDomain(a,12)}},getNextDomain:function(a){&quot;use strict&quot;;return 0===arguments.length&amp;&amp;(a=1),this.getDomain(this.jumpDate(this.getDomainKeys().pop(),a,this.options.domain),1)[0]},getPreviousDomain:function(a){&quot;use strict&quot;;return 0===arguments.length&amp;&amp;(a=1),this.getDomain(this.jumpDate(this.getDomainKeys().shift(),-a,this.options.domain),1)[0]},getDatas:function(a,b,c,d,e,f){&quot;use strict&quot;;var g=this;arguments.length&lt;5&amp;&amp;(e=!0),arguments.length&lt;6&amp;&amp;(f=this.APPEND_ON_UPDATE);var h=function(a){e!==!1?&quot;function&quot;==typeof e?a=e(a):&quot;function&quot;==typeof g.options.afterLoadData?a=g.options.afterLoadData(a):console.log(&quot;Provided callback for afterLoadData is not a function.&quot;):&quot;csv&quot;!==g.options.dataType&amp;&amp;&quot;tsv&quot;!==g.options.dataType||(a=this.interpretCSV(a)),g.parseDatas(a,f,b,c),&quot;function&quot;==typeof d&amp;&amp;d()};switch(typeof a){case&quot;string&quot;:if(&quot;&quot;===a)return h({}),!0;var i=this.parseURI(a,b,c),j=&quot;GET&quot;;null!==g.options.dataPostPayload&amp;&amp;(j=&quot;POST&quot;);var k=null;switch(null!==g.options.dataPostPayload&amp;&amp;(k=this.parseURI(g.options.dataPostPayload,b,c)),this.options.dataType){case&quot;json&quot;:d3.json(i,h).send(j,k);break;case&quot;csv&quot;:d3.csv(i,h).send(j,k);break;case&quot;tsv&quot;:d3.tsv(i,h).send(j,k);break;case&quot;txt&quot;:d3.text(i,&quot;text/plain&quot;,h).send(j,k)}return!1;case&quot;object&quot;:if(a===Object(a))return h(a),!1;default:return h({}),!0}},parseDatas:function(a,b,c,d){&quot;use strict&quot;;b===this.RESET_ALL_ON_UPDATE&amp;&amp;this._domains.forEach(function(a,b){b.forEach(function(a,b,c){c[b].v=null})});var e={},f=function(a){return a.t};for(var g in a){var h=new Date(1e3*g),i=this.getDomain(h)[0].getTime();if(this.DSTDomain.indexOf(i)&gt;=0&amp;&amp;this._domains.has(i-36e5)&amp;&amp;(i-=36e5),!isNaN(g)&amp;&amp;a.hasOwnProperty(g)&amp;&amp;this._domains.has(i)&amp;&amp;i&gt;=+c&amp;&amp;i&lt;+d){var j=this._domains.get(i);e.hasOwnProperty(i)||(e[i]=j.map(f));var k=e[i].indexOf(this._domainType[this.options.subDomain].extractUnit(h));b===this.RESET_SINGLE_ON_UPDATE?j[k].v=a[g]:isNaN(j[k].v)?j[k].v=a[g]:j[k].v+=a[g]}}},parseURI:function(a,b,c){&quot;use strict&quot;;return a=a.replace(/\{\{t:start\}\}/g,b.getTime()/1e3),a=a.replace(/\{\{t:end\}\}/g,c.getTime()/1e3),a=a.replace(/\{\{d:start\}\}/g,b.toISOString()),a=a.replace(/\{\{d:end\}\}/g,c.toISOString())},interpretCSV:function(a){&quot;use strict&quot;;var b,c,d={},e=Object.keys(a[0]);for(b=0,c=a.length;b&lt;c;b++)d[a[b][e[0]]]=+a[b][e[1]];return d},resize:function(){&quot;use strict&quot;;var a=this,b=a.options,c=b.displayLegend?a.Legend.getDim(&quot;width&quot;)+b.legendMargin[1]+b.legendMargin[3]:0,d=b.displayLegend?a.Legend.getDim(&quot;height&quot;)+b.legendMargin[0]+b.legendMargin[2]:0,e=a.graphDim.width-b.domainGutter-b.cellPadding,f=a.graphDim.height-b.domainGutter-b.cellPadding;this.root.transition().duration(b.animationDuration).attr(&quot;width&quot;,function(){return&quot;middle&quot;===b.legendVerticalPosition||&quot;center&quot;===b.legendVerticalPosition?e+c:Math.max(e,c)}).attr(&quot;height&quot;,function(){return&quot;middle&quot;===b.legendVerticalPosition||&quot;center&quot;===b.legendVerticalPosition?Math.max(f,d):f+d}),this.root.select(&quot;.graph&quot;).transition().duration(b.animationDuration).attr(&quot;y&quot;,function(){return&quot;top&quot;===b.legendVerticalPosition?d:0}).attr(&quot;x&quot;,function(){return&quot;middle&quot;!==b.legendVerticalPosition&amp;&amp;&quot;center&quot;!==b.legendVerticalPosition||&quot;left&quot;!==b.legendHorizontalPosition?0:c})},next:function(a){&quot;use strict&quot;;return 0===arguments.length&amp;&amp;(a=1),this.loadNextDomain(a)},previous:function(a){&quot;use strict&quot;;return 0===arguments.length&amp;&amp;(a=1),this.loadPreviousDomain(a)},jumpTo:function(a,b){&quot;use strict&quot;;arguments.length&lt;2&amp;&amp;(b=!1);var c=this.getDomainKeys(),d=c[0],e=c[c.length-1];return a&lt;d?this.loadPreviousDomain(this.getDomain(d,a).length):b?this.loadNextDomain(this.getDomain(d,a).length):a&gt;e&amp;&amp;this.loadNextDomain(this.getDomain(e,a).length)},rewind:function(){&quot;use strict&quot;;this.jumpTo(this.options.start,!0)},update:function(a,b,c){&quot;use strict&quot;;arguments.length&lt;2&amp;&amp;(b=!0),arguments.length&lt;3&amp;&amp;(c=this.RESET_ALL_ON_UPDATE);var d=this.getDomainKeys(),e=this;this.getDatas(a,new Date(d[0]),this.getSubDomain(d[d.length-1]).pop(),function(){e.fill()},b,c)},setLegend:function(){&quot;use strict&quot;;var a=this.options.legend.slice(0);arguments.length&gt;=1&amp;&amp;Array.isArray(arguments[0])&amp;&amp;(this.options.legend=arguments[0]),arguments.length&gt;=2&amp;&amp;(Array.isArray(arguments[1])&amp;&amp;arguments[1].length&gt;=2?this.options.legendColors=[arguments[1][0],arguments[1][1]]:this.options.legendColors=arguments[1]),(arguments.length&gt;0&amp;&amp;!arrayEquals(a,this.options.legend)||arguments.length&gt;=2)&amp;&amp;(this.Legend.buildColors(),this.fill()),this.Legend.redraw(this.graphDim.width-this.options.domainGutter-this.options.cellPadding)},removeLegend:function(){&quot;use strict&quot;;return!!this.options.displayLegend&amp;&amp;(this.options.displayLegend=!1,this.Legend.remove(),!0)},showLegend:function(){&quot;use strict&quot;;return!this.options.displayLegend&amp;&amp;(this.options.displayLegend=!0,this.Legend.redraw(this.graphDim.width-this.options.domainGutter-this.options.cellPadding),!0)},highlight:function(a){&quot;use strict&quot;;return(this.options.highlight=this.expandDateSetting(a)).length&gt;0&amp;&amp;(this.fill(),!0)},destroy:function(a){&quot;use strict&quot;;return this.root.transition().duration(this.options.animationDuration).attr(&quot;width&quot;,0).attr(&quot;height&quot;,0).remove().each(&quot;end&quot;,function(){&quot;function&quot;==typeof a?a():&quot;undefined&quot;!=typeof a&amp;&amp;console.log(&quot;Provided callback for destroy() is not a function.&quot;)}),null},getSVG:function(){&quot;use strict&quot;;for(var a={&quot;.cal-heatmap-container&quot;:{},&quot;.graph&quot;:{},&quot;.graph-rect&quot;:{},&quot;rect.highlight&quot;:{},&quot;rect.now&quot;:{},&quot;rect.highlight-now&quot;:{},&quot;text.highlight&quot;:{},&quot;text.now&quot;:{},&quot;text.highlight-now&quot;:{},&quot;.domain-background&quot;:{},&quot;.graph-label&quot;:{},&quot;.subdomain-text&quot;:{},&quot;.q0&quot;:{},&quot;.qi&quot;:{}},b=1,c=this.options.legend.length+1;b&lt;=c;b++)a[&quot;.q&quot;+b]={};var d=this.root,e=[&quot;stroke&quot;,&quot;stroke-width&quot;,&quot;stroke-opacity&quot;,&quot;stroke-dasharray&quot;,&quot;stroke-dashoffset&quot;,&quot;stroke-linecap&quot;,&quot;stroke-miterlimit&quot;,&quot;fill&quot;,&quot;fill-opacity&quot;,&quot;fill-rule&quot;,&quot;marker&quot;,&quot;marker-start&quot;,&quot;marker-mid&quot;,&quot;marker-end&quot;,&quot;alignement-baseline&quot;,&quot;baseline-shift&quot;,&quot;dominant-baseline&quot;,&quot;glyph-orientation-horizontal&quot;,&quot;glyph-orientation-vertical&quot;,&quot;kerning&quot;,&quot;text-anchor&quot;,&quot;shape-rendering&quot;,&quot;text-transform&quot;,&quot;font-family&quot;,&quot;font&quot;,&quot;font-size&quot;,&quot;font-weight&quot;],f=function(b,c,d){e.indexOf(c)!==-1&amp;&amp;(a[b][c]=d)},g=function(a){return d.select(a)[0][0]};for(var h in a)if(a.hasOwnProperty(h)){var i=g(h);if(null!==i)if(&quot;getComputedStyle&quot;in window){var j=getComputedStyle(i,null);if(0!==j.length)for(var k=0;k&lt;j.length;k++)f(h,j.item(k),j.getPropertyValue(j.item(k)));else for(var l in j)j.hasOwnProperty(l)&amp;&amp;f(h,l,j[l])}else if(&quot;currentStyle&quot;in i){var m=i.currentStyle;for(var n in m)f(h,n,m[n])}}var o='&lt;svg xmlns=&quot;<A rel="nofollow" class="external free" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</A>&quot; xmlns:xlink=&quot;<A rel="nofollow" class="external free" href="http://www.w3.org/1999/xlink">http://www.w3.org/1999/xlink</A>&quot;&gt;&lt;style type=&quot;text/css&quot;&gt;&lt;![CDATA[ ';for(var p in a){o+=p+&quot; {\n&quot;;for(var q in a[p])o+=&quot;\t&quot;+q+&quot;:&quot;+a[p][q]+&quot;;\n&quot;;o+=&quot;}\n&quot;}return o+=&quot;]]&gt;&lt;/style&gt;&quot;,o+=(new XMLSerializer).serializeToString(this.root[0][0]),o+=&quot;&lt;/svg&gt;&quot;}};var DomainPosition=function(){&quot;use strict&quot;;this.positions=d3.map()};DomainPosition.prototype.getPosition=function(a){&quot;use strict&quot;;return this.positions.get(a)},DomainPosition.prototype.getPositionFromIndex=function(a){&quot;use strict&quot;;var b=this.getKeys();return this.positions.get(b[a])},DomainPosition.prototype.getLast=function(){&quot;use strict&quot;;var a=this.getKeys();return this.positions.get(a[a.length-1])},DomainPosition.prototype.setPosition=function(a,b){&quot;use strict&quot;;this.positions.set(a,b)},DomainPosition.prototype.shiftRightBy=function(a){&quot;use strict&quot;;this.positions.forEach(function(b,c){this.set(b,c-a)});var b=this.getKeys();this.positions.remove(b[0])},DomainPosition.prototype.shiftLeftBy=function(a){&quot;use strict&quot;;this.positions.forEach(function(b,c){this.set(b,c+a)});var b=this.getKeys();this.positions.remove(b[b.length-1])},DomainPosition.prototype.getKeys=function(){&quot;use strict&quot;;return this.positions.keys().sort(function(a,b){return parseInt(a,10)-parseInt(b,10)})};var Legend=function(a){&quot;use strict&quot;;this.calendar=a,this.computeDim(),null!==a.options.legendColors&amp;&amp;this.buildColors()};Legend.prototype.computeDim=function(){&quot;use strict&quot;;var a=this.calendar.options;this.dim={width:a.legendCellSize*(a.legend.length+1)+a.legendCellPadding*a.legend.length,height:a.legendCellSize}},Legend.prototype.remove=function(){&quot;use strict&quot;;this.calendar.root.select(&quot;.graph-legend&quot;).remove(),this.calendar.resize()},Legend.prototype.redraw=function(a){&quot;use strict&quot;;function b(a){a.attr(&quot;width&quot;,i.legendCellSize).attr(&quot;height&quot;,i.legendCellSize).attr(&quot;x&quot;,function(a,b){return b*(i.legendCellSize+i.legendCellPadding)})}function c(){switch(i.legendHorizontalPosition){case&quot;right&quot;:return&quot;center&quot;===i.legendVerticalPosition||&quot;middle&quot;===i.legendVerticalPosition?a+i.legendMargin[3]:a-f.getDim(&quot;width&quot;)-i.legendMargin[1];case&quot;middle&quot;:case&quot;center&quot;:return Math.round(a/2-f.getDim(&quot;width&quot;)/2);default:return i.legendMargin[3]}}function d(){return&quot;bottom&quot;===i.legendVerticalPosition?g.graphDim.height+i.legendMargin[0]-i.domainGutter-i.cellPadding:i.legendMargin[0]}if(!this.calendar.options.displayLegend)return!1;var e,f=this,g=this.calendar,h=g.root,i=g.options;this.computeDim();var j=i.legend.slice(0);j.push(j[j.length-1]+1);var k=g.root.select(&quot;.graph-legend&quot;);null!==k[0][0]?(h=k,e=h.select(&quot;g&quot;).selectAll(&quot;rect&quot;).data(j)):(h=&quot;top&quot;===i.legendVerticalPosition?h.insert(&quot;svg&quot;,&quot;.graph&quot;):h.append(&quot;svg&quot;),h.attr(&quot;x&quot;,c()).attr(&quot;y&quot;,d()),e=h.attr(&quot;class&quot;,&quot;graph-legend&quot;).attr(&quot;height&quot;,f.getDim(&quot;height&quot;)).attr(&quot;width&quot;,f.getDim(&quot;width&quot;)).append(&quot;g&quot;).selectAll().data(j)),e.enter().append(&quot;rect&quot;).call(b).attr(&quot;class&quot;,function(a){return g.Legend.getClass(a,null===g.legendScale)}).attr(&quot;fill-opacity&quot;,0).call(function(a){null!==g.legendScale&amp;&amp;null!==i.legendColors&amp;&amp;i.legendColors.hasOwnProperty(&quot;base&quot;)&amp;&amp;a.attr(&quot;fill&quot;,i.legendColors.base)}).append(&quot;title&quot;),e.exit().transition().duration(i.animationDuration).attr(&quot;fill-opacity&quot;,0).remove(),e.transition().delay(function(a,b){return i.animationDuration*b/10}).call(b).attr(&quot;fill-opacity&quot;,1).call(function(a){a.attr(&quot;fill&quot;,function(a,b){return null===g.legendScale?&quot;&quot;:0===b?g.legendScale(a-1):g.legendScale(i.legend[b-1])}),a.attr(&quot;class&quot;,function(a){return g.Legend.getClass(a,null===g.legendScale)})}),e.select(&quot;title&quot;).text(function(a,b){return 0===b?i.legendTitleFormat.lower.format({min:i.legend[b],name:i.itemName[1]}):b===j.length-1?i.legendTitleFormat.upper.format({max:i.legend[b-1],name:i.itemName[1]}):i.legendTitleFormat.inner.format({down:i.legend[b-1],up:i.legend[b],name:i.itemName[1]})}),h.transition().duration(i.animationDuration).attr(&quot;x&quot;,c()).attr(&quot;y&quot;,d()).attr(&quot;width&quot;,f.getDim(&quot;width&quot;)).attr(&quot;height&quot;,f.getDim(&quot;height&quot;)),h.select(&quot;g&quot;).transition().duration(i.animationDuration).attr(&quot;transform&quot;,function(){return&quot;vertical&quot;===i.legendOrientation?&quot;rotate(90 &quot;+i.legendCellSize/2+&quot; &quot;+i.legendCellSize/2+&quot;)&quot;:&quot;&quot;}),g.resize()},Legend.prototype.getDim=function(a){&quot;use strict&quot;;var b=&quot;horizontal&quot;===this.calendar.options.legendOrientation;switch(a){case&quot;width&quot;:return this.dim[b?&quot;width&quot;:&quot;height&quot;];case&quot;height&quot;:return this.dim[b?&quot;height&quot;:&quot;width&quot;]}},Legend.prototype.buildColors=function(){&quot;use strict&quot;;var a=this.calendar.options;if(null===a.legendColors)return this.calendar.legendScale=null,!1;var b=[];if(Array.isArray(a.legendColors))b=a.legendColors;else{if(!a.legendColors.hasOwnProperty(&quot;min&quot;)||!a.legendColors.hasOwnProperty(&quot;max&quot;))return a.legendColors=null,!1;b=[a.legendColors.min,a.legendColors.max]}var c=a.legend.slice(0);c[0]&gt;0?c.unshift(0):c[0]&lt;0&amp;&amp;c.unshift(c[0]-(c[c.length-1]-c[0])/c.length);var d=d3.scale.linear().range(b).interpolate(d3.interpolateHcl).domain([d3.min(c),d3.max(c)]),e=c.map(function(a){return d(a)});return this.calendar.legendScale=d3.scale.threshold().domain(a.legend).range(e),!0},Legend.prototype.getClass=function(a,b){&quot;use strict&quot;;if(null===a||isNaN(a))return&quot;&quot;;for(var c=[this.calendar.options.legend.length+1],d=0,e=this.calendar.options.legend.length-1;d&lt;=e;d++){if(this.calendar.options.legend[0]&gt;0&amp;&amp;a&lt;0){c=[&quot;1&quot;,&quot;i&quot;];break}if(a&lt;=this.calendar.options.legend[d]){c=[d+1];break}}return 0===a&amp;&amp;c.push(0),c.unshift(&quot;&quot;),(c.join(&quot; r&quot;)+(b?c.join(&quot; q&quot;):&quot;&quot;)).trim()},String.prototype.format=function(){&quot;use strict&quot;;var a=this;for(var b in arguments[0])if(arguments[0].hasOwnProperty(b)){var c=new RegExp(&quot;\\{&quot;+b+&quot;\\}&quot;,&quot;gi&quot;);a=a.replace(c,arguments[0][b])}return a},&quot;function&quot;==typeof define&amp;&amp;define.amd?define([&quot;d3&quot;],function(){&quot;use strict&quot;;return CalHeatMap}):&quot;object&quot;==typeof module&amp;&amp;module.exports?module.exports=CalHeatMap:window.CalHeatMap=CalHeatMap;
</P></DIV></DIV></DIV></DIV></DIV></BODY></HTML>