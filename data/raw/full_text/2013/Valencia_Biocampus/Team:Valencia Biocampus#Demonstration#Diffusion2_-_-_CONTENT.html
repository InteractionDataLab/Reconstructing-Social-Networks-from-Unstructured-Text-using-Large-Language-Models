<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Valencia_Biocampus_Demonstration_Diffusion2"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Valencia_Biocampus/Demonstration/Diffusion2">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Valencia_Biocampus/Demonstration/Diffusion2&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Valencia_Biocampus/Demonstration/Diffusion2&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Valencia_Biocampus/Demonstration/Diffusion2&amp;action=history">History               </A></LI><LI style="color:white;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Valencia_Biocampus/Demonstration/Diffusion2" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Valencia Biocampus/Demonstration/Diffusion2</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2013.igem.org</H3><DIV id="header_wrapper"><DIV id="top_menu_wrapper"><UL id="top_menu" class="container"><LI><A href="https://2013.igem.org/Team:Valencia_Biocampus" id="menu_a_home" class="active">Home</A></LI><LI><A href="https://2013.igem.org/Team:Valencia_Biocampus/Team" id="menu_a_team">Team</A></LI><LI><A href="https://2013.igem.org/Team:Valencia_Biocampus/Project" id="menu_a_project">Project</A></LI><LI><A href="https://2013.igem.org/Team:Valencia_Biocampus/Results" id="menu_a_results">Results</A></LI><LI><A href="https://2013.igem.org/Team:Valencia_Biocampus/Modeling" id="menu_a_modeling">Modeling</A></LI><LI><A href="https://2013.igem.org/Team:Valencia_Biocampus/Devices" id="menu_a_devices">Devices</A></LI><LI><A href="https://2013.igem.org/Team:Valencia_Biocampus/HP" id="menu_a_HP">Human Practices</A></LI><LI><A href="https://2013.igem.org/Team:Valencia_Biocampus/Achievements" id="menu_a_achievements">Achievements</A></LI><LI><A href="https://2013.igem.org/Team:Valencia_Biocampus/Attributions" id="menu_a_attributions">Attributions</A></LI></UL></DIV></DIV><DIV class="container"><H2><SPAN class="mw-headline" id="Description_of_the_numerical_method"> Description of the numerical method </SPAN></H2><P>The Crank-Nicolson method is obtained by using a <I>forward difference</I> in time ($t_k$) and <I>central differences</I> in space $(x_i, y_j)$.
However, by giving discrete values for time and space $(t_k, x_i, y_j)$ to our <I>Crank-Nicolson</I> method and zeroing <I>boundary conditions</I> (since we have to define some limit for the plate) and also setting <I>initial conditions</I> to a specific initial distribution, we achieved the <I>matrix recursive formula</I>: 
<SPAN style="font-size: 120%;">$$[\mathcal{C}^{k+1}] = \mathcal{M}\;[\mathcal{C}^k]$$</SPAN>
Where $\mathcal{M}$ is a <I>block tridiagonal</I> matrix depending on the parameters and the velocities in $x$ and $y$ directions at some points in space.

However, this matrix recursive formula wasn't so obvious, so we tried to obtain it following carefully these steps:
  1.- Crank-Nicolson method says:

$$\; \frac{u^{k+1}_{i,j} - u^{k}_{i,j}}{q}\;= \frac{1}{2} \; \left(F^{k+1}_{i,j} \; \left( u, \;x, \;y, \;t, \;\frac{\partial u}{\partial x}, \;\frac{\partial u}{\partial y}, \;\frac{\partial^2 u}{\partial x^2}, \;\frac{\partial u^2}{\partial y^2}\right) + F^{k}_{i,j} \; \left( u, \;x, \;y, \;t, \;\frac{\partial u}{\partial x}, \;\frac{\partial u}{\partial y}, \;\frac{\partial^2 u}{\partial x^2}, \;\frac{\partial u^2}{\partial y^2}\right)\right)$$

So, fitting our differential equation into the definition of the method, we got the discretized one, that will lead the final numerical solution. Note that we replaced the time derivatives by the approximate <I>forward differences</I> and the space derivatives by <I>central differences</I>, being $\;q\;$ and $\;h\;$ the time and space step, respectively:
<SPAN style="font-size: 100%;">$$\; 2 \; \frac{C^{k+1}_{i,j} - C^{k}_{i,j}}{q}\;= \\ \;D \; \left(\frac{C^{k+1}_{i+1,j} - 2C^{k+1}_{i,j}+C^{k+1}_{i-1,j}}{h^2} + \frac{C^{k+1}_{i,j+1} - 2C^{k+1}_{i,j}+C^{k+1}_{i,j-1}}{h^2}\right) - \left(\frac{\nu_{x_{i+1,j}} - \nu_{x_{i-1,j}}}{2h} \; C^{k+1}_{i,j} + \nu_{x_{i,j}} \; \frac{C^{k+1}_{i+1,j} - C^{k+1}_{i-1,j}}{2h} + \frac{\nu_{y_{i,j+1}} - \nu_{y_{i,j-1}}}{2h} \; C^{k+1}_{i,j} + \nu_{y_{i,j}} \; \frac{C^{k+1}_{i,j+1} - C^{k+1}_{i,j-1}}{2h}\right) \\ + D \; \left(\frac{C^{k}_{i+1,j} - 2C^{k}_{i,j}+C^{k}_{i-1,j}}{h^2} + \frac{C^{k}_{i,j+1} - 2C^{k}_{i,j}+C^{k}_{i,j-1}}{h^2}\right) - \left(\frac{\nu_{x_{i+1,j}} - \nu_{x_{i-1,j}}}{2h} \; C^{k}_{i,j} + \nu_{x_{i,j}} \; \frac{C^{k}_{i+1,j} - C^{k}_{i-1,j}}{2h} + \frac{\nu_{y_{i,j+1}} - \nu_{y_{i,j-1}}}{2h} \; C^{k}_{i,j} + \nu_{y_{i,j}} \; \frac{C^{k}_{i,j+1} - C^{k}_{i,j-1}}{2h}\right)$$</SPAN>
As there were so many terms, we reorganised the equation, by placing all the unknowns ($C^{k+1}$) at the left side, and the knowns ($C^{k}$) at right side of equality. Also, some constants were defined: $\;\lambda \; = \; \frac{q \; D}{2 \; h^2}\;$ and $\;\mu \; = \; \frac{q}{4 \; h}\;$. As result, a more handy equation was obtained:
<SPAN style="font-size: 100%;">$$ C^{k+1}_{i+1,j} \; \left(- \lambda + \nu_{x_{i,j}} \; \mu \right) +  C^{k+1}_{i,j+1} \; \left(- \lambda + \nu_{y_{i,j}} \; \mu \right) +  C^{k+1}_{i,j} \; \left(1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{i,j}} + \nu^{(0,1)}_{{y}_{i,j}}\right) + C^{k+1}_{i-1,j} \; \left(- \lambda - \nu_{x_{i,j}} \; \mu \right) + C^{k+1}_{i,j-1} \; \left(- \lambda - \nu_{y_{i,j}} \; \mu \right) \; = \\ \; C^{k}_{i+1,j} \; \left(\lambda - \nu_{x_{i,j}} \; \mu \right) +  C^{k}_{i,j+1} \; \left(\lambda - \nu_{y_{i,j}} \; \mu \right) +  C^{k}_{i,j} \; \left(1 - 4 \; \lambda - \nu^{(1,0)}_{{x}_{i,j}} - \nu^{(0,1)}_{{y}_{i,j}}\right) + C^{k}_{i-1,j} \; \left(\lambda + \nu_{x_{i,j}} \; \mu \right) + C^{k}_{i,j-1} \; \left(\lambda + \nu_{y_{i,j}} \; \mu \right) $$</SPAN>  2.- As it was still too cumbersome, was still not so easy to compute it in matrix way. For that, we were forced to particularize it in a reduced example, with the aim of extrapolate, from then, the general method. The particular case was based on the space meshing in three steps each coordinate, so that, $i=1,2,3$ and $j=1,2,3$:
<SPAN style="font-size: 100%;">$ i=1,\;j=1 $
$$ C^{k+1}_{2,1} \; \left(- \lambda + \nu_{x_{1,1}} \; \mu \right) +  C^{k+1}_{1,2} \; \left(- \lambda + \nu_{y_{1,1}} \; \mu \right) +  C^{k+1}_{1,1} \; \left(1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{1,1}} + \nu^{(0,1)}_{{y}_{1,1}}\right) + C^{k+1}_{0,1} \; \left(- \lambda - \nu_{x_{1,1}} \; \mu \right) + C^{k+1}_{1,0} \; \left(- \lambda - \nu_{y_{1,1}} \; \mu \right) \; = \\ \; C^{k}_{2,1} \; \left(\lambda - \nu_{x_{1,1}} \; \mu \right) +  C^{k}_{1,2} \; \left(\lambda - \nu_{y_{1,1}} \; \mu \right) +  C^{k}_{1,1} \; \left(1 - 4 \; \lambda - \nu^{(1,0)}_{{x}_{1,1}} - \nu^{(0,1)}_{{y}_{1,1}}\right) + C^{k}_{0,1} \; \left(\lambda + \nu_{x_{1,1}} \; \mu \right) + C^{k}_{1,0} \; \left(\lambda + \nu_{y_{1,1}} \; \mu \right) $$
$ i=1,\;j=2 $
$$ C^{k+1}_{2,2} \; \left(- \lambda + \nu_{x_{1,2}} \; \mu \right) +  C^{k+1}_{1,3} \; \left(- \lambda + \nu_{y_{1,2}} \; \mu \right) +  C^{k+1}_{1,2} \; \left(1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{1,2}} + \nu^{(0,1)}_{{y}_{1,2}}\right) + C^{k+1}_{0,2} \; \left(- \lambda - \nu_{x_{1,2}} \; \mu \right) + C^{k+1}_{1,1} \; \left(- \lambda - \nu_{y_{1,2}} \; \mu \right) \; = \\ \; C^{k}_{2,2} \; \left(\lambda - \nu_{x_{1,2}} \; \mu \right) +  C^{k}_{1,3} \; \left(\lambda - \nu_{y_{1,2}} \; \mu \right) +  C^{k}_{1,2} \; \left(1 - 4 \; \lambda - \nu^{(1,0)}_{{x}_{1,2}} - \nu^{(0,1)}_{{y}_{1,2}}\right) + C^{k}_{0,2} \; \left(\lambda + \nu_{x_{1,2}} \; \mu \right) + C^{k}_{1,1} \; \left(\lambda + \nu_{y_{1,2}} \; \mu \right) $$
$ i=1,\;j=3 $
$$ C^{k+1}_{2,3} \; \left(- \lambda + \nu_{x_{1,3}} \; \mu \right) +  C^{k+1}_{1,4} \; \left(- \lambda + \nu_{y_{1,3}} \; \mu \right) +  C^{k+1}_{1,3} \; \left(1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{1,3}} + \nu^{(0,1)}_{{y}_{1,3}}\right) + C^{k+1}_{0,3} \; \left(- \lambda - \nu_{x_{1,3}} \; \mu \right) + C^{k+1}_{1,2} \; \left(- \lambda - \nu_{y_{1,3}} \; \mu \right) \; = \\ \; C^{k}_{2,3} \; \left(\lambda - \nu_{x_{1,3}} \; \mu \right) +  C^{k}_{1,4} \; \left(\lambda - \nu_{y_{1,3}} \; \mu \right) +  C^{k}_{1,3} \; \left(1 - 4 \; \lambda - \nu^{(1,0)}_{{x}_{1,3}} - \nu^{(0,1)}_{{y}_{1,3}}\right) + C^{k}_{0,3} \; \left(\lambda + \nu_{x_{1,3}} \; \mu \right) + C^{k}_{1,2} \; \left(\lambda + \nu_{y_{1,3}} \; \mu \right) $$
$ i=2,\;j=1 $
$$ C^{k+1}_{3,1} \; \left(- \lambda + \nu_{x_{2,1}} \; \mu \right) +  C^{k+1}_{2,2} \; \left(- \lambda + \nu_{y_{2,1}} \; \mu \right) +  C^{k+1}_{2,1} \; \left(1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{2,1}} + \nu^{(0,1)}_{{y}_{2,1}}\right) + C^{k+1}_{1,1} \; \left(- \lambda - \nu_{x_{2,1}} \; \mu \right) + C^{k+1}_{2,0} \; \left(- \lambda - \nu_{y_{2,1}} \; \mu \right) \; = \\ \; C^{k}_{3,1} \; \left(\lambda - \nu_{x_{2,1}} \; \mu \right) +  C^{k}_{2,2} \; \left(\lambda - \nu_{y_{2,1}} \; \mu \right) +  C^{k}_{2,1} \; \left(1 - 4 \; \lambda - \nu^{(1,0)}_{{x}_{2,1}} - \nu^{(0,1)}_{{y}_{2,1}}\right) + C^{k}_{1,1} \; \left(\lambda + \nu_{x_{2,1}} \; \mu \right) + C^{k}_{2,0} \; \left(\lambda + \nu_{y_{2,1}} \; \mu \right) $$
$ i=2,\;j=2 $
$$ C^{k+1}_{3,2} \; \left(- \lambda + \nu_{x_{2,2}} \; \mu \right) +  C^{k+1}_{2,3} \; \left(- \lambda + \nu_{y_{2,2}} \; \mu \right) +  C^{k+1}_{2,2} \; \left(1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{2,2}} + \nu^{(0,1)}_{{y}_{2,2}}\right) + C^{k+1}_{1,2} \; \left(- \lambda - \nu_{x_{2,2}} \; \mu \right) + C^{k+1}_{2,1} \; \left(- \lambda - \nu_{y_{2,2}} \; \mu \right) \; = \\ \; C^{k}_{3,2} \; \left(\lambda - \nu_{x_{2,2}} \; \mu \right) +  C^{k}_{2,3} \; \left(\lambda - \nu_{y_{2,2}} \; \mu \right) +  C^{k}_{2,2} \; \left(1 - 4 \; \lambda - \nu^{(1,0)}_{{x}_{2,2}} - \nu^{(0,1)}_{{y}_{2,2}}\right) + C^{k}_{1,2} \; \left(\lambda + \nu_{x_{2,2}} \; \mu \right) + C^{k}_{2,1} \; \left(\lambda + \nu_{y_{2,2}} \; \mu \right) $$
$ i=2,\;j=3 $
$$ C^{k+1}_{3,3} \; \left(- \lambda + \nu_{x_{2,3}} \; \mu \right) +  C^{k+1}_{2,4} \; \left(- \lambda + \nu_{y_{2,3}} \; \mu \right) +  C^{k+1}_{2,3} \; \left(1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{2,3}} + \nu^{(0,1)}_{{y}_{2,3}}\right) + C^{k+1}_{1,3} \; \left(- \lambda - \nu_{x_{2,3}} \; \mu \right) + C^{k+1}_{2,2} \; \left(- \lambda - \nu_{y_{2,3}} \; \mu \right) \; = \\ \; C^{k}_{3,3} \; \left(\lambda - \nu_{x_{2,3}} \; \mu \right) +  C^{k}_{2,4} \; \left(\lambda - \nu_{y_{2,3}} \; \mu \right) +  C^{k}_{2,3} \; \left(1 - 4 \; \lambda - \nu^{(1,0)}_{{x}_{2,3}} - \nu^{(0,1)}_{{y}_{2,3}}\right) + C^{k}_{1,3} \; \left(\lambda + \nu_{x_{2,3}} \; \mu \right) + C^{k}_{2,2} \; \left(\lambda + \nu_{y_{2,3}} \; \mu \right) $$
$ i=3,\;j=1 $
$$ C^{k+1}_{4,1} \; \left(- \lambda + \nu_{x_{3,1}} \; \mu \right) +  C^{k+1}_{3,2} \; \left(- \lambda + \nu_{y_{3,1}} \; \mu \right) +  C^{k+1}_{3,1} \; \left(1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{3,1}} + \nu^{(0,1)}_{{y}_{3,1}}\right) + C^{k+1}_{2,1} \; \left(- \lambda - \nu_{x_{3,1}} \; \mu \right) + C^{k+1}_{3,0} \; \left(- \lambda - \nu_{y_{3,1}} \; \mu \right) \; = \\ \; C^{k}_{4,1} \; \left(\lambda - \nu_{x_{3,1}} \; \mu \right) +  C^{k}_{3,2} \; \left(\lambda - \nu_{y_{3,1}} \; \mu \right) +  C^{k}_{3,1} \; \left(1 - 4 \; \lambda - \nu^{(1,0)}_{{x}_{3,1}} - \nu^{(0,1)}_{{y}_{3,1}}\right) + C^{k}_{2,1} \; \left(\lambda + \nu_{x_{3,1}} \; \mu \right) + C^{k}_{3,0} \; \left(\lambda + \nu_{y_{3,1}} \; \mu \right) $$
$ i=3,\;j=2 $
$$ C^{k+1}_{4,2} \; \left(- \lambda + \nu_{x_{3,2}} \; \mu \right) +  C^{k+1}_{3,3} \; \left(- \lambda + \nu_{y_{3,2}} \; \mu \right) +  C^{k+1}_{3,2} \; \left(1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{3,2}} + \nu^{(0,1)}_{{y}_{3,2}}\right) + C^{k+1}_{2,2} \; \left(- \lambda - \nu_{x_{3,2}} \; \mu \right) + C^{k+1}_{3,1} \; \left(- \lambda - \nu_{y_{3,2}} \; \mu \right) \; = \\ \; C^{k}_{4,2} \; \left(\lambda - \nu_{x_{3,2}} \; \mu \right) +  C^{k}_{3,3} \; \left(\lambda - \nu_{y_{3,2}} \; \mu \right) +  C^{k}_{3,2} \; \left(1 - 4 \; \lambda - \nu^{(1,0)}_{{x}_{3,2}} - \nu^{(0,1)}_{{y}_{3,2}}\right) + C^{k}_{2,2} \; \left(\lambda + \nu_{x_{3,2}} \; \mu \right) + C^{k}_{3,1} \; \left(\lambda + \nu_{y_{3,2}} \; \mu \right) $$
$ i=3,\;j=3 $
$$ C^{k+1}_{4,3} \; \left(- \lambda + \nu_{x_{3,3}} \; \mu \right) +  C^{k+1}_{3,4} \; \left(- \lambda + \nu_{y_{3,3}} \; \mu \right) +  C^{k+1}_{3,3} \; \left(1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{3,3}} + \nu^{(0,1)}_{{y}_{3,3}}\right) + C^{k+1}_{2,3} \; \left(- \lambda - \nu_{x_{3,3}} \; \mu \right) + C^{k+1}_{3,2} \; \left(- \lambda - \nu_{y_{3,3}} \; \mu \right) \; = \\ \; C^{k}_{4,3} \; \left(\lambda - \nu_{x_{3,3}} \; \mu \right) +  C^{k}_{3,4} \; \left(\lambda - \nu_{y_{3,3}} \; \mu \right) +  C^{k}_{3,3} \; \left(1 - 4 \; \lambda - \nu^{(1,0)}_{{x}_{3,3}} - \nu^{(0,1)}_{{y}_{3,3}}\right) + C^{k}_{2,3} \; \left(\lambda + \nu_{x_{3,3}} \; \mu \right) + C^{k}_{3,2} \; \left(\lambda + \nu_{y_{3,3}} \; \mu \right) $$</SPAN>  3.- Our goal was to rewrite the equations system, in the form:

$$ \underline{\underline{A}} \; \underline{C^{k+1}} \; = \; \underline{\underline{B}} \; \underline{C^{k}} $$

So, in that moment, we could finally put all that in a matrix form, being all $\;C^{k+1}_{i,j}\;$ the unknowns, and $\;C^{k}_{i,j}\;$ the knowns (and of course, all the constant parameters). 

That was also the moment to impose the <I> boundary conditions </I>. We consider that the most fit are <I> Neumann </I> ones, that are to make zero all the border concentration; so we removed all terms containing i=0 or i=4 or j=0 or j=4. Note that, in order to facilitate the reading of the matrix, have been renamed some parameters, such as $\;\alpha \; = \; 1 + 4 \; \lambda\;$ and $\;\beta \; = \; 1 - 4 \; \lambda\;$:
<SPAN style="font-size: 92.5%;">$$ \begin{bmatrix}
\begin{array}{ccc|ccc|ccc}
\alpha + \nu^{(1,0)}_{{x}_{1,1}} + \nu^{(0,1)}_{{y}_{1,1}} &amp; - \lambda + \nu_{y_{1,1}} \; \mu &amp; 0 &amp; - \lambda + \nu_{x_{1,1}} \; \mu &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
- \lambda - \nu_{y_{1,2}} \; \mu &amp; \alpha + \nu^{(1,0)}_{{x}_{1,2}} + \nu^{(0,1)}_{{y}_{1,2}} &amp; - \lambda + \nu_{y_{1,2}} \; \mu &amp; 0 &amp; - \lambda + \nu_{x_{1,2}} \; \mu &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; - \lambda - \nu_{y_{1,3}} \; \mu &amp; \alpha + \nu^{(1,0)}_{{x}_{1,3}} + \nu^{(0,1)}_{{y}_{1,3}} &amp; 0 &amp; 0 &amp; - \lambda + \nu_{x_{1,3}} \; \mu &amp; 0 &amp; 0 &amp; 0\\
\hline\\
- \lambda - \nu_{x_{2,1}} \; \mu &amp; 0 &amp; 0 &amp; \alpha + \nu^{(1,0)}_{{x}_{2,1}} + \nu^{(0,1)}_{{y}_{2,1}} &amp; - \lambda + \nu_{y_{2,1}} \; \mu &amp; 0 &amp; - \lambda + \nu_{x_{2,1}} \; \mu &amp; 0 &amp; 0\\
0 &amp; - \lambda - \nu_{x_{2,2}} \; \mu &amp; 0 &amp; - \lambda - \nu_{y_{2,2}} \; \mu &amp; \alpha + \nu^{(1,0)}_{{x}_{2,2}} + \nu^{(0,1)}_{{y}_{2,2}} &amp; - \lambda + \nu_{y_{2,2}} \; \mu &amp; 0 &amp; - \lambda + \nu_{x_{2,2}} \; \mu &amp; 0\\
0 &amp; 0 &amp; - \lambda - \nu_{x_{2,3}} \; \mu &amp; 0 &amp; - \lambda - \nu_{y_{2,3}} \; \mu &amp; \alpha + \nu^{(1,0)}_{{x}_{2,3}} + \nu^{(0,1)}_{{y}_{2,3}} &amp; 0 &amp; 0 &amp; - \lambda + \nu_{x_{2,3}} \; \mu\\
\hline\\
0 &amp; 0 &amp; 0 &amp; - \lambda - \nu_{x_{3,1}} \; \mu &amp; 0 &amp; 0 &amp; \alpha + \nu^{(1,0)}_{{x}_{3,1}} + \nu^{(0,1)}_{{y}_{3,1}} &amp; - \lambda + \nu_{y_{3,1}} \; \mu &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; - \lambda - \nu_{x_{3,2}} \; \mu &amp; 0 &amp; - \lambda - \nu_{y_{3,2}} \; \mu &amp; \alpha + \nu^{(1,0)}_{{x}_{3,2}} + \nu^{(0,1)}_{{y}_{3,2}} &amp; - \lambda + \nu_{y_{3,2}} \; \mu\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; - \lambda - \nu_{x_{3,3}} \; \mu &amp; 0 &amp; - \lambda - \nu_{y_{3,3}} \; \mu &amp; \alpha + \nu^{(1,0)}_{{x}_{3,3}} + \nu^{(0,1)}_{{y}_{3,3}}
\end{array}
\end{bmatrix}\begin{bmatrix}
C^{k+1}_{1,1}\\C^{k+1}_{1,2}\\C^{k+1}_{1,3}\\\hline\\C^{k+1}_{2,1}\\C^{k+1}_{2,2}\\C^{k+1}_{2,3}\\\hline\\C^{k+1}_{3,1}\\C^{k+1}_{3,2}\\C^{k+1}_{3,3}\end{bmatrix}=$$

$$\begin{bmatrix}
\begin{array}{ccc|ccc|ccc}
\beta - \nu^{(1,0)}_{{x}_{1,1}} - \nu^{(0,1)}_{{y}_{1,1}} &amp; \lambda - \nu_{y_{1,1}} \; \mu &amp; 0 &amp; \lambda - \nu_{x_{1,1}} \; \mu &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
\lambda + \nu_{y_{1,2}} \; \mu &amp; \beta - \nu^{(1,0)}_{{x}_{1,2}} - \nu^{(0,1)}_{{y}_{1,2}} &amp; \lambda - \nu_{y_{1,2}} \; \mu &amp; 0 &amp; \lambda - \nu_{x_{1,2}} \; \mu &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; \lambda + \nu_{y_{1,3}} \; \mu &amp; \beta - \nu^{(1,0)}_{{x}_{1,3}} - \nu^{(0,1)}_{{y}_{1,3}} &amp; 0 &amp; 0 &amp; \lambda - \nu_{x_{1,3}} \; \mu &amp; 0 &amp; 0 &amp; 0\\
\hline\\
\lambda + \nu_{x_{2,1}} \; \mu &amp; 0 &amp; 0 &amp; \beta - \nu^{(1,0)}_{{x}_{2,1}} - \nu^{(0,1)}_{{y}_{2,1}} &amp; \lambda - \nu_{y_{2,1}} \; \mu &amp; 0 &amp; \lambda - \nu_{x_{2,1}} \; \mu &amp; 0 &amp; 0\\
0 &amp; \lambda + \nu_{x_{2,2}} \; \mu &amp; 0 &amp; \lambda + \nu_{y_{2,2}} \; \mu &amp; \beta - \nu^{(1,0)}_{{x}_{2,2}} - \nu^{(0,1)}_{{y}_{2,2}} &amp; \lambda - \nu_{y_{2,2}} \; \mu &amp; 0 &amp; \lambda - \nu_{x_{2,2}} \; \mu &amp; 0\\
0 &amp; 0 &amp; \lambda + \nu_{x_{2,3}} \; \mu &amp; 0 &amp; \lambda + \nu_{y_{2,3}} \; \mu &amp; \beta - \nu^{(1,0)}_{{x}_{2,3}} - \nu^{(0,1)}_{{y}_{2,3}} &amp; 0 &amp; 0 &amp; \lambda - \nu_{x_{2,3}} \; \mu\\
\hline\\
0 &amp; 0 &amp; 0 &amp; \lambda + \nu_{x_{3,1}} \; \mu &amp; 0 &amp; 0 &amp; \beta - \nu^{(1,0)}_{{x}_{3,1}} - \nu^{(0,1)}_{{y}_{3,1}} &amp; \lambda - \nu_{y_{3,1}} \; \mu &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \lambda + \nu_{x_{3,2}} \; \mu &amp; 0 &amp; \lambda + \nu_{y_{3,2}} \; \mu &amp; \beta - \nu^{(1,0)}_{{x}_{3,2}} - \nu^{(0,1)}_{{y}_{3,2}} &amp; \lambda - \nu_{y_{3,2}} \; \mu\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \lambda + \nu_{x_{3,3}} \; \mu &amp; 0 &amp; \lambda + \nu_{y_{3,3}} \; \mu &amp; \beta -\nu^{(1,0)}_{{x}_{3,3}} - \nu^{(0,1)}_{{y}_{3,3}}
\end{array}
\end{bmatrix}\begin{bmatrix}
C^{k}_{1,1}\\C^{k}_{1,2}\\C^{k}_{1,3}\\\hline\\C^{k}_{2,1}\\C^{k}_{2,2}\\C^{k}_{2,3}\\\hline\\C^{k}_{3,1}\\C^{k}_{3,2}\\C^{k}_{3,3}\end{bmatrix}$$</SPAN>  3.- Now was time to generalize last matrix equation. To provide a better global vision, we divided the matrixes into $\;n^2\;$ matrix blocks of $\;n\;$ x $\;n\;$ size, and the vectors in $\;n\;$ vector blocks of $\;n\;$ size:

$$ \underline{\underline{A}} \; = \begin{bmatrix}
\underline{\underline{A_{1,1}}} &amp; \underline{\underline{A_{1,2}}} &amp; \cdots &amp; \underline{\underline{A_{1,n}}}\\
\underline{\underline{A_{2,1}}} &amp; \underline{\underline{A_{2,2}}} &amp; \cdots &amp; \underline{\underline{A_{2,n}}}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\underline{\underline{A_{n,1}}} &amp; \underline{\underline{A_{n,2}}} &amp; \cdots &amp; \underline{\underline{A_{n,n}}}\\
\end{bmatrix} \;\;\;\; 
\underline{C^{k+1}} \; = \begin{bmatrix}
\underline{C^{k+1}_{1}} \\
\underline{C^{k+1}_{2}} \\
\vdots \\
\underline{C^{k+1}_{n}} \\
\end{bmatrix} \;\;\;\; 
\underline{\underline{B}} \; = \begin{bmatrix}
\underline{\underline{B_{1,1}}} &amp; \underline{\underline{B_{1,2}}} &amp; \cdots &amp; \underline{\underline{B_{1,n}}}\\
\underline{\underline{B_{2,1}}} &amp; \underline{\underline{B_{2,2}}} &amp; \cdots &amp; \underline{\underline{B_{2,n}}}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\underline{\underline{B_{n,1}}} &amp; \underline{\underline{B_{n,2}}} &amp; \cdots &amp; \underline{\underline{B_{n,n}}}\\
\end{bmatrix} \;\;\;\; 
\underline{C^{k}} \; = \begin{bmatrix}
\underline{C^{k}_{1}} \\
\underline{C^{k}_{2}} \\
\vdots \\
\underline{C^{k}_{n}} \\
\end{bmatrix} $$

Each one of these submatrixes was easier to study than the global one, so it wasn't complex to, finally, realise which pattern they followed, and could generalized for a $\;n\;$ x $\;n\;$ space steps (so $\;i=1,2,...,n\;$ and $\;j=1,2,...,n$):
<SPAN style="font-size: 110%;">$$ \underline{\underline{A_{i,i}}} \; = \begin{bmatrix}
1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{i,1}} + \nu^{(0,1)}_{{y}_{i,1}} &amp; - \lambda + \nu_{y_{i,1}} \; \mu &amp; 0 &amp; \cdots &amp; 0\\
- \lambda - \nu_{y_{i,2}} \; \mu &amp; 1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{i,2}} + \nu^{(0,1)}_{{y}_{i,2}} &amp; - \lambda + \nu_{y_{i,2}} \; \mu &amp; \cdots &amp; 0\\
0 &amp; - \lambda - \nu_{y_{i,3}} \; \mu &amp; 1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{i,3}} + \nu^{(0,1)}_{{y}_{i,3}} &amp; \cdots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 + 4 \; \lambda + \nu^{(1,0)}_{{x}_{i,n}} + \nu^{(0,1)}_{{y}_{i,n}}\\
\end{bmatrix} $$
$$ \underline{\underline{A_{i,i-1}}} \; = \begin{bmatrix}
- \lambda - \nu_{x_{i,1}} \; \mu &amp; 0 &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; - \lambda - \nu_{x_{i,2}} \; \mu &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; 0 &amp; - \lambda - \nu_{x_{i,3}} \; \mu &amp; \cdots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; - \lambda - \nu_{x_{i,n}} \; \mu \\
\end{bmatrix} $$
$$ \underline{\underline{A_{i-1,i}}} \; = \begin{bmatrix}
- \lambda + \nu_{x_{i-1,1}} \; \mu &amp; 0 &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; - \lambda + \nu_{x_{i-1,2}} \; \mu &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; 0 &amp; - \lambda + \nu_{x_{i-1,3}} \; \mu &amp; \cdots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; - \lambda + \nu_{x_{i-1,n}} \; \mu \\
\end{bmatrix} $$</SPAN>  4.- The last step focuses on isolating the unknowns vector, by doing:

$$ \underline{C^{k+1}} \; = \; \underline{\underline{A^{-1}}} \;  \underline{\underline{B}} \; \underline{C^{k}} \; = \; \underline{\underline{\mathcal{M}}} \; \underline{C^{k}}$$

Where $\;\underline{\underline{\mathcal{M}}} \; = \; \underline{\underline{A^{-1}}} \;  \underline{\underline{B}}$

That is the last equation system must be solved each time iteration. Note that, for the first iteration $\;(k\;=\;0)$, we get $\;\underline{C^{1}}\;=\;\underline{\underline{\mathcal{M}}} \; \underline{C^{0}}\;$, and this $\;\underline{C^{0}}\;$ vector, is given with the <I> initial conditions </I>, in our case, a Gaussian Distribution, centered in the middle of the plate (in the ideal case, is usually chosen a Delta of Dirac ($\delta(x,y)$) as initial conditions, but we are dealing a real model).
</P></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2013.igem.org/Team:Valencia_Biocampus/Demonstration/Diffusion2">http://2013.igem.org/Team:Valencia_Biocampus/Demonstration/Diffusion2</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Valencia_Biocampus/Demonstration/Diffusion2" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Valencia_Biocampus/Demonstration/Diffusion2" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Valencia_Biocampus/Demonstration/Diffusion2&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Valencia_Biocampus/Demonstration/Diffusion2&amp;oldid=274383" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2013.igem.org:Privacy_policy" title="2013.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2013.igem.org:General_disclaimer" title="2013.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>