<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_TU-Munich_Modeling_Kill_Switch"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:TU-Munich/Modeling/Kill_Switch">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:TU-Munich/Modeling/Kill_Switch&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:TU-Munich/Modeling/Kill_Switch&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:TU-Munich/Modeling/Kill_Switch&amp;action=history">History               </A></LI><LI style="color:white;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:TU-Munich/Modeling/Kill_Switch" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:TU-Munich/Modeling/Kill Switch</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2013.igem.org</H3><DIV id="header-container"><DIV id="menu"><UL><LI><A id="home" href="https://2013.igem.org/Team:TU-Munich">Home</A></LI><LI><A id="project" href="https://2013.igem.org/Team:TU-Munich/Project/Overview">Project</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Project/Phytoremediation">Phytoremediation</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Project/Physcomitrella"><I>Physcomitrella</I></A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Project/Localisation">Localization</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Project/Biodegradation">BioDegradation</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Project/Bioaccumulation">BioAccumulation</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Project/Killswitch">Kill Switch</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Project/Safety">Safety</A></LI></UL><LI><A id="results" href="https://2013.igem.org/Team:TU-Munich/Results/Overview">Results</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/BioBricks">BioBricks</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/Recombinant">Effector Studies</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/Moss">Moss Methods</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/Localization">Localization</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/GM-Moss">PhyscoFilter</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/KillSwitch">Kill Switch</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/Implementation">Implementation</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/Software">AutoAnnotator</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/Economics">Entrepreneurship</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/Summary">Summary</A></LI><LI><A id="modeling" href="https://2013.igem.org/Team:TU-Munich/Modeling/Overview">Modeling</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Modeling/Protein_Predictions">Protein Predictions</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Modeling/Kill_Switch">Kill Switch</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Modeling/Enzyme">Enzyme Kinetics</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Modeling/Filter">Filter Model</A></LI><LI><A id="team" href="https://2013.igem.org/Team:TU-Munich/Team/Members">Team</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Team/Members">Members</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Team/Sponsors">Sponsors</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Team/Collaborations">Collaborations</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Team/Gallery">Pictures</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Team/Statistics">Timeline</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Team/Attributions">Attributions</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Team/Judging">Judging</A></LI><LI><A id="notebook" href="https://2013.igem.org/Team:TU-Munich/Notebook/Labjournal">Notebook</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Notebook/Labjournal">Labjournal</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Notebook/Methods">Methods</A></LI><LI><A id="human_practice" href="https://2013.igem.org/Team:TU-Munich/HumanPractice/Overview">Outreach</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/HumanPractice/Interviews">Expert Counsel</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/HumanPractice/GMO">GMO release</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/HumanPractice/Media">Publicity</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/HumanPractice/Education">Educational Kit</A></LI><LI><A href="https://2013.igem.org/Team:TU-Munich/Results/How_To">Tutorials</A></LI></DIV></DIV><DIV id="wikicontent-container"><DIV id="wikicontent"><H2><SPAN class="mw-headline" id="Kill_Switch_Modeling">Kill Switch Modeling</SPAN></H2><DIV><H4><SPAN class="mw-headline" id="Purpose">Purpose</SPAN></H4><P>The idea of our <A href="https://2013.igem.org/Team:TU-Munich/Project/Killswitch" class="external text" rel="nofollow">kill switch</A> is to kill off our moss, as soon as it leaves the filter system. For this purpose two methods were proposed:
</P><OL><LI><B>siRNA</B> method: When some trigger is activated, siRNA is expressed inhibiting the expression of a vital gene
</LI><LI><B>nuclease</B> method: When some trigger is activated, a nuclease is released destroying the DNA of the cell
</LI></OL><P>To decide between these two methods we modelled the vitality V of the cell (a number between 0 and 1, so a perfectly functional cell has V=1, a dead cell V=0) and depending on the tested method the concentration of siRNA R and nuclease N as appropriate. Both concentrations are normalized to the unit interval [0,1].
</P><H2><SPAN class="mw-headline" id="siRNA_Model">siRNA Model</SPAN></H2><H4><SPAN class="mw-headline" id="Governing_equations">Governing equations</SPAN></H4><DIV class="thumb tright"><DIV class="thumbinner" style="width:402px;"><DIV class="thumbcaption"><B>Figure 1:</B> Example solution to our siRNA model with parameters k<SUB>1</SUB>=1, k<SUB>2</SUB>=2, k<SUB>3</SUB>=2, k<SUB>4</SUB>=1.</DIV></DIV></DIV>
We determined the governing equations of this model to be the following:<P>with initial conditions V(0) = 1 and R(0) = 0, where at the time t=0 the trigger is activated.
</P><P>Figure 1, created by our MatLab script <A href="#siRNA_model_script">siRNA model</A> shown below, on the right shows a solution to this system for some example parameters. In this case the vitality of the cell decreases to somewhere around 0.3 while at the same time after an initial peak the siRNA concentration also drops upon which the vitality settles in at about 0.4.
</P><P>So it appears, that the siRNA approach does not achieve the required death of the cells. In the following it will be shown, that this is the case for all parameter values.
</P><H4><SPAN class="mw-headline" id="Calculation_of_stable_points_and_analysis">Calculation of stable points and analysis</SPAN></H4>
The steady points V* and R* of this system have to satisfy 
Defining  we get the following quadratic equation for the steady point of V <P><B>If α = 1</B>, the unique steady point is .
</P>
To analyze the stability of these the eigenvalues of the Hessian matrix  H 
must be computed. The eigenvalues are <P>
These are both negative, so this is a <B>stable point</B>, i.e. an attractor.
</P><B>If α ≠ 1</B>, the steady points are <P>
Now only one of these is in the sensible range, because
</P><UL><LI>for α&gt; 1: </LI><LI>for α&lt; 1: </LI></UL><P>So there is only one steady point in this range, namely:
</P><P>
By expanding the fraction by  we can rewrite V* as
</P><P>
So using the results from above, we get: </P>
Now look at the eigenvalues of the Hessian matrix to analyze the stability <P>
Defining , the eigenvalues are given by
</P><P>
So , which means that this is a <B>stable attractor</B>.
</P><H4><SPAN class="mw-headline" id="Result_of_our_model">Result of our model</SPAN></H4><P>So for the <B>siRNA</B> there <B>always is a stable point</B> for the vitality <B>between (but excluding) 0 and 1</B>, so the moss is <B>not killed-off</B> completely, just impeded in its growth.
</P><H4><SPAN class="mw-headline" id="Interpretation">Interpretation</SPAN></H4><P>This result makes intuitive sense, because as the function of the cell is repressed the cell produces less of the inhibiting siRNA, which leads to a regeneration of the cell. Eventually a steady state at a lower vitality is reached, where the vitality stays constant.
</P><H4><SPAN class="mw-headline" id="Stochastic_Model"> Stochastic Model </SPAN></H4><DIV class="thumb tright"><DIV class="thumbinner" style="width:402px;"><DIV class="thumbcaption"><B>Figure 2</B>: Averaging over 1000 realisations of the Gillespie algorithm. Solid line indicates the mean, dashed lines indicate the 1-σ interval.</DIV></DIV></DIV><P>As number of siRNA in a cell can be very small, we cannot always assume that there is an sufficient amount of RNA such we can rule out stochastic effect. To deal with this problem we set up an analogous stochastic model constisting of a Markov Jump Process of the two species with a total of 4 reactions.
</P><P>
The state space [0,1] was discretised to [1,2,3,...,100] for both species R and N while the reaction rates were kept the same.
</P><P>To simulate the model we used and implementation of the Gillespie Algorithm with 1000 realisations and then averaged over all realisations.
</P><P>With this implementation the qualitative behaviour of the system remains unchanged, while the quantitative changes which is due to the discretization.
</P><H2><SPAN class="mw-headline" id="Nuclease_Model">Nuclease Model</SPAN></H2><H4><SPAN class="mw-headline" id="Governing_equations_2">Governing equations</SPAN></H4><DIV class="thumb tright"><DIV class="thumbinner" style="width:402px;"><DIV class="thumbcaption"><B>Figure 3:</B> Example solution to our nuclease model with parameters p<SUB>1</SUB>=1, p<SUB>3</SUB>=0.5, p<SUB>4</SUB>=0.005.</DIV></DIV></DIV>
We determined the governing equations of this model to be the following:<P>with initial conditions V(0) = 1 and N(0) = 0, where at the time t=0 the trigger is activated.
</P><P>Figure 2, created by our MatLab script <A href="#nuclease_model_script">nuclease model</A> shown below, on the left shows a solution to this system for some example parameters. It clearly shows that in this case the vitality of the cell decreases to 0 and remains there, i.e. that the cell has died.
</P><P>In the following we will verify, that this is the case for all parameter values.
</P><H4><SPAN class="mw-headline" id="Calculation_of_stable_points_and_analysis_2">Calculation of stable points and analysis</SPAN></H4>
Any steady state given by V* and N* of this system must to satisfy 
The Hessian matrix of this system for the steady point is easy to solve <P>
The eigenvector corresponding to the zero eigenvalue is . It is obvious from the equations that any disturbance away from the steady state along this vector will decay back to the steady state, <B>so this is a stable attractor</B>.
</P><H4><SPAN class="mw-headline" id="Results_of_our_model">Results of our model</SPAN></H4><P>The <B>nuclease</B> always reduces the vitality of the moss to 0, i.e. <B>kills it off completely</B>.
</P><H4><SPAN class="mw-headline" id="Interpretation_2">Interpretation</SPAN></H4><P>Again this result is very intuitive, since the <B>moss cannot regenerate</B> from the destruction of its genome.
</P><H3><SPAN class="mw-headline" id="Conclusions">Conclusions</SPAN></H3><P>For a functional kill-switch it is necessary, that the cells are actually killed and not just live on with reduced vitality. So based on our modeling results the siRNA approach is not satisfactory, while the <B>nuclease satisfies the requirement</B>. <B>As a result the team pursued the nuclease approach leading to our final kill-switch.</B></P><H2><SPAN class="mw-headline" id="MatLab_Scripts">MatLab Scripts</SPAN></H2><H4><SPAN class="mw-headline" id="siRNA_model_script">siRNA model script</SPAN></H4><PRE>% f = @(R,V,k) [k(3)* V  - k(4) * R , -k(1) * R * V + k(2) *(V  -1)* (R  -1)];
g = @(k,y)    [k(3)* y(2)- k(4)*y(1); -k(1)*y(1)*y(2)+k(2)*(y(2)-1)*(y(1)-1)];

%k= [  k1,  k2,  k3,  k4 ]; %insert the appropriate reaction rate constant
k = [   1,   2,   2,   1];

[TOUT, YOUT] = ode45(@(t,y) g(k,y) ,[0,10],[0;1]);

plot(TOUT, YOUT(:,1), 'markersize', 15, 'linewidth', 5)
hold on; plot(TOUT, YOUT(:,2), 'r', 'markersize', 15, 'linewidth', 5); hold off

legend('siRNA concentration','Vitality');
xlabel('time');
set(gca,'FontSize',24);
set(gcf,'position', [100 100 600 600]);

axis square
set(gcf,'Color','w');
export_fig siRNA_pic.png

</PRE><H4><SPAN class="mw-headline" id="Stochastic_siRNA_script"> Stochastic siRNA script </SPAN></H4><PRE>%% 1 States
% [R,V]
x0 = [0,100];

%% 2 Reactions
% stoichiometric matrix
S = zeros(4,2);

%% 2.1 increase siRNA
% R -&gt; R + 1
% rate k3 * V
S(1,:) = [1,0];

%% 2.2 degrade siRNA
% R -&gt; R - 1
% rate k4 * R
S(2,:) = [-1,0];

%% 2.3 increase vitality
% V -&gt; V + 1
% rate k2 * ( V - 1 ) * ( R - 1 )
S(3,:) = [0,1];

%% 2.4 decrease vitality
% V -&gt; V - 1
% rate k1 * R * V
S(4,:) = [0,-1];


param = [   1,   2,   1,   2];

% rates
acell = { @(t,x,k) k(3) * x(2)/100,
    @(t,x,k) k(4) * x(1)/100,
    @(t,x,k) k(2) * ( x(2) - 100 )/100 * ( x(1) - 100 )/100,
    @(t,x,k) k(1) * x(1) * x(2)/100};

a = @(t,x,k) [feval(acell{1},t,x,k),feval(acell{2},t,x,k),feval(acell{3},t,x,k),feval(acell{4},t,x,k)];

% time vector

N_time = 100;

tt = linspace(0,100,N_time);

% number of runs
N_repeat = 1000;

% output
X_runs = zeros(N_repeat,N_time,length(x0));


%plotting
figure(1)
clf
hold on

for j = 1:N_repeat 
    [X_runs(j,:,:)]=SSA(x0,S,a,tt,param);
end

figure
hold on
plot(tt,mean(X_runs(:,:,1)),'b')
plot(tt,mean(X_runs(:,:,2)),'r')
legend('siRNA','Vitality')
for k = 1:length(x0)
    switch k
        case 1
        plot(tt,mean(X_runs(:,:,k)),'b')
        plot(tt,mean(X_runs(:,:,k))+sqrt(var(X_runs(:,:,k))),'--b')
        plot(tt,mean(X_runs(:,:,k))-sqrt(var(X_runs(:,:,k))),'--b')
        case 2
        plot(tt,mean(X_runs(:,:,k)),'r')
        plot(tt,mean(X_runs(:,:,k))+sqrt(var(X_runs(:,:,k))),'--r')
        plot(tt,mean(X_runs(:,:,k))-sqrt(var(X_runs(:,:,k))),'--r')
    end
end

find(X_runs(:,:,2)==0,1,'first')
set(gcf,'Color','w')
axis square
export_fig siRNA_stochastic.png

</PRE><H4><SPAN class="mw-headline" id="Gillespie">Gillespie</SPAN></H4><PRE>function [ xx, XX, TT ] = SSA( x0, S, a, tt , param)
    %SSA Summary of this function goes here
    %   Detailed explanation goes here
    
    % initialise
    TT(1) = 0;
    XX(1,:) = x0;
    
    % step
    i = 1;
    while (TT(end)&lt;tt(end));
        % increment step
        i = i + 1;
        
        %compute rates
        at = a(TT(i-1),XX(i-1,:),param);
        a0 = sum(at);
        
        for k = 1 : length(at)
            aj(k) = sum(at(1:k)/a0);
        end
        
        %sample time
        TT(i) = TT(i-1) + expinv(rand,1/a0);
        
        % select reaction that happens
        j = find(aj&gt;rand,1,'first');
        
        % add reaction
        XX(i,:) = XX(i-1,:) + S(j,:);
    end

    xx = zeros(length(tt),length(x0));
    for j = 1:length(tt)
        xx(j,:) = XX(find(TT&lt;=tt(j),1,'last'),:);
    end
    
end

</PRE><H4><SPAN class="mw-headline" id="Nuclease_model_script">Nuclease model script</SPAN></H4><PRE>% f = @(N,V,k) [p(3)* V  - p(4) * N , -p(1) * N * V  ];
g = @(p,y)    [p(3)* y(2)- p(4)*y(1); -p(1)*y(1)*y(2)];

%p= [  p1,  p2,  p3,  p4 ]; %insert the appropriate reaction rate constant
p = [   1, NaN,   1, 0.5 ];

[TOUT, YOUT] = ode45(@(t,y) g(p,y) ,[0,20],[0;1]);

plot(TOUT, YOUT(:,1), 'markersize', 15, 'linewidth', 5)
hold on; plot(TOUT, YOUT(:,2), 'r', 'markersize', 15, 'linewidth', 5); hold off

legend('Nuclease concentration','Vitality')
xlabel('time');
set(gca,'FontSize',24);
set(gcf,'position', [100 100 600 600]);

axis square
set(gcf,'Color','w')
export_fig nuc_pic.png
</PRE></DIV></DIV></DIV><DIV id="social-footer"><DIV id="annotator"><H2>AutoAnnotator:</H2><FORM action="https://2013.igem.org/Team:TU-Munich/Results/AutoAnnotator" method="get"> or go to the <A href="https://2013.igem.org/Team:TU-Munich/Results/AutoAnnotator">AutoAnnotator</A> page.
  </FORM></DIV><DIV id="follow"><H2>Follow us:</H2></DIV><DIV id="address"><H2>Address:</H2><P>iGEM Team TU-Munich
     Emil-Erlenmeyer-Forum 5
     85354 Freising, Germany</P><P>Email: <A id="mail" href="mailto:igem@wzw.tum.de">igem@wzw.tum.de</A>
     Phone: +49 8161 71-4351</P></DIV></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2013.igem.org/Team:TU-Munich/Modeling/Kill_Switch">http://2013.igem.org/Team:TU-Munich/Modeling/Kill_Switch</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:TU-Munich/Modeling/Kill_Switch" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:TU-Munich/Modeling/Kill_Switch" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:TU-Munich/Modeling/Kill_Switch&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:TU-Munich/Modeling/Kill_Switch&amp;oldid=358176" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2013.igem.org:Privacy_policy" title="2013.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2013.igem.org:General_disclaimer" title="2013.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>