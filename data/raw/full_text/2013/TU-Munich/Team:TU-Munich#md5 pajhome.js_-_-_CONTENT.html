<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_TU-Munich_md5_pajhome_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:TU-Munich/md5_pajhome.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:TU-Munich/md5_pajhome.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:TU-Munich/md5_pajhome.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:TU-Munich/md5_pajhome.js&amp;action=history">History               </A></LI><LI style="color:white;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:TU-Munich/md5_pajhome.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:TU-Munich/md5 pajhome.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2013.igem.org</H3><P>/*
</P><PRE>* A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
* Digest Algorithm, as defined in <A href="http://tools.ietf.org/html/rfc1321" class="external mw-magiclink-rfc">RFC 1321</A>.
* Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
* Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
* Distributed under the BSD License
* See <A href="http://pajhome.org.uk/crypt/md5" class="external free" rel="nofollow">http://pajhome.org.uk/crypt/md5</A> for more info.
*/
</PRE><P>/*
</P><PRE>* Configurable variables. You may need to tweak these to be compatible with
* the server-side, but the defaults work in most cases.
*/
</PRE><P>var hexcase = 0;   /* hex output format. 0 - lowercase; 1 - uppercase        */
var b64pad  = &quot;&quot;;  /* base-64 pad character. &quot;=&quot; for strict RFC compliance   */
</P><P>/*
</P><PRE>* These are the functions you'll usually want to call
* They take string arguments and return either hex or base-64 encoded strings
*/
</PRE><P>function hex_md5(s)    { return rstr2hex(rstr_md5(str2rstr_utf8(s))); }
function b64_md5(s)    { return rstr2b64(rstr_md5(str2rstr_utf8(s))); }
function any_md5(s, e) { return rstr2any(rstr_md5(str2rstr_utf8(s)), e); }
function hex_hmac_md5(k, d)
</P><PRE> { return rstr2hex(rstr_hmac_md5(str2rstr_utf8(k), str2rstr_utf8(d))); }
</PRE><P>function b64_hmac_md5(k, d)
</P><PRE> { return rstr2b64(rstr_hmac_md5(str2rstr_utf8(k), str2rstr_utf8(d))); }
</PRE><P>function any_hmac_md5(k, d, e)
</P><PRE> { return rstr2any(rstr_hmac_md5(str2rstr_utf8(k), str2rstr_utf8(d)), e); }
</PRE><P>/*
</P><PRE>* Perform a simple self-test to see if the VM is working
*/
</PRE><P>function md5_vm_test()
{
</P><PRE> return hex_md5(&quot;abc&quot;).toLowerCase() == &quot;900150983cd24fb0d6963f7d28e17f72&quot;;
</PRE><P>}
</P><P>/*
</P><PRE>* Calculate the MD5 of a raw string
*/
</PRE><P>function rstr_md5(s)
{
</P><PRE> return binl2rstr(binl_md5(rstr2binl(s), s.length * 8));
</PRE><P>}
</P><P>/*
</P><PRE>* Calculate the HMAC-MD5, of a key and some data (raw strings)
*/
</PRE><P>function rstr_hmac_md5(key, data)
{
</P><PRE> var bkey = rstr2binl(key);
 if(bkey.length &gt; 16) bkey = binl_md5(bkey, key.length * 8);
</PRE><PRE> var ipad = Array(16), opad = Array(16);
 for(var i = 0; i &lt; 16; i++)
 {
   ipad[i] = bkey[i] ^ 0x36363636;
   opad[i] = bkey[i] ^ 0x5C5C5C5C;
 }
</PRE><PRE> var hash = binl_md5(ipad.concat(rstr2binl(data)), 512 + data.length * 8);
 return binl2rstr(binl_md5(opad.concat(hash), 512 + 128));
</PRE><P>}
</P><P>/*
</P><PRE>* Convert a raw string to a hex string
*/
</PRE><P>function rstr2hex(input)
{
</P><PRE> try { hexcase; } catch(e) { hexcase=0; }
 var hex_tab = hexcase ? &quot;0123456789ABCDEF&quot; : &quot;0123456789abcdef&quot;;
 var output = &quot;&quot;;
 var x;
 for(var i = 0; i &lt; input.length; i++)
 {
   x = input.charCodeAt(i);
   output += hex_tab.charAt((x &gt;&gt;&gt; 4) &amp; 0x0F)
          +  hex_tab.charAt( x        &amp; 0x0F);
 }
 return output;
</PRE><P>}
</P><P>/*
</P><PRE>* Convert a raw string to a base-64 string
*/
</PRE><P>function rstr2b64(input)
{
</P><PRE> try { b64pad; } catch(e) { b64pad=<I>; }</I>
 var tab = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;
 var output = &quot;&quot;;
 var len = input.length;
 for(var i = 0; i &lt; len; i += 3)
 {
   var triplet = (input.charCodeAt(i) &lt;&lt; 16)
               | (i + 1 &lt; len ? input.charCodeAt(i+1) &lt;&lt; 8 : 0)
               | (i + 2 &lt; len ? input.charCodeAt(i+2)      : 0);
   for(var j = 0; j &lt; 4; j++)
   {
     if(i * 8 + j * 6 &gt; input.length * 8) output += b64pad;
     else output += tab.charAt((triplet &gt;&gt;&gt; 6*(3-j)) &amp; 0x3F);
   }
 }
 return output;
</PRE><P>}
</P><P>/*
</P><PRE>* Convert a raw string to an arbitrary string encoding
*/
</PRE><P>function rstr2any(input, encoding)
{
</P><PRE> var divisor = encoding.length;
 var i, j, q, x, quotient;
</PRE><PRE> /* Convert to an array of 16-bit big-endian values, forming the dividend */
 var dividend = Array(Math.ceil(input.length / 2));
 for(i = 0; i &lt; dividend.length; i++)
 {
   dividend[i] = (input.charCodeAt(i * 2) &lt;&lt; 8) | input.charCodeAt(i * 2 + 1);
 }
</PRE><PRE> /*
  * Repeatedly perform a long division. The binary array forms the dividend,
  * the length of the encoding is the divisor. Once computed, the quotient
  * forms the dividend for the next step. All remainders are stored for later
  * use.
  */
 var full_length = Math.ceil(input.length * 8 /
                                   (Math.log(encoding.length) / Math.log(2)));
 var remainders = Array(full_length);
 for(j = 0; j &lt; full_length; j++)
 {
   quotient = Array();
   x = 0;
   for(i = 0; i &lt; dividend.length; i++)
   {
     x = (x &lt;&lt; 16) + dividend[i];
     q = Math.floor(x / divisor);
     x -= q * divisor;
     if(quotient.length &gt; 0 || q &gt; 0)
       quotient[quotient.length] = q;
   }
   remainders[j] = x;
   dividend = quotient;
 }
</PRE><PRE> /* Convert the remainders to the output string */
 var output = &quot;&quot;;
 for(i = remainders.length - 1; i &gt;= 0; i--)
   output += encoding.charAt(remainders[i]);
</PRE><PRE> return output;
</PRE><P>}
</P><P>/*
</P><PRE>* Encode a string as utf-8.
* For efficiency, this assumes the input is valid utf-16.
*/
</PRE><P>function str2rstr_utf8(input)
{
</P><PRE> var output = &quot;&quot;;
 var i = -1;
 var x, y;
</PRE><PRE> while(++i &lt; input.length)
 {
   /* Decode utf-16 surrogate pairs */
   x = input.charCodeAt(i);
   y = i + 1 &lt; input.length ? input.charCodeAt(i + 1) : 0;
   if(0xD800 &lt;= x &amp;&amp; x &lt;= 0xDBFF &amp;&amp; 0xDC00 &lt;= y &amp;&amp; y &lt;= 0xDFFF)
   {
     x = 0x10000 + ((x &amp; 0x03FF) &lt;&lt; 10) + (y &amp; 0x03FF);
     i++;
   }
</PRE><PRE>   /* Encode output as utf-8 */
   if(x &lt;= 0x7F)
     output += String.fromCharCode(x);
   else if(x &lt;= 0x7FF)
     output += String.fromCharCode(0xC0 | ((x &gt;&gt;&gt; 6 ) &amp; 0x1F),
                                   0x80 | ( x         &amp; 0x3F));
   else if(x &lt;= 0xFFFF)
     output += String.fromCharCode(0xE0 | ((x &gt;&gt;&gt; 12) &amp; 0x0F),
                                   0x80 | ((x &gt;&gt;&gt; 6 ) &amp; 0x3F),
                                   0x80 | ( x         &amp; 0x3F));
   else if(x &lt;= 0x1FFFFF)
     output += String.fromCharCode(0xF0 | ((x &gt;&gt;&gt; 18) &amp; 0x07),
                                   0x80 | ((x &gt;&gt;&gt; 12) &amp; 0x3F),
                                   0x80 | ((x &gt;&gt;&gt; 6 ) &amp; 0x3F),
                                   0x80 | ( x         &amp; 0x3F));
 }
 return output;
</PRE><P>}
</P><P>/*
</P><PRE>* Encode a string as utf-16
*/
</PRE><P>function str2rstr_utf16le(input)
{
</P><PRE> var output = &quot;&quot;;
 for(var i = 0; i &lt; input.length; i++)
   output += String.fromCharCode( input.charCodeAt(i)        &amp; 0xFF,
                                 (input.charCodeAt(i) &gt;&gt;&gt; 8) &amp; 0xFF);
 return output;
</PRE><P>}
</P><P>function str2rstr_utf16be(input)
{
</P><PRE> var output = &quot;&quot;;
 for(var i = 0; i &lt; input.length; i++)
   output += String.fromCharCode((input.charCodeAt(i) &gt;&gt;&gt; 8) &amp; 0xFF,
                                  input.charCodeAt(i)        &amp; 0xFF);
 return output;
</PRE><P>}
</P><P>/*
</P><PRE>* Convert a raw string to an array of little-endian words
* Characters &gt;255 have their high-byte silently ignored.
*/
</PRE><P>function rstr2binl(input)
{
</P><PRE> var output = Array(input.length &gt;&gt; 2);
 for(var i = 0; i &lt; output.length; i++)
   output[i] = 0;
 for(var i = 0; i &lt; input.length * 8; i += 8)
   output[i&gt;&gt;5] |= (input.charCodeAt(i / 8) &amp; 0xFF) &lt;&lt; (i%32);
 return output;
</PRE><P>}
</P><P>/*
</P><PRE>* Convert an array of little-endian words to a string
*/
</PRE><P>function binl2rstr(input)
{
</P><PRE> var output = &quot;&quot;;
 for(var i = 0; i &lt; input.length * 32; i += 8)
   output += String.fromCharCode((input[i&gt;&gt;5] &gt;&gt;&gt; (i % 32)) &amp; 0xFF);
 return output;
</PRE><P>}
</P><P>/*
</P><PRE>* Calculate the MD5 of an array of little-endian words, and a bit length.
*/
</PRE><P>function binl_md5(x, len)
{
</P><PRE> /* append padding */
 x[len &gt;&gt; 5] |= 0x80 &lt;&lt; ((len) % 32);
 x[(((len + 64) &gt;&gt;&gt; 9) &lt;&lt; 4) + 14] = len;
</PRE><PRE> var a =  1732584193;
 var b = -271733879;
 var c = -1732584194;
 var d =  271733878;
</PRE><PRE> for(var i = 0; i &lt; x.length; i += 16)
 {
   var olda = a;
   var oldb = b;
   var oldc = c;
   var oldd = d;
</PRE><PRE>   a = md5_ff(a, b, c, d, x[i+ 0], 7 , -680876936);
   d = md5_ff(d, a, b, c, x[i+ 1], 12, -389564586);
   c = md5_ff(c, d, a, b, x[i+ 2], 17,  606105819);
   b = md5_ff(b, c, d, a, x[i+ 3], 22, -1044525330);
   a = md5_ff(a, b, c, d, x[i+ 4], 7 , -176418897);
   d = md5_ff(d, a, b, c, x[i+ 5], 12,  1200080426);
   c = md5_ff(c, d, a, b, x[i+ 6], 17, -1473231341);
   b = md5_ff(b, c, d, a, x[i+ 7], 22, -45705983);
   a = md5_ff(a, b, c, d, x[i+ 8], 7 ,  1770035416);
   d = md5_ff(d, a, b, c, x[i+ 9], 12, -1958414417);
   c = md5_ff(c, d, a, b, x[i+10], 17, -42063);
   b = md5_ff(b, c, d, a, x[i+11], 22, -1990404162);
   a = md5_ff(a, b, c, d, x[i+12], 7 ,  1804603682);
   d = md5_ff(d, a, b, c, x[i+13], 12, -40341101);
   c = md5_ff(c, d, a, b, x[i+14], 17, -1502002290);
   b = md5_ff(b, c, d, a, x[i+15], 22,  1236535329);
</PRE><PRE>   a = md5_gg(a, b, c, d, x[i+ 1], 5 , -165796510);
   d = md5_gg(d, a, b, c, x[i+ 6], 9 , -1069501632);
   c = md5_gg(c, d, a, b, x[i+11], 14,  643717713);
   b = md5_gg(b, c, d, a, x[i+ 0], 20, -373897302);
   a = md5_gg(a, b, c, d, x[i+ 5], 5 , -701558691);
   d = md5_gg(d, a, b, c, x[i+10], 9 ,  38016083);
   c = md5_gg(c, d, a, b, x[i+15], 14, -660478335);
   b = md5_gg(b, c, d, a, x[i+ 4], 20, -405537848);
   a = md5_gg(a, b, c, d, x[i+ 9], 5 ,  568446438);
   d = md5_gg(d, a, b, c, x[i+14], 9 , -1019803690);
   c = md5_gg(c, d, a, b, x[i+ 3], 14, -187363961);
   b = md5_gg(b, c, d, a, x[i+ 8], 20,  1163531501);
   a = md5_gg(a, b, c, d, x[i+13], 5 , -1444681467);
   d = md5_gg(d, a, b, c, x[i+ 2], 9 , -51403784);
   c = md5_gg(c, d, a, b, x[i+ 7], 14,  1735328473);
   b = md5_gg(b, c, d, a, x[i+12], 20, -1926607734);
</PRE><PRE>   a = md5_hh(a, b, c, d, x[i+ 5], 4 , -378558);
   d = md5_hh(d, a, b, c, x[i+ 8], 11, -2022574463);
   c = md5_hh(c, d, a, b, x[i+11], 16,  1839030562);
   b = md5_hh(b, c, d, a, x[i+14], 23, -35309556);
   a = md5_hh(a, b, c, d, x[i+ 1], 4 , -1530992060);
   d = md5_hh(d, a, b, c, x[i+ 4], 11,  1272893353);
   c = md5_hh(c, d, a, b, x[i+ 7], 16, -155497632);
   b = md5_hh(b, c, d, a, x[i+10], 23, -1094730640);
   a = md5_hh(a, b, c, d, x[i+13], 4 ,  681279174);
   d = md5_hh(d, a, b, c, x[i+ 0], 11, -358537222);
   c = md5_hh(c, d, a, b, x[i+ 3], 16, -722521979);
   b = md5_hh(b, c, d, a, x[i+ 6], 23,  76029189);
   a = md5_hh(a, b, c, d, x[i+ 9], 4 , -640364487);
   d = md5_hh(d, a, b, c, x[i+12], 11, -421815835);
   c = md5_hh(c, d, a, b, x[i+15], 16,  530742520);
   b = md5_hh(b, c, d, a, x[i+ 2], 23, -995338651);
</PRE><PRE>   a = md5_ii(a, b, c, d, x[i+ 0], 6 , -198630844);
   d = md5_ii(d, a, b, c, x[i+ 7], 10,  1126891415);
   c = md5_ii(c, d, a, b, x[i+14], 15, -1416354905);
   b = md5_ii(b, c, d, a, x[i+ 5], 21, -57434055);
   a = md5_ii(a, b, c, d, x[i+12], 6 ,  1700485571);
   d = md5_ii(d, a, b, c, x[i+ 3], 10, -1894986606);
   c = md5_ii(c, d, a, b, x[i+10], 15, -1051523);
   b = md5_ii(b, c, d, a, x[i+ 1], 21, -2054922799);
   a = md5_ii(a, b, c, d, x[i+ 8], 6 ,  1873313359);
   d = md5_ii(d, a, b, c, x[i+15], 10, -30611744);
   c = md5_ii(c, d, a, b, x[i+ 6], 15, -1560198380);
   b = md5_ii(b, c, d, a, x[i+13], 21,  1309151649);
   a = md5_ii(a, b, c, d, x[i+ 4], 6 , -145523070);
   d = md5_ii(d, a, b, c, x[i+11], 10, -1120210379);
   c = md5_ii(c, d, a, b, x[i+ 2], 15,  718787259);
   b = md5_ii(b, c, d, a, x[i+ 9], 21, -343485551);
</PRE><PRE>   a = safe_add(a, olda);
   b = safe_add(b, oldb);
   c = safe_add(c, oldc);
   d = safe_add(d, oldd);
 }
 return Array(a, b, c, d);
</PRE><P>}
</P><P>/*
</P><PRE>* These functions implement the four basic operations the algorithm uses.
*/
</PRE><P>function md5_cmn(q, a, b, x, s, t)
{
</P><PRE> return safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s),b);
</PRE><P>}
function md5_ff(a, b, c, d, x, s, t)
{
</P><PRE> return md5_cmn((b &amp; c) | ((~b) &amp; d), a, b, x, s, t);
</PRE><P>}
function md5_gg(a, b, c, d, x, s, t)
{
</P><PRE> return md5_cmn((b &amp; d) | (c &amp; (~d)), a, b, x, s, t);
</PRE><P>}
function md5_hh(a, b, c, d, x, s, t)
{
</P><PRE> return md5_cmn(b ^ c ^ d, a, b, x, s, t);
</PRE><P>}
function md5_ii(a, b, c, d, x, s, t)
{
</P><PRE> return md5_cmn(c ^ (b | (~d)), a, b, x, s, t);
</PRE><P>}
</P><P>/*
</P><PRE>* Add integers, wrapping at 2^32. This uses 16-bit operations internally
* to work around bugs in some JS interpreters.
*/
</PRE><P>function safe_add(x, y)
{
</P><PRE> var lsw = (x &amp; 0xFFFF) + (y &amp; 0xFFFF);
 var msw = (x &gt;&gt; 16) + (y &gt;&gt; 16) + (lsw &gt;&gt; 16);
 return (msw &lt;&lt; 16) | (lsw &amp; 0xFFFF);
</PRE><P>}
</P><P>/*
</P><PRE>* Bitwise rotate a 32-bit number to the left.
*/
</PRE><P>function bit_rol(num, cnt)
{
</P><PRE> return (num &lt;&lt; cnt) | (num &gt;&gt;&gt; (32 - cnt));
</PRE><P>}
</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2013.igem.org/Team:TU-Munich/md5_pajhome.js">http://2013.igem.org/Team:TU-Munich/md5_pajhome.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:TU-Munich/md5_pajhome.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:TU-Munich/md5_pajhome.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:TU-Munich/md5_pajhome.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:TU-Munich/md5_pajhome.js&amp;oldid=107857" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2013.igem.org:Privacy_policy" title="2013.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2013.igem.org:General_disclaimer" title="2013.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>