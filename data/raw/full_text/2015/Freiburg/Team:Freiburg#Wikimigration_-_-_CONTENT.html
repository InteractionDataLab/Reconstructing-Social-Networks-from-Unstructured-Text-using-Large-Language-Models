<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Freiburg_Wikimigration skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Freiburg/Wikimigration</SPAN></H1><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P><TITLE>&quot;&quot;</TITLE></P><DIV id="header"><DIV id="naviconwrapper"><DIV id="naviconbar"><DIV id="navicons"><UL><LI id="home"><A href="https://2015.igem.org/Team:Freiburg/Home">Home</A></LI><LI id="project"><A href="https://2015.igem.org/Team:Freiburg/Project/Overview">Project</A></LI><LI id="team"><A href="https://2015.igem.org/Team:Freiburg/Team">Team</A></LI><LI id="results"><A href="https://2015.igem.org/Team:Freiburg/Results">Results</A></LI><LI id="policy" style="font-size:11px"><A href="https://2015.igem.org/Team:Freiburg/Practices">Human Practice</A></LI><LI id="notebook"><A href="https://2015.igem.org/Team:Freiburg/Notebook">Notebook</A></LI></UL></DIV></DIV></DIV><DIV id="navtextwrapper"><DIV id="navtext"><UL id="project-sub"><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Project/Overview">Introduction</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Project/System">Overview</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Design">Diagnostics today</A></LI><LI><A class="navsub1 subsubmenu" href="#">The DiaCHIP</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Project/DNA_Engineering">DNA Engineering</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Project/Cellfree_Expression">Cell-Free Expression</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Project/Protein_Purification">Protein Purification</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Project/Surface_Chemistry">Surface Chemistry</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Project/iRIf">Optical Detection</A></LI></UL><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Project/Future_Directions">Outlook</A></LI><UL id="team-sub"><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Team">Members</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Attributions">Acknowledgements</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Partners">Partners</A></LI></UL><UL id="results-sub"><LI><A class="navsub1 subsubmenu" href="#">The DiaCHIP</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Results">Main Results</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Results/Diagnostics">Diagnostics</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Results/Own_Device">Our Device</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Results/Immobilization">DNA Array</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Results/Cellfree">Cell-Free Expression</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Results/Surface">Binding on Surface</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Results/Modeling">Modeling</A></LI></UL><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Parts">BioBricks</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Collaborations">Collaborations</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/InterLab_Study">Interlab Study</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Achievements">Achievements</A></LI><UL id="policy-sub"><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Human_Practice/Science_Fair">Science Fair</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Human_Practice/Theater_Project">Theater Project</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Human_Practice/Public_Opinion">Public Opinion</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Human_Practice/College">College Talk</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Human_Practice/Ethics">Ethics</A></LI></UL><UL id="notebook-sub"><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Labjournals">Labjournals</A></LI><LI><A class="navsub1 subsubmenu" href="#">Techniques</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Project/Classic_vs_Gibson">Gibson</A></LI><LI><A class="navsub2" href="https://2015.igem.org/Team:Freiburg/Project/Coli_Strains">E.coli Strains</A></LI></UL><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Protocols">Protocols</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Materials">Materials</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Safety">Safety</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Wikimigration">Wiki-Tricks</A></LI><LI><A class="navsub1" href="https://2015.igem.org/Team:Freiburg/Glossary">Glossary</A></LI></DIV></DIV></DIV><DIV class="clearfix" id="smallnav"><UL class="clearfix"><LI id="home_small"><A href="https://2015.igem.org/Team:Freiburg/Home">Home</A></LI><LI id="project_small"><A href="https://2015.igem.org/Team:Freiburg/Project/Overview">Project</A></LI><LI id="results_small"><A href="https://2015.igem.org/Team:Freiburg/Results">Results</A></LI><LI id="team_small"><A href="https://2015.igem.org/Team:Freiburg/Team">Team</A></LI><LI id="policy_small"><A href="https://2015.igem.org/Team:Freiburg/Practices">Practice</A></LI><LI id="notebook_small"><A href="https://2015.igem.org/Team:Freiburg/Notebook">Notebook</A></LI></UL><A href="#" id="pull">Menu</A></DIV><DIV class="content_background_wrapper"><DIV class="central_position_wrap"><DIV id="bubble_wrapper"><DIV id="bubble_sidebar" class="bubble2"><P><A id="bubble2" href="#firstHeading">text</A></P></DIV><DIV id="bubble_sidebar" class="bubble3"><P><A id="bubble3" href="">next</A></P></DIV></DIV><DIV class="page_content"><DIV class="content_box"><H1>How to Migrate to the iGEM-Wiki: The Freiburg Way</H1><P>
At the end of an iGEM summer writing the final wiki in time for wiki freeze is a challenge every iGEM team experiences. But apart from designing the wiki itself, using CSS and Javascript, a main problem is the content. A final iGEM wiki should on the one hand be good to read and inspire people for science, on the other hand all the information needed to repeat the experiments has to be provided for good scientific practice. And especially for this last aspect we would like to show how we worked on our wiki and what may be adaptable for future teams.
</P><H2>The Internal Wiki</H2><P>
To start early and to document every step we did, we worked with a so called internal wiki that was based on dokuwiki and hosted on the university's web server. A special advantage of this wiki-system was an introductory course provided by the university and the relatively simple formatting syntax that allowed direct work without long learning periods. Additionally the wiki is used to organize our team, to protocol meetings and to provide information such as scientific papers and protocols as well as cooking recipes that we tested during these meetings. But a major drawback from using dokuwiki was that the syntax is not at all compatible with the mediawiki syntax that is used on the external official iGEM wiki. To not rewrite all articels we thought for a solution to convert content between these wikis in a fast and simple way.
</P><H2>Migration</H2><DIV class="image_box right"><DIV class="thumb2 tright" style="width:310px"><DIV class="thumbinner"><DIV class="thumbcaption">Form providing input for the wikitranslate script
</DIV></DIV></DIV></DIV><P>
Even though the dokuwiki provides a feature to export the page's body content (by appending &amp;do=export_xhtmlbody to the <ACRONYM title="Uniform Resource Locator">URL</ACRONYM> and getting the source code of this via STRG+U in Firefox) all the image links refer to the internal server and are, therefore, broken. The first step in migrating our content, thus was a script to download all the images of a specified internal wiki page and prefix the file names with Freiburg_ to avoid name conflicts with other teams. The program also outputs a file with all the file names separated by commas that is later used to upload the files.
To transfer the downloaded and renamed files onto the iGEM server the selenium browser automation tool (<A class="urlextern" href="http://www.seleniumhq.org/" rel="nofollow" target="_Blank" title="http://www.seleniumhq.org/">http://www.seleniumhq.org/</A>) in combination with the sideflow-plugin (<A class="urlextern" href="https://github.com/73rhodes/sideflow" rel="nofollow" target="_Blank" title="https://github.com/73rhodes/sideflow">https://github.com/73rhodes/sideflow</A>) was used. This plugin allows for the creation of loops in selenium routines as needed to upload a list of files. The steps in the selenium routine are basically the coded equivalent to clicking on the upload-button, selecting a file, clicking the ignore any warnings button and submit the form.
Once the files are on the server, it is necessary to get their location on this server to use it as image source in the html-text on the sites. As the iGEM Server assigns a variable path to every file (as /e/e4/filename.png) this path has to be probed for every single image to be used on the site.
This routine is implemented in the wikitranslate script together with a routine for replacing the linked headers by unlinked ones and one for adding preceding and following text, such that, for example custom styling for a specific page can be done directly in the protocol. The script is used on a web server basis (as cgi - script) and thus can be used by every team member with no needs for programming skills. It then returns an html-file that contains the source code to paste in the manually created new external wiki page.
</P><H2 class="sectionedit4">Refining the External Wiki</H2><P>
Despite lowering a lot the workload needed for transferring our content to the external wiki, there still is need to adapt the design by hand. A major aspect here is a consistent design of the uploaded pages with the ones created especially for the external wiki, as the landing page or the project overview pages.
All in all, using an automated uploading and replacing procedure to transfer our content from the internal to the external wiki allowed us to spend more time on the remaining pages, like our poster and the presentation. And we hope that our experiences might also be useful for other teams writing their content in advance.
</P><H2 class="sectionedit5">Script-Code</H2><DIV class="accordion"><DIV class="accordion-section"><A class="accordion-section-title" href="#accordion-1">dwfileload.py:</A><DIV id="accordion-1" class="accordion-section-content" style="display:none; padding:15px;"><DIV class="table sectionedit6">      
     	
			#!/usr/bin/env python		from bs4 import BeautifulSoup # parse raw html and extract elements		import requests		from requests.auth import HTTPBasicAuth		import cgi		import urllib3		##################		# DEFINITIONS		##################		def getdwsource(dwsite):		    # get the subsite of the internal wiki specified as site		    # use the dummy usre to provide access to the wiki		    dokuwiki=requests.get('https://wiki.uni-freiburg.de/igem2015/doku.php?id=%s&amp;do=export_xhtmlbody'%dwsite, auth=HTTPBasicAuth('dummy', 'igem2015'))		    # extract the html of the requests-object by using beautifulsoup		    soup=BeautifulSoup(dokuwiki.text,  'html.parser')		    # print('https://wiki.uni-freiburg.de/igem2015/doku.php?id=%s&amp;do=export_xhtmlbody'%site)		    return soup		def getdwpicnames(source):		    ########		    # returns a dict of the the names of all images in the source code as keys with the corresponding links to the image and the info-page		    ########		    picnamesdic={}		    for img in source.find_all('img'):		        # extract the name of all pictures from the src-string		        try:		            # get the name of the picnamesdic		            dwname=img.get('src').split('media=')[1]		            # use the name as key for a dict to store the links for src and href		            picnamesdic[dwname]=[img.get('src')]		            picnamesdic[dwname].append(img.parent.get('href'))		            print('+ \t %s '%img.get('src').split('media=')[1])		            # print('dwlink=%s'%picnamesdic[dwname])		        except:		            print('- \t\t %s '%img.get('src').split('/')[-1])		    return picnamesdic		def unescape(s):		    s = s.replace(&quot;&amp;lt;&quot;, &quot;&lt;&quot;)		    s = s.replace(&quot;&amp;gt;&quot;, &quot;&gt;&quot;)		    s = s.replace(&quot;%3A&quot;, &quot;:&quot;)		    # this has to be last:		    s = s.replace(&quot;&amp;amp;&quot;, &quot;&amp;&quot;)		    return s		def getpicurl(picname):		    # input: The name of a file uploaded on the iGEM 2015 Wiki-Server #		    # IMPOARTNT: The picture has to be uploaded before running the script! #		    # picname=input('please paste the name of an uploaded iGEM-wiki file:\n')		    # correct picname for changes the iGEM-Server needs		    picname=picname.replace(':','-' )		    # define fix url for Wiki-Sever #		    url='https://2015.igem.org/File:Freiburg_%s'%picname		    print('the url I looked for was:\n%s' %url)		    # get raw_html from url as specified here: http://stackoverflow.com/questions/17257912/how-to-print-raw-html-string-using-urllib3 #		    http_pool = urllib3.connection_from_url(url)		    r = http_pool.urlopen('GET',url)		    raw_html=r.data.decode('utf-8')		    # initialise bs-object '		    soup = BeautifulSoup(raw_html, 'html.parser')		    # find the href-link in an a-object in a div with id=file #		    try:		        serverlink='https://2015.igem.org'+soup.find(id='file').find('a').get('href')		        # return the link #		        return '%(x)s, %(y)s' % {'x': picname, 'y' : serverlink}		    except:		        return None		###################		# BEGIN PROGRAMME		###################		# ask for internal wiki site to read		dwsite=input('dwsite (in please in quotations):\t')		# get sourcecode		dwsource=getdwsource(dwsite)		# get all picture names within a href		picnamesdic=getdwpicnames(dwsource)		# initialize list of urls to download		urldic = {}		# fill the list		for key in picnamesdic:		    if getpicurl(key) == None:		        urldic[key]='/igem2015/lib/exe/fetch.php?media='+key		# download the images in the current directory (replace non usable syntax and append Freiburg_)		for url in urldic:		    r=requests.get('http://wiki.uni-freiburg.de'+urldic[url], auth=HTTPBasicAuth('dummy', 'igem2015'),  stream=True)if r.status_code == 200:		        f = open('Freiburg_'+url.replace(':','-'), 'wb')		        f.write(r.content)		        f.close()		f = open('files.txt', 'a')		for key in urldic.keys():			f.write('&quot;{}&quot;'.format(key.replace(':','-')))			f.write(', ')		f.close()</DIV></DIV></DIV></DIV><DIV class="accordion"><DIV class="accordion-section"><A class="accordion-section-title" href="#accordion-2">Presets for Selenium IDE</A><DIV id="accordion-2" class="accordion-section-content" style="display:none; padding:15px;"><DIV class="table sectionedit6"><TABLE summary="fileupload" id="fileupload"><TBODY><TR><TH>command</TH><TH>target</TH><TH>value</TH></TR><TR><TD>storeEval</TD><TD>new Array(YOURARRAY);</TD><TD>myarray</TD></TR><TR><TD>getEval</TD><TD>index=0;</TD></TR><TR><TD>while</TD><TD>index &lt; storedVars['myarray'].length</TD></TR><TR><TD>open</TD><TD>/Special:Upload</TD></TR><TR><TD>waitForPageToLoad</TD></TR><TR><TD>storeEval</TD><TD>index</TD><TD>temp</TD></TR><TR><TD>echo</TD><TD>javascript{'/home/USER/CITY_'+storedVars['myarray'][storedVars['temp']]}</TD></TR><TR><TD>type</TD><TD>id=wpUploadFile</TD><TD>javascript{'/home/USER/CITY_'+storedVars['myarray'][storedVars['temp']]}</TD></TR><TR><TD>click</TD><TD>id=wpIgnoreWarning</TD></TR><TR><TD>clickAndWait</TD><TD>name=wpUpload</TD></TR><TR><TD>getEval</TD><TD>index++;</TD></TR><TR><TD>endWhile</TD></TR></TBODY></TABLE></DIV></DIV></DIV></DIV><DIV class="accordion"><DIV class="accordion-section"><A class="accordion-section-title" href="#accordion-3">HTML for Webserver-Input</A><DIV id="accordion-3" class="accordion-section-content" style="display:none; padding:15px;"><DIV class="table sectionedit6">&lt;form method=&quot;get&quot; action=&quot;wikitranslate.py&quot;&gt;&lt;div&gt;&lt;h3&gt;Choose option:&lt;/h3&gt;&lt;input type=&quot;checkbox&quot; name=&quot;rmheaderlink&quot; value=&quot;True&quot;&gt;  Remove headerlinks&lt;br&gt;&lt;input type=&quot;checkbox&quot; name=&quot;changepicurl&quot; value=&quot;True&quot;&gt;  Change the picture links&lt;br&gt;&lt;input type=&quot;checkbox&quot; name=&quot;appendtextbefore&quot; value=&quot;True&quot;&gt;  Add preceding text &lt;br&gt;&lt;input type=&quot;checkbox&quot; name=&quot;appendtextafter&quot; value=&quot;True&quot;&gt;  Append text &lt;br&gt;&lt;input type=&quot;checkbox&quot; name=&quot;changeprotocols&quot; value=&quot;True&quot;&gt; Change protocol links &lt;br&gt;&lt;input type=&quot;checkbox&quot; name=&quot;changeregistry&quot; value=&quot;True&quot;&gt; Link registry entries &lt;br&gt;&lt;/div&gt;&lt;h3&gt;Provide information if necessary&lt;/h3&gt;&lt;div&gt;&lt;label for=&quot;dwhtml&quot;&gt;Name of an internal wiki-page (e.g. &lt;em&gt;labjournal:cellfree&lt;/em&gt;):&lt;/label&gt;&lt;input id=&quot;dwhtml&quot; name=&quot;dwsite&quot; required&gt;&lt;/textarea&gt;&lt;/div&gt;&lt;div&gt;&lt;label for=&quot;textbefore&quot;&gt;Text to precede&lt;/label&gt;&lt;textarea id='textbefore' cols=&quot;20&quot; rows=&quot;5&quot; name=&quot;textbefore&quot;&gt;						{{Freiburg/CSS}}&lt;html&gt;&lt;/textarea&gt;&lt;/div&gt;&lt;div&gt;&lt;label for=&quot;textafter&quot;&gt;Text to append&lt;/label&gt;&lt;textarea id=&quot;textafter&quot; cols=&quot;20&quot; rows=&quot;5&quot; name=&quot;textafter&quot;&gt;&lt;/html&gt;&lt;/div&gt;&lt;div&gt;&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;&lt;/div&gt;&lt;/form&gt;</DIV></DIV></DIV></DIV><DIV class="accordion"><DIV class="accordion-section"><A class="accordion-section-title" href="#accordion-4">CGI script code to be run on Webserver</A><DIV id="accordion-4" class="accordion-section-content" style="display:none; padding:15px;"><DIV class="table sectionedit6">
      		
      						#!/usr/bin/python				import cgi				form = cgi.FieldStorage() # instantiate only once!				dwsite = form.getfirst('dwsite', 'empty')				#dwsite = 'labjournal:ilab'				isrmheaderlinks=form.getfirst('rmheaderlink', False)				ischangepicurl=form.getfirst('changepicurl', False)				appendtextbefore=form.getfirst('appendtextbefore', False)				appendtextafter=form.getfirst('appendtextafter',  False)				ischangeprotocols=form.getfirst('changeprotocols', False)				isregistry=form.getfirst('changeregistry', False)				#isrmheaderlinks=True				#ischangepicurl=True				#appendtextbefore=True				#appendtextafter=True				#ischangeprotocols=True				#isregistry=True				#textbefore='some text before'				#textafter='some text after'				textbefore=form.getfirst('textbefore', '')				textafter=form.getfirst('textafter', '')				# Avoid script injection escaping the user input				dwsite = cgi.escape(dwsite)				from bs4 import BeautifulSoup # parse raw html and extract elements				import urllib3 # read html-text from url				import requests				from requests.auth import HTTPBasicAuth				import sys				from cStringIO import StringIO				import csv				#import html 				old_stdout = sys.stdout				sys.stdout = mystdout = StringIO()				# read in the dict with internal and external protocol names				protocolsdic = {}				reader = csv.DictReader(open('protocols_names.csv', 'r'))				for row in reader:				    protocolsdic[row['internal']]=row['external']				# remove empty dict entries				protocolsdic.pop('',  None)				# read in the dict with registry entries to replace				registrydic = {}				reader = csv.DictReader(open('registry_links.csv', 'r'))				for row in reader:				    registrydic[row['internal']]='&lt;a href=%(x)s&gt;%(y)s&lt;/a&gt;' % {'x' : '&quot;{}&quot;'.format(row['external']), 'y' : row['internal']}				################				# BEGIN DEFINITIONS 				################				def getdwsource(dwsite):				    # get the subsite of the internal wiki specified as site				    # use the dummy usre to provide access to the wiki				    dokuwiki=requests.get('https://wiki.uni-freiburg.de/igem2015/doku.php?id=%s&amp;do=export_xhtmlbody'%dwsite, auth=HTTPBasicAuth('dummy', 'igem2015'))				    # extract the html of the requests-object by using beautifulsoup				    soup=BeautifulSoup(dokuwiki.text,  'html.parser')				    # print('https://wiki.uni-freiburg.de/igem2015/doku.php?id=%s&amp;do=export_xhtmlbody'%site)				    return soup				def sfah(source):					# return the soup-objects of all headers					return source.findAll('h1') + source.findAll('h2') + source.findAll('h3') + source.findAll('h4') + source.findAll('h5') + source.findAll('h6')				def rmheaderlinks(soup):				    ########				    # removes the a-href links from the headers of an internal dw-file				    ########				    rmheaderlinksdic={}				    for header in sfah(soup):				    	rmheaderlinksdic[unicode(header.a)]=header.a.text				    return rmheaderlinksdic				def getdwpicnames(source):				    ########				    # returns a dict of the the names of all images in the source code as keys with the corresponding links to the image and the info-page				    ########				    picnamesdic={}				    for img in source.find_all('img'):				        # extract the name of all pictures from the src-string				        try:				            # get the name of the picnamesdic				            dwname=img.get('src').split('media=')[1]				            # use the name as key for a dict to store the links for src and href				            picnamesdic[dwname]=[img.get('src')]				            picnamesdic[dwname].append(img.parent.get('href'))				            print('+ \t %s '%img.get('src').split('media=')[1])				            # print('dwlink=%s'%picnamesdic[dwname])				        except:				            print('- \t\t %s '%img.get('src').split('/')[-1])				    return picnamesdic				def getpicurl(picname):				    # input: The name of a file uploaded on the iGEM 2015 Wiki-Server #				    # IMPORTANT: The picture has to be uploaded before running the script! #				    # picname=input('please paste the name of an uploaded iGEM-wiki file:\n')				    # correct picname for changes the iGEM-Server needs				    picname=picname.replace(':','-' )				    # define fix url for Wiki-Sever #				    url='https://2015.igem.org/File:Freiburg_%s'%picname				    #print('the url I looked for was:\n%s' %url)				    # get raw_html from url as specified here: http://stackoverflow.com/questions/17257912/how-to-print-raw-html-string-using-urllib3 #				    http_pool = urllib3.connection_from_url(url)				    r = http_pool.urlopen('GET',url)				    raw_html=r.data.decode('utf-8')  # initialise bs-object '				    soup = BeautifulSoup(raw_html, 'html.parser')				    # find the href-link in an a-object in a div with id=file #				    try:				        serverlink='https://2015.igem.org'+soup.find(id='file').find('a').get('href')				        # return the link #				        return serverlink				    except:				        return None				def unescape(s):				    s = s.replace(&quot;&amp;lt;&quot;, &quot;&lt;&quot;)				    s = s.replace(&quot;&amp;gt;&quot;, &quot;&gt;&quot;)				    # this has to be last:				    s = s.replace(&quot;&amp;amp;&quot;, &quot;&amp;&quot;)				    return s				def changeprotocols(soup):				    returndic = {}				    for link in soup.findAll('a'):				        linksource = link.get('href')				        for name in protocolsdic:				            if linksource != None:				                if unicode(name) in linksource :				                    print(unicode(name))				                # generate pairs for replacement using the absolute path for the iGEM server protocols section				                    returndic[linksource] =unicode('https://2015.igem.org/Team:Freiburg/Protocols/')+protocolsdic[name]				    return returndic				##########################				# BEGIN PROGRAMME				##########################				# set the subprogramcounter				prog_count = 0				# get the source code				dwsource=getdwsource(dwsite)				# convert it to replaceable text				exthtml=unicode(dwsource)				# initialize dic to replace elements				rpdic={}				### is rmheaderlinks ###				if isrmheaderlinks:					# compute dic to replace headerlinks					rpdic.update(rmheaderlinks(dwsource))				        prog_count+=1				### is changeprotocols ###				if ischangeprotocols:				    rpdic.update(changeprotocols(dwsource))				    prog_count+=1				### is changepicurl ###				missingimage = False				if ischangepicurl:				    picnamesdic=getdwpicnames(dwsource)				    for key in picnamesdic:				        serverlink=getpicurl(key)				        if serverlink != None:				            rpdic.update({cgi.escape(picnamesdic[key][0]):serverlink})				        else:				            missingimage = True					if picnamesdic[key][1]:				        	rpdic.update({cgi.escape(picnamesdic[key][1]):serverlink})				    prog_count+=1				### is registry ###				if isregistry:				    rpdic.update(registrydic)				    prog_count+=1				### cancel output if no program was called ###				if prog_count == 0:				    sys.exit(0)				### replacing ###				exthtmlold = exthtml				for text in rpdic.keys():				#    exthtml = exthtml.replace(cgi.escape(text),unescape(rpdic[text]))				    exthtml = exthtml.replace(text,rpdic[text])				sys.stdout=old_stdout				if not missingimage:				    print &quot;Content-Disposition: attachment; filename=\&quot;%s.html\&quot;\r\n\n&quot;%dwsite				    if appendtextbefore:				    	print(textbefore.encode('utf8'))				    print(exthtml.encode('utf8'))				    if appendtextafter:				    	print(textafter.encode('utf8'))				else:				    print &quot;Content-type: text/html \n&quot;				    print('There is an image missing!!')
      			
    	</DIV></DIV></DIV></DIV><DIV class="tags"><SPAN><A class="wikilink1" href="/igem2015/doku.php?id=tag:info&amp;do=showtag&amp;tag=info" rel="tag" title="tag:info">info</A></SPAN></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>