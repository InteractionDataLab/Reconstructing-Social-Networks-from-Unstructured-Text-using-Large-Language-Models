<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Paris_Bettencourt_Modeling skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Paris Bettencourt/Modeling</SPAN></H1><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><DIV id="mainContainer"><DIV id="menuContainer"><DIV id="smallMenuTitle"><H1>Ferment It Yourself</H1><H3>iGEM Paris-Bettencourt 2O15</H3></DIV><UL><LI class="left"><A href="https://2015.igem.org/Team:Paris_Bettencourt/Background" title="Background">Background</A></LI><LI class="left"><A href="https://2015.igem.org/Team:Paris_Bettencourt/Design" title="Design">Design</A></LI><LI class="left"><BUTTON class="menuButton">Project</BUTTON></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Project/Micronutrients">Micronutrients</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Project/Continuity">Continuity</A></LI><DIV class="subright"><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Modeling">Modeling</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Project/Manufacturing">Manufacturing</A></LI></DIV></UL><LI class="left"><BUTTON class="menuButton">Achievements</BUTTON></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Results">Results</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Parts">Parts</A></LI></DIV><DIV class="subright"><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Medals">Medal Fulfillments</A></LI></DIV><LI class="right"><BUTTON class="menuButton">Practices</BUTTON></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Practices">Overview</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Practices/SynBio_Challenge">SynBio Challenge</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Practices/DILambda">DIλ</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Acceptance">Acceptance</A></LI></DIV><DIV class="subright"><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Practices/Events">Events</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Practices/Rhizi">Rhizi</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Collaborations">Collaborations</A></LI></DIV><LI class="right"><BUTTON class="menuButton">Safety</BUTTON></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Safety">Safety Overview</A></LI><LI><A href="https://2015.igem.org/Safety/Final_Safety_Form?team_id=1678">Safety Form</A></LI></DIV><DIV class="subright"><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/ReviewBoard">Review Board</A></LI></DIV><LI class="right"><BUTTON class="menuButton">Notebook</BUTTON></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Notebook">Daily notebook</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Protocols">Protocols</A></LI></DIV><DIV class="subright"><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Bibliography">Bibliography</A></LI></DIV><LI class="right"><BUTTON class="menuButton">Team</BUTTON></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Team">Members</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Attributions">Attributions</A></LI><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Acknowledgments">Acknowledgments</A></LI></DIV><DIV class="subright"><LI><A href="https://2015.igem.org/Team:Paris_Bettencourt/Press">Press</A></LI><LI><A href="https://igem.org/Team.cgi?id=1678">Official Team Profile</A></LI></DIV></DIV><DIV id="modeling"><DIV class="contentContainer"><DIV id="banner"><H3>Modeling
</H3></DIV></DIV><DIV class="textWrapper"><DIV class="textContent {{{page_option}}}" id="caffeine"><H1>Modeling</H1><H2>Introduction</H2><DIV class="column-left">
Based on a set of ordinary differential equations (ODE) describing the kinetics of cell differentiation, we designed a model to find the best differentiation rate.

First we developed a deterministic algorithm based on the ordinary differential equation.

Then we found out that a stochastic algorithm could be another solution to solve our problem.
</DIV><DIV class="column-right">
For a system involving large cell counts, the ordinary differential equations model gives an accurate representation of the behavior. But with small cell counts, the stochastic and discrete method has a significant influence on the observed behaviour.

This led us to write both a deterministic program based on the mass action law and a stochastic program based on Gillespie’s stochastic simulation algorithm (SSA). With these two programs we obtain an accurate analysis of vitamin production.
</DIV><H2>Deterministic model</H2><H3>Parameters</H3>
We conceived a simple model with the minimum number of parameters.

We found seven significant parameters for our model.
<UL><LI>\(t\) : fermentation period.</LI><LI>\(k_{1}\) : rate constant of the mother cell differentiation.</LI><LI>\(k_{2}\) : rate constant of the mother cell doubling time.</LI><LI>\(k_{3}\) : rate constant of the differentiated cell doubling time.</LI><LI>\(k_{4}\) : rate constant of the differentiated cell vitamin production.</LI><LI>\(MC_{0}\) : initial number of mother cells in the medium.</LI><LI>\(DC_{0}\) : initial number of differentiated cells in the medium.</LI></UL><H3>Kinetic equations</H3>
We wrote four simple kinetic equations.

\[
\begin{align}
MC \xrightarrow[]{k_{1}} DC
\\
MC \xrightarrow[]{k_{2}} 2.MC
\\
DC \xrightarrow[]{k_{3}} 2.DC
\\
DC \xrightarrow[]{k_{4}} DC + Vitamin
\end{align}
\]

<H3>Formal mathematical solution</H3><H4>Translation in ordinary differential equations</H4>
We used the law of mass action to write the ordinary differential equations based on kinetic equations \((1)\), \((2)\), \((3)\) and \((4)\).

We found the following equations.

\[
\begin{align}
\frac{dMC}{dt}(t) = (k_{2} - k_{1}).MC(t)
\end{align}
\]

\[
\begin{align}
\frac{dDC}{dt}(t) = k_{1}.MC(t) + k_{3}.DC(t)
\end{align}
\]

\[
\begin{align}
\frac{dVitamin}{dt}(t) = k_{4}.DC(t) \Rightarrow Vitamin(t) = k_{4}.\int_{0}^{t}{DC(t').dt'}
\end{align}
\]

<H4>Mathematical resolution</H4>
Simple ordinary differential equations' resolution methods are used to find the solutions of the previous equations \((5)\), \((6)\), and \((7)\).

We expressed the time evolution of the mother cell, differentiated cell and vitamin number.

\[
\begin{align}
MC(t) = MC_{0}.e^{(k_{2} - k_{1}).t}
\end{align}
\]



\[
\begin{align}
DC(t) = 
\begin{cases}
DC_{0}.e^{k_{3}.t} + MC_{0}.\frac{k_{1}}{k_{2}-k_{1}-k_{3}}.(e^{(k_{2} - k_{1}).t} - e^{k_{3}.t}) &amp; \mbox{if } k_{1} \ne k_{3} - k_{2}
\\
\\
(MC_{0}.(k_{2} - k_{3}).t + DC_{0}).e^{k_{3}.t} &amp; \mbox{if } k_{1} = k_{3} - k_{2}
\end{cases}
\end{align}
\]



\[
\begin{align}
Vitamin(t) = 
\begin{cases}
DC_{0}.\frac{k_{4}}{k_{3}}.(e^{k_{3}.t} - 1) + MC_{0}.\frac{k_{4}.k_{1}}{(k_{2}-k_{1}-k_{3}).(k_{2} - k_{1})}.(e^{(k_{2} - k_{1}).t} - 
1) + MC_{0}.\frac{k_{4}.k_{1}}{(k_{2}-k_{1}-k_{3}).k_{3}}.(1 - e^{k_{3}.t}) &amp; \mbox{if } k_{1} \ne k_{3} - k_{2}
\\
\\
DC_{0}.\frac{k_{4}}{k_{3}}.(e^{k_{3}.t} - 1) + MC_{0}.\frac{k_{4}}{k_{3}}.(k_{3}.t - 1).(\frac{k_{2}}{k_{3}} - 1).(e^{k_{3}.t} - 1) +  
MC_{0}.\frac{k_{4}}{k_{3}}.(\frac{k_{2}}{k_{3}} - 1) &amp; 
\mbox{if } k_{1} = k_{3} - k_{2}
\end{cases}
\end{align}
\]

<H3>Vitamin optimization</H3>
Our goal is to optimize the vitamin production. We can only change three parameters : \(k_{1}\), \(MC_0\) and \(DC_0\).

\(t\), \(k_{2}\), \(k_{3}\) and \(k_{4}\) are constants. \(MC_0\) and \(DC_0\) are not relevant parameters. It seems logical that the 
more cells are in the medium, the more vitamins are produced.

However, it could be interesting to compare different \(\frac{MC_0}{DC_0}\) ratios but we prefer to focus on the rate constant \(k_{1}\).

We try to find the best \(k_{1}\). To this end we maximize the vitamin function numerically with MATLAB.

As an example, let's consider the following parameters.
<UL><LI>\(t = 10 \phantom{t} (hours)\)</LI><LI>\(k_{2} = 0.66 \phantom{t} (hours^{-1})\)</LI><LI>\(k_{3} = 0.33 \phantom{t} (hours^{-1})\)</LI><LI>\(k_{4} = 1 \phantom{t} (hours^{-1})\)</LI><LI>\(MC_0 = 5 \phantom{t} (cells)\)</LI><LI>\(DC_0 = 0 \phantom{t} (cells)\)</LI></UL>
We obtain the following graph with a simple MATLAB program available on the software section.
<P style="text-align:center"><B>Figure 1 :</B> Deterministic vitamin optimization.</P>
As you can see, we are able to find the best \(k_{1}\) to optimize the vitamin production.

We noticed that two different \(k_{1}\) exist to optimize the maximum number of differentiated cell \(DC\) or the maximum number of \(Vitamin\).

In our case, we chose of course the \(k_{1}\) that optimizes the vitamin production <I>i.e.</I> \(k_{1} = 0.207 \phantom{t} (hours^{-1})\).
<H3>Deterministic evolution of mother cell, differentiated cell and vitamin numbers</H3>
We wrote a deterministic algorithm with MATLAB using the previous solutions \((8)\), \((9)\) and \((10)\). For those interested, the source code is available on the software section.

In order to optimize the vitamin production, we use the same parameters as previously and set \(k_{1}\) with the previous resulting value <I>i.e.</I> \(k_{1} = 
0.207 \phantom{t} (hours^{-1})\).

We obtain the following graph.
<P style="text-align:center"><B>Figure 2 :</B> Deterministic evolution of the system.</P>
As you can see, the mother cell, the differentiated cell and the vitamin numbers follow an exponential law of time.

This result seems relevant. The model does not take into account the cells' death and the nutrients present in the medium.
<H2>Stochastic model</H2><H3>Parameters</H3>
We used more parameters than the deterministic model. Indeed, because of the nature of the algorithm, we need a constant rate probability distribution.

In order to do a simulation with laboratory data, we modelize the time probability distribution with a normalized Gaussian distribution using the <A href="http://fr.mathworks.com/help/stats/normrnd.html">normrnd</A> MATLAB function.

For each time distribution \(i\), we use the following time probability distribution.
\[
\begin{align}
\mathcal P_{i}(t) = \frac{1}{\sigma_{i}.\sqrt{2\pi}}.e^{\frac{-(t - \mu_{i})^2}{2.\sigma_{i}^2}}
\end{align}
\]

where
<UL><LI>\(\mathcal P_{i}(t)\) : time \(t\) probability.</LI><LI>\(\mu_{i}\) : time mean.</LI><LI>\(\sigma_{i}\) : time standard deviation.</LI></UL>

Rate constants for the time distribution \(i\) are calculated using the following formula.
\[
\begin{align}
k_{i} = \frac{ln(2)}{t}
\end{align}
\]

The time \(t\) is a random variable with a probability \(\mathcal P_{i}(t)\) as explained above.


The vitamin number is computed by numerical integration using the rate constant \(k_{4}\).

We have ten parameters for this model.
<UL><LI>\(t\) : fermentation period.</LI><LI>\(\mu_{1}\) : mother cell differentiation time mean.</LI><LI>\(\sigma_{1}\) : mother cell differentiation time standard deviation.</LI><LI>\(\mu_{2}\) : mother cell doubling time mean.</LI><LI>\(\sigma_{2}\) : mother cell doubling time standard deviation.</LI><LI>\(\mu_{3}\) : differentiated cell doubling time mean.</LI><LI>\(\sigma_{3}\) : differentiated cell doubling time standard deviation.</LI><LI>\(k_{4}\) : rate constant of the differentiated cell vitamin production.</LI><LI>\(MC_0\) : initial number of mother cells in the medium.</LI><LI>\(DC_0\) : initial number of differentiated cells in the medium.</LI></UL><H3>Algorithm</H3><H4>Introduction</H4>

In the program, each cell is a structure containing three elements.
<UL><LI>The cell type.
		</LI><LI>1 : mother cell.</LI><LI>2 : differentiated cell.</LI></UL><LI>The next event type.
		</LI><LI>1 : a mother cell becomes a differentiated cell.</LI><LI>2 : a mother cell divides into two mother cells.</LI><LI>3 : a differentiated cell divides into two differentiated cells.</LI><LI>The time before the next event.</LI>
The time \(T_{i}\) for an event is chosen thanks to the equation \((11)\).

There is a competition between the first two events concerning the mother cell.

Either the mother cell differentiates or it divides into two differentiated cells.

To do the choice we compare \(T_{1}\) and \(T_{2}\). The smallest time is the next event time.
<H4>Step 1 : Initialize the cells.</H4>
First of all we have to generate the first cells in accordance with \(MC_0\) and \(DC_0\).

For each cell we set the cell type, the next event and the time before the next event.
<H4>Step 2 : Choose the next event among all cells.</H4>
We have an array containing all the cells. Each cell contains the time before its next event (divide or differentiate).

The next event time processed by the algorithm is the smallest cell next event time.
<H4>Step 3 : Do the next event.</H4>
Now that we know the next event type and the concerned cell (only one cell is involved here), we compute this event.

As explained above, we have three choices.

If the cell is a mother cell, the cell can divide or differentiate.

If the cell is a differentiated cell, the cell can only divide.

We define a new event and time event for the cell and for the new cell in case of division.

We also performed the number of vitamin calculus by numerically integrating the number of \(DC\).

We use the following formula.

\[
\begin{align}
Vitamin(t) = Vitamin(t-T_{i}) + k_{4}.DC(t).T_{i}
\end{align}
\]

where
<UL><LI>\(Vitamin(t)\) : number of vitamin at the instant \(t\).</LI><LI>\(DC(t)\) : number of differentiated cells in the medium at the instant \(t\).</LI><LI>\(T_{i}\) : time of the next event being performed.</LI><LI>\(k_{4}\) : rate constant of the differentiated cell vitamin production.</LI></UL><H4>Step 4 : Update the simulation time.</H4>
For each cell except the concerned cell, define the cell next event time with the following formula.

\[
\begin{align}
T_{event \phantom{t} cell} = T_{event \phantom{t} cell} - T_{i}
\end{align}
\]

where
<UL><LI>\(T_{i}\) : time of the next event being performed.</LI><LI>\(T_{event \phantom{t} cell}\) : cell next time event.</LI></UL><H4>Step 5 : Go to step 2 until the simulation time is superior to the fermentation period.</H4>
We do this process until the simulation time is superior to the fermentation period.
The number of cells increases with an exponential law. The computational power increases with the same law.

Do not try to process a long simulation time if your computer is not powerful.
<H4>Step 6 : Show the results.</H4>
Here is a graph generated by the stochastic algorithm.
<P style="text-align:center"><B>Figure 3 :</B> Stochastic evolution of the system.</P>

With the following distribution of event time probability.
<P style="text-align:center"><B>Figure 4 :</B> Distribution of event time probability.</P><H3>Vitamin optimization</H3>
Like the deterministic model our goal is to maximize the vitamin production.

In order to get relevant results, we average by doing a large number of simulations specified by the \(Averaging\) \(number\) parameter.

We can only change three parameters : \(\mu_{1}\), \(MC_0\) and \(DC_0\).

\(t\), \(\sigma_{1}\), \(\mu_{2}\), \(\sigma_{2}\),  \(\mu_{3}\), \(\sigma_{3}\) and \(k_{4}\) are constants.

We try to find the best \(\mu_{1}\) to maximize the vitamin production.

As an example we can consider the following parameters.
<UL><LI>\(t = 5 \phantom{t} (hours)\)</LI><LI>\(Averaging\) \(number = 500\)</LI><LI>\(\sigma_{1} = 0.1 \phantom{t} (hours)\)</LI><LI>\(\mu_{2} = 1.0502 \phantom{t} (hours)\)</LI><LI>\(\sigma_{2} = 0.1 \phantom{t} (hours)\)</LI><LI>\(\mu_{3} = 2.1004 \phantom{t} (hours)\)</LI><LI>\(\sigma_{3} = 0.1 \phantom{t} (hours)\)</LI><LI>\(k_{4} = 1 \phantom{t} (hours^{-1})\)</LI><LI>\(MC_0 = 5 \phantom{t} (cells)\)</LI><LI>\(DC_0 = 0 \phantom{t} (cells)\)</LI></UL>
We obtain the following graph.
<P style="text-align:center"><B>Figure 5 :</B> Stochastic vitamin optimization.</P>
Here is a deterministic vitamin optimization.
<P style="text-align:center"><B>Figure 6 :</B> Deterministic vitamin optimization.</P>
We can compare the two results by superimposing the two graphs.
<P style="text-align:center"><B>Figure 7 :</B> Comparison of deterministic and stochastic vitamin optimization.</P>
We performed a cross-correlation and found correlation coefficients between the two graphs with the <A href="http://fr.mathworks.com/help/signal/ref/xcorr.html">xcorr</A> and <A href="http://fr.mathworks.com/help/images/ref/corr2.html">corr2</A> MATLAB functions.
<P style="text-align:center"><B>Figure 8 :</B> Deterministic and stochastic cross-correlation and correlation coefficients.</P>
As described in the <A href="http://fr.mathworks.com/help/images/ref/corr2.html">official MATLAB website</A>, the \(DC\) and \(Vitamin\) correlation coefficients are computed with the following formula.


\[
\begin{align}

DC \phantom{t} correlation \phantom{t} coefficient = \frac{\sum\limits^{}_{k_{1}} (DC_{d}(k_{1}) - \overline{DC_{d}}).(DC_{s}(k_{1}) - \overline{DC_{s}})}
{\sqrt{\left(\sum\limits^{}_{k_{1}} (DC_{d}(k_{1}) - \overline{DC_{d}})^2 \right).\left(\sum\limits^{}_{k_{1}} (DC_{s}(k_{1}) - \overline{DC_{s}})^2 \right)}}

\end{align}
\]



\[
\begin{align}

Vitamin \phantom{t} correlation \phantom{t} coefficient = \frac{\sum\limits^{}_{k_{1}} (Vitamin_{d}(k_{1}) - \overline{Vitamin_{d}}).(Vitamin_{s}(k_{1}) - \overline{Vitamin_{s}})}
{\sqrt{\left(\sum\limits^{}_{k_{1}} (Vitamin_{d}(k_{1}) - \overline{Vitamin_{d}})^2 \right).\left(\sum\limits^{}_{k_{1}} (Vitamin_{s}(k_{1}) - \overline{Vitamin_{s}})^2 \right)}}

\end{align}
\]


The \(DC\) and \(Vitamin\) cross-correlation are computed with these equations.


\[
\begin{align}

DC \phantom{t} cross\text{-}correlation(k_{1}') = \sum\limits^{}_{k_{1}} DC_{d}(k_{1}).DC_{s}(k_{1} + k_{1}')

\end{align}
\]

\[
\begin{align}

Vitamin \phantom{t} cross\text{-}correlation(k_{1}') = \sum\limits^{}_{k_{1}} Vitamin_{d}(k_{1}).Vitamin_{s}(k_{1} + k_{1}')

\end{align}
\]

where
<UL><LI>\(DC_{d}(k_{1})\) : deterministic \(DC\) function of \(k_{1}\).</LI><LI>\(DC_{s}(k_{1})\) : stochastic \(DC\) function of \(k_{1}\).</LI><LI>\(Vitamin_{d}(k_{1})\) : deterministic \(Vitamin\) function of \(k_{1}\).</LI><LI>\(Vitamin_{s}(k_{1})\) : stochastic \(Vitamin\) function of \(k_{1}\).</LI></UL><H2>Conclusion</H2>

As we can see, the stochastic and the deterministic models provide <I>a priori</I> different results.
It seems logical because of the statistical nature of the problem.

However, the comparison of the two graphs gives us useful and accurate information about the vitamin optimization.

Because of small cell counts, the stochastic and discrete method has a significant influence on the observed behaviour.
<I>In vivo</I>, the cell population likely follows the stochastic model.
We are waiting for laboratory results to confirm or disprove our model.

We are able to maximize the vitamin production by determining the best rate constant \(k_{1}\) and therefore the best doubling time \(\mu_{1}\) to set the differentiation rate.
<H1>Software</H1><H2>Introduction</H2>
As explained in the modeling section, this program models the cell population evolution with mother cell differentiation and cell division.

In order to make this model and code accessible, understandable and editable by everyone, we have created this software section.

We focus here on the stochastic program.

<H2>Files</H2>
The MATLAB code is available on <A href="https://github.com/iGEMParisBettencourt2015/modeling" title="Source code in GitHub">GitHub</A> under the GNU General Public License version 3.0.

Feel free to download the source code, modify it and make it accessible for everyone.


Here is a quick explanation of the different files <I>i.e.</I> the different functions.
<H3>Stochastic algorithm</H3><UL><LI>\(timeEvolutionStochastic\) : calculate the time evolution.</LI><LI>\(checkInput\) : check the input and show an error message if the input is not good.</LI><LI>\(elmPixel\) : find the coordinates of a pixel around another pixel.</LI><LI>\(errorProgramm\) : display an error and stop the program.</LI><LI>\(freePosition\) : create a list of free pixels around one pixel.</LI><LI>\(getComputerName\) : get the computer name.</LI><LI>\(getSizeMat\) : find the matrix size.</LI><LI>\(imageToMatrix\) : convert an image into a matrix.</LI><LI>\(initCells\) : initialize the cells.</LI><LI>\(initialization\) : initialize the program.</LI><LI>\(initTimeEvent\) : calculate the different time.</LI><LI>\(initVariables\) : initialize the variables.</LI><LI>\(isBinary\) : check if a number is 0 or 1.</LI><LI>\(isPositiveInteger\) : check if a number is a positive integer (1) or not (0).</LI><LI>\(makeCells\) : make the cells.</LI><LI>\(randEvent\) : generate the next random event.</LI><LI>\(randPosition\) : find a free position for a cell.</LI><LI>\(saveInitialParameters\) : save the initial parameters in a text file.</LI><LI>\(saveResult\) : save and plot the results.</LI><LI>\(showAndSaveEventTimeDistribution\) : show and save the event time probability distribution.</LI><LI>\(showPopulation\) : show the cells matrix.</LI><LI>\(writeParameters\) : write a text file with the parameters.</LI><LI>\(launchStochasticProgramm\) : launch the stochastic time evolution simulation.</LI><LI>\(k1OptimizationStochastic\) : calculate the number of differentiated cells and vitamin with different \(k_{1}\) in a stochastic way.</LI><LI>\(k1OptimizationStochasticAndDeterministic\) : superimpose the deterministic and stochastic models.</LI></UL><H3>Deterministic algorithm</H3><UL><LI>\(timeEvolutionDeterministic\) : show the time evolution by numerical calculus and equations.</LI><LI>\(k1OptimizationDeterministic\) : calculate the number of differentiated cells with different \(k_{1}\) in a deterministic way.</LI></UL><H2>Input</H2>
In order to launch a simulation, you must define five variables.
<UL><LI>Initial cells.</LI><LI>Rate constants.</LI><LI>Fermentation period.</LI><LI>Action.</LI><LI>Folder name.</LI></UL><H3>Cells input</H3>
You can choose to generate a random or a predetermined position for the initial cells.

You have two cell types : mother cells and differentiated cells.
<H4>Random initial position</H4>
The input array must contain four integer values in this order.
<UL><LI>\(MC_0\) : initial number of mother cells in the medium.</LI><LI>\(DC_0\) : initial number of differentiated cells in the medium.</LI><LI>\(sizeMatCell\) : cells box size (in pixels).</LI><LI>\(sizeMat\) : real box size (in pixels).</LI></UL>
Warning : \(sizeMatCell\) must be larger than \(sizeMat\).


In the program, the input variable has the following pattern.

\(input = [MC_0, DC_0, sizeMatCell, sizeMat]\)

Here is an example.
<UL><LI>\(MC_0 = 5 \phantom{t} (cells)\)</LI><LI>\(DC_0 = 0 \phantom{t} (cells)\)</LI><LI>\(sizeMatCell = 100 \phantom{t} (pixels)\)</LI><LI>\(sizeMat = 250 \phantom{t} (pixels)\)</LI></UL><H4>Predetermined initial position</H4>
In order to make an easy predetermined initial position input, we wrote a code that understands images.

The input must contain the image path.

It is very easy to design a custom image <I>i.e.</I> a custom spatial cell distribution. You must follow these four rules (we work only with the image red component)
<UL><LI>the image must be square and in jpeg format.</LI><LI>255 means no cell.</LI><LI>128 means one differentiated cell.</LI><LI>0 means one mother cell.</LI></UL>
0, 128 and 255 are red components of any colours that you want because the MATLAB code take into account only the image red component.

If you want, you can use the following hexadecimal colors codes.
<UL><LI>#FFFFFF (white) means no cell.</LI><LI>#800000 (red) means one differentiated cell.</LI><LI>#000000 (black) means one mother cell.</LI></UL>
Here is an example only with mother cells.
<P><B>Figure 9 :</B> Example of predetermined cells initial position with mother cells.</P>
Here is another example with mother cells (black) and differentiated cells (red).
<P><B>Figure 10 :</B> Example of predetermined cells initial position with mother cells (black) and differentiated cells (red).</P><H3>Rate constants</H3>
You have to define seven variables.
<UL><LI>\(\mu_{1}\) : mother cell differentiation time mean.</LI><LI>\(\sigma_{1}\) : mother cell differentiation time standard deviation.</LI><LI>\(\mu_{2}\) : mother cell doubling time mean.</LI><LI>\(\sigma_{2}\) : mother cell doubling time standard deviation.</LI><LI>\(\mu_{3}\) : differentiated cell doubling time mean.</LI><LI>\(\sigma_{3}\) : differentiated cell doubling time standard deviation.</LI><LI>\(k_{4}\) : rate constant of the differentiated cell vitamin production.</LI></UL>
In the program, the rate constants variable has the following pattern.

\(constantRate = [\mu_{1}, \sigma_{1}, \mu_{2}, \sigma_{2}, \mu_{3}, \sigma_{3}, k_{4}]\)

Here is an example.
<UL><LI>\(\mu_{1} = 1 \phantom{t} (hours)\)</LI><LI>\(\sigma_{1} = 0.1 \phantom{t} (hours)\)</LI><LI>\(\mu_{2} = 1.0502 \phantom{t} (hours)\)</LI><LI>\(\sigma_{2} = 0.1 \phantom{t} (hours)\)</LI><LI>\(\mu_{3} = 2.1004 \phantom{t} (hours)\)</LI><LI>\(\sigma_{3} = 0.1 \phantom{t} (hours)\)</LI><LI>\(k_{4} = 1 \phantom{t} (hours^{-1})\)</LI></UL><H3>Fermentation period</H3>
The fermentation period \(t\) is a simple scalar variable.

You can use \(t = 5 \phantom{t} (hours)\) for example.
<H3>Action</H3>
In order to choose what you want to do, you must define three Boolean variables.
<UL><LI>\(createFolder\) : create a folder in the disk to save information.</LI><LI>\(showAnimation\) : show the cell population animation. Warning : requires a lot of computing power.</LI><LI>\(plotGraph\) : plot the results in graphs.</LI></UL>
In the program, the action variable has the following pattern.

\(action = [createFolder, showAnimation, plotGraph\)]

In the following example we want to create a folder and plot the graphs.
<UL><LI>\(createFolder = 1\)</LI><LI>\(showAnimation = 0\)</LI><LI>\(plotGraph = 1\)</LI></UL>
In the following example we want to show the cell animation.
<UL><LI>\(createFolder = 0\)</LI><LI>\(showAnimation = 1\)</LI><LI>\(plotGraph = 0\)</LI></UL>
In the following example we want to show the cell animation and save the images in a folder.

With the images you can create gif animations.
<UL><LI>\(createFolder = 1\)</LI><LI>\(showAnimation = 1\)</LI><LI>\(plotGraph = 0\)</LI></UL><H3>Folder name</H3>
The \(folderName\) variable is a string containing the folder name where results folder are stored in the disk.

You can use \(folderName =\) '\(Results\)' for example.

<H2>Output</H2>
Four types of output are generated.
<UL><LI>raw data : all the useful information.</LI><LI>folder creation : if chosen in the \(action\) variable a folder is created.</LI><LI>graphs : if chosen in the \(action\) variable graphs are generated.</LI><LI>animation : if chosen in the \(action\) variable cell animation is generated.</LI></UL><H3>Raw data</H3><UL><LI>\(mainTic\) : start of the program.</LI><LI>\(MC_0\) : initial number of mother cells in the medium.</LI><LI>\(DC_0\) : initial number of differentiated cells in the medium.</LI><LI>\(pasDistributionTimeEvent\) : resolution for the graph time event distribution plot (see the \(initVariables\) function).</LI><LI>\(frameRate\) : animation frame rate (see the \(initVariables\) function).</LI><LI>\(timeShowPopulation\) : simulation time between two animations (see the \(initVariables\) function).</LI><LI>\(simulationTime\) : fermentation period \(t\).</LI><LI>\(resultFolderName\) : folder where the results folder are created.</LI><LI>\(\mu_{1}\) : mother cell differentiation time mean.</LI><LI>\(\sigma_{1}\) : mother cell differentiation time standard deviation.</LI><LI>\(\mu_{2}\) : mother cell doubling time mean.</LI><LI>\(\sigma_{2}\) : mother cell doubling time standard deviation.</LI><LI>\(\mu_{3}\) : differentiated cell doubling time mean.</LI><LI>\(\sigma_{3}\) : differentiated cell doubling time standard deviation.</LI><LI>\(k_{4}\) : rate constant of the differentiated cell vitamin production.</LI><LI>\(cVitamin\) : vitamin counter.</LI><LI>\(time\) : main timer containing the simulation time.</LI><LI>\(createFolder\) : action boolean.</LI><LI>\(showPopulationBool\) : action boolean.</LI><LI>\(plotGraph\) : action boolean.</LI><LI>\(input\) : input array.</LI><LI>\(cTime1\) : time distribution counter 1 (see the \(randEvent\) function).</LI><LI>\(cTime2\) : time distribution counter 2 (see the \(randEvent\) function).</LI><LI>\(cTime3\) : time distribution counter 3 (see the \(randEvent\) function).</LI><LI>\(counterEvent\) : event counter.</LI><LI>\(timerShow\) : time animation counter.</LI><LI>\(sizeMat\) : real box size (in pixels).</LI><LI>\(nextEvent\) : next event type.</LI><LI>\(time1Array\) : time distribution array 1 (see the \(initTimeEvent\) function).</LI><LI>\(time2Array\) : time distribution array 2 (see the \(initTimeEvent\) function).</LI><LI>\(time3Array\) : time distribution array 3 (see the \(initTimeEvent\) function).</LI><LI>\(cell\) : structure containing all the cells' information.</LI><LI>\(sizeMatCell\) : cells box size (in pixels).</LI><LI>\(timeNextEvent\) : time before the next event.</LI><LI>\(saveTime\) : array containing the simulation time evolution.</LI><LI>\(saveNbrMC\) : array containing the mother cells time evolution.</LI><LI>\(saveNbrDC\) : array containing the differentiated cells time evolution.</LI><LI>\(saveNbrVitamin\) : array containing the vitamin time evolution.</LI><LI>\(folderName\) : folder where the results are stored. The pattern is the following : \(resultFolderName/DD-MM-YY\_hh\_mm\_ss\_mss\).</LI><LI>\(imgType\) : image type (see the \(initialization\) function).</LI><LI>\(parametersFileName\) : parameters file name where the parameters are saved (see the \(initialization\) function).</LI><LI>\(parametersDoc\) : file object where the parameters are saved.</LI><LI>\(maxMC\) : maximum number of mother cells.</LI><LI>\(maxDC\) : maximum number of differentiated cells.</LI><LI>\(maxVitamin\) : maximum number of vitamins.</LI><LI>\(timeSpent\) : computation time (in seconds).</LI></UL><H3>Folder creation</H3>
If the \(action\) variable \(createFolder\) is set, the program will save important results in this folder.
<UL><LI>\(parameters.txt\) : text file containing different simulation parameters and results.</LI><LI>\(data.mat\) : MATLAB file containing the raw data structure. To load the file, use this formula : \(load('data.mat')\).</LI></UL><H3>Graphs</H3>
If the \(action\) variable \(plotGraph\) is set, the program will show the graphs.

Moreover, if the \(action\) variable \(createFolder\) is set, the program will save the graphs in the folder.

<H3>Animation</H3>
If the \(action\) variable \(showAnimation\) is set, the program will show the cell animation.

Moreover, if the \(action\) variable \(createFolder\) is set, the program will save the images in the folder.

<H2>Examples</H2>
We present here some results obtained with the program. For more details about the model sees the modeling section.

<H3>Time evolution of mother cells, differentiated cells and vitamin</H3><H4>Graphs</H4>
As explained in the modeling section the program give these results.
<P style="text-align:center"><B>Figure 11 :</B> Stochastic evolution of the system.</P><P style="text-align:center"><B>Figure 12 :</B> Stochastic vitamin optimization.</P><P style="text-align:center"><B>Figure 13 :</B> Distribution of event time probability.</P><H4>Animation</H4>
Here is an example with mother cells (black) and differentiated cells (red).

This image is the cell input.
<P><B>Figure 14 :</B> Example of predetermined cells initial position with mother cells (black) and differentiated cells (red).</P>
The result is the following animation after a conversion in a gif file.

The mother cells are in orange and the differentiated cells are in yellow.
<P><B>Figure 15 :</B> Animation example with predetermined cells initial position with mother cells and differentiated cells.</P><H3>Vitamin optimization</H3>
This program is designed to maximize the vitamin production. Here are some results.
<P style="text-align:center"><B>Figure 16 :</B> Stochastic vitamin optimization.</P><H3>Deterministic and stochastic vitamin optimization comparison</H3>
Here is a comparison between the two models.
<P style="text-align:center"><B>Figure 17 :</B> Comparison of deterministic and stochastic vitamin optimization.</P><H2>Conclusion</H2>
Feel free to use and modify this program. The source code is available on <A href="https://github.com/iGEMParisBettencourt2015/modeling" title="Source code in GitHub"> GitHub : iGEM Paris Bettencourt 2015</A> under the <A href="http://www.gnu.org/licenses/gpl.txt" alt="GNU General Public License">GNU General Public License version 3.0</A>.
For more information concerning the model see the modeling section.




</DIV></DIV></DIV></BODY></HTML>