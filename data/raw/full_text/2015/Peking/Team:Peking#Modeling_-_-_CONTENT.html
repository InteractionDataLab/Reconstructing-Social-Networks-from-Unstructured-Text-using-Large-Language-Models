<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Peking_Modeling skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Peking/Modeling</SPAN></H1><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><DIV id="container"><HEADER class="clearfix"><DIV class="navbar navbar-default navbar-top"><DIV class="container"><DIV class="navbar-collapse collapse" style="padding-top:5px;padding-bottom:0"><UL class="nav navbar-nav navbar-right " style="padding-bottom:15px;padding-top:10px"><LI><A href="https://2015.igem.org/Team:Peking/JudgingCriteria">Achievements</A></LI><LI><A href="https://2015.igem.org/Team:Peking/JudgingCriteria">Judging Criteria</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Parts">Parts</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Collaborations">Collaborations</A></LI></UL><LI><A href="https://2015.igem.org/Team:Peking/Design">Project</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Design">Overview</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Design/PC_Reporter">Paired <SPAN style="text-transform:lowercase">d</SPAN>Cas9 Reporter</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Design/Isothermal">Iso-<SPAN style="text-transform:lowercase">t</SPAN>hermal Amplification</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Device">Hardware</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Design/Speculation">Speculation</A></LI><LI><A class="active" href="https://2015.igem.org/Team:Peking/Modeling">Modeling</A></LI><LI><A class="active" href="https://2015.igem.org/Team:Peking/Modeling">Array Design</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Modeling/Analysis">Analysis Algorithm</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Practices">Practices</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Practices">Overview</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Practices/Background">Facts about TB</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Practices/Consultation">Consultation and Interview</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Practices/Engagement">Public Engagement</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Practices/Outreach">Ethics and Economics Issue</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Team">Lab</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Team">Team</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Notebook">Notebook</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Attributions">Attributions</A></LI><LI><A href="https://2015.igem.org/Team:Peking/Safety">Safety</A></LI></DIV></DIV></DIV></HEADER><DIV class="page-banner"><DIV class="container"><DIV class="row"><DIV class="col-md-6"><H2 style="font-size:20px; margin-bottom:5px; padding-bottom:0">M<SPAN style="text-transform:lowercase">odeling</SPAN></H2><P style="margin-top:0px;font-size:14px" id="Modeling-Overview">The purpose of models is not to fit the data but to sharpen the questions. </P></DIV><DIV class="col-md-6"><UL class="breadcrumbs"><LI><A href="https://2015.igem.org/Team:Peking">Home</A></LI><LI>Modeling</LI></UL></DIV></DIV></DIV></DIV><DIV id="content"><DIV class="container"><DIV class="row blog-page"><DIV class="col-md-3 sidebar left-sidebar"><DIV id="sidebar1" class="widget widget-categories"><H4 style="font-size:18px">M<SPAN style="text-transform:lowercase">arker Finder</SPAN></H4><UL><LI><A href="#Modeling-Overview">Overview</A></LI><LI><A href="#Modeling-SSPD">SSPD Method</A></LI><LI><A href="#Modeling-OligoGenerator">Oligo Generator</A></LI></UL></DIV><DIV id="sidebar2" class="widget widget-categories"><H4 style="font-size:18px">M<SPAN style="text-transform:lowercase">arker Finder</SPAN></H4><UL><LI><A href="#Modeling-Overview">Overview</A></LI><LI><A href="#Modeling-SSPD">SSPD Method</A></LI><LI><A href="#Modeling-OligoGenerator">Oligo Generator</A></LI></UL></DIV></DIV><DIV class="col-md-9 page-content" style="text-align:justify;"><DIV id="Modeling-Marker Finder"><DIV class="col-md-12" style="padding:0"><H3 class="classic-title" style="margin-top:50px"><SPAN>Overview</SPAN></H3><P>Though single marker detection using PC reporter works well in lab, in clinical diagnosis of MTB there can be more disturbance, which may mislead the diagnosis. To increase the reliability of the detection , we designed MTB multi-marker array. To select all MTB specific markers through out MTB genome and facilitate array experiment, we developed an algorithm named SSPD, which consists of 4 steps:
                                    <OL style="margin-top:0;margin-bottom:0;color:#606060"><LI style="margin-bottom:6px">Search for all target candidates</LI><LI style="margin-bottom:6px">Select MTB specific targets</LI><LI style="margin-bottom:6px">Pair left and right target sites as markers</LI><LI style="margin-bottom:6px">Determine PCR fragments</LI></OL></P><P>Notice that a target has the same sequence with corresponding sgRNA guide sequence, selecting MTB specific target is thus equivalent to selecting sgRNA.
                                    In <SPAN id="Modeling-SSPD">addition</SPAN>, we designed Oligo Generator to generate oligo sequences from corresponding targets, together with sgRNA generator, it facilitates multiple sgRNA construction. The code can be found <A href="https://static.igem.org/mediawiki/2015/a/a6/Peking-Modeling-MarkerFinder.zip" style="color:#00afd1">here</A> with a report <A href="https://static.igem.org/mediawiki/2015/2/21/Code_Document.pdf" style="color:#00afd1">here</A>.
                                </P></DIV><DIV class="col-md-12" style="padding:0"><H3 class="classic-title" style="margin-top:50px"><SPAN>SSPD Methods</SPAN></H3><DIV id="SSPD-S1" class="col-md-12" style="margin:0; padding:0"><P><B><LARGE>Search for guide sequences of gRNA candidates</LARGE></B></P><P>The CRISPR/dCas9 requires a protospacer adjacent motif (PAM) sequence in the form of 5’-NGG-3’ downstream the target sequence to bind to the target. (Figure 1) Since our experimental results shows that PAM-out orientation (5’-CCN(N)<SUB>20</SUB>-…-(N)<SUB>20</SUB>NGG-3’) was highly efficient for PC Reporter system to work, our model focused on this orientation. (It is convenient to adjust our program for guide sequence design with other orientations. See more in <A href="https://static.igem.org/mediawiki/2015/a/a7/Peking-Modeling-Supplementary.pdf" style="color:#00afd1">Supplementary Information 1 </A>)
                                    </P><DIV id="Modeling_Fig1"><DIV class="col-md-12"><P><B>Figure 1. Schematic illustration of guide design in PAM-out orientation.</B> Note that the 20nt guide sequence is identical to target.</P></DIV></DIV><P>We took advantage of Python 3.4.3 build-in regular expression to search for left guide sequences of gRNA <I>(‘(?&lt;=cc).(?=.{20})’)</I> and right guide sequences of gRNA <I>(‘(?&lt;=.{20}).(?=gg)’)</I> separately, which would be paired later for PC reporter system to function.
                                    </P><DIV id="Modeling_Table1" style="color:#606060"><TABLE class="col-md-6 table table-bordered"><TBODY><TR style="color:#606060"><TD>Left gRNA candidates   (CCN(N)<SUB>20</SUB>)</TD><TD>414962</TD></TR><TR style="color:#606060"><TD>Right gRNA candidates ((N)<SUB>20</SUB>NGG)</TD><TD>407371</TD></TR></TBODY></TABLE><P class="col-md-12"><B>Table 1.</B> The number of gRNA candidates in <I>Mycobacterium Tuberculosis</I> genome</P></DIV></DIV><DIV id="SSPD-S2" class="col-md-12" style="margin:0; padding:0"><P><B><LARGE>Specificity test for each candidate</LARGE></B></P><P>Specificity of guide sequence of gRNA here is defined as the probability of the gRNA binds to the corresponding target site instead of other similar non-target sites. It is measured by taking both quantity of potential off-target sites and similarity between off-target sites and the unique target site into consideration. Since we hope to take sample directly from human mouth, we compared our guide sequence candidates with Human Oral Meta-Genome (HOMG), and reserved only the orthogonal ones to avoid false positive in MTB detection. We adopted a BLAST-based 2-step filtration approach to realize it. In general, the two steps are: a) Filter out guides with off-targets that have 12 bp PAM-proximal sequence identical to corresponding target; b) Score the reserved gRNA on specificity. The principle of the score-rule is that higher specificity should get higher score (see the detail below). Thus we can easily filter out guides with high off-target probability, which is indicated by a low score.
                                    </P><DIV id="SSPD-filter1" class="col-md-12" style="margin:0; padding:0"><P><B>a) PAM-proximal 12bp filtration by BLAST</B></P><P>Previous research has demonstrated that SpCas9 tolerates mismatches to a greater extent in the PAM-distal region than the PAM-proximal region, and the PAM-proximal 8-12nt of the target largely determine the specificity of the targets. Guide sequences of gRNA whose target has identical PAM-proximal 12nt off-targets is highly possible to hit off target, which suggest its fate of being eliminated. Remaining guides are uploaded to BLAST again for potential off-target site finding.  Sequences that are similar to target and found by BLAST are recorded as all off-target sites for the second filtration, those ignored are considered not contributing to off-target. 
                                    </P><DIV id="Modeling_Table2" style="color:#606060"><TABLE class=" table col-md-6 table-bordered"><TBODY><TR style="color:#606060"><TD>Left gRNA candidates  (CCN(N)<SUB>20</SUB>)</TD><TD>55156</TD></TR><TR style="color:#606060"><TD>Right gRNA candidates ((N)<SUB>20</SUB>NGG)</TD><TD>54938</TD></TR></TBODY></TABLE><P class="col-md-12"><B>Table 2.</B> The number of gRNA candidates left after the first filtration in <I>Mycobacterium Tuberculosis</I> genome</P></DIV></DIV><DIV id="SSPD-filter2" class="col-md-12" style="margin:0; padding:0"><P><B>b) Score filtration </B></P><P>Our initial filtration significantly reduce computation by limiting guide sequence score operation to only most possible off-target sites rather than entire subject. We then use Zhang Lab score methods to give an off-target effects measurement of the guide sequences. For each guide candidates, scoring process includes two steps: firstly，each of the individual off-target sites is assigned an “individual score”, then all individual scores are aggregated to an overall score of the given guide sequence.The algorithm used to score single off-target sites is as below.
                                        </P><P>
                                        In the first term, <I>e</I> runs over the mismatch positions set  between the guide and the off-target site, with  representing the experimentally-determined effect of mismatch position on targeting. Term two refers to the effect caused by mean pairwise distance between mismatches(). Term three represent a dampening penalty for highly mismatched off-targets, where  refers to the number of mismatches. 
                                        </P><DIV id="Modeling_Fig2"><DIV class="col-md-12"><P><B>Figure 2. Schematic illustration of an off-target site.</B> The 20 bps are numbered sequentially from the one most distant to PAM, and the red 7, 12, 19 represents the mismatches in the off-target sites.</P></DIV></DIV><P>
                                        Here we show an example (Figure 2) to help readers understand this formula better. Nucleotides are numbered sequentially from the one most distant to PAM, and mismatches in the off-target sites are emphasized by red sign. In this case, W(7)= 0.317, W(12)=0.508, W(19)=0.583; d<SUB>mean</SUB>=(d<SUB>(7,12)</SUB>+d<SUB>(7,19)</SUB>+d<SUB>(12,19)</SUB>)/3=7; n<SUB>m</SUB>=3. Therefore, the off-target site shown above has an individual score of 0.004415278985074628. A higher individual score for an off target site indicates a higher similarity to the target, and thus a higher likelihood of the CRISPR/Cas9 complex binding to the off-target site. Once individual off-target have been scored, each guide is assigned an overall score:
                                        </P><P><I>h</I> runs over the potential off-target set  of guide sequence </P></DIV><P>A higher overall score indicates a better guide with few or weak potential off-targets. Guides with individual off-target sites score 2% or above are eliminated, the remaining are ranked in the order of overall score from 100% to 0%, with a list of off-targets presented in individual score descending order. Guides having an overall score of greater than 45% are reserved finally while others were filtered out in case their lack of specificity.
                                        </P><DIV id="Modeling_Table3" style="color:#606060"><TABLE class="col-md-6 table table-bordered"><TBODY><TR><TD>Left gRNA candidates   (CCN(N)<SUB>20</SUB>)</TD><TD>54417</TD></TR><TR><TD>Right gRNA candidates ((N)<SUB>20</SUB>NGG)</TD><TD>54288</TD></TR></TBODY></TABLE><P class="col-md-12"><B>Table 2.</B> The number of gRNA candidates left after the first filtration in <I>Mycobacterium Tuberculosis</I> genome</P></DIV><DIV id="Modeling_Fig3"><P class="col-md-12"><B>Figure 3. Analysis of the guide sequences scores after score filtration.</B><B>(a)</B>Overall score distribution of guide sequences after the second step filtration. Most sequences have scores more than 97. <B>(b)</B>Ratio of reserved guides (i.e. the number of guide sequences reserved after score filtration / the number of guide sequences after first filtration) is approximately 1 on higher score gRNA and 0 on lower score gRNA.ure 1. Schematic illustration of guide design in PAM-out orientation. Note the 20nt guide sequence is identical to target non-complementary strand.</P></DIV></DIV></DIV><DIV id="SSPD-P" class="col-md-12" style="margin:0; padding:0"><P><LARGE><B>Pair left and right target sites with optimal spacer length</B></LARGE></P><P>All reserved left and right target sites after two-step filtration are considered to be qualified for pairing. In this step, a left site and a right site with appropriate spacer length will be paired. The best spacer length is 19-23bp for split-luciferase dCas9 fusion system according to our experimental data (Figure 4, Link to CRISPR). Single sites that cannot pair with any other sites within the given range of the spacer length would be eliminated.
                                    </P><DIV id="Modeling_Fig4"><P class="col-md-12"><B>Figure 4. The effect of spacer length variation on the performance of PC reporter system.</B> Spacer is defined as the sequence between the sgRNA pairs. The spacer length varies from 5 bp to 107 bp. </P></DIV><DIV id="Modeling_Table4" style="color:#606060"><TABLE class="table col-md-6 table-bordered"><TBODY><TR style="color:#606060"><TD>Spacer Length</TD><TD>19</TD><TD>20</TD><TD>21</TD><TD>22</TD><TD>23</TD><TD>19-23</TD></TR><TR style="color:#606060"><TD>Marker Number</TD><TD>690</TD><TD>836</TD><TD>746</TD><TD>720</TD><TD>759</TD><TD>3751</TD></TR></TBODY></TABLE><P class="col-md-12">The number of gRNA pairs under the condition of different spacer length between left and right pair from 19 to 23 bps in <I>Mycobacterium Tuberculosis</I> genome</P></DIV></DIV><DIV id="SSPD-D" class="col-md-12" style="margin:0; padding:0"><P><LARGE><B>Design PCR fragments</B></LARGE></P><P>We provide two methods for determining PCR fragments. For the first, fix pair number k per fragment, search the adjacent but non-overlapped k pairs. Sort the results with fragment length. For another, fix maximal PCR fragment length, sort the results with pair numbers per fragment. Sorted results will be presented on user interface, enabling users to select fragments by themselves as needed. Selecting overlapping fragment is not allowable for array design.
                                    </P><DIV id="Peking_Modeling_Figure5.png"><P class="col-md-12"><B>Figure 5.</B> Schematic illustration of PCR fragment determination method, taking 2 pairs per fragment as an example. The top xxx shows all left and right targets on given segment of pathogen genome, and the chart aside lists all pairs. Only adjacent but non-overlapped pairs can be deposited on one fragment. Users can choose one through the four optional PCR fragment listed below, since they are overlapped.</P></DIV><DIV id="Modeling_Fig6"><DIV id="Modeling-OligoGenerator"><P> </P></DIV><DIV class="col-md-12"><P><B>Figure 6.</B> 72 target sites (MTB-specific markers) out of 9 fragments on MTB genome, screened out using SSPD.)</P></DIV></DIV></DIV><DIV class="col-md-12" style="padding:0"><H3 class="classic-title" style="margin-top:50px"><SPAN>Oligo Generator</SPAN></H3><P>Using SSPD method mentioned above, we can easily find the reliable target sites on genome. However, designing multiple target sites into oligonucleotides sequences for following sgRNA construction manually can be laborious. Thus here we developed a supplementary program to facilitate oligo sequence generation, which is combined with our sgRNA generator (Link to Part xxx). Specifically, we used Golden Gate Cloning to make it more convenient to substitute guide sequences for different target sites. Detailed operation is explained on flow chart below. See more details in <A href="https://static.igem.org/mediawiki/2015/a/a7/Peking-Modeling-Supplementary.pdf" style="color:#00afd1">Supplementary Information 2</A>.
                                </P><DIV id="Modeling_Fig7"><P class="col-md-12"><B>Figure 7.</B> Schematic illustration of a flow chart explaining the protocol of guide sequence substitution.</P></DIV></DIV><DIV id="Modeling-Ref" class="col-md-12" style="padding:0;margin-top:30px;margin-top:20px"><H3 class="classic-title"><SPAN>Reference</SPAN></H3><P>
                                1. Hsu P D, Scott D A, Weinstein J A, et al. DNA targeting specificity of RNA-guided Cas9 nucleases[J]. Nature biotechnology, 2013, 31(9): 827-832.</P><P>2. http://crispr.mit.edu/about </P><P>3. Naito Y, Hino K, Bono H, et al. CRISPRdirect: software for designing CRISPR/Cas guide RNA with reduced off-target sites[J]. Bioinformatics, 2014: btu743.</P></DIV></DIV></DIV></DIV></DIV></DIV></DIV><FOOTER style="margin-top:30px; padding:0"><DIV class="container"><DIV class="row footer-widgets" style="padding:0:margin:0"><DIV class="col-md-3"><DIV class="col-md-12 footer-widget social-widget row" style="padding-top:0:padding-bottom:0;margin-top:0;margin-bottom:0"><H4>Share This</H4></DIV><DIV class="col-md-12 footer-widget social-widget row"><H4>Follow Us</H4></DIV></DIV><DIV class="col-md-6"><DIV class="footer-widget"><H4>Sponsors</H4></DIV></DIV><DIV class="col-md-3"><DIV class="footer-widget" style="padding:0:margin:0"><H4>Contact us</H4><DIV class="footer-widget contact-widget"><UL style="font-size:12px;color:#b4b4b4"><LI><SPAN>Email:</SPAN><A href="Mailto:pekingigem@gmail.com&amp;Subject=Hello&amp;Body=Hi, Peking iGEM!" style="color:#b4b4b4">pekingigem@gmail.com</A></LI><LI><SPAN>Website:</SPAN><A href="2015.igem.org/Team:Peking" style="color:#b4b4b4"> 2015.igem.org/Team:Peking</A></LI><LI><SPAN>Address:</SPAN> Peking University, No.5 Yiheyuan Road Haidian District, Beijing, P.R.China 100871</LI></UL></DIV></DIV></DIV><DIV class="copyright-section"><DIV class="row"><DIV class="col-md-12" style="padding:0;margin:0;height:30px"><P class="text-center">© 2015 Peking iGEM -  All Rights Reserved. Based on <A href="http://getbootstrap.com/" style="color:#b4b4b4">Bootstrap</A> and Margo template.</P></DIV></DIV></DIV></DIV></DIV></FOOTER></DIV></DIV></DIV></DIV></BODY></HTML>