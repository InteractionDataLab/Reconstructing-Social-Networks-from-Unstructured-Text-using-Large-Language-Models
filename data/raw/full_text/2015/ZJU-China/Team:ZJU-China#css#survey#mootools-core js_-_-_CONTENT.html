<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_ZJU-China_css_survey_mootools-core_js skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:ZJU-China/css/survey/mootools-core js</SPAN></H1><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><P>//MooTools, &lt;<A rel="nofollow" class="external free" href="http://mootools.net">http://mootools.net</A>&gt;, My Object Oriented (JavaScript) Tools. Copyright (c) 2006-2009 Valerio Proietti, &lt;<A rel="nofollow" class="external free" href="http://mad4milk.net">http://mad4milk.net</A>&gt;, MIT Style License.
var MooTools = {
</P><PRE>   version: &quot;1.2.5&quot;,
   build: &quot;008d8f0f2fcc2044e54fdd3635341aaab274e757&quot;
</PRE><P>};
var Native = function(l) {
</P><PRE>   l = l || {};
   var a = l.name;
   var j = l.legacy;
   var b = l.protect;
   var c = l.implement;
   var i = l.generics;
   var g = l.initialize;
   var h = l.afterImplement ||
   function() {};
   var d = g || j;
   i = i !== false;
   d.constructor = Native;
   d.$family = {
       name: &quot;native&quot;
   };
   if (j &amp;&amp; g) {
       d.prototype = j.prototype;
   }
   d.prototype.constructor = d;
   if (a) {
       var f = a.toLowerCase();
       d.prototype.$family = {
           name: f
       };
       Native.typize(d, f);
   }
   var k = function(o, m, p, n) {
       if (!b || n || !o.prototype[m]) {
           o.prototype[m] = p;
       }
       if (i) {
           Native.genericize(o, m, b);
       }
       h.call(o, m, p);
       return o;
   };
   d.alias = function(o, m, q) {
       if (typeof o == &quot;string&quot;) {
           var p = this.prototype[o];
           if ((o = p)) {
               return k(this, m, o, q);
           }
       }
       for (var n in o) {
           this.alias(n, o[n], m);
       }
       return this;
   };
   d.implement = function(n, m, q) {
       if (typeof n == &quot;string&quot;) {
           return k(this, n, m, q);
       }
       for (var o in n) {
           k(this, o, n[o], m);
       }
       return this;
   };
   if (c) {
       d.implement(c);
   }
   return d;
</PRE><P>};
Native.genericize = function(b, c, a) {
</P><PRE>   if ((!a || !b[c]) &amp;&amp; typeof b.prototype[c] == &quot;function&quot;) {
       b[c] = function() {
           var d = Array.prototype.slice.call(arguments);
           return b.prototype[c].apply(d.shift(), d);
       };
   }
</PRE><P>};
Native.implement = function(d, c) {
</P><PRE>   for (var b = 0,
   a = d.length; b &lt; a; b++) {
       d[b].implement(c);
   }
</PRE><P>};
Native.typize = function(a, b) {
</P><PRE>   if (!a.type) {
       a.type = function(c) {
           return ($type(c) === b);
       };
   }
</PRE><P>}; (function() {
</P><PRE>   var a = {
       Array: Array,
       Date: Date,
       Function: Function,
       Number: Number,
       RegExp: RegExp,
       String: String
   };
   for (var j in a) {
       new Native({
           name: j,
           initialize: a[j],
           protect: true
       });
   }
   var d = {
       &quot;boolean&quot;: Boolean,
       &quot;native&quot;: Native,
       object: Object
   };
   for (var c in d) {
       Native.typize(d[c], c);
   }
   var h = {
       Array: [&quot;concat&quot;, &quot;indexOf&quot;, &quot;join&quot;, &quot;lastIndexOf&quot;, &quot;pop&quot;, &quot;push&quot;, &quot;reverse&quot;, &quot;shift&quot;, &quot;slice&quot;, &quot;sort&quot;, &quot;splice&quot;, &quot;toString&quot;, &quot;unshift&quot;, &quot;valueOf&quot;],
       String: [&quot;charAt&quot;, &quot;charCodeAt&quot;, &quot;concat&quot;, &quot;indexOf&quot;, &quot;lastIndexOf&quot;, &quot;match&quot;, &quot;replace&quot;, &quot;search&quot;, &quot;slice&quot;, &quot;split&quot;, &quot;substr&quot;, &quot;substring&quot;, &quot;toLowerCase&quot;, &quot;toUpperCase&quot;, &quot;valueOf&quot;]
   };
   for (var f in h) {
       for (var b = h[f].length; b--;) {
           Native.genericize(a[f], h[f][b], true);
       }
   }
</PRE><P>})();
var Hash = new Native({
</P><PRE>   name: &quot;Hash&quot;,
   initialize: function(a) {
       if ($type(a) == &quot;hash&quot;) {
           a = $unlink(a.getClean());
       }
       for (var b in a) {
           this[b] = a[b];
       }
       return this;
   }
</PRE><P>});
Hash.implement({
</P><PRE>   forEach: function(b, c) {
       for (var a in this) {
           if (this.hasOwnProperty(a)) {
               b.call(c, this[a], a, this);
           }
       }
   },
   getClean: function() {
       var b = {};
       for (var a in this) {
           if (this.hasOwnProperty(a)) {
               b[a] = this[a];
           }
       }
       return b;
   },
   getLength: function() {
       var b = 0;
       for (var a in this) {
           if (this.hasOwnProperty(a)) {
               b++;
           }
       }
       return b;
   }
</PRE><P>});
Hash.alias(&quot;forEach&quot;, &quot;each&quot;);
Array.implement({
</P><PRE>   forEach: function(c, d) {
       for (var b = 0,
       a = this.length; b &lt; a; b++) {
           c.call(d, this[b], b, this);
       }
   }
</PRE><P>});
Array.alias(&quot;forEach&quot;, &quot;each&quot;);
function $A(b) {
</P><PRE>   if (b.item) {
       var a = b.length,
       c = new Array(a);
       while (a--) {
           c[a] = b[a];
       }
       return c;
   }
   return Array.prototype.slice.call(b);
</PRE><P>}
function $arguments(a) {
</P><PRE>   return function() {
       return arguments[a];
   };
</PRE><P>}
function $chk(a) {
</P><PRE>   return !! (a || a === 0);
</PRE><P>}
function $clear(a) {
</P><PRE>   clearTimeout(a);
   clearInterval(a);
   return null;
</PRE><P>}
function $defined(a) {
</P><PRE>   return (a != undefined);
</PRE><P>}
function $each(c, b, d) {
</P><PRE>   var a = $type(c); ((a == &quot;arguments&quot; || a == &quot;collection&quot; || a == &quot;array&quot;) ? Array: Hash).each(c, b, d);
</PRE><P>}
function $empty() {}
function $extend(c, a) {
</P><PRE>   for (var b in (a || {})) {
       c[b] = a[b];
   }
   return c;
</PRE><P>}
function $H(a) {
</P><PRE>   return new Hash(a);
</PRE><P>}
function $lambda(a) {
</P><PRE>   return ($type(a) == &quot;function&quot;) ? a: function() {
       return a;
   };
</PRE><P>}
function $merge() {
</P><PRE>   var a = Array.slice(arguments);
   a.unshift({});
   return $mixin.apply(null, a);
</PRE><P>}
function $mixin(f) {
</P><PRE>   for (var d = 1,
   a = arguments.length; d &lt; a; d++) {
       var b = arguments[d];
       if ($type(b) != &quot;object&quot;) {
           continue;
       }
       for (var c in b) {
           var h = b[c],
           g = f[c];
           f[c] = (g &amp;&amp; $type(h) == &quot;object&quot; &amp;&amp; $type(g) == &quot;object&quot;) ? $mixin(g, h) : $unlink(h);
       }
   }
   return f;
</PRE><P>}
function $pick() {
</P><PRE>   for (var b = 0,
   a = arguments.length; b &lt; a; b++) {
       if (arguments[b] != undefined) {
           return arguments[b];
       }
   }
   return null;
</PRE><P>}
function $random(b, a) {
</P><PRE>   return Math.floor(Math.random() * (a - b + 1) + b);
</PRE><P>}
function $splat(b) {
</P><PRE>   var a = $type(b);
   return (a) ? ((a != &quot;array&quot; &amp;&amp; a != &quot;arguments&quot;) ? [b] : b) : [];
</PRE><P>}
var $time = Date.now ||
function() {
</P><PRE>   return + new Date;
</PRE><P>};
function $try() {
</P><PRE>   for (var b = 0,
   a = arguments.length; b &lt; a; b++) {
       try {
           return arguments[b]();
       } catch(c) {}
   }
   return null;
</PRE><P>}
function $type(a) {
</P><PRE>   if (a == undefined) {
       return false;
   }
   if (a.$family) {
       return (a.$family.name == &quot;number&quot; &amp;&amp; !isFinite(a)) ? false: a.$family.name;
   }
   if (a.nodeName) {
       switch (a.nodeType) {
       case 1:
           return &quot;element&quot;;
       case 3:
           return (/\S/).test(a.nodeValue) ? &quot;textnode&quot;: &quot;whitespace&quot;;
       }
   } else {
       if (typeof a.length == &quot;number&quot;) {
           if (a.callee) {
               return &quot;arguments&quot;;
           } else {
               if (a.item) {
                   return &quot;collection&quot;;
               }
           }
       }
   }
   return typeof a;
</PRE><P>}
function $unlink(c) {
</P><PRE>   var b;
   switch ($type(c)) {
   case &quot;object&quot;:
       b = {};
       for (var f in c) {
           b[f] = $unlink(c[f]);
       }
       break;
   case &quot;hash&quot;:
       b = new Hash(c);
       break;
   case &quot;array&quot;:
       b = [];
       for (var d = 0,
       a = c.length; d &lt; a; d++) {
           b[d] = $unlink(c[d]);
       }
       break;
   default:
       return c;
   }
   return b;
</PRE><P>}
var Browser = $merge({
</P><PRE>   Engine: {
       name: &quot;unknown&quot;,
       version: 0
   },
   Platform: {
       name: (window.orientation != undefined) ? &quot;ipod&quot;: (navigator.platform.match(/mac|win|linux/i) || [&quot;other&quot;])[0].toLowerCase()
   },
   Features: {
       xpath: !!(document.evaluate),
       air: !!(window.runtime),
       query: !!(document.querySelector)
   },
   Plugins: {},
   Engines: {
       presto: function() {
           return (!window.opera) ? false: ((arguments.callee.caller) ? 960 : ((document.getElementsByClassName) ? 950 : 925));
       },
       trident: function() {
           return (!window.ActiveXObject) ? false: ((window.XMLHttpRequest) ? ((document.querySelectorAll) ? 6 : 5) : 4);
       },
       webkit: function() {
           return (navigator.taintEnabled) ? false: ((Browser.Features.xpath) ? ((Browser.Features.query) ? 525 : 420) : 419);
       },
       gecko: function() {
           return (!document.getBoxObjectFor &amp;&amp; window.mozInnerScreenX == null) ? false: ((document.getElementsByClassName) ? 19 : 18);
       }
   }
</PRE><P>},
Browser || {});
Browser.Platform[Browser.Platform.name] = true;
Browser.detect = function() {
</P><PRE>   for (var b in this.Engines) {
       var a = this.Engines[b]();
       if (a) {
           this.Engine = {
               name: b,
               version: a
           };
           this.Engine[b] = this.Engine[b + a] = true;
           break;
       }
   }
   return {
       name: b,
       version: a
   };
</PRE><P>};
Browser.detect();
Browser.Request = function() {
</P><PRE>   return $try(function() {
       return new XMLHttpRequest();
   },
   function() {
       return new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);
   },
   function() {
       return new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
   });
</PRE><P>};
Browser.Features.xhr = !!(Browser.Request());
Browser.Plugins.Flash = (function() {
</P><PRE>   var a = ($try(function() {
       return navigator.plugins[&quot;Shockwave Flash&quot;].description;
   },
   function() {
       return new ActiveXObject(&quot;ShockwaveFlash.ShockwaveFlash&quot;).GetVariable(&quot;$version&quot;);
   }) || &quot;0 r0&quot;).match(/\d+/g);
   return {
       version: parseInt(a[0] || 0 + &quot;.&quot; + a[1], 10) || 0,
       build: parseInt(a[2], 10) || 0
   };
</PRE><P>})();
function $exec(b) {
</P><PRE>   if (!b) {
       return b;
   }
   if (window.execScript) {
       window.execScript(b);
   } else {
       var a = document.createElement(&quot;script&quot;);
       a.setAttribute(&quot;type&quot;, &quot;text/javascript&quot;);
       a[(Browser.Engine.webkit &amp;&amp; Browser.Engine.version &lt; 420) ? &quot;innerText&quot;: &quot;text&quot;] = b;
       document.head.appendChild(a);
       document.head.removeChild(a);
   }
   return b;
</PRE><P>}
Native.UID = 1;
var $uid = (Browser.Engine.trident) ?
function(a) {
</P><PRE>   return (a.uid || (a.uid = [Native.UID++]))[0];
</PRE><P>}: function(a) {
</P><PRE>   return a.uid || (a.uid = Native.UID++);
</PRE><P>};
var Window = new Native({
</P><PRE>   name: &quot;Window&quot;,
   legacy: (Browser.Engine.trident) ? null: window.Window,
   initialize: function(a) {
       $uid(a);
       if (!a.Element) {
           a.Element = $empty;
           if (Browser.Engine.webkit) {
               a.document.createElement(&quot;iframe&quot;);
           }
           a.Element.prototype = (Browser.Engine.webkit) ? window[&quot;<A href="/wiki/index.php?title=DOMElement.prototype&amp;action=edit&amp;redlink=1" class="new" title="DOMElement.prototype (page does not exist)">DOMElement.prototype</A>&quot;] : {};
       }
       a.document.window = a;
       return $extend(a, Window.Prototype);
   },
   afterImplement: function(b, a) {
       window[b] = Window.Prototype[b] = a;
   }
</PRE><P>});
Window.Prototype = {
</P><PRE>   $family: {
       name: &quot;window&quot;
   }
</PRE><P>};
new Window(window);
var Document = new Native({
</P><PRE>   name: &quot;Document&quot;,
   legacy: (Browser.Engine.trident) ? null: window.Document,
   initialize: function(a) {
       $uid(a);
       a.head = a.getElementsByTagName(&quot;head&quot;)[0];
       a.html = a.getElementsByTagName(&quot;html&quot;)[0];
       if (Browser.Engine.trident &amp;&amp; Browser.Engine.version &lt;= 4) {
           $try(function() {
               a.execCommand(&quot;BackgroundImageCache&quot;, false, true);
           });
       }
       if (Browser.Engine.trident) {
           a.window.attachEvent(&quot;onunload&quot;,
           function() {
               a.window.detachEvent(&quot;onunload&quot;, arguments.callee);
               a.head = a.html = a.window = null;
           });
       }
       return $extend(a, Document.Prototype);
   },
   afterImplement: function(b, a) {
       document[b] = Document.Prototype[b] = a;
   }
</PRE><P>});
Document.Prototype = {
</P><PRE>   $family: {
       name: &quot;document&quot;
   }
</PRE><P>};
new Document(document);
Array.implement({
</P><PRE>   every: function(c, d) {
       for (var b = 0,
       a = this.length; b &lt; a; b++) {
           if (!c.call(d, this[b], b, this)) {
               return false;
           }
       }
       return true;
   },
   filter: function(d, f) {
       var c = [];
       for (var b = 0,
       a = this.length; b &lt; a; b++) {
           if (d.call(f, this[b], b, this)) {
               c.push(this[b]);
           }
       }
       return c;
   },
   clean: function() {
       return this.filter($defined);
   },
   indexOf: function(c, d) {
       var a = this.length;
       for (var b = (d &lt; 0) ? Math.max(0, a + d) : d || 0; b &lt; a; b++) {
           if (this[b] === c) {
               return b;
           }
       }
       return - 1;
   },
   map: function(d, f) {
       var c = [];
       for (var b = 0,
       a = this.length; b &lt; a; b++) {
           c[b] = d.call(f, this[b], b, this);
       }
       return c;
   },
   some: function(c, d) {
       for (var b = 0,
       a = this.length; b &lt; a; b++) {
           if (c.call(d, this[b], b, this)) {
               return true;
           }
       }
       return false;
   },
   associate: function(c) {
       var d = {},
       b = Math.min(this.length, c.length);
       for (var a = 0; a &lt; b; a++) {
           d[c[a]] = this[a];
       }
       return d;
   },
   link: function(c) {
       var a = {};
       for (var f = 0,
       b = this.length; f &lt; b; f++) {
           for (var d in c) {
               if (c[d](this[f])) {
                   a[d] = this[f];
                   delete c[d];
                   break;
               }
           }
       }
       return a;
   },
   contains: function(a, b) {
       return this.indexOf(a, b) != -1;
   },
   extend: function(c) {
       for (var b = 0,
       a = c.length; b &lt; a; b++) {
           this.push(c[b]);
       }
       return this;
   },
   getLast: function() {
       return (this.length) ? this[this.length - 1] : null;
   },
   getRandom: function() {
       return (this.length) ? this[$random(0, this.length - 1)] : null;
   },
   include: function(a) {
       if (!this.contains(a)) {
           this.push(a);
       }
       return this;
   },
   combine: function(c) {
       for (var b = 0,
       a = c.length; b &lt; a; b++) {
           this.include(c[b]);
       }
       return this;
   },
   erase: function(b) {
       for (var a = this.length; a--; a) {
           if (this[a] === b) {
               this.splice(a, 1);
           }
       }
       return this;
   },
   empty: function() {
       this.length = 0;
       return this;
   },
   flatten: function() {
       var d = [];
       for (var b = 0,
       a = this.length; b &lt; a; b++) {
           var c = $type(this[b]);
           if (!c) {
               continue;
           }
           d = d.concat((c == &quot;array&quot; || c == &quot;collection&quot; || c == &quot;arguments&quot;) ? Array.flatten(this[b]) : this[b]);
       }
       return d;
   },
   hexToRgb: function(b) {
       if (this.length != 3) {
           return null;
       }
       var a = this.map(function(c) {
           if (c.length == 1) {
               c += c;
           }
           return c.toInt(16);
       });
       return (b) ? a: &quot;rgb(&quot; + a + &quot;)&quot;;
   },
   rgbToHex: function(d) {
       if (this.length &lt; 3) {
           return null;
       }
       if (this.length == 4 &amp;&amp; this[3] == 0 &amp;&amp; !d) {
           return &quot;transparent&quot;;
       }
       var b = [];
       for (var a = 0; a &lt; 3; a++) {
           var c = (this[a] - 0).toString(16);
           b.push((c.length == 1) ? &quot;0&quot; + c: c);
       }
       return (d) ? b: &quot;#&quot; + b.join(&quot;&quot;);
   }
</PRE><P>});
try {
</P><PRE>   delete Function.prototype.bind;
</PRE><P>} catch(e) {}
Function.implement({
</P><PRE>   extend: function(a) {
       for (var b in a) {
           this[b] = a[b];
       }
       return this;
   },
   create: function(b) {
       var a = this;
       b = b || {};
       return function(d) {
           var c = b.arguments;
           c = (c != undefined) ? $splat(c) : Array.slice(arguments, (b.event) ? 1 : 0);
           if (b.event) {
               c = [d || window.event].extend(c);
           }
           var f = function() {
               return a.apply(b.bind || null, c);
           };
           if (b.delay) {
               return setTimeout(f, b.delay);
           }
           if (b.periodical) {
               return setInterval(f, b.periodical);
           }
           if (b.attempt) {
               return $try(f);
           }
           return f();
       };
   },
   run: function(a, b) {
       return this.apply(b, $splat(a));
   },
   pass: function(a, b) {
       return this.create({
           bind: b,
           arguments: a
       });
   },
   bind: function(b, a) {
       return this.create({
           bind: b,
           arguments: a
       });
   },
   bindWithEvent: function(b, a) {
       return this.create({
           bind: b,
           arguments: a,
           event: true
       });
   },
   attempt: function(a, b) {
       return this.create({
           bind: b,
           arguments: a,
           attempt: true
       })();
   },
   delay: function(b, c, a) {
       return this.create({
           bind: c,
           arguments: a,
           delay: b
       })();
   },
   periodical: function(c, b, a) {
       return this.create({
           bind: b,
           arguments: a,
           periodical: c
       })();
   }
</PRE><P>});
Number.implement({
</P><PRE>   limit: function(b, a) {
       return Math.min(a, Math.max(b, this));
   },
   round: function(a) {
       a = Math.pow(10, a || 0);
       return Math.round(this * a) / a;
   },
   times: function(b, c) {
       for (var a = 0; a &lt; this; a++) {
           b.call(c, a, this);
       }
   },
   toFloat: function() {
       return parseFloat(this);
   },
   toInt: function(a) {
       return parseInt(this, a || 10);
   }
</PRE><P>});
Number.alias(&quot;times&quot;, &quot;each&quot;); (function(b) {
</P><PRE>   var a = {};
   b.each(function(c) {
       if (!Number[c]) {
           a[c] = function() {
               return Math[c].apply(null, [this].concat($A(arguments)));
           };
       }
   });
   Number.implement(a);
</PRE><P>})([&quot;abs&quot;, &quot;acos&quot;, &quot;asin&quot;, &quot;atan&quot;, &quot;atan2&quot;, &quot;ceil&quot;, &quot;cos&quot;, &quot;exp&quot;, &quot;floor&quot;, &quot;log&quot;, &quot;max&quot;, &quot;min&quot;, &quot;pow&quot;, &quot;sin&quot;, &quot;sqrt&quot;, &quot;tan&quot;]);
String.implement({
</P><PRE>   test: function(a, b) {
       return ((typeof a == &quot;string&quot;) ? new RegExp(a, b) : a).test(this);
   },
   contains: function(a, b) {
       return (b) ? (b + this + b).indexOf(b + a + b) &gt; -1 : this.indexOf(a) &gt; -1;
   },
   trim: function() {
       return this.replace(/^\s+|\s+$/g, &quot;&quot;);
   },
   clean: function() {
       return this.replace(/\s+/g, &quot; &quot;).trim();
   },
   camelCase: function() {
       return this.replace(/-\D/g,
       function(a) {
           return a.charAt(1).toUpperCase();
       });
   },
   hyphenate: function() {
       return this.replace(/[A-Z]/g,
       function(a) {
           return (&quot;-&quot; + a.charAt(0).toLowerCase());
       });
   },
   capitalize: function() {
       return this.replace(/\b[a-z]/g,
       function(a) {
           return a.toUpperCase();
       });
   },
   escapeRegExp: function() {
       return this.replace(/([-.*+?^${}()|[\]\/\\])/g, &quot;\\$1&quot;);
   },
   toInt: function(a) {
       return parseInt(this, a || 10);
   },
   toFloat: function() {
       return parseFloat(this);
   },
   hexToRgb: function(b) {
       var a = this.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);
       return (a) ? a.slice(1).hexToRgb(b) : null;
   },
   rgbToHex: function(b) {
       var a = this.match(/\d{1,3}/g);
       return (a) ? a.rgbToHex(b) : null;
   },
   stripScripts: function(b) {
       var a = &quot;&quot;;
       var c = this.replace(/&lt;script[^&gt;]*&gt;([\s\S]*?)&lt;\/script&gt;/gi,
       function() {
           a += arguments[1] + &quot;\n&quot;;
           return &quot;&quot;;
       });
       if (b === true) {
           $exec(a);
       } else {
           if ($type(b) == &quot;function&quot;) {
               b(a, c);
           }
       }
       return c;
   },
   substitute: function(a, b) {
       return this.replace(b || (/\\?\{([^{}]+)\}/g),
       function(d, c) {
           if (d.charAt(0) == &quot;\\&quot;) {
               return d.slice(1);
           }
           return (a[c] != undefined) ? a[c] : &quot;&quot;;
       });
   }
</PRE><P>});
Hash.implement({
</P><PRE>   has: Object.prototype.hasOwnProperty,
   keyOf: function(b) {
       for (var a in this) {
           if (this.hasOwnProperty(a) &amp;&amp; this[a] === b) {
               return a;
           }
       }
       return null;
   },
   hasValue: function(a) {
       return (Hash.keyOf(this, a) !== null);
   },
   extend: function(a) {
       Hash.each(a || {},
       function(c, b) {
           Hash.set(this, b, c);
       },
       this);
       return this;
   },
   combine: function(a) {
       Hash.each(a || {},
       function(c, b) {
           Hash.include(this, b, c);
       },
       this);
       return this;
   },
   erase: function(a) {
       if (this.hasOwnProperty(a)) {
           delete this[a];
       }
       return this;
   },
   get: function(a) {
       return (this.hasOwnProperty(a)) ? this[a] : null;
   },
   set: function(a, b) {
       if (!this[a] || this.hasOwnProperty(a)) {
           this[a] = b;
       }
       return this;
   },
   empty: function() {
       Hash.each(this,
       function(b, a) {
           delete this[a];
       },
       this);
       return this;
   },
   include: function(a, b) {
       if (this[a] == undefined) {
           this[a] = b;
       }
       return this;
   },
   map: function(b, c) {
       var a = new Hash;
       Hash.each(this,
       function(f, d) {
           a.set(d, b.call(c, f, d, this));
       },
       this);
       return a;
   },
   filter: function(b, c) {
       var a = new Hash;
       Hash.each(this,
       function(f, d) {
           if (b.call(c, f, d, this)) {
               a.set(d, f);
           }
       },
       this);
       return a;
   },
   every: function(b, c) {
       for (var a in this) {
           if (this.hasOwnProperty(a) &amp;&amp; !b.call(c, this[a], a)) {
               return false;
           }
       }
       return true;
   },
   some: function(b, c) {
       for (var a in this) {
           if (this.hasOwnProperty(a) &amp;&amp; b.call(c, this[a], a)) {
               return true;
           }
       }
       return false;
   },
   getKeys: function() {
       var a = [];
       Hash.each(this,
       function(c, b) {
           a.push(b);
       });
       return a;
   },
   getValues: function() {
       var a = [];
       Hash.each(this,
       function(b) {
           a.push(b);
       });
       return a;
   },
   toQueryString: function(a) {
       var b = [];
       Hash.each(this,
       function(g, f) {
           if (a) {
               f = a + &quot;[&quot; + f + &quot;]&quot;;
           }
           var d;
           switch ($type(g)) {
           case &quot;object&quot;:
               d = Hash.toQueryString(g, f);
               break;
           case &quot;array&quot;:
               var c = {};
               g.each(function(j, h) {
                   c[h] = j;
               });
               d = Hash.toQueryString(c, f);
               break;
           default:
               d = f + &quot;=&quot; + encodeURIComponent(g);
           }
           if (g != undefined) {
               b.push(d);
           }
       });
       return b.join(&quot;&amp;&quot;);
   }
</PRE><P>});
Hash.alias({
</P><PRE>   keyOf: &quot;indexOf&quot;,
   hasValue: &quot;contains&quot;
</PRE><P>});
var Event = new Native({
</P><PRE>   name: &quot;Event&quot;,
   initialize: function(a, g) {
       g = g || window;
       var l = g.document;
       a = a || g.event;
       if (a.$extended) {
           return a;
       }
       this.$extended = true;
       var k = a.type;
       var h = a.target || a.srcElement;
       while (h &amp;&amp; h.nodeType == 3) {
           h = h.parentNode;
       }
       if (k.test(/key/)) {
           var b = a.which || a.keyCode;
           var n = Event.Keys.keyOf(b);
           if (k == &quot;keydown&quot;) {
               var d = b - 111;
               if (d &gt; 0 &amp;&amp; d &lt; 13) {
                   n = &quot;f&quot; + d;
               }
           }
           n = n || String.fromCharCode(b).toLowerCase();
       } else {
           if (k.match(/(click|mouse|menu)/i)) {
               l = (!l.compatMode || l.compatMode == &quot;CSS1Compat&quot;) ? l.html: l.body;
               var j = {
                   x: a.pageX || a.clientX + l.scrollLeft,
                   y: a.pageY || a.clientY + l.scrollTop
               };
               var c = {
                   x: (a.pageX) ? a.pageX - g.pageXOffset: a.clientX,
                   y: (a.pageY) ? a.pageY - g.pageYOffset: a.clientY
               };
               if (k.match(/DOMMouseScroll|mousewheel/)) {
                   var i = (a.wheelDelta) ? a.wheelDelta / 120 : -(a.detail || 0) / 3;
               }
               var f = (a.which == 3) || (a.button == 2);
               var m = null;
               if (k.match(/over|out/)) {
                   switch (k) {
                   case &quot;mouseover&quot;:
                       m = a.relatedTarget || a.fromElement;
                       break;
                   case &quot;mouseout&quot;:
                       m = a.relatedTarget || a.toElement;
                   }
                   if (! (function() {
                       while (m &amp;&amp; m.nodeType == 3) {
                           m = m.parentNode;
                       }
                       return true;
                   }).create({
                       attempt: Browser.Engine.gecko
                   })()) {
                       m = false;
                   }
               }
           }
       }
       return $extend(this, {
           event: a,
           type: k,
           page: j,
           client: c,
           rightClick: f,
           wheel: i,
           relatedTarget: m,
           target: h,
           code: b,
           key: n,
           shift: a.shiftKey,
           control: a.ctrlKey,
           alt: a.altKey,
           meta: a.metaKey
       });
   }
</PRE><P>});
Event.Keys = new Hash({
</P><PRE>   enter: 13,
   up: 38,
   down: 40,
   left: 37,
   right: 39,
   esc: 27,
   space: 32,
   backspace: 8,
   tab: 9,
   &quot;delete&quot;: 46
</PRE><P>});
Event.implement({
</P><PRE>   stop: function() {
       return this.stopPropagation().preventDefault();
   },
   stopPropagation: function() {
       if (this.event.stopPropagation) {
           this.event.stopPropagation();
       } else {
           this.event.cancelBubble = true;
       }
       return this;
   },
   preventDefault: function() {
       if (this.event.preventDefault) {
           this.event.preventDefault();
       } else {
           this.event.returnValue = false;
       }
       return this;
   }
</PRE><P>});
function Class(b) {
</P><PRE>   if (b instanceof Function) {
       b = {
           initialize: b
       };
   }
   var a = function() {
       Object.reset(this);
       if (a._prototyping) {
           return this;
       }
       this._current = $empty;
       var c = (this.initialize) ? this.initialize.apply(this, arguments) : this;
       delete this._current;
       delete this.caller;
       return c;
   }.extend(this);
   a.implement(b);
   a.constructor = Class;
   a.prototype.constructor = a;
   return a;
</PRE><P>}
Function.prototype.protect = function() {
</P><PRE>   this._protected = true;
   return this;
</PRE><P>};
Object.reset = function(a, c) {
</P><PRE>   if (c == null) {
       for (var f in a) {
           Object.reset(a, f);
       }
       return a;
   }
   delete a[c];
   switch ($type(a[c])) {
   case &quot;object&quot;:
       var d = function() {};
       d.prototype = a[c];
       var b = new d;
       a[c] = Object.reset(b);
       break;
   case &quot;array&quot;:
       a[c] = $unlink(a[c]);
       break;
   }
   return a;
</PRE><P>};
new Native({
</P><PRE>   name: &quot;Class&quot;,
   initialize: Class
</PRE><P>}).extend({
</P><PRE>   instantiate: function(b) {
       b._prototyping = true;
       var a = new b;
       delete b._prototyping;
       return a;
   },
   wrap: function(a, b, c) {
       if (c._origin) {
           c = c._origin;
       }
       return function() {
           if (c._protected &amp;&amp; this._current == null) {
               throw new Error('The method &quot;' + b + '&quot; cannot be called.');
           }
           var f = this.caller,
           g = this._current;
           this.caller = g;
           this._current = arguments.callee;
           var d = c.apply(this, arguments);
           this._current = g;
           this.caller = f;
           return d;
       }.extend({
           _owner: a,
           _origin: c,
           _name: b
       });
   }
</PRE><P>});
Class.implement({
</P><PRE>   implement: function(a, d) {
       if ($type(a) == &quot;object&quot;) {
           for (var f in a) {
               this.implement(f, a[f]);
           }
           return this;
       }
       var g = Class.Mutators[a];
       if (g) {
           d = g.call(this, d);
           if (d == null) {
               return this;
           }
       }
       var c = this.prototype;
       switch ($type(d)) {
       case &quot;function&quot;:
           if (d._hidden) {
               return this;
           }
           c[a] = Class.wrap(this, a, d);
           break;
       case &quot;object&quot;:
           var b = c[a];
           if ($type(b) == &quot;object&quot;) {
               $mixin(b, d);
           } else {
               c[a] = $unlink(d);
           }
           break;
       case &quot;array&quot;:
           c[a] = $unlink(d);
           break;
       default:
           c[a] = d;
       }
       return this;
   }
</PRE><P>});
Class.Mutators = {
</P><PRE>   Extends: function(a) {
       this.parent = a;
       this.prototype = Class.instantiate(a);
       this.implement(&quot;parent&quot;,
       function() {
           var b = this.caller._name,
           c = this.caller._owner.parent.prototype[b];
           if (!c) {
               throw new Error('The method &quot;' + b + '&quot; has no parent.');
           }
           return c.apply(this, arguments);
       }.protect());
   },
   Implements: function(a) {
       $splat(a).each(function(b) {
           if (b instanceof Function) {
               b = Class.instantiate(b);
           }
           this.implement(b);
       },
       this);
   }
</PRE><P>};
var Chain = new Class({
</P><PRE>   $chain: [],
   chain: function() {
       this.$chain.extend(Array.flatten(arguments));
       return this;
   },
   callChain: function() {
       return (this.$chain.length) ? this.$chain.shift().apply(this, arguments) : false;
   },
   clearChain: function() {
       this.$chain.empty();
       return this;
   }
</PRE><P>});
var Events = new Class({
</P><PRE>   $events: {},
   addEvent: function(c, b, a) {
       c = Events.removeOn(c);
       if (b != $empty) {
           this.$events[c] = this.$events[c] || [];
           this.$events[c].include(b);
           if (a) {
               b.internal = true;
           }
       }
       return this;
   },
   addEvents: function(a) {
       for (var b in a) {
           this.addEvent(b, a[b]);
       }
       return this;
   },
   fireEvent: function(c, b, a) {
       c = Events.removeOn(c);
       if (!this.$events || !this.$events[c]) {
           return this;
       }
       this.$events[c].each(function(d) {
           d.create({
               bind: this,
               delay: a,
               &quot;arguments&quot;: b
           })();
       },
       this);
       return this;
   },
   removeEvent: function(b, a) {
       b = Events.removeOn(b);
       if (!this.$events[b]) {
           return this;
       }
       if (!a.internal) {
           this.$events[b].erase(a);
       }
       return this;
   },
   removeEvents: function(c) {
       var d;
       if ($type(c) == &quot;object&quot;) {
           for (d in c) {
               this.removeEvent(d, c[d]);
           }
           return this;
       }
       if (c) {
           c = Events.removeOn(c);
       }
       for (d in this.$events) {
           if (c &amp;&amp; c != d) {
               continue;
           }
           var b = this.$events[d];
           for (var a = b.length; a--; a) {
               this.removeEvent(d, b[a]);
           }
       }
       return this;
   }
</PRE><P>});
Events.removeOn = function(a) {
</P><PRE>   return a.replace(/^on([A-Z])/,
   function(b, c) {
       return c.toLowerCase();
   });
</PRE><P>};
var Options = new Class({
</P><PRE>   setOptions: function() {
       this.options = $merge.run([this.options].extend(arguments));
       if (!this.addEvent) {
           return this;
       }
       for (var a in this.options) {
           if ($type(this.options[a]) != &quot;function&quot; || !(/^on[A-Z]/).test(a)) {
               continue;
           }
           this.addEvent(a, this.options[a]);
           delete this.options[a];
       }
       return this;
   }
</PRE><P>});
var Element = new Native({
</P><PRE>   name: &quot;Element&quot;,
   legacy: window.Element,
   initialize: function(a, b) {
       var c = Element.Constructors.get(a);
       if (c) {
           return c(b);
       }
       if (typeof a == &quot;string&quot;) {
           return document.newElement(a, b);
       }
       return document.id(a).set(b);
   },
   afterImplement: function(a, b) {
       Element.Prototype[a] = b;
       if (Array[a]) {
           return;
       }
       Elements.implement(a,
       function() {
           var c = [],
           h = true;
           for (var f = 0,
           d = this.length; f &lt; d; f++) {
               var g = this[f][a].apply(this[f], arguments);
               c.push(g);
               if (h) {
                   h = ($type(g) == &quot;element&quot;);
               }
           }
           return (h) ? new Elements(c) : c;
       });
   }
</PRE><P>});
Element.Prototype = {
</P><PRE>   $family: {
       name: &quot;element&quot;
   }
</PRE><P>};
Element.Constructors = new Hash;
var IFrame = new Native({
</P><PRE>   name: &quot;IFrame&quot;,
   generics: false,
   initialize: function() {
       var g = Array.link(arguments, {
           properties: Object.type,
           iframe: $defined
       });
       var d = g.properties || {};
       var c = document.id(g.iframe);
       var f = d.onload || $empty;
       delete d.onload;
       d.id = d.name = $pick(d.id, d.name, c ? (c.id || c.name) : &quot;IFrame_&quot; + $time());
       c = new Element(c || &quot;iframe&quot;, d);
       var b = function() {
           var h = $try(function() {
               return c.contentWindow.location.host;
           });
           if (!h || h == window.location.host) {
               var i = new Window(c.contentWindow);
               new Document(c.contentWindow.document);
               $extend(i.Element.prototype, Element.Prototype);
           }
           f.call(c.contentWindow, c.contentWindow.document);
       };
       var a = $try(function() {
           return c.contentWindow;
       }); ((a &amp;&amp; a.document.body) || window.frames[d.id]) ? b() : c.addListener(&quot;load&quot;, b);
       return c;
   }
</PRE><P>});
var Elements = new Native({
</P><PRE>   initialize: function(g, b) {
       b = $extend({
           ddup: true,
           cash: true
       },
       b);
       g = g || [];
       if (b.ddup || b.cash) {
           var h = {},
           f = [];
           for (var c = 0,
           a = g.length; c &lt; a; c++) {
               var d = document.id(g[c], !b.cash);
               if (b.ddup) {
                   if (h[d.uid]) {
                       continue;
                   }
                   h[d.uid] = true;
               }
               if (d) {
                   f.push(d);
               }
           }
           g = f;
       }
       return (b.cash) ? $extend(g, this) : g;
   }
</PRE><P>});
Elements.implement({
</P><PRE>   filter: function(a, b) {
       if (!a) {
           return this;
       }
       return new Elements(Array.filter(this, (typeof a == &quot;string&quot;) ?
       function(c) {
           return c.match(a);
       }: a, b));
   }
</PRE><P>}); (function() {
</P><PRE>   var d;
   try {
       var a = document.createElement(&quot;&lt;input name=x&gt;&quot;);
       d = (a.name == &quot;x&quot;);
   } catch(b) {}
   var c = function(f) {
       return (&quot;&quot; + f).replace(/&amp;/g, &quot;&amp;&quot;).replace(/&quot;/g, &quot;&quot;&quot;);
   };
   Document.implement({
       newElement: function(f, g) {
           if (g &amp;&amp; g.checked != null) {
               g.defaultChecked = g.checked;
           }
           if (d &amp;&amp; g) {
               f = &quot;&lt;&quot; + f;
               if (g.name) {
                   f += ' name=&quot;' + c(g.name) + '&quot;';
               }
               if (g.type) {
                   f += ' type=&quot;' + c(g.type) + '&quot;';
               }
               f += &quot;&gt;&quot;;
               delete g.name;
               delete g.type;
           }
           return this.id(this.createElement(f)).set(g);
       },
       newTextNode: function(f) {
           return this.createTextNode(f);
       },
       getDocument: function() {
           return this;
       },
       getWindow: function() {
           return this.window;
       },
       id: (function() {
           var f = {
               string: function(i, h, g) {
                   i = g.getElementById(i);
                   return (i) ? f.element(i, h) : null;
               },
               element: function(g, j) {
                   $uid(g);
                   if (!j &amp;&amp; !g.$family &amp;&amp; !(/^object|embed$/i).test(g.tagName)) {
                       var h = Element.Prototype;
                       for (var i in h) {
                           g[i] = h[i];
                       }
                   }
                   return g;
               },
               object: function(h, i, g) {
                   if (h.toElement) {
                       return f.element(h.toElement(g), i);
                   }
                   return null;
               }
           };
           f.textnode = f.whitespace = f.window = f.document = $arguments(0);
           return function(h, j, i) {
               if (h &amp;&amp; h.$family &amp;&amp; h.uid) {
                   return h;
               }
               var g = $type(h);
               return (f[g]) ? f[g](h, j, i || document) : null;
           };
       })()
   });
</PRE><P>})();
if (window.$ == null) {
</P><PRE>   Window.implement({
       $: function(a, b) {
           return document.id(a, b, this.document);
       }
   });
</PRE><P>}
Window.implement({
</P><PRE>   $$: function(a) {
       if (arguments.length == 1 &amp;&amp; typeof a == &quot;string&quot;) {
           return this.document.getElements(a);
       }
       var g = [];
       var c = Array.flatten(arguments);
       for (var d = 0,
       b = c.length; d &lt; b; d++) {
           var f = c[d];
           switch ($type(f)) {
           case &quot;element&quot;:
               g.push(f);
               break;
           case &quot;string&quot;:
               g.extend(this.document.getElements(f, true));
           }
       }
       return new Elements(g);
   },
   getDocument: function() {
       return this.document;
   },
   getWindow: function() {
       return this;
   }
</PRE><P>});
Native.implement([Element, Document], {
</P><PRE>   getElement: function(a, b) {
       return document.id(this.getElements(a, true)[0] || null, b);
   },
   getElements: function(a, d) {
       a = a.split(&quot;,&quot;);
       var c = [];
       var b = (a.length &gt; 1);
       a.each(function(f) {
           var g = this.getElementsByTagName(f.trim()); (b) ? c.extend(g) : c = g;
       },
       this);
       return new Elements(c, {
           ddup: b,
           cash: !d
       });
   }
</PRE><P>}); (function() {
</P><PRE>   var i = {},
   g = {};
   var j = {
       input: &quot;checked&quot;,
       option: &quot;selected&quot;,
       textarea: (Browser.Engine.webkit &amp;&amp; Browser.Engine.version &lt; 420) ? &quot;innerHTML&quot;: &quot;value&quot;
   };
   var c = function(m) {
       return (g[m] || (g[m] = {}));
   };
   var h = function(o, m) {
       if (!o) {
           return;
       }
       var n = o.uid;
       if (m !== true) {
           m = false;
       }
       if (Browser.Engine.trident) {
           if (o.clearAttributes) {
               var r = m &amp;&amp; o.cloneNode(false);
               o.clearAttributes();
               if (r) {
                   o.mergeAttributes(r);
               }
           } else {
               if (o.removeEvents) {
                   o.removeEvents();
               }
           }
           if ((/object/i).test(o.tagName)) {
               for (var q in o) {
                   if (typeof o[q] == &quot;function&quot;) {
                       o[q] = $empty;
                   }
               }
               Element.dispose(o);
           }
       }
       if (!n) {
           return;
       }
       i[n] = g[n] = null;
   };
   var d = function() {
       Hash.each(i, h);
       if (Browser.Engine.trident) {
           $A(document.getElementsByTagName(&quot;object&quot;)).each(h);
       }
       if (window.CollectGarbage) {
           CollectGarbage();
       }
       i = g = null;
   };
   var k = function(o, m, t, n, q, s) {
       var p = o[t || m];
       var r = [];
       while (p) {
           if (p.nodeType == 1 &amp;&amp; (!n || Element.match(p, n))) {
               if (!q) {
                   return document.id(p, s);
               }
               r.push(p);
           }
           p = p[m];
       }
       return (q) ? new Elements(r, {
           ddup: false,
           cash: !s
       }) : null;
   };
   var f = {
       html: &quot;innerHTML&quot;,
       &quot;class&quot;: &quot;className&quot;,
       &quot;for&quot;: &quot;htmlFor&quot;,
       defaultValue: &quot;defaultValue&quot;,
       text: (Browser.Engine.trident || (Browser.Engine.webkit &amp;&amp; Browser.Engine.version &lt; 420)) ? &quot;innerText&quot;: &quot;textContent&quot;
   };
   var b = [&quot;compact&quot;, &quot;nowrap&quot;, &quot;ismap&quot;, &quot;declare&quot;, &quot;noshade&quot;, &quot;checked&quot;, &quot;disabled&quot;, &quot;readonly&quot;, &quot;multiple&quot;, &quot;selected&quot;, &quot;noresize&quot;, &quot;defer&quot;];
   var l = [&quot;value&quot;, &quot;type&quot;, &quot;defaultValue&quot;, &quot;accessKey&quot;, &quot;cellPadding&quot;, &quot;cellSpacing&quot;, &quot;colSpan&quot;, &quot;frameBorder&quot;, &quot;maxLength&quot;, &quot;readOnly&quot;, &quot;rowSpan&quot;, &quot;tabIndex&quot;, &quot;useMap&quot;];
   b = b.associate(b);
   Hash.extend(f, b);
   Hash.extend(f, l.associate(l.map(String.toLowerCase)));
   var a = {
       before: function(n, m) {
           if (m.parentNode) {
               m.parentNode.insertBefore(n, m);
           }
       },
       after: function(n, m) {
           if (!m.parentNode) {
               return;
           }
           var o = m.nextSibling; (o) ? m.parentNode.insertBefore(n, o) : m.parentNode.appendChild(n);
       },
       bottom: function(n, m) {
           m.appendChild(n);
       },
       top: function(n, m) {
           var o = m.firstChild; (o) ? m.insertBefore(n, o) : m.appendChild(n);
       }
   };
   a.inside = a.bottom;
   Hash.each(a,
   function(m, n) {
       n = n.capitalize();
       Element.implement(&quot;inject&quot; + n,
       function(o) {
           m(this, document.id(o, true));
           return this;
       });
       Element.implement(&quot;grab&quot; + n,
       function(o) {
           m(document.id(o, true), this);
           return this;
       });
   });
   Element.implement({
       set: function(q, n) {
           switch ($type(q)) {
           case &quot;object&quot;:
               for (var o in q) {
                   this.set(o, q[o]);
               }
               break;
           case &quot;string&quot;:
               var m = Element.Properties.get(q); (m &amp;&amp; m.set) ? m.set.apply(this, Array.slice(arguments, 1)) : this.setProperty(q, n);
           }
           return this;
       },
       get: function(n) {
           var m = Element.Properties.get(n);
           return (m &amp;&amp; m.get) ? m.get.apply(this, Array.slice(arguments, 1)) : this.getProperty(n);
       },
       erase: function(n) {
           var m = Element.Properties.get(n); (m &amp;&amp; m.erase) ? m.erase.apply(this) : this.removeProperty(n);
           return this;
       },
       setProperty: function(n, o) {
           var m = f[n];
           if (o == undefined) {
               return this.removeProperty(n);
           }
           if (m &amp;&amp; b[n]) {
               o = !!o;
           } (m) ? this[m] = o: this.setAttribute(n, &quot;&quot; + o);
           return this;
       },
       setProperties: function(m) {
           for (var n in m) {
               this.setProperty(n, m[n]);
           }
           return this;
       },
       getProperty: function(n) {
           var m = f[n];
           var o = (m) ? this[m] : this.getAttribute(n, 2);
           return (b[n]) ? !!o: (m) ? o: o || null;
       },
       getProperties: function() {
           var m = $A(arguments);
           return m.map(this.getProperty, this).associate(m);
       },
       removeProperty: function(n) {
           var m = f[n]; (m) ? this[m] = (m &amp;&amp; b[n]) ? false: &quot;&quot;: this.removeAttribute(n);
           return this;
       },
       removeProperties: function() {
           Array.each(arguments, this.removeProperty, this);
           return this;
       },
       hasClass: function(m) {
           return this.className.contains(m, &quot; &quot;);
       },
       addClass: function(m) {
           if (!this.hasClass(m)) {
               this.className = (this.className + &quot; &quot; + m).clean();
           }
           return this;
       },
       removeClass: function(m) {
           this.className = this.className.replace(new RegExp(&quot;(^|\\s)&quot; + m + &quot;(?:\\s|$)&quot;), &quot;$1&quot;);
           return this;
       },
       toggleClass: function(m) {
           return this.hasClass(m) ? this.removeClass(m) : this.addClass(m);
       },
       adopt: function() {
           Array.flatten(arguments).each(function(m) {
               m = document.id(m, true);
               if (m) {
                   this.appendChild(m);
               }
           },
           this);
           return this;
       },
       appendText: function(n, m) {
           return this.grab(this.getDocument().newTextNode(n), m);
       },
       grab: function(n, m) {
           a[m || &quot;bottom&quot;](document.id(n, true), this);
           return this;
       },
       inject: function(n, m) {
           a[m || &quot;bottom&quot;](this, document.id(n, true));
           return this;
       },
       replaces: function(m) {
           m = document.id(m, true);
           m.parentNode.replaceChild(this, m);
           return this;
       },
       wraps: function(n, m) {
           n = document.id(n, true);
           return this.replaces(n).grab(n, m);
       },
       getPrevious: function(m, n) {
           return k(this, &quot;previousSibling&quot;, null, m, false, n);
       },
       getAllPrevious: function(m, n) {
           return k(this, &quot;previousSibling&quot;, null, m, true, n);
       },
       getNext: function(m, n) {
           return k(this, &quot;nextSibling&quot;, null, m, false, n);
       },
       getAllNext: function(m, n) {
           return k(this, &quot;nextSibling&quot;, null, m, true, n);
       },
       getFirst: function(m, n) {
           return k(this, &quot;nextSibling&quot;, &quot;firstChild&quot;, m, false, n);
       },
       getLast: function(m, n) {
           return k(this, &quot;previousSibling&quot;, &quot;lastChild&quot;, m, false, n);
       },
       getParent: function(m, n) {
           return k(this, &quot;parentNode&quot;, null, m, false, n);
       },
       getParents: function(m, n) {
           return k(this, &quot;parentNode&quot;, null, m, true, n);
       },
       getSiblings: function(m, n) {
           return this.getParent().getChildren(m, n).erase(this);
       },
       getChildren: function(m, n) {
           return k(this, &quot;nextSibling&quot;, &quot;firstChild&quot;, m, true, n);
       },
       getWindow: function() {
           return this.ownerDocument.window;
       },
       getDocument: function() {
           return this.ownerDocument;
       },
       getElementById: function(p, o) {
           var n = this.ownerDocument.getElementById(p);
           if (!n) {
               return null;
           }
           for (var m = n.parentNode; m != this; m = m.parentNode) {
               if (!m) {
                   return null;
               }
           }
           return document.id(n, o);
       },
       getSelected: function() {
           return new Elements($A(this.options).filter(function(m) {
               return m.selected;
           }));
       },
       getComputedStyle: function(n) {
           if (this.currentStyle) {
               return this.currentStyle[n.camelCase()];
           }
           var m = this.getDocument().defaultView.getComputedStyle(this, null);
           return (m) ? m.getPropertyValue([n.hyphenate()]) : null;
       },
       toQueryString: function() {
           var m = [];
           this.getElements(&quot;input, select, textarea&quot;, true).each(function(n) {
               if (!n.name || n.disabled || n.type == &quot;submit&quot; || n.type == &quot;reset&quot; || n.type == &quot;file&quot;) {
                   return;
               }
               var o = (n.tagName.toLowerCase() == &quot;select&quot;) ? Element.getSelected(n).map(function(p) {
                   return p.value;
               }) : ((n.type == &quot;radio&quot; || n.type == &quot;checkbox&quot;) &amp;&amp; !n.checked) ? null: n.value;
               $splat(o).each(function(p) {
                   if (typeof p != &quot;undefined&quot;) {
                       m.push(n.name + &quot;=&quot; + encodeURIComponent(p));
                   }
               });
           });
           return m.join(&quot;&amp;&quot;);
       },
       clone: function(p, m) {
           p = p !== false;
           var s = this.cloneNode(p);
           var o = function(w, v) {
               if (!m) {
                   w.removeAttribute(&quot;id&quot;);
               }
               if (Browser.Engine.trident) {
                   w.clearAttributes();
                   w.mergeAttributes(v);
                   w.removeAttribute(&quot;uid&quot;);
                   if (w.options) {
                       var x = w.options,
                       t = v.options;
                       for (var u = x.length; u--;) {
                           x[u].selected = t[u].selected;
                       }
                   }
               }
               var y = j[v.tagName.toLowerCase()];
               if (y&amp;&amp; v[y]) {
                   w[y] = v[y];
               }
           };
           if (p) {
               var q = s.getElementsByTagName(&quot;*&quot;),
               r = this.getElementsByTagName(&quot;*&quot;);
               for (var n = q.length; n--;) {
                   o(q[n], r[n]);
               }
           }
           o(s, this);
           return document.id(s);
       },
       destroy: function() {
           Element.empty(this);
           Element.dispose(this);
           h(this, true);
           return null;
       },
       empty: function() {
           $A(this.childNodes).each(function(m) {
               Element.destroy(m);
           });
           return this;
       },
       dispose: function() {
           return (this.parentNode) ? this.parentNode.removeChild(this) : this;
       },
       hasChild: function(m) {
           m = document.id(m, true);
           if (!m) {
               return false;
           }
           if (Browser.Engine.webkit &amp;&amp; Browser.Engine.version &lt; 420) {
               return $A(this.getElementsByTagName(m.tagName)).contains(m);
           }
           return (this.contains) ? (this != m &amp;&amp; this.contains(m)) : !!(this.compareDocumentPosition(m) &amp; 16);
       },
       match: function(m) {
           return (!m || (m == this) || (Element.get(this, &quot;tag&quot;) == m));
       }
   });
   Native.implement([Element, Window, Document], {
       addListener: function(p, o) {
           if (p == &quot;unload&quot;) {
               var m = o,
               n = this;
               o = function() {
                   n.removeListener(&quot;unload&quot;, o);
                   m();
               };
           } else {
               i[this.uid] = this;
           }
           if (this.addEventListener) {
               this.addEventListener(p, o, false);
           } else {
               this.attachEvent(&quot;on&quot; + p, o);
           }
           return this;
       },
       removeListener: function(n, m) {
           if (this.removeEventListener) {
               this.removeEventListener(n, m, false);
           } else {
               this.detachEvent(&quot;on&quot; + n, m);
           }
           return this;
       },
       retrieve: function(n, m) {
           var p = c(this.uid),
           o = p[n];
           if (m != undefined &amp;&amp; o == undefined) {
               o = p[n] = m;
           }
           return $pick(o);
       },
       store: function(n, m) {
           var o = c(this.uid);
           o[n] = m;
           return this;
       },
       eliminate: function(m) {
           var n = c(this.uid);
           delete n[m];
           return this;
       }
   });
   window.addListener(&quot;unload&quot;, d);
</PRE><P>})();
Element.Properties = new Hash;
Element.Properties.style = {
</P><PRE>   set: function(a) {
       this.style.cssText = a;
   },
   get: function() {
       return this.style.cssText;
   },
   erase: function() {
       this.style.cssText = &quot;&quot;;
   }
</PRE><P>};
Element.Properties.tag = {
</P><PRE>   get: function() {
       return this.tagName.toLowerCase();
   }
</PRE><P>};
Element.Properties.html = (function() {
</P><PRE>   var c = document.createElement(&quot;div&quot;);
   var a = {
</PRE>
        table: [1, &quot;<TABLE>&quot;, &quot;</TABLE>&quot;],
<PRE>       select: [1, &quot;&lt;select&gt;&quot;, &quot;&lt;/select&gt;&quot;],
</PRE>
        tbody: [2, &quot;<TABLE>&lt;tbody&gt;&quot;, &quot;&lt;/tbody&gt;</TABLE>&quot;],
        tr: [3, &quot;<TABLE>&lt;tbody&gt;<TBODY><TR>&quot;, &quot;</TR>&lt;/tbody&gt;</TBODY></TABLE>&quot;]
<PRE>   };
   a.thead = a.tfoot = a.tbody;
   var b = {
       set: function() {
           var f = Array.flatten(arguments).join(&quot;&quot;);
           var g = Browser.Engine.trident &amp;&amp; a[this.get(&quot;tag&quot;)];
           if (g) {
               var h = c;
               h.innerHTML = g[1] + f + g[2];
               for (var d = g[0]; d--;) {
                   h = h.firstChild;
               }
               this.empty().adopt(h.childNodes);
           } else {
               this.innerHTML = f;
           }
       }
   };
   b.erase = b.set;
   return b;
</PRE><P>})();
if (Browser.Engine.webkit &amp;&amp; Browser.Engine.version &lt; 420) {
</P><PRE>   Element.Properties.text = {
       get: function() {
           if (this.innerText) {
               return this.innerText;
           }
           var a = this.ownerDocument.newElement(&quot;div&quot;, {
               html: this.innerHTML
           }).inject(this.ownerDocument.body);
           var b = a.innerText;
           a.destroy();
           return b;
       }
   };
</PRE><P>}
Element.Properties.events = {
</P><PRE>   set: function(a) {
       this.addEvents(a);
   }
</PRE><P>};
Native.implement([Element, Window, Document], {
</P><PRE>   addEvent: function(f, h) {
       var i = this.retrieve(&quot;events&quot;, {});
       i[f] = i[f] || {
           keys: [],
           values: []
       };
       if (i[f].keys.contains(h)) {
           return this;
       }
       i[f].keys.push(h);
       var g = f,
       a = Element.Events.get(f),
       c = h,
       j = this;
       if (a) {
           if (a.onAdd) {
               a.onAdd.call(this, h);
           }
           if (a.condition) {
               c = function(k) {
                   if (a.condition.call(this, k)) {
                       return h.call(this, k);
                   }
                   return true;
               };
           }
           g = a.base || g;
       }
       var d = function() {
           return h.call(j);
       };
       var b = Element.NativeEvents[g];
       if (b) {
           if (b == 2) {
               d = function(k) {
                   k = new Event(k, j.getWindow());
                   if (c.call(j, k) === false) {
                       k.stop();
                   }
               };
           }
           this.addListener(g, d);
       }
       i[f].values.push(d);
       return this;
   },
   removeEvent: function(c, b) {
       var a = this.retrieve(&quot;events&quot;);
       if (!a || !a[c]) {
           return this;
       }
       var g = a[c].keys.indexOf(b);
       if (g == -1) {
           return this;
       }
       a[c].keys.splice(g, 1);
       var f = a[c].values.splice(g, 1)[0];
       var d = Element.Events.get(c);
       if (d) {
           if (d.onRemove) {
               d.onRemove.call(this, b);
           }
           c = d.base || c;
       }
       return (Element.NativeEvents[c]) ? this.removeListener(c, f) : this;
   },
   addEvents: function(a) {
       for (var b in a) {
           this.addEvent(b, a[b]);
       }
       return this;
   },
   removeEvents: function(a) {
       var c;
       if ($type(a) == &quot;object&quot;) {
           for (c in a) {
               this.removeEvent(c, a[c]);
           }
           return this;
       }
       var b = this.retrieve(&quot;events&quot;);
       if (!b) {
           return this;
       }
       if (!a) {
           for (c in b) {
               this.removeEvents(c);
           }
           this.eliminate(&quot;events&quot;);
       } else {
           if (b[a]) {
               while (b[a].keys[0]) {
                   this.removeEvent(a, b[a].keys[0]);
               }
               b[a] = null;
           }
       }
       return this;
   },
   fireEvent: function(d, b, a) {
       var c = this.retrieve(&quot;events&quot;);
       if (!c || !c[d]) {
           return this;
       }
       c[d].keys.each(function(f) {
           f.create({
               bind: this,
               delay: a,
               &quot;arguments&quot;: b
           })();
       },
       this);
       return this;
   },
   cloneEvents: function(d, a) {
       d = document.id(d);
       var c = d.retrieve(&quot;events&quot;);
       if (!c) {
           return this;
       }
       if (!a) {
           for (var b in c) {
               this.cloneEvents(d, b);
           }
       } else {
           if (c[a]) {
               c[a].keys.each(function(f) {
                   this.addEvent(a, f);
               },
               this);
           }
       }
       return this;
   }
</PRE><P>});
try {
</P><PRE>   if (typeof HTMLElement != &quot;undefined&quot;) {
       HTMLElement.prototype.fireEvent = Element.prototype.fireEvent;
   }
</PRE><P>} catch(e) {}
Element.NativeEvents = {
</P><PRE>   click: 2,
   dblclick: 2,
   mouseup: 2,
   mousedown: 2,
   contextmenu: 2,
   mousewheel: 2,
   DOMMouseScroll: 2,
   mouseover: 2,
   mouseout: 2,
   mousemove: 2,
   selectstart: 2,
   selectend: 2,
   keydown: 2,
   keypress: 2,
   keyup: 2,
   focus: 2,
   blur: 2,
   change: 2,
   reset: 2,
   select: 2,
   submit: 2,
   load: 1,
   unload: 1,
   beforeunload: 2,
   resize: 1,
   move: 1,
   DOMContentLoaded: 1,
   readystatechange: 1,
   error: 1,
   abort: 1,
   scroll: 1
</PRE><P>}; (function() {
</P><PRE>   var a = function(b) {
       var c = b.relatedTarget;
       if (c == undefined) {
           return true;
       }
       if (c === false) {
           return false;
       }
       return ($type(this) != &quot;document&quot; &amp;&amp; c != this &amp;&amp; c.prefix != &quot;xul&quot; &amp;&amp; !this.hasChild(c));
   };
   Element.Events = new Hash({
       mouseenter: {
           base: &quot;mouseover&quot;,
           condition: a
       },
       mouseleave: {
           base: &quot;mouseout&quot;,
           condition: a
       },
       mousewheel: {
           base: (Browser.Engine.gecko) ? &quot;DOMMouseScroll&quot;: &quot;mousewheel&quot;
       }
   });
</PRE><P>})();
Element.Properties.styles = {
</P><PRE>   set: function(a) {
       this.setStyles(a);
   }
</PRE><P>};
Element.Properties.opacity = {
</P><PRE>   set: function(a, b) {
       if (!b) {
           if (a == 0) {
               if (this.style.visibility != &quot;hidden&quot;) {
                   this.style.visibility = &quot;hidden&quot;;
               }
           } else {
               if (this.style.visibility != &quot;visible&quot;) {
                   this.style.visibility = &quot;visible&quot;;
               }
           }
       }
       if (!this.currentStyle || !this.currentStyle.hasLayout) {
           this.style.zoom = 1;
       }
       if (Browser.Engine.trident) {
           this.style.filter = (a == 1) ? &quot;&quot;: &quot;alpha(opacity=&quot; + a * 100 + &quot;)&quot;;
       }
       this.style.opacity = a;
       this.store(&quot;opacity&quot;, a);
   },
   get: function() {
       return this.retrieve(&quot;opacity&quot;, 1);
   }
</PRE><P>};
Element.implement({
</P><PRE>   setOpacity: function(a) {
       return this.set(&quot;opacity&quot;, a, true);
   },
   getOpacity: function() {
       return this.get(&quot;opacity&quot;);
   },
   setStyle: function(b, a) {
       switch (b) {
       case &quot;opacity&quot;:
           return this.set(&quot;opacity&quot;, parseFloat(a));
       case &quot;float&quot;:
           b = (Browser.Engine.trident) ? &quot;styleFloat&quot;: &quot;cssFloat&quot;;
       }
       b = b.camelCase();
       if ($type(a) != &quot;string&quot;) {
           var c = (Element.Styles.get(b) || &quot;@&quot;).split(&quot; &quot;);
           a = $splat(a).map(function(f, d) {
               if (!c[d]) {
                   return &quot;&quot;;
               }
               return ($type(f) == &quot;number&quot;) ? c[d].replace(&quot;@&quot;, Math.round(f)) : f;
           }).join(&quot; &quot;);
       } else {
           if (a == String(Number(a))) {
               a = Math.round(a);
           }
       }
       this.style[b] = a;
       return this;
   },
   getStyle: function(h) {
       switch (h) {
       case &quot;opacity&quot;:
           return this.get(&quot;opacity&quot;);
       case &quot;float&quot;:
           h = (Browser.Engine.trident) ? &quot;styleFloat&quot;: &quot;cssFloat&quot;;
       }
       h = h.camelCase();
       var a = this.style[h];
       if (!$chk(a)) {
           a = [];
           for (var g in Element.ShortStyles) {
               if (h != g) {
                   continue;
               }
               for (var f in Element.ShortStyles[g]) {
                   a.push(this.getStyle(f));
               }
               return a.join(&quot; &quot;);
           }
           a = this.getComputedStyle(h);
       }
       if (a) {
           a = String(a);
           var c = a.match(/rgba?\([\d\s,]+\)/);
           if (c) {
               a = a.replace(c[0], c[0].rgbToHex());
           }
       }
       if (Browser.Engine.presto || (Browser.Engine.trident &amp;&amp; !$chk(parseInt(a, 10)))) {
           if (h.test(/^(height|width)$/)) {
               var b = (h == &quot;width&quot;) ? [&quot;left&quot;, &quot;right&quot;] : [&quot;top&quot;, &quot;bottom&quot;],
               d = 0;
               b.each(function(i) {
                   d += this.getStyle(&quot;border-&quot; + i + &quot;-width&quot;).toInt() + this.getStyle(&quot;padding-&quot; + i).toInt();
               },
               this);
               return this[&quot;offset&quot; + h.capitalize()] - d + &quot;px&quot;;
           }
           if ((Browser.Engine.presto) &amp;&amp; String(a).test(&quot;px&quot;)) {
               return a;
           }
           if (h.test(/(border(.+)Width|margin|padding)/)) {
               return &quot;0px&quot;;
           }
       }
       return a;
   },
   setStyles: function(b) {
       for (var a in b) {
           this.setStyle(a, b[a]);
       }
       return this;
   },
   getStyles: function() {
       var a = {};
       Array.flatten(arguments).each(function(b) {
           a[b] = this.getStyle(b);
       },
       this);
       return a;
   }
</PRE><P>});
Element.Styles = new Hash({
</P><PRE>   left: &quot;@px&quot;,
   top: &quot;@px&quot;,
   bottom: &quot;@px&quot;,
   right: &quot;@px&quot;,
   width: &quot;@px&quot;,
   height: &quot;@px&quot;,
   maxWidth: &quot;@px&quot;,
   maxHeight: &quot;@px&quot;,
   minWidth: &quot;@px&quot;,
   minHeight: &quot;@px&quot;,
   backgroundColor: &quot;rgb(@, @, @)&quot;,
   backgroundPosition: &quot;@px @px&quot;,
   color: &quot;rgb(@, @, @)&quot;,
   fontSize: &quot;@px&quot;,
   letterSpacing: &quot;@px&quot;,
   lineHeight: &quot;@px&quot;,
   clip: &quot;rect(@px @px @px @px)&quot;,
   margin: &quot;@px @px @px @px&quot;,
   padding: &quot;@px @px @px @px&quot;,
   border: &quot;@px @ rgb(@, @, @) @px @ rgb(@, @, @) @px @ rgb(@, @, @)&quot;,
   borderWidth: &quot;@px @px @px @px&quot;,
   borderStyle: &quot;@ @ @ @&quot;,
   borderColor: &quot;rgb(@, @, @) rgb(@, @, @) rgb(@, @, @) rgb(@, @, @)&quot;,
   zIndex: &quot;@&quot;,
   zoom: &quot;@&quot;,
   fontWeight: &quot;@&quot;,
   textIndent: &quot;@px&quot;,
   opacity: &quot;@&quot;
</PRE><P>});
Element.ShortStyles = {
</P><PRE>   margin: {},
   padding: {},
   border: {},
   borderWidth: {},
   borderStyle: {},
   borderColor: {}
</PRE><P>}; [&quot;Top&quot;, &quot;Right&quot;, &quot;Bottom&quot;, &quot;Left&quot;].each(function(h) {
</P><PRE>   var g = Element.ShortStyles;
   var b = Element.Styles; [&quot;margin&quot;, &quot;padding&quot;].each(function(i) {
       var j = i + h;
       g[i][j] = b[j] = &quot;@px&quot;;
   });
   var f = &quot;border&quot; + h;
   g.border[f] = b[f] = &quot;@px @ rgb(@, @, @)&quot;;
   var d = f + &quot;Width&quot;,
   a = f + &quot;Style&quot;,
   c = f + &quot;Color&quot;;
   g[f] = {};
   g.borderWidth[d] = g[f][d] = b[d] = &quot;@px&quot;;
   g.borderStyle[a] = g[f][a] = b[a] = &quot;@&quot;;
   g.borderColor[c] = g[f][c] = b[c] = &quot;rgb(@, @, @)&quot;;
</PRE><P>}); (function() {
</P><PRE>   Element.implement({
       scrollTo: function(i, j) {
           if (b(this)) {
               this.getWindow().scrollTo(i, j);
           } else {
               this.scrollLeft = i;
               this.scrollTop = j;
           }
           return this;
       },
       getSize: function() {
           if (b(this)) {
               return this.getWindow().getSize();
           }
           return {
               x: this.offsetWidth,
               y: this.offsetHeight
           };
       },
       getScrollSize: function() {
           if (b(this)) {
               return this.getWindow().getScrollSize();
           }
           return {
               x: this.scrollWidth,
               y: this.scrollHeight
           };
       },
       getScroll: function() {
           if (b(this)) {
               return this.getWindow().getScroll();
           }
           return {
               x: this.scrollLeft,
               y: this.scrollTop
           };
       },
       getScrolls: function() {
           var j = this,
           i = {
               x: 0,
               y: 0
           };
           while (j &amp;&amp; !b(j)) {
               i.x += j.scrollLeft;
               i.y += j.scrollTop;
               j = j.parentNode;
           }
           return i;
       },
       getOffsetParent: function() {
           var i = this;
           if (b(i)) {
               return null;
           }
           if (!Browser.Engine.trident) {
               return i.offsetParent;
           }
           while ((i = i.parentNode) &amp;&amp; !b(i)) {
               if (d(i, &quot;position&quot;) != &quot;static&quot;) {
                   return i;
               }
           }
           return null;
       },
       getOffsets: function() {
           if (this.getBoundingClientRect) {
               var k = this.getBoundingClientRect(),
               n = document.id(this.getDocument().documentElement),
               q = n.getScroll(),
               l = this.getScrolls(),
               j = this.getScroll(),
               i = (d(this, &quot;position&quot;) == &quot;fixed&quot;);
               return {
                   x: k.left.toInt() + l.x - j.x + ((i) ? 0 : q.x) - n.clientLeft,
                   y: k.top.toInt() + l.y - j.y + ((i) ? 0 : q.y) - n.clientTop
               };
           }
           var m = this,
           o = {
               x: 0,
               y: 0
           };
           if (b(this)) {
               return o;
           }
           while (m &amp;&amp; !b(m)) {
               o.x += m.offsetLeft;
               o.y += m.offsetTop;
               if (Browser.Engine.gecko) {
                   if (!g(m)) {
                       o.x += c(m);
                       o.y += h(m);
                   }
                   var p = m.parentNode;
                   if (p &amp;&amp; d(p, &quot;overflow&quot;) != &quot;visible&quot;) {
                       o.x += c(p);
                       o.y += h(p);
                   }
               } else {
                   if (m != this &amp;&amp; Browser.Engine.webkit) {
                       o.x += c(m);
                       o.y += h(m);
                   }
               }
               m = m.offsetParent;
           }
           if (Browser.Engine.gecko &amp;&amp; !g(this)) {
               o.x -= c(this);
               o.y -= h(this);
           }
           return o;
       },
       getPosition: function(l) {
           if (b(this)) {
               return {
                   x: 0,
                   y: 0
               };
           }
           var m = this.getOffsets(),
           j = this.getScrolls();
           var i = {
               x: m.x - j.x,
               y: m.y - j.y
           };
           var k = (l &amp;&amp; (l = document.id(l))) ? l.getPosition() : {
               x: 0,
               y: 0
           };
           return {
               x: i.x - k.x,
               y: i.y - k.y
           };
       },
       getCoordinates: function(k) {
           if (b(this)) {
               return this.getWindow().getCoordinates();
           }
           var i = this.getPosition(k),
           j = this.getSize();
           var l = {
               left: i.x,
               top: i.y,
               width: j.x,
               height: j.y
           };
           l.right = l.left + l.width;
           l.bottom = l.top + l.height;
           return l;
       },
       computePosition: function(i) {
           return {
               left: i.x - f(this, &quot;margin-left&quot;),
               top: i.y - f(this, &quot;margin-top&quot;)
           };
       },
       setPosition: function(i) {
           return this.setStyles(this.computePosition(i));
       }
   });
   Native.implement([Document, Window], {
       getSize: function() {
           if (Browser.Engine.presto || Browser.Engine.webkit) {
               var j = this.getWindow();
               return {
                   x: j.innerWidth,
                   y: j.innerHeight
               };
           }
           var i = a(this);
           return {
               x: i.clientWidth,
               y: i.clientHeight
           };
       },
       getScroll: function() {
           var j = this.getWindow(),
           i = a(this);
           return {
               x: j.pageXOffset || i.scrollLeft,
               y: j.pageYOffset || i.scrollTop
           };
       },
       getScrollSize: function() {
           var j = a(this),
           i = this.getSize();
           return {
               x: Math.max(j.scrollWidth, i.x),
               y: Math.max(j.scrollHeight, i.y)
           };
       },
       getPosition: function() {
           return {
               x: 0,
               y: 0
           };
       },
       getCoordinates: function() {
           var i = this.getSize();
           return {
               top: 0,
               left: 0,
               bottom: i.y,
               right: i.x,
               height: i.y,
               width: i.x
           };
       }
   });
   var d = Element.getComputedStyle;
   function f(i, j) {
       return d(i, j).toInt() || 0;
   }
   function g(i) {
       return d(i, &quot;-moz-box-sizing&quot;) == &quot;border-box&quot;;
   }
   function h(i) {
       return f(i, &quot;border-top-width&quot;);
   }
   function c(i) {
       return f(i, &quot;border-left-width&quot;);
   }
   function b(i) {
       return (/^(?:body|html)$/i).test(i.tagName);
   }
   function a(i) {
       var j = i.getDocument();
       return (!j.compatMode || j.compatMode == &quot;CSS1Compat&quot;) ? j.html: j.body;
   }
</PRE><P>})();
Element.alias(&quot;setPosition&quot;, &quot;position&quot;);
Native.implement([Window, Document, Element], {
</P><PRE>   getHeight: function() {
       return this.getSize().y;
   },
   getWidth: function() {
       return this.getSize().x;
   },
   getScrollTop: function() {
       return this.getScroll().y;
   },
   getScrollLeft: function() {
       return this.getScroll().x;
   },
   getScrollHeight: function() {
       return this.getScrollSize().y;
   },
   getScrollWidth: function() {
       return this.getScrollSize().x;
   },
   getTop: function() {
       return this.getPosition().y;
   },
   getLeft: function() {
       return this.getPosition().x;
   }
</PRE><P>});
Native.implement([Document, Element], {
</P><PRE>   getElements: function(j, h) {
       j = j.split(&quot;,&quot;);
       var c, f = {};
       for (var d = 0,
       b = j.length; d &lt; b; d++) {
           var a = j[d],
           g = Selectors.Utils.search(this, a, f);
           if (d != 0 &amp;&amp; g.item) {
               g = $A(g);
           }
           c = (d == 0) ? g: (c.item) ? $A(c).concat(g) : c.concat(g);
       }
       return new Elements(c, {
           ddup: (j.length &gt; 1),
           cash: !h
       });
   }
</PRE><P>});
Element.implement({
</P><PRE>   match: function(b) {
       if (!b || (b == this)) {
           return true;
       }
       var d = Selectors.Utils.parseTagAndID(b);
       var a = d[0],
       f = d[1];
       if (!Selectors.Filters.byID(this, f) || !Selectors.Filters.byTag(this, a)) {
           return false;
       }
       var c = Selectors.Utils.parseSelector(b);
       return (c) ? Selectors.Utils.filter(this, c, {}) : true;
   }
</PRE><P>});
var Selectors = {
</P><PRE>   Cache: {
       nth: {},
       parsed: {}
   }
</PRE><P>};
Selectors.RegExps = {
</P><PRE>   id: (/#([\w-]+)/),
   tag: (/^(\w+|\*)/),
   quick: (/^(\w+|\*)$/),
   splitter: (/\s*([+&gt;~\s])\s*([a-zA-Z#.*:\[])/g),
   combined: (/\.([\w-]+)|\[(\w+)(?:([!*^$~|]?=)([&quot;']?)([^\4]*?)\4)?\]|:([\w-]+)(?:\([&quot;']?(.*?)?[&quot;']?\)|$)/g)
</PRE><P>};
Selectors.Utils = {
</P><PRE>   chk: function(b, c) {
       if (!c) {
           return true;
       }
       var a = $uid(b);
       if (!c[a]) {
           return c[a] = true;
       }
       return false;
   },
   parseNthArgument: function(i) {
       if (Selectors.Cache.nth[i]) {
           return Selectors.Cache.nth[i];
       }
       var f = i.match(/^([+-]?\d*)?([a-z]+)?([+-]?\d*)?$/);
       if (!f) {
           return false;
       }
       var h = parseInt(f[1], 10);
       var d = (h || h === 0) ? h: 1;
       var g = f[2] || false;
       var c = parseInt(f[3], 10) || 0;
       if (d != 0) {
           c--;
           while (c &lt; 1) {
               c += d;
           }
           while (c &gt;= d) {
               c -= d;
           }
       } else {
           d = c;
           g = &quot;index&quot;;
       }
       switch (g) {
       case &quot;n&quot;:
           f = {
               a: d,
               b: c,
               special: &quot;n&quot;
           };
           break;
       case &quot;odd&quot;:
           f = {
               a: 2,
               b: 0,
               special: &quot;n&quot;
           };
           break;
       case &quot;even&quot;:
           f = {
               a: 2,
               b: 1,
               special: &quot;n&quot;
           };
           break;
       case &quot;first&quot;:
           f = {
               a: 0,
               special: &quot;index&quot;
           };
           break;
       case &quot;last&quot;:
           f = {
               special: &quot;last-child&quot;
           };
           break;
       case &quot;only&quot;:
           f = {
               special: &quot;only-child&quot;
           };
           break;
       default:
           f = {
               a: (d - 1),
               special: &quot;index&quot;
           };
       }
       return Selectors.Cache.nth[i] = f;
   },
   parseSelector: function(f) {
       if (Selectors.Cache.parsed[f]) {
           return Selectors.Cache.parsed[f];
       }
       var d, i = {
           classes: [],
           pseudos: [],
           attributes: []
       };
       while ((d = Selectors.RegExps.combined.exec(f))) {
           var j = d[1],
           h = d[2],
           g = d[3],
           b = d[5],
           c = d[6],
           k = d[7];
           if (j) {
               i.classes.push(j);
           } else {
               if (c) {
                   var a = Selectors.Pseudo.get(c);
                   if (a) {
                       i.pseudos.push({
                           parser: a,
                           argument: k
                       });
                   } else {
                       i.attributes.push({
                           name: c,
                           operator: &quot;=&quot;,
                           value: k
                       });
                   }
               } else {
                   if (h) {
                       i.attributes.push({
                           name: h,
                           operator: g,
                           value: b
                       });
                   }
               }
           }
       }
       if (!i.classes.length) {
           delete i.classes;
       }
       if (!i.attributes.length) {
           delete i.attributes;
       }
       if (!i.pseudos.length) {
           delete i.pseudos;
       }
       if (!i.classes &amp;&amp; !i.attributes &amp;&amp; !i.pseudos) {
           i = null;
       }
       return Selectors.Cache.parsed[f] = i;
   },
   parseTagAndID: function(b) {
       var a = b.match(Selectors.RegExps.tag);
       var c = b.match(Selectors.RegExps.id);
       return [(a) ? a[1] : &quot;*&quot;, (c) ? c[1] : false];
   },
   filter: function(g, c, f) {
       var d;
       if (c.classes) {
           for (d = c.classes.length; d--; d) {
               var h = c.classes[d];
               if (!Selectors.Filters.byClass(g, h)) {
                   return false;
               }
           }
       }
       if (c.attributes) {
           for (d = c.attributes.length; d--; d) {
               var b = c.attributes[d];
               if (!Selectors.Filters.byAttribute(g, b.name, b.operator, b.value)) {
                   return false;
               }
           }
       }
       if (c.pseudos) {
           for (d = c.pseudos.length; d--; d) {
               var a = c.pseudos[d];
               if (!Selectors.Filters.byPseudo(g, a.parser, a.argument, f)) {
                   return false;
               }
           }
       }
       return true;
   },
   getByTagAndID: function(b, a, d) {
       if (d) {
           var c = (b.getElementById) ? b.getElementById(d, true) : Element.getElementById(b, d, true);
           return (c &amp;&amp; Selectors.Filters.byTag(c, a)) ? [c] : [];
       } else {
           return b.getElementsByTagName(a);
       }
   },
   search: function(p, o, u) {
       var b = [];
       var c = o.trim().replace(Selectors.RegExps.splitter,
       function(k, j, i) {
           b.push(j);
           return &quot;:)&quot; + i;
       }).split(&quot;:)&quot;);
       var q, f, B;
       for (var A = 0,
       w = c.length; A &lt; w; A++) {
           var z = c[A];
           if (A == 0 &amp;&amp; Selectors.RegExps.quick.test(z)) {
               q = p.getElementsByTagName(z);
               continue;
           }
           var a = b[A - 1];
           var r = Selectors.Utils.parseTagAndID(z);
           var C = r[0],
           s = r[1];
           if (A == 0) {
               q = Selectors.Utils.getByTagAndID(p, C, s);
           } else {
               var d = {},
               h = [];
               for (var y = 0,
               x = q.length; y &lt; x; y++) {
                   h = Selectors.Getters[a](h, q[y], C, s, d);
               }
               q = h;
           }
           var g = Selectors.Utils.parseSelector(z);
           if (g) {
               f = [];
               for (var v = 0,
               t = q.length; v &lt; t; v++) {
                   B = q[v];
                   if (Selectors.Utils.filter(B, g, u)) {
                       f.push(B);
                   }
               }
               q = f;
           }
       }
       return q;
   }
</PRE><P>};
Selectors.Getters = {
</P><PRE>   &quot; &quot;: function(j, h, k, a, f) {
       var d = Selectors.Utils.getByTagAndID(h, k, a);
       for (var c = 0,
       b = d.length; c &lt; b; c++) {
           var g = d[c];
           if (Selectors.Utils.chk(g, f)) {
               j.push(g);
           }
       }
       return j;
   },
   &quot;&gt;&quot;: function(j, h, k, a, g) {
       var c = Selectors.Utils.getByTagAndID(h, k, a);
       for (var f = 0,
       d = c.length; f &lt; d; f++) {
           var b = c[f];
           if (b.parentNode == h &amp;&amp; Selectors.Utils.chk(b, g)) {
               j.push(b);
           }
       }
       return j;
   },
   &quot;+&quot;: function(c, b, a, f, d) {
       while ((b = b.nextSibling)) {
           if (b.nodeType == 1) {
               if (Selectors.Utils.chk(b, d) &amp;&amp; Selectors.Filters.byTag(b, a) &amp;&amp; Selectors.Filters.byID(b, f)) {
                   c.push(b);
               }
               break;
           }
       }
       return c;
   },
   &quot;~&quot;: function(c, b, a, f, d) {
       while ((b = b.nextSibling)) {
           if (b.nodeType == 1) {
               if (!Selectors.Utils.chk(b, d)) {
                   break;
               }
               if (Selectors.Filters.byTag(b, a) &amp;&amp; Selectors.Filters.byID(b, f)) {
                   c.push(b);
               }
           }
       }
       return c;
   }
</PRE><P>};
Selectors.Filters = {
</P><PRE>   byTag: function(b, a) {
       return (a == &quot;*&quot; || (b.tagName &amp;&amp; b.tagName.toLowerCase() == a));
   },
   byID: function(a, b) {
       return (!b || (a.id &amp;&amp; a.id == b));
   },
   byClass: function(b, a) {
       return (b.className &amp;&amp; b.className.contains &amp;&amp; b.className.contains(a, &quot; &quot;));
   },
   byPseudo: function(a, d, c, b) {
       return d.call(a, c, b);
   },
   byAttribute: function(c, d, b, f) {
       var a = Element.prototype.getProperty.call(c, d);
       if (!a) {
           return (b == &quot;!=&quot;);
       }
       if (!b || f == undefined) {
           return true;
       }
       switch (b) {
       case &quot;=&quot;:
           return (a == f);
       case &quot;*=&quot;:
           return (a.contains(f));
       case &quot;^=&quot;:
           return (a.substr(0, f.length) == f);
       case &quot;$=&quot;:
           return (a.substr(a.length - f.length) == f);
       case &quot;!=&quot;:
           return (a != f);
       case &quot;~=&quot;:
           return a.contains(f, &quot; &quot;);
       case &quot;|=&quot;:
           return a.contains(f, &quot;-&quot;);
       }
       return false;
   }
</PRE><P>};
Selectors.Pseudo = new Hash({
</P><PRE>   checked: function() {
       return this.checked;
   },
   empty: function() {
       return ! (this.innerText || this.textContent || &quot;&quot;).length;
   },
   not: function(a) {
       return ! Element.match(this, a);
   },
   contains: function(a) {
       return (this.innerText || this.textContent || &quot;&quot;).contains(a);
   },
   &quot;first-child&quot;: function() {
       return Selectors.Pseudo.index.call(this, 0);
   },
   &quot;last-child&quot;: function() {
       var a = this;
       while ((a = a.nextSibling)) {
           if (a.nodeType == 1) {
               return false;
           }
       }
       return true;
   },
   &quot;only-child&quot;: function() {
       var b = this;
       while ((b = b.previousSibling)) {
           if (b.nodeType == 1) {
               return false;
           }
       }
       var a = this;
       while ((a = a.nextSibling)) {
           if (a.nodeType == 1) {
               return false;
           }
       }
       return true;
   },
   &quot;nth-child&quot;: function(h, f) {
       h = (h == undefined) ? &quot;n&quot;: h;
       var c = Selectors.Utils.parseNthArgument(h);
       if (c.special != &quot;n&quot;) {
           return Selectors.Pseudo[c.special].call(this, c.a, f);
       }
       var g = 0;
       f.positions = f.positions || {};
       var d = $uid(this);
       if (!f.positions[d]) {
           var b = this;
           while ((b = b.previousSibling)) {
               if (b.nodeType != 1) {
                   continue;
               }
               g++;
               var a = f.positions[$uid(b)];
               if (a != undefined) {
                   g = a + g;
                   break;
               }
           }
           f.positions[d] = g;
       }
       return (f.positions[d] % c.a == c.b);
   },
   index: function(a) {
       var b = this,
       c = 0;
       while ((b = b.previousSibling)) {
           if (b.nodeType == 1 &amp;&amp; ++c &gt; a) {
               return false;
           }
       }
       return (c == a);
   },
   even: function(b, a) {
       return Selectors.Pseudo[&quot;nth-child&quot;].call(this, &quot;2n+1&quot;, a);
   },
   odd: function(b, a) {
       return Selectors.Pseudo[&quot;nth-child&quot;].call(this, &quot;2n&quot;, a);
   },
   selected: function() {
       return this.selected;
   },
   enabled: function() {
       return (this.disabled === false);
   }
</PRE><P>});
Element.Events.domready = {
</P><PRE>   onAdd: function(a) {
       if (Browser.loaded) {
           a.call(this);
       }
   }
</PRE><P>}; (function() {
</P><PRE>   var b = function() {
       if (Browser.loaded) {
           return;
       }
       Browser.loaded = true;
       window.fireEvent(&quot;domready&quot;);
       document.fireEvent(&quot;domready&quot;);
   };
   window.addEvent(&quot;load&quot;, b);
   if (Browser.Engine.trident) {
       var a = document.createElement(&quot;div&quot;); (function() { ($try(function() {
               a.doScroll();
               return document.id(a).inject(document.body).set(&quot;html&quot;, &quot;temp&quot;).dispose();
           })) ? b() : arguments.callee.delay(50);
       })();
   } else {
       if (Browser.Engine.webkit &amp;&amp; Browser.Engine.version &lt; 525) { (function() { ([&quot;loaded&quot;, &quot;complete&quot;].contains(document.readyState)) ? b() : arguments.callee.delay(50);
           })();
       } else {
           document.addEvent(&quot;DOMContentLoaded&quot;, b);
       }
   }
</PRE><P>})();
var JSON = new Hash(this.JSON &amp;&amp; {
</P><PRE>   stringify: JSON.stringify,
   parse: JSON.parse
</PRE><P>}).extend({
</P><PRE>   $specialChars: {
       &quot;\b&quot;: &quot;\\b&quot;,
       &quot;\t&quot;: &quot;\\t&quot;,
       &quot;\n&quot;: &quot;\\n&quot;,
       &quot;\f&quot;: &quot;\\f&quot;,
       &quot;\r&quot;: &quot;\\r&quot;,
       '&quot;': '\\&quot;',
       &quot;\\&quot;: &quot;\\\\&quot;
   },
   $replaceChars: function(a) {
       return JSON.$specialChars[a] || &quot;\\u00&quot; + Math.floor(a.charCodeAt() / 16).toString(16) + (a.charCodeAt() % 16).toString(16);
   },
   encode: function(b) {
       switch ($type(b)) {
       case &quot;string&quot;:
           return '&quot;' + b.replace(/[\x00-\x1f\\&quot;]/g, JSON.$replaceChars) + '&quot;';
       case &quot;array&quot;:
           return &quot;[&quot; + String(b.map(JSON.encode).clean()) + &quot;]&quot;;
       case &quot;object&quot;:
       case &quot;hash&quot;:
           var a = [];
           Hash.each(b,
           function(f, d) {
               var c = JSON.encode(f);
               if (c) {
                   a.push(JSON.encode(d) + &quot;:&quot; + c);
               }
           });
           return &quot;{&quot; + a + &quot;}&quot;;
       case &quot;number&quot;:
       case &quot;boolean&quot;:
           return String(b);
       case false:
           return &quot;null&quot;;
       }
       return null;
   },
   decode: function(string, secure) {
       if ($type(string) != &quot;string&quot; || !string.length) {
           return null;
       }
       if (secure &amp;&amp; !(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(string.replace(/\\./g, &quot;@&quot;).replace(/&quot;[^&quot;\\\n\r]*&quot;/g, &quot;&quot;))) {
           return null;
       }
       return eval(&quot;(&quot; + string + &quot;)&quot;);
   }
</PRE><P>});
var Cookie = new Class({
</P><PRE>   Implements: Options,
   options: {
       path: false,
       domain: false,
       duration: false,
       secure: false,
       document: document
   },
   initialize: function(b, a) {
       this.key = b;
       this.setOptions(a);
   },
   write: function(b) {
       b = encodeURIComponent(b);
       if (this.options.domain) {
           b += &quot;; domain=&quot; + this.options.domain;
       }
       if (this.options.path) {
           b += &quot;; path=&quot; + this.options.path;
       }
       if (this.options.duration) {
           var a = new Date();
           a.setTime(a.getTime() + this.options.duration * 24 * 60 * 60 * 1000);
           b += &quot;; expires=&quot; + a.toGMTString();
       }
       if (this.options.secure) {
           b += &quot;; secure&quot;;
       }
       this.options.document.cookie = this.key + &quot;=&quot; + b;
       return this;
   },
   read: function() {
       var a = this.options.document.cookie.match(&quot;(?:^|;)\\s*&quot; + this.key.escapeRegExp() + &quot;=([^;]*)&quot;);
       return (a) ? decodeURIComponent(a[1]) : null;
   },
   dispose: function() {
       new Cookie(this.key, $merge(this.options, {
           duration: -1
       })).write(&quot;&quot;);
       return this;
   }
</PRE><P>});
Cookie.write = function(b, c, a) {
</P><PRE>   return new Cookie(b, a).write(c);
</PRE><P>};
Cookie.read = function(a) {
</P><PRE>   return new Cookie(a).read();
</PRE><P>};
Cookie.dispose = function(b, a) {
</P><PRE>   return new Cookie(b, a).dispose();
</PRE><P>};
var Swiff = new Class({
</P><PRE>   Implements: [Options],
   options: {
       id: null,
       height: 1,
       width: 1,
       container: null,
       properties: {},
       params: {
           quality: &quot;high&quot;,
           allowScriptAccess: &quot;always&quot;,
           wMode: &quot;transparent&quot;,
           swLiveConnect: true
       },
       callBacks: {},
       vars: {}
   },
   toElement: function() {
       return this.object;
   },
   initialize: function(m, n) {
       this.instance = &quot;Swiff_&quot; + $time();
       this.setOptions(n);
       n = this.options;
       var b = this.id = n.id || this.instance;
       var a = document.id(n.container);
       Swiff.CallBacks[this.instance] = {};
       var f = n.params,
       h = n.vars,
       g = n.callBacks;
       var i = $extend({
           height: n.height,
           width: n.width
       },
       n.properties);
       var l = this;
       for (var d in g) {
           Swiff.CallBacks[this.instance][d] = (function(o) {
               return function() {
                   return o.apply(l.object, arguments);
               };
           })(g[d]);
           h[d] = &quot;Swiff.CallBacks.&quot; + this.instance + &quot;.&quot; + d;
       }
       f.flashVars = Hash.toQueryString(h);
       if (Browser.Engine.trident) {
           i.classid = &quot;clsid:D27CDB6E-AE6D-11cf-96B8-444553540000&quot;;
           f.movie = m;
       } else {
           i.type = &quot;application/x-shockwave-flash&quot;;
           i.data = m;
       }
       var k = '&lt;object id=&quot;' + b + '&quot;';
       for (var j in i) {
           k += &quot; &quot; + j + '=&quot;' + i[j] + '&quot;';
       }
       k += &quot;&gt;&quot;;
       for (var c in f) {
           if (f[c]) {
               k += '&lt;param name=&quot;' + c + '&quot; value=&quot;' + f[c] + '&quot; /&gt;';
           }
       }
       k += &quot;&lt;/object&gt;&quot;;
       this.object = ((a) ? a.empty() : new Element(&quot;div&quot;)).set(&quot;html&quot;, k).firstChild;
   },
   replaces: function(a) {
       a = document.id(a, true);
       a.parentNode.replaceChild(this.toElement(), a);
       return this;
   },
   inject: function(a) {
       document.id(a, true).appendChild(this.toElement());
       return this;
   },
   remote: function() {
       return Swiff.remote.apply(Swiff, [this.toElement()].extend(arguments));
   }
</PRE><P>});
Swiff.CallBacks = {};
Swiff.remote = function(obj, fn) {
</P><PRE>   var rs = obj.CallFunction('&lt;invoke name=&quot;' + fn + '&quot; returntype=&quot;javascript&quot;&gt;' + __flash__argumentsToXML(arguments, 2) + &quot;&lt;/invoke&gt;&quot;);
   return eval(rs);
</PRE><P>};
var Fx = new Class({
</P><PRE>   Implements: [Chain, Events, Options],
   options: {
       fps: 50,
       unit: false,
       duration: 500,
       link: &quot;ignore&quot;
   },
   initialize: function(a) {
       this.subject = this.subject || this;
       this.setOptions(a);
       this.options.duration = Fx.Durations[this.options.duration] || this.options.duration.toInt();
       var b = this.options.wait;
       if (b === false) {
           this.options.link = &quot;cancel&quot;;
       }
   },
   getTransition: function() {
       return function(a) {
           return - (Math.cos(Math.PI * a) - 1) / 2;
       };
   },
   step: function() {
       var a = $time();
       if (a &lt; this.time + this.options.duration) {
           var b = this.transition((a - this.time) / this.options.duration);
           this.set(this.compute(this.from, this.to, b));
       } else {
           this.set(this.compute(this.from, this.to, 1));
           this.complete();
       }
   },
   set: function(a) {
       return a;
   },
   compute: function(c, b, a) {
       return Fx.compute(c, b, a);
   },
   check: function() {
       if (!this.timer) {
           return true;
       }
       switch (this.options.link) {
       case &quot;cancel&quot;:
           this.cancel();
           return true;
       case &quot;chain&quot;:
           this.chain(this.caller.bind(this, arguments));
           return false;
       }
       return false;
   },
   start: function(b, a) {
       if (!this.check(b, a)) {
           return this;
       }
       this.from = b;
       this.to = a;
       this.time = 0;
       this.transition = this.getTransition();
       this.startTimer();
       this.onStart();
       return this;
   },
   complete: function() {
       if (this.stopTimer()) {
           this.onComplete();
       }
       return this;
   },
   cancel: function() {
       if (this.stopTimer()) {
           this.onCancel();
       }
       return this;
   },
   onStart: function() {
       this.fireEvent(&quot;start&quot;, this.subject);
   },
   onComplete: function() {
       this.fireEvent(&quot;complete&quot;, this.subject);
       if (!this.callChain()) {
           this.fireEvent(&quot;chainComplete&quot;, this.subject);
       }
   },
   onCancel: function() {
       this.fireEvent(&quot;cancel&quot;, this.subject).clearChain();
   },
   pause: function() {
       this.stopTimer();
       return this;
   },
   resume: function() {
       this.startTimer();
       return this;
   },
   stopTimer: function() {
       if (!this.timer) {
           return false;
       }
       this.time = $time() - this.time;
       this.timer = $clear(this.timer);
       return true;
   },
   startTimer: function() {
       if (this.timer) {
           return false;
       }
       this.time = $time() - this.time;
       this.timer = this.step.periodical(Math.round(1000 / this.options.fps), this);
       return true;
   }
</PRE><P>});
Fx.compute = function(c, b, a) {
</P><PRE>   return (b - c) * a + c;
</PRE><P>};
Fx.Durations = {
</P><PRE>   &quot;short&quot;: 250,
   normal: 500,
   &quot;long&quot;: 1000
</PRE><P>};
Fx.CSS = new Class({
</P><PRE>   Extends: Fx,
   prepare: function(d, f, b) {
       b = $splat(b);
       var c = b[1];
       if (!$chk(c)) {
           b[1] = b[0];
           b[0] = d.getStyle(f);
       }
       var a = b.map(this.parse);
       return {
           from: a[0],
           to: a[1]
       };
   },
   parse: function(a) {
       a = $lambda(a)();
       a = (typeof a == &quot;string&quot;) ? a.split(&quot; &quot;) : $splat(a);
       return a.map(function(c) {
           c = String(c);
           var b = false;
           Fx.CSS.Parsers.each(function(g, f) {
               if (b) {
                   return;
               }
               var d = g.parse(c);
               if ($chk(d)) {
                   b = {
                       value: d,
                       parser: g
                   };
               }
           });
           b = b || {
               value: c,
               parser: Fx.CSS.Parsers.String
           };
           return b;
       });
   },
   compute: function(d, c, b) {
       var a = []; (Math.min(d.length, c.length)).times(function(f) {
           a.push({
               value: d[f].parser.compute(d[f].value, c[f].value, b),
               parser: d[f].parser
           });
       });
       a.$family = {
           name: &quot;fx:css:value&quot;
       };
       return a;
   },
   serve: function(c, b) {
       if ($type(c) != &quot;fx:css:value&quot;) {
           c = this.parse(c);
       }
       var a = [];
       c.each(function(d) {
           a = a.concat(d.parser.serve(d.value, b));
       });
       return a;
   },
   render: function(a, d, c, b) {
       a.setStyle(d, this.serve(c, b));
   },
   search: function(a) {
       if (Fx.CSS.Cache[a]) {
           return Fx.CSS.Cache[a];
       }
       var b = {};
       Array.each(document.styleSheets,
       function(f, d) {
           var c = f.href;
           if (c &amp;&amp; c.contains(&quot;://&quot;) &amp;&amp; !c.contains(document.domain)) {
               return;
           }
           var g = f.rules || f.cssRules;
           Array.each(g,
           function(k, h) {
               if (!k.style) {
                   return;
               }
               var j = (k.selectorText) ? k.selectorText.replace(/^\w+/,
               function(i) {
                   return i.toLowerCase();
               }) : null;
               if (!j || !j.test(&quot;^&quot; + a + &quot;$&quot;)) {
                   return;
               }
               Element.Styles.each(function(l, i) {
                   if (!k.style[i] || Element.ShortStyles[i]) {
                       return;
                   }
                   l = String(k.style[i]);
                   b[i] = (l.test(/^rgb/)) ? l.rgbToHex() : l;
               });
           });
       });
       return Fx.CSS.Cache[a] = b;
   }
</PRE><P>});
Fx.CSS.Cache = {};
Fx.CSS.Parsers = new Hash({
</P><PRE>   Color: {
       parse: function(a) {
           if (a.match(/^#[0-9a-f]{3,6}$/i)) {
               return a.hexToRgb(true);
           }
           return ((a = a.match(/(\d+),\s*(\d+),\s*(\d+)/))) ? [a[1], a[2], a[3]] : false;
       },
       compute: function(c, b, a) {
           return c.map(function(f, d) {
               return Math.round(Fx.compute(c[d], b[d], a));
           });
       },
       serve: function(a) {
           return a.map(Number);
       }
   },
   Number: {
       parse: parseFloat,
       compute: Fx.compute,
       serve: function(b, a) {
           return (a) ? b + a: b;
       }
   },
   String: {
       parse: $lambda(false),
       compute: $arguments(1),
       serve: $arguments(0)
   }
</PRE><P>});
Fx.Tween = new Class({
</P><PRE>   Extends: Fx.CSS,
   initialize: function(b, a) {
       this.element = this.subject = document.id(b);
       this.parent(a);
   },
   set: function(b, a) {
       if (arguments.length == 1) {
           a = b;
           b = this.property || this.options.property;
       }
       this.render(this.element, b, a, this.options.unit);
       return this;
   },
   start: function(c, f, d) {
       if (!this.check(c, f, d)) {
           return this;
       }
       var b = Array.flatten(arguments);
       this.property = this.options.property || b.shift();
       var a = this.prepare(this.element, this.property, b);
       return this.parent(a.from, a.to);
   }
</PRE><P>});
Element.Properties.tween = {
</P><PRE>   set: function(a) {
       var b = this.retrieve(&quot;tween&quot;);
       if (b) {
           b.cancel();
       }
       return this.eliminate(&quot;tween&quot;).store(&quot;tween:options&quot;, $extend({
           link: &quot;cancel&quot;
       },
       a));
   },
   get: function(a) {
       if (a || !this.retrieve(&quot;tween&quot;)) {
           if (a || !this.retrieve(&quot;tween:options&quot;)) {
               this.set(&quot;tween&quot;, a);
           }
           this.store(&quot;tween&quot;, new Fx.Tween(this, this.retrieve(&quot;tween:options&quot;)));
       }
       return this.retrieve(&quot;tween&quot;);
   }
</PRE><P>};
Element.implement({
</P><PRE>   tween: function(a, c, b) {
       this.get(&quot;tween&quot;).start(arguments);
       return this;
   },
   fade: function(c) {
       var f = this.get(&quot;tween&quot;),
       d = &quot;opacity&quot;,
       a;
       c = $pick(c, &quot;toggle&quot;);
       switch (c) {
       case &quot;in&quot;:
           f.start(d, 1);
           break;
       case &quot;out&quot;:
           f.start(d, 0);
           break;
       case &quot;show&quot;:
           f.set(d, 1);
           break;
       case &quot;hide&quot;:
           f.set(d, 0);
           break;
       case &quot;toggle&quot;:
           var b = this.retrieve(&quot;fade:flag&quot;, this.get(&quot;opacity&quot;) == 1);
           f.start(d, (b) ? 0 : 1);
           this.store(&quot;fade:flag&quot;, !b);
           a = true;
           break;
       default:
           f.start(d, arguments);
       }
       if (!a) {
           this.eliminate(&quot;fade:flag&quot;);
       }
       return this;
   },
   highlight: function(c, a) {
       if (!a) {
           a = this.retrieve(&quot;highlight:original&quot;, this.getStyle(&quot;background-color&quot;));
           a = (a == &quot;transparent&quot;) ? &quot;#fff&quot;: a;
       }
       var b = this.get(&quot;tween&quot;);
       b.start(&quot;background-color&quot;, c || &quot;#ffff88&quot;, a).chain(function() {
           this.setStyle(&quot;background-color&quot;, this.retrieve(&quot;highlight:original&quot;));
           b.callChain();
       }.bind(this));
       return this;
   }
</PRE><P>});
Fx.Morph = new Class({
</P><PRE>   Extends: Fx.CSS,
   initialize: function(b, a) {
       this.element = this.subject = document.id(b);
       this.parent(a);
   },
   set: function(a) {
       if (typeof a == &quot;string&quot;) {
           a = this.search(a);
       }
       for (var b in a) {
           this.render(this.element, b, a[b], this.options.unit);
       }
       return this;
   },
   compute: function(f, d, c) {
       var a = {};
       for (var b in f) {
           a[b] = this.parent(f[b], d[b], c);
       }
       return a;
   },
   start: function(b) {
       if (!this.check(b)) {
           return this;
       }
       if (typeof b == &quot;string&quot;) {
           b = this.search(b);
       }
       var f = {},
       d = {};
       for (var c in b) {
           var a = this.prepare(this.element, c, b[c]);
           f[c] = a.from;
           d[c] = a.to;
       }
       return this.parent(f, d);
   }
</PRE><P>});
Element.Properties.morph = {
</P><PRE>   set: function(a) {
       var b = this.retrieve(&quot;morph&quot;);
       if (b) {
           b.cancel();
       }
       return this.eliminate(&quot;morph&quot;).store(&quot;morph:options&quot;, $extend({
           link: &quot;cancel&quot;
       },
       a));
   },
   get: function(a) {
       if (a || !this.retrieve(&quot;morph&quot;)) {
           if (a || !this.retrieve(&quot;morph:options&quot;)) {
               this.set(&quot;morph&quot;, a);
           }
           this.store(&quot;morph&quot;, new Fx.Morph(this, this.retrieve(&quot;morph:options&quot;)));
       }
       return this.retrieve(&quot;morph&quot;);
   }
</PRE><P>};
Element.implement({
</P><PRE>   morph: function(a) {
       this.get(&quot;morph&quot;).start(a);
       return this;
   }
</PRE><P>});
Fx.implement({
</P><PRE>   getTransition: function() {
       var a = this.options.transition || Fx.Transitions.Sine.easeInOut;
       if (typeof a == &quot;string&quot;) {
           var b = a.split(&quot;:&quot;);
           a = Fx.Transitions;
           a = a[b[0]] || a[b[0].capitalize()];
           if (b[1]) {
               a = a[&quot;ease&quot; + b[1].capitalize() + (b[2] ? b[2].capitalize() : &quot;&quot;)];
           }
       }
       return a;
   }
</PRE><P>});
Fx.Transition = function(b, a) {
</P><PRE>   a = $splat(a);
   return $extend(b, {
       easeIn: function(c) {
           return b(c, a);
       },
       easeOut: function(c) {
           return 1 - b(1 - c, a);
       },
       easeInOut: function(c) {
           return (c &lt;= 0.5) ? b(2 * c, a) / 2 : (2 - b(2 * (1 - c), a)) / 2;
       }
   });
</PRE><P>};
Fx.Transitions = new Hash({
</P><PRE>   linear: $arguments(0)
</PRE><P>});
Fx.Transitions.extend = function(a) {
</P><PRE>   for (var b in a) {
       Fx.Transitions[b] = new Fx.Transition(a[b]);
   }
</PRE><P>};
Fx.Transitions.extend({
</P><PRE>   Pow: function(b, a) {
       return Math.pow(b, a[0] || 6);
   },
   Expo: function(a) {
       return Math.pow(2, 8 * (a - 1));
   },
   Circ: function(a) {
       return 1 - Math.sin(Math.acos(a));
   },
   Sine: function(a) {
       return 1 - Math.sin((1 - a) * Math.PI / 2);
   },
   Back: function(b, a) {
       a = a[0] || 1.618;
       return Math.pow(b, 2) * ((a + 1) * b - a);
   },
   Bounce: function(g) {
       var f;
       for (var d = 0,
       c = 1; 1; d += c, c /= 2) {
           if (g &gt;= (7 - 4 * d) / 11) {
               f = c * c - Math.pow((11 - 6 * d - 11 * g) / 4, 2);
               break;
           }
       }
       return f;
   },
   Elastic: function(b, a) {
       return Math.pow(2, 10 * --b) * Math.cos(20 * b * Math.PI * (a[0] || 1) / 3);
   }
</PRE><P>}); [&quot;Quad&quot;, &quot;Cubic&quot;, &quot;Quart&quot;, &quot;Quint&quot;].each(function(b, a) {
</P><PRE>   Fx.Transitions[b] = new Fx.Transition(function(c) {
       return Math.pow(c, [a + 2]);
   });
</PRE><P>});
var Request = new Class({
</P><PRE>   Implements: [Chain, Events, Options],
   options: {
       url: &quot;&quot;,
       data: &quot;&quot;,
       headers: {
           &quot;X-Requested-With&quot;: &quot;XMLHttpRequest&quot;,
           Accept: &quot;text/javascript, text/html, application/xml, text/xml, */*&quot;
       },
       async: true,
       format: false,
       method: &quot;post&quot;,
       link: &quot;ignore&quot;,
       isSuccess: null,
       emulation: true,
       urlEncoded: true,
       encoding: &quot;utf-8&quot;,
       evalScripts: false,
       evalResponse: false,
       noCache: false
   },
   initialize: function(a) {
       this.xhr = new Browser.Request();
       this.setOptions(a);
       this.options.isSuccess = this.options.isSuccess || this.isSuccess;
       this.headers = new Hash(this.options.headers);
   },
   onStateChange: function() {
       if (this.xhr.readyState != 4 || !this.running) {
           return;
       }
       this.running = false;
       this.status = 0;
       $try(function() {
           this.status = this.xhr.status;
       }.bind(this));
       this.xhr.onreadystatechange = $empty;
       if (this.options.isSuccess.call(this, this.status)) {
           this.response = {
               text: this.xhr.responseText,
               xml: this.xhr.responseXML
           };
           this.success(this.response.text, this.response.xml);
       } else {
           this.response = {
               text: null,
               xml: null
           };
           this.failure();
       }
   },
   isSuccess: function() {
       return ((this.status &gt;= 200) &amp;&amp; (this.status &lt; 300));
   },
   processScripts: function(a) {
       if (this.options.evalResponse || (/(ecma|java)script/).test(this.getHeader(&quot;Content-type&quot;))) {
           return $exec(a);
       }
       return a.stripScripts(this.options.evalScripts);
   },
   success: function(b, a) {
       this.onSuccess(this.processScripts(b), a);
   },
   onSuccess: function() {
       this.fireEvent(&quot;complete&quot;, arguments).fireEvent(&quot;success&quot;, arguments).callChain();
   },
   failure: function() {
       this.onFailure();
   },
   onFailure: function() {
       this.fireEvent(&quot;complete&quot;).fireEvent(&quot;failure&quot;, this.xhr);
   },
   setHeader: function(a, b) {
       this.headers.set(a, b);
       return this;
   },
   getHeader: function(a) {
       return $try(function() {
           return this.xhr.getResponseHeader(a);
       }.bind(this));
   },
   check: function() {
       if (!this.running) {
           return true;
       }
       switch (this.options.link) {
       case &quot;cancel&quot;:
           this.cancel();
           return true;
       case &quot;chain&quot;:
           this.chain(this.caller.bind(this, arguments));
           return false;
       }
       return false;
   },
   send: function(l) {
       if (!this.check(l)) {
           return this;
       }
       this.running = true;
       var j = $type(l);
       if (j == &quot;string&quot; || j == &quot;element&quot;) {
           l = {
               data: l
           };
       }
       var d = this.options;
       l = $extend({
           data: d.data,
           url: d.url,
           method: d.method
       },
       l);
       var h = l.data,
       b = String(l.url),
       a = l.method.toLowerCase();
       switch ($type(h)) {
       case &quot;element&quot;:
           h = document.id(h).toQueryString();
           break;
       case &quot;object&quot;:
       case &quot;hash&quot;:
           h = Hash.toQueryString(h);
       }
       if (this.options.format) {
           var k = &quot;format=&quot; + this.options.format;
           h = (h) ? k + &quot;&amp;&quot; + h: k;
       }
       if (this.options.emulation &amp;&amp; ![&quot;get&quot;, &quot;post&quot;].contains(a)) {
           var i = &quot;_method=&quot; + a;
           h = (h) ? i + &quot;&amp;&quot; + h: i;
           a = &quot;post&quot;;
       }
       if (this.options.urlEncoded &amp;&amp; a == &quot;post&quot;) {
           var c = (this.options.encoding) ? &quot;; charset=&quot; + this.options.encoding: &quot;&quot;;
           this.headers.set(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot; + c);
       }
       if (this.options.noCache) {
           var g = &quot;noCache=&quot; + new Date().getTime();
           h = (h) ? g + &quot;&amp;&quot; + h: g;
       }
       var f = b.lastIndexOf(&quot;/&quot;);
       if (f &gt; -1 &amp;&amp; (f = b.indexOf(&quot;#&quot;)) &gt; -1) {
           b = b.substr(0, f);
       }
       if (h &amp;&amp; a == &quot;get&quot;) {
           b = b + (b.contains(&quot;?&quot;) ? &quot;&amp;&quot;: &quot;?&quot;) + h;
           h = null;
       }
       this.xhr.open(a.toUpperCase(), b, this.options.async);
       this.xhr.onreadystatechange = this.onStateChange.bind(this);
       this.headers.each(function(n, m) {
           try {
               this.xhr.setRequestHeader(m, n);
           } catch(o) {
               this.fireEvent(&quot;exception&quot;, [m, n]);
           }
       },
       this);
       this.fireEvent(&quot;request&quot;);
       this.xhr.send(h);
       if (!this.options.async) {
           this.onStateChange();
       }
       return this;
   },
   cancel: function() {
       if (!this.running) {
           return this;
       }
       this.running = false;
       this.xhr.abort();
       this.xhr.onreadystatechange = $empty;
       this.xhr = new Browser.Request();
       this.fireEvent(&quot;cancel&quot;);
       return this;
   }
</PRE><P>}); (function() {
</P><PRE>   var a = {}; [&quot;get&quot;, &quot;post&quot;, &quot;put&quot;, &quot;delete&quot;, &quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;].each(function(b) {
       a[b] = function() {
           var c = Array.link(arguments, {
               url: String.type,
               data: $defined
           });
           return this.send($extend(c, {
               method: b
           }));
       };
   });
   Request.implement(a);
</PRE><P>})();
Element.Properties.send = {
</P><PRE>   set: function(a) {
       var b = this.retrieve(&quot;send&quot;);
       if (b) {
           b.cancel();
       }
       return this.eliminate(&quot;send&quot;).store(&quot;send:options&quot;, $extend({
           data: this,
           link: &quot;cancel&quot;,
           method: this.get(&quot;method&quot;) || &quot;post&quot;,
           url: this.get(&quot;action&quot;)
       },
       a));
   },
   get: function(a) {
       if (a || !this.retrieve(&quot;send&quot;)) {
           if (a || !this.retrieve(&quot;send:options&quot;)) {
               this.set(&quot;send&quot;, a);
           }
           this.store(&quot;send&quot;, new Request(this.retrieve(&quot;send:options&quot;)));
       }
       return this.retrieve(&quot;send&quot;);
   }
</PRE><P>};
Element.implement({
</P><PRE>   send: function(a) {
       var b = this.get(&quot;send&quot;);
       b.send({
           data: this,
           url: a || b.options.url
       });
       return this;
   }
</PRE><P>});
Request.HTML = new Class({
</P><PRE>   Extends: Request,
   options: {
       update: false,
       append: false,
       evalScripts: true,
       filter: false
   },
   processHTML: function(c) {
       var b = c.match(/&lt;body[^&gt;]*&gt;([\s\S]*?)&lt;\/body&gt;/i);
       c = (b) ? b[1] : c;
       var a = new Element(&quot;div&quot;);
       return $try(function() {
           var d = &quot;&lt;root&gt;&quot; + c + &quot;&lt;/root&gt;&quot;,
           h;
           if (Browser.Engine.trident) {
               h = new ActiveXObject(&quot;Microsoft.XMLDOM&quot;);
               h.async = false;
               h.loadXML(d);
           } else {
               h = new DOMParser().parseFromString(d, &quot;text/xml&quot;);
           }
           d = h.getElementsByTagName(&quot;root&quot;)[0];
           if (!d) {
               return null;
           }
           for (var g = 0,
           f = d.childNodes.length; g &lt; f; g++) {
               var j = Element.clone(d.childNodes[g], true, true);
               if (j) {
                   a.grab(j);
               }
           }
           return a;
       }) || a.set(&quot;html&quot;, c);
   },
   success: function(d) {
       var c = this.options,
       b = this.response;
       b.html = d.stripScripts(function(f) {
           b.javascript = f;
       });
       var a = this.processHTML(b.html);
       b.tree = a.childNodes;
       b.elements = a.getElements(&quot;*&quot;);
       if (c.filter) {
           b.tree = b.elements.filter(c.filter);
       }
       if (c.update) {
           document.id(c.update).empty().set(&quot;html&quot;, b.html);
       } else {
           if (c.append) {
               document.id(c.append).adopt(a.getChildren());
           }
       }
       if (c.evalScripts) {
           $exec(b.javascript);
       }
       this.onSuccess(b.tree, b.elements, b.html, b.javascript);
   }
</PRE><P>});
Element.Properties.load = {
</P><PRE>   set: function(a) {
       var b = this.retrieve(&quot;load&quot;);
       if (b) {
           b.cancel();
       }
       return this.eliminate(&quot;load&quot;).store(&quot;load:options&quot;, $extend({
           data: this,
           link: &quot;cancel&quot;,
           update: this,
           method: &quot;get&quot;
       },
       a));
   },
   get: function(a) {
       if (a || !this.retrieve(&quot;load&quot;)) {
           if (a || !this.retrieve(&quot;load:options&quot;)) {
               this.set(&quot;load&quot;, a);
           }
           this.store(&quot;load&quot;, new Request.HTML(this.retrieve(&quot;load:options&quot;)));
       }
       return this.retrieve(&quot;load&quot;);
   }
</PRE><P>};
Element.implement({
</P><PRE>   load: function() {
       this.get(&quot;load&quot;).send(Array.link(arguments, {
           data: Object.type,
           url: String.type
       }));
       return this;
   }
</PRE><P>});
Request.JSON = new Class({
</P><PRE>   Extends: Request,
   options: {
       secure: true
   },
   initialize: function(a) {
       this.parent(a);
       this.headers.extend({
           Accept: &quot;application/json&quot;,
           &quot;X-Request&quot;: &quot;JSON&quot;
       });
   },
   success: function(a) {
       this.response.json = JSON.decode(a, this.options.secure);
       this.onSuccess(this.response.json, a);
   }
</PRE><P>});
</P></DIV></DIV></DIV></DIV></BODY></HTML>