<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Heidelberg_software_jaws skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Heidelberg/software/jaws</SPAN></H1><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><DIV class="container" id="menucontainer"><DIV id="navcontainer-right-outer"><DIV id="navcontainer-right-inner"><UL class="nav navbar-nav navbar-right"><LI><A href="https://2015.igem.org/Team:Heidelberg/Achievements" class="menubox"><P class="menutext">Achievements</P></A></LI><LI class="dropdown"><A href="https://2015.igem.org/Team:Heidelberg/Results" class="dropdown-toggle menubox" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><P class="menutext">Results
                        </P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Results#Medalfulfillments"><P class="menutext dropdown-text">Medal fulfillments</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Results#AB"><P class="menutext dropdown-text">AptaBodies</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Results#RTSMS"><P class="menutext dropdown-text">Real time S.M.S.</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Results#LandV"><P class="menutext dropdown-text">Cystic fibrosis</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Results#CF"><P class="menutext dropdown-text">Labeling and vizualization</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Results#Modelling"><P class="menutext dropdown-text">Modeling and Software validation</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Results/Standardization"><P class="menutext dropdown-text">Standardization</P></A></LI></UL><LI class="dropdown"><A href="https://2015.igem.org/Team:Heidelberg/Overview" class="dropdown-toggle menubox" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><P class="menutext">Project
            </P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Overview"><P class="menutext dropdown-text">Overview</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Project/AB"><P class="menutext dropdown-text">AptaBodies</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/project/rtsms"><P class="menutext dropdown-text">Real time S.M.S.</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/project/cf"><P class="menutext dropdown-text">Cystic fibrosis</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/project/rd"><P class="menutext dropdown-text">Labelling and Visualization</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/project/hlpd"><P class="menutext dropdown-text">HRP based detection</P></A></LI><LI class="dropdown"><A href="https://2015.igem.org/Team:Heidelberg/Software" class="dropdown-toggle menubox" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><P class="menutext">Software
                        </P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/software/maws"><P class="menutext dropdown-text">MAWS</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/software/jaws"><P class="menutext dropdown-text">JAWS</P></A></LI><LI class="dropdownbox"><A href="
https://2015.igem.org/Team:Heidelberg/WikiTools"><P class="menutext dropdown-text">Wiki Tools</P></A></LI><LI class="dropdown"><A href="https://2015.igem.org/Team:Heidelberg/notebook/mm" class="dropdown-toggle menubox" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><P class="menutext">Notebook
                        </P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/notebook/ab"><P class="menutext dropdown-text">AptaBodies</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/notebook/rtsms"><P class="menutext dropdown-text">Real time S.M.S.</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/notebook/cf"><P class="menutext dropdown-text">Cystic fibrosis</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/notebook/rd"><P class="menutext dropdown-text">Labeling and vizualization</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/notebook/pc"><P class="menutext dropdown-text">Pulse chase</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/notebook/mm"><P class="menutext dropdown-text">Materials &amp; Methods</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Safety"><P class="menutext dropdown-text">Safety</P></A></LI><LI><A href="https://2015.igem.org/Team:Heidelberg/Parts" class="menubox"><P class="menutext">Parts</P></A></LI><LI class="dropdown"><A href="https://2015.igem.org/Team:Heidelberg/Team" class="dropdown-toggle menubox" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><P class="menutext">Team
                        </P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Team"><P class="menutext dropdown-text">Members</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Supervisors"><P class="menutext dropdown-text">Supervisors</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Collaborations"><P class="menutext dropdown-text">Collaboration</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Attributions"><P class="menutext dropdown-text">Attributions</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Sponsors"><P class="menutext dropdown-text">Sponsors</P></A></LI><LI class="dropdown"><A href="https://2015.igem.org/Team:Heidelberg/Modeling" class="dropdown-toggle menubox" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><P class="menutext">Modeling
                        </P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Modeling/aptakinetics"><P class="menutext dropdown-text">Aptamer Sensors</P></A></LI><LI class="dropdownbox"><A href="https://2015.igem.org/Team:Heidelberg/Modeling/rtsms"><P class="menutext dropdown-text">In vitro transcription</P></A></LI><LI><A href="https://2015.igem.org/Team:Heidelberg/Practices" class="menubox"><P class="menutext">Outreach</P></A></LI></DIV></DIV></DIV><NAV id="myNavmenu" class="navmenu navmenu-default navmenu-fixed-left offcanvas" role="navigation"><A class="navmenu-brand" href="https://2015.igem.org/Team:Heidelberg">iGEM Team Heidelberg 2015</A><UL class="nav navmenu-nav"><LI><A href="https://2015.igem.org/Team:Heidelberg/Achievements">Achievements</A></LI><LI><A href="https://2015.igem.org/Team:Heidelberg/Results">Results</A></LI><LI><A href="https://2015.igem.org/Team:Heidelberg/Overview">Project</A></LI><LI><A href="https://2015.igem.org/Team:Heidelberg/Software">Software</A></LI><LI><A href="https://2015.igem.org/Team:Heidelberg/notebook/mm">Notebook</A></LI><LI><A href="https://2015.igem.org/Team:Heidelberg/Parts">Parts</A></LI><LI><A href="https://2015.igem.org/Team:Heidelberg/Team">Team</A></LI><LI><A href="https://2015.igem.org/Team:Heidelberg/Modeling">Modeling</A></LI><LI><A href="https://2015.igem.org/Team:Heidelberg/Practices">Outreach</A></LI></UL></NAV><DIV class="container"><DIV class="content"><DIV class="row"><DIV class="col-lg-12"><DIV class="panel apanel‐default" style="min-height:318px;"><DIV class="panel‐body"><DIV class="row"><DIV class="col-lg-12"><P class="basicheader">Abstract</P><P class="basictext">Aptazymes, i.e. fusions of a catalytic ribozyme or DNAzyme with one or several aptamers, make construction of nucleic acids-based circuits responding to external stimuli possible, as their catalytic activity can be activated in either the presence or absence of the cognate ligand. The design of aptazymes has been hampered by the need for communication modules, which translate the binding of a ligand to the aptamer into a change of function in the catalytic nucleic acid. Standard procedure herefore is selection on the one hand and rational design on the other, resulting in tedious work which is not certain to succeed. To this day, only few attempts have been made to automatize the design process, which all target a specifically designed chassis ribozyme. Here we describe a software &quot;JAWS&quot; (Joining Aptamers Without Selection) using a criterion for computational selection of communication modules based upon the partition function, as well as energetic and entropic data. This is then used in a random search-like algorithm to extract optimal communication modules without the need for selection.                                </P></DIV></DIV></DIV></DIV></DIV></DIV></DIV><DIV class="row"><DIV class="col-lg-12"><DIV class="panel apanel‐default" style="min-height:318px;"><DIV class="panel‐body"><DIV class="row"><DIV class="col-lg-8"><P class="basicheader">Introduction</P><P class="basictext">
Designing communication modules for controlling functional nucleic acids usually requires either the use of known modules <X-REF>Kertsburg2002</X-REF>, or a selection process, whereby nucleic acids containing randomized modules are folded in the presence of the controlling ligand and assayed for their activity<X-REF>Kertsburg2002</X-REF>. This constitutes a tedious and lengthy process, with uncertain results, whereafter nucleic acids have to be folded in the presence of their ligand to display activity <X-REF>Penchovsky2013</X-REF>. This renders impractical all kinds of assays requiring more complicated switching behaviour, as increasingly complex arrays of communication modules would require increasingly complex selection schemes. Those selection schemes can prove restrictive to smaller labs, as well as iGEM teams, whose time and equipment-constraints do not allow for a selection process of multiple weeks. To alleviate the need for selection, a variety of methods have been developed for the case of the hammerhead ribozyme. These range from long, predefined communication modules <X-REF>Kertsburg2002</X-REF> to computational methods involving an energetic criterion, as well as random search algorithms to construct dynamically switching modules <X-REF>Penchovsky2013</X-REF><X-REF>Penchovsky2005</X-REF>. Although those approaches address the specific problem of the hammerhead ribozyme very well, they lack generality, as the hammerhead ribozymes used there are heaviliy modified to allow for an easy design process <X-REF>Penchovsky2013</X-REF>. Here we developed a completely general approach to the computational design of communication modules, relying on a variable set of constraints. We validated several computationally designed aptazymes with different combinations of aptamer and functional nucleic acid <I>in vitro</I> and found that all of them showed the desired switching behavior.</P></DIV><DIV class="col-lg-4"><DIV class="imagewrapper"><DIV class="imagewrapperheader">

                                    Communication Module Scheme

                                </DIV><DIV class="imagewrappercaption"><STRONG>

 Fig.1: The concept behind JAWS' communication modules:
 </STRONG><P class="basictext">

                                        The stem containing the aptamer (turquoise) contains base-pairs involving the aptamer in the inactive conformation. Activation occurs by strand displacement following ligand binding. Thereafter, another stem (black) forms, involving neither the ribozyme (purple) nor th aptamer.
                                    </P></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><DIV class="row"><DIV class="col-lg-12"><DIV class="panel apanel‐default" style="min-height:318px;"><DIV class="panel‐body"><DIV class="row"><DIV class="col-lg-12"><P class="basicheader">Algorithm</P><DIV class="col-lg-6"><DIV class="imagewrapper"><DIV class="imagewrapperheader">

                                            The JAWS Algorithm

                                        </DIV><DIV class="imagewrappercaption"><STRONG>

 Figure 2: JAWS uses a random search algorithm coupled to constraints to identify bistable nucleotide sequences:

 </STRONG><P class="basictext"> A partial template containing the ribozyme sequence 5' of the aptamer, the aptamer itself and the ribozyme sequence 3' of the aptamer is loaded, nucleotides between ribozyme and aptamer are randomised. Constraints enforcing active structure formation and inactive structure formation are enforced. Following that, sequences conforming to those constraints are accepted. 

                                            </P></DIV></DIV></DIV><DIV class="col-lg-6"><DIV class="imagewrapper"><DIV class="imagewrapperheader">

                                            Active and Inactive Constraints

                                        </DIV><DIV class="imagewrappercaption"><STRONG>

 Figure 3: The base pairing constraints ensure that chosen structures have the potential to fold into both an active and an inactive structre.

 </STRONG><P class="basictext">

                                                The base-pairing constraints of the JAWS algorithm are twofold: Firstly to ensure the existence of the active state, secondly to enforce the dominance of the inactive state, to remove background activity.

                                            </P></DIV></DIV></DIV><P class="basictext" style="clear:both">To generalize the design process of aptazymes we consider an aptamer inserted into a stem of the ribozyme of interest, adding a region of randomized nucleotides functioning as communication module. We constrain the active state of such an aptazyme to be such, that the aptamer is not bound by the rest of the structure, and all randomized nucleotides form a symmetric stem consistent with the consensus secondary structure of the native ribozyme. We constrain an inactive state to be such, that a part of the aptamer with a length of $N$
nucleotides forms a stem with the randomized nucleotides, and a portion of randomized nucleotides with length $N$. Hereafter, we shall call $N$ the shift of the communication module. By defining our communication module by a consensus structure, a length and a shift, we specify a constraint, checking for the existence of the active state consensus structure as well as the inactive structure, with a tolerance of $M$
wrong base pairs. We do so by inspection of the matrix of all base pair probabilities $P_{ij}$, yielded from the partition function $Z$ calculated for our sequence. We then discard all sequences not satisfying this constraint. Of the remaining sequences, only those that satisfy the constraint of the ensemble free energy difference between active and inactive state being less then the aptamer's interaction energy $\Delta{G_{Apt}}$ are retained. Using this approach, we arrive at functional communication modules for nucleic acids completely unrelated to the hammerhead ribozyme. In detail, the algorithm proceeds as follows:
</P><P class="basictext">
Secondary structure prediction is performed using a partition function based approach using ViennaRNA <X-REF>Lorenz</X-REF>, which then allows for the extraction of the nucleic acid's partition function $Z=\Sigma_{I}e^{-\beta{G_{I}}}$, with $I$ an index enumerating all potential base pairs, loops and stacks, and $G_{I}$ the corresponding Gibbs free energy. This in turn allows for the construction of the probability matrix $P_{I}=\frac{e^{-\beta{G_{I}}}}{Z}$ consisting of the base pair probabilities $P_{ij}=\frac{e^{-\beta{G_{ij}}}}{Z}: i,j\in{{Bases}}$. The matrix $P_{ij}$ will be the basis of our calculations. To construct a communication module, we use the following steps:
</P><OL class="basictext"><LI>
Given the position of a region $\mathcal{R}\subset{Sequence}$ comprising $2\cdot{N}+A$ bases, which should surround the aptamer $\mathcal{A}$ with length $A$, construct an active conformation. Henceforth, we shall refer to $N$ as the <I>stem length</I> and to the active conformation as <I>conformation $\mathcal{I}$</I>. This conformation is such, that the aptamer does not participate in base-pairing interactions with the rest of the functional nucleic acid. Furthermore, all $2\cdot{N}$ nucleotides of the region $\mathcal{R}\diagdown{\mathcal{A}}$ should participate in base pairing interactions, forming a stem of length $N$.
</LI><LI>
Given $R$, $N$ and a <I>shift</I> $S$, construct an inactive conformation, consisting of the first $N$ bases in $R$ pairing with the bases $N+A-S$ to $2\cdot{N}+A-S$. This conformation has a stem displaced by $S$ nucleotides from the active conformation, disturbing ribozyme activity. The inactive conformation shall be refered to as <I>conformation $\mathcal{II}$</I>.
</LI><LI>
Generate a sequence $\mathcal{S}$, with all nucleotides in $\mathcal{R}\diagdown\mathcal{A}$ randomised.
</LI><LI>
Compute the partition function $Z$ of $\mathcal{S}$ and the base pair probability matrix $P_{ij}$ at $\theta{ = 37°C}$. Check, if base pairs conforming to conformation $\mathcal{I}$ exist. This is true iff $P_{ij}\gt{P_{threshold}} \forall{(i,j)\in{\mathcal{I}}}$. If it is true, accept the sequence and move on to the next step. Else, return to step 3.
</LI><LI>
Using the base pair probability matrix $P_{ij}$, check if base pairs conforming to $\mathcal{II}$ exits. This is true iff $P_{ij}\gt{P_{threshold}} \forall{(i,j)\in{\mathcal{II}}}$. Requiring simultaneous conformity to $\mathcal{I}$ and $\mathcal{II}$ ensures that the structure is bistable, with local minima of free energy coinciding with the active and inactive structures, respectively. If this is true, accept this sequence, otherwise discard this sequence and return to step 3.
</LI><LI>
Compute the ensemble free energies $\Delta{G_{\mathcal{I}}}, \Delta{G_{\mathcal{II}}}$ for the conformations $\mathcal{I}$ and $\mathcal{II}$ respectively. Check if $\Delta{G_{\mathcal{I}}}\lt{E_{threshold}} \wedge \Delta{G_{\mathcal{II}}}\lt{E_{threshold}}$. This ensures that the secondary structures are stable and do not unravel easily at 37°C.
</LI><LI>
Compute the difference in ensemble free energies $\Delta{G} = \Delta{G_{\mathcal{I}}} - \Delta{G_{\mathcal{II}}}$ and constrain it to be smaller in its absolute value than a threshold $\Delta{E_{threshold}}$. This ensures that the bistability of the structure is given, and the structure switches conformation upon ligand binding. 
</LI><LI>
If all of the above apply, accept the sequence as a candidate sequence for the aptazyme. Else return to step 3.
</LI></OL><P class="basictext">In terms of the optimisation of $N$ and $S$ it is sufficient to run one simulation with relaxed constraints and evaluate the two dimensional histogram of points $(S,N)$ to find the region in $S,N$ space with the highest amount of candidates generated. This should correspond to the optimal stem length and shift for the aptamer ribozyme combination to be considered.</P><P class="basicheader">Results</P><P class="basictext">Our implementation of the algorithm, termed JAWS (Joining Aptamers Without SELEX), was done in Python using the ViennaRNA library and its Python bindings. JAWS, as well as its documentation, is freely available as Open Source on our <A href="https://github.com/igemsoftware/Heidelberg_15" target="_blank">GitHub repository</A>. We used JAWS to create functional DNA and RNA constructs exhibiting switching behavior. Thus, we constructed variants of the SpinachII fluorescent aptamer, which were shown to be switchable in real time by the presence or absence of ATP to a fluorescent and non-fluorescent state, respectively, using an aptamer from <X-REF>Sazani2004</X-REF>. Both variants outperformed a combination of previously published components (BBa_K1614012)<X-REF>Sazani2004</X-REF>, as they exhibited a wider dynamic range and stronger contrast between their active and inactive state. Furthermore, experimental evidence corresponded well to computational predictions, as candidate 2 (BBa_K1614015), predicted to have a more stable secondary structure, also exhibited slightly less background, better switching and a clearer spectrum than candidate 1 (BBa_K1614014). In addition, we created ligand switchable versions of the F8 DNAzyme <X-REF>Wang2014</X-REF>, which were designed to cleave in the presence of ampicillin, an oligonucleotide, ketamine, or p53. Their activity was confirmed in optimal buffer as well as in a more realistic setting for on-site detection of small molecule contamination in beverages (specifically in energy drinks spiked with carbenicillin). Finally, JAWS successfully computed switchable HRP mimicking DNAzymes for rapid characterisation of aptamers generated by MAWS, our aptamer designing tool. The switchable DNAzymes indeed showed increased activity in the presence of their respective ligands. There we observed, that different stem strength, as predicted by the software, using both free energy $\Delta{G}$ and an entropy like distance<X-REF>Kullback1951</X-REF> $S[P_{ij},\frac{1}{L}]=-\Sigma_{ij}P_{ij}\cdot{log(LP_{ij})}$, where lower energy and entropy indicates greater stem strength possessed less background activity as well as a higher dynamic range, whereas weak stems possessed higher background and a lower dynamic range.</P><P class="basicheader">Discussion</P><DIV class="col-lg-6"><DIV class="imagewrapper"><DIV class="imagewrapperheader">
            JAWS workflow
        </DIV><DIV class="imagewrappercaption"><STRONG>
           Figure 4: Predict-test-optimize cycle applied to JAWS.
        </STRONG><P class="basictext">
            Experimental data were crucial to the final design of JAWS, as they enabled us to make optimization of predicted aptazymes with respect to dynamic range and kinetics possible.
        </P></DIV></DIV></DIV><P class="basictext">Following the results from the switchable HRP assays, we implemented an additional constraint regulating  the stem strength of our candidates. Namely, at each step enforce that $S[P_{ij}]=\Sigma_{ij}P_{ij}\cdot{log({P_{ij}}\cdot{L})}$ be inside an interval of entropies$[S_{0},S_{1}]$. This ensures at least <I>in silico</I>, that the DNAzymes generated possess a certain stem strength, and thus a specified dynamic range and kinetic behaviour. Furthermore, the process of generating ligand gated, bistable structures is easily expandable to switching structures which are not simple stems. This is already implemented in our software, as the constraint regarding the existence of basepairs conforming to a stem can actually process any given secondary structure. Even so, we are currently limited to simulating DNAs and RNAs without any consideration of pseudoknots. This would be crucial for even more efficient aptazyme design, as many ribozymes feature extensive tertiary interactions to promote their activity. Again, this could be bypassed by adding additional terms to the partition function $Z$, corresponding to inter-loop interactions, which would allow for additional constraints stabilizing or destabilizing tertiary interactions in the presence or absence of ligands. That said, we expanded upon existing computational concepts, generalizing them to all functional nucleic acids and developed an extensible, modular, and universal constraint based system, allowing for the design of tailor-made ligand gated nucleic acids, fit to any specific problem.
                                        </P></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><DIV class="container"><DIV class="content"><DIV class="row"><DIV class="col-lg-12"><DIV class="panel panel‐default"><DIV class="panel‐heading"><H3 class="basicheader"> References </H3></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>