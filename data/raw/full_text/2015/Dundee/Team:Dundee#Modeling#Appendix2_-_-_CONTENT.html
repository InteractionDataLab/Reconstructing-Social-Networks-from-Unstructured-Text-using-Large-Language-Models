<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Dundee_Modeling_Appendix2 skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Dundee/Modeling/Appendix2</SPAN></H1><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><H1><HIGHLIGHT class="highlight">Dry Lab</HIGHLIGHT></H1><H3><HIGHLIGHT class="highlight">Appendix 2: Fingerprint Ageing Code</HIGHLIGHT></H3><FONT color="white"><SECTION id="about" class="row1"><DIV class="row"><DIV class="col-md-6"><H3>Principal Component Analysis Code</H3></DIV><DIV class="col-md-6"><H3>Squalene Epoxide Model Code</H3></DIV></DIV></SECTION><DIV class="container"><SECTION id="pca"><DIV class="row3"><DIV class="row"><DIV class="col-lg-12 feature" style=""><DIV class="row"><H2><B>Principal Component Analysis Code</B></H2><P> Principal component analysis was performed using MATLAB software to produce the data and figures described in the <A href="https://2015.igem.org/wiki/index.php?title=Team:Dundee/Modeling/Fingerprints#pca"><U><B>PCA Section</B></U></A>. The MATLAB file can be seen below, where green represents comments to aid in understanding the commands.</P><DIV class="content"><PRE class="codeinput"><SPAN class="comment"><B><FONT size="6" colour="green">MATLAB code from FrickPCA.m file</FONT></B></SPAN><SPAN class="comment"><B>%% Section 1. Importing the data from excel onto MATLAB.</B></SPAN>
filename = <SPAN class="string">'frick.xlsx'</SPAN>;
sheet = 3; <SPAN class="comment">% Sheet 3 contains only normalised values with all donors encapsulated into a single matrix.</SPAN>
xlrange = <SPAN class="string">'B2:JN16'</SPAN>;
A = xlsread(filename,sheet,xlrange);
<SPAN class="comment">% Raw chromatogram values have been normalized to the sum to take measure the quantitative changes between the different compounds analysed in the dataset.</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 2. Normalisation and Orthogonal transformation of data.</B></SPAN>
data = A; [M,N] = size(data); mn = mean(data,2);
dataN = data - repmat(mn,1,N) ; <SPAN class="comment">%data normalising by subtracting column mean from each column.</SPAN>
Z= dataN' / sqrt(N-1);
[u,S,PC] = svd(Z); <SPAN class="comment">%Singular value decomposition</SPAN>
signals = PC'*dataN;
<SPAN class="comment">% In order to have total control and understanding of the matrix operations behind the PCA, the traditional singular value decomposition linear algebraic operations were used instead of the PCA MATLAB function on the data.</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 3. Scoreplot of Interdonal variation with respect to first two PCs.</B></SPAN>
pointsize=50;
figure <SPAN class="comment">% Scoreplot of Interdonal variation</SPAN>
colour1= [ [0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0];[0.5 0.5 0]; [0.5 0.5 0];[0.5 0.5 0];[1 0 1]; [1 0 1];[1 0 1];[0 0.5 0.5]; [0 0.5 0.5];[0 0.5 0.5];[0.5 0 0];[0.5 0 0];[0.5 0 0]; [0 0.5 0];[0 0.5 0];[0 0.5 0]; [0 0 0.4]; [0 0 0.4];[0 0 0.4];[1 0 0];[1 0 0];[1 0 0]];
scatter(signals(1,:),signals(2,:),pointsize,colour1,<SPAN class="string">'filled'</SPAN>);
title(<SPAN class="string">'Scoreplot Of Interdonal Variation In Fingerprints Against Time W.R.T First Two Principal Components'</SPAN>)
xlabel(<SPAN class="string">'PC1'</SPAN>)
ylabel(<SPAN class="string">'PC2'</SPAN>)
text(-0.5,-0.201,<SPAN class="string">'\bf \fontsize{10}Donor Key'</SPAN>); <SPAN class="comment">%Artisan Legend</SPAN>
text(-0.5,-0.234,<SPAN class="string">'\bf \color[rgb]{0.5,0.5,0}{\fontsize{14}{\bullet}}  \color[rgb]{0,0,0} \fontsize{10}CB003'</SPAN>);
text(-0.5,-0.256,<SPAN class="string">'\bf \color[rgb]{1,0,1}{\fontsize{14}{\bullet}}  \color[rgb]{0,0,0} \fontsize{10}CA006'</SPAN>);
text(-0.5,-0.278,<SPAN class="string">'\bf \color[rgb]{0,0.5,0.5}{\fontsize{14}{\bullet}}  \color[rgb]{0,0,0} \fontsize{10}CB033'</SPAN>);
text(-0.5,-0.3,<SPAN class="string">'\bf \color[rgb]{0.5,0,0}{\fontsize{14}{\bullet}}  \color[rgb]{0,0,0} \fontsize{10}DA080'</SPAN>);
text(-0.5,-0.322,<SPAN class="string">'\bf \color[rgb]{0,0.5,0}{\fontsize{14}{\bullet}}  \color[rgb]{0,0,0} \fontsize{10}CA100'</SPAN>);
text(-0.5,-0.344,<SPAN class="string">'\bf \color[rgb]{0,0,0.4}{\fontsize{14}{\bullet}}  \color[rgb]{0,0,0} \fontsize{10}DA103'</SPAN>);
text(-0.5,-0.366,<SPAN class="string">'\bf \color[rgb]{1,0,0}{\fontsize{14}{\bullet}}  \color[rgb]{0,0,0} \fontsize{10}CB135'</SPAN>);
<SPAN class="comment">%This figure shows interdonal variation between all the donors and their aged fingerprint samples from all ageing intervals. Along the first PC, both inter and intra variation appear to increase. Moreover, this graph shows that individual donor samples DO NOT distinctly group together in a dichotomous manner which means that it would not be possible to deduce which fingerprint corresponds to which donor based on their Principal Components (PCs). The donor dots appear to follow faintly separate trajectories along the first PC axis, this suggests a distinct intradonal variation across all donors. This partly confirms the feasibility of a fingerprint age presumptive test. To further understand the nature of fingerprint compound degradation and its relationship between donors the following must be investigated: How much of which compounds contribute to forming the first two principal components?</SPAN><SPAN class="comment">%This would be explored through 'factor loading'(See Section 14 of code), How much do the first two PCs represent the total variance of the dataset?(See Section 7 of code), and if fingerprints from different donors age the at the same rate? (Section 4)</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 4. Scoreplot of composite degradation against time with respect to first two PCs.</B></SPAN>
figure
colour2=[ [1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];[1 1 0];<SPAN class="keyword">...</SPAN>
    [0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];[0 0 0.2];<SPAN class="keyword">...</SPAN>
    [0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0]; [0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];[0 0.3 0];<SPAN class="keyword">...</SPAN>
    [0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3]; [0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];[0 0.3 0.3];<SPAN class="keyword">...</SPAN>
    [0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];[0.4 0 0.4];<SPAN class="keyword">...</SPAN>
    [0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];[0.2 0 0];<SPAN class="keyword">...</SPAN>
    [0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];[0.1 0.1 0];<SPAN class="keyword">...</SPAN>
    [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6]; [0 0 0.6];[0 0 0.6];<SPAN class="keyword">...</SPAN>
    [0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];[0 0.9 0];<SPAN class="keyword">...</SPAN>
    [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6]; [0 0.6 0.6];[0 0.6 0.6];<SPAN class="keyword">...</SPAN>
    [0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];[0.8 0 0.8];<SPAN class="keyword">...</SPAN>
    [0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];[0.8 0 0];<SPAN class="keyword">...</SPAN>
    [0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0];[0.5 0.5 0]];
scatter(signals(1,:),signals(2,:),pointsize,colour2,<SPAN class="string">'filled'</SPAN>);
title(<SPAN class="string">'Scoreplot of Composite Degradation Against Time W.R.T The First Two Principal Components'</SPAN>);
xlabel(<SPAN class="string">'PC1'</SPAN>);
ylabel(<SPAN class="string">'PC2'</SPAN>);
text(0.62,0.2,<SPAN class="string">'Time (days)'</SPAN>);
text(0.62,0.15,<SPAN class="string">'\bf\color[rgb]{1,1,0}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 0'</SPAN>);
text(0.62,0.125,<SPAN class="string">'\bf\color[rgb]{0,0,0.2}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 2'</SPAN>);
text(0.62,0.1,<SPAN class="string">'\bf\color[rgb]{0,0.3,0}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 5'</SPAN>);
text(0.62,0.075,<SPAN class="string">'\bf\color[rgb]{0,0.3,0.3}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 7'</SPAN>);
text(0.62,0.05,<SPAN class="string">'\bf\color[rgb]{0.4,0,0.4}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 9'</SPAN>);
text(0.62,0.025,<SPAN class="string">'\bf\color[rgb]{0.2,0,0}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 12'</SPAN>);
text(0.62,0,<SPAN class="string">'\bf\color[rgb]{0.1,0.1,0}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 14'</SPAN>);
text(0.62,-0.025,<SPAN class="string">'\bf\color[rgb]{0,0,0.6}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 16'</SPAN>);
text(0.62,-0.05,<SPAN class="string">'\bf\color[rgb]{0,0.9,0}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 19'</SPAN>);
text(0.62,-0.075,<SPAN class="string">'\bf\color[rgb]{0,0.6,0.6}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 21'</SPAN>);
text(0.62,-0.1,<SPAN class="string">'\bf\color[rgb]{0.8,0,0.8}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 23'</SPAN>);
text(0.62,-0.125,<SPAN class="string">'\bf\color[rgb]{0.8,0,0}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 26'</SPAN>);
text(0.62,-0.15,<SPAN class="string">'\bf\color[rgb]{0.5,0.5,0}{\fontsize{14}{\bullet}} \color{black}\fontsize{10}Day 28'</SPAN>);
<SPAN class="comment">%This PC graph with respect to time is difficult to interpret due to the plethora of colours. The graph shows that the older a fingerprint is the more difficult it is to pinpoint their age. The lack of distinct groupings between tandem day intervals shows that fingerprints do not age at a constant rate across all donors. This suggests that to construct an age curve would require intra specificity. This rejects the hypothesis of creating a 'one size fits all age curve' for any random fingerprnt of age deduction. An attempt to explore the behaviour of aged fingerprints in greater detail is in section 17.</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 5. Scatterplot of entire signal data in 3D.</B></SPAN>
figure
scatter3(signals(1,:),signals(2,:),signals(3,:),pointsize,colour1,<SPAN class="string">'filled'</SPAN>)
title(<SPAN class="string">'Interdonal Variation Represented By First Three Principal Components'</SPAN>)
xlabel(<SPAN class="string">'PC1'</SPAN>)
ylabel(<SPAN class="string">'PC2'</SPAN>)
zlabel(<SPAN class="string">'PC3'</SPAN>)
correctedPosition = get(gcf,<SPAN class="string">'Position'</SPAN>) + [21 -125 0 0];
fps = 60; sec = 5;

vidObj = VideoWriter(<SPAN class="string">'newfile.avi'</SPAN>);
vidObj.Quality = 100;
vidObj.FrameRate = fps;

open(vidObj);
<SPAN class="keyword">for</SPAN> i=1:fps*sec
  camorbit(0.9,-0.1);
  writeVideo(vidObj,getframe(gcf, correctedPosition));
<SPAN class="keyword">end</SPAN>
close(vidObj);
<SPAN class="comment">% Video animation of Interdonal variation along first three PCs.</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 6. Comparing eigenvalues from PCA and SVD.</B></SPAN>
[COEFF,SCORE,latent]=pca(data'); <SPAN class="comment">% Transpose data before plugging into function</SPAN><SPAN class="comment">% PCA function was applied to the normalised data to compare the eigenvalues from the covariance matrix diag(S) with latent.</SPAN>
latent; <SPAN class="comment">% Returns the eigenvalues of the covariance matrix.</SPAN><SPAN class="comment">% latent omits zero value eigenvalues.</SPAN>
eigenSVD = diag(S).^2;
<SPAN class="comment">%Both methods of analysis are expected to provide different principal components but the same eigenvalues. This is a check for consistency.</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 7. Evaluation of variance coverage by principal components.</B></SPAN>
latentcov=cumsum(latent)./sum(latent);   <SPAN class="comment">% 98% of the variance is accounted for by first 3 PCs from PCA package.</SPAN>
Scoverage=cumsum(diag(S))./sum(diag(S)); <SPAN class="comment">% 76% of the var is accounted for by the first 3 PCs from svd package.</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 8. Curating normalised data for CB003 donor.</B></SPAN>
CB003_dataN = array2table(dataN);
filename2 = <SPAN class="string">'CB003Norm.xlsx'</SPAN>;
writetable(CB003_dataN,filename2,<SPAN class="string">'sheet'</SPAN>,1); <SPAN class="comment">%Used this newly created spreadsheet on Excel to</SPAN><SPAN class="comment">%manually cut out CB003 from the rest of the donors</SPAN>
SheetCB3_2 = 2;
xlrange1= <SPAN class="string">'A1:AM15'</SPAN>;
CB003 = xlsread(filename2,SheetCB3_2,xlrange1);
<SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 9. Curating normalised data to for CB135 donor.</B></SPAN>
SheetCB135_3 = 3;
CB135 = xlsread(filename2,SheetCB135_3,xlrange1);
<SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 10. CB003 interdonal PCA.</B></SPAN>
signalsCB003 = PC'*CB003;
figure
scatter(signalsCB003(1,:),signalsCB003(2,:),<SPAN class="string">'filled'</SPAN>)<SPAN class="comment">%first row all columns,second row all columns.</SPAN>
title(<SPAN class="string">'CB003 Interdonal Score Plot Analysis'</SPAN>)
xlabel(<SPAN class="string">'PC1'</SPAN>)
ylabel(<SPAN class="string">'PC2'</SPAN>)
<SPAN class="comment">%This figure shows how much the principle components for the whole sample reflects on the particular CB003 donor in other words, the interdonor variation between CB003 and the rest of the samples.</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 11. CB135 interdonal PCA.</B></SPAN>
signalsCB135 = PC'*CB135;
figure
scatter(signalsCB135(1,:),signalsCB135(2,:))
title(<SPAN class="string">'CB135 interdonal score plot analysis'</SPAN>)
xlabel(<SPAN class="string">'PC1'</SPAN>)
ylabel(<SPAN class="string">'PC2'</SPAN>)
<SPAN class="comment">% Measuring the degradation of composites from donor CB135 against the PCs</SPAN><SPAN class="comment">% of entire sample.</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 12. PCA Intravariation in CB003.</B></SPAN>
Z1 = CB003'/sqrt(N-1);
[u1,S1,PC1]= svd(Z1); <SPAN class="comment">% Principal matrix made only by CB003 sample alone</SPAN>
intrasignalCB3 = PC1'*CB003;
figure
scatter(intrasignalCB3(1,:),intrasignalCB3(2,:),<SPAN class="string">'filled'</SPAN>)
title(<SPAN class="string">'Intravariation scoreplot of first two principal components of Donor CB003'</SPAN>)
xlabel(<SPAN class="string">'PC1'</SPAN>)
ylabel(<SPAN class="string">'PC2'</SPAN>)
<SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 13. PCA Intravariation in CB135.</B></SPAN>
Z2 = CB135'/sqrt(N-1);
[u2,S2,PC2] = svd(Z2);
intrasignalCB135=PC2'*CB135;
figure
scatter(intrasignalCB135(1,:),intrasignalCB135(2,:))
title(<SPAN class="string">'Intravariation scoreplot of first two principal components of Donor CB135'</SPAN>)
xlabel(<SPAN class="string">'PC1'</SPAN>)
ylabel(<SPAN class="string">'PC2'</SPAN>)
<SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 14. Factor loadings for PC produced from SVD.</B></SPAN><SPAN class="comment">% This tells us how much each compound contributes to each of the primary three principal components given that PC1 accounts for 60% of the data according to the SVD reading on chapter 7.</SPAN>
signalT = signals';
figure
biplot(PC(:,1:2),<SPAN class="string">'scores'</SPAN>,signalT(:,1:2),<SPAN class="string">'VarLabels'</SPAN>,<SPAN class="keyword">...</SPAN>
    {<SPAN class="string">'Tetra'</SPAN>,<SPAN class="string">'Penta'</SPAN>,<SPAN class="string">'Hexa'</SPAN>,<SPAN class="string">'Palmitic'</SPAN>,<SPAN class="string">'Oliec'</SPAN>,<SPAN class="string">'Stearic'</SPAN>,<SPAN class="string">'Squalene'</SPAN>,<SPAN class="string">'C24'</SPAN>,<SPAN class="string">'C30:1'</SPAN>,<SPAN class="string">'C30:0'</SPAN>,<SPAN class="string">'CHO'</SPAN>,<SPAN class="string">'C32:1'</SPAN>,<SPAN class="string">'C32:0'</SPAN>,<SPAN class="string">'C34:1'</SPAN>,<SPAN class="string">'C34:0'</SPAN>},<SPAN class="string">'LineWidth'</SPAN>,2)
<SPAN class="comment">% (:,1:2) = all rows of first two columns--opposite to written algrebra</SPAN>
title(<SPAN class="string">'Biplot Of Finger Composite Contribution To First Two Principal Components [SVD]'</SPAN>)
xlabel(<SPAN class="string">'PC1'</SPAN>)
ylabel(<SPAN class="string">'PC2'</SPAN>)
figure
biplot(PC(:,1:3),<SPAN class="string">'scores'</SPAN>,signalT(:,1:3),<SPAN class="string">'VarLabels'</SPAN>,<SPAN class="keyword">...</SPAN>
    {<SPAN class="string">'Tetra'</SPAN>,<SPAN class="string">'Penta'</SPAN>,<SPAN class="string">'Hexa'</SPAN>,<SPAN class="string">'Palmitic'</SPAN>,<SPAN class="string">'Oliec'</SPAN>,<SPAN class="string">'Stearic'</SPAN>,<SPAN class="string">'Squalene'</SPAN>,<SPAN class="string">'C24'</SPAN>,<SPAN class="string">'C30:1'</SPAN>,<SPAN class="string">'C30:0'</SPAN>,<SPAN class="string">'CHO'</SPAN>,<SPAN class="string">'C32:1'</SPAN>,<SPAN class="string">'C32:0'</SPAN>,<SPAN class="string">'C34:1'</SPAN>,<SPAN class="string">'C34:0'</SPAN>})
title(<SPAN class="string">'Biplot Of Finger Composite Contribution To First Three Principal Components [SVD]'</SPAN>)
<SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 15. Factor loadings for PC produced from PCA package.</B></SPAN>
figure
biplot(COEFF(:,1:2),<SPAN class="string">'Scores'</SPAN>,SCORE(:,1:2),<SPAN class="string">'VarLabels'</SPAN>,<SPAN class="keyword">...</SPAN>
    {<SPAN class="string">'Tetra'</SPAN>,<SPAN class="string">'Penta'</SPAN>,<SPAN class="string">'Hexa'</SPAN>,<SPAN class="string">'Palmitic'</SPAN>,<SPAN class="string">'Oliec'</SPAN>,<SPAN class="string">'Stearic'</SPAN>,<SPAN class="string">'Squalene'</SPAN>,<SPAN class="string">'C24'</SPAN>,<SPAN class="string">'C30:1'</SPAN>,<SPAN class="string">'C30:0'</SPAN>,<SPAN class="string">'CHO'</SPAN>,<SPAN class="string">'C32:1'</SPAN>,<SPAN class="string">'C32:0'</SPAN>,<SPAN class="string">'C34:1'</SPAN>,<SPAN class="string">'C34:0'</SPAN>})
title(<SPAN class="string">'Biplot Of Finger Composite Contribution To First Two Principal Components [PCA]'</SPAN>)
xlabel(<SPAN class="string">'PC1'</SPAN>)
ylabel(<SPAN class="string">'PC2'</SPAN>)
figure
biplot(COEFF(:,1:3),<SPAN class="string">'Scores'</SPAN>,SCORE(:,1:3),<SPAN class="string">'VarLabels'</SPAN>,<SPAN class="keyword">...</SPAN>
     {<SPAN class="string">'Tetra'</SPAN>,<SPAN class="string">'Penta'</SPAN>,<SPAN class="string">'Hexa'</SPAN>,<SPAN class="string">'Palmitic'</SPAN>,<SPAN class="string">'Oliec'</SPAN>,<SPAN class="string">'Stearic'</SPAN>,<SPAN class="string">'Squalene'</SPAN>,<SPAN class="string">'C24'</SPAN>,<SPAN class="string">'C30:1'</SPAN>,<SPAN class="string">'C30:0'</SPAN>,<SPAN class="string">'CHO'</SPAN>,<SPAN class="string">'C32:1'</SPAN>,<SPAN class="string">'C32:0'</SPAN>,<SPAN class="string">'C34:1'</SPAN>,<SPAN class="string">'C34:0'</SPAN>})
 title(<SPAN class="string">'Biplot Of Finger Composite Contribution To First Three Principal Components [PCA]'</SPAN>)
 xlabel(<SPAN class="string">'PC1'</SPAN>)
 ylabel(<SPAN class="string">'PC2'</SPAN>)
 zlabel(<SPAN class="string">'PC3'</SPAN>)
 correctedPosition = get(gcf,<SPAN class="string">'Position'</SPAN>) + [21 -125 0 0];
fps = 60; sec = 10;

vidObj = VideoWriter(<SPAN class="string">'newfile.avi'</SPAN>);
vidObj.Quality = 100;
vidObj.FrameRate = fps;

open(vidObj);
<SPAN class="keyword">for</SPAN> i=1:fps*sec
  camorbit(0.9,-0.1);
  writeVideo(vidObj,getframe(gcf, correctedPosition));
<SPAN class="keyword">end</SPAN>
close(vidObj);
<SPAN class="comment">%Results suggest Squalene consitutes 80% of the first PC and 20% of the second.</SPAN><SPAN class="comment">%Palmitic acid constitutes 65% of second PC and -40% of first.</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 16. PC1 Axis Comparison.</B></SPAN><SPAN class="comment">%In order to view the relationship between time and squalene more clearly,the samples of each donor were grouped based on age and plotted against PC1 to see how the data aligns. This also aims to see whether or not squalene breaks down at a consistent rate across all donors.</SPAN><SPAN class="comment">% Day 0</SPAN>
Sheet_time_0 = 6;
xlranget0= <SPAN class="string">'B2:V16'</SPAN>;
day_0 = xlsread(filename,Sheet_time_0,xlranget0);
[M1,N1] = size(day_0); mn1 = mean(day_0,2);
day0N = day_0 - repmat(mn,1,N1);
signals_t_0 = PC'*day0N;

<SPAN class="comment">% Day 2</SPAN>
Sheet_time_2 = 6;
xlranget2= <SPAN class="string">'B19:V33'</SPAN>;
day_2 = xlsread(filename,Sheet_time_2,xlranget2);
mn2 = mean(day_2,2);
day2N = day_2 - repmat(mn2,1,N1);
signals_t_2 = PC'*day2N;

<SPAN class="comment">% Day 5</SPAN>
Sheet_time_5 = 6;
xlranget5= <SPAN class="string">'B36:V50'</SPAN>;
day_5 = xlsread(filename,Sheet_time_5,xlranget5);
mn3 = mean(day_5,2);
day5N = day_5 - repmat(mn3,1,N1);
signals_t_5 = PC'*day5N;

<SPAN class="comment">% Day 7</SPAN>
Sheet_time_7 = 6;
xlranget7= <SPAN class="string">'B53:V67'</SPAN>;
day_7 = xlsread(filename,Sheet_time_7,xlranget7);
mn4 = mean(day_7,2);
day7N = day_7 - repmat(mn4,1,N1);
signals_t_7 = PC'*day7N;

<SPAN class="comment">% Day 9</SPAN>
Sheet_time_9 = 6;
xlranget9= <SPAN class="string">'B70:V84'</SPAN>;
day_9 = xlsread(filename,Sheet_time_9,xlranget9);
mn5 = mean(day_9,2);
day9N = day_9 - repmat(mn5,1,N1);
signals_t_9 = PC'*day9N;

<SPAN class="comment">% Day 12</SPAN>
Sheet_time_12 = 6;
xlranget12= <SPAN class="string">'B87:V101'</SPAN>;
day_12 = xlsread(filename,Sheet_time_12,xlranget12);
mn6 = mean(day_12,2);
day12N = day_12 - repmat(mn6,1,N1);
signals_t_12 = PC'*day12N;

<SPAN class="comment">% Day 14</SPAN>
Sheet_time_14 = 6;
xlranget14= <SPAN class="string">'B104:V118'</SPAN>;
day_14 = xlsread(filename,Sheet_time_14,xlranget14);
mn7 = mean(day_14,2);
day14N = day_14 - repmat(mn7,1,N1);
signals_t_14 = PC'*day14N;

<SPAN class="comment">% Day 16</SPAN>
Sheet_time_16 = 6;
xlranget16= <SPAN class="string">'B121:V135'</SPAN>;
day_16 = xlsread(filename,Sheet_time_16,xlranget16);
mn8 = mean(day_16,2);
day16N = day_16 - repmat(mn8,1,N1);
signals_t_16 = PC'*day16N;

<SPAN class="comment">% Day 19</SPAN>
Sheet_time_19 = 6;
xlranget19= <SPAN class="string">'B138:V152'</SPAN>;
day_19 = xlsread(filename,Sheet_time_19,xlranget19);
mn9 = mean(day_19,2);
day19N = day_19 - repmat(mn9,1,N1);
signals_t_19 = PC'*day19N;

<SPAN class="comment">% Day 21</SPAN>
Sheet_time_21 = 6;
xlranget21= <SPAN class="string">'B155:V169'</SPAN>;
day_21 = xlsread(filename,Sheet_time_21,xlranget21);
mn10 = mean(day_21,2);
day21N = day_21 - repmat(mn10,1,N1);
signals_t_21 = PC'*day21N;

<SPAN class="comment">% Day 23</SPAN>
Sheet_time_23 = 6;
xlranget23= <SPAN class="string">'B172:V186'</SPAN>;
day_23 = xlsread(filename,Sheet_time_23,xlranget23);
mn11 = mean(day_23,2);
day23N = day_23 - repmat(mn11,1,N1);
signals_t_23 = PC'*day23N;

<SPAN class="comment">% Day 26</SPAN>
Sheet_time_26 = 6;
xlranget26= <SPAN class="string">'B187:V203'</SPAN>;
day_26 = xlsread(filename,Sheet_time_26,xlranget26);
mn12 = mean(day_26,2);
day26N = day_26 - repmat(mn12,1,N1);
signals_t_26 = PC'*day26N;

<SPAN class="comment">% Day 28</SPAN>
Sheet_time_28 = 6;
xlranget28= <SPAN class="string">'B155:V169'</SPAN>;
day_28 = xlsread(filename,Sheet_time_28,xlranget21);
mn13 = mean(day_28,2);
day28N = day_28 - repmat(mn13,1,N1);
signals_t_28 = PC'*day28N;


<SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 16.1 Interdonal Alignment Of Fingerprint Sample Age Along First Principal Alignment Axis.</B></SPAN>

spacing  = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1];
spacing1 = [0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2];
spacing2 = [0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3];
spacing3 = [0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4 0.4];
spacing4 = [0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5];
spacing5 = [0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6 0.6];
spacing6 = [0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7 0.7];
spacing7 = [0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8];
spacing8 = [0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9];
spacing9= [1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0];
spacing10= [1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1 1.1];
spacing11= [1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2 1.2];
spacing12= [1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3];
col1 = [1 1 0]; col2 = [0 0 0.2]; col3=[0 0.3 0];col4=[0 0.3 0.3]; col5=[0.4 0 0.4];col6=[0.2 0 0];col7=[0.1 0.1 0];
col8=[0 0 0.6];col9=[0 0.9 0];col10=[0 0.6 0.6];col11=[0.8 0 0.8];col12=[0.8 0 0];col13=[0.5 0.5 0];
figure
hold <SPAN class="string">on</SPAN>
scatter(signals_t_28(1,:),spacing12,50,col13,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 28</SPAN>
scatter(signals_t_26(1,:),spacing11,50,col12,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 26</SPAN>
scatter(signals_t_23(1,:),spacing10,50,col11,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 23</SPAN>
 scatter(signals_t_21(1,:),spacing9,50,col10,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 21</SPAN>
  scatter(signals_t_19(1,:),spacing8,50,col9,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 19</SPAN>
  scatter(signals_t_16(1,:),spacing7,50,col8,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 16</SPAN>
  scatter(signals_t_14(1,:),spacing6,50,col7,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 14</SPAN>
  scatter(signals_t_12(1,:),spacing5,50,col6,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 12</SPAN>
   scatter(signals_t_9(1,:),spacing4,50,col5,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 9</SPAN>
   scatter(signals_t_7(1,:),spacing3,50,col4,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 7</SPAN>
   scatter(signals_t_5(1,:),spacing2,50,col3,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 5</SPAN>
   scatter(signals_t_2(1,:),spacing1,50,col2,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 2</SPAN>
    scatter(signals_t_0(1,:),spacing,50,col1,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 0</SPAN>
hold <SPAN class="string">off</SPAN>
set(gca,<SPAN class="string">'YTick'</SPAN>,[],<SPAN class="string">'XTick'</SPAN>,[]);
title(<SPAN class="string">'Alignment of Aged Fingerprint Data with respect to First Principal Component Axis'</SPAN>);
xlabel(<SPAN class="string">'PC1'</SPAN>);
legend(<SPAN class="string">'day 28'</SPAN>,<SPAN class="string">'day 26'</SPAN>,<SPAN class="string">'day 23'</SPAN>,<SPAN class="string">'day 21'</SPAN>,<SPAN class="string">'day 19'</SPAN>,<SPAN class="string">'day 16'</SPAN>,<SPAN class="string">'day 14'</SPAN>,<SPAN class="string">'day 12'</SPAN>,<SPAN class="string">'day 9'</SPAN>,<SPAN class="string">'day 7'</SPAN>,<SPAN class="string">'day 5'</SPAN>,<SPAN class="string">'day 2'</SPAN>,<SPAN class="string">'day 0'</SPAN>);
<SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 16.2 Intradonal Alignment against PC1.</B></SPAN><SPAN class="comment">% CB003</SPAN><SPAN class="comment">% Day 0</SPAN>
Sheet_CB3_0 = 2;
xlrangeCB3_0= <SPAN class="string">'B2:D16'</SPAN>;
cb3_0 = xlsread(filename,Sheet_CB3_0,xlrangeCB3_0);
[M2,N2] = size(cb3_0); mncb31 = mean(cb3_0,2);
cb3_0N = cb3_0 - repmat(mn,1,N2);
signals_cb3_0 = PC'*cb3_0N;
<SPAN class="comment">% Day 2</SPAN>
Sheet_cb3_2 = 2;
xlrangeCB3_2= <SPAN class="string">'E2:G16'</SPAN>;
cb3_2 = xlsread(filename,Sheet_cb3_2,xlrangeCB3_2);
mncb3_2 = mean(cb3_2,2);
cb3_2N = cb3_2 - repmat(mncb3_2,1,N2);
signals_cb3_2 = PC'*cb3_2N;
<SPAN class="comment">% Day 5</SPAN>
Sheet_cb3_5 = 2;
xlrangeCB3_5= <SPAN class="string">'H2:J16'</SPAN>;
cb3_5 = xlsread(filename,Sheet_cb3_5,xlrangeCB3_5);
mncb3_3 = mean(cb3_5,2);
cb3_5N = cb3_5 - repmat(mncb3_3,1,N2);
signals_cb3_5 = PC'*cb3_5N;
<SPAN class="comment">% Day 7</SPAN>
Sheet_cb3_7 = 2;
xlrangeCB_7= <SPAN class="string">'K2:M16'</SPAN>;
cb3_7 = xlsread(filename,Sheet_cb3_7,xlrangeCB_7);
mncb4 = mean(cb3_7,2);
cb3_7N = cb3_7 - repmat(mncb4,1,N2);
signals_cb3_7 = PC'*cb3_7N;
<SPAN class="comment">% Day 9</SPAN>
Sheet_cb3_9 = 2;
xlrangeCB_9= <SPAN class="string">'N2:P16'</SPAN>;
cb3_9 = xlsread(filename,Sheet_cb3_9,xlrangeCB_9);
mncb5 = mean(cb3_9,2);
cb3_9N = cb3_9 - repmat(mncb5,1,N2);
signals_cb3_9 = PC'*cb3_9N;
<SPAN class="comment">% Day 12</SPAN>
Sheet_cb3_12 = 2;
xlrangeCB12= <SPAN class="string">'Q2:S16'</SPAN>;
cb3_12 = xlsread(filename,Sheet_cb3_12,xlrangeCB12);
mncb6 = mean(cb3_12,2);
cb3_12N = cb3_12 - repmat(mncb6,1,N2);
signals_cb3_12 = PC'*cb3_12N;
<SPAN class="comment">% Day 14</SPAN>
Sheet_CB3_14 = 2;
xlrangeCB14= <SPAN class="string">'T2:V16'</SPAN>;
cb3_14 = xlsread(filename,Sheet_CB3_14,xlrangeCB14);
mncb7 = mean(cb3_14,2);
cb3_14N = cb3_14 - repmat(mncb7,1,N2);
signals_cb3_14 = PC'*cb3_14N;
<SPAN class="comment">% Day 16</SPAN>
Sheet_CB3_16 = 2;
xlrangeCB16= <SPAN class="string">'W2:Y16'</SPAN>;
cb3_16 = xlsread(filename,Sheet_CB3_16,xlrangeCB16);
mncb8 = mean(cb3_16,2);
cb3_16N = cb3_16 - repmat(mncb8,1,N2);
signals_cb3_16 = PC'*cb3_16N;
<SPAN class="comment">% Day 19</SPAN>
Sheet_CB3_19 = 2;
xlrangeCB19= <SPAN class="string">'Z2:AB16'</SPAN>;
cb3_19 = xlsread(filename,Sheet_CB3_19,xlrangeCB19);
mncb9 = mean(cb3_19,2);
cb3_19N = cb3_19 - repmat(mncb9,1,N2);
signals_cb3_19 = PC'*cb3_19N;
<SPAN class="comment">% Day 21</SPAN>
Sheet_CB3_21 = 2;
xlrangeCB21= <SPAN class="string">'AC2:AE16'</SPAN>;
cb3_21 = xlsread(filename,Sheet_CB3_21,xlrangeCB21);
mncb10 = mean(cb3_21,2);
cb3_21N = cb3_21 - repmat(mncb10,1,N2);
signals_cb3_21 = PC'*cb3_21N;
<SPAN class="comment">% Day 23</SPAN>
Sheet_CB3_23 = 2;
xlrangeCB23= <SPAN class="string">'AF2:AH16'</SPAN>;
cb3_23 = xlsread(filename,Sheet_CB3_23,xlrangeCB23);
mncb11 = mean(cb3_23,2);
cb3_23N = cb3_23 - repmat(mncb11,1,N2);
signals_cb3_23 = PC'*cb3_23N;
<SPAN class="comment">% Day 26</SPAN>
Sheet_CB3_26 = 2;
xlrangeCB26= <SPAN class="string">'AI2:AK16'</SPAN>;
cb3_26 = xlsread(filename,Sheet_CB3_26,xlrangeCB26);
mncb13 = mean(cb3_26,2);
cb3_26N = cb3_26 - repmat(mncb13,1,N2);
signals_cb3_26 = PC'*cb3_26N;
<SPAN class="comment">% Day 28</SPAN>
Sheet_CB3_28 = 2;
xlrangeCB28= <SPAN class="string">'AL2:AN16'</SPAN>;
cb3_28 = xlsread(filename,Sheet_CB3_28,xlrangeCB28);
mncb14 = mean(cb3_28,2);
cb3_28N = cb3_28 - repmat(mncb14,1,N2);
signals_cb3_28 = PC'*cb3_28N;
<SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 16.3.</B></SPAN><SPAN class="comment">%Intraspecific CB003 PC1 Alignment</SPAN>
spacing  = [0.1 0.1 0.1 ];
spacing1 = [0.2 0.2 0.2 ];
spacing2 = [0.3 0.3 0.3 ];
spacing3 = [0.4 0.4 0.4 ];
spacing4 = [0.5 0.5 0.5 ];
spacing5 = [0.6 0.6 0.6 ];
spacing6 = [0.7 0.7 0.7 ];
spacing7 = [0.8 0.8 0.8 ];
spacing8 = [0.9 0.9 0.9 ];
spacing9= [1.0 1.0 1.0 ];
spacing10= [1.1 1.1 1.1 ];
spacing11= [1.2 1.2 1.2 ];
spacing12= [1.3 1.3 1.3 ];
col1 = [1 1 0]; col2 = [0 0 0.2]; col3=[0 0.3 0];col4=[0 0.3 0.3]; col5=[0.4 0 0.4];col6=[0.2 0 0];col7=[0.1 0.1 0];
col8=[0 0 0.6];col9=[0 0.9 0];col10=[0 0.6 0.6];col11=[0.8 0 0.8];col12=[0.8 0 0];col13=[0.5 0.5 0];
figure
hold <SPAN class="string">on</SPAN>
scatter(signals_cb3_28(1,:),spacing12,50,col13,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 28</SPAN>
scatter(signals_cb3_26(1,:),spacing11,50,col12,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 26</SPAN>
scatter(signals_cb3_23(1,:),spacing10,50,col11,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 23</SPAN>
 scatter(signals_cb3_21(1,:),spacing9,50,col10,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 21</SPAN>
  scatter(signals_cb3_19(1,:),spacing8,50,col9,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 19</SPAN>
  scatter(signals_cb3_16(1,:),spacing7,50,col8,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 16</SPAN>
  scatter(signals_cb3_14(1,:),spacing6,50,col7,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 14</SPAN>
  scatter(signals_cb3_12(1,:),spacing5,50,col6,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 12</SPAN>
   scatter(signals_cb3_9(1,:),spacing4,50,col5,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 9</SPAN>
   scatter(signals_cb3_7(1,:),spacing3,50,col4,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 7</SPAN>
   scatter(signals_cb3_5(1,:),spacing2,50,col3,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 5</SPAN>
   scatter(signals_cb3_2(1,:),spacing1,50,col2,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 2</SPAN>
    scatter(signals_cb3_0(1,:),spacing,50,col1,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 0</SPAN>
hold <SPAN class="string">off</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 16.31 Donor CB135 PC1 Alignment.</B></SPAN><SPAN class="comment">% CB135</SPAN><SPAN class="comment">% Day 0</SPAN>
Sheet_CB135_0 = 7;
xlrangeCB3_0= <SPAN class="string">'B2:D16'</SPAN>;
cb3_0 = xlsread(filename,Sheet_CB3_0,xlrangeCB3_0);
[M2,N2] = size(cb3_0); mncb31 = mean(cb3_0,2);
cb3_0N = cb3_0 - repmat(mn,1,N2);
signals_cb3_0 = PC'*cb3_0N;
<SPAN class="comment">% Day 2</SPAN>
Sheet_cb3_2 = 2;
xlrangeCB3_2= <SPAN class="string">'E2:G16'</SPAN>;
cb3_2 = xlsread(filename,Sheet_cb3_2,xlrangeCB3_2);
mncb3_2 = mean(cb3_2,2);
cb3_2N = cb3_2 - repmat(mncb3_2,1,N2);
signals_cb3_2 = PC'*cb3_2N;
<SPAN class="comment">% Day 5</SPAN>
Sheet_cb3_5 = 7;
xlrangeCB3_5= <SPAN class="string">'H2:J16'</SPAN>;
cb3_5 = xlsread(filename,Sheet_cb3_5,xlrangeCB3_5);
mncb3_3 = mean(cb3_5,2);
cb3_5N = cb3_5 - repmat(mncb3_3,1,N2);
signals_cb3_5 = PC'*cb3_5N;
<SPAN class="comment">% Day 7</SPAN>
Sheet_cb3_7 = 7;
xlrangeCB_7= <SPAN class="string">'K2:M16'</SPAN>;
cb3_7 = xlsread(filename,Sheet_cb3_7,xlrangeCB_7);
mncb4 = mean(cb3_7,2);
cb3_7N = cb3_7 - repmat(mncb4,1,N2);
signals_cb3_7 = PC'*cb3_7N;
<SPAN class="comment">% Day 9</SPAN>
Sheet_cb3_9 = 7;
xlrangeCB_9= <SPAN class="string">'N2:P16'</SPAN>;
cb3_9 = xlsread(filename,Sheet_cb3_9,xlrangeCB_9);
mncb5 = mean(cb3_9,2);
cb3_9N = cb3_9 - repmat(mncb5,1,N2);
signals_cb3_9 = PC'*cb3_9N;
<SPAN class="comment">% Day 12</SPAN>
Sheet_cb3_12 = 7;
xlrangeCB12= <SPAN class="string">'Q2:S16'</SPAN>;
cb3_12 = xlsread(filename,Sheet_cb3_12,xlrangeCB12);
mncb6 = mean(cb3_12,2);
cb3_12N = cb3_12 - repmat(mncb6,1,N2);
signals_cb3_12 = PC'*cb3_12N;
<SPAN class="comment">% Day 14</SPAN>
Sheet_CB3_14 = 7;
xlrangeCB14= <SPAN class="string">'T2:V16'</SPAN>;
cb3_14 = xlsread(filename,Sheet_CB3_14,xlrangeCB14);
mncb7 = mean(cb3_14,2);
cb3_14N = cb3_14 - repmat(mncb7,1,N2);
signals_cb3_14 = PC'*cb3_14N;
<SPAN class="comment">% Day 16</SPAN>
Sheet_CB3_16 = 7;
xlrangeCB16= <SPAN class="string">'W2:Y16'</SPAN>;
cb3_16 = xlsread(filename,Sheet_CB3_16,xlrangeCB16);
mncb8 = mean(cb3_16,2);
cb3_16N = cb3_16 - repmat(mncb8,1,N2);
signals_cb3_16 = PC'*cb3_16N;
<SPAN class="comment">% Day 19</SPAN>
Sheet_CB3_19 = 7;
xlrangeCB19= <SPAN class="string">'Z2:AB16'</SPAN>;
cb3_19 = xlsread(filename,Sheet_CB3_19,xlrangeCB19);
mncb9 = mean(cb3_19,2);
cb3_19N = cb3_19 - repmat(mncb9,1,N2);
signals_cb3_19 = PC'*cb3_19N;
<SPAN class="comment">% Day 21</SPAN>
Sheet_CB3_21 = 7;
xlrangeCB21= <SPAN class="string">'AC2:AE16'</SPAN>;
cb3_21 = xlsread(filename,Sheet_CB3_21,xlrangeCB21);
mncb10 = mean(cb3_21,2);
cb3_21N = cb3_21 - repmat(mncb10,1,N2);
signals_cb3_21 = PC'*cb3_21N;
<SPAN class="comment">% Day 23</SPAN>
Sheet_CB3_23 = 7;
xlrangeCB23= <SPAN class="string">'AF2:AH16'</SPAN>;
cb3_23 = xlsread(filename,Sheet_CB3_23,xlrangeCB23);
mncb11 = mean(cb3_23,2);
cb3_23N = cb3_23 - repmat(mncb11,1,N2);
signals_cb3_23 = PC'*cb3_23N;
<SPAN class="comment">% Day 26</SPAN>
Sheet_CB3_26 = 7;
xlrangeCB26= <SPAN class="string">'AI2:AK16'</SPAN>;
cb3_26 = xlsread(filename,Sheet_CB3_26,xlrangeCB26);
mncb13 = mean(cb3_26,2);
cb3_26N = cb3_26 - repmat(mncb13,1,N2);
signals_cb3_26 = PC'*cb3_26N;
<SPAN class="comment">% Day 28</SPAN>
Sheet_CB3_28 = 7;
xlrangeCB28= <SPAN class="string">'AL2:AN16'</SPAN>;
cb3_28 = xlsread(filename,Sheet_CB3_28,xlrangeCB28);
mncb14 = mean(cb3_28,2);
cb3_28N = cb3_28 - repmat(mncb14,1,N2);
signals_cb3_28 = PC'*cb3_28N;
spacing  = [0.1 0.1 0.1 ];
spacing1 = [0.2 0.2 0.2 ];
spacing2 = [0.3 0.3 0.3 ];
spacing3 = [0.4 0.4 0.4 ];
spacing4 = [0.5 0.5 0.5 ];
spacing5 = [0.6 0.6 0.6 ];
spacing6 = [0.7 0.7 0.7 ];
spacing7 = [0.8 0.8 0.8 ];
spacing8 = [0.9 0.9 0.9 ];
spacing9= [1.0 1.0 1.0 ];
spacing10= [1.1 1.1 1.1 ];
spacing11= [1.2 1.2 1.2 ];
spacing12= [1.3 1.3 1.3 ];
col1 = [1 1 0]; col2 = [0 0 0.2]; col3=[0 0.3 0];col4=[0 0.3 0.3]; col5=[0.4 0 0.4];col6=[0.2 0 0];col7=[0.1 0.1 0];
col8=[0 0 0.6];col9=[0 0.9 0];col10=[0 0.6 0.6];col11=[0.8 0 0.8];col12=[0.8 0 0];col13=[0.5 0.5 0];
figure
hold <SPAN class="string">on</SPAN>
scatter(signals_cb3_28(1,:),spacing12,50,col13,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 28</SPAN>
scatter(signals_cb3_26(1,:),spacing11,50,col12,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 26</SPAN>
scatter(signals_cb3_23(1,:),spacing10,50,col11,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 23</SPAN>
 scatter(signals_cb3_21(1,:),spacing9,50,col10,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 21</SPAN>
  scatter(signals_cb3_19(1,:),spacing8,50,col9,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 19</SPAN>
  scatter(signals_cb3_16(1,:),spacing7,50,col8,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 16</SPAN>
  scatter(signals_cb3_14(1,:),spacing6,50,col7,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 14</SPAN>
  scatter(signals_cb3_12(1,:),spacing5,50,col6,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 12</SPAN>
   scatter(signals_cb3_9(1,:),spacing4,50,col5,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 9</SPAN>
   scatter(signals_cb3_7(1,:),spacing3,50,col4,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 7</SPAN>
   scatter(signals_cb3_5(1,:),spacing2,50,col3,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 5</SPAN>
   scatter(signals_cb3_2(1,:),spacing1,50,col2,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 2</SPAN>
    scatter(signals_cb3_0(1,:),spacing,50,col1,<SPAN class="string">'filled'</SPAN>); <SPAN class="comment">% day 0</SPAN>
hold <SPAN class="string">off</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 17. Age Curves Of Major Composites Found In Principal Components For Each Donor.</B></SPAN><SPAN class="comment">% Donor CB003</SPAN>
t = [ 0 2 5 7 9 12 14 16 19 21 23 26 28];
xlrange3 =<SPAN class="string">'B21:N21'</SPAN>; <SPAN class="comment">%sq</SPAN>
xlrange4 =<SPAN class="string">'B22:N22'</SPAN>; <SPAN class="comment">%palm</SPAN>
xlrange5 =<SPAN class="string">'B23:N23'</SPAN>; <SPAN class="comment">%hexa</SPAN>
agecurvCB3SQ= xlsread(filename,sheet,xlrange3);
agecurvCB3PM= xlsread(filename,sheet,xlrange4);
agecurvCB3HX= xlsread(filename,sheet,xlrange5);
figure
a=agecurvCB3SQ;
b=agecurvCB3PM;
c=agecurvCB3HX;
e =std(a)*ones(size(t));
e1=std(b)*ones(size(t));
e2=std(c)*ones(size(t));
hold <SPAN class="string">on</SPAN>
a1 = plot(t,a,<SPAN class="string">'r'</SPAN>);
a2 = plot(t,b,<SPAN class="string">'b'</SPAN>);
a3 = plot(t,c,<SPAN class="string">'g'</SPAN>);
errorbar(t,a,e,<SPAN class="string">'r'</SPAN>);
errorbar(t,b,e1,<SPAN class="string">'b'</SPAN>);
errorbar(t,c,e2,<SPAN class="string">'g'</SPAN>);
hold <SPAN class="string">off</SPAN>
legend([a1 a2 a3],<SPAN class="string">'Squalene'</SPAN>,<SPAN class="string">'Palmitic acid'</SPAN>,<SPAN class="string">'Hexadecenoic acid'</SPAN>);
title(<SPAN class="string">'Degradation Principle Composites  Against Time For CB003 Donor'</SPAN>);
xlabel(<SPAN class="string">'Time (days)'</SPAN>);
ylabel(<SPAN class="string">'Normalised Chromatogram Values'</SPAN>);
<SPAN class="comment">% Donor CA006</SPAN>
xlrange6 =<SPAN class="string">'B26:N26'</SPAN>; <SPAN class="comment">%hexa</SPAN>
xlrange7 =<SPAN class="string">'B27:N27'</SPAN>; <SPAN class="comment">%palm</SPAN>
xlrange8 =<SPAN class="string">'B28:N28'</SPAN>; <SPAN class="comment">%sq</SPAN>
agecurvCA6HX= xlsread(filename,sheet,xlrange6);
agecurvCA6PM= xlsread(filename,sheet,xlrange7);
agecurvCA6SQ= xlsread(filename,sheet,xlrange8);
figure
aa=agecurvCA6SQ;
bb=agecurvCA6PM;
cc=agecurvCA6HX;
ee =std(aa)*ones(size(t));
ee1=std(bb)*ones(size(t));
ee2=std(cc)*ones(size(t));
hold <SPAN class="string">on</SPAN>
aa1 = plot(t,aa,<SPAN class="string">'r'</SPAN>);
aa2 = plot(t,bb,<SPAN class="string">'b'</SPAN>);
aa3 = plot(t,cc,<SPAN class="string">'g'</SPAN>);
errorbar(t,aa,ee,<SPAN class="string">'r'</SPAN>);
errorbar(t,bb,ee1,<SPAN class="string">'b'</SPAN>);
errorbar(t,cc,ee2,<SPAN class="string">'g'</SPAN>);
hold <SPAN class="string">off</SPAN>
legend([aa1 aa2 aa3],<SPAN class="string">'Squalene'</SPAN>,<SPAN class="string">'Palmitic acid'</SPAN>,<SPAN class="string">'Hexadecenoic acid'</SPAN>);
title(<SPAN class="string">'Degradation Principle Composites  Against Time For CA006 Donor'</SPAN>);
xlabel(<SPAN class="string">'Time (days)'</SPAN>);
ylabel(<SPAN class="string">'Normalised Chromatogram Values'</SPAN>);
<SPAN class="comment">% CB033</SPAN>
xlrange9 =<SPAN class="string">'B31:N31'</SPAN>; <SPAN class="comment">%hexa</SPAN>
xlrange10 =<SPAN class="string">'B32:N32'</SPAN>; <SPAN class="comment">%palm</SPAN>
xlrange11 =<SPAN class="string">'B33:N33'</SPAN>; <SPAN class="comment">%sq</SPAN>
agecurvCB33HX= xlsread(filename,sheet,xlrange9);
agecurvCB33PM= xlsread(filename,sheet,xlrange10);
agecurvCB33SQ= xlsread(filename,sheet,xlrange11);
figure
aaa=agecurvCB33SQ;
bbb=agecurvCB33PM;
ccc=agecurvCB33HX;
eee =std(aaa)*ones(size(t));
eee1=std(bbb)*ones(size(t));
eee2=std(ccc)*ones(size(t));
hold <SPAN class="string">on</SPAN>
aaa1 = plot(t,aaa,<SPAN class="string">'r'</SPAN>);
aaa2 = plot(t,bbb,<SPAN class="string">'b'</SPAN>);
aaa3 = plot(t,ccc,<SPAN class="string">'g'</SPAN>);
errorbar(t,aaa,eee,<SPAN class="string">'r'</SPAN>);
errorbar(t,bbb,eee1,<SPAN class="string">'b'</SPAN>);
errorbar(t,ccc,eee2,<SPAN class="string">'g'</SPAN>);
hold <SPAN class="string">off</SPAN>
legend([aaa1 aaa2 aaa3],<SPAN class="string">'Squalene'</SPAN>,<SPAN class="string">'Palmitic acid'</SPAN>,<SPAN class="string">'Hexadecenoic acid'</SPAN>);
title(<SPAN class="string">'Degradation Principle Composites  Against Time For CB033 Donor'</SPAN>);
xlabel(<SPAN class="string">'Time (days)'</SPAN>);
ylabel(<SPAN class="string">'Normalised Chromatogram Values'</SPAN>);
<SPAN class="comment">%DA080</SPAN>
xlrange12 =<SPAN class="string">'B36:N36'</SPAN>; <SPAN class="comment">%hexa</SPAN>
xlrange13 =<SPAN class="string">'B37:N37'</SPAN>; <SPAN class="comment">%palm</SPAN>
xlrange14 =<SPAN class="string">'B38:N38'</SPAN>; <SPAN class="comment">%sq</SPAN>
agecurvDA80HX= xlsread(filename,sheet,xlrange12);
agecurvDA80PM= xlsread(filename,sheet,xlrange13);
agecurvDA80SQ= xlsread(filename,sheet,xlrange14);
figure
aaaa=agecurvDA80SQ;
bbbb=agecurvDA80PM;
cccc=agecurvDA80HX;
eeee =std(aaaa)*ones(size(t));
eeee1=std(bbbb)*ones(size(t));
eeee2=std(cccc)*ones(size(t));
hold <SPAN class="string">on</SPAN>
aaaa1 = plot(t,aaaa,<SPAN class="string">'r'</SPAN>);
aaaa2 = plot(t,bbbb,<SPAN class="string">'b'</SPAN>);
aaaa3 = plot(t,cccc,<SPAN class="string">'g'</SPAN>);
errorbar(t,aaaa,eeee,<SPAN class="string">'r'</SPAN>);
errorbar(t,bbbb,eeee1,<SPAN class="string">'b'</SPAN>);
errorbar(t,cccc,eeee2,<SPAN class="string">'g'</SPAN>);
hold <SPAN class="string">off</SPAN>
legend([aaaa1 aaaa2 aaaa3],<SPAN class="string">'Squalene'</SPAN>,<SPAN class="string">'Palmitic acid'</SPAN>,<SPAN class="string">'Hexadecenoic acid'</SPAN>);
title(<SPAN class="string">'Degradation Principle Composites  Against Time For DA080 Donor'</SPAN>);
xlabel(<SPAN class="string">'Time (days)'</SPAN>);
ylabel(<SPAN class="string">'Normalised Chromatogram Values'</SPAN>);
<SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">% END OF FILE</SPAN></PRE></DIV></DIV><A href="#selection" class="btn btn-info btn-lg pull-right" role="button"></A><A href="https://2015.igem.org/Team:Dundee/Modeling/Fingerprints#pca" class="btn btn-primary btn-lg pull-right" role="button">View description of PCA</A></DIV></DIV></DIV></SECTION><SECTION id="fmodel"><DIV class="row3"><DIV class="row"><DIV class="col-lg-12 feature" style=""><DIV class="row"><H2><B>Squalene Epoxide Model MATLAB Code</B></H2><P>The figures shown in the <U><A href="https://2015.igem.org/Team:Dundee/Modeling/Fingerprints#fmodel">squalene epoxide and lanosterol synthase model</A></U> were created using MATLAB. Before using MATLAB the original system of equations was non-dimensionalised to the system:</P>
$$

\begin{eqnarray*}
\frac{dLS}{d\tau}&amp;=&amp;PC-\lambda LS \cdot SE,\\
\frac{dSE}{d\tau}&amp;=&amp;PC-\lambda LS \cdot SE,\\
\frac{PC}{d\tau}&amp;=&amp;\lambda LS \cdot SE-PC-\gamma PC,\\
\frac{dLa}{d\tau}&amp;=&amp;\gamma PC.
\end{eqnarray*}
$$<P>The initial conditions were also non-dimensionalised to become:</P>
$$

\begin{eqnarray*}
LS(0)&amp;=&amp;v_{0},\\
SE(0)&amp;=&amp;1,\\
PC(0)&amp;=&amp;0,\\
La(0)&amp;=&amp;0.
\end{eqnarray*}
$$
<P>Two files were written to perform sensitivity analysis; one to set the function (squalene.m) and one to solve the function and plot the results in <U><A href="https://2015.igem.org/wiki/index.php?title=Team:Dundee/Modeling/Fingerprints#modelfig1">Figure 6</A></U> (run_squalene.m). Both files are shown below, where the green text is comments to aid in understanding of the scripts.</P></DIV><DIV class="content"><PRE class="codeinput"><SPAN class="comment"><B><FONT size="6" colour="green">MATLAB code from squalene.m file</FONT></B></SPAN><SPAN class="comment">% File to solve the system of ODEs describing lanosterol synthase and squalene epoxide binding.</SPAN><SPAN class="comment">% The vector u has 4 dimensions;</SPAN><SPAN class="comment">% u(1) = Lanosterol synthase (LS) concentration, {non-dimensionalised}</SPAN><SPAN class="comment">% u(2) = Squalene epoxide (SE) concentration, {&quot;}</SPAN><SPAN class="comment">% u(3) = Protosterol cation (PC) concentration (1st Intermediate), {&quot;}</SPAN><SPAN class="comment">% u(4) = Lanosterol (La) concentration. {&quot;}</SPAN><SPAN class="comment">% t is the time that the simulation is run over.</SPAN><SPAN class="comment">% lambda is the 1st binding parameter ((k1/k2)SE(0)).</SPAN><SPAN class="comment">% gamma is the 2nd binding parameter (k3/k2).</SPAN><SPAN class="keyword">function</SPAN> f = squalene(t,u,lambda,gamma);
<SPAN class="comment">% Then set f as the RHS of the system of ODEs.</SPAN>
f = [u(3)-lambda.*u(1)*u(2);
    u(3)-lambda.*u(1)*u(2);
    lambda.*u(1)*u(2)-u(3)-gamma.*u(3);
    gamma.*u(3)];
<SPAN class="keyword">end</SPAN><SPAN class="comment">% Then end the function.</SPAN><SPAN class="comment">% This function can then be solved using ode23 in the file run_squalene.m  by using the @squalene command.</SPAN><SPAN class="comment">% END OF FILE.</SPAN><SPAN class="comment"><B><FONT size="6" color="green">MATLAB code for run_squalene.m file.</FONT></B></SPAN><SPAN class="comment"><B>% File to solve the non-dimensionalised system of ODEs representing the binding of squalene epoxide (SE) and lanosterol synthase (LS) to form lanosterol (La).</B></SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">% Set the final time of the simulation, set at 30 seconds.</SPAN>
T = 30;
<SPAN class="comment">% Set initial concentration of ratio (LS/SE) as the expected value.</SPAN>
u0 = 2.561;
<SPAN class="comment">% Parameter a is how many values of each parameter are used in the sensitivity analysis.</SPAN>
a = 100;

<SPAN class="comment">% Set lambda1 as the range of values for parameter lambda, where the maximum value is twice the expected.</SPAN>
lambda1 = linspace(0,(0.64061499*2),a);
<SPAN class="comment">% Set gamma1 as the range of values for parameter gamma, where the maximum value is twice the expected.</SPAN>
gamma1 = linspace(0,(1.000223733*2),a);
<SPAN class="comment">% Set Store as an empty matrix to store the values of lanosterol concentrations for each range of values of lambda1 and gamma1.</SPAN>
Store = zeros(a,a);
<SPAN class="comment">% Set a for loop that will solve the system of ODEs from the squalene.m file using the ode23 solver, for each value of lambda1, gamma1.</SPAN><SPAN class="comment">% The resulting values for the lanosterol concentration are stored in the Store matrix.</SPAN><SPAN class="keyword">for</SPAN> i=1:a
    <SPAN class="keyword">for</SPAN> j=1:a
[t,u]=ode23(@squalene,[0 T],[u0 1 0 0],[],lambda1(a+1-i),gamma1(j));
 Store(i,j) = u(end,4);

    <SPAN class="keyword">end</SPAN><SPAN class="keyword">end</SPAN><SPAN class="comment">% Call up a blank figure, so that no other figures are overwritten.</SPAN>
figure(1)
<SPAN class="comment">% Plot a colourplot of Store, that is plot the lanosterol concentration against lambda1 and gamma1.</SPAN>

imagesc(Store)
<SPAN class="comment">% Set the colormap as default colour choice, as this is easiest to see.</SPAN>
colormap <SPAN class="string">default</SPAN><SPAN class="comment">% Remove the values on the x and y axis by using the set command.</SPAN>
set(gca,<SPAN class="string">'YTick'</SPAN>,[],<SPAN class="string">'XTick'</SPAN>,[]);
<SPAN class="comment">% Add a colorbar with user defined axis labels (Tick labels) and label,</SPAN><SPAN class="comment">% 'Complex Concentration'.</SPAN>
c=colorbar(<SPAN class="string">'Ticks'</SPAN>,[0,0.99],<SPAN class="string">'TickLabels'</SPAN>,{<SPAN class="string">'None'</SPAN>,<SPAN class="string">'High'</SPAN>},<SPAN class="string">'FontSize'</SPAN>,15,<SPAN class="string">'FontWeight'</SPAN>,<SPAN class="string">'bold'</SPAN>);
c.Label.String = <SPAN class="string">'Complex Concentration'</SPAN>;
<SPAN class="comment">% Add labels to the x and y axis for clarity on the plot.</SPAN>
xlabel(<SPAN class="string">'\fontsize{12} \bf Increasing \lambda'</SPAN>);
ylabel(<SPAN class="string">'\fontsize{12} \bf Increasing \gamma'</SPAN>);
<SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 2: This section is used to plot only lambda against lanosterol concentration over time.</B></SPAN><SPAN class="comment">% Define store1 as an empty matrix to hold values of LS, SE, PC (1st Intermediate) and La, for each value of lambda1.</SPAN>
store1 = zeros(5000,5,a); <SPAN class="comment">% 1st is time, 2:5 are u.</SPAN><SPAN class="comment">% Set a for loop that will solve the system of ODEs from the squalene.m file using the ode23 solver, for each value of lambda1, with the expected value of gamma1 used.</SPAN><SPAN class="comment">% The resulting values for LS, SE, PC and the lanosterol concentration are stored in the store1 matrix.</SPAN><SPAN class="keyword">for</SPAN> i=1:a

    [t,u]=ode23(@squalene,[0 T],[2.561 1 0 0],[],lambda1(i),1.000223733);
    store1(end-size(t,1)+1:end,1,i) = t;
    store1(end-size(t,1)+1:end,2:5,i) = u;

<SPAN class="keyword">end</SPAN><SPAN class="comment">% Call up a blank figure, so that no other figures are overwritten.</SPAN>
figure(2)
<SPAN class="comment">% Plot the values of lambda1 against the corresponding values of lanosterol concentration over time.</SPAN>

 plot(lambda1,squeeze(store1(end,5,:)),<SPAN class="string">'LineWidth'</SPAN>,2);
 <SPAN class="comment">% Add labels to the x and y axis for clarity on the plot.</SPAN>
 xlabel(<SPAN class="string">'\bf \fontsize{12}Increasing \lambda'</SPAN>);
 ylabel(<SPAN class="string">'\bf \fontsize{12} Lanosterol Concentration'</SPAN>);
 <SPAN class="comment">% Set the axis to tight so that the axis is not too large for the data.</SPAN>
 axis <SPAN class="string">tight</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 3: This section is used to plot only gamma against lanosterol concentration over time.</B></SPAN><SPAN class="comment">% Define store2 as an empty matrix to hold values of LS, SE, PC and La, for each value of gamma1.</SPAN>
store2 = zeros(a,5,a); <SPAN class="comment">% 1st is time, 2:4 are u.</SPAN><SPAN class="comment">% Set a for loop that will solve the system of ODEs from the squalene.m file using the ode23 solver, for each value of gamma1, with the expected value of lambda1 used.</SPAN><SPAN class="comment">% The resulting values for LS, SE, PC and the lanosterol concentration are stored in the store2 matrix.</SPAN><SPAN class="keyword">for</SPAN> i=1:a

    [t,u]=ode23(@squalene,[0 T],[2.561 1 0 0],[],0.64061499,gamma1(i));
    store2(end-size(t,1)+1:end,1,i) = t;
    store2(end-size(t,1)+1:end,2:5,i) = u;

<SPAN class="keyword">end</SPAN><SPAN class="comment">% Call up a blank figure, so that no other figures are overwritten.</SPAN>
figure(3)
<SPAN class="comment">% Plot the values of gamma1 against the corresponding values of lanosterol concentration over time.</SPAN>
 plot(gamma1,squeeze(store2(end,5,:)),<SPAN class="string">'LineWidth'</SPAN>,2);
<SPAN class="comment">% Add labels to the x and y axis for clarity on the plot.</SPAN>
  xlabel(<SPAN class="string">'\bf Increasing \gamma'</SPAN>);
 ylabel(<SPAN class="string">'\bf Lanosterol Concentration'</SPAN>);
<SPAN class="comment">% Set the axis to tight so that the axis is not too large for the data.</SPAN>
 axis <SPAN class="string">tight</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment">%</SPAN><SPAN class="comment"><B>%% Section 4: This section is used to plot only v0, the ratio of (LS(0)/SE(0)) against lanosterol concentration over time.</B></SPAN><SPAN class="comment">% Define store3 as an empty matrix to hold values of LS,SE,PC and La, for each value of v0.</SPAN>
store3= zeros(a,5,a);
<SPAN class="comment">% Set v0 as the range of values for v0 with the maximum as twice the expected value.</SPAN>
v0=linspace(0,(2.561*2),a);
<SPAN class="comment">% Set a for loop that will solve the system of ODEs from the squalene.m file using the ode23 solver, for each value of v0, with the expected value of lambda and gamma used.</SPAN><SPAN class="comment">% The resulting values for LS, SE, PC and the lanosterol concentration are stored in the store3 matrix.</SPAN><SPAN class="keyword">for</SPAN> i=1:a
    [t,u]= ode23(@squalene,[0 T],[v0(i) 1 0 0],[],0.64061499,1.00223733);
    store3(end-size(t,1)+1:end,1,i) = t;
    store3(end-size(t,1)+1:end,2:5,i) = u;
<SPAN class="keyword">end</SPAN><SPAN class="comment">% Call up a new figure, so that no figures are overwritten.</SPAN>
figure(4)
<SPAN class="comment">% Plot the values of v0 against the corresponding values of lanosterol concentration over time.</SPAN>
plot(v0,squeeze(store3(end,5,:)),<SPAN class="string">'LineWidth'</SPAN>,2);
<SPAN class="comment">% Set the axis to tight so that the axis is not too large for the data.</SPAN>
axis <SPAN class="string">tight</SPAN>;
<SPAN class="comment">% Add labels to the x and y axis for clarity on the plot.</SPAN>
xlabel(<SPAN class="string">'\bf \fontsize{12} Increasing v_{0}'</SPAN>);
ylabel(<SPAN class="string">'\bf \fontsize{12} Concentration of Lanosterol formed'</SPAN>);
<SPAN class="comment">%</SPAN><SPAN class="comment">% END OF FILE.</SPAN></PRE></DIV><A href="#selection" class="btn btn-info btn-lg pull-right" role="button"></A><A href="https://2015.igem.org/Team:Dundee/Modeling/Fingerprints#fmodel" class="btn btn-primary btn-lg pull-right" role="button">View description of model</A></DIV></DIV></DIV></SECTION><SECTION id="end"><DIV class="row3"><DIV class="row"><DIV class="col-lg-12 feature" style=""><DIV class="row"><P>To see the MATLAB code for the FluID section of the project or the Chromate Biosensor section of the project use the following buttons.</P><A href="https://2015.igem.org/Team:Dundee/Modeling/Appendix3" class="btn btn-primary btn-lg pull-right" role="button">Appendix 3: Chromate Biosensor</A><A href="https://2015.igem.org/Team:Dundee/Modeling/Appendix1" class="btn btn-primary btn-lg pull-right" role="button">Appendix 1: FluID</A></DIV></DIV></DIV></DIV></SECTION></DIV></FONT><DIV id="nav"><NAV class="navbar navbar-default navbar-fixed-top navbar-collapse" role="navigation"><DIV class="container"><DIV class="navbar-header"><A href="http://www.dundee.ac.uk/" target="_blank"><SPAN class="navbar-brand">University of Dundee</SPAN></A></DIV><DIV class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"><UL class="nav navbar-nav navbar-right"><LI><A href="https://2015.igem.org/Team:Dundee">Home</A></LI><LI class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown">About Us</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Team">Meet the Team</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Attributions">Attributions</A></LI></UL><LI class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown">Project</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Abstract">Abstract</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Forensic_Toolkit">Project Overview</A></LI><LI class="dropdown-header">Devices</LI><LI><A href="https://2015.igem.org/Team:Dundee/Forensic_Toolkit/FluID">FluID</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Forensic_Toolkit/Fingerprints">Fingerprint Ageing</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Forensic_Toolkit/Chromate">Chromate Biosensor</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Part_Collection">Parts</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Medals">Medals</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Future">Future Work</A></LI><LI class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown">Wet Lab</A></LI><LI class="dropdown-header">Lab Book</LI><LI><A href="https://2015.igem.org/Team:Dundee/Lab_Book/FluID">FluID</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Lab_Book/Fingerprints">Fingerprints</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Lab_Book/Chromate_Detector">Chromate Biosensor</A></LI><LI class="dropdown-header">Useful Information</LI><LI><A href="https://2015.igem.org/Team:Dundee/Protocols">Protocols</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Sequences">Sequences</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Bacterial_Two_Hybrid">Bacterial Two Hybrid</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Safety">Safety</A></LI><LI class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown">Dry Lab</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Modeling">Introduction</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Modeling/FluID">FluID</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Modeling/Fingerprints">Fingerprint Ageing</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Modeling/Chromate">Chromate Biosensor</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Modeling/Appendix1">Appendix : Code</A></LI><LI class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown">Outreach</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Practices">Practices</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Ethics">Ethics</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Collaborations">Collaborations</A></LI></DIV></DIV></NAV></DIV><DIV class="container"><DIV class="footer-btn"><A href="https://2015.igem.org/Team:Dundee/Introduction_Video" class="btn btn-info btn-lg" role="button">Watch Our Introduction Video</A></DIV></DIV><FOOTER><DIV class=""><DIV class="container"><DIV class="col-md-3"><A href="http://www.dundee.ac.uk/" target="_blank"><H4>Dundee University</H4></A><P>Located on the east coast of Scotland, The University of Dundee is one of Scotland's leading research institutes.</P></DIV><DIV class="col-md-3"><H4>Social Media</H4><DIV class="row"><DIV class="col-md-10"><A target="_blank" href="https://www.youtube.com/channel/UCJHBLvLhjzGqHqdjABjOY-w">youtube.com/DundeeiGEM2015</A></DIV></DIV><DIV class="row"><DIV class="col-md-10"><A target="_blank" href="http://www.facebook.com/igemdundee2015">facebook.com/iGEMDundee2015</A></DIV></DIV><DIV class="row"><DIV class="col-md-10"><A target="_blank" href="http://www.twitter.com/dundeeigemteam">twitter.com/DundeeiGEMTeam</A></DIV></DIV></DIV></DIV></DIV></FOOTER><DIV id="nav"><NAV class="navbar navbar-default navbar-fixed-top navbar-collapse" role="navigation"><DIV class="container"><DIV class="navbar-header"><A href="http://www.dundee.ac.uk/" target="_blank"><SPAN class="navbar-brand">University of Dundee</SPAN></A></DIV><DIV class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"><UL class="nav navbar-nav navbar-right"><LI><A href="https://2015.igem.org/Team:Dundee">Home</A></LI><LI class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown">About Us</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Team">Meet the Team</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Attributions">Attributions</A></LI></UL><LI class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown">Project</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Abstract">Abstract</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Forensic_Toolkit">Project Overview</A></LI><LI class="dropdown-header">Devices</LI><LI><A href="https://2015.igem.org/Team:Dundee/Forensic_Toolkit/FluID">FluID</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Forensic_Toolkit/Fingerprints">Fingerprint Ageing</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Forensic_Toolkit/Chromate">Chromate Biosensor</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Part_Collection">Parts</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Medals">Medals</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Future">Future Work</A></LI><LI class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown">Wet Lab</A></LI><LI class="dropdown-header">Lab Book</LI><LI><A href="https://2015.igem.org/Team:Dundee/Lab_Book/FluID">FluID</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Lab_Book/Fingerprints">Fingerprints</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Lab_Book/Chromate_Detector">Chromate Biosensor</A></LI><LI class="dropdown-header">Useful Information</LI><LI><A href="https://2015.igem.org/Team:Dundee/Protocols">Protocols</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Sequences">Sequences</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Bacterial_Two_Hybrid">Bacterial Two Hybrid</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Safety">Safety</A></LI><LI class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown">Dry Lab</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Modeling">Introduction</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Modeling/FluID">FluID</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Modeling/Fingerprints">Fingerprint Ageing</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Modeling/Chromate">Chromate Biosensor</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Modeling/Appendix1">Appendix : Code</A></LI><LI class="dropdown"><A href="#" class="dropdown-toggle" data-toggle="dropdown">Outreach</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Practices">Practices</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Ethics">Ethics</A></LI><LI><A href="https://2015.igem.org/Team:Dundee/Collaborations">Collaborations</A></LI></DIV></DIV></NAV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>