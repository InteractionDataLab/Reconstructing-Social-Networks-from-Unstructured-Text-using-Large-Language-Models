<HTML lang="en" dir="ltr" class="client-nojs">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Team_Aachen_Software skin-igem action-view"><DIV id="globalWrapper"><DIV id="content" class="mw-body" role="main"><H1 id="firstHeading" class="firstHeading"><SPAN dir="auto">Team:Aachen/Software</SPAN></H1><DIV id="bodyContent"><DIV id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><DIV class="wrapper"><DIV id="main" class="clearfix"><NAV class="navbar navbar-default"><DIV class="dropdownbar"><DIV class="fluid-container"><DIV class="collapse navbar-collapse"><UL id="menu-header" class="nav navbar-nav navbar-left"><LI class="dropdown"><A href="#" data-toggle="dropdown" class="dropdown-toggle">Project</A></LI><LI><A class="menu-link" href="/Team:Aachen/InteractiveTour10">Interactive Journey</A></LI><LI><A class="menu-link" href="/Team:Aachen/Project/Overview">Overview</A></LI><LI><A class="menu-link" href="/Team:Aachen/Project/Background">Background</A></LI><LI><A class="menu-link" href="/Team:Aachen/Project/Outlook">Outlook</A></LI></UL><LI class="dropdown"><A href="#" data-toggle="dropdown" class="dropdown-toggle">Lab</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Lab">Overview</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Modeling">Modeling</A></LI><LI id="" class="dropdown"><A class="menu-link" href="/Team:Aachen/Lab/Methanol">Methanol</A></LI><LI><A href="/Team:Aachen/Lab/Methanol/Biobricks">Biobricks</A></LI><LI><A href="/Team:Aachen/Lab/Methanol/Polycistronic_Expression_Plasmid">Polycistronic Expression Plasmid</A></LI><LI><A href="/Team:Aachen/Lab/Methanol/Monocistronic_Diversity_Library">Monocistronic Diversity Library</A></LI><LI><A href="/Team:Aachen/Lab/Methanol/Characterization">Characterization</A></LI><LI id="" class="dropdown"><A class="menu-link" href="/Team:Aachen/Lab/Glycogen">Glycogen</A></LI><LI><A href="/Team:Aachen/Lab/Glycogen/Synthesis">Synthesis</A></LI><LI><A href="/Team:Aachen/Lab/Glycogen/Knockouts">Knockouts</A></LI><LI><A href="/Team:Aachen/Lab/Glycogen/Characterization">Characterization</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Lab/Libraries">Libraries</A></LI><LI id="" class="dropdown"><A class="menu-link" href="/Team:Aachen/Lab/Bioreactor">Bioreactor</A></LI><LI><A href="/Team:Aachen/Lab/Bioreactor/Hardware">Hardware</A></LI><LI><A href="/Team:Aachen/Software">Software</A></LI><LI><A href="/Team:Aachen/Lab/Bioreactor/Characterization_of_Bioreactor">Characterization</A></LI><LI class="dropdown"><A href="#" data-toggle="dropdown" class="dropdown-toggle">Notebook</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Notebook/Protocols">Protocols</A></LI><LI class="dropdown" id=""><A class="menu-link" href="/Team:Aachen/Notebook/Documentation">Documentation</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Notebook/Construction_Manuals">Construction Manuals</A></LI><LI class="dropdown"><A href="#" data-toggle="dropdown" class="dropdown-toggle">Human Practice</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Practices/Overview">Overview</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Practices/Maker_Faire">Maker Faire</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Practices/Community_Labs">Community Labs</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Practices/tubefront">tubefront</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Practices/Safety">Safety</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Collaborations">Collaborations</A></LI><LI class="dropdown"><A href="#" data-toggle="dropdown" class="dropdown-toggle">Achievements</A></LI><LI><A class="menu-link" href="/Team:Aachen/Achievements#Judging">Judging</A></LI><LI><A class="menu-link" href="/Team:Aachen/Parts">Parts</A></LI><LI class="dropdown"><A href="#" data-toggle="dropdown" class="dropdown-toggle">Team</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Attributions#Members">Members</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Attributions#Partners">Partners</A></LI><LI id=""><A class="menu-link" href="/Team:Aachen/Attributions#Attributions">Attributions</A></LI></DIV></DIV></DIV></NAV><DIV class="container tour"><DIV class="tourBoundingBox" style="display:none;"><DIV class="tourBoundingBoxInner"><DIV class="parentTourItem "><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour10">
					The Challenge
				</A></DIV><DIV class="parentTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour20">
					The Team
				</A></DIV><DIV class="parentTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour31">
					The Strategy
				</A></DIV><DIV class="expandedTour" style="display:none"><DIV class="expandedTourInner"><DIV class="childTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour31">
							Biological Approach
						</A></DIV><DIV class="childTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour32">
							The Bioreactor
						</A></DIV></DIV></DIV><DIV class="parentTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour41">
					The People
				</A></DIV><DIV class="expandedTour" style="display:none"><DIV class="expandedTourInner"><DIV class="childTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour41">
							Maker Faire
						</A></DIV><DIV class="childTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour42">
							Community Labs
						</A></DIV><DIV class="childTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour43">
							tubefront
						</A></DIV></DIV></DIV><DIV class="parentTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour51">
					The Solution
				</A></DIV><DIV class="expandedTour" style="display:none"><DIV class="expandedTourInner"><DIV class="childTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour51">
							Engineering
						</A></DIV><DIV class="childTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour52">
							Biology
						</A></DIV></DIV></DIV><DIV class="parentTourItem"><A class="tourItemLabel" href="/Team:Aachen/InteractiveTour60">
					The Future
				</A></DIV></DIV></DIV></DIV><DIV class="container container-primary"><DIV class="row"><H1><SPAN class="mw-headline" id="Introduction">Introduction</SPAN></H1><P>Every bioreactor comes with control software. But how can you interface with something that is completely DIY? To test and run our bioreactor, we have developed suite of calibration and control software. We call it the &quot;Master Control Program&quot; or simply MCP.
</P><DIV class="figraw figure-large col-md-6"><TABLE><TBODY><TR><TD><B>Workflow and Compontent of the MCP Platform</B>Calibration of pump and biosensor devices is done with their respective calibration programs. The calibration results are then fed into the Master Control Program where reactors, experiments and cultivations are set up and controlled.
</TD></TR></TBODY></TABLE></DIV><H1><SPAN class="mw-headline" id="Key_Achievements">Key Achievements</SPAN></H1><DIV id="{{{color}}}" class="achievements"><UL><LI> fully-featured MCP for running multiple small scale reactors at the same time</LI><LI> reliable data acquisition and configurable live plots</LI><LI> easy-to-use calibration programs for pumps and biomass sensors</LI></UL></DIV><P>
We are providing ready-to-use zip files with the MCP, Pump Calibrator and OD Calibrator in our <A href="/Team:Aachen/Lab/Bioreactor/Download_Library" title="Team:Aachen/Lab/Bioreactor/Download Library">Download Library</A>. The Source code of the whole Master Control Program software suite is available in the <A rel="nofollow" class="external text" href="https://github.com/igemsoftware/Aachen_2015">igemsoftware GitHub repository</A> under the GNU GENERAL PUBLIC LICENSE Version 3.0.
</P><H1><SPAN class="mw-headline" id="Challenges">Challenges</SPAN></H1><P>Developing a control software that is intuitive and responsive was not trivial. Translating the abstract idea of an experiment and the respective cultivation parameters into data structures and communication messages led to many challenges that are not apparent to the end user.
</P><UL><LI> motors and sensory devices have to be calibrated in order to respond as expected</LI><LI> online data comes in at high rates</LI><LI> the software has to remain stable independent of the number of accumulated data points</LI><LI> plots have to be combined dynamically and still show online data</LI><LI> communication is conflicting with high-frequency stepping of the aeration pump</LI></UL><P>All of these difficulties were addressed and now we can present a fully integrated package that handles everything from calibration to cultivation. There is no more need for the researcher to do pump calibrations or setpoint calculations by hand.
</P><H1><SPAN class="mw-headline" id="Architecture">Architecture</SPAN></H1><H2><SPAN class="mw-headline" id="Control_Software">Control Software</SPAN></H2><P>The MCP and its accompanying programs are written using C# and the .NET Framework 4.5. This makes them backwards-compatible to Windows 7 and gave us the advantage of asynchronous operations using async/await. All components of the control software are written following the MVVM design pattern<SUP id="cite_ref-1" class="reference"><A href="#cite_note-1">[1]</A></SUP> to keep things manageable.
</P><P>The software suite is divided into several libraries to allow for independent implementation and development of certain features:
</P><UL><LI><B>MCP.Protocol</B> implements a serial communication interface and the bioreactor communication protocol</LI><LI><B>MCP.Measurement</B> contains classes for live-logging and processing of incoming measurements</LI><LI><B>MCP.Curves</B> harbors regression- and transformation functions that are used to map calibration profiles</LI><LI><B>MCP.Equipment</B> implements pumps, sensors and reactors and their respective calibration and configuration information</LI><LI><B>MCP.Cultivation</B> implements controlling of cultivations, process parameters and their organization in an experiment library</LI></UL><P>Upon these libraries, three applications were developed:
</P><UL><LI> the <B>OD Calibrator</B> application makes it easy to gather a high-resolution calibration profile and export it to a calibration file.</LI><LI> using the <B>Pump Calibrator</B>, newly assembled pumps can be tested and calibrated</LI><LI> the <B>Master Control Program</B> integrates calibration files, experiement management and data logging with controlling the slave units via a serial communication protocol</LI></UL><P>For the different features within the MCP, we rely on multiple external libraries. This includes a custom build of <I>DynamicDataDisplay</I> version 4.0 <SUP id="cite_ref-2" class="reference"><A href="#cite_note-2">[2]</A></SUP>, the machine learning and statistics framework <I>Accord.NET</I><SUP id="cite_ref-3" class="reference"><A href="#cite_note-3">[3]</A></SUP> and the UI and helper libraries <I>Extended WPF Toolkit</I><SUP id="cite_ref-4" class="reference"><A href="#cite_note-4">[4]</A></SUP> and <I>TCD.Controls</I><SUP id="cite_ref-5" class="reference"><A href="#cite_note-5">[5]</A></SUP>.
</P><H2><SPAN class="mw-headline" id="Microcontroller_Firmware">Microcontroller Firmware</SPAN></H2><P>In contrast to the control software that is running on the computer, the microcontroller firmware is written in the C programming language and underlies completely different constraints. With the ATmega328, only 8 bit of 16 Mhz processing power are available and the whole reactor control is implemented on a much lower abstraction level.
</P><P>To integrate pumps, stirrer, biomass sensor and the communication protocol, we wrote several functions that are called in every iteration of the loop. A <I>ReadIncoming</I> function reads and interprets or forwards protocol messages that are coming from either up or down in the hierachy. When commands are coming in, the global variables for the respective setpoints are updated.
</P><H1><SPAN class="mw-headline" id="Outlook">Outlook</SPAN></H1><P>The integration with all relevant online parameters makes it possible to integrate more advanced process automation parameters. The interfaces for postprocessing of gas and biomass online data exist and function reliably. The MCP also supports dynamic switching of offgas sensors between different reactors using magnetic valves. This can reduce the material cost and still provide semi-continuous offgas data for multiple reactors.
</P><P>Due to the integration of OD-measurement with reactor control a <I>turbidostat</I> mode can easily be implemented into the software.
</P><H1><SPAN class="mw-headline" id="Usage">Usage</SPAN></H1><H2><SPAN class="mw-headline" id="Step_1_-_Pump_Calibration">Step 1 - Pump Calibration</SPAN></H2><P>A dedicated calibrator app, the <I>Pump Calibrator</I> is provided as a component of our software package. It communicates with the microcontroller via the bioreactor communication protocol to to drive the pump at different <I>steps-per-hour</I>-setpoints and receive data from a laboratory fine scale.
After selecting a calibration mode (<I>Debug</I>, <I>Quick</I>, <I>Standard</I>, <I>Precise</I> and <I>Precise Aeration</I>) the calibration is started via the &quot;Start Calibration&quot; button. A progress bar indicates how long the fully automatized calibration will take. 
</P><P>All <I>response points</I> are accumulated into a <I>response-curve</I> which is exported to a file. This calibration file is later used by the MCP to calculate accurate setpoints for a given pumping rate using linear regression.
</P><DIV class="figraw figure-large col-md-6"><TABLE><TBODY><TR><TD><B>Pump Calibration</B>After setting up the hardware, only two steps remain before starting the calibration: Selection of the COM port and a calibration mode.
</TD></TR></TBODY></TABLE></DIV><P>Over the past months we have used the Pump Calibrator to test countless pump prototypes. Not only the hardware, but also the software was optimized over time. The calibrator uses a triplicate linear regression to determine the pumping rate for a given setpoint. We found this to be much more reliable than taking the difference between the first and last point.
</P><H2><SPAN class="mw-headline" id="Step_2_-_Biomass_Sensor_Calibration">Step 2 - Biomass Sensor Calibration</SPAN></H2><P>Our biomass sensor uses an optical measurement principle and has to be calibrated against OD<SUB>600</SUB>, cell dry weight (CDW) or both. This task can be completed with minimal effort using the OD Calibrator app.
</P><P>The resulting calibration file is later imported into the Master Control Program.
</P><DIV class="figraw figure-large col-md-6"><TABLE><TBODY><TR><TD><B>Calibration Curve of Biosensor 4</B>The 3rd-degree polynomial regression has the formula OD(x)=-4.02x<SUP>3</SUP>+6.97x<SUP>2</SUP>-0.004737x+12.03. Horizontal error bars indicate the standard deviation over the measurement interval.
</TD></TR></TBODY></TABLE></DIV><P>The sensor is <B>well capable of measuring OD values smaller than 0.1</B>. Last year we showed this for the cuvette-based device<SUP id="cite_ref-6" class="reference"><A href="#cite_note-6">[6]</A></SUP> and also the online OD sensor can probably achieve a comparable performance. In our calibration run we observed that sensor <B>values at ODs below 0.1 are still around 20 times greater than the standard deviations</B> over a 15-second calibration interval. The limitation for these low OD values and also the greater source of variation was the sensitivity range of the reference photometer.
</P><H2><SPAN class="mw-headline" id="Step_3_-_Configuring_the_Reactors">Step 3 - Configuring the Reactors</SPAN></H2><P>After the calibrations were imported, new reactors are configured in the &quot;Reactors&quot; tab of the MCP. 
</P><DIV class="figraw figure-large col-md-6"><TABLE><TBODY><TR><TD><B>Reactor Configuration</B>By clicking &quot;Create New Reactor&quot; (1), a popup window opens for configuring the new device. A ReactorID must be selected (2) and then calibration files are selected from dropdown menus (3). Pump or sensor calibration assignments can be changed later on.
</TD></TR></TBODY></TABLE></DIV><P>Only pumps and sensors with existing calibration file mapping can be used in the cultivation. This is simply because without a calibration file, no accurate setpoint can be calculated for a given pumping rate.
</P><H2><SPAN class="mw-headline" id="Step_4_-_Starting_a_Cultivation">Step 4 - Starting a Cultivation</SPAN></H2><DIV class="figraw figure-large col-md-6"><TABLE><TBODY><TR><TD><B>Experiment Setup</B>When new experiments are created, the involved reactors have to be selected. Process parameters of each cultivation can then be edited and the cultivations are started individually.
</TD></TR></TBODY></TABLE></DIV><P>Process parameters are edited in the Setpoint Window that is shown below. For a list of parameter symbols, please see <A href="/Team:Aachen/Notebook/Construction_Manuals/Communication_Protocol" title="Team:Aachen/Notebook/Construction Manuals/Communication Protocol">the communication protocol specification</A>.
</P><DIV class="figraw figure-medium col-md-6"><TABLE><TBODY><TR><TD><B>Setpoint Window</B>All cultivation parameters can be changed independently for each reactor. The stirring speed (n) has a dynamic range of 150-1300 rpm and for most cultivations we recommend a gas flow rate (q_g) of 2 vvm. Setpoints for feed and harvest pump are automatically calculated from the culture volume V_L and the dilution rate D.
</TD></TR></TBODY></TABLE></DIV><H1><SPAN class="mw-headline" id="References">References</SPAN></H1><OL class="references"><LI id="cite_note-1"><SPAN class="mw-cite-backlink"><A href="#cite_ref-1">↑</A></SPAN><SPAN class="reference-text"><A rel="nofollow" class="external free" href="https://en.wikipedia.org/wiki/Model_View_ViewModel">https://en.wikipedia.org/wiki/Model_View_ViewModel</A></SPAN></LI><LI id="cite_note-2"><SPAN class="mw-cite-backlink"><A href="#cite_ref-2">↑</A></SPAN><SPAN class="reference-text"><A rel="nofollow" class="external free" href="http://d3future.codeplex.com/">http://d3future.codeplex.com/</A></SPAN></LI><LI id="cite_note-3"><SPAN class="mw-cite-backlink"><A href="#cite_ref-3">↑</A></SPAN><SPAN class="reference-text"><A rel="nofollow" class="external free" href="http://accord-framework.net/">http://accord-framework.net/</A></SPAN></LI><LI id="cite_note-4"><SPAN class="mw-cite-backlink"><A href="#cite_ref-4">↑</A></SPAN><SPAN class="reference-text"><A rel="nofollow" class="external free" href="http://wpftoolkit.codeplex.com/">http://wpftoolkit.codeplex.com/</A></SPAN></LI><LI id="cite_note-5"><SPAN class="mw-cite-backlink"><A href="#cite_ref-5">↑</A></SPAN><SPAN class="reference-text"><A rel="nofollow" class="external free" href="http://www.nuget.org/packages/TCD.Controls/">http://www.nuget.org/packages/TCD.Controls/</A></SPAN></LI><LI id="cite_note-6"><SPAN class="mw-cite-backlink"><A href="#cite_ref-6">↑</A></SPAN><SPAN class="reference-text"><A rel="nofollow" class="external free" href="https://2014.igem.org/Team:Aachen/OD/F_device#odfachievements">https://2014.igem.org/Team:Aachen/OD/F_device#odfachievements</A></SPAN></LI></OL></DIV><DIV class="hexagon-bg"><DIV class="hexagon"><DIV class="colorable fill"><CENTER><A href="#">▲</A></CENTER></DIV></DIV></DIV></DIV></DIV></DIV><DIV class="footer"><DIV class="bar"><DIV class="bar-wrap"><DIV class="disclaimer"><A href="mailto:igem@rwth-aachen.de">Contact</A></DIV><DIV class="copyright">CC-BY-SA iGEM Aachen 2015</DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>