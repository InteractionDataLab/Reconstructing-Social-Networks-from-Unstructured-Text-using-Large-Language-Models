<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Grenoble_Projet_Modelling_Stochastic"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Grenoble/Projet/Modelling/Stochastic">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Grenoble/Projet/Modelling/Stochastic&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Grenoble/Projet/Modelling/Stochastic&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Grenoble/Projet/Modelling/Stochastic&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Grenoble/Projet/Modelling/Stochastic" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Grenoble/Projet/Modelling/Stochastic</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2011.igem.org</H3><P><TITLE>Grenoble 2011, Mercuro-Coli iGEM</TITLE></P><DIV class="left"><DIV class="navigation"><DIV class="centering"><UL class="topnav"><UL><LI><A href="/Team:Grenoble">Home</A></LI><LI><A href="/Team:Grenoble/Projet/Intro"><SPAN class="scriptina"><I>Le Projet</I></SPAN></A></LI><LI><A href="/Team:Grenoble/Projet/Intro">Introduction</A></LI><LI><A href="/Team:Grenoble/Projet/Device">Device</A></LI><LI><A href="/Team:Grenoble/Projet/Design">The Genetic Network</A></LI><LI><A href="/Team:Grenoble/Projet/Modelling">Modelling</A></LI><LI><A href="/Team:Grenoble/Projet/Results">Results</A></LI><LI><A href="/Team:Grenoble/Projet/Biobricks">Biobricks</A></LI></UL><LI><A href="/Team:Grenoble/HumanPractice">Human Practice</A></LI><LI><A href="/Team:Grenoble/HumanPractice">Overview</A></LI><LI><A href="/Team:Grenoble/HumanPractice/identifying">A communication problem</A></LI><LI><A href="/Team:Grenoble/HumanPractice/developing">Developing a solution</A></LI><LI><A href="/Team:Grenoble/HumanPractice/promoting">Promoting synthetic biology</A></LI><LI><A href="/Team:Grenoble/HumanPractice/collaboration">Collaboration</A></LI></UL><LI><A href="/Team:Grenoble/Safety">Safety</A></LI><LI><A href="/Team:Grenoble/Notebook/June">Notebook</A></LI><LI><A href="/Team:Grenoble/Notebook/June">June</A></LI><LI><A href="/Team:Grenoble/Notebook/July">July</A></LI><LI><A href="/Team:Grenoble/Notebook/August">August</A></LI><LI><A href="/Team:Grenoble/Notebook/September">September</A></LI><LI><A href="/Team:Grenoble/Notebook/October">October</A></LI><LI><A href="/Team:Grenoble/The_Team/">About us</A></LI><LI><A href="/Team:Grenoble/The_Team/">The Team</A></LI><LI><A href="/Team:Grenoble/Grenoble">Grenoble</A></LI><LI><A href="/Team:Grenoble/Data_Page">Data Page</A></LI><LI><A href="/Team:Grenoble/Sponsors">Sponsors</A></LI></DIV></DIV></DIV><DIV class="body"><DIV class="left"><DIV class="blocbackground" id="Stochastic"><H1>Modelling - Stochastic</H1><P>
		  With the model developed so far, we have studied the deterministic behavior of our system. All the parameters 
		  are precisely known and the solution obtained is always the same whatever the number of simulation is. However, 
		  in the switching area, the choice between one of the two states is randomly made by bacteria. We therefore need 
		  to adapt the model so as to take into account the randomness of the choice of the state.
		</P></DIV><DIV class="blocbackground" id="Random_Aspect"><H2>Sensitivity to noise</H2><P>
			We have started our study by simply using the deterministic model, which we have transformed into a stochastic 
			differential equation system: the gradient of IPTG and the homogenous concentration of aTc are modeled by a 
			normal distribution with, for standard deviation, a predetermined percentage of the distribution average.
		    </P><CENTER><TABLE class="nobordure"><TBODY><TR><TD><DIV class="legend"><STRONG>Figure 1:</STRONG>
						Logarithmic gradient of IPTG and aTc repartition on the plate with deterministic modelling
						</DIV></TD><TD><DIV class="legend"><STRONG>Figure 2:</STRONG>
						Logarithmic gradient of IPTG and aTc repartition on the plate with random deterministic modelling
						</DIV></TD></TR><TR><TD><DIV class="legend"><STRONG>Figure 3:</STRONG>
						Concentration of both repressor on the plate with deterministic modelling.
						</DIV></TD><TD><DIV class="legend"><STRONG>Figure 4:</STRONG>
						Concentration of both repressor on the plate with random deterministic modelling.
						</DIV></TD></TR></TBODY></TABLE></CENTER><P>
				As can be seen from the figures above, the presence of fluctuations affect the quality of the switch in 
				the case of the random model. This is why it is important to take into account the stochastic aspect 
				(random and probalistic studies) of the system. We have run the stochastic simulations by means of a 
				commonly-used algorithm, the Gillespie algorithm, which we describe below.
			</P></DIV><DIV class="blocbackground" id="Gillespie_algorithm"><H2>Gillespie algorithm</H2><P>
			During a chemical reaction, the molecules move at random in the medium obeying brownian motion, 
			and reactions happen randomly in the medium. On a macroscopic scale, the reactions can be seen 
			as deterministic, and the statistical properties are summarized by constants in classical ODEs. 
			
		      </P><TABLE class="nobordure"><TBODY><TR><TD><DIV class="legend">
				Reactions in the cell happen at random
			      </DIV></TD><TD><P>
			      However, at a cell's scale, the influence of the randomness of the reactions is no longer 
			      negligible, especially for biosensors. For an efficient measurement biosensor systems must provide 
			      the expected precision of the measure.
			    </P><P>
			      In his algorithm Gillespie uses propensity theory to describe the behaviour of such a medium. 
			      Each reaction occuring in the cell, like synthesis or degradation of a protein, has a certain 
			      propensity (see it as the probability that the event occurs in a coming amount of time).
			    </P></TD></TR><TR><TD><DIV class="legend">A random number is generated and sets the reaction to occur according to their propensities</DIV></TD><TD><P>
			      The propensities are calculated at each time . Then, one random number is generated and its value
			      will set the reaction that will occur for the current time . Of course, a reaction with a relatively high
			      propensity will have more chance to occur than another one.
			    </P><P>
			      After this step the concentrations are changed according to the reaction, and the same process is repeated until
			      the ending time of the simulation is reached.
			    </P></TD></TR></TBODY></TABLE><P>
			  This is a basic description of the algorithm, but following these steps we can get a curve of the evolution of
			  a molecule in the cell that takes into account the randomness of reactions occuring in the cell.
			</P><CENTER><DIV class="legend"><STRONG>Figure 1: </STRONG>Result of one Gillespie run on our model (TetR nb of molecules)</DIV></CENTER><P>
			  Of course, the calculation being partially based on a random selection of the reactions, each run of the algorithm produces a different
			  curve. On the image below all the curves have been generated using the exact same initial conditions and parameters.
			</P><CENTER><DIV class="legend"><STRONG>Figure 2: </STRONG>Result of several Gillespie runs on our model (TetR nb of molecules). Curves are all similar</DIV></CENTER><P>
			  However, the output depends on the parameters and equations of the system, and for each run the results are very similar (except
			  if the probability density function is bi-modal of course. In the case of our system for example, at the interface each bacterium
			  has a chance to switch into one way or another. In this case the output can be either around 0 (LacI pathway chosen) or higher
			  (TetR way chosen)
			</P><P><STRONG>Reference :</STRONG> Daniel T. Gillespie (1977). &quot;Exact Stochastic Simulation of Coupled Chemical Reactions&quot;. 
			The Journal of Physical Chemistry 81 (25): 2340–2361</P><P>Daniel T. Gillespie (1976). &quot;A General Method for Numerically Simulating the Stochastic Time Evolution 
			of Coupled Chemical Reactions&quot;. Journal of Computational Physics 22 (4): 403–434</P><H2>Our genetical network</H2><OL><LI><STRONG>Propensity functions and the Gillespie Algorithm</STRONG></LI><P>
			  To simplify the computations, our stochastic model only describes the stochastic behaviour of the 
			  Toggle switch genetic network. 
			  The toggle switch is the core of our system, it is the most sensitive part of the network and sets 
			  the precision, the behaviour and the limits of our system.
			</P><P>
			  The propensity functions used in our models are derived from the ODEs we have already written for 
			  deterministic modelling :
			</P><CENTER><TABLE class="nobordure"><TBODY><TR><TD><BIG>Chemical reaction</BIG></TD><TD><BIG>Propensity</BIG></TD></TR><TR><TD>
			    $ \phi \longrightarrow TetR $
			  </TD><TD>
			    $ \frac{k_{pLac}P_{Lac total}}{1+(\frac{LacI}{1 + \frac{IPTG}{K_{LacI - IPTG}}})^{n_{n_pLac}}} $
			  </TD></TR><TR><TD>
			    $ TetR \longrightarrow \phi$
			  </TD><TD>
			    $ \delta_{TetR} TetR $
			  </TD></TR><TR><TD>
			    $ \phi \longrightarrow LacI $
			  </TD><TD>
			    $ \frac{k_{pTet}P_{Tet total}}{1+(\frac{TetR}{1 + \frac{aTc}{K_{TetR - aTc}}})^{n_{n_pTet}}} $
			  </TD></TR><TR><TD>
			    $ LacI \longrightarrow \phi$
			  </TD><TD>
			    $ \delta_{LacI} LacI $
			  </TD></TR></TBODY></TABLE></CENTER><P>
			  The parameters are the same as those used in ODEs and can be found on the 
			  <A href="https://2011.igem.org/Team:Grenoble/Projet/Modelling/Parameters"> parameter page.</A>
			  In our Matlab code the propensities are computed at each time step in the file Stochastic_model.m.
			</P><LI><STRONG>Runs and statistical properties</STRONG></LI><P>
			  In a Gillespie simulation, the information brought by a few instances of the Gillespie simulation is 
			  enough to get the general behaviour of the genetical system. 
			  However, it is not sufficient when the information that we want is the mean or the variance of the 
			  concentrations in each species.
			</P><P>
			  In this case a great number of runs is necessary to have a correct estimate of the expected values. 
			  This is why we had to write a Matlab code to iterate a great number of runs. This part of the code 
			  can be found in the file Main_gillespie.m.
			</P><P>
			  Once the runs are computed through Gillespie algorithm, we have to extract the information from them. 
			  In this purpose we wrote the Hist.m, test.m and Dynamicdistros.m files. These files are specific to 
			  our system, we hope they can give an idea of how to analyse the results obtained via our Gillespie 
			  code, but they are not as easily understandable as other files.
			</P><P>
			  Once the datasets are obtained we have to extract its statistical properties. Refer to the next 
			  section for more information.
			</P></OL><P>IMPORTANT NOTE:</P><P>
			  We tried to write a Matlab code that is as easily adaptable to any other system as possible.
			  However, because of the lack of time and the great amount of work it requires, we could not 
			  build a completely generic MATLAB function handler for Gillespie simulations. We provide the source codes 
			  <A href="http://igemgrenoble-files.perso.sfr.fr/2011/MATLAB_Archives/">here</A> of the Matlab 
			  stochastic scripts for our simulations and tried to comment them as much as possible. Note that, 
			  if you want to adapt our code to a completely different system, only the Stochastic_model.m and 
			  parameters.mat files need to be changed, but a good understanding of the whole code is necessary.
		      </P><P>
				Stochastic Modelling allows us to take into account the random aspect of chemical reaction and also
				to perform <A href="https://2011.igem.org/Team:Grenoble/Projet/Results/Toggle#Stoc">stability study of our device</A>.
		      </P></DIV><DIV class="blocbackground" id="Stats"><H2>Mean, standard deviation and statistical properties</H2><P>
			To determine the number of bacteria and the minimal step for the IPTG gradient we get, we need to compute
			the mean and the standard deviation of each of the two species of the toggle switch.
		      </P><P>
			$X_{LacI}$ and $X_{TetR}$ are here the matrices representing the two toggle switch states in each bacterium on the whole 
			plate in time. On each point of the plate are wells containing a great number of bacteria. Each toggle state in each
			bacterium is a random variable. The X matrices are therefore matrices of $ nb_{cells} \times nb_{cell/well} \times time points$
			random variables.
		      </P><CENTER><DIV class="legend"><STRONG>Figure 1: </STRONG>Design of the Matrices representing the TetR and LacI concentrations in each bacterium on the plate</DIV></CENTER><P>
			Thanks to stochastic modelling we can obtain the mean and variance in each of the $nb_{wells}$ wells on
			the plate. (These values have to be estimated from the data we obtain with Gillespie, and as in biological 
			results, we need an important dataset to make an analysis that is statistically reliable.)
		      </P><P>
			Here the mean value of concentrations of LacI and TetR in all of the bacteria in each channel is computed and we expect to get
			the behaviour on the figure below.
		      </P><CENTER><DIV class="legend"><STRONG>Figure 1: </STRONG>Expected behaviour of the means of TetR and LacI over the plate</DIV></CENTER><P>
			To design our final device we need to know the width of the interface between the two states of the toggle switch.
			We also need to know the number of bacteria needed in the wells to have a proper measurement.
		      </P><P>
			The interface which will be the colored part of our plate will turn red when populations in way 1 and populations 
			in way 2 are in presence on the same point on the plate.
			We then need to know the statistical properties of the $(X_{LacI} X_{TetR})_{well}$ random variable.
		      </P><CENTER><DIV class="legend"><STRONG>Figure 2: </STRONG>Expected behaviour of the means of $TetR \times LacI$ over the plate</DIV></CENTER><P>
			($µ_{X_{LacI}X_{TetR}}(well)$ is of course not continuous but discrete, we just want to highlight the deviation problem caused
			by $σ_{X_{LacI}X_{TetR}}(well)$)
		      </P><P>We want to know $µ_{X_{LacI}X_{TetR}}(well)$ and $σ_{X_{LacI}X_{TetR}}(well)$ to obtain respectively :</P><OL><LI>
			  The width of the &quot;gaussian&quot; function of $µ_{X_{LacI}X_{TetR}}(well)$ to set the minimal definition (the ΔIPTG between wells)
			  of our final device
			</LI><LI>
			  The minimum number of bacteria we want in the wells.
			</LI><P>
			  We have $nb_{cell/well}$ independant random variables with the same probability density function. According to
			  central limit theorem, the mean of $X_{LacI}X_{TetR} = (X_{LacI}X_{TetR  cell1} + 
			  X_{LacI}X_{TetR  cell2} + ... + X_{LacI}X_{TetR  celln}) / n$ is $µ_{X_{LacI}X_{TetR}}(well)$ and its
			  standard deviation is $σ_{X_{LacI}X_{TetR}}(well)/ \sqrt{n}$.
			  The width of the gaussian is therefore easily calculable ($µ_{X_{LacI}X_{TetR}}(well) = µ_{X_{LacI}}(well) + 
			  µ_{X_{TetR}}(well)$), but it's not that easy for the standard deviation $σ_{X_{LacI}X_{TetR}}(well)$
			</P><P>
			  If we consider $X_{LacI}$ and $X_{TetR}$ are two correlated random variables, with known mean and variance ($µ_{LacI}$, $µ_{TetR}$, 
			  $σ_{LacI}$, $σ_{TetR}$)
			  $$
			  Var(X_{LacI}X_{TetR}) = E[(X_{LacI}X_{TetR} - E[(X_{LacI}X_{TetR}])^{2}]
			  $$
			  $$
			  = E[(X_{LacI}X_{TetR})^{2} -2E[X_{LacI}X_{TetR}]X_{LacI}X_{TetR} + 
			  E[X_{LacI}X_{TetR}]^{2}]
			  $$
			  $$
			  = E[(X_{LacI}X_{TetR})] -2(µ_{LacI}µ_{TetR})^{2} + µ_{LacI}µ_{TetR}
			  $$
			</P><P>
			  and $E[(X_{LacI}X_{TetR})]$ is not reductible to function of $µ_{LacI}$ and $µ_{TetR}$. To obtain this value
			  we then needed to create a composite random variable x<SUB>3</SUB> wich will be calculated during each run of our
			  MATLAB stochastic algorithm (see previous section).
			  $$
			  x_{3}= x_{LacI} \times x_{TetR}
			  $$
			  We can thus get the variance and mean of $X_{LacI}X_{TetR}$ ($X_{3}$) with our data.
			  If we want to get an error inferior to 10% for example around the $µ_{X_{LacI}X_{TetR}}(well)$ curve, the number of bacteria n
			  needed will be n so that:
			  $$\frac{\sigma_{LacI \times TetR_{cell}}}{\mu_{LacI \times TetR_{cell}}\sqrt{n_{cells}}} \leq 10%$$
			  With such a precision we can then calculate the IPTG definition between the wells.
			</P><P>
				This statistical approach of stochastic modelling allows us to get <A href="https://2011.igem.org/Team:Grenoble/Projet/Results/Device#Statistic">severals specificities of our device</A>.
			</P><DIV class="body"><DIV class="left"><DIV class="blocbackground"><TABLE class="nobordure"><TBODY><TR><TD><A href="https://2011.igem.org/Main_Page" title="iGEM 2011 Main Page">iGEM 2011 Main Page</A><H3><SPAN class="vert">Contact</SPAN> Us:</H3><H3><A title="Geoffrey BOUCHAGE" href="mailto:geoffrey.bouchage@phelma.grenoble-inp.fr"> Clic here !</A></H3></TD></TR></TBODY></TABLE></DIV></DIV></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2011.igem.org/Team:Grenoble/Projet/Modelling/Stochastic">http://2011.igem.org/Team:Grenoble/Projet/Modelling/Stochastic</A>&quot;</DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Grenoble/Projet/Modelling/Stochastic" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Grenoble/Projet/Modelling/Stochastic" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Grenoble/Projet/Modelling/Stochastic&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Grenoble/Projet/Modelling/Stochastic&amp;oldid=260817" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2011.igem.org:Privacy_policy" title="2011.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2011.igem.org:General_disclaimer" title="2011.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></OL></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>