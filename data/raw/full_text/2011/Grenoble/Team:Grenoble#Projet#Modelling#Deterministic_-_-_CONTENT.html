<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_Grenoble_Projet_Modelling_Deterministic"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:Grenoble/Projet/Modelling/Deterministic">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:Grenoble/Projet/Modelling/Deterministic&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:Grenoble/Projet/Modelling/Deterministic&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:Grenoble/Projet/Modelling/Deterministic&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:Grenoble/Projet/Modelling/Deterministic" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:Grenoble/Projet/Modelling/Deterministic</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2011.igem.org</H3><P><TITLE>Grenoble 2011, Mercuro-Coli iGEM</TITLE></P><DIV class="left"><DIV class="navigation"><DIV class="centering"><UL class="topnav"><UL><LI><A href="/Team:Grenoble">Home</A></LI><LI><A href="/Team:Grenoble/Projet/Intro"><SPAN class="scriptina"><I>Le Projet</I></SPAN></A></LI><LI><A href="/Team:Grenoble/Projet/Intro">Introduction</A></LI><LI><A href="/Team:Grenoble/Projet/Device">Device</A></LI><LI><A href="/Team:Grenoble/Projet/Design">The Genetic Network</A></LI><LI><A href="/Team:Grenoble/Projet/Modelling">Modelling</A></LI><LI><A href="/Team:Grenoble/Projet/Results">Results</A></LI><LI><A href="/Team:Grenoble/Projet/Biobricks">Biobricks</A></LI></UL><LI><A href="/Team:Grenoble/HumanPractice">Human Practice</A></LI><LI><A href="/Team:Grenoble/HumanPractice">Overview</A></LI><LI><A href="/Team:Grenoble/HumanPractice/identifying">A communication problem</A></LI><LI><A href="/Team:Grenoble/HumanPractice/developing">Developing a solution</A></LI><LI><A href="/Team:Grenoble/HumanPractice/promoting">Promoting synthetic biology</A></LI><LI><A href="/Team:Grenoble/HumanPractice/collaboration">Collaboration</A></LI></UL><LI><A href="/Team:Grenoble/Safety">Safety</A></LI><LI><A href="/Team:Grenoble/Notebook/June">Notebook</A></LI><LI><A href="/Team:Grenoble/Notebook/June">June</A></LI><LI><A href="/Team:Grenoble/Notebook/July">July</A></LI><LI><A href="/Team:Grenoble/Notebook/August">August</A></LI><LI><A href="/Team:Grenoble/Notebook/September">September</A></LI><LI><A href="/Team:Grenoble/Notebook/October">October</A></LI><LI><A href="/Team:Grenoble/The_Team/">About us</A></LI><LI><A href="/Team:Grenoble/The_Team/">The Team</A></LI><LI><A href="/Team:Grenoble/Grenoble">Grenoble</A></LI><LI><A href="/Team:Grenoble/Data_Page">Data Page</A></LI><LI><A href="/Team:Grenoble/Sponsors">Sponsors</A></LI></DIV></DIV></DIV><DIV class="body"><DIV class="left"><DIV class="blocbackground" id="Construction"><H1>Construction of the model</H1><A href="http://2011..org/wiki/images/d/d1/Rapport_Equations.pdf">
	      PDF version of the next two sections (Equations for Toggle Switch and Quorum sensing)</A><P>	As a proof of concept, we will consider anhydrotetracycline (aTc) instead of Mercury in
				our model, and the transcriptional regulator TetR in place of MerR. The TetR system is well
				characterized in E. coli, which facilitates the modelling. In addition, if the system works well
				with aTc, it should work as well with Mercury, Copper or lead for example.
			</P><P>
				In addition, since aTc diffuse freely accross the membrane of the cell, we do not have to take
				complex uptake mechanisms into considerations. Mercury is ionized and its entry in the cells
				depends on the presence of transporter protein.
				So in the following chapter, we are going to use TetR instead of MerR and aTc instead of
				Mercury.
			</P></DIV><DIV class="blocbackground" id="Two_level"><H2>The Two modules of Modelling</H2><P>
							Large-scale biochemical networks are classically decomposed into modules of smaller size to facilitate 
							the model building process and the model calibration. The approach consists in modelling each module 
							separately and integrating the different models into a larger model of the whole system. 
							Like divided our genetic network in severals part (see <A href="https://2011.igem.org/Team:Grenoble/Projet/Design">genetic network</A>),
							we also divided our model in two independant level of modelling:
							<UL><LI><STRONG>The Toggle Switch module:</STRONG> modelling this network module allows to predict in 
                              which state the bacteria are. In particular, we can determine the switching conditions in bacteria
                               and the localization of the switching area on the device (that depend on both IPTG and aTc
                                concentrations). This gives indications on how to adjust the size of the device to improve the 
                                aTc detection.</LI><LI><STRONG>The Quorum Sensing and Coloration module:</STRONG>the corresponding model is used to 
                              predict the localization and the width of the red line on the device. The modelling results are 
                              used to improve the device precision, for instance, by choosing between a device with a continuous 
                              bacterial layer and a device with strips containing bacteria. Each strip has the same concentration
                              of aTc, but a different IPTG concentration.</LI></UL></P><P>
							The first level of the model will allow us to define the switch conditions in bacteria, depending
							on the concentrations of aTc and IPTG. From these results, we could see where the switch
							zone will appear on the device and therefore, the position of the red line. These parts of the
							results indicate the range of aTc that can be detected.
						</P><P>
							The second level will give us an estimation of the red line width, which indicates the system precision.
							Based on these results, we could improve the precision of our device, for instance, by comparing
							between a device with a continuous bacterial layer and a device with strips containing bacteria.
							Each strip has a different IPTG concentration, but the same concentration of Mercury.
						</P><P><STRONG>Two independent levels of modelling which are coupled in order to get a
						<A href="https://2011.igem.org/Team:Grenoble/Projet/Results/Toggle#TS_QS">global simulation of the device.</A></STRONG></P></DIV><DIV class="blocbackground" id="Our_EquationsTS"><H2>Establishment of the equation</H2><H3>Toggle switch</H3><P>In a first part, we define a model to caracterize the <A href="https://2011.igem.org/Team:Grenoble/Projet/Design/toggle">Toggle Switch module</A> of our genetic network.
			</P><OL><LI>Biological Model</LI><P>
			  A toggle switch consists of two genes, each coding for a protein
			  that represses the expression of the other gene. This double
			  repression system ensures the basic function of a toggle switch: a
			  bistable system which can be switched from one state to the other
			  by putting, in our example, some IPTG or aTc molecules in the
			  medium.
		      </P><P>
			  The biological system we are trying to implement is more complex,
			  on both the biological and physical side. However, the toggle switch 
			  model is basically the same. In the study of the toggle switch itself,
			  the system can be reduced to a simple two-state subsystem that we will
			  then use for the rest of our modelling. However, our toggle switch model
			  is basically the same: we can reduce it to a simple two-state subsystem 
			  that we will then use for the rest of our modelling. The
			  toggle switch itself is not influenced by the rest of the system,
			  if we do not consider the RsmA regulatory system that will be
			  modeled at the very end of our work. Thus we will be able to model
			  the toggle switch independently and then build the rest of the
			  model upon this basis.
		      </P><LI>Mathematical Model</LI><P>
					In order to get the state of the bacteria, we need to compute the concentration of both
					repressors. To obtain these variations, we develop a system of ordinary differential equations (ODES)
					which governs the behavior of the Toggle Switch.
		      </P><CENTER>
		      $		      
		      \frac{d[TetR]}{dt} = \frac{k_{pLac}.[pLac]_{tot}}{1 +  (\frac{[lacI]}{K_{pLac} + \frac{K_{pLac}.[IPTG]}{K_{lacI-IPTG}}.})^\beta} - \delta_{TetR}.[TetR]$
		      
		      $\frac{d[lacI]}{dt} = \frac{k_{pTet}.[pTet]_{tot}}{1 +  (\frac{[tetR]}{K_{pTet} + \frac{K_{pTet}.[aTc]}{K_{TetR-aTc}}.})^\gamma} - \delta_{lacI}.[lacI]$
		      </CENTER><P>
					With this ODE system, we follow the evolution of the concentration of the two toggle switch repressors,
					TetR and LacI. This gives us the state of the bacteria. A demonstration of this ODE system is available
					in the previous pdf file. We briefly explain the equations below.
			  </P><P>
					Both equations are developed following the same approach. There is a term of production and a term of 
					degradation. The parameters $k_{pLac}.[pLac]_{tot}$ represent the protein synthesis rate from the pLac promoter.
					K_{pLac} and K_{lacI−IPTG} are the dissociation constants of LacI and pLac, and LacI and IPTG, respectively.
					The parameters β and γ denote the cooperativity of repression, that is, the number of repressors bound
					to the promoter. 
			  </P><P>
					According to these equations, the rate of variation of repressor TetR is inhibited by the repressor LacI.
					The degree of inhibition is modulated by the IPTG concentration. Reciprocally in the second equation, 
					the rate of variation of LacI depends on TetR, whose negative effect is modulated by aTc.
			  </P><P><STRONG>
						This indicates that the two equations are coupled. And also that only one repressor could be
						predominant, as shown later.
			  </STRONG></P><P>
			  These two equations can be easily computed with a differential solver. We can precisely estimate the effects of each parameter.  
			</P></OL><P>
				With this model, we were able to predict the <A href="https://2011.igem.org/Team:Grenoble/Projet/Results/Toggle#TS_QS">behavior of our toggle switch</A>.
		    </P></DIV><DIV class="blocbackground" id="Our_EquationsQS"><H2>Establishment of the equation</H2><H3>Quorum sensing</H3><OL><LI>Mathematical Model</LI><P>
					In a second part, we define a model able to characterize the <A href="https://2011.igem.org/Team:Grenoble/Projet/Design/quorum">quorum sensing module</A> of our genetic network,
					which involves the quorum sensing genes CinI and CinR, as well as the signaling molecule AHL.
					
					In order to model the Quorum Sensing module, we detail below the different reactions taking place 
					inside this module. For reasons that will become clear later, we focus on a particular area of our
					device, where neighboring bacteria will have a different behavior, although they carry the same 
					genetic circuit.
			  </P><DIV class="legend"><STRONG>Figure 1:</STRONG>Mechanism of Quorum Sensing diffusion at the boundary</DIV><P>
					According to the figure, several  must be taken into account:
					<OL><LI>the production of the Quorum Sensing molecule</LI><LI>the secretion of the molecule</LI><LI>the diffusion of the molecule in the medium</LI><LI>the penetration of the molecule</LI><LI>the complexation of the molecule with its receptor</LI><LI>the activation of the coloration</LI></OL></P><P>
					To model these mecanisms, we need to follow the evolution of the following quantities
					<UL><LI>$[QS_i]$ concentration of the intracellular Quorum Sensing molecule.</LI><LI>$[QS_e]$ concentration of the extracellular Quorum Sensing molecule.</LI><LI>$[cinR]$ concentration of the Quorum Sensing receptor.</LI><LI>$[cinI]$ concentration of the Quorum Sensing producer enzyme.</LI><LI>$[cinR_{comp}]$ concentration of the complexe cinR-QS.</LI></UL></P><P>
					Based on the Bangalore 2007 iGEM team, we get the following system of equations:
			  </P><CENTER>
			  $\frac{d[QS_i]}{dt} = \eta([QS_e]-[QS_i])-\delta_{QSi} [QS_i] + k_{QS-production}'[cinI]$
			  $\frac{d[QS_e]}{dt} = \rho v_c\eta([QS_i]-[QS_e])-\delta_{QSe} [QS_e] + D_{diff}\frac{\partial^2 [QS_e]}{\partial x^2}$
			  $\frac{d[cinR_{free}]}{dt} = \frac{k_{pLac}.[pLac]_{tot}}{1 +  (\frac{[lacI_{total}]}{K_{pLac} + \frac{K_{pLac}.[IPTG]}{K_{lacI-IPTG}}.})^\beta} - \delta_{cinR}[cinR_{free}] - V_{complexation}$
			  $\frac{d[cinR_{comp}]}{dt} = K_{comp}([cinR_{free}].[QS_i])$</CENTER><P>
					In the first equation, expressing the evolution of the concentration of the intracellular Quorum Sensing 
					molecule, 3 terms are involved: $[QSe]−[QSi]$, which describes the diffusion through the membrane, 
					$\delta_{QSi}[QSi]$, the degradation and $k_{QS−production}[cinI]$, the production of Quorum Sensing molecule 
					by the enzyme CinI.
					In the second equation, expressing the evolution of extracellular Quorum Sensing, there is no production term, but a spatial diffusion term
					$D_{diff}\frac{\partial^2 [QS_e]}{\partial x^2}$.
			  </P><P>
					The concentrations of CinI and CinR can be obtained by using the toggle switch modelling. Indeed, since CinI 
					is on the pathway of LacI and CinR on the pathway of Tet, their evolution follow the same equations. 
					In addition we consider the complexation of the CinR protein and the Quorum Sensing molecule, 
					which is expressed by the term $V_{complexation}$ in the CinR equation:
					\[V_{complexation} = K_{comp}[QS_i][CinR_{free}]\] 
					with $K_{comp}$ the affinity constant of AHL for cinR.
			  </P><P>
					In order to simplify the model, we considered that the complexation of CinR to AHL is total and depends only 
					on $[cinR]$	and $[QS_i] which is the limitant factor$.
			  </P><P><STRONG>
					To solve this set of equations, we couldn't use a classical ODE solver from Matlab (Mathworks), because 
					the equations are derived both in time and space. We therefore needed to use the finite difference method.
					To that aim, we build a matrix based on Taylor's series discretization.
			  </STRONG></P><P><LI>Definition of the matrix</LI></P><P>
				To solve this set of equations we have to use a matrix that will describe our system in both space
				and time. for example for the QS molecule outside of the cell :
			</P><CENTER>
					$M_{QSe}(m,n) = [QS_e](x,t)$
					$M_{QSe}(m+1,n+1) = [QS_e](x + dx,t+dt)$
			</CENTER><P>
				In these equations, m represents the spatial dimension and n the temporal dimension.
			</P><UL><LI>
			    On the spatial point of view, we only consider the x dimension, as the IPTG gradient will be only evolving
			    along this dimension. Thus we consider the state of our cells is the same along the width of our plate.
			  </LI><LI>
			    With this Matrix, and after computation of all the terms, we can get the entire behaviour of CinI, CinR, QS
			    inside and outside the cells.
			  </LI><LI>
			    The first line of the Matrix equals 0. These are the initial conditions we set to 0 at time t = 0s.
			  </LI><LI>
			    On the borders of the plate (x = 0 and x = L) the model used has to be different, limit conditions will be
			    set.
			  </LI><LI>
			    Of course, QSi, CinI and CinR matrices will be similarly implemented.
			  </LI></UL><LI>Discretization of the equation</LI><P>
			  With our continuous equations set, we want to obtain discrete definition of each of the matrices. interdependencies 
			  of the equations imply that the computation of the matrices will be performed on the entire CinI matrix
			  first, then each line of the Qi and Qe matrices will be computed alternatively. The computation of the CinR 
			  will be eventually performed.
			</P><P>
			  Parallel computation of all the matrices without proper control is not possible indeed, as the terms of Qi matrix
			  will depend on the Qe terms of the preceding line (and vice-versa).
			  Discretization is obtained with first order taylor series :
			</P></OL><CENTER>
			$
			M_{QSi}(m,n+1) =\Delta t (\eta (M_{QSe}(m,n) -  M_{QSi}(m,n)) - \delta_{QSi}.M_{QSi}(m,n) + k_{QSp}M_{CinI}(m,n)) + M_{QSi}(m,n)
			$
			$
			M_{QSe}(m,n+1) =\Delta t ( D_{m} + D_{diff} \frac{M_{QSe}(m+1,n) - 2 M_{QSe}(m,n) + M_{QSe}(m-1,n)}{\Delta x^2}) + M_{QSe}(m,n)
			$
			$
			with D_{m} =\rho v_c \eta .M_{QSi}(m,n) - M_{QSe}(m,n)(\delta_{QSe} + \rho v_c \eta)
			$
			$
			M_{CinR_{free}}(m,n+1) = \Delta t (\frac{k_{pTet}[P_{Tet total}]}{1+ (\frac{[TetR]}{K_{pTet}(1+\frac{[aTc]}{K_{TetR - aTc}})})^{n_{pTet}}} - M_{CinR_{free}}(m,n)(\delta_{CinR} - k_{comp}.M_{Qi}(m,n))) + M_{CinR_{free}}(m,n)$</CENTER><P><STRONG>
			With these discrete equations the 4 matrices can be computed through simple calculation loops over each line.
			The CinI matrix does not depend on space dimension, it is then possible to compute it without discretization with
			a differential solver.</STRONG></P><P><STRONG>
			Moreover to get the coupling of toggle switch and quorum sensing modules, we used the results of the first one
			(lacI and TetR evolution) to get the evolution of quorum sensing proteins (respectively cinI and cinR).
			It means that the output of the first module are used as input for the second module.</STRONG></P><P>
				With this model, we were able to predict how the <A href="https://2011.igem.org/Team:Grenoble/Projet/Results/Toggle#QS">red stripe appears</A> on the plate
			</P></DIV><DIV class="blocbackground" id="Our_algorithms"><H2>Our algorithms</H2><P>
		      An archive containing our Matlab scripts for the deterministic modeling can be found <A href="http://iGEMgrenoble-files.perso.sfr.fr/2011/MATLAB_Archives/">here</A>
		      (file Deterministic_archive.tar.gz). You can launch and ODE-based simulation(see our ODEs in 
		      the two previous sections) with the file biosenseur1Dmain.m.
		    </P><P>
		      Several dialog boxes will pop up to enter the specificities of the simulation: (physical 
		      specificities of the device, chemical species concentrations and IPTG gradient).
		    </P><P>
				At the end of the simulation you obtain 3 matrices named M_stock, M_QS and M_comp containing the concentrations
				in each protein species at each time point and on each physical point of the plate. We wrote three Matlab scripts
				(DynamicplottingTS, DynamicplottingQS and DynamicplottingCP) that dynamically display the protein concentrations.
				For a good understanding of the models and of our results, we also wrote a script (Imageshow.m) to illustrate 
				the plate coloration.
			</P><P>
				To see the results we obtained with this algorithms, refer to this <A href="https://2011.igem.org/Team:Grenoble/Projet/Results">page</A>.
			</P></DIV></DIV></DIV></DIV><DIV class="printfooter">
Retrieved from &quot;<A href="http://2011.igem.org/Team:Grenoble/Projet/Modelling/Deterministic">http://2011.igem.org/Team:Grenoble/Projet/Modelling/Deterministic</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:Grenoble/Projet/Modelling/Deterministic" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:Grenoble/Projet/Modelling/Deterministic" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:Grenoble/Projet/Modelling/Deterministic&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:Grenoble/Projet/Modelling/Deterministic&amp;oldid=261524" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2011.igem.org:Privacy_policy" title="2011.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2011.igem.org:General_disclaimer" title="2011.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></BODY></HTML>