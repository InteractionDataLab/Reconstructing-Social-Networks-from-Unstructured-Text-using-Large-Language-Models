<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<style type="text/css">
A:before { content:' '; } 
A:after { content:' '; } 
SPAN:before { content:' '; } 
SPAN:after { content:' '; } 
</style>
<BODY class="mediawiki  ltr ns-0 ns-subject page-Team_TU_Munich_jquery_EmbedPicasaGallery_js"><DIV id="globalWrapper"><DIV id="top-section"><DIV id="p-logo"><A href="/Main_Page" title="Main Page">&quot;
	    </A></DIV><DIV id="menubar" class="left-menu noprint"><UL><LI class="selected"><A href="/Team:TU_Munich/jquery.EmbedPicasaGallery.js">Page               </A></LI><LI class="new"><A href="/wiki/index.php?title=Talk:Team:TU_Munich/jquery.EmbedPicasaGallery.js&amp;action=edit&amp;redlink=1">Discussion               </A></LI><LI><A href="/wiki/index.php?title=Team:TU_Munich/jquery.EmbedPicasaGallery.js&amp;action=edit">View source               </A></LI><LI><A href="/wiki/index.php?title=Team:TU_Munich/jquery.EmbedPicasaGallery.js&amp;action=history">History               </A></LI><LI style="color:#808080;cursor:default">teams</LI></UL></DIV><DIV class="right-menu noprint" id="menubar"><UL><LI id="pt-login"><A href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Team:TU_Munich/jquery.EmbedPicasaGallery.js" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</A></LI></UL></DIV><DIV id="search-controls" class="noprint"><FORM action="/Special:Search" id="searchform"> </FORM></DIV></DIV><DIV id="content"><H1 class="firstHeading">Team:TU Munich/jquery.EmbedPicasaGallery.js</H1><DIV id="bodyContent"><H3 id="siteSub" class="noprint">From 2011.igem.org</H3><P>/**************************************************************************
</P><PRE>* Name:   EmbedPicasaGallery
* Author: Tobias Oetiker &lt;tobi@oetiker.ch&gt;
* Demo:   <A href="http://tobi.oetiker.ch/photo/" class="external free" rel="nofollow">http://tobi.oetiker.ch/photo/</A>
* $Id: jquery.EmbedPicasaGallery.js 474 2011-06-16 09:02:45Z oetiker $
**************************************************************************
Description:

This little script asks picasa web for a list of albums and for a list
of pictures in the album. It then emits a series of &lt;div class=&quot;pic-thumb&quot;/&gt;
elements containing thumbnail images. The divs are inserted inside the element
marked with a particular id. Clicking on an album will display thumbnails of the
images in the album and clicking on a thumbnail will show the image itself
using slimbox.

The script itself uses jQuery (<A href="http://www.jquery.org" class="external free" rel="nofollow">http://www.jquery.org</A>) and slimbox2
(<A href="http://www.digitalia.be/software/slimbox2" class="external free" rel="nofollow">http://www.digitalia.be/software/slimbox2</A>) to work. So you have to load
these two guys before loading the gallery script. You can load them in the
header or the body of the document, this does not matter.

 &lt;script type=&quot;text/javascript&quot; src=&quot;js/jquery.js&quot;&gt;&lt;/script&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;css/slimbox2.css&quot; type=&quot;text/css&quot; media=&quot;screen&quot; /&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;slimbox2.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;js/jquery.EmbedPicasaGallery.js&quot;&gt;&lt;/script&gt;</PRE><PRE>Once loaded, call the picasaGallery function. This activates the
code. With the id argument you tell it, where to put the gallery.
</PRE><PRE>&lt;script type=&quot;text/javascript&quot;&gt;
 jQuery(document).ready(function() {
 jQuery(&quot;#images&quot;).EmbedPicasaGallery('oetiker',{
     matcher:            /./,         // string or regexp to match album title
     size:               72,        // thumbnail size (32, 48, 64, 72, 144, 160)
     msg_loading_list :  'Loading album list from PicasaWeb',
     msg_back :          'back',
     msg_more :          'more',
     authkey :           'optional-picasa-authkey',
     albumid :           'go-directly-to-this-album-ignore-matcher',
     auto_open:          false, //opens the first album
     album_title_tag:    '&lt;h2/&gt;',
     hide_back:          false, //hide the back button
     thumb_id_prefix:    'pThumb_',
     show_more:      null,       // show only the first x images when the album gets opened
     loading_animation: 'css/loading.gif',
     thumb_finalizer:    function(){var $a = jQuery(this); ... use this to do something to the anchor AFTER slimbox got there },
     thumb_tuner:        function($img,entry,i){ ... $img is the img of the thumbnail, entry is the picasa image info ...}
     link_mapper: function(el){  // see <A href="http://code.google.com/p/slimbox/wiki/jQueryAPI#The_linkMapper_function" class="external free" rel="nofollow">http://code.google.com/p/slimbox/wiki/jQueryAPI#The_linkMapper_function</A>
           return [
                    el.href,
                    '&lt;a href=&quot;'+el.href+'&quot;&gt;'+el.title+'&lt;/a&gt;'
                  ]
           }
  });
 });
 &lt;/script&gt;</PRE><PRE>Finally inside the document, add a div tag with the id set to the name
chosen above.

</PRE><UL><LI>/
</LI></UL><P>(function($) {
</P><PRE>   // setup a namespace for us
   var nsp = 'EmbedPicasaGallery', authkey;
</PRE><PRE>   // Private Variables and Functions in the _ object
   // note that this will refer to _ unless you
   // call using the call or apply methods
</PRE><PRE>   // Public Variables and Methods
   $[nsp] = {
       defaultOptions: {
           matcher : RegExp('.+'),
           size    : 72,
           msg_loading_list : 'Loading album list from PicasaWeb',
           msg_back : 'back',
           msg_more : 'more',
           album_title_tag: '&lt;h2/&gt;',
           auto_open: false,
           thumb_id_prefix: 'pThumb_',
           thumb_tuner: null,
           thumb_finalizer: null,
           loading_animation: null,
           show_more: null,
           hide_back: false,
           link_mapper: function(el){
                   return [
                       el.href,
                       '&lt;a href=&quot;'+el.href+'&quot;&gt;'+el.title+'&lt;/a&gt;'
                   ]
               }
       } 
   };
   $.fn[nsp] = function(user,opts) {
       var localOpts,
           Cache = {};
</PRE><PRE>       localOpts = $.extend( 
           {}, // start with an empty map
           $[nsp].defaultOptions, // add defaults
           opts // add options
       );
</PRE><PRE>       function showOverview() {
           var $this,
               meta_opts,
               albumCount,
               $album_list,
               authkey = <I>;</I></PRE><PRE>           if ( Cache.__overview ){
                Cache.__overview.show();
                return;
           }
           $this = $(this);
           $this.empty();
           meta_opts = localOpts;
           if ($.meta){
               meta_opts = $.extend({}, localOpts, $this.data());
           }
           albumCount = 0;
           $album_list = $('&lt;div/&gt;')
               .addClass('album-list')
               .css('position','relative')
               .css('overflow','hidden')
               .append($('&lt;div/&gt;').text(meta_opts.msg_loading_list));
</PRE><PRE>           function appendImage(i,item){
               var title,$div,$img;
               title = item.media$group.media$title.$t;
               if (title.match(meta_opts.matcher)){
                   albumCount++;
                   $img = $('&lt;img/&gt;')
                       .attr('title',title)
                       .attr('src',item.media$group.media$thumbnail[0].url)
                   $div = $('&lt;div/&gt;')
                       .addClass('album-cover')
                       .css({
                           'float': 'left',
                           marginRight: '10px',
                           marginBottom: '10px'
                       })
                       .click(function () {
                          $album_list.hide();
                          showAlbum($this,meta_opts,item.gphoto$id.$t,title,item.gphoto$numphotos.$t);
                       })
                       .hover(
                           function () { $(this).css(&quot;cursor&quot;,&quot;pointer&quot;)},
                           function () { $(this).css(&quot;cursor&quot;,&quot;default&quot;)}
                       )
                       .append( $img )
                       .append(
                           $('&lt;div/&gt;')
                           .addClass('album-title')
                           .css({
                               'font-size': '10px'
                           })
                           .text(title)
                           .width( meta_opts.size )
                       )                    
                   $album_list.append($div);
               };
           }
           
           function renderAlbumList(data){
               var $albums,maxHeight=0;
               $album_list.empty();
       		if (data.feed &amp;&amp; data.feed.entry){
   	            $.each(data.feed.entry,appendImage);
       		} else {
         		    $this.text('Warning: No picasa albums found for user ' + user);
</PRE><P>		        }
</P><PRE>               Cache.__overview = $album_list;
               $albums = $album_list.children();
</PRE><PRE>               if (meta_opts.auto_open){
                   $albums.eq(0).click();
                   return;
               }
               $('.album-title',$album_list)
               .each(function(){                        
                    var h = $(this).outerHeight();
                    if (h &gt; maxHeight){
                       maxHeight = h
                    }
               })
               .each(function(){
                   $(this).height(maxHeight)
               });
</PRE><PRE>           }
</PRE><PRE>           if (meta_opts.authkey){
               authkey = '&amp;authkey=' + meta_opts.authkey;
           }

   	    if (meta_opts.albumid) {
      	       showAlbum($this,meta_opts,meta_opts.albumid)
   	    }
</PRE><P>	        else {
</P><PRE>               $this.prepend($album_list);
               $.getJSON('<A href="http://picasaweb.google.com/data/feed/api/user/'" class="external free" rel="nofollow">http://picasaweb.google.com/data/feed/api/user/'</A> 
                   + user + '?kind=album&amp;access=visible' + authkey 
                   + '&amp;alt=json-in-script&amp;thumbsize=' + meta_opts.size + 'c&amp;callback=?',
                   renderAlbumList
              );
</PRE><P>	        }
</P><PRE>       };
</PRE><PRE>       function showAlbum($this,meta_opts,album,title,photoCount){                        
           if ( Cache[album] ){
              Cache[album].show();
              return;
           };
</PRE><PRE>           var i,$album,albumPics=[],$picDiv;
</PRE><PRE>           $album = $('&lt;div/&gt;').addClass('album')
               .css('position','relative')
               .css('overflow','hidden');
       
           if (title){
               $album.append($(meta_opts.album_title_tag).text(title))
           }
           function makeDiv(){            
              var $div = $('&lt;div/&gt;')
                  .css({
                       'float': 'left',
                       marginRight: '10px',
                       marginBottom: '10px',
                       width: meta_opts.size+'px',
                       height: meta_opts.size+'px'
                   });
              if (meta_opts.loading_animation){
                  $div.css('background','url(' + meta_opts.loading_animation + ') no-repeat center center');            
              }
              return $div;
           }
</PRE><PRE>           function makeButton(text){
               return $(&quot;&lt;div/&gt;&quot;)                    
                   .addClass(&quot;pic-thumb&quot;)
                   .width(meta_opts.size)
                   .height(meta_opts.size)
                   .css({borderWidth: '0px',
                        'float' : 'left',
                        marginRight: '10px',
                        marginBottom: '10px',
                        cursor: 'pointer'
                    })
                   .append($(&quot;&lt;div/&gt;&quot;)
                       .html(''+text)
                       .css({'borderStyle':'outset',
                             'borderWidth':'1px',
                             'textAlign'  :'center',
                             'width'       : (meta_opts.size - 2) + 'px',
                             'height'      : (meta_opts.size - 2) + 'px'
                       })
                   );                 
           }
</PRE><PRE>           if (Cache.__overview &amp;&amp; !meta_opts.hide_back){            
               $album.append(makeButton(meta_opts.msg_back)
                   .click(function(){$album.hide();showOverview()})
               );
           }
           $this.prepend($album);
           
           if (photoCount){
               for (i=0;i&lt;photoCount &amp;&amp; (!meta_opts.show_more || i&lt;meta_opts.show_more);i++) {
                   $picDiv = makeDiv();
                   $album.append($picDiv);
                   albumPics.push($picDiv);
               }
           }
</PRE><PRE>           function makeImage(i,item){
              var title = item.media$group.media$description.$t || item.media$group.media$title.$t;  
              var $div = albumPics[i] || makeDiv();
</PRE><PRE>              var $img = $('&lt;img/&gt;')
              	   .css('borderWidth','0px')
</PRE><P>	           .hide()
</P><PRE>                  .load(function(){                   
                      if (meta_opts.thumb_tuner){
                          meta_opts.thumb_tuner(this,item);
                      }
</PRE><P>		       $img.show();
</P><PRE>                  });
</PRE><PRE>              var thumbs = item.media$group.media$thumbnail;
</PRE><P>	       var gotOne = false;
</P><PRE>              for (var i = 0; i&lt;thumbs.length;i++){
                   if (thumbs[i].width == meta_opts.size &amp;&amp; thumbs[i].height == meta_opts.size){
                       $img.attr(&quot;src&quot;, thumbs[i].url);
</PRE><P>			gotOne = true;
</P><PRE>                       break;
                   }
              }
</PRE><P>	       if (!gotOne){
	           $img.attr(&quot;alt&quot;,&quot;Sorry, no matching thumbnail found.&quot;);
	       }
</P><PRE>              var $a = $(&quot;&lt;a/&gt;&quot;)
                  .attr(&quot;href&quot;,item.content.src)
                  .attr(&quot;title&quot;,title)
                  .append($img);
</PRE><PRE>              $div
                  .attr(&quot;id&quot;, meta_opts.thumb_id_prefix + item.gphoto$id.$t )
                  .append($a);
</PRE><PRE>              return $div; 
           }
</PRE><PRE>           function renderAlbum(data){
               var images = data.feed.entry;
               var hiddenImages = [];
               for (var i=0;i&lt;images.length;i++){
                   var $div = makeImage(i,images[i]);
                   if (!meta_opts.show_more || i &lt; meta_opts.show_more){
                       $div.show();
                   }
                   else {
                       $div.hide();
                       hiddenImages.push($div);
                   }
                   $album.append($div);
</PRE><PRE>                   if (meta_opts.show_more &amp;&amp; i == meta_opts.show_more){
                       var $moreButton = makeButton(meta_opts.msg_more);
                       $album.append($moreButton
                           .click(function(){
                               var start = 0;
                               jQuery.each(hiddenImages,function(i,$img){
                                   window
                                       .setTimeout(
                                           function(){
                                               $img.fadeIn('fast');
                                           },
                                           50*(start++)
                                       );
                               });
                               $moreButton.hide();
                           })
                       );                        
                   }            
               }
               if ($.fn.slimbox){
                   $('a',$album).slimbox({},meta_opts.link_mapper);
               }
               if (meta_opts.thumb_callback){
                   $('a',$album).each(meta_opts.thumb_callback);
               }
               Cache[album] = $album;
           }
           authkey = <I>;</I>
           if (meta_opts.authkey){
              authkey = '&amp;authkey=' + meta_opts.authkey;
           }
           $.getJSON('<A href="http://picasaweb.google.com/data/feed/api/user/'" class="external free" rel="nofollow">http://picasaweb.google.com/data/feed/api/user/'</A> 
               + user + '/albumid/' 
               + album + '?kind=photo&amp;access=visible' + authkey + '&amp;alt=json-in-script&amp;thumbsize='+meta_opts.size+'c&amp;imgmax=800&amp;callback=?',
               renderAlbum
           );
       };
</PRE><PRE>       return this.each(showOverview);
   };
</PRE><P>})(jQuery);
</P><DIV class="printfooter">
Retrieved from &quot;<A href="http://2011.igem.org/Team:TU_Munich/jquery.EmbedPicasaGallery.js">http://2011.igem.org/Team:TU_Munich/jquery.EmbedPicasaGallery.js</A>&quot;</DIV></DIV></DIV><DIV id="footer-box" class="noprint"><DIV id="footer"><UL id="f-list"><LI id="t-recentchanges"><A href="/Special:RecentChanges" title="Recent changes">Recent changes</A></LI><LI id="t-whatlinkshere"><A href="/Special:WhatLinksHere/Team:TU_Munich/jquery.EmbedPicasaGallery.js" title="List of all wiki pages that link here [j]" accesskey="j">What links here</A></LI><LI id="t-recentchangeslinked"><A href="/Special:RecentChangesLinked/Team:TU_Munich/jquery.EmbedPicasaGallery.js" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</A></LI><LI id="t-specialpages"><A href="/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</A></LI><LI><A href="/Special:Preferences">My preferences</A></LI></UL></DIV><DIV id="footer"><UL id="f-list"><LI id="t-print"><A href="/wiki/index.php?title=Team:TU_Munich/jquery.EmbedPicasaGallery.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</A></LI><LI id="t-permalink"><A href="/wiki/index.php?title=Team:TU_Munich/jquery.EmbedPicasaGallery.js&amp;oldid=80710" title="Permanent link to this revision of the page">Permanent link</A></LI><LI id="privacy"><A href="/2011.igem.org:Privacy_policy" title="2011.igem.org:Privacy policy">Privacy policy</A></LI><LI id="disclaimer"><A href="/2011.igem.org:General_disclaimer" title="2011.igem.org:General disclaimer">Disclaimers</A></LI></UL></DIV></DIV></DIV></BODY></HTML>